[
    {
        "number": 84926,
        "title": "Disconnect `ssh` connection plugin verbosity from Ansible verbosity",
        "body": "SSH connection plugin verbosity is hardcoded to match Ansible's verbosity (e.g., running Ansible with `-vvv` applies `-vvv` to all `ssh` invocations as well). This causes a ridiculous amount of unnecessary logging/storage overhead (especially for AAP jobs that nearly always run with increased verbosity), pollutes `raw` outputs, interpreter discovery diagnostics, and more. It also complicates attaining 100% code coverage in some interpreter discovery cases, since `stderr` always contains junk.\n\nAdd an explicit connection verbosity config to `ssh` instead of inheriting Ansible's verbosity. Also, when no verbosity is set, add `-q` to `ssh` invocations to suppress connection closure messages and other diagnostic noise on stderr.\n\n@ansibot bot_skip\n",
        "created_at": "2025-04-03T17:31:14Z",
        "user": "nitzmahone",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84924,
        "title": "show example of async handlers or make it clear that they cannot be run async",
        "body": "### Summary\n\ni am trying to restart a service in an handler that takes quite some time to restart. so i want to do it with async/poll: 0 . but the handler task is currently waiting on the service to restart, ignoring the poll = 0 option.\n\n\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nhandler\n\n### Ansible Version\n\n```console\n$ ansible --version\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\nlinux\n\n### Additional Information\n\n.\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-04-03T13:27:34Z",
        "user": "dberardo-com",
        "labels": [
            "needs_info",
            "needs_verified"
        ]
    },
    {
        "number": 84922,
        "title": "Callbacks do not resolve temlpating for delegate_to ",
        "body": "### Summary\n\nHi guys,\n\nI am using ansible for a very long time andd something alsways bothered me (and my colleagues):\nwhen using delegate_to the jinja templating for ansible_host is not resolved but the template itself is shown in the delegation expression\n`[VM1 -> VM2({{ NET1_IP }}]`\n\nIt would be really great to solve this in ansible itself instead of relying on soething like setting a fact beforehand like mentioned in this ticket:\n#82693 \n\n\nhere is my setup (which had to be readcted):\n\n\nexample task:\n```\n  - name: does something\n    ansible.builtin.debug:\n      msg: \"test\"\n    delegate_to: \"{{ VM2 }}\"\n```\n\nredacted output:\n```\nTASK [do_something : does something] *************************************************************************************\nThursday 03 April 2025  08:30:21 +0000 (0:00:00.230)       0:00:08.873 ********\nok: [VM1 -> VM2({{ NET1_IP }})]\n```\n\nin my inventory I have both hosts and in the one that gets the delegated task I have NET1_IP defined.\n\nin my inventory for VM2:\n`ansible_host: \"{{ NET1_IP }}\"`\n\nthe delegation itself works BUT the display does not resolve the jinja templating sadly\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible core\n\n### Ansible Version\n\n```console\nansible [core 2.15.12]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/home/SVC_ADMIN_ANS/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /opt/dbp/venv/Y10-P06S10/lib64/python3.9/site-packages/ansible\n  ansible collection location = /opt/dbp/collections:/usr/share/ansible/collections\n  executable location = /opt/dbp/venv/Y10-P06S10/bin/ansible\n  python version = 3.9.21 (main, Dec  5 2024, 00:00:00) [GCC 11.5.0 20240719 (Red Hat 11.5.0-2)] (/opt/dbp/venv/Y10-P06S10/bin/python3)\n  jinja version = 3.1.4\n  libyaml = True\n```\n\n### Configuration\n\n```console\nANY_ERRORS_FATAL(/etc/ansible/ansible.cfg) = True\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['ansible.posix.profile_tasks']\nCOLLECTIONS_PATHS(/etc/ansible/ansible.cfg) = ['<REDACTED>', '/usr/share/ansible/collections']\nCOLOR_VERBOSE(/etc/ansible/ansible.cfg) = white\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 10\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['<REDACTED>']\nDEFAULT_JINJA2_NATIVE(/etc/ansible/ansible.cfg) = True\nDEFAULT_LOAD_CALLBACK_PLUGINS(/etc/ansible/ansible.cfg) = True\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /<REDACTED>/ansible.log\nDEFAULT_POLL_INTERVAL(/etc/ansible/ansible.cfg) = 15\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = community.general.diy\nDISPLAY_SKIPPED_HOSTS(/etc/ansible/ansible.cfg) = True\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\nINVENTORY_IGNORE_EXTS(/etc/ansible/ansible.cfg) = ['~', '.orig', '.bak', '.cfg', '.retry', '.pyc', '.pyo', '.kdbx']\n\nCALLBACK:\n========\n\ndefault:\n_______\ndisplay_skipped_hosts(/etc/ansible/ansible.cfg) = True\n\nCONNECTION:\n==========\n\nparamiko_ssh:\n____________\nhost_key_checking(/etc/ansible/ansible.cfg) = False\n\nssh:\n___\nhost_key_checking(/etc/ansible/ansible.cfg) = False\npipelining(/etc/ansible/ansible.cfg) = True\n```\n\n### OS / Environment\n\nredhat-release-9.5-0.6.el9.x86_64\n\n### Steps to Reproduce\n\n```yaml (paste below)\n  - name: does something\n    ansible.builtin.debug:\n      msg: \"test\"\n    delegate_to: \"{{ VM2 }}\"\n```\n\n\n### Expected Results\n\n```\nTASK [do_something : does something] *************************************************************************************\nThursday 03 April 2025  08:30:21 +0000 (0:00:00.230)       0:00:08.873 ********\nok: [VM1 -> VM2(10.10.0.1)]\n```\n\n### Actual Results\n\n```console\nTASK [do_something : does something] *************************************************************************************\nThursday 03 April 2025  08:30:21 +0000 (0:00:00.230)       0:00:08.873 ********\nok: [VM1 -> VM2({{ NET1_IP }})]\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-04-03T08:54:42Z",
        "user": "mindgam3s",
        "labels": [
            "bug",
            "P3",
            "affects_2.15",
            "data_tagging"
        ]
    },
    {
        "number": 84913,
        "title": "str-ify subprocess launches",
        "body": "We're still launching subprocesses with `bytes` args in a number of places- that causes a lot of stderr noise from things like coverage and pydevd that attempt to monkeypatch args and have dropped support for non-str values- even more noisy now that we've turned unknown stderr from workers into a full-fledged warning. I noticed this using the ssh connection plugin under pycharm, but IIRC there are a number of other things that could trigger the same issue, and since we've basically settled on requiring controller-side UTF8 support, doesn't seem unreasonable to `str` ify those things as Py3 more or less expects now.\n\n@ansibot bot_skip\n",
        "created_at": "2025-04-01T16:37:04Z",
        "user": "nitzmahone",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84909,
        "title": "_get_collection_name_from_path() can return None and calling code isn't expecting this",
        "body": "### Summary\n\nIf you have one `ansible_collections` tree inside another, `ansible.utils.collection_loader._get_collection_name_from_path()` returns `None`. `ansible.collections.list_collections()` doesn't seem to expect this, it returns a dictionary with `None` as a key. This terribly confuses other code; for example `ansible.plugins.list.get_composite_name()` can fail with `TypeError: sequence item 0: expected str instance, NoneType found` if `ansible-doc -vvv --metadata-dump --no-fail-on-errors` is run.\n\n(What's surprising me is that this crash doesn't happen all the time. I sometimes have to run the command multiple times to get the crash. Sometimes it just happens every time. It also seems to depend on which collections I have in the nested `ansible_collections` tree whether it happens a lot or just sometimes \ud83e\udd37)\n\nThis happens with the latest ansible-core release, ansible-core devel branch, and ansible-core DT branch.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-doc\n\n### Ansible Version\n\n```console\nstable-2.18, devel, DT\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\n-\n\n### Steps to Reproduce\n\nCreate a nested `ansible_collections` tree, point `ANSIBLE_COLLECTIONS_PATH` only at the inner tree, and try to run `ansible-doc -vvv --metadata-dump --no-fail-on-errors`.\n\nIn my case the inner tree mainly had symlinks to some of the collections in the outer tree. (This happened while testing antsibull-nox.)\n\n### Expected Results\n\nGet a proper error, or it just works.\n\n### Actual Results\n\n```console\n`ERROR! Unexpected Exception, this is probably a bug: sequence item 0: expected str instance, NoneType found`\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-29T11:51:57Z",
        "user": "felixfontein",
        "labels": [
            "bug",
            "has_pr",
            "P3"
        ]
    },
    {
        "number": 84907,
        "title": "basic.py tmpdir creation race condition",
        "body": "### Summary\n\nEncountered a race condition with the tmp directory makedir in basic.py.\n\n[WARNING]: Unable to use /tmp/.ansible_root as temporary directory, failing\nback to system: [Errno 17] File exists: '/tmp/.ansible_root'\n\n```\n            if basedir is not None and not os.path.exists(basedir):\n                try:\n                    os.makedirs(basedir, mode=0o700)\n                except (OSError, IOError) as e:\n                    self.warn(\"Unable to use %s as temporary directory, \"\n                              \"failing back to system: %s\" % (basedir, to_native(e)))\n                    basedir = None\n```\n\nThe makedirs needs exist_ok=True\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nbasic.py\n\n### Ansible Version\n\n```console\nansible [core 2.15.0]\n  python version = 3.11.2 (main, Feb 17 2023, 09:28:16) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/usr/bin/python3.11)\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\nRHEL8.6\n\n### Steps to Reproduce\n\nThis is a very rare race condition\n\n\n### Expected Results\n\nMakedir doesn't fail if tmpdir already exists\n\n### Actual Results\n\n```console\n[WARNING]: Unable to use /tmp/.ansible_root as temporary directory, failing\nback to system: [Errno 17] File exists: '/tmp/.ansible_root'\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-28T02:41:24Z",
        "user": "jnm27",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 84905,
        "title": "[ansible.builtin.pip][bug] The pip module is not creating virtualenv properly for relative paths",
        "body": "### Summary\n\nWhen I try to use pip module together with `virtualenv` option,\nit does not create properly the virtual environment under the specified relative path.\n\nIt does work properly when an absolute path is specified though.\n\n\n### Issue Type\n\nBug Report\n\n\n### Component Name\n\npip\n\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.1]\n  config file = None\n  configured module search path = ['/home/sdatko/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/lib/python3.13/site-packages/ansible\n  ansible collection location = /home/sdatko/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/bin/ansible\n  python version = 3.13.1 (main, Dec  4 2024, 18:05:56) [GCC 14.2.1 20240910] (/usr/bin/python)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = None\nEDITOR(env: EDITOR) = vim\n\nGALAXY_SERVERS:\n```\n\n\n### OS / Environment\n\nArch Linux latest (but tested also in other environments with older Ansible versions; seems to happen everywhere)\n\n\n### Steps to Reproduce\n\nExample playbook:\n```yaml\n---\n- name: Testing pip module\n  any_errors_fatal: true\n  gather_facts: false\n  hosts: localhost\n  tasks:\n    - shell: pwd\n    - name: Create virtualenv with example package\n      ansible.builtin.pip:\n        name: example\n        virtualenv: my-venv\n        virtualenv_command: /usr/bin/python3 -m venv\n```\n\n\n### Expected Results\n\nThe `my-venv` directory with virtual environment should be created relative to the current working directory (`shell: pwd` task returns the `/home/username`) and the `example` package should be installed inside that virtual environment.\n\n\n### Actual Results\n\n```console\nRunning `ansible-playbook -vvvv example.yml` results in the following:\n\nansible-playbook [core 2.18.1]\n  config file = None\n  configured module search path = ['/home/sdatko/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/lib/python3.13/site-packages/ansible\n  ansible collection location = /home/sdatko/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/bin/ansible-playbook\n  python version = 3.13.1 (main, Dec  4 2024, 18:05:56) [GCC 14.2.1 20240910] (/usr/bin/python)\n  jinja version = 3.1.5\n  libyaml = True\nNo config file found; using defaults\nsetting up inventory plugins\nLoading collection ansible.builtin from\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\nSkipping due to inventory source not existing or not being readable by the current user\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\nSkipping due to inventory source not existing or not being readable by the current user\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\nSkipping due to inventory source not existing or not being readable by the current user\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\nSkipping due to inventory source not existing or not being readable by the current user\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\n[WARNING]: No inventory was parsed, only implicit localhost is available\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\nthe implicit localhost does not match 'all'\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python3.13/site-packages/ansible/plugins/callback/default.py\nSkipping callback 'default', as we already have a stdout callback.\nSkipping callback 'minimal', as we already have a stdout callback.\nSkipping callback 'oneline', as we already have a stdout callback.\n\nPLAYBOOK: example.yml **********************************************************\nPositional arguments: example.yml\nverbosity: 4\nconnection: ssh\nbecome_method: sudo\ntags: ('all',)\ninventory: ('/etc/ansible/hosts',)\nforks: 5\n1 plays in example.yml\n\nPLAY [Testing pip module] ******************************************************\n\nTASK [shell] *******************************************************************\ntask path: /home/sdatko/example.yml:7\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: sdatko\n<127.0.0.1> EXEC /bin/sh -c 'echo ~sdatko && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/sdatko/.ansible/tmp `\"&& mkdir \"` echo /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423 `\" && echo ansible-tmp-1743079524.6977901-410555-188277734482423=\"` echo /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423 `\" ) && sleep 0'\nUsing module file /usr/lib/python3.13/site-packages/ansible/modules/command.py\n<127.0.0.1> PUT /home/sdatko/.ansible/tmp/ansible-local-4105524_2rzniw/tmp08hkqc67 TO /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423/AnsiballZ_command.py\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423/ /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423/AnsiballZ_command.py && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423/AnsiballZ_command.py && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.6977901-410555-188277734482423/ > /dev/null 2>&1 && sleep 0'\nchanged: [localhost] => {\n    \"changed\": true,\n    \"cmd\": \"pwd\",\n    \"delta\": \"0:00:00.001946\",\n    \"end\": \"2025-03-27 13:45:24.833633\",\n    \"invocation\": {\n        \"module_args\": {\n            \"_raw_params\": \"pwd\",\n            \"_uses_shell\": true,\n            \"argv\": null,\n            \"chdir\": null,\n            \"creates\": null,\n            \"executable\": null,\n            \"expand_argument_vars\": true,\n            \"removes\": null,\n            \"stdin\": null,\n            \"stdin_add_newline\": true,\n            \"strip_empty_ends\": true\n        }\n    },\n    \"msg\": \"\",\n    \"rc\": 0,\n    \"start\": \"2025-03-27 13:45:24.831687\",\n    \"stderr\": \"\",\n    \"stderr_lines\": [],\n    \"stdout\": \"/home/sdatko\",\n    \"stdout_lines\": [\n        \"/home/sdatko\"\n    ]\n}\n\nTASK [Create virtualenv with example package] **********************************\ntask path: /home/sdatko/example.yml:8\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: sdatko\n<127.0.0.1> EXEC /bin/sh -c 'echo ~sdatko && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/sdatko/.ansible/tmp `\"&& mkdir \"` echo /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871 `\" && echo ansible-tmp-1743079524.852888-410571-139078312334871=\"` echo /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871 `\" ) && sleep 0'\nUsing module file /usr/lib/python3.13/site-packages/ansible/modules/pip.py\n<127.0.0.1> PUT /home/sdatko/.ansible/tmp/ansible-local-4105524_2rzniw/tmp_z3np_yh TO /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871/AnsiballZ_pip.py\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871/ /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871/AnsiballZ_pip.py && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871/AnsiballZ_pip.py && sleep 0'\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/sdatko/.ansible/tmp/ansible-tmp-1743079524.852888-410571-139078312334871/ > /dev/null 2>&1 && sleep 0'\nfatal: [localhost]: FAILED! => {\n    \"changed\": false,\n    \"invocation\": {\n        \"module_args\": {\n            \"break_system_packages\": false,\n            \"chdir\": null,\n            \"editable\": false,\n            \"executable\": null,\n            \"extra_args\": null,\n            \"name\": [\n                \"example\"\n            ],\n            \"requirements\": null,\n            \"state\": \"present\",\n            \"umask\": null,\n            \"version\": null,\n            \"virtualenv\": \"my-venv\",\n            \"virtualenv_command\": \"/usr/bin/python3 -m venv\",\n            \"virtualenv_python\": null,\n            \"virtualenv_site_packages\": false\n        }\n    },\n    \"msg\": \"Unable to find pip in the virtualenv, my-venv, under any of these names: pip3, pip. Make sure pip is present in the virtualenv.\"\n}\n\nPLAY RECAP *********************************************************************\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n**/edit/**: Later I noticed that the `/tmp/my-venv` directory was created in my system. It appears that it was created apparently via [`setup_virtualenv()` call](https://github.com/ansible/ansible/blob/87422526f53993e10dd0cfcf465f1d7674357ca5/lib/ansible/modules/pip.py#L751) but the rest of the `pip` module seem to look for `my-venv` still relatively to the current working directory (as expected).\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-27T12:49:08Z",
        "user": "sdatko",
        "labels": [
            "module",
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84897,
        "title": "Allow user to silent the warning when reserved name variable is used",
        "body": "### Summary\n\nHello everyone, Im trying to use ec2 dynamic inventory and Im getting this warning at the beginning of each running playbook. \n\n`[WARNING]: Found variable using reserved name: tags`\n\norchestration.aws_ec2.yaml\n```\nplugin: amazon.aws.aws_ec2\ncache: no\nprofile: orchestration.test.role\nregions:\n  - us-east-1\nfilters:\n  instance-state-name: running\n  tag:my_ansible: true\n\nhostnames:\n  - private-ip-address\n\ncompose:\n  aws_tags: tags\n\ngroups:\n  group_test: \"aws_tags['my_ansible'] == 'true'\"\n```\n\nansible.cfg \n```\n[defaults]\nremote_user          = ubuntu\ninventory            = ./inventory\nprivate_key_file     = ~/.ssh/keys/mykey.pem\ninterpreter_python   = /usr/bin/python3.12\nhost_key_checking    = false\naction_warnings      = false\ndeprecation_warnings = false\nsystem_warnings      = false\n\n[privilege_escalation]\nbecome        = true\nbecome_user   = root\nbecome_method = sudo\nbecome_ask_password = false\n```\n\nmy question is that if It is the default behavior of the plugin how can I disable it I tried to set all warnings to false\nbut it is still showing \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\n\n### Ansible Version\n\n```console\n$ ansible --version\n\nansible [core 2.18.3]\n  config file = /Users/ehsan/Documents/cloud-mgmt/ansible/project1/ansible.cfg\n  configured module search path = ['/Users/ehsan/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /opt/homebrew/Cellar/ansible/11.3.0_1/libexec/lib/python3.13/site-packages/ansible\n  ansible collection location = /Users/ehsan/.ansible/collections:/usr/share/ansible/collections\n  executable location = /opt/homebrew/bin/ansible\n  python version = 3.13.2 (main, Feb  4 2025, 14:51:09) [Clang 16.0.0 (clang-1600.0.26.6)] (/opt/homebrew/Cellar/ansible/11.3.0_1/libexec/bin/python)\n  jinja version = 3.1.6\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\nMacOS\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\nansible-playbook playbook.yaml\n\nPLAY [Ping playbook] ******************************************************************************************************************************************\n[WARNING]: Found variable using reserved name: tags\n\n```\n\n\n### Expected Results\n\nrunning without that warning\n\n### Actual Results\n\n```console\nPLAY [Ping playbook] ******************************************************************************************************************************************\n[WARNING]: Found variable using reserved name: tags\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-26T01:09:55Z",
        "user": "eahangari-8x8",
        "labels": [
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84893,
        "title": "setuptools 78.0.2 behavior change causes sanity failure for package data",
        "body": "### Summary\n\nsetuptools between 66.1.0 and 78.0.2 included a behavior change that results in our license files being moved to the `licenses` directory of the `dist-info`:\n\n```\nERROR: Found 10 package-data issue(s) which need to be resolved:\nERROR: ansible_core-2.19.0.dev0.dist-info/Apache-License.txt:0:0: missing from wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/COPYING:0:0: missing from wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/MIT-license.txt:0:0: missing from wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/PSF-license.txt:0:0: missing from wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/licenses/COPYING:0:0: unexpected in wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/licenses/licenses/Apache-License.txt:0:0: unexpected in wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/licenses/licenses/MIT-license.txt:0:0: unexpected in wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/licenses/licenses/PSF-license.txt:0:0: unexpected in wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/licenses/licenses/simplified_bsd.txt:0:0: unexpected in wheel (78.0.2)\nERROR: ansible_core-2.19.0.dev0.dist-info/simplified_bsd.txt:0:0: missing from wheel (78.0.2)\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\npyproject.toml\n\n### Ansible Version\n\n```console\n$ ansible --version\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\nNA\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n\n```\n\n\n### Expected Results\n\nNA\n\n### Actual Results\n\n```console\nNA\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-25T16:35:35Z",
        "user": "sivel",
        "labels": [
            "bug",
            "P3"
        ]
    },
    {
        "number": 84880,
        "title": "Make apt clean mark as change only if something was actually cleaned",
        "body": "### Summary\n\n\n### Limitation\nI'm using ansible [core 2.17.9] and an `apt` task with a single `clean: true` it always returns `changed: true`, even if there was nothing to be cleaned.\n\n### Proposal\nThis could be improved if we detected that nothing will be done, as `apt-get` can tell us what it will be doing.\nAn improvement could be done based on the `apt-get clean --dry-run` which outputs `(r)glob` expressions :\n\n```\nsudo apt-get clean --dry-run\nDel /var/cache/apt/archives/* /var/cache/apt/archives/partial/*\nDel /var/lib/apt/lists/partial/*\nDel /var/cache/apt/pkgcache.bin /var/cache/apt/srcpkgcache.bin\n```\n\nThis feature and format has been present in upstream APT for about 10 years :\nhttps://salsa.debian.org/apt-team/apt/-/blob/1.1_exp15/apt-private/private-download.cc#L301\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\napt\n\n### Additional Information\n\n\n### Implementation suggestion\n\nThe `changed` result could be set to true if any of the (r?)glob expressions provided by `--dry-run` match anything.\nStopping on first match found, and maybe even starting from the two non-glob expression, should make it pretty fast.\n\nThe change could be done in `lib.ansible.modules.apt.aptclean()`. It would be something along the line of :\n\n- start by setting local var `changed `to false\n- run `m.run_command(['apt-get', 'clean', '--dry-run'])`\n- test for errors and if none found, split by lines\n- match if line starts with `Del ` , and split the remainder by whitespaces\n- for each expression, check if it is a glob, and _maybe_ optimize by processing non-globs first\n- for non glob expression, test if exists, and for glob expressions try to find a match \n- if any is found for any exprssion, set local `changed `var to true _and stop processing_\n- then do the remainder of the current function, actually runing `apt-get clean`\n- finally return the pre-computed `cleanup `variable as 4th value\n- in the caller, get the \"changed\" value from the 4th return value\n- update the caller to update the `changed` return value in combination with other `apt` operations\n  (which might be the most complicated thing for a newcomer like me)\n\n\nI would love to provide a PR, as i can actually write some Python, but to be honest, understanding how to run a development version of Ansible to test my proposal above, might take me far more time than someone \"more used\" to ansible might take to code the above proposal. In any case, i could do it myself but i would certainly need some help or some explicit pointers and advice on _how to test ansible in a development environment_.\n\nSo i'll leave this suggestion up to you, or i'll require a \"looks good to me\" from you, before i actually spend some time on this. Thanks in advance for your feedback.\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-22T18:34:53Z",
        "user": "nipil",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 84863,
        "title": "ansible-pull --only-if-changed is broken",
        "body": "### Summary\n\nWhen i use ansible-pull with ``--only-if-changed``, commit id changed, but modifications are not triggered.\n\n```\n[2025-03-19 20:21:18] 4a-k1-12d.domain.com | CHANGED => \n[2025-03-19 20:21:18]     after: 5db3493a82a58ef28ac5521778cb35e8dd97d5ca\n[2025-03-19 20:21:18]     ansible_facts:\n[2025-03-19 20:21:18]         discovered_interpreter_python: /usr/bin/python3.11\n[2025-03-19 20:21:18]     before: 5dd538dfe19c6991fccc8cf675e99e68891fde24\n[2025-03-19 20:21:18]     changed: true\n[2025-03-19 20:21:18]     remote_url_changed: false\n[2025-03-19 20:21:18] Repository has not changed, quitting.\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-pull\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.2]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /opt/ansible/lib/python3.11/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /opt/ansible/bin/ansible\n  python version = 3.11.2 (main, Nov 30 2024, 21:22:50) [GCC 12.2.0] (/opt/ansible/bin/python3)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nANSIBLE_FORCE_COLOR(/etc/ansible/ansible.cfg) = True\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = explicit\nDEFAULT_REMOTE_USER(/etc/ansible/ansible.cfg) = root\nDEFAULT_VERBOSITY(/etc/ansible/ansible.cfg) = 0\nDISPLAY_SKIPPED_HOSTS(/etc/ansible/ansible.cfg) = False\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto_silent\nPAGER(env: PAGER) = most\nSHOW_CUSTOM_STATS(/etc/ansible/ansible.cfg) = True\n\nGALAXY_SERVERS:\n\n\nCALLBACK:\n========\n\ndefault:\n_______\ndisplay_failed_stderr(/etc/ansible/ansible.cfg) = True\ndisplay_skipped_hosts(/etc/ansible/ansible.cfg) = False\nresult_format(/etc/ansible/ansible.cfg) = yaml\nshow_custom_stats(/etc/ansible/ansible.cfg) = True\n\nminimal:\n_______\nresult_format(/etc/ansible/ansible.cfg) = yaml\n\nCONNECTION:\n==========\n\nparamiko_ssh:\n____________\nremote_user(/etc/ansible/ansible.cfg) = root\n\nssh:\n___\nremote_user(/etc/ansible/ansible.cfg) = root\n```\n\n### OS / Environment\n\nDebian 12\n\n### Steps to Reproduce\n\nCommit to the ansible repository\nRun ansible-pull\n\n\n### Expected Results\n\nPlaybook to be played\n\n### Actual Results\n\n```console\n``Repository has not changed``\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-19T20:01:38Z",
        "user": "eoli3n",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.18"
        ]
    },
    {
        "number": 84850,
        "title": "Ansible silently handles any exceptions raised in inventory plugin",
        "body": "### Summary\n\nWe have custom inventory plugin (that fetches list of hosts & their data via external service API). One would expect when AnsibleParserError  is raised inside parse() method, this will be shown in stderr.\n\nBut looking at ansible-core it is silently handles (ANY!) exception and execution continues. I stumbled into this debugging, why playbook is not executed on all out hosts. Plugin was failing and we were only getting partial inventory without any warning!\n\nRelated code is in ansible/inventory/manager.py\n```\n                    try:\n                        # FIXME in case plugin fails 1/2 way we have partial inventory\n                        plugin.parse(self._inventory, self._loader, source, cache=cache)\n                        try:\n                            plugin.update_cache_if_changed()\n                        except AttributeError:\n                            # some plugins might not implement caching\n                            pass\n                        parsed = True\n                        display.vvv('Parsed %s inventory source with %s plugin' % (source, plugin_name))\n                        break\n                    except AnsibleParserError as e:\n                        display.debug('%s was not parsable by %s' % (source, plugin_name))\n                        tb = ''.join(traceback.format_tb(sys.exc_info()[2]))\n                        failures.append({'src': source, 'plugin': plugin_name, 'exc': e, 'tb': tb})\n                    except Exception as e:\n                        display.debug('%s failed while attempting to parse %s' % (plugin_name, source))\n                        tb = ''.join(traceback.format_tb(sys.exc_info()[2]))\n                        failures.append({'src': source, 'plugin': plugin_name, 'exc': AnsibleError(e), 'tb': tb})\n```\n\nIn case of parser error, we would definitely want to stop ansible and display warning. Is there any other approach i am not aware of, to do this?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ninventory/manager.py\n\n### Ansible Version\n\n```console\n$ ansible --version\n2.15.8\n```\n\n### Configuration\n\n```console\ndefault/does not matter\n```\n\n### OS / Environment\n\nany\n\n### Steps to Reproduce\n\nTrigger any exception in parse() method of official or custom inventory plugin\n\n\n### Expected Results\n\nStop ansible execution and display error.\n\n### Actual Results\n\n```console\nSilently ignored and continues to process next inventory and executes playbook.\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-18T11:20:18Z",
        "user": "eleksis",
        "labels": [
            "bug",
            "data_tagging"
        ]
    },
    {
        "number": 84843,
        "title": "ansible-config does not correclty validate all entries",
        "body": "### Summary\n\nMostly the dynamic 'galaxy servers' \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-config\n\n### Ansible Version\n\n```console\n$ ansible --version\nall\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nany\n```\n\n### OS / Environment\n\nall\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```\n[galaxy]\nserver_list=my_org_hub\n\n[galaxy_server.my_org_hub]\n# url missing\n\n```\n```yaml (paste below)\nansible-config validate\n```\n\n\n### Expected Results\n\nerror!\n\n### Actual Results\n\n```console\nalls good!\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-17T19:15:38Z",
        "user": "bcoca",
        "labels": [
            "bug",
            "has_pr"
        ]
    },
    {
        "number": 84830,
        "title": "Action plugins can still not set variables / top-level facts access deprecation",
        "body": "### Fallible Version\n\n2025.3.11\n\n### Summary\n\nIt has been a long-standing issue that the only action plugin that can set variables is `ansible.builtin.load_vars` (by some special casing in ansible-core). All other action plugins (and modules) have to return `ansible_facts` if they want to make things available top-level without registration. Also, so far, the facts returned were marked as unsafe and it was thus not possible to create anything like real lazily evaluated variables anyway.\n\nNow with Data Tagging, action plugins can mark values in `ansible_facts` as trusted; these will be lazily evaluated. **But** the DT PR also deprecates top-level facts. Every time anything returned in `ansible_facts` is used on top-level, the user gets a (rather big) deprecation warning. This makes returning `ansible_facts` for the purpose of introducing top-level \"variables\" very unattractive.\n\nThis is a huge problem for the community.sops collection: it provides a community.sops.load_vars action that loads a SOPS encrypted file and returns the variables contained in there as `ansible_facts`. This has been the only way to create a replacement for ansible.builtin.load_vars that decrypts SOPS encrypted files (similar to how ansible.builtin.load_vars decrypts Ansible Vault encrypted files). With the top-level facts deprecation, it becomes **very** unattractive to use ansible-core with Data Tagging with community.sops. Adjusting all roles and playbooks which work with SOPS encrypted data is not an option, and generally disable deprecation warnings is not an option as well.\n\nPlease either introduce a way for action plugins to return proper variables before ansible-core 2.19 is in feature freeze, or move the top-level facts deprecation to a later release of ansible-core that includes such a way. Having neither of this basically means I (and everyone else who uses SOPS with Ansible) basically won't be able to use ansible-core 2.19 at all.\n\n\n### <!-- Bot instructions (ignore this) -->\n\n<!--\n### Component Name\nbin/ansible\n### Issue Type\nBug Report\n### Ansible Version\n2.19.0.dev0\n### Configuration\n### OS / Environment\n-->\n",
        "created_at": "2025-03-14T18:33:30Z",
        "user": "felixfontein",
        "labels": [
            "feature",
            "data_tagging",
            "fallible_dt"
        ]
    },
    {
        "number": 84825,
        "title": "get_url does not handle partial content correctly",
        "body": "### Summary\n\nSame behavior as #68843 (closed due to inactivity) :\n> When using get_url to download a big file, the task succeeds, but the file actually downloaded is truncated. Only a part has been saved.\n\nAttempting the same problematic download using `curl` showed the underlying error to be:\n```\ncurl: (18) transfer closed with 502043195 bytes remaining to read\n```\ncurl Error details ([source](https://github.com/curl/curl/blob/acdb48272a53fe97f63e5437fce27c7036a9c43e/docs/libcurl/libcurl-errors.md?plain=1#L128-L132)):\n```\n## CURLE_PARTIAL_FILE (18)\n\nA file transfer was shorter or larger than expected. This happens when the\nserver first reports an expected transfer size, and then delivers data that\ndoes not match the previously given size.\n```\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nget_url\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.16.4]\n  config file = None\n  configured module search path = ['/home/ubuntu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/ubuntu/.local/lib/python3.10/site-packages/ansible\n  ansible collection location = /home/ubuntu/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/ubuntu/.local/bin/ansible\n  python version = 3.10.12 (main, Feb  4 2025, 14:57:36) [GCC 11.4.0] (/usr/bin/python3)\n  jinja version = 3.1.3\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = None\nEDITOR(env: EDITOR) = emacs\n```\n\n### OS / Environment\n\nUbuntu 22.04.5\n\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: \"Download ...\"\n  become_user: \"{{ user }}\"\n  become: yes\n  get_url:\n    url: \"{{ asset_url }}\"\n    dest: \"{{ asset_path }}\"\n```\n\n\n### Expected Results\n\nI expected the entire `1.5GB` file (indicated by `msg\": \"OK (1582232524 bytes)\"` in Actual Results) to be downloaded, but after the task completed without error, the resulting file was only `~1GB` (indicated by `\"size\": 1084682149` in Actual Results)\n\n### Actual Results\n\n```console\nchanged: [arch-local] => {\n    \"changed\": true,\n    \"checksum_dest\": null,\n    \"checksum_src\": \"20f148a25774bcd06637c012ed0f47121ccbd186\",\n    \"dest\": \"<redacted asset_path>\",\n    \"elapsed\": 337,\n    \"gid\": 0,\n    \"group\": \"root\",\n    \"invocation\": {\n\t\"module_args\": {\n            \"attributes\": null,\n            \"backup\": false,\n            \"checksum\": \"\",\n            \"client_cert\": null,\n            \"client_key\": null,\n            \"dest\": \"<redacted asset_path>\",\n            \"force\": false,\n            \"force_basic_auth\": false,\n            \"group\": null,\n            \"headers\": null,\n            \"http_agent\": \"ansible-httpget\",\n            \"mode\": null,\n            \"owner\": null,\n            \"selevel\": null,\n            \"serole\": null,\n            \"setype\": null,\n            \"seuser\": null,\n            \"sha256sum\": \"\",\n            \"timeout\": 10,\n            \"tmp_dest\": null,\n            \"unsafe_writes\": false,\n            \"url\": \"<redacted asset_url>\",\n            \"url_password\": null,\n            \"url_username\": null,\n            \"use_proxy\": true,\n            \"validate_certs\": true\n\t}\n    },\n    \"md5sum\": \"3392ad36d2d6e4ff3b4b3d23e949ab96\",\n    \"mode\": \"0644\",\n    \"msg\": \"OK (1582232524 bytes)\",\n    \"owner\": \"root\",\n    \"size\": 1084682149,\n    \"src\": \"/tmp/.ansible-/ansible-tmp-1741875282.6428506-210-52584486647726/tmperakhngo\",\n    \"state\": \"file\",\n    \"status_code\": 200,\n    \"uid\": 0,\n    \"url\": \"<redacted asset_url>\"\n}\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-13T19:06:45Z",
        "user": "derekenos",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 84822,
        "title": "include_tasks until contradictory documentation",
        "body": "### Summary\n\nThe [attribute](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_tasks_module.html#attributes) documentation of `include_tasks` lists `until` as \"fully supported\", the description there is \"Denotes if this action obeys until/retry/poll keywords\", however in the [parameters](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_tasks_module.html#parameters) section it says\n\n> The do-until loop is not supported.\n\nHow can both be true at the same time?\n\nIn practice include_tasks does **not** support `until` at this time and based on #83896 this is seen as a new feature\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/modules/include_tasks.py\n\n### Ansible Version\n\n```console\n\"latest\" on the docs website.\n```\n\n### Configuration\n\n```console\nnot relevant\n```\n\n### OS / Environment\n\nnot relevant\n\n### Additional Information\n\nRight now the documentation seems to be self contradictory and I was only able to determine the \"true\" statement by trial and error, at first I thought maybe the do-until statement only applies when using the `free-form` but based on my observations and the issue mentioned before it is just not supported.\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-13T13:04:44Z",
        "user": "Keeper-of-the-Keys",
        "labels": [
            "module",
            "has_pr"
        ]
    },
    {
        "number": 84818,
        "title": "[CI] Upgrade Codecov uploader to use API v5",
        "body": "We're currently relying on the version implemented ages ago (#75938). I think it uses v2 API and Codecov has evolved since. Their uploader apps have been rewritten a couple of times too (Python -> JS -> Python).\n\nThe most recent one is https://pypi.org/p/codecov-cli. It now ships with PEP 740 digital attestations bundled. We should look into using it instead and integrate https://pypi.org/p/pypi-attestations to be on top of the supply chain.\n\n@ansibot bot_skip",
        "created_at": "2025-03-12T17:27:21Z",
        "user": "webknjaz",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84817,
        "title": "ansible.builtin.lineinfile and ansible.builtin.blockinfile charset support",
        "body": "### Summary\n\nI'm trying to use `ansible.builtin.lineinfile` and `ansible.builtin.blockinfile` to make changes to a file which is not UTF-8.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible.builtin.lineinfile\nansible.builtin.blockinfile\n\n### Additional Information\n\nSuggested usage (similar to `ansible.builtin.replace`):\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: Set the license \n  ansible.builtin.lineinfile:\n    path: \"{{ conf_path }}/licenses.txt\"\n    line: \"{{ license_key }}\"\n    insertafter: EOF\n    encoding: cp037\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-12T15:11:31Z",
        "user": "roded",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 84805,
        "title": "Implement module_utils caller ID on deprecations",
        "body": "### Fallible Version\n\n2025.3.3\n\n### Summary\n\nDeprecations need to sniff the callstack to augment the captured deprecation context with the actual caller when the deprecation call occurs in shared code from a different collection. Shouldn't be a problem that the messaging points at the currently executing plugin gleaned from PluginExecContext, but the date/version info are misleading if not reported against the collection that actually called the code.\n\nImplement stack walk and comparison with PluginExecContext, adjust messaging accordingly in mixed scenarios.\n\n\n### <!-- Bot instructions (ignore this) -->\n\n<!--\n### Component Name\nbin/ansible\n### Issue Type\nBug Report\n### Ansible Version\n2.19.0.dev0\n### Configuration\n### OS / Environment\n-->\n",
        "created_at": "2025-03-11T02:15:43Z",
        "user": "nitzmahone",
        "labels": [
            "bug",
            "data_tagging",
            "fallible_dt"
        ]
    },
    {
        "number": 84803,
        "title": "Ansible support for dnf --transient on bootc machines",
        "body": "### Summary\n\nDNF has a new [persistence](https://dnf.readthedocs.io/en/stable/conf_ref.html#persistence-label) configuration that allows users to \"transiently\" install packages on bootc (image mode) machines without running `bootc usr-overlay`.  Installing something transiently looks like `dnf install --transient ansible`.\n\nSince bootc machines are now available for general use and DNF has decided to support easily installing packages on running machines, users may soon want to use the Ansible package module for bootc machine patching.\n\nTo take this a step further, I can see it being useful to use the same Ansible scripts to manage both bootc and traditional machines. If transiently installing packages is opt-in, it could cause a lot of Ansible automation to require updates.  I'd be curious to hear thoughts on what would make more sense from an Ansible-perspective.\n\nForeman + Katello are planning on introducing remote execution support soon to make it easy to transiently install packages on machines. Since our remote execution scripts run either shell commands or Ansible, it would be nice to have both options support bootc machines.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible.builtin.package\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\nPerhaps something like:\n```yaml (paste below)\n- name: Install ntpdate\n  ansible.builtin.package:\n    name: ntpdate\n    state: present\n    persistence: transient\n```\nThe question is -- could ansible detect the right persistence and use the correct one accordingly? Or is that dangerous?\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-10T20:02:11Z",
        "user": "ianballou",
        "labels": [
            "module",
            "feature",
            "needs_verified"
        ]
    },
    {
        "number": 84799,
        "title": "Data Tagging: HostVars.raw_get() is no more",
        "body": "### Fallible Version\n\n2025.3.3\n\n### Summary\n\nThe documentation on `HostVars.raw_get()` said:\n```\n        Similar to __getitem__, however the returned data is not run through\n        the templating engine to expand variables in the hostvars.\n```\nThis method has been removed without hints why and no replacement AFAICT.\n\nIt's used by the community.general.merge_variables lookup: https://github.com/ansible-collections/community.general/blob/main/plugins/lookup/merge_variables.py#L160\n\nCC @rlenferink @m-a-r-k-e @alpex8 who authored the plugin and might know more to why `HostVars.raw_get()` is needed there.\n\n### <!-- Bot instructions (ignore this) -->\n\n<!--\n### Component Name\nbin/ansible\n### Issue Type\nBug Report\n### Ansible Version\n2.19.0.dev0\n### Configuration\n### OS / Environment\n-->\n",
        "created_at": "2025-03-09T12:27:50Z",
        "user": "felixfontein",
        "labels": [
            "bug",
            "has_pr",
            "data_tagging",
            "fallible_dt"
        ]
    },
    {
        "number": 84793,
        "title": "Different behavior for `state: restarted` in the `ansible.builtin.service` module (FreeBSD)",
        "body": "### Summary\n\nThe `state: restarted` in the `ansible.builtin.service` module differs from the others (`started`, `stopped` and `reloaded`) of the implementation in FreeBSD:\nhttps://github.com/ansible/ansible/blob/09391f38f009ec58b5759dbd74df34fd281ef3ac/lib/ansible/modules/service.py#L1090-L1099\n\nWith the current implementation `started`, `stopped` and `reloaded` execute the corresponding action even if the service is disabled, only `restarted` will have no effect when the service is disabled.\n\n#### Option 1\nAdd the following part - to be consistent with the rest\n```\nif self.action == \"restart\":\n  self.action = \"onerestart\"\n```\n\n#### Option 2\nOmit the `start`/`stop` modification - to match the documentation\n\n_\n\nI would prefer option 1 but that's just my opinion.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.service\n\n### Ansible Version\n\n```console\n$ ansible --version\nN/A\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nN/A\n```\n\n### OS / Environment\n\nFreeBSD\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: Restart apache24\n  become: true\n  ansible.builtin.service:\n    name: \"apache24\"\n    state: \"restarted\"\n```\n\n\n### Expected Results\n\nN/A\n\n### Actual Results\n\n```console\nN/A\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-07T17:58:02Z",
        "user": "ohaucke",
        "labels": [
            "module",
            "bug",
            "needs_verified"
        ]
    },
    {
        "number": 84790,
        "title": "display interrupted runners",
        "body": "### Summary\n\nIf I run an ansible playbook on a hundred machines and one of them hangs, and I interrupt ansible, I don't get to know which machine it was that blocked up my playbook. the [task executor](https://github.com/ansible/ansible/blob/09391f38f009ec58b5759dbd74df34fd281ef3ac/lib/ansible/executor/task_executor.py#L395) should catch SIGINT and produce a failed `TaskResult` with a relevant message, that way I can exclude that machine using `--limit` `-l`.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ntask_executor\n\n### Additional Information\n\n...\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-06T21:37:20Z",
        "user": "simonLeary42",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 84781,
        "title": "Data Tagging: extending `AnsibleDumper` can result in strange Python errors",
        "body": "### Fallible Version\n\n2025.3.3\n\n### Summary\n\ncommunity.general's `yaml` plugin does (among other things)\n```\nfrom ansible.parsing.yaml.dumper import AnsibleDumper\n\nclass MyDumper(AnsibleDumper):\n    def represent_scalar(self, tag, value, style=None):\n        \"\"\"Uses block style for multi-line strings\"\"\"\n        if style is None:\n            if should_use_block(value):\n                style = '|'\n                # we care more about readable than accuracy, so...\n                # ...no trailing space\n                value = value.rstrip()\n                # ...and non-printable characters\n                value = ''.join(x for x in value if x in string.printable or ord(x) >= 0xA0)\n                # ...tabs prevent blocks from expanding\n                value = value.expandtabs()\n                # ...and odd bits of whitespace\n                value = re.sub(r'[\\x0b\\x0c\\r]', '', value)\n                # ...as does trailing space\n                value = re.sub(r' +\\n', '\\n', value)\n            else:\n                style = self.default_style\n        node = yaml.representer.ScalarNode(tag, value, style=style)\n        if self.alias_key is not None:\n            self.represented_objects[self.alias_key] = node\n        return node\n```\nThis causes the `import` sanity tests to fail with:\n```\n03:54 ERROR: plugins/callback/yaml.py:56:0: traceback: TypeError: function() argument 'code' must be code, not str (0%)\n```\nLine 56 is the line with `class MyDumper(AnsibleDumper):`.\n\n\n### <!-- Bot instructions (ignore this) -->\n\n<!--\n### Component Name\nbin/ansible\n### Issue Type\nBug Report\n### Ansible Version\n2.19.0.dev0\n### Configuration\n### OS / Environment\n-->\n",
        "created_at": "2025-03-05T20:19:49Z",
        "user": "felixfontein",
        "labels": [
            "bug",
            "has_pr",
            "data_tagging",
            "fallible_dt"
        ]
    },
    {
        "number": 84780,
        "title": "Data Tagging: errors reported by filter plugins result in excessively long and complex messages",
        "body": "### Fallible Version\n\n2025.3.3\n\n### Summary\n\nNot really a bug, but I'm not sure whether this is fully intentional:\n\nWhen a filter plugin raises exceptions of type `AnsibleFilterTypeError` or `AnsibleFilterError`, excessive error reports are created that are quite confusing for users IMO.\n\nFor example (seen in https://github.com/ansible-collections/community.routeros/pull/346):\n```\n\nTASK [filter_quoting : Test split filter error handling] ***********************\ntask path: /root/ansible_collections/community/routeros/tests/output/.tmp/integration/filter_quoting-q7spxqnm-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/filter_quoting/tasks/main.yml:14\n[ERROR]: Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for 'test': The filter plugin 'community.routeros.split' failed: Unexpected end of string during escaped parameter\n\nTask failed.\nOrigin: /root/ansible_collections/community/routeros/tests/output/.tmp/integration/filter_quoting-q7spxqnm-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/filter_quoting/tasks/main.yml:14:3\n\n12         'foo bar=\"a b c\"' | community.routeros.split == ['foo', 'bar=a b c']\n13\n14 - name: \"Test split filter error handling\"\n     ^ column 3\n\n<<< caused by >>>\n\nFinalization of task args for 'ansible.builtin.set_fact' failed.\nOrigin: /root/ansible_collections/community/routeros/tests/output/.tmp/integration/filter_quoting-q7spxqnm-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/filter_quoting/tasks/main.yml:15:3\n\n13\n14 - name: \"Test split filter error handling\"\n15   set_fact:\n     ^ column 3\n\n<<< caused by >>>\n\nError while resolving value for 'test': The filter plugin 'community.routeros.split' failed: Unexpected end of string during escaped parameter\nOrigin: /root/ansible_collections/community/routeros/tests/output/.tmp/integration/filter_quoting-q7spxqnm-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/filter_quoting/tasks/main.yml:16:11\n\n14 - name: \"Test split filter error handling\"\n15   set_fact:\n16     test: >-\n             ^ column 11\n\nfatal: [testhost]: FAILED! => {\n    \"changed\": false,\n    \"msg\": \"Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for 'test': The filter plugin 'community.routeros.split' failed: Unexpected end of string during escaped parameter\"\n}\n...ignoring\n```\nThis is generated by\n```yaml\n- name: \"Test split filter error handling\"\n  set_fact:\n    test: >-\n      {{ 'a=\"' | community.routeros.split }}\n  ignore_errors: true\n  register: result\n```\n\n### <!-- Bot instructions (ignore this) -->\n\n<!--\n### Component Name\nbin/ansible\n### Issue Type\nBug Report\n### Ansible Version\n2.19.0.dev0\n### Configuration\n### OS / Environment\n-->\n",
        "created_at": "2025-03-05T20:16:08Z",
        "user": "felixfontein",
        "labels": [
            "bug",
            "data_tagging",
            "fallible_dt"
        ]
    },
    {
        "number": 84778,
        "title": "Feature: Ansible Facts Should Gather NetworkManager UUID",
        "body": "### Summary\n\nA large swatch of hosts use NetworkManager or other facility that create a UUID in the network connections. This information is used in a wide array of automations. Currently the work around is to use the command module and do a lot of filtering.\n\nFor example, setting `/etc/NetworkManager/system-connections/*.nmconnection` files often require the UUID in order to be associated properly with the appropriate network card.\n\nsome psuedo code might be\n\n```\nif os.path.exists(\"/usr/bin/nmcli\")\n    rc, out, err = module.run_command(['nmcli', '-t', '-f', 'UUID,DEVICE', 'con', 'show'])\n    if rc == 0:\n        for line in out.splitlines():\n            uuid, device = line.split(':')\n            uuids[device] = uuid.strip()\n```\n\nThis would provide valuable information for configuration of hosts\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nlib/ansible/module_utils/facts/network/linux.py\n\n### Additional Information\n\nWhen attempting to setup more complicated network setup such as a bridge on top of a bond, the most reliable path is to process a jinja template\n\n```\n[connection]\nuuid={{ interface_uuid  }}\nid={{ interface }}\ntype=ethernet\ninterface-name={{ interface }}\nautoconnect=true\n\n[ipv6]\nmethod=disabled\n```\n\nAnd then create the bond and bridge files. Configuration of interfaces in this fashion is desirable for a lot of folks who have a desire to standardize the deployment without using things like the community `nmcli` module which adds complexity and is not ideal in some environments\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-05T16:44:28Z",
        "user": "stratus-ss",
        "labels": [
            "feature",
            "P3"
        ]
    },
    {
        "number": 84768,
        "title": "Task async handling does not error on network issues",
        "body": "### Summary\n\nHi,\nI've noticed that running a task with async means network issues are ignored. I am unsure if this is by design or wanted; my expectations were it would error out if polling failed.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ntask_executor\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.3]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/home/username/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/username/ansible-2.18-venv/lib64/python3.12/site-packages/ansible\n  ansible collection location = /home/username/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/username/ansible-2.18-venv/bin/ansible\n  python version = 3.12.8 (main, Dec  9 2024, 15:25:01) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/home/username/ansible-2.18-venv/bin/python)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n\nGALAXY_SERVERS:\n```\n\n### OS / Environment\n\nRHEL 8.10\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: Reproducer async does not notice server gone\n  hosts: all\n  gather_facts: true\n\n  tasks:\n    - name: Sleep for 3 hours\n      ansible.builtin.command: sleep 3h\n      async: 7200\n      poll: 60\n```\n\nNote: if you are running with ssh connection persistence you may need to chose a value higher than your timeout in order to notice this. Otherwise the same open connection will be used.\n\nAfter executing this with -vv you will notice that it does a POLL every 60 seconds like this:\nASYNC POLL on host.tld: jid=j285098950535.3387392 started=1 finished=0\n\nNow on the target I'll just drop everything from the control nodes source IP (example IP 1.1.1.1)\n\n`firewall-cmd --add-rich-rule='rule family=\"ipv4\" source address=\"1.1.1.1\" drop'`\n\nNow polling no longer works.\n\n### Expected Results\n\nI expected async to error because polls no longer succeed.\n\n### Actual Results\n\n```console\nAsync keeps running until the limit in `async:` is reached.\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-03-04T11:03:20Z",
        "user": "Klaas-",
        "labels": [
            "bug",
            "needs_verified",
            "affects_2.18"
        ]
    },
    {
        "number": 84756,
        "title": "support (or don't support) freeform parameters with `--extra-vars`",
        "body": "### Summary\n\nif you use a string for your `--extra-vars` that doesn't start with `{` or `[` and doesn't contain `=`, this is considered by the `parse_kv` splitter as a \"free-form parameter\", and gets thrown into a variable `_raw_params`, which is meant to be used by some modules to support a more terse syntax ([source code](https://github.com/ansible/ansible/blob/4a710587ddd043ee729d85ab987c85193f9885c7/lib/ansible/parsing/splitter.py#L88-L91)). If you use multiple such `--extra-vars`, The global `_raw_params` variable stores only the last one.\n```console\n$ ansible localhost -e foobar -m debug -a 'var=foobar'\nlocalhost | SUCCESS => {\n    \"foobar\": \"VARIABLE IS NOT DEFINED!\"\n}\n```\n\n```console\n$ ansible localhost -e foobar -m debug -a 'var=_raw_params'\nlocalhost | SUCCESS => {\n    \"_raw_params\": \"foobar\"\n}\n```\n\n```console\n$ ansible localhost -e foobar -e barfoo -m debug -a 'var=_raw_params'\nlocalhost | SUCCESS => {\n    \"_raw_params\": \"barfoo\"\n}\n```\n\nI think it would be a nice feature if free form `--extra-args` would set the specified variable to `true`. Currently the only way to set a variable to `true` from the command line involves typing out a whole JSON dictionary in a shell argument, avoiding quotation issues.\n\nI think free form `--extra-vars` should at least be an error if it won't be supported. Storing a CLI arg as global `_raw_params` and clobbering CLI args over each other isn't very good behavior.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nsplitter\n\n### Additional Information\n\nAt my workplace we do something sort of like `-e run_special_tasks=true`, and then reference that variable using `when: run_special_tasks | default(false) | bool`. This has issues:\n* `to_bool` assumes literally anything is false except for a short list of truey strings and `1`. this means that `2` is false, `\"lorem ipsum\"` is false, lists are false, dictionaries are false. [source code](https://github.com/ansible/ansible/blob/4a710587ddd043ee729d85ab987c85193f9885c7/lib/ansible/plugins/filter/core.py#L83)\n* we have to remember to never reference the value of this variable without type casting it first. We can also create a second variable that contains the boolean value of the 1st, but then we have to remember never to use the 1st. How can this be enforced? Custom extensions to `ansible-lint`?\n\nInstead, if this was supported, we could do `-e  run_special_tasks`, and reference that variable as `when: run_special_tasks | default(false)`. I think this would be intuitive and elegant.\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-26T17:12:12Z",
        "user": "simonLeary42",
        "labels": [
            "easyfix",
            "has_pr",
            "feature",
            "P3"
        ]
    },
    {
        "number": 84751,
        "title": "`ansible-pull` always runs locally",
        "body": "### Summary\n\nWhen running the `ansible-pull` command, the subsequent `ansible-playbook` is apparently executed with [hardcoded connection](https://github.com/ansible/ansible/blob/5ff8d093f07344abbd35942c1a03bab1d84dfeb3/lib/ansible/cli/pull.py#L178) argument set to `local`.\n\nThis is very confusing when the docs for `ansible-pull` [mention](https://docs.ansible.com/ansible/latest/cli/ansible-pull.html#cmdoption-ansible-pull-l) the option to limit the execution to a subset of hosts. Knowing the command is fixed to local connection, I wonder what the use case of that argument could be.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\npull\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.14.17]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/bin/ansible\n  python version = 3.9.18 (main, Aug 23 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/usr/bin/python3)\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nDEFAULT_ACTION_PLUGIN_PATH(env: ANSIBLE_ACTION_PLUGINS) = ['/usr/local/lib/python3.9/site-packages/ara/plugins/action']\nDEFAULT_CALLBACK_PLUGIN_PATH(env: ANSIBLE_CALLBACK_PLUGINS) = ['/usr/local/lib/python3.9/site-packages/ara/plugins/callback']\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['/etc/ansible/hosts']\nDEFAULT_LOOKUP_PLUGIN_PATH(env: ANSIBLE_LOOKUP_PLUGINS) = ['/usr/local/lib/python3.9/site-packages/ara/plugins/lookup']\nDEFAULT_VAULT_PASSWORD_FILE(/etc/ansible/ansible.cfg) = /home/ansible/.ansible/vault\nDIFF_ALWAYS(/etc/ansible/ansible.cfg) = True\nDISPLAY_SKIPPED_HOSTS(/etc/ansible/ansible.cfg) = False\nMAX_FILE_SIZE_FOR_DIFF(/etc/ansible/ansible.cfg) = 10485760\n\nCALLBACK:\n========\n\ndefault:\n_______\ndisplay_skipped_hosts(/etc/ansible/ansible.cfg) = False\n\nCONNECTION:\n==========\n\nssh:\n___\npipelining(/etc/ansible/ansible.cfg) = True\n```\n\n### OS / Environment\n\nRed Hat Enterprise Linux release 9.4 (Plow)\n\n### Steps to Reproduce\n\n```console\nansible-pull -d /etc/ansible -U <<URL>> --clean --diff -l all site.yml\n```\n\n\n### Expected Results\n\nI expected the command to do a git checkout and then run `ansible-playbook` on all the nodes selected by the `limit` argument.\n\n### Actual Results\n\nThe command executes all tasks, even the ones strictly for other nodes, on the local node. \n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-25T12:00:36Z",
        "user": "Hipska",
        "labels": [
            "bug",
            "docs",
            "affects_2.14"
        ]
    },
    {
        "number": 84732,
        "title": "copy module does not preserve file ownership",
        "body": "### Summary\n\nI just encountered the issue described in https://github.com/ansible/ansible/pull/81592, which was closed indicating it's a doc bug that has been fixed.  However, looking at the latest docs (https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html), and under \"owner,\" is says:\n\nWhen left unspecified, it uses the current user unless you are root, in which case it can preserve the previous ownership.\n\nBut it DOES NOT preserve the previous ownership if left unspecified (as illustrated in the issue).  More accurate wording, imo, is simply:\n\nWhen left unspecified, it uses the current user.\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/modules/copy.py\n\n### Ansible Version\n\n```console\nansible --version\nansible [core 2.15.8]\n  config file = /home/rowagn/git/oracle-core/automation/ansible/client/ansible.cfg\n  configured module search path = ['/home/rowagn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /sso/sfw/virtualenv/ansible2_15_8/lib/python3.9/site-packages/ansible\n  ansible collection location = /home/rowagn/.ansible/collections:/usr/share/ansible/collections\n  executable location = /sso/sfw/virtualenv/ansible2_15_8/bin/ansible\n  python version = 3.9.18 (main, Jul 18 2024, 11:58:42) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/sso/sfw/virtualenv/ansible2_15_8/bin/python3)\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n### Configuration\n\n```console\nansible-config dump --only-changed\nCONFIG_FILE() = /home/rowagn/git/oracle-core/automation/ansible/client/ansible.cfg\nDEFAULT_EXECUTABLE(/home/rowagn/git/oracle-core/automation/ansible/client/ansible.cfg) = /etc/ansible-wrapper\nDEFAULT_TIMEOUT(/home/rowagn/git/oracle-core/automation/ansible/client/ansible.cfg) = 20\nEDITOR(env: EDITOR) = /bin/vim\nPAGER(env: PAGER) = /bin/less\nRETRY_FILES_ENABLED(/home/rowagn/git/oracle-core/automation/ansible/client/ansible.cfg) = False\n```\n\n### OS / Environment\n\ncat /etc/redhat-release\nRed Hat Enterprise Linux release 8.10 (Ootpa)\n\n\n### Additional Information\n\nIf this doc were improved, it would prevent folks from running into the issue described in https://github.com/ansible/ansible/pull/81592 (i.e., where we try to preserve ownership of copied files and it does not work).\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-19T18:36:05Z",
        "user": "rwagnergit",
        "labels": [
            "module",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 84726,
        "title": "_set_composite_vars doesn't support disable_lookups handling.",
        "body": "### Summary\n\nThe `_set_composite_vars` method of the Constructable class of the inventory plugin don't have disable_lookups in its parameters. Therefore, when this method calls the `_compose` function of the same class, it always does so with disable_lookups=True.\n\n```\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/inventory/__init__.py#L334\n\ndef _compose(self, template, variables, disable_lookups=True):\n        \"\"\" helper method for plugins to compose variables for Ansible based on jinja2 expression and inventory vars\"\"\"\n        t = self.templar\n```\n\n\n```\n## https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/inventory/__init__.py#L356\n\ndef _set_composite_vars(self, compose, variables, host, strict=False):\n        \"\"\" loops over compose entries to create vars for hosts \"\"\"\n        if compose and isinstance(compose, dict):\n            for varname in compose:\n                try:\n                    composite = self._compose(compose[varname], variables)\n      .....\n```\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nplugin inventory\n\n### Additional Information\n\n- AWS Inventory plugin for ansible use this function:\nhttps://github.com/ansible-collections/amazon.aws/blob/main/plugins/inventory/aws_ec2.py#L788\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-18T09:17:19Z",
        "user": "jpaniorte",
        "labels": [
            "feature",
            "data_tagging"
        ]
    },
    {
        "number": 84683,
        "title": "Make `constructed` inventory to comply with `TRANSFORM_INVALID_GROUP_CHARS` setting",
        "body": "### Summary\n\nAdd a flag in `constructed` inventory so that it can be changed to respect `TRANSFORM_INVALID_GROUP_CHARS` setting. It should by default, IMO, but obviously this is yet another case where unexpected behavior can not be fixed for backward compatibility reasons.\n\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nconstructed\n\n### Additional Information\n\nOften (maybe even most of the time) I would like to group hosts exclusively so that host belongs to exactly one group of certain set of groups. For example, by cloud they are in, or server cluster, or whatever. If I don't care about DRY or minimalism I could just list hosts in the groups they belong to, but that way group membership is never exclusive (\"exclusive\" meaning that host would be a member of at most/exactly one group of a set of groups). This means that I should also take into account what happens when some host is accidentally listed on multiple groups at the same time. Together with the fact that each host is identified by `inventory_hostname`, and treated as one and the same when mentioned multiple times in inventory, makes this very possible to happen if inventory is somewhat big.\n\n`constructed` inventory offers almost tolerable solution for this. I can use tokenized `inventory_hostname` as a rule for group membership. For example:\n\n```\ngroup-a1.group-b1.aaa # Use reverse FQDN -like names so that inventory is easier to read\n```\n, and then I would configure `constructed` -inventory to add host into groups specified by `n-1` of `n` dot-separated tokens. This makes it less likely that host would be accidentally assigned to multiple exclusive groups (e.g. also in groups `group-a4` and `group-b3`, even though host is supposed to be a member of exactly one `group-a[0-9]+` group and exactly one `group-b[0-9]+` group), especially if we don't manually set group membership in inventory at all.\n\nHowever, `constructed` inventory always converts `[^a-zA-Z0-9_]` to `_`, regardless of `TRANSFORM_INVALID_GROUP_CHARS` -setting. This is inconvenient (as is the whole push to allow only valid python identifiers as group names IMHO), for various reasons. For example, usually those group names come from outside of my Ansible project, and it makes a) using converted names awkward when writing inventory and b) mapping groups with their \"real life\" counterparts more complex.\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-07T14:25:59Z",
        "user": "hmontone",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 84679,
        "title": "ansible.builtin.template module - evaluating unused code branches",
        "body": "### Summary\n\nWhat weird voodoo is happening here and why is the behaviour different between Ansible with Jinja2 and native Jinja2 for the same template?\n\n```jinja2\n{% if false %}\n  {{ \"string\"|invalid_filter }}\n{% endif %}\n```\n\n```\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: . Could not load \"ddddd\": 'ddddd'\nfatal: [hostname]: FAILED! => changed=false\n  msg: |-\n    AnsibleError: template error while templating string: Could not load \"invalid_filter\": 'invalid_filter'. String:\n    {% if false %}\n      {{ \"string\"|invalid_filter }}\n    {% endif %}\n    . Could not load \"invalid_filter\": 'invalid_filter'\n```\n\nThe same works perfectly fine using Jinja2 outside of Ansible as it doesn't evaluate the code block as the condition is false, but Ansible is doing something different. This makes the `is filter` test pretty useless, if we then attempt to use that filter within the code branch?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.template\n\n### Ansible Version\n\n```console\nansible [core 2.18.2]\n  config file = /xxx/yyy/ansible.cfg\n  configured module search path = ['/home/aaa/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /xxx/python3/lib64/python3.12/site-packages/ansible\n  ansible collection location = /xxx/python3/ansible\n  executable location = /xxx/python3/bin/ansible\n  python version = 3.12.6 (main, Sep 23 2024, 09:58:19) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/xxx/python3/bin/python3)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n### Configuration\n\n```console\nCOLLECTIONS_PATHS(/xxx/yyy/ansible.cfg) = ['/xxx/python3/ansible']\nCONFIG_FILE() = /xxx/yyy/ansible.cfg\nDEFAULT_LOAD_CALLBACK_PLUGINS(/xxx/yyy/ansible.cfg) = True\nDEFAULT_STDOUT_CALLBACK(/xxx/yyy/ansible.cfg) = community.general.yaml\nDEFAULT_VAULT_PASSWORD_FILE(/xxx/yyy/ansible.cfg) = /home/aaa/.ansible/.vault_password\nDISPLAY_SKIPPED_HOSTS(/xxx/yyy/ansible.cfg) = False\nDUPLICATE_YAML_DICT_KEY(/xxx/yyy/ansible.cfg) = error\nEDITOR(env: EDITOR) = vim\nHOST_KEY_CHECKING(/xxx/yyy/ansible.cfg) = False\nINTERPRETER_PYTHON(/xxx/yyy/ansible.cfg) = /xxx/python3/bin/python3\n\nGALAXY_SERVERS:\n\n\nCALLBACK:\n========\n\ndefault:\n_______\ndisplay_skipped_hosts(/xxx/yyy/ansible.cfg) = False\n\nCONNECTION:\n==========\n\nparamiko_ssh:\n____________\nhost_key_checking(/xxx/yyy/ansible.cfg) = False\n\nssh:\n___\nhost_key_checking(/xxx/yyy/ansible.cfg) = False\n```\n\n### OS / Environment\n\nRHEL 8.10 with Python 3.12 Virtual Environment\n\n\n\n### Steps to Reproduce\n\nSee Summary\n\n### Expected Results\n\nI would expect the same behaviour as native Jinja2 and for Ansible not to evaluate the block if the conditional is false. I can't even work out how I can replicate this behaviour with Jinja2 as you normally pass the whole template to Jinja2, unless Ansible is chopping it up and evaluating it in separate sections?\n\n### Actual Results\n\n```console\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: . Could not load \"ddddd\": 'ddddd'\nfatal: [hostname]: FAILED! => changed=false\n  msg: |-\n    AnsibleError: template error while templating string: Could not load \"invalid_filter\": 'invalid_filter'. String:\n    {% if false %}\n      {{ \"string\"|invalid_filter }}\n    {% endif %}\n    . Could not load \"invalid_filter\": 'invalid_filter'\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-06T12:46:25Z",
        "user": "cmason3",
        "labels": [
            "module",
            "bug",
            "data_tagging",
            "affects_2.18"
        ]
    },
    {
        "number": 84668,
        "title": "dnf module - dnf group install fails without erroring when state: latest",
        "body": "### Summary\n\nWhen attempting to install dnf groups with the state:latest parameter it returns\"Group X upgraded\" with no packages installed instead of the installing the latest packages in the group. Additionally I am using the installroot: parameter to a separate filesystem.\n\nChanging the state to present installs the group content successfully. I tested locally on two systems with the dnf command individually to see if this matched the dnf group install procedure.\n\nSystem 1 with known group installed\n```\n$ dnf group upgrade base\n\n=========================================================================================================================================================================================================================\n Package                                     Architecture                                Version                                                Repository                                                          Size\n=========================================================================================================================================================================================================================\nUpgrading:\n bzip2                                       x86_64                                      1.0.6-28.el8_10                                        rhel-8-for-x86_64-baseos-rpms                                       60 k\n strace                                      x86_64                                      5.18-2.1.el8_10                                        rhel-8-for-x86_64-baseos-rpms                                      1.4 M\nUpgrading Groups:\n Base\n\nTransaction Summary\n=========================================================================================================================================================================================================================\nUpgrade  2 Packages\n```\nVS\n```\n$ dnf group install base\n\n=========================================================================================================================================================================================================================\n Package                                    Architecture                               Version                                                Repository                                                            Size\n=========================================================================================================================================================================================================================\nUpgrading:\n bzip2                                      x86_64                                     1.0.6-28.el8_10                                        rhel-8-for-x86_64-baseos-rpms                                         60 k\n strace                                     x86_64                                     5.18-2.1.el8_10                                        rhel-8-for-x86_64-baseos-rpms                                        1.4 M\nInstalling group/module packages:\n rhc                                        x86_64                                     1:0.2.5-1.el8_10                                       rhel-8-for-x86_64-appstream-rpms                                      11 M\nInstalling Groups:\n Base\n\nTransaction Summary\n=========================================================================================================================================================================================================================\nInstall  1 Package\nUpgrade  2 Packages\n```\n\nSystem 2 with known group not installed\n```\n$ dnf group upgrade xfce\n\nModule or Group 'xfce' is not installed.\nError: No group marked for upgrade.\n```\nVS\n```\n$ dnf group install xfce\n\n=========================================================================================================================================================================================================================\n Package                                                 Architecture                           Version                                           Repository                                                        Size\n=========================================================================================================================================================================================================================\nInstalling group/module packages:\n Thunar                                                  x86_64                                 4.16.8-1.el8                                     epel_8-x86_64-rpms                                          1.6 M\n ...etc\nInstalling dependencies:\n atkmm                                                   x86_64                                 2.24.2-7.el8                                      rhel-8-for-x86_64-appstream-rpms                                  92 k\n... etc\nInstalling Groups:\n Xfce\n\nTransaction Summary\n=========================================================================================================================================================================================================================\nInstall  34 Packages\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ndnf\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.16.3]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/bin/ansible\n  python version = 3.12.8 (main, Dec  9 2024, 15:25:01) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3.12)\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n### OS / Environment\n\nRHEL 8 System targeted via Ansible Automation Platform\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n    - name: Install package groups\n      ansible.builtin.dnf:\n        name: \"{{ all_pkg_groups | join(',') }}\"\n        installroot: \"{{ image_build_directory }}/\"\n        state: latest\n      vars:\n        all_pkg_groups: \"{{ pkg_groups.values() | map('flatten') | list | flatten }}\"\n```\n\n\n### Expected Results\n\nExpected latest version of dnf group content to be installed. Or if matching the dnf group upgrade procedure it should fail. \n\nPossibly related to the bug mention on the documentation where it mentions dnf\u2019s API doesn\u2019t properly mark groups as installed.\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1620324\n\n### Actual Results\n\n```console\n{\n  \"msg\": \"Nothing to do\",\n  \"changed\": false,\n  \"results\": [\n    \"Group development upgraded.\",\n    \"Group debugging upgraded.\",\n    \"Group base upgraded.\",\n...ect\n],\n  \"rc\": 0,\n  \"invocation\": {\n    \"module_args\": {\n      \"name\": [\n        \"@workstation-product-environment\",\n        \"@development\",\n        \"@debugging\",\n        \"@base\",\n...ect\n      ],\n      \"installroot\": \"/mnt/rbd\",\n      \"state\": \"latest\",\n      \"exclude\": [\n        \"gnome-initial-setup\",\n        \"gnome-tour\"\n      ],\n      \"allow_downgrade\": false,\n      \"autoremove\": false,\n      \"bugfix\": false,\n      \"cacheonly\": false,\n      \"disable_gpg_check\": false,\n      \"disable_plugin\": [],\n      \"disablerepo\": [],\n      \"download_only\": false,\n      \"enable_plugin\": [],\n      \"enablerepo\": [],\n      \"install_repoquery\": true,\n      \"install_weak_deps\": true,\n      \"security\": false,\n      \"skip_broken\": false,\n      \"update_cache\": false,\n      \"update_only\": false,\n      \"validate_certs\": true,\n      \"sslverify\": true,\n      \"lock_timeout\": 30,\n      \"allowerasing\": false,\n      \"nobest\": false,\n      \"use_backend\": \"auto\",\n      \"conf_file\": null,\n      \"disable_excludes\": null,\n      \"download_dir\": null,\n      \"list\": null,\n      \"releasever\": null\n    }\n  },\n  \"_ansible_no_log\": false\n}\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-04T23:55:48Z",
        "user": "Evan-Barker-git",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 84657,
        "title": "ansible.builtin.default callback wraps lines",
        "body": "### Summary\n\nWhen moving from the deprecated `community.general.yaml` callback to `ansible.builtin.default` callback with `result_format=yaml` it inserts newlines according to some unknown column value to wrap lines. The test case line was wrapped at 86 characters including the indentation.\n\nBoth the output from `ansible-playbook` to terminal **and to log file** show this unnecessary line wrapping. It is even worse that the log file shows this anomaly.\n\nSeen in:\n\n- `false_condition` lines.\n- Output from at least some modules like `ansible.builtin.systemd`\n\nMy terminal is much wider than 80 columns but still \"some\" lines are wrapped at about 80 characters. \nAnsible already knows how wide my terminal is because it prints the correct amount of `*` at each line such as `PLAY [...]` `TASK [...]` and `PLAY RECAP`. But it still uses some arbitrary (?) about 80 characters for wrapping.\n\nThe callback plugin should not do any line wrapping. Or there should be a way to configure the wrapping to effectively disable it.  \nThere should be no reason ever to wrap lines sent to log file.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.default\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.16.14]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/tmp/al/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/ansible/venv/lib64/python3.11/site-packages/ansible\n  ansible collection location = /tmp/al/collections:/usr/share/ansible/collections\n  executable location = /home/ansible/venv/bin/ansible\n  python version = 3.11.9 (main, Dec  9 2024, 00:00:00) [GCC 11.5.0 20240719 (Red Hat 11.5.0-2)] (/home/ansible/venv/bin/python3.11)\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCACHE_PLUGIN(/etc/ansible/ansible.cfg) = community.general.yaml\nCACHE_PLUGIN_CONNECTION(/etc/ansible/ansible.cfg) = /tmp/.ansible-fact.$USER\nCACHE_PLUGIN_TIMEOUT(/etc/ansible/ansible.cfg) = 5184000\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['ansible.posix.timer']\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 10\nDEFAULT_JINJA2_NATIVE(/etc/ansible/ansible.cfg) = True\nDEFAULT_LOCAL_TMP(/etc/ansible/ansible.cfg) = /tmp/.ansible.user/ansible-local-17765y_vsa96t\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\nDEFAULT_STRATEGY(/etc/ansible/ansible.cfg) = ansible.builtin.free\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 50\nDEFAULT_VAULT_ID_MATCH(/etc/ansible/ansible.cfg) = True\nINJECT_FACTS_AS_VARS(/etc/ansible/ansible.cfg) = False\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto_silent\nRETRY_FILES_SAVE_PATH(/etc/ansible/ansible.cfg) = /tmp/.ansible-retry.user\n\nCACHE:\n=====\n\njsonfile:\n________\n_timeout(/etc/ansible/ansible.cfg) = 5184000\n_uri(/etc/ansible/ansible.cfg) = /tmp/.ansible-fact.user\n\nCALLBACK:\n========\n\ndefault:\n_______\nresult_format(/etc/ansible/ansible.cfg) = yaml\n\nminimal:\n_______\nresult_format(/etc/ansible/ansible.cfg) = yaml\n```\n\n### OS / Environment\n\nEL9\n\n### Steps to Reproduce\n\nSet `callback_result_format=yaml` and use the default callback plugin.\n\nRun `ansible-playbook -vv test.yml` that includes the play:\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: test case\n  ansible.builtin.debug:\n    msg: test message\n  when:\n    - true\n    - not (ansible_check_mode | bool) and ansible_diff_mode | bool and ansible_playbook_python is defined and ansible_play_name is defined\n```\n\n\n### Expected Results\n\nThe resulting `false_condition` that is output should not be line wrapped.\n\nSame can be seen in output from `ansible.builtin.systemd` module, for example on long `ExecStart` lines.\n\n```console\nTASK [test case] **************************************************************************************************************************************************\ntask path: /home/ansible/testing/test-wrap.yml:7\nskipping: [host01] =>\n    false_condition: not (ansible_check_mode | bool) and ansible_diff_mode | bool and ansible_playbook_python is defined and ansible_play_name is defined\n```\n\nNote how Ansible has detected the terminal width correctly and has added `*` characters until the rightmost column of the terminal. The `false_condition` is shorter than this so it should be on one line.\n\nLogging to a file should not be wrapped also, ever.\n\n### Actual Results\n\n```console\nOutput on terminal from test case, notice how false_condition line is wrapped at 86 characters which is way shorter than the amount of * characters on the first line:\n\nTASK [test case] **************************************************************************************************************************************************\ntask path: /home/ansible/testing/test-wrap.yml:7\nskipping: [host01] =>\n    false_condition: not (ansible_check_mode | bool) and ansible_diff_mode | bool and\n        ansible_playbook_python is defined and ansible_play_name is defined\n\n\nExample line wrapped log file output from `ansible.builtin.systemd` module:\n\n        ExecReload: '{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no\n            ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }'\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-02-03T06:38:43Z",
        "user": "bluikko",
        "labels": [
            "bug",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 84651,
        "title": "Data Tagging Post PR Merge Tracker",
        "body": "This is an omnibus issue to track remaining work once #84621 has merged.\n\n@ansibot bot_skip\n",
        "created_at": "2025-01-30T17:26:06Z",
        "user": "nitzmahone",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84640,
        "title": "Review and simplify exception types raised by Jinja plugins",
        "body": "Except in cases where an `obj` reference is required on specific input data, Jinja plugins should not raise Ansible-specific exceptions (eg `AnsibleFilterError`, `AnsibleLookupError`). Ansible-specific exception wrappers will be applied and re-raised automatically by templating infrastructure as needed.\n\nConvert unnecessary usage of Ansible-specific exceptions by Jinja plugin implementations to an appropriate stdlib exception type.\n\n@ansibot bot_skip\n",
        "created_at": "2025-01-30T02:32:23Z",
        "user": "nitzmahone",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84639,
        "title": "Review `fail_json` calls that pass `exception`",
        "body": "Modules should only pass the exception arg to fail_json when working with a deferred exception. In most other cases, the arg should be omitted entirely- this allows automatic traceback capture from either the active exception or the call site.\n\n@ansibot bot_skip\n",
        "created_at": "2025-01-30T02:20:56Z",
        "user": "nitzmahone",
        "labels": [
            "core-internal"
        ]
    },
    {
        "number": 84636,
        "title": "Data Tagging PR Merge Blocking Tracker",
        "body": "This is an omnibus issue to track items blocking merge of #84621.\n\n@ansibot bot_skip",
        "created_at": "2025-01-30T00:49:17Z",
        "user": "nitzmahone",
        "labels": []
    },
    {
        "number": 84635,
        "title": "Data Tagging 2.19 Tracker",
        "body": "This is an omnibus issue to track remaining work for the Data Tagging feature for ansible-core 2.19.\n\n\n@ansibot bot_skip\n",
        "created_at": "2025-01-30T00:43:00Z",
        "user": "nitzmahone",
        "labels": []
    },
    {
        "number": 84634,
        "title": "ansible.builtin.dnf5 throws unhandled runtime error, provides no detail in transaction component that's failing",
        "body": "### Summary\n\nI'm running a pretty basic dnf update task (reduced the host scope to just localhost via `ansible_connection=local` for debugging). It seems I'm running into an issue with my repositories, packages, or otherwise, but I'm getting no information because the dnf5 module seems to be missing an exception.\n\nhttps://github.com/ansible/ansible/blob/2a53b851fee8ebaa07c1341122dd905354659237/lib/ansible/modules/dnf5.py#L778\n\n... and seems to trace back to this in libdnf5 (don't quote me on it):\n\nhttps://github.com/rpm-software-management/dnf5/blob/main/libdnf5/repo/file_downloader.cpp#L215-L217\n\nI couldn't make heads or tails of exactly what files were failing to download, so I couldn't put together a path to reproduce this reliably other than on my machine.\n\nIt might make sense to have someone more experienced with libdnf5 bindings catch the exception and add more verbosity. E.g. the following catches and raises the error so that I don't have a stack trace, but of course, I'm not getting any more or less detail. It's just \"prettier\".\n\n```\n                try:\n                    result = transaction.run()\n                except RuntimeError as e:\n                    self.module.fail_json(\n                        msg=\"Runtime error encountered\",\n                        failures=[\"transaction_error: {}\".format(e)],\n                        rc=1,\n                    )\n```\n\nAlso worth noting that swapping out `transaction.run()` for `transaction.test()` also exhibits the issue. The latter is redundant when calling the former according to documentation, but I figured it might cut out some LoC in libdnf5 that need review, if it's determined that the library should _not_ be raising an exception and should instead get a new transaction result.\n\nIf it helps:\n\n```\n\u276f rpm -qa | grep libdnf5\nlibdnf5-5.2.8.1-3.fc41.x86_64\nlibdnf5-cli-5.2.8.1-3.fc41.x86_64\npython3-libdnf5-5.2.8.1-3.fc41.x86_64\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ndnf5\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.2]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/user/code/ansible/ansible-playbook/lib64/python3.13/site-packages/ansible\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/user/code/ansible/ansible-playbook/bin/ansible\n  python version = 3.13.1 (main, Dec  9 2024, 00:00:00) [GCC 14.2.1 20240912 (Red Hat 14.2.1-3)] (/home/user/code/ansible/ansible-playbook/bin/python3)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nEDITOR(env: EDITOR) = nvim\n\nGALAXY_SERVERS:\n```\n\n### OS / Environment\n\nFedora Linux 41 (Workstation Edition)\n\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n  - name: apply patches to DNF-based systems\n    dnf:\n      name: \"*\"\n      state: latest\n      update_only: yes\n    become: yes\n```\n\nThis is all I can provide, the logs aren't telling me what's failing to download, and I could not narrow down what part of the overall RPM transaction is throwing the error. I avoided running `dnf update` manually so that I could try to narrow it down.\n\n### Expected Results\n\nI expected the module to successfully apply patches, or tell me in more detail what part of my configuration isn't working.\n\n### Actual Results\n\n```console\nTraceback (most recent call last):\n  File \"/home/user/.ansible/tmp/ansible-tmp-1738162193.1835434-35759-201364269042730/AnsiballZ_dnf5.py\", line 107, in <module>\n    _ansiballz_main()\n    ~~~~~~~~~~~~~~~^^\n  File \"/home/user/.ansible/tmp/ansible-tmp-1738162193.1835434-35759-201364269042730/AnsiballZ_dnf5.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/user/.ansible/tmp/ansible-tmp-1738162193.1835434-35759-201364269042730/AnsiballZ_dnf5.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible.modules.dnf5', init_globals=dict(_module_fqn='ansible.modules.dnf5', _modlib_path=modlib_path),\n    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                     run_name='__main__', alter_sys=True)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_ansible.legacy.dnf5_payload_kgkto_bn/ansible_ansible.legacy.dnf5_payload.zip/ansible/modules/dnf5.py\", line 787, in <module>\n  File \"/tmp/ansible_ansible.legacy.dnf5_payload_kgkto_bn/ansible_ansible.legacy.dnf5_payload.zip/ansible/modules/dnf5.py\", line 783, in main\n  File \"/tmp/ansible_ansible.legacy.dnf5_payload_kgkto_bn/ansible_ansible.legacy.dnf5_payload.zip/ansible/modules/dnf5.py\", line 757, in run\n  File \"/usr/lib64/python3.13/site-packages/libdnf5/base.py\", line 891, in run\n    return _base.Transaction_run(self)\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^\nRuntimeError: Failed to download files\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-29T19:21:07Z",
        "user": "komish",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "data_tagging",
            "affects_2.18"
        ]
    },
    {
        "number": 84625,
        "title": "Add type hints to lib/ansible/vars/",
        "body": "### Summary\n\nAdd type hints for lib/ansibe/vars/\n\nShould wait until after https://github.com/ansible/ansible/pull/84621 is merged\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nlib/ansible/vars/\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-28T18:30:21Z",
        "user": "sivel",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 84607,
        "title": "ansible.builtin.service_facts incorrect and simplified state",
        "body": "### Summary\n\nAs indicated in the title, the **`ansible.builtin.service_facts`** module does not accurately report the state of services when the source is **`systemd`**.\n\nOn hosts using **`systemd`**, the state **`exited`** or **`dead`** indicates that the service is inactive. \nHowever, this does not confirm that the service is properly in the **`stopped`** state.\n\nAccording to the code in the **`SystemctlScanService`** class [here](https://github.com/ansible/ansible/blob/e6adddcaf8d4cf46185a90be89a574ba01cc6b84/lib/ansible/modules/service_facts.py#L260C1-L295C127) :\n\n```python\nclass SystemctlScanService(BaseService):\n\n    BAD_STATES = frozenset(['not-found', 'masked', 'failed'])\n\n    def systemd_enabled(self):\n        return is_systemd_managed(self.module)\n\n    def _list_from_units(self, systemctl_path, services):\n\n        # list units as systemd sees them\n        rc, stdout, stderr = self.module.run_command(\"%s list-units --no-pager --type service --all --plain\" % systemctl_path, use_unsafe_shell=True)\n        if rc != 0:\n            self.module.warn(\"Could not list units from systemd: %s\" % stderr)\n        else:\n            for line in [svc_line for svc_line in stdout.split('\\n') if '.service' in svc_line]:\n\n                state_val = \"stopped\"\n                status_val = \"unknown\"\n                fields = line.split()\n\n                # systemd sometimes gives misleading status\n                # check all fields for bad states\n                for bad in self.BAD_STATES:\n                    # except description\n                    if bad in fields[:-1]:\n                        status_val = bad\n                        break\n                else:\n                    # active/inactive\n                    status_val = fields[2]\n\n                service_name = fields[0]\n                if fields[3] == \"running\":\n                    state_val = \"running\"\n\n                services[service_name] = {\"name\": service_name, \"state\": state_val, \"status\": status_val, \"source\": \"systemd\"}\n```\n\nthe service state on hosts is determined by the **`SUB`** parameter from the following command.\n\n```bash\n$ systemctl list-units --no-pager --type service --all --plain\n```\n\nUnfortunately, the **`SUB`** parameter, which is referenced as **`fields[3]`**, is later overridden by the **`state_val`** variable, which is set to **`stopped`** by default at the beginning.\n\nAs a result, this leads to the module always returning only two possible outcomes: **`stopped`** or **`running`**, rather than accurately reporting the true state of the services.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlib/ansible/modules/service_facts.py\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.1]\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.11/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.11.0 (main, Jan 24 2025, 20:49:13) [GCC 11.5.0 20240719 (Red Hat 11.5.0-2)] (/usr/local/bin/python3.11)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = /etc/ansible/ansible.cfg\nDEFAULT_BECOME(/etc/ansible/ansible.cfg) = False\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['/etc/ansible/hosts']\nDEFAULT_REMOTE_USER(/etc/ansible/ansible.cfg) = root\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\n```\n\n### OS / Environment\n\n* CentOS Linux 7\n* CentOS Linux 8\n* CentOS Stream 9\n* Red Hat Enterprise Linux 7\n* Red Hat Enterprise Linux 8\n* Red Hat Enterprise Linux 9\n\n### Steps to Reproduce\n\nThis playbook captures the state of services both before and after kill the rsyslog service. \nAfter kill, the service enters a **`dead`** state, but the **`service_facts`** module reports it as **`stopped`**.\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n# systemd_test.yml\n- name: Test systemd service_facts\n  hosts: localhost\n  gather_facts: no\n\n  # Global Vars\n  vars:\n    servname: \"rsyslog\"\n\n  tasks:\n\n  - name: state of rsyslog now\n    command: systemctl list-units --no-pager --type service --all --plain\n    register: service_list_pre\n\n  - name: set fact\n    set_fact:\n      rsyslog_state_pre: \"{{ service_list_pre.stdout_lines | select('search', servname) | list | first | regex_replace('\\\\s+', ' ') | split(' ') }}\"\n\n  - name: print state from command\n    debug:\n      msg: \"rsyslog is {{ rsyslog_state_pre[3]}}\"\n\n  - name: kill rsyslog\n    command: killall rsyslogd\n\n  - name: new state of rsyslog\n    command: systemctl list-units --no-pager --type service --all --plain\n    register: service_list_post\n\n  - name: set fact\n    set_fact:\n      rsyslog_state_now: \"{{ service_list_post.stdout_lines | select('search', servname) | list | first | regex_replace('\\\\s+', ' ') | split(' ') }}\"\n\n  - name: print new state from command\n    debug:\n      msg: \"rsyslog is {{ rsyslog_state_now[3]}}\"\n\n  - name: populate service facts\n    service_facts:\n\n  - name: print state from service_facts\n    debug:\n      msg: \"rsyslog is {{ ansible_facts['services'].values() | selectattr('name', 'equalto', servname + '.service') | map(attribute='state') }}\"\n```\n\nUnfortunately, I cannot provide an output with the **`-vvv`** option as it exceeds 65536 characters.\n\n### Expected Results\n\nThis module should report the true state of the services without overwriting it.\n\nAccurately determining the state of a service is essential when using Ansible, particularly in enterprise environments.\n\nChanging the existing state field might cause problems for all currently implemented playbooks/roles.\n\nThe best solution would be to add a new value, **`sub_state`**, that reflects the exact state from **`systemctl`**, but only when the source is **`systemd`**.\n\nFor example, like this:\n\n```python\nclass SystemctlScanService(BaseService):\n\n    BAD_STATES = frozenset(['not-found', 'masked', 'failed'])\n\n    def systemd_enabled(self):\n        return is_systemd_managed(self.module)\n\n    def _list_from_units(self, systemctl_path, services):\n\n        # list units as systemd sees them\n        rc, stdout, stderr = self.module.run_command(\"%s list-units --no-pager --type service --all --plain\" % systemctl_path, use_unsafe_shell=True)\n        if rc != 0:\n            self.module.warn(\"Could not list units from systemd: %s\" % stderr)\n        else:\n            for line in [svc_line for svc_line in stdout.split('\\n') if '.service' in svc_line]:\n\n                state_val = \"stopped\"\n                status_val = \"unknown\"\n                fields = line.split()\n\n                # systemd sometimes gives misleading status\n                # check all fields for bad states\n                for bad in self.BAD_STATES:\n                    # except description\n                    if bad in fields[:-1]:\n                        status_val = bad\n                        break\n                else:\n                    # active/inactive\n                    status_val = fields[2]\n\n                service_name = fields[0]\n                sub_state_val = fields[3]\n                if sub_state_val == \"running\":\n                    state_val = \"running\"\n\n                services[service_name] = {\"name\": service_name, \"state\": state_val, \"sub_state\": sub_state_val, \"status\": status_val, \"source\": \"systemd\"}\n```\n\n### Actual Results\n\n```console\nPLAY [Test systemd service_facts] ***********************************************************************************************************************************************\n\nTASK [state of rsyslog now] *****************************************************************************************************************************************************\nchanged: [localhost]\n\nTASK [set fact] *****************************************************************************************************************************************************************\nok: [localhost]\n\nTASK [print state from command] *************************************************************************************************************************************************\nok: [localhost] => {\n    \"msg\": \"rsyslog is running\"\n}\n\nTASK [kill rsyslog] *************************************************************************************************************************************************************\nchanged: [localhost]\n\nTASK [new state of rsyslog] *****************************************************************************************************************************************************\nchanged: [localhost]\n\nTASK [set fact] *****************************************************************************************************************************************************************\nok: [localhost]\n\nTASK [print new state from command] *********************************************************************************************************************************************\nok: [localhost] => {\n    \"msg\": \"rsyslog is dead\"\n}\n\nTASK [populate service facts] ***************************************************************************************************************************************************\nok: [localhost]\n\nTASK [print state from service_facts] *******************************************************************************************************************************************\nok: [localhost] => {\n    \"msg\": \"rsyslog is ['stopped']\"\n}\n\nPLAY RECAP **********************************************************************************************************************************************************************\nlocalhost                  : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-24T20:06:23Z",
        "user": "NomakCooper",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.18"
        ]
    },
    {
        "number": 84604,
        "title": "powershell edition is switched to powershell.exe with become even with pwsh.exe",
        "body": "### Summary\n\nWhen using `PowerShell.7` as the remote configuration for Windows, `become: true` will always use `powershell.exe`, which breaks scripts that only work with PowerShell-7.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nrunas\n\n### Ansible Version\n\n```console\nansible [core 2.17.5]\n  config file = /home/yzhao/ansible/ansible.cfg\n  configured module search path = ['/home/yzhao/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/yzhao/ansible/.venv/lib/python3.12/site-packages/ansible\n  ansible collection location = /home/yzhao/ansible/collections:/usr/share/ansible/collections\n  executable location = /home/yzhao/ansible/.venv/bin/ansible\n  python version = 3.12.3 (main, Sep 11 2024, 14:17:37) [GCC 13.2.0] (/home/yzhao/ansible/.venv/bin/python3)\n  jinja version = 3.1.4\n  libyaml = True\n```\n\n### Configuration\n\n```console\nANSIBLE_HOME(/home/yzhao/ansible/ansible.cfg) = /home/yzhao/ansible\nCONFIG_FILE() = /home/yzhao/ansible/ansible.cfg\nDEFAULT_HOST_LIST(/home/yzhao/ansible/ansible.cfg) = ['/home/yzhao/ansible/hosts', '/home/yzhao/ansible/hosts.local.yml']\n```\n\n### OS / Environment\n\nLinux SB-PC-YZHAO4 5.10.102.1-microsoft-standard-WSL2 #1 SMP Wed Mar 2 00:30:59 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\n\nDistributor ID: Ubuntu\nDescription:    Ubuntu 24.04.1 LTS\nRelease:        24.04\nCodename:       noble\n\n### Steps to Reproduce\n\nUsing `ansible_psrp_configuration_name=PowerShell.7` to explicitly request `pwsh.exe` for the whole session:\n \n```yaml (paste below)\n# pwsh_test.yml\n\n- name: Powershell tests\n  hosts: SB-PC-IPBUILD3.skyboxlabs.com\n  gather_facts: false\n  vars:\n    ansible_psrp_configuration_name: PowerShell.7\n  tasks:\n    - name: Print version\n      ansible.windows.win_powershell:\n        script: echo $PSVersionTable.PSVersion.Major\n      check_mode: false\n```\n\n\n### Expected Results\n\n(some formatting changed for brevity)\n\nExpecting `output` to be `7`.\n```\n$ ansible-playbook pwsh_test.yml --diff -v --check -b\nPLAY [Powershell tests] *****************************************************************************************************************************************************\n\nTASK [Print version] *****************************************************************************************************************************************************\nchanged: [SB-PC-IPBUILD3.skyboxlabs.com] => {\"changed\": true, \"debug\": [], \"error\": [], \"host_err\": \"\", \"host_out\": \"\", \"information\": [], \"output\": [7], \"result\": {}, \"verbose\": [], \"warning\": []}\n\nPLAY RECAP ****************************************************************************************************************************************\nSB-PC-IPBUILD3.skyboxlabs.com : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n```\n\n### Actual Results\n\n```console\nExpecting `output` is `5`.\n\n$ ansible-playbook pwsh_test.yml --diff -vvvv --check -b\nansible-playbook [core 2.17.5]\n  config file = /home/yzhao/ansible/ansible.cfg\n  configured module search path = ['/home/yzhao/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/yzhao/ansible/.venv/lib/python3.12/site-packages/ansible\n  ansible collection location = /home/yzhao/ansible/collections:/usr/share/ansible/collections\n  executable location = /home/yzhao/ansible/.venv/bin/ansible-playbook\n  python version = 3.12.3 (main, Sep 11 2024, 14:17:37) [GCC 13.2.0] (/home/yzhao/ansible/.venv/bin/python3)\n  jinja version = 3.1.4\n  libyaml = True\nUsing /home/yzhao/ansible/ansible.cfg as config file\nsetting up inventory plugins\nLoading collection ansible.builtin from \nhost_list declined parsing /home/yzhao/ansible/hosts as it did not pass its verify_file() method\nscript declined parsing /home/yzhao/ansible/hosts as it did not pass its verify_file() method\nauto declined parsing /home/yzhao/ansible/hosts as it did not pass its verify_file() method\nParsed /home/yzhao/ansible/hosts inventory source with yaml plugin\nsetting up inventory plugins\nhost_list declined parsing /home/yzhao/ansible/hosts.local.yml as it did not pass its verify_file() method\nscript declined parsing /home/yzhao/ansible/hosts.local.yml as it did not pass its verify_file() method\nParsed /home/yzhao/ansible/hosts.local.yml inventory source with yaml plugin\nLoading collection ansible.windows from /home/yzhao/ansible/.venv/lib/python3.12/site-packages/ansible_collections/ansible/windows\nLoading callback plugin default of type stdout, v2.0 from /home/yzhao/ansible/.venv/lib/python3.12/site-packages/ansible/plugins/callback/default.py\nSkipping callback 'default', as we already have a stdout callback.\nSkipping callback 'minimal', as we already have a stdout callback.\nSkipping callback 'oneline', as we already have a stdout callback.\n\nPLAYBOOK: pwsh_test.yml *************************************************************************************************************************************************************************************************************************************************\nPositional arguments: pwsh_test.yml\nverbosity: 4\nconnection: ssh\nbecome: True\nbecome_method: sudo\ntags: ('all',)\ncheck: True\ndiff: True\ninventory: ('/home/yzhao/ansible/hosts', '/home/yzhao/ansible/hosts.local.yml')\nforks: 5\n1 plays in pwsh_test.yml\n\nPLAY [Powershell tests] *************************************************************************************************************************************************************************************************************************************************\n\nTASK [Print version] ****************************************************************************************************************************************************************************************************************************************************\ntask path: /home/yzhao/ansible/pwsh_test.yml:7\nUsing module file /home/yzhao/ansible/.venv/lib/python3.12/site-packages/ansible_collections/ansible/windows/plugins/modules/win_powershell.ps1\nPipelining is enabled.\n<SB-PC-IPBUILD3.skyboxlabs.com> ESTABLISH PSRP CONNECTION FOR USER: adm.yzhao@SKYBOXLABS.COM ON PORT 5985 TO SB-PC-IPBUILD3.skyboxlabs.com\nPSRP: EXEC (via pipeline wrapper)\nchanged: [SB-PC-IPBUILD3.skyboxlabs.com] => {\n    \"changed\": true,\n    \"debug\": [],\n    \"error\": [],\n    \"host_err\": \"\",\n    \"host_out\": \"\",\n    \"information\": [],\n    \"invocation\": {\n        \"module_args\": {\n            \"arguments\": null,\n            \"chdir\": null,\n            \"creates\": null,\n            \"depth\": 2,\n            \"error_action\": \"continue\",\n            \"executable\": null,\n            \"parameters\": null,\n            \"removes\": null,\n            \"script\": \"echo $PSVersionTable.PSVersion.Major\",\n            \"sensitive_parameters\": null\n        }\n    },\n    \"output\": [\n        5\n    ],\n    \"result\": {},\n    \"verbose\": [],\n    \"warning\": []\n}\n\nPLAY RECAP **************************************************************************************************************************************************************************************************************************************************************\nSB-PC-IPBUILD3.skyboxlabs.com : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-24T17:23:47Z",
        "user": "yangskyboxlabs",
        "labels": [
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 84598,
        "title": "Make `ansible-test` show a nice log message on non-executable `runme.sh`",
        "body": "### Summary\n\nI saw ansible-test tracebacking with a `PermissionError` when a `runme.sh` committer forgets to `chmod +x runme.sh`.\n\nLet's process that exception and show a clear error message with instructions for the caller on fixing that mistake.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-test\n\n### Ansible Version\n\n```console\ndevel\n```\n\n### Configuration\n\n```console\nN/A\n```\n\n### OS / Environment\n\nAny CI / testing env.\n\n### Steps to Reproduce\n\nCreate a `chmod -x runme.sh` and run `ansible-test` against that integration target.\n\n### Expected Results\n\nA log message (`AnsibleError`ish?) instead of a traceback.\n\n### Actual Results\n\n```python-traceback\nTraceback (most recent call last):\n  File \"/root/ansible/bin/ansible-test\", line 44, in <module>\n    main()\n  File \"/root/ansible/bin/ansible-test\", line 35, in main\n    cli_main(args)\n  File \"/root/ansible/test/lib/ansible_test/_internal/__init__.py\", line 65, in main\n    main_internal(cli_args)\n  File \"/root/ansible/test/lib/ansible_test/_internal/__init__.py\", line 91, in main_internal\n    args.func(config)\n  File \"/root/ansible/test/lib/ansible_test/_internal/commands/integration/posix.py\", line 48, in command_posix_integration\n    command_integration_filtered(args, host_state, internal_targets, all_targets, inventory_path, pre_target=pre_target, post_target=post_target)\n  File \"/root/ansible/test/lib/ansible_test/_internal/commands/integration/__init__.py\", line 510, in command_integration_filtered\n    command_integration_script(args, host_state, target, test_dir, inventory_path, coverage_manager)\n  File \"/root/ansible/test/lib/ansible_test/_internal/commands/integration/__init__.py\", line 631, in command_integration_script\n    cover_python(args, host_state.controller_profile.python, cmd, target.name, env, cwd=cwd, capture=False)\n  File \"/root/ansible/test/lib/ansible_test/_internal/coverage_util.py\", line 160, in cover_python\n    return intercept_python(args, python, cmd, env, capture, data, cwd)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/ansible/test/lib/ansible_test/_internal/util_common.py\", line 467, in intercept_python\n    return run_command(args, cmd, capture=capture, env=env, data=data, cwd=cwd, always=always)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/ansible/test/lib/ansible_test/_internal/util_common.py\", line 488, in run_command\n    return raw_command(\n           ^^^^^^^^^^^^\n  File \"/root/ansible/test/lib/ansible_test/_internal/util.py\", line 517, in raw_command\n    process = subprocess.Popen(cmd_bytes, env=env_bytes, stdin=stdin, stdout=stdout, stderr=stderr, cwd=cwd)  # pylint: disable=consider-using-with\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/python3.12/subprocess.py\", line 1026, in __init__\n    self._execute_child(args, executable, preexec_fn, close_fds,\n  File \"/usr/lib64/python3.12/subprocess.py\", line 1955, in _execute_child\n    raise child_exception_type(errno_num, err_msg, err_filename)\nPermissionError: [Errno 13] Permission denied: b'./runme.sh'\n```\n\n_Originally posted by @webknjaz in https://github.com/ansible/ansible/pull/80146#discussion_r1925851074_\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-23T18:06:02Z",
        "user": "webknjaz",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 84593,
        "title": "ansible-test is failing if private pypi and credentials in keyring",
        "body": "### Summary\n\nPip is configured to use a private python index forwarding any request to pypi.org if the package is missing in the private pypi.\nThe credentials for this private index are stored in the keyring of the user.\n\nIf we try to run ansible-test on a fresh collection created, the command fails to run completely with an error about keyring problem (`keyring.errors.NoKeyringError`)\n\nThe keyring is using as backend SecretService which need to resolve the unix socket path with the environment variable DBUS_SESSION_BUS_ADDRESS.\n\n`ansible-test` seems to filter this environment variable and consequently the next calls to pip failed because the credentials cannot be retrieved on the keyring backend because of DBUS_SESSION_BUS_ADRESS unset. \n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ntest\n\n### Ansible Version\n\n```console\n$ ansible --version\n\nansible [core 2.18.1]\n  config file = /home/cbouvier/.ansible.cfg\n  configured module search path = ['/home/cbouvier/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/cbouvier/.local/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible\n  ansible collection location = /home/cbouvier/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/cbouvier/.local/bin/ansible\n  python version = 3.12.3 (main, Jan 17 2025, 18:03:48) [GCC 13.3.0] (/home/cbouvier/.local/pipx/venvs/ansible-core/bin/python)\n  jinja version = 3.1.4\n  libyaml = True\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n\nansible-config dump --only-changed -t all\nCONFIG_FILE() = /home/cbouvier/.ansible.cfg\nEDITOR(env: EDITOR) = emacs\nPAGER(env: PAGER) = less\n\nGALAXY_SERVERS:\n```\n\n### OS / Environment\n\nUbuntu 24.04 LTS\n\n```sh\napt list --installed pipx python3-keyring\n```\n\n> Listing... Done\npipx/noble,noble,now 1.4.3-1 all [installed]\npython3-keyring/noble,noble,now 24.3.1-1 all [installed]\n\n```sh\npipx list --short --include-injected | grep 'ansible-core'\n```\n\n> ansible-core 2.18.1\n\n```sh\npipx runpip ansible-core list\n```\n> Package          Version  \n\\----------------  -------  \nansible-core     2.18.1  \nargcomplete      3.5.0  \ncffi             1.17.1  \ncryptography     43.0.1  \ndecorator        5.1.1  \ngssapi           1.8.3  \njaraco.classes   3.4.0  \njaraco.context   6.0.1  \njaraco.functools 4.1.0  \njeepney          0.8.0  \nJinja2           3.1.4  \njmespath         1.0.1  \nkeyring          25.5.0  \nMarkupSafe       2.1.5  \nmore-itertools   10.5.0  \nnetaddr          1.3.0  \npackaging        24.1  \npip              24.3.1  \npyasn1           0.6.1  \npycparser        2.22  \npython-gssapi    0.6.4  \nPyYAML           6.0.2  \nresolvelib       1.0.1  \nSecretStorage    3.3.3  \nsix              1.16.0\n\n\n```sh\nkeyring --list-backend\n```\n>keyring.backends.fail.Keyring (priority: 0)\nkeyring.backends.SecretService.Keyring (priority: 5)  \nkeyring.backends.libsecret.Keyring (priority: 4.8)  \nkeyring.backends.chainer.ChainerBackend (priority: 10)\n\n```sh\nenv | grep \"DBUS\"\n```\n> DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus\n\n```sh\ncat $HOME/.config/pip/pip.conf \n```\n>[global]  \nkeyring-provider = subprocess  \nindex-url = https://my_username@<<private_gitlab_instance>>/api/v4/groups/506/-/packages/pypi/simple/\n\n\n### Steps to Reproduce\n\npip configuration for using a private pypi like the [gitlab documentation](https://docs.gitlab.com/ee/user/packages/pypi_repository/#install-a-pypi-package). The private pypi forwards the requests to pypi.org if the package is not found on the private one.\n\nThe credentials are recorded in the keyring of the system.\n```sh\nkeyring set https://<<private_gitlab_instance>>/api/v4/groups/506/-/packages/pypi/simple/ my_username \n```\n\nconfiguration is working\n```sh\npython3.12 -m venv test_private_pypi\ntest_private_pypi/bin/python -m pip install pip==20.4\n```\n> Looking in indexes: https://****@<<private_gitlab_instance>>/api/v4/groups/506/-/packages/pypi/simple/\nCollecting pip==24.2\n  Using cached pip-24.2-py3-none-any.whl.metadata (3.6 kB)\nUsing cached pip-24.2-py3-none-any.whl (1.8 MB)\nInstalling collected packages: pip\n  Attempting uninstall: pip\n    Found existing installation: pip 24.0\n    Uninstalling pip-24.0:\n      Successfully uninstalled pip-24.0\nSuccessfully installed pip-24.2\n\nNow let's create a new collection with ansible-creator:\n```sh\nmkdir -p $HOME/.ansible/collections/cbouvier/my_awesome_collection && cd $HOME/.ansible/collections/cbouvier/my_awesome_collection\nansible-creator init collection cbouvier.my_awesome_collection\n```\n\nFinally (in the directory `$HOME/.ansible/collections/cbouvier/my_awesome_collection`)\n```sh\nansible-test sanity --local --requirements --python 3.12\n```\nraises an exception `keyring.errors.NoKeyringError`\n> Downloading pip 24.2 bootstrap script: https://ci-files.testing.ansible.com/ansible-test/get-pip-24.2.py\nCached pip 24.2 bootstrap script: /home/cbouvier/.ansible/test/cache/get_pip_24_2.py\nExecute command: /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python /tmp/ansible-test-hrldg0nq-pip.py --disable-pip-version-check pip==24.2 --no-setuptools --no-wheel\nTraceback (most recent call last):\nFile \"/usr/bin/keyring\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 154, in main\n    return cli.run(argv)\n           ^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 75, in run\n    return method()\n           ^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 83, in do_get\n    password = get_password(self.service, self.username)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/core.py\", line 56, in get_password\n    return get_keyring().get_password(service_name, username)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/backends/fail.py\", line 28, in get_password\n    raise NoKeyringError(msg)\n[...]\nkeyring.errors.NoKeyringError: No recommended backend was available. Install a recommended 3rd party backend package; or, install the keyrings.alt package if you want to use the non-recommended backends. See https://pypi.org/project/keyring for details.\nWARNING: 401 Error, Credentials not correct for https://<<private_gitlab_instance>>/api/v4/groups/506/-/packages/pypi/simple/pip/\n\nThe error is confusing because it is not related to the backend availability but the fact that the SecretService backend does not find the dbus unix socket set with the environment variable  DBUS_SESSION_BUS_ADDRESS.\n\nThe full output of the error (with the hostname of the gitlab instance modified) is\n[ansible-test-sanity-error.txt](https://github.com/user-attachments/files/18510415/ansible-test-sanity-error.txt)\n\nIf we try explicitly \n```sh\n/home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python /home/cbouvier/.ansible/test/cache/get_pip_24_2.py --disable-pip-version-check pip==24.2 --no-setuptools --no-wheel\n```\ninstead of\n```\n/home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python /tmp/ansible-test-hrldg0nq-pip.py --disable-pip-version-check pip==24.2 --no-setuptools --no-wheel\n```\nas displayed in the `Execute Command` output \n\nWe can install the package pip==24.2\n\n>Looking in indexes: https://****@<<private_gitlab_instace>>/api/v4/groups/506/-/packages/pypi/simple/\nCollecting pip==24.2\n  Using cached pip-24.2-py3-none-any.whl.metadata (3.6 kB)\nUsing cached pip-24.2-py3-none-any.whl (1.8 MB)\nInstalling collected packages: pip\nSuccessfully installed pip-24.2\n\nAfter cleaning $HOME/.ansible/test and $HOME/.ansible/tmp and adding the environment variable name\nDBUS_SESSION_BUS_ADDRESS in https://github.com/ansible/ansible/blob/03d6209862730daaf131226443cdb98189b911aa/test/lib/ansible_test/_internal/util.py#L678\n\n`ansible-test` run without problem.\n\n[ansible-test-sanity-ok.txt](https://github.com/user-attachments/files/18510458/ansible-test-sanity-ok.txt)\n\n\n### Expected Results\n\n```sh\nansible-test sanity --local --requirements --python 3.12\n```\n\nshould run without raising any exception when keyring is used for getting credentials.\n\nThe result should look like:\n[ansible-test-sanity-ok.txt](https://github.com/user-attachments/files/18510494/ansible-test-sanity-ok.txt)\n\n\n### Actual Results\n\n```console\nConfigured locale: en_US.UTF-8\nCreating container database.\nRead 0 sanity test ignore line(s) for Ansible 2.18 from: tests/sanity/ignore-2.18.txt\nRunning sanity test \"action-plugin-docs\"\nRun command: /home/cbouvier/.local/pipx/venvs/ansible-core/bin/python /home/cbouvier/.local/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible_test/_util/target/tools/virtualenvcheck.py\nRun command: /usr/bin/python3.12 -m venv --without-pip /home/cbouvier/.ansible/test/venv/sanity/3.12/4f53cda1\nCreated Python 3.12 virtual environment using \"venv\": /home/cbouvier/.ansible/test/venv/sanity/3.12/4f53cda1\nInstalling requirements for Python 3.12 [venv]\nStream command with data: /home/cbouvier/.ansible/test/venv/sanity/3.12/4f53cda1/bin/python\nInitializing \"/tmp/ansible-test-3suwalvb-injector\" as the temporary injector directory.\nRun command with data: /home/cbouvier/.ansible/test/venv/sanity/3.12/4f53cda1/bin/python /home/cbouvier/.local/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible_test/_util/controller/sanity/code- ...\nRunning sanity test \"ansible-doc\"\nRun command: /home/cbouvier/.local/pipx/venvs/ansible-core/bin/python /home/cbouvier/.local/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible_test/_util/target/tools/virtualenvcheck.py\nRun command: /usr/bin/python3.12 -m venv --without-pip /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2\nCreated Python 3.12 virtual environment using \"venv\": /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2\nInstalling requirements for Python 3.12 [venv]\nStream command with data: /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python\nDownloading pip 24.2 bootstrap script: https://ci-files.testing.ansible.com/ansible-test/get-pip-24.2.py\nCached pip 24.2 bootstrap script: /home/cbouvier/.ansible/test/cache/get_pip_24_2.py\nExecute command: /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python /tmp/ansible-test-hrldg0nq-pip.py --disable-pip-version-check pip==24.2 --no-setuptools --no-wheel\nTraceback (most recent call last):\n  File \"/usr/bin/keyring\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 154, in main\n    return cli.run(argv)\n           ^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 75, in run\n    return method()\n           ^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 83, in do_get\n    password = get_password(self.service, self.username)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/core.py\", line 56, in get_password\n    return get_keyring().get_password(service_name, username)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/backends/fail.py\", line 28, in get_password\n    raise NoKeyringError(msg)\nkeyring.errors.NoKeyringError: No recommended backend was available. Install a recommended 3rd party backend package; or, install the keyrings.alt package if you want to use the non-recommended backends. See https://pypi.org/project/keyring for details.\nTraceback (most recent call last):\n  File \"/usr/bin/keyring\", line 8, in <module>\n    sys.exit(main())\n             ^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 154, in main\n    return cli.run(argv)\n           ^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 75, in run\n    return method()\n           ^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/cli.py\", line 83, in do_get\n    password = get_password(self.service, self.username)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/core.py\", line 56, in get_password\n    return get_keyring().get_password(service_name, username)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/keyring/backends/fail.py\", line 28, in get_password\n    raise NoKeyringError(msg)\nkeyring.errors.NoKeyringError: No recommended backend was available. Install a recommended 3rd party backend package; or, install the keyrings.alt package if you want to use the non-recommended backends. See https://pypi.org/project/keyring for details.\nWARNING: 401 Error, Credentials not correct for https://<<gitlab_private_instance>>/api/v4/groups/506/-/packages/pypi/simple/pip/\nERROR: Could not find a version that satisfies the requirement pip==24.2 (from versions: none)\nERROR: No matching distribution found for pip==24.2\nA command failed with status 1: /home/cbouvier/.ansible/test/venv/sanity.ansible-doc/3.12/1dcd3ee2/bin/python /tmp/ansible-test-hrldg0nq-pip.py --disable-pip-version-check pip==24.2 --no-setuptools --no-wheel\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-22T19:32:36Z",
        "user": "clbouvier",
        "labels": [
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84579,
        "title": "ansible-galaxy should dedupe collections from python install",
        "body": "### Summary\n\nWhen I run `ansible-galaxy collection list` it lists the same collection as coming from:\n\n* /home/florian/.local/share/pipx/venvs/ansible/lib/python3.13/site-packages/ansible_collections\n* /home/florian/.local/share/pipx/venvs/ansible/lib64/python3.13/site-packages/ansible_collections\n\nThe only difference in this path is `lib` vs `lib64` of my venv. An ls shows that `lib64` is simply a symlink to `lib`:\n```\n$ ls -l /home/florian/.local/share/pipx/venvs/ansible/                                                                                                                                                                                                                                                                                                                              total 28\ndrwxr-xr-x. 1 florian florian   650 13. Jan 13:01 bin\ndrwxr-xr-x. 1 florian florian    20 22. Okt 08:42 include\ndrwxr-xr-x. 1 florian florian    20 22. Okt 08:42 lib\nlrwxrwxrwx. 1 florian florian     3 22. Okt 08:42 lib64 -> lib\n-rw-r--r--. 1 florian florian 19885 16. Jan 14:39 pipx_metadata.json\n-rw-r--r--. 1 florian florian   201 22. Okt 08:42 pyvenv.cfg\n```\n\nIt would be great if ansible-galaxy could dedupe those.\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible-galaxy\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-20T09:59:01Z",
        "user": "apollo13",
        "labels": [
            "easyfix",
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 84573,
        "title": "Force SSH connection loss detection in `reboot` module",
        "body": "### Summary\n\nWhen SSH pipelining is set up without an explicitly configured timeout, the `reboot` action plugin may end up being stuck forever.\n\nThis is something I've faced when newly provisioning a macOS host for our ansible-core-ci (https://github.com/samdoran/ansible-collection-macos/issues/50).\n\nI've hit the problem in a playbook through a collection calling `reboot` but I'm pretty sure just calling `reboot` ad-hoc would be vulnerable to this behavior.\n\nIn this case, `ansible.cfg` had\n```ini\n[ssh_connection]\npipelining = True\nssh_args = -C -o ControlMaster=auto -o ControlPersist=600s\n```\nwhich possibly influenced SSH not detecting connection loss and hanging.\n\nI didn't capture the command before I terminated the play the first time around, but in `htop` I saw something like `shutdown -r +0` being fed into `ssh`. I'm pretty sure that the target host rebooted successfully, but the client did not notice that and kept hanging.\n\nWhen trying to reproduce this with the bare `reboot` module, I've captured the following:\n```console\n$ ps auxxx | grep '[R]eboot'                              \n<user>       2802752  0.0  0.0  15860  7392 pts/19   S+   19:55   0:00 ssh -C -o ControlMaster=auto -o ControlPersist=600s -o StrictHostKeyChecking=no -o Port=9934 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=\"administrator\" -o ConnectTimeout=10 -o ControlPath=\"~/.ansible/cp/e8ee008ecc\" -tt prl-05.host.name.com /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-ajixzanccrkbtxknnzutfuxeptocvfho ; /sbin/shutdown -r +0 \"Reboot initiated by Ansible\"'\"'\"' && sleep 0'\n```\n\nSome googling suggests that using `ServerAliveInterval` should help SSH notice that the connection is gone:\n* https://serverfault.com/a/706477/111608\n* https://stackoverflow.com/q/63085454/595220\n\nAlso, https://github.com/ansible/ansible/issues/62730#issuecomment-537897275 mentions this in conjunction with Windows (`win_reboot` module).\nThe FAQ also suggest setting it: https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#how-do-i-get-ansible-to-notice-a-dead-target-in-a-timely-manner.\n\nhttps://serverfault.com/a/706494/111608 suggests that the server-side session management software is supposed to cleanly finalize the connection by terminating sshd first, but that sometimes does not happen with various `reboot` commands and so the client has no idea.\n\nI've found https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_updates_module.html#notes suggesting that control master should be disabled in addition to server alive interval. It also has an example of scoping this to the task level: https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_updates_module.html#examples.\n\nThose examples were added by @jborean93 in https://github.com/ansible-collections/ansible.windows/pull/536. It's not explicitly spelled out, but I think, it's in response to https://github.com/ansible-collections/ansible.windows/issues/463.\n\nI'm pretty sure the same would be hit by `ansible.builtin.reboot` and `ansible.windows.win_reboot`, not just `ansible.windows.win_updates`, but neither have this documented.\n\nGiven the nature of the issue, I'm pretty sure that it's the same for POSIX.\n\nSo while the workaround seems to be setting `ansible_ssh_args` on the task level, I feel like it might be error-prone and hard to debug.\n\nI think that we should improve the `reboot` action plugin to auto-inject `-o ControlMaster=no -o ServerAliveInterval=30` into `ansible_ssh_args` instead of forcing the user to face this unobvious behavior and guess that a hack is necessary.\n\nAnother idea could be calling `ssh -O stop` to terminate the master process: https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Multiplexing#Ending_Multiplexed_Connections.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nssh, reboot\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.14.1]\n  config file = ~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg\n  configured module search path = ['~/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = ~/.pyenv/versions/3.11.10/envs/ansible-core-ci-pyenv-py3.11.10/lib/python3.11/site-packages/ansible\n  ansible collection location = ~/src/github/ansible/ansible-core-ci/parallels/deploy\n  executable location = ~/.pyenv/versions/ansible-core-ci-pyenv-py3.11.10/bin/ansible\n  python version = 3.11.10 (main, Nov 22 2024, 00:27:45) [GCC 14.2.1 20241116] (~/.pyenv/versions/3.11.10/envs/ansible-core-ci-pyenv-py3.11.10/bin/python)\n  jinja version = 3.1.3\n  libyaml = True\n```\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\n\n[DEPRECATION WARNING]: DEFAULT_GATHER_SUBSET option, the module_defaults \nkeyword is a more generic version and can apply to all calls to the \nM(ansible.builtin.gather_facts) or M(ansible.builtin.setup) actions, use \nmodule_defaults instead. This feature will be removed from ansible-core in \nversion 2.18. Deprecation warnings can be disabled by setting \ndeprecation_warnings=False in ansible.cfg.\nCOLLECTIONS_PATHS(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = ['~/src/github/ansible/ansible-core-ci/parallels/deploy']\nCONFIG_FILE() = ~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg\nDEFAULT_FORCE_HANDLERS(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = True\nDEFAULT_FORKS(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = 20\nDEFAULT_GATHERING(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = smart\nDEFAULT_GATHER_SUBSET(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = ['min']\nDEFAULT_HOST_LIST(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = ['~/src/github/ansible/ansible-core-ci/parallels/deploy/inventory.yml']\nDEFAULT_TRANSPORT(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = ssh\nINJECT_FACTS_AS_VARS(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = False\n\nCALLBACK:\n========\n\ndefault:\n_______\ncheck_mode_markers(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = True\nshow_task_path_on_failure(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = True\n\nCONNECTION:\n==========\n\nparamiko_ssh:\n____________\nssh_args(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=600s\n\nssh:\n___\nhost_key_checking(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = False\npipelining(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = True\nssh_args(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=600s\nssh_transfer_method(~/src/github/ansible/ansible-core-ci/parallels/deploy/ansible.cfg) = scp\n```\n\n### OS / Environment\n\ncontroller: Gentoo Linux\ntarget: macOS 15.2 (24C101)\n\n### Steps to Reproduce\n\nI'm able to reproduce this with\n```console\n$ ansible -m reboot -b macos-hostname\n```\n\nThe process being stuck is\n```console\n$ ps auxxx | grep '[R]eboot'                              \n<user>       2802752  0.0  0.0  15860  7392 pts/19   S+   19:55   0:00 ssh -C -o ControlMaster=auto -o ControlPersist=600s -o StrictHostKeyChecking=no -o Port=9934 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=\"administrator\" -o ConnectTimeout=10 -o ControlPath=\"~/.ansible/cp/e8ee008ecc\" -tt prl-05.host.name.com /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-ajixzanccrkbtxknnzutfuxeptocvfho ; /sbin/shutdown -r +0 \"Reboot initiated by Ansible\"'\"'\"' && sleep 0'\n```\n\n### Expected Results\n\nIt shouldn't get stuck.\n\n### Actual Results\n\n```console\nThe target host reboots, but the action plugin never learns of this, as the original SSH command triggering the reboot blocks its further execution indefinitely, being unable to detect the connection loss.\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-17T18:56:19Z",
        "user": "webknjaz",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 84558,
        "title": "Task timeout breaks failed_when handling in loop tasks",
        "body": "### Summary\n\nIf failed_when is used in a looping task with timeout, a timeout does not correctly register a task failure if there was a success earlier in the loop.\n\nWhen a task timeout is hit, task_executor.py _execute() returns early with failed=True, omitting failed_when_result.\n\nWhen task_result.py is_failed() processes results, if any of the results contain the failed_when_result key then only that key is used to determine if the task failed. So _check_key('failed_when_result') will only find the earlier success of the loop and ignore the timed out result that doesn't have the failed_when_result key.\n\nThis leads to inconsistent handling of task timeouts.\n\nAssuming this is a valid bug, there are a couple approaches to resolve it:\n1. Ensure failed_when_result=True is added on timeout for tasks with failed_when\n2. Modify is_failed() and/or _check_key() to handle results with partial failed_when_result entries.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlib/ansible/executor/task_result.py\nlib/ansible/executor/task_executor.py\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.1]\n  config file = None\n  configured module search path = ['/home/ubuntu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/ubuntu/.local/share/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible\n  ansible collection location = /home/ubuntu/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/ubuntu/.local/bin/ansible\n  python version = 3.12.3 (main, Nov  6 2024, 18:32:19) [GCC 13.2.0] (/home/ubuntu/.local/share/pipx/venvs/ansible-core/bin/python)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = None\n\nGALAXY_SERVERS:\n```\n\n\n### OS / Environment\n\nUbuntu 24.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- hosts: localhost\n  gather_facts: false\n  tasks:\n    - name: Task 1, timeout\n      command: sleep {{ item }}\n      timeout: 2\n      register: status\n      failed_when: status.failed\n      loop: [1, 4]\n\n    - name: Task 2, show status\n      debug:\n        msg: \"Second task was run. Task 1 status: {{ status }}\"\n```\n\n\n### Expected Results\n\nTask 2 should never be run as we will always fail due to the timeout in task 1 for the second loop item.\n\n### Actual Results\n\n```console\nTask 1 is not marked as failed, execution continues. If task 1 was in a rescue block the rescue would never be called.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-15T12:37:06Z",
        "user": "colml",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.18"
        ]
    },
    {
        "number": 84557,
        "title": "Ansible exposes password in fatal error message",
        "body": "### Summary\n\nHello,\n\nI was debugging some code where I needed to clone using the git module. In my case I used credentials stored under Resources in website in order to clone.\n\nWhile debugging and going through the testresult the fatal error message exposed my password. \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngit\n\n### Ansible Version\n\n```console\nAnsible AWX 24.6.2.dev0+g94e5795dfc.d20241107\n(im not an Ansible administrator)\n```\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\n```\n\n### OS / Environment\n\nRaspbian OS\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```\n  ansible.builtin.git:\n    repo: '{{git_user}}:{{git_password}}@https://git.local.net/my_project.git'\n    dest: \"{{ ansible_env.HOME }}/dect_noise_scanner\"\n    accept_hostkey: true\n```\n\n\nThe credentials created is of type Simple Username/Password\nAnd identifier is called \"git\" \n\n\n### Expected Results\n\nPassword completely hidden\n\n### Actual Results\n\n```console\nI have hidden it away as \"MY_EXPOSED_PASSWORD\", which is what showed my informations.\n\nfatal: [it-04182]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/git ls-remote 'shg:********@https://git.local.net/my_project.git' -h refs/heads/HEAD\", \"msg\": \"fatal:********@https' is not supported\", \"rc\": 128, \"stderr\": \"fatal: protocol 'shg:MY_EXPOSED_PASSWORD@https' is not supported\\n\", \"stderr_lines\": [\"fatal: protocol 'shg:MY_EXPOSED_PASSWORD@https' is not supported\"], \"stdout\": \"\", \"stdout_lines\": []}\n```\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-15T12:36:37Z",
        "user": "Stefanhg",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "verified"
        ]
    },
    {
        "number": 84515,
        "title": "play_hosts in vars_prompt is restricted to hosts in play",
        "body": "### Summary\n\nUsing ansible 2.15.13 play_hosts in vars_prompt is restricted to hosts in play\n\n### Issue Type\n\nFeature Request\n\n### Component Name\n\nvars_prompt\n\n### Ansible Version\n\n```console\n$ ansible --version\nansible [core 2.18.1]\n  config file = None\n  configured module search path = ['/home/cloud-user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /tmp/ansible3.12/lib64/python3.12/site-packages/ansible\n  ansible collection location = /home/cloud-user/.ansible/collections:/usr/share/ansible/collections\n  executable location = /tmp/ansible3.12/bin/ansible\n  python version = 3.12.5 (main, Dec  3 2024, 00:00:00) [GCC 11.5.0 20240719 (Red Hat 11.5.0-2)] (/tmp/ansible3.12/bin/python3.12)\n  jinja version = 3.1.5\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\n$ ansible-config dump --only-changed -t all\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nRocky 9\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n---\n\n- hosts: overcloud\n  gather_facts: false\n  vars_prompt:\n    - name: confirm_deprovision\n      prompt: |\n        The following hosts will be deprovisioned:\n        {{ play_hosts | join(', ') }}\n        If you want to proceed type: yes\n      default: \"no\"\n      private: false\n  tasks:\n    - debug:\n        var: play_hosts\n```\n\ninventory:\n```\nhost1 ansible_connection=local\n\n[overcloud]\nhost2 ansible_connection=local\n```\n\n```\n$ ansible-playbook -i /tmp/inventory /tmp/test.yml\n```\n\n\n### Expected Results\n\nplay_hosts in vars_prompt matches play_hosts in tasks\n\n### Actual Results\n\n```console\n(kayobe-venv) [cloud-user@kayobe-dev kayobe]$ ansible-playbook -i /tmp/inventory /tmp/test.yml\nThe following hosts will be deprovisioned:\nhost1, host2\nIf you want to proceed type: yes\n [no]: no\n\nPLAY [overcloud] *********************************************************************************************************************************************************************************************************************************************\n\nTASK [debug] *************************************************************************************************************************************************************************************************************************************************\nok: [host2] => {\n    \"play_hosts\": [\n        \"host2\"\n    ]\n}\n\nPLAY RECAP ***************************************************************************************************************************************************************************************************************************************************\nhost2                      : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-06T13:10:56Z",
        "user": "jovial",
        "labels": [
            "feature",
            "affects_2.15",
            "affects_2.18"
        ]
    },
    {
        "number": 84505,
        "title": "Update collection loader `__package__` and `__loader__` handling",
        "body": "### Summary\r\n\r\nSetting the `__package__` attribute on modules has been deprecated for awhile. It may be largely deactivated in Python 3.14, and [will be removed in Python 3.15](https://docs.python.org/3.13/whatsnew/3.13.html#pending-removal-in-python-3-15).\r\n\r\nI did a quick poke at both real and synthetic collections modules under Python 3.14.0a3- we're currently getting the correct behavior (ie, `__spec__.parent` matches `__package__`), but since we have very little direct interaction with `__spec__` and even fewer tests for it, I'm not at all confident that collections modules will continue to work under 3.15+ without some changes.\r\n\r\nWe need to develop validation tests for each of the different cases of collection-loader owned modules/packages (delegated, collection synthetic) and ensure that everything still works correctly when we stop setting `__package__` on our module objects in 3.14+.\r\n\r\nWe'll have the same problem in 3.16+ with `__loader__`/`__spec__.loader`, so we might as well handle that one at the same time.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncollection loader\r\n\r\n### Ansible Version\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nN/A\r\n\r\n### Steps to Reproduce\r\n\r\nN/A\r\n\r\n### Expected Results\r\n\r\nN/A\r\n\r\n### Actual Results\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2025-01-02T22:57:56Z",
        "user": "nitzmahone",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 84502,
        "title": "Fact caching with smart gathering can miss facts when plays use different gather_subset sets",
        "body": "### Summary\r\n\r\nThe lack of ability to set a global `gather_subset` means that when using fact caching with `gather_facts: smart`, the facts collected are determined by the `gather_subset` of the first play that runs. Subsequent plays that request different fact subsets via their own `gather_subset` configuration will not receive those additional facts because:\r\n\r\n1. The first play/block/task caches its collected facts based on its `gather_subset`\r\n2. Later plays/blocks/tasks see the facts are cached (due to smart gathering)\r\n3. No new fact gathering occurs until the cache times out even though different subsets are requested\r\n4. This leads to missing facts that were explicitly requested by later plays\r\n\r\nThis creates a potential issue where plays/blocks/tasks using the same cache location must maintain identical `gather_subset` configurations to ensure all required facts are available when using fact caching with smart gathering. It seems like there should either be a way to specify a global `gather_subset` or smart gathering should be able to determine if some new facts need to be added to the facts cache due to the subset being expanded on later plays.\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/module_utils/facts/collector.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.18.1]\r\n  config file = None\r\n  configured module search path = ['/home/raddessi/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/raddessi/.conda/envs/ansible-3.11/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/raddessi/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/raddessi/.conda/envs/ansible-3.11/bin/ansible\r\n  python version = 3.11.11 | packaged by conda-forge | (main, Dec  5 2024, 14:17:24) [GCC 13.3.0] (/home/raddessi/.conda/envs/ansible-3.11/bin/python3.11)\r\n  jinja version = 3.1.5\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = code\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nnot relevant but confirmed on fedora 41 and debian 10\r\n\r\n### Steps to Reproduce\r\n\r\nI've set up an integration test to document the failure that you can see [at this branch](https://github.com/ansible/ansible/compare/devel...raddessi:ansible:devel.gather_subset_caching?expand=1), here is a high level summary:\r\n\r\nenv settings\r\n```bash\r\nANSIBLE_GATHERING=smart\r\nANSIBLE_CACHE_PLUGIN=jsonfile\r\nANSIBLE_CACHE_PLUGIN_CONNECTION=./cache\r\n```\r\n\r\nplaybook1\r\n```yaml\r\n# First play, facts cached here will be minimal\r\n- hosts: testhost\r\n  module_defaults:\r\n    ansible.builtin.gather_facts:\r\n      gather_subset: [\"!all\"]  # can be changed to  [\"!all\", \"hardware\"] to resolve the issue\r\n  tasks:\r\n    - name: ensure facts are gathered\r\n      assert:\r\n        that:\r\n            - ansible_facts is defined and 'fqdn' in ansible_facts\r\n```\r\n\r\n```yaml\r\n# Second play, hardware facts not available despite being requested\r\n- hosts: testhost\r\n  module_defaults:\r\n    ansible.builtin.gather_facts:\r\n      gather_subset: [\"hardware\"]\r\n  tasks:\r\n    - name: ensure the hardware facts are present\r\n      assert:\r\n        that:\r\n            - ansible_facts is defined and 'processor_cores' in ansible_facts\r\n```\r\n\r\n\r\n\r\n### Expected Results\r\n\r\nI expected to be able to use facts that were specified but since the cache already exists it was returned as-is even though it only contains a subset of the facts that were requested.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [ensure the hardware facts are present] ***********************************\r\nfatal: [testhost]: FAILED! => {\r\n    \"assertion\": \"ansible_facts is defined and 'processor_cores' in ansible_facts\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\ntesthost                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n\r\nNOTICE: To resume at this test target, use the option: --start-at gather_subset_caching\r\nFATAL: Command \"./runme.sh\" returned exit status 2.\r\nFATAL: Command \"podman exec ansible-test-controller-uYaUDvjx /usr/bin/env ANSIBLE_TEST_CONTENT_ROOT=/root/ansible LC_ALL=en_US.UTF-8 /usr/bin/python3.13 /root/ansible/bin/ansible-test integration --allow-destructive --containers '{}' --truncate 187 --color yes --host-path test/results/.tmp/host-a2osvri4 --metadata test/results/.tmp/metadata-yyow8ew_.json -- gather_subset_caching\" returned exit status 1.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-31T22:55:42Z",
        "user": "raddessi",
        "labels": [
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84500,
        "title": "ansible.builtin.service_facts incorrectly documents the status values reported for systemd systems",
        "body": "### Summary\n\nThe documented status values are wrong for systemd systems.  The docs say that the status values are: enabled, disabled, static, indirect or unknown.  But the code says the status values are: not-found, masked, failed, active, and inactive.\r\n\r\nFurther, the status codes returned are not useful unless their values are mapped to the state expected after running systemctl's \"unit file commands\", like `systemctl enable ...` or `systemctl mask ...` or `systemctl stop ...`.\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/modules/service_facts.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.18.1]\r\n  config file = /home/REDACTED_USER/REDACTED_DIR/ansible.cfg\r\n  configured module search path = ['/home/REDACTED_USER/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/REDACTED_USER/REDACTED_DIR/venv/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/REDACTED_USER/REDACTED_DIR/collections\r\n  executable location = venv/bin/ansible\r\n  python version = 3.12.3 (main, Nov  6 2024, 18:32:19) [GCC 13.2.0] (/home/REDACTED_USER/REDACTED_DIR/venv/bin/python3)\r\n  jinja version = 3.1.5\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nBECOME_ALLOW_SAME_USER(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = True\r\nCOLLECTIONS_PATHS(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = ['/home/REDACTED_USER/pri>\r\nCONFIG_FILE() = /home/REDACTED_USER/REDACTED_DIR/ansible.cfg\r\nDEFAULT_BECOME(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = True\r\nDEFAULT_FILTER_PLUGIN_PATH(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = ['/home/>\r\nDEFAULT_ROLES_PATH(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = ['/home/REDACTED_USER/pr>\r\nEDITOR(env: EDITOR) = emacs -nw --no-desktop\r\nINTERPRETER_PYTHON(/home/REDACTED_USER/REDACTED_DIR/ansible.cfg) = /usr/bin/python3\r\n\r\nGALAXY_SERVERS:\n```\n\n\n### OS / Environment\n\n# lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 24.04.1 LTS\r\nRelease:\t24.04\r\nCodename:\tnoble\r\n\n\n### Additional Information\n\nWithout knowing the status of a systemd service you don't know what operations can be performed on the service, whether it can be (re)started without error, etc.  This is true whether the ansible.builtin.service module is used or whether systemctl commands are run on the target.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-30T19:21:01Z",
        "user": "kpinc",
        "labels": [
            "module",
            "P3",
            "needs_verified",
            "affects_2.18"
        ]
    },
    {
        "number": 84499,
        "title": "Ability to hide 'included' lines when using include_role or include_tasks with default callback plugin",
        "body": "### Summary\n\nI just upgraded, and notice that latest now prints \"included: host1, host2, hostX\" for all included roles.\r\nI use this playbook to be able to auto tag roles.\r\n\r\n```yaml\r\n  tasks:\r\n    - include_role:\r\n        name: \"{{ role_item }}\"\r\n        apply:\r\n          tags: \"{{ role_item | split('/') | last }}\"\r\n      tags: always\r\n      loop_control:\r\n        loop_var: role_item\r\n      loop:\r\n        - role1\r\n        - role2\r\n        - sub/rolea\r\n        - sub/roleb\r\n```\r\n\r\nIt produces an huge output with ~1000 hosts in inventory\r\n\r\n```\r\nincluded: role1 for host1, host2, host3\r\nincluded: role2 for host1, host2, host3\r\nincluded: sub/rolea for host1, host2, host3\r\nincluded: sub/roleb for host1, host2, host3\r\n```\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncallback\n\n### Additional Information\n\nI want to be able to configure default callback to ignore those lines, even in verbose\r\n\r\n```\r\n[defaults]\r\ncallback_pretty_results = yes\r\ncallback_result_format = yaml\r\ndisplay_skipped_hosts = no\r\ndisplay_failed_stderr = yes\r\nshow_custom_stats = yes\r\nverbosity = 1\r\n\r\ndisplay_included = no\r\n```\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-30T11:47:50Z",
        "user": "eoli3n",
        "labels": [
            "waiting_on_contributor",
            "feature"
        ]
    },
    {
        "number": 84498,
        "title": "Adding no_log to role argument validation",
        "body": "### Summary\n\nIt already exists in module argument validation, the plan is to just port it over\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible.builtin.validate_argument_spec\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-29T21:12:10Z",
        "user": "kominoshja",
        "labels": [
            "module",
            "feature",
            "data_tagging"
        ]
    },
    {
        "number": 84495,
        "title": "\"creates\" is ignored when multiple files are specified, and the files are outside current directory",
        "body": "### Summary\n\nThe \"creates\" constraint in `shell` behaves differently depending on where the listed files are located.\r\n\r\nWhen a single file is given, it appears to behave as expected, i.e., if the file already exists then the task is not performed.\r\n\r\nWhen multiple files are given, and they are in the task path, behavior is as above.\r\n\r\nWhen multiple files are given, and they are not in the task path, the task is run even though the files already exist.\r\n\r\nSee playbook in section \"Steps to reproduce\". Run that playbook twice to reproduce.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nshell\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/ubuntu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/ubuntu/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.3 (main, Nov  6 2024, 18:32:19) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nUbuntu 24.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts:\r\n    - '127.0.0.1'\r\n\r\n  tasks:\r\n      - name: success - Create single file in ~\r\n        args:\r\n          creates: /home/ubuntu/a\r\n        ansible.builtin.shell: |\r\n          touch /home/ubuntu/a\r\n\r\n      - name: success - Create multiple files in current directory\r\n        args:\r\n          creates:\r\n            - a\r\n            - b\r\n        ansible.builtin.shell: |\r\n          touch a b\r\n\r\n      - name: failure - Create multiple files in ~\r\n        args:\r\n          creates:\r\n            - /home/ubuntu/a\r\n            - /home/ubuntu/b\r\n        ansible.builtin.shell: |\r\n          touch /home/ubuntu/a /home/ubuntu/b\r\n```\r\n\n\n### Expected Results\n\nSee the section \"Summary\".\n\n### Actual Results\n\n```console\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nansible-playbook [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/ubuntu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/ubuntu/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.12.3 (main, Nov  6 2024, 18:32:19) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nNo config file found; using defaults\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: main.yml *************************************************************\r\n1 plays in ansible/main.yml\r\n\r\nPLAY [127.0.0.1] ***************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /home/ubuntu/.dotfiles/ansible/main.yml:1\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: ubuntu\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ubuntu && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/ubuntu/.ansible/tmp `\"&& mkdir \"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575 `\" && echo ansible-tmp-1735297572.0545905-2753-218625252217575=\"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/ubuntu/.ansible/tmp/ansible-local-27508expt46y/tmpn0vwkjic TO /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575/ /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.0545905-2753-218625252217575/ > /dev/null 2>&1 && sleep 0'\r\nok: [127.0.0.1]\r\n\r\nTASK [success - Create single file in ~] ***************************************\r\ntask path: /home/ubuntu/.dotfiles/ansible/main.yml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: ubuntu\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ubuntu && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/ubuntu/.ansible/tmp `\"&& mkdir \"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247 `\" && echo ansible-tmp-1735297572.6977189-2832-40327463316247=\"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/command.py\r\n<127.0.0.1> PUT /home/ubuntu/.ansible/tmp/ansible-local-27508expt46y/tmp3s5a50wb TO /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247/AnsiballZ_command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247/ /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.6977189-2832-40327463316247/ > /dev/null 2>&1 && sleep 0'\r\nok: [127.0.0.1] => {\r\n    \"changed\": false,\r\n    \"cmd\": \"touch /home/ubuntu/a\\n\",\r\n    \"delta\": null,\r\n    \"end\": null,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"touch /home/ubuntu/a\\n\",\r\n            \"_uses_shell\": true,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": \"/home/ubuntu/a\",\r\n            \"executable\": null,\r\n            \"expand_argument_vars\": true,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true\r\n        }\r\n    },\r\n    \"msg\": \"Did not run command since '/home/ubuntu/a' exists\",\r\n    \"rc\": 0,\r\n    \"start\": null,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"skipped, since /home/ubuntu/a exists\",\r\n    \"stdout_lines\": [\r\n        \"skipped, since /home/ubuntu/a exists\"\r\n    ]\r\n}\r\n\r\nTASK [success - Create multiple files in current directory] ********************\r\ntask path: /home/ubuntu/.dotfiles/ansible/main.yml:11\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: ubuntu\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ubuntu && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/ubuntu/.ansible/tmp `\"&& mkdir \"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105 `\" && echo ansible-tmp-1735297572.8988683-2857-167062530684105=\"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/command.py\r\n<127.0.0.1> PUT /home/ubuntu/.ansible/tmp/ansible-local-27508expt46y/tmp65ji5wt4 TO /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105/AnsiballZ_command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105/ /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/ubuntu/.ansible/tmp/ansible-tmp-1735297572.8988683-2857-167062530684105/ > /dev/null 2>&1 && sleep 0'\r\nok: [127.0.0.1] => {\r\n    \"changed\": false,\r\n    \"cmd\": \"touch a b\\n\",\r\n    \"delta\": null,\r\n    \"end\": null,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"touch a b\\n\",\r\n            \"_uses_shell\": true,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": \"['a', 'b']\",\r\n            \"executable\": null,\r\n            \"expand_argument_vars\": true,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true\r\n        }\r\n    },\r\n    \"msg\": \"Did not run command since '['a', 'b']' exists\",\r\n    \"rc\": 0,\r\n    \"start\": null,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"skipped, since ['a', 'b'] exists\",\r\n    \"stdout_lines\": [\r\n        \"skipped, since ['a', 'b'] exists\"\r\n    ]\r\n}\r\n\r\nTASK [failure - Create multiple files in ~] ************************************\r\ntask path: /home/ubuntu/.dotfiles/ansible/main.yml:19\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: ubuntu\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ubuntu && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/ubuntu/.ansible/tmp `\"&& mkdir \"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637 `\" && echo ansible-tmp-1735297573.0390477-2882-220125337962637=\"` echo /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/command.py\r\n<127.0.0.1> PUT /home/ubuntu/.ansible/tmp/ansible-local-27508expt46y/tmpa3nihfbn TO /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637/AnsiballZ_command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637/ /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/ubuntu/.ansible/tmp/ansible-tmp-1735297573.0390477-2882-220125337962637/ > /dev/null 2>&1 && sleep 0'\r\nchanged: [127.0.0.1] => {\r\n    \"changed\": true,\r\n    \"cmd\": \"touch /home/ubuntu/a /home/ubuntu/b\\n\",\r\n    \"delta\": \"0:00:00.003488\",\r\n    \"end\": \"2024-12-27 11:06:13.155383\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"touch /home/ubuntu/a /home/ubuntu/b\\n\",\r\n            \"_uses_shell\": true,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": \"['/home/ubuntu/a', '/home/ubuntu/b']\",\r\n            \"executable\": null,\r\n            \"expand_argument_vars\": true,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true\r\n        }\r\n    },\r\n    \"msg\": \"\",\r\n    \"rc\": 0,\r\n    \"start\": \"2024-12-27 11:06:13.151895\",\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\n127.0.0.1                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-27T11:19:47Z",
        "user": "erikv85",
        "labels": [
            "module",
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 84481,
        "title": "Templating very slow with variable references",
        "body": "### Summary\n\nHi,\r\n\r\nTemplating is very slow with variable references. You can test it with my .zip file ([ansible-template-perf.zip](https://github.com/user-attachments/files/18204483/ansible-template-perf.zip)) which contains a complete, standalone and basic example. You can just follow the README file.\r\n\r\nSorry if it's a duplicated issue (it's possible). Maybe my complete example and its dataset could help us to solve the problem. At least I hope so...\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ntemplate\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.17.7]\r\n  config file = /home/flaf/tmp/ansible-template-perf/ansible.cfg\r\n  configured module search path = ['/home/flaf/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /tmp/pyenv/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/flaf/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /tmp/pyenv/bin/ansible\r\n  python version = 3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0] (/tmp/pyenv/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = True\r\nCONFIG_FILE() = /home/flaf/tmp/ansible-template-perf/ansible.cfg\r\nDEFAULT_BECOME(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = False\r\nDEFAULT_HOST_LIST(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = ['/home/flaf/tmp/ansible-template-perf/inventory.yml']\r\nDEFAULT_MANAGED_STR(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = This file is managed by Ansible, do not edit it\r\nDEFAULT_ROLES_PATH(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = ['/home/flaf/tmp/ansible-template-perf/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(env: ANSIBLE_VAULT_PASSWORD_FILE) = /var/run/user/1000/flaf-vault/ansible-vault-snpnextcloud\r\nDIFF_ALWAYS(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = True\r\nEDITOR(env: EDITOR) = vim\r\nINTERPRETER_PYTHON(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = auto_silent\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\npipelining(/home/flaf/tmp/ansible-template-perf/ansible.cfg) = True\n```\n\n\n### OS / Environment\n\nUbuntu 22.04 and Python 3.10.12\n\n### Steps to Reproduce\n\nJust follow the README instructions in the .zip file ([ansible-template-perf.zip](https://github.com/user-attachments/files/18204483/ansible-template-perf.zip)):\r\n\r\n```sh\r\npython3 -m venv --upgrade-deps /tmp/pyenv\r\n. /tmp/pyenv/bin/activate\r\npip install ansible-core==2.17.7\r\n\r\n# Run the test.\r\n./test.sh\r\n```\n\n### Expected Results\n\nThe playbook lasts ~10-15 seconds.\n\n### Actual Results\n\n```console\nThe playbook should last ~2 seconds (something like that).\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-20T00:49:03Z",
        "user": "flaf",
        "labels": [
            "module",
            "bug",
            "affects_2.17",
            "data_tagging"
        ]
    },
    {
        "number": 84470,
        "title": "Unsafe conditionals checks prevent from composing dynamic assert lists",
        "body": "### Summary\r\n\r\nAfter upgrade from 2.15.6 to 2.15.13 a lot of asserts break.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.13]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFreeBSD 14.1\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nAn example of a complex assert that worked on 2.15.6:\r\n\r\n```yaml (paste below)\r\n    - name: assert git commit and push vars\r\n      assert:\r\n        fail_msg: |\r\n          Ensure git_clone_worktree is leading to actual worktree\r\n          Ensure git_cp_files is a list of relative file paths to be committed\r\n        success_msg: |2\r\n            Working on: {{ git_cp_worktree | regex_replace(home_path, '~') }}\r\n          With git dir: {{ git_cp_gitdir | regex_replace(home_path, '~') }}\r\n        quiet: no\r\n        that: \"{{ checks_static + checks_dynamic }}\"\r\n      vars:\r\n        checks_static:\r\n          - git_cp_worktree is string\r\n          - git_cp_worktree is truthy\r\n          - git_cp_worktree is directory\r\n          - git_cp_gitdir is string\r\n          - git_cp_gitdir is truthy\r\n          - git_cp_gitdir is directory\r\n          - git_cp_files is defined\r\n          - git_cp_files|type_debug == 'list'\r\n          - git_cp_files is truthy\r\n          - git_cp_files | reject('string') | length == 0\r\n          - git_cp_message is string\r\n          - git_cp_message is truthy\r\n          - git_cp_key_file|default('') is string\r\n          - git_cp_key_file|default('') is falsy or git_cp_key_file is exists\r\n          - git_cp_lock_timeout is integer or (git_cp_lock_timeout is string and git_cp_lock_timeout.isnumeric())\r\n          - git_lock_timeout is integer or (git_lock_timeout is string and git_lock_timeout.isnumeric())\r\n        checks_dynamic: |-\r\n          {% set ns = namespace(out=[]) %}\r\n          {% for idx in range(0, git_cp_files|length) %}\r\n          {% set _ = ns.out.extend([\r\n            'git_cp_files[{}] is not abs'.format(idx),\r\n            '[git_cp_worktree, git_cp_files[{}]] | path_join is file'.format(idx)\r\n          ]) %}\r\n          {% endfor %}\r\n          {{ ns.out }}\r\n```\r\nIf I comment out ` set _ = ...` block in the template of `checks_dynamic`, error goes away, but those checks are lost. Any solution that removes templating from `that` either requires loops/extra tasks to assert dynamic data (heavy performance hit), or removes ability to see the specific check that failed (stuff like `that: \"(checks_static + checks_dynamic) is all\"` will not show anything useful on failure).\r\n\r\nAdditionally if any simple static item akin `- a[0] == a[1]` can fail unexpectedly if `a` set at block level and references other vars.\r\n\r\n### Expected Results\r\n\r\nI expected to be able to feed lists of checks to `that`.\r\n\r\n### Actual Results\r\n\r\n```console\r\n\"Conditional is marked as unsafe, and cannot be evaluated.\"\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-13T10:50:50Z",
        "user": "Vladimir-csp",
        "labels": [
            "bug",
            "affects_2.15",
            "data_tagging"
        ]
    },
    {
        "number": 84469,
        "title": "Allow `display_skipped_hosts` to be configured via vars",
        "body": "### Summary\n\nAllow callback plugins to be dynamically configured via vars, specifically in this case, allow `display_skipped_hosts` to be configured dynamically\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nlib/ansible/plugins/callback/default.py\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-12T16:33:04Z",
        "user": "sivel",
        "labels": [
            "easyfix",
            "has_pr",
            "feature",
            "P3"
        ]
    },
    {
        "number": 84466,
        "title": "apt: stop upgrading wildcard packages with state=present",
        "body": "### Summary\r\n\r\nWhen installing a package with the apt module, using a wildcard (`*`) in the package name/version, and `state=present`, ansible will upgrade the package to the highest match. Ansible should not do this, and should not upgrade packages without `state=latest`. As it is, when a wildcard is used, there is no way to stop ansible from upgrading.\r\n\r\nThis is technically a feature request, as this functionality was added deliberately a LONG time ago. But I think it needs to go away. This would be a breaking change, so if the default behavior is not changed, then at the very least, I think we need some sort of mechanism to allow disabling it.\r\n\r\nI recall seeing the justification for this behavior being \"that's how the `apt` CLI behaves when you use wildcards\". I'm not sure where I saw this at, but this is an inaccurate statement (technically true, but misleading). When you do `apt install foo`, even without a wildcard, it will install the latest version. The wildcard has nothing to do with it. Even if it were specific to wildcards, the `apt` CLI doesn't have things like `state=present`. It should not be the apt module's goal to mimmic the CLI behavior when it provides functionality specifically for controlling that behavior.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\nansible myhost -m apt -a 'name=foo=1.* state=present'\r\n```\r\n\r\n^ Have a package called `foo` version 1.0 installed. Have package version 1.1 available, but not installed.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-11T22:47:35Z",
        "user": "phemmer",
        "labels": [
            "module",
            "feature",
            "needs_verified"
        ]
    },
    {
        "number": 84451,
        "title": "Register `faulthandler` for all python processes",
        "body": "### Summary\r\n\r\nTo enable remote debugging when troubleshooting what a process is doing, we could make that really easy by using `faulthandler.register(signal.SIGTRAP)`.\r\n\r\nThen any `ansible`/`ansible-playbook` process could have `kill -TRAP <PID>` sent, to get a call stack.  Additionally, we could do the same in modules using `AnsibleModule` for the same functionality.  It may not give a complete picture, but may be easier than users attempting to get this information via `gdb`.\r\n\r\nProbably the biggest point for debate will be where the output goes. By default it will go to `stderr` of the process, which will be hidden in a number of scenarios. So we probably want it to go to a file like `/tmp/ansible-<pid>.stack`, `/tmp/ansible-worker-<WORKER_ID>-<PID>.stack` and something similar for a module.  I'm not sure how to handle the files that would be required for this, as the `file` argument requires a fileobj with a fileno.  Maybe this could be implemented without `faulthandler`.  These are all just ideas.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nlib/ansible/executor/\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-09T18:12:19Z",
        "user": "sivel",
        "labels": [
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 84450,
        "title": "Incomplete contents of diff mode and registered variables",
        "body": "### Summary\r\n\r\nWhen using ansible in diff mode, output of a task for some modules is incomplete. Same goes for registered variables which show only some changes that are made. I haven't tested it with many modules, but the issue is present for e.g. template module, which I will use as an example.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ntemplate\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.3]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nTested on Debian and MacOS\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n\r\n- name: Issue\r\n  hosts: localhost\r\n\r\n  tasks:\r\n  - name: Show issue impact\r\n    ansible.builtin.template:\r\n      src: asd.j2\r\n      dest: /opt/test/asd\r\n      mode: '644'\r\n    register: result\r\n\r\n  - name: debug\r\n    debug:\r\n      msg: \"{{ result }}\"\r\n```\r\nwhen I change both mode of the target file (to e.g. '440') and contents of a source template (from e.g. \"3\" to \"6\"), only changes in the file content are shown in the diff mode:\r\n```\r\n$ ansible-playbook --check --diff playbook.yml\r\n...\r\nTASK [Show issue impact] ***************************************************************************************************************************************************************************************************************************\r\n--- before: /opt/test/asd\r\n+++ after: .../asd.j2\r\n@@ -1 +1 @@\r\n-3\r\n+6\r\n\r\nchanged: [localhost]\r\n...\r\n```\r\nSame goes for the registered variable:\r\n```\r\nTASK [debug] ***************************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": {\r\n        \"changed\": true,\r\n        \"diff\": [\r\n            {\r\n                \"after\": \"6\\n\",\r\n                \"after_header\": \".../asd.j2\",\r\n                \"before\": \"3\\n\",\r\n                \"before_header\": \"/opt/test/asd\"\r\n            }\r\n        ],\r\n        \"failed\": false\r\n    }\r\n}\r\n```\r\n\r\n### Expected Results\r\n\r\nI expect to find all changes to the target file when running diff mode - I also expect them to be in registered variables so I can e.g. write more robust `changed_when` logic (which is now impossible and which is what pushed me to create this issue). Output should somehow combine all changes - with something like this for registered variables (ideally with more structured information so it's simpler to deduce what this \"diff\" part is about (content or file permissions)):\r\n```\r\nok: [localhost] => {\r\n    \"msg\": {\r\n        \"changed\": true,\r\n        \"diff\": [\r\n            {\r\n                \"after\": \"6\\n\",\r\n                \"after_header\": \".../asd.j2\",\r\n                \"before\": \"3\\n\",\r\n                \"before_header\": \"/opt/test/asd\"\r\n            },\r\n       {\r\n            \"after\": {\r\n                \"mode\": \"0440\",\r\n                \"path\": \"/opt/test/asd\"\r\n            },\r\n            \"before\": {\r\n                \"mode\": \"0644\",\r\n                \"path\": \"/opt/test/asd\"\r\n            }\r\n        }\r\n        ],\r\n        \"failed\": false\r\n    }\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nAlready shown in \"Steps to Reproduce\" section\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-09T17:30:41Z",
        "user": "Fallstad",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 84449,
        "title": "Add support for PowerShell 7.x",
        "body": "### Summary\r\n\r\nAdd support for PowerShell 7.x\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\n`ansible-test`",
        "created_at": "2024-12-09T15:53:38Z",
        "user": "sivel",
        "labels": [
            "P2",
            "feature"
        ]
    },
    {
        "number": 84446,
        "title": "Update galaxy_ng container for CI",
        "body": "### Summary\r\n\r\nUpdate the `galaxy_ng` container for CI.  The quay.io/pulp/galaxy_ng container is slated for EOL sometime soon.  We should try to utilize the mechanism from the `galaxy_ng` repo to spin galaxy up, however it will require some significant work to both spinning up the container, as well as creating the container image.  \r\n\r\nWe should also aim to pre-poulate the image as best as possible to reduce CI execution time. This may include:\r\n\r\n* postgres start up and migrations\r\n* pre-populate with test collections made via `setup_collections`\r\n\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\n`ansible-test`",
        "created_at": "2024-12-09T15:47:15Z",
        "user": "sivel",
        "labels": [
            "feature",
            "ansible-test"
        ]
    },
    {
        "number": 84444,
        "title": "ansible.builtin.dnf became incompatible with AIX",
        "body": "### Summary\n\nThe commit 665d2e15d74c27df5702ba17855eee3cbeda381e was created to \"remove legacy code\".\r\nUnfortunately, this breaks the compatibilty with AIX.\r\nNOTE:  the problem comes only from the usage of base.setup_loggers() (https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/dnf.py#L639), nothing else.\r\nThe latest version available on AIX is 4.2.17, while this function was introduced in the version 4.22.0 of dnf (https://github.com/rpm-software-management/dnf/commit/2fb605013654206c74b6e64f1bed69f4fece3623).\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.dnf\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.18.1]\r\n  config file = ~/tests/aix/ansible.cfg\r\n  configured module search path = ['/~/.ansible/collection/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = ~/venvs/molecule/lib/python3.12/site-packages/ansible\r\n  ansible collection location = ~/.ansible/collection/collections:/usr/share/ansible/collections\r\n  executable location = ~/venvs/molecule/bin/ansible\r\n  python version = 3.12.7 (main, Dec  7 2024, 20:52:09) [GCC 14.2.1 20241116] (~/venvs/molecule/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /tests/aix/ansible.cfg\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = /usr/bin/less\r\n\r\nGALAXY_SERVERS:\n```\n\n\n### OS / Environment\n\nGentoo\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Prepare AIX\r\n  hosts: aix\r\n  gather_facts: false\r\n  tasks:\r\n    - name: Ensure tar is installed\r\n      ansible.builtin.dnf:\r\n        name: tar\r\n        state: present\r\n        use_backend: dnf4\r\n      vars:\r\n        ansible_python_interpreter: /opt/freeware/libexec/python3\r\n      environment:\r\n        PATH: /opt/freeware/bin\r\n```\r\n\n\n### Expected Results\n\nI expected the package to be installed.\n\n### Actual Results\n\n```console\n[...]\r\n'Base' object has no attribute 'setup_loggers'\\r\\n\", \"msg\": \"MODULE FAILURE: No start of json char found\\nSee stdout/stderr for the exact error\", \"rc\": 1}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-08T14:49:06Z",
        "user": "snail59",
        "labels": [
            "waiting_on_contributor",
            "module",
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84443,
        "title": "break_when doesn't properly evaluate variable state when used with include_tasks",
        "body": "### Summary\n\nWhen looping over a variable and wanting to execute multiple tasks for the item, until a condition is met, the newly introduced break_when directive doesn't properly evaluate the state of the checked for variable at the end of each iteration.\r\n\r\nThe only way to achieve the behavior is by using include_tasks, as blocks don't work with a loop.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nloop_control\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.18.1]\r\n  config file = None\r\n  configured module search path = ['/home/vscode/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/vscode/.local/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/vscode/.ansible/collections:/usr/share/ansible/collections:/workspace/collections\r\n  executable location = /home/vscode/.local/bin/ansible\r\n  python version = 3.12.7 (main, Oct  1 2024, 22:26:44) [GCC 10.2.1 20210110] (/usr/local/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nDebian 11\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# playbook.yml\r\n---\r\n\r\n- name: Reproduce break_when not breaking early\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: Initialize variables\r\n      ansible.builtin.set_fact:\r\n        break_loop: false\r\n        processed_numbers: []\r\n\r\n    - name: Process numbers\r\n      ansible.builtin.include_tasks: tasks/included_tasks.yml\r\n      with_items: [1, 2, 3, 4, 5]\r\n      loop_control:\r\n        break_when: break_loop\r\n        loop_var: current_number\r\n        extended: true\r\n\r\n    - name: Final debug\r\n      ansible.builtin.debug:\r\n        var: processed_numbers\r\n\r\n```\r\n```yaml\r\n# tasks/included_tasks.yml\r\n---\r\n\r\n- name: Add current number to processed_numbers\r\n  ansible.builtin.set_fact:\r\n    processed_numbers: \"{{ processed_numbers + [current_number] }}\"\r\n\r\n- name: Break loop if number equals 3\r\n  ansible.builtin.set_fact:\r\n    break_loop: true\r\n  when: current_number == 3\r\n```\r\n\n\n### Expected Results\n\nFinal output should be\r\n```\r\nok: [localhost] => {\r\n    \"processed_numbers\": [\r\n        1,\r\n        2\r\n    ]\r\n}\r\n```\n\n### Actual Results\n\n```console\nPLAY [Reproduce break_when not breaking early] ************************************************************************************************************************************************************************************\r\n\r\nTASK [Initialize variables] *******************************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Process numbers] ************************************************************************************************************************************************************************************************************\r\nincluded: /workspace/collections/ansible_collections/ifalatik/aoc2024/playbooks/tasks/included_tasks.yml for localhost => (item=1)\r\nincluded: /workspace/collections/ansible_collections/ifalatik/aoc2024/playbooks/tasks/included_tasks.yml for localhost => (item=2)\r\nincluded: /workspace/collections/ansible_collections/ifalatik/aoc2024/playbooks/tasks/included_tasks.yml for localhost => (item=3)\r\nincluded: /workspace/collections/ansible_collections/ifalatik/aoc2024/playbooks/tasks/included_tasks.yml for localhost => (item=4)\r\nincluded: /workspace/collections/ansible_collections/ifalatik/aoc2024/playbooks/tasks/included_tasks.yml for localhost => (item=5)\r\n\r\nTASK [Add current number to processed_numbers] ************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Break loop if number equals 3] **********************************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Add current number to processed_numbers] ************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Break loop if number equals 3] **********************************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Add current number to processed_numbers] ************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Break loop if number equals 3] **********************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Add current number to processed_numbers] ************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Break loop if number equals 3] **********************************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Add current number to processed_numbers] ************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Break loop if number equals 3] **********************************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Final debug] ****************************************************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"processed_numbers\": [\r\n        1,\r\n        2,\r\n        3,\r\n        4,\r\n        5\r\n    ]\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-12-07T13:37:51Z",
        "user": "ifalatik",
        "labels": [
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84406,
        "title": "include_vars treats dir paths beginning with ~/ as relative",
        "body": "### Summary\r\n\r\nWhen I use an include_vars with a dir entry pointing to the home dir (~), it treats that path as relative to the current directory\r\n```\r\n  - name: Including Environment variable files\r\n    include_vars:\r\n      dir: ~/infrastructure/cfg/Env/\r\n      name: envfiles\r\n  ```    \r\nI get the following error\r\n```\r\nTASK [Including Environment variable files] ******************************************************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"ansible_facts\": {\"envfiles\": {}}, \"ansible_included_var_files\": [], \"changed\": false, \"message\": \"/home/ansible/infrastructure/ansible/~/infrastructure/cfg/Env/ directory does not exist\"}\r\n```\r\nThis only applys to \"dir:\" entries, and \"file:\" entries (like below) work correctly \r\n```\r\n  - name: Including Software variable file\r\n    include_vars:\r\n      file:  ~/infrastructure/cfg/software.yaml\r\n```\r\nIt is possible that I could replace \"\\~/\" with \"../../\", but this makes assumptions on the current directory.\r\nI could also replace \"\\~/\" with \"/home/ansible/\", but this makes assumptions on the current user and the path to /home.\r\n\r\nI do believe that \"dir\" and \"file\" should be consistant in the treatment of \"~\" as a non relative directory\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npip install --user ansible boto boto3\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.13]\r\n  config file = None\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ansible/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/ansible/.local/bin/ansible\r\n  python version = 3.9.16 (main, Jul  5 2024, 00:00:00) [GCC 11.4.1 20230605 (Red Hat 11.4.1-2)] (/usr/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n$ cat /etc/os-release\r\nNAME=\"Amazon Linux\"\r\nVERSION=\"2023\"\r\nID=\"amzn\"\r\nID_LIKE=\"fedora\"\r\nVERSION_ID=\"2023\"\r\nPLATFORM_ID=\"platform:al2023\"\r\nPRETTY_NAME=\"Amazon Linux 2023.6.20241121\"\r\nANSI_COLOR=\"0;33\"\r\nCPE_NAME=\"cpe:2.3:o:amazon:amazon_linux:2023\"\r\nHOME_URL=\"https://aws.amazon.com/linux/amazon-linux-2023/\"\r\nDOCUMENTATION_URL=\"https://docs.aws.amazon.com/linux/\"\r\nSUPPORT_URL=\"https://aws.amazon.com/premiumsupport/\"\r\nBUG_REPORT_URL=\"https://github.com/amazonlinux/amazon-linux-2023\"\r\nVENDOR_NAME=\"AWS\"\r\nVENDOR_URL=\"https://aws.amazon.com/\"\r\nSUPPORT_END=\"2028-03-15\"\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n  - name: Including Software variable file (WILL WORK)\r\n    include_vars:\r\n      file:  ~/infrastructure/cfg/software.yaml\r\n\r\n  - name: Including Environment variable files (WILL FAIL)\r\n    include_vars:\r\n      dir: ~/infrastructure/cfg/Env/\r\n      name: envfiles\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect that this \r\n      dir: ~/infrastructure/cfg/Env/\r\nwould work exactly like this when the current login is ansible\r\n      dir: /home/ansible/infrastructure/cfg/Env/\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [automation server post-work (as root)] *****************************************************************************************************************************************************************************************************\r\nRead vars_file 'vars.yaml'\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************************************************************************************\r\ntask path: /home/ansible/infrastructure/ansible/install_software.yaml:248\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: ansible\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ansible && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/ansible/.ansible/tmp `\"&& mkdir \"` echo /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999 `\" && echo ansible-tmp-1732872741.491025-687510-42140329486999=\"` echo /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999 `\" ) && sleep 0'\r\nUsing module file /home/ansible/.local/lib/python3.9/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/ansible/.ansible/tmp/ansible-local-686394tmtom_sn/tmp5m3p7o1_ TO /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999/ /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-sothcdonrzqffwgtuenmmflrgeqanvyo ; /usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999/AnsiballZ_setup.py'\"'\"' && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/ansible/.ansible/tmp/ansible-tmp-1732872741.491025-687510-42140329486999/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\nRead vars_file 'vars.yaml'\r\nRead vars_file 'vars.yaml'\r\nRead vars_file 'vars.yaml'\r\n\r\nTASK [Including Environment variable files] ******************************************************************************************************************************************************************************************************\r\ntask path: /home/ansible/infrastructure/ansible/install_software.yaml:255\r\nfatal: [localhost]: FAILED! => {\r\n    \"ansible_facts\": {\r\n        \"eenvironment\": {}\r\n    },\r\n    \"ansible_included_var_files\": [],\r\n    \"changed\": false,\r\n    \"message\": \"/home/ansible/infrastructure/ansible/~/infrastructure/cfg/Env/ directory does not exist\"\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=31   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-29T08:44:40Z",
        "user": "chris-king-medibank",
        "labels": [
            "bug",
            "P3",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 84387,
        "title": "ansible.builtin.iptables inconsistent parser behavior with 'owner' extension",
        "body": "### Summary\n\nWhen matching 'uid-owner' & 'gid-owner' flags, rule constructor automatically adds -m 'owner' to parameters. This results in an error, when user explicitly specifies `match: owner` in the task:\r\n```\r\niptables v1.8.7 (nf_tables): owner: At least one of --uid-owner, --gid-owner or --socket-exists is required\r\nTry 'iptables -h' or 'iptables --help' for more information.\r\n```\r\nThis seems inconsistent with behavior of iptables itself, since it does require `-m owner` when performing any owner-related matching, moreover using other extensions does require appropriate match flag to be set.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\niptables\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.10.8\r\n  config file = None\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Nov  6 2024, 20:22:13) [GCC 11.4.0]\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nubuntu 22.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: This task executes\r\n  ansible.builtin.iptables:\r\n    table: nat\r\n    chain: OUTPUT\r\n    #match: owner # Notice the line i commented out\r\n    uid_owner: 1001\r\n    ctstate: NEW\r\n    jump: ACCEPT\r\n    comment: \"Explicitly allow packets from user mitmproxy to avoid loopback and succeed\"\r\n\r\n- name: This task fails\r\n  ansible.builtin.iptables:\r\n    table: nat\r\n    chain: OUTPUT\r\n    match: owner # Uncommented line\r\n    uid_owner: 1001\r\n    ctstate: NEW\r\n    jump: ACCEPT\r\n    comment: \"Explicitly allow packets from user mitmproxy to avoid loopback and fail miserably\"\r\n```\r\n\n\n### Expected Results\n\nI expected the task without `match: owner` to fail, and with it to succeed, so naturally I was shocked to learn it worked the other way around!\n\n### Actual Results\n\n```console\nfatal: [default]: FAILED! => {\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/sbin/iptables -t nat -A OUTPUT -m owner -j ACCEPT -m conntrack --ctstate NEW -m owner --uid-owner 1001 -m comment --comment 'Explicitly allow packets from user mitmproxy to avoid loopback and fail miserably'\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"action\": \"append\",\r\n            \"chain\": \"OUTPUT\",\r\n            \"comment\": \"Explicitly allow packets from user mitmproxy to avoid loopback and fail miserably\",\r\n            \"ctstate\": [\r\n                \"NEW\"\r\n            ],\r\n            \"destination\": null,\r\n            \"destination_port\": null,\r\n            \"dst_range\": null,\r\n            \"flush\": false,\r\n            \"fragment\": null,\r\n            \"gateway\": null,\r\n            \"gid_owner\": null,\r\n            \"goto\": null,\r\n            \"icmp_type\": null,\r\n            \"in_interface\": null,\r\n            \"ip_version\": \"ipv4\",\r\n            \"jump\": \"ACCEPT\",\r\n            \"limit\": null,\r\n            \"limit_burst\": null,\r\n            \"log_level\": null,\r\n            \"log_prefix\": null,\r\n            \"match\": [\r\n                \"owner\"\r\n            ],\r\n            \"out_interface\": null,\r\n            \"policy\": null,\r\n            \"protocol\": null,\r\n            \"reject_with\": null,\r\n            \"rule_num\": null,\r\n            \"set_counters\": null,\r\n            \"set_dscp_mark\": null,\r\n            \"set_dscp_mark_class\": null,\r\n            \"source\": null,\r\n            \"source_port\": null,\r\n            \"src_range\": null,\r\n            \"state\": \"present\",\r\n            \"syn\": \"ignore\",\r\n            \"table\": \"nat\",\r\n            \"tcp_flags\": null,\r\n            \"to_destination\": null,\r\n            \"to_ports\": null,\r\n            \"to_source\": null,\r\n            \"uid_owner\": \"1001\",\r\n            \"wait\": null\r\n        }\r\n    },\r\n    \"msg\": \"iptables v1.8.7 (nf_tables): owner: At least one of --uid-owner, --gid-owner or --socket-exists is required\\nTry `iptables -h' or 'iptables --help' for more information.\",\r\n    \"rc\": 2,\r\n    \"stderr\": \"iptables v1.8.7 (nf_tables): owner: At least one of --uid-owner, --gid-owner or --socket-exists is required\\nTry `iptables -h' or 'iptables --help' for more information.\\n\",\r\n    \"stderr_lines\": [\r\n        \"iptables v1.8.7 (nf_tables): owner: At least one of --uid-owner, --gid-owner or --socket-exists is required\",\r\n        \"Try `iptables -h' or 'iptables --help' for more information.\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-25T16:29:17Z",
        "user": "xrzi",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 84381,
        "title": "exctract list of ips from inventory without providing vault password",
        "body": "### Summary\n\nI want to extract the list of ips from ansible inventory,\r\nI can do that as follows:\r\n\r\n```\r\nansible-inventory --list --ask-vault-pass | jq -r '._meta.hostvars[].ansible_host'\r\n```\r\n\r\nbut this requires giving vault pass which theoretically is not required.\r\n\r\nplease provide a way to extract ip list from inventory without querying the encrypted vault\r\n\r\nA generalization of the requested feature is as follows:\r\nprovide a way to parse and extract information from inventory without querying the encrypted vault\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncli\n\n### Additional Information\n\nIt is useful in bash scripts that need ip list. this feature help one to not have a duplicate ip list for things which could not be done directly with ansible playbooks and needs scripting\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-24T04:48:24Z",
        "user": "zxsimba",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 84380,
        "title": "Inline encrypted ansible-vault variable doesn't get decrypted when passed to to_nice_yaml(indent=2)",
        "body": "### Summary\n\nThis bug came about when trying to use the alertmanager role but the bug lies with `ansible-vault`.\r\n\r\nWhen running a templated file validation with an vault encrypted variable it fails. Here is the specific task that is failing for me. \r\n```yaml\r\n- name: Copy alertmanager config\r\n  ansible.builtin.template:\r\n    force: true\r\n    src: \"{{ alertmanager_config_file }}\"\r\n    dest: \"{{ alertmanager_config_dir }}/alertmanager.yml\"\r\n    owner: \"{{ alertmanager_system_user }}\"\r\n    group: \"{{ alertmanager_system_group }}\"\r\n    mode: 0644\r\n    validate: \"{{ alertmanager_binary_install_dir }}/amtool check-config %s\"\r\n  no_log: \"{{ false if (lookup('env', 'CI')) or (lookup('env', 'MOLECULE_PROVISIONER_NAME')) else true }}\"\r\n  become: true\r\n  notify:\r\n    - restart alertmanager\r\n  tags:\r\n    - alertmanager\r\n    - configure\r\n    - alertmanager_configure\r\n```\r\n\r\nUsing debug to check the variable correctly decrypts it, the variable in question `alertmanager_receivers` is an array of hashes which might be where the true problem lies.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-vault\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.18.0]\r\n  config file = /Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg\r\n  configured module search path = ['/Users/ccn510/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/ccn510/.local/pipx/venvs/ansible/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/ccn510/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/ccn510/.local/bin/ansible\r\n  python version = 3.12.7 (main, Oct  1 2024, 02:05:46) [Clang 15.0.0 (clang-1500.3.9.4)] (/Users/ccn510/.local/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = True\r\nCONFIG_FILE() = /Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg\r\nDEFAULT_FORKS(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = 50\r\nDEFAULT_HOST_LIST(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = ['/Users/ccn510/Developer/tactifools/tf-infra/inventory/hosts.ini']\r\nDEFAULT_MANAGED_STR(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = Ansible managed: {file} modified on %Y-%m-%d %H:%M:%S by {uid} on {host}\r\nDEFAULT_VAULT_PASSWORD_FILE(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = /Users/ccn510/Developer/tactifools/tf-infra/vault-pass.txt\r\nINTERPRETER_PYTHON(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = auto_silent\r\n\r\nGALAXY_SERVERS:\r\n\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\nssh_args(/Users/ccn510/Developer/tactifools/tf-infra/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=60s\n```\n\n\n### OS / Environment\n\nmacOS\n\n### Steps to Reproduce\n\nTry and use an ansilble-vault encrypted variable in a template with a validate condition.\r\n\n\n### Expected Results\n\nThe validate step would also decrypt the variable\n\n### Actual Results\n\n```console\nTASK [prometheus.prometheus.alertmanager : Copy alertmanager config] ******************************\r\ntask path: /Users/ccn510/.ansible/collections/ansible_collections/prometheus/prometheus/roles/alertmanager/tasks/configure.yml:46\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'echo ~christopher && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'/home/christopher\\n', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/christopher/.ansible/tmp `\"&& mkdir \"` echo /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332 `\" && echo ansible-tmp-1732391996.292172-60585-104042242713332=\"` echo /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332 `\" ) && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'ansible-tmp-1732391996.292172-60585-104042242713332=/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332\\n', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /Users/ccn510/.local/pipx/venvs/ansible/lib/python3.12/site-packages/ansible/modules/stat.py\r\n<game.tactifools.co.uk> PUT /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp_z_iaiew TO /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py\r\n<game.tactifools.co.uk> SSH: EXEC sftp -b - -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' '[game.tactifools.co.uk]'\r\n<game.tactifools.co.uk> (0, b'sftp> put /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp_z_iaiew /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py\\n', b'OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/Users/ccn510/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/Users/ccn510/.ssh/known_hosts2\\'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at \\'/Users/ccn510/.ansible/cp/9fe1b87357\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /home/christopher\\r\\ndebug3: Looking up /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp_z_iaiew\\r\\ndebug2: Sending SSH2_FXP_STAT \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp_z_iaiew\" to remote \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:119976\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 119976 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'chmod u+x /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/ /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' -tt game.tactifools.co.uk '/bin/sh -c '\"'\"'sudo -H -S -p \"[sudo via ansible, key=hwnufrnmugxpfaeegxjqhrczgviyxqro] password:\" -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-hwnufrnmugxpfaeegxjqhrczgviyxqro ; /usr/bin/python3.12 /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_stat.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<game.tactifools.co.uk> (0, b'\\r\\n\\r\\n{\"changed\": false, \"stat\": {\"exists\": true, \"path\": \"/etc/alertmanager/alertmanager.yml\", \"mode\": \"0644\", \"isdir\": false, \"ischr\": false, \"isblk\": false, \"isreg\": true, \"isfifo\": false, \"islnk\": false, \"issock\": false, \"uid\": 993, \"gid\": 984, \"size\": 515, \"inode\": 20320472, \"dev\": 2307, \"nlink\": 1, \"atime\": 1732361039.793075, \"mtime\": 1732360807.1143107, \"ctime\": 1732360807.646292, \"wusr\": true, \"rusr\": true, \"xusr\": false, \"wgrp\": false, \"rgrp\": true, \"xgrp\": false, \"woth\": false, \"roth\": true, \"xoth\": false, \"isuid\": false, \"isgid\": false, \"blocks\": 8, \"block_size\": 4096, \"device_type\": 0, \"readable\": true, \"writeable\": true, \"executable\": false, \"pw_name\": \"alertmanager\", \"gr_name\": \"alertmanager\", \"checksum\": \"f69bbbd01d80612641ee014f8c6a9404014c5284\", \"mimetype\": \"text/plain\", \"charset\": \"us-ascii\", \"version\": \"4294790353\", \"attributes\": [\"extents\"], \"attr_flags\": \"e\"}, \"invocation\": {\"module_args\": {\"path\": \"/etc/alertmanager/alertmanager.yml\", \"follow\": false, \"get_checksum\": true, \"get_size\": false, \"checksum_algorithm\": \"sha1\", \"get_mime\": true, \"get_attributes\": true}}}\\r\\n', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to game.tactifools.co.uk closed.\\r\\n\")\r\n<game.tactifools.co.uk> PUT /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmpm39uw1i_/alertmanager.yml.j2 TO /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\r\n<game.tactifools.co.uk> SSH: EXEC sftp -b - -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' '[game.tactifools.co.uk]'\r\n<game.tactifools.co.uk> (0, b'sftp> put /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmpm39uw1i_/alertmanager.yml.j2 /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\\n', b'OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/Users/ccn510/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/Users/ccn510/.ssh/known_hosts2\\'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at \\'/Users/ccn510/.ansible/cp/9fe1b87357\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /home/christopher\\r\\ndebug3: Looking up /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmpm39uw1i_/alertmanager.yml.j2\\r\\ndebug2: Sending SSH2_FXP_STAT \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmpm39uw1i_/alertmanager.yml.j2\" to remote \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:1276\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 1276 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'chmod u+x /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/ /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /Users/ccn510/.local/pipx/venvs/ansible/lib/python3.12/site-packages/ansible/modules/copy.py\r\n<game.tactifools.co.uk> PUT /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp7ngs6doe TO /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py\r\n<game.tactifools.co.uk> SSH: EXEC sftp -b - -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' '[game.tactifools.co.uk]'\r\n<game.tactifools.co.uk> (0, b'sftp> put /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp7ngs6doe /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py\\n', b'OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/Users/ccn510/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/Users/ccn510/.ssh/known_hosts2\\'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at \\'/Users/ccn510/.ansible/cp/9fe1b87357\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /home/christopher\\r\\ndebug3: Looking up /Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp7ngs6doe\\r\\ndebug2: Sending SSH2_FXP_STAT \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/Users/ccn510/.ansible/tmp/ansible-local-5964657gnsywu/tmp7ngs6doe\" to remote \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:123775\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 123775 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'chmod u+x /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/ /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' -tt game.tactifools.co.uk '/bin/sh -c '\"'\"'sudo -H -S -p \"[sudo via ansible, key=tvzqdnpwvcjjlhqpooigqlyowizdsszr] password:\" -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-tvzqdnpwvcjjlhqpooigqlyowizdsszr ; /usr/bin/python3.12 /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/AnsiballZ_copy.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<game.tactifools.co.uk> (1, b'\\r\\n\\r\\n{\"exit_status\": 1, \"stdout\": \"Checking \\'/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\\'  FAILED: parse \\\\\"$ANSIBLE_VAULT;1.1;AES256\\\\\\\\n62306461353230396566653264353935343361393830343631613731656161326566336434393036\\\\\\\\n3761396261313261393765343062346630663935663366330a336164363162316261613462306561\\\\\\\\n38636366613365373932356135623538386131363566386637356263303530363533656637633135\\\\\\\\n6530653865353637660a656437386636313832316131333933303763653861326564303462343538\\\\\\\\n32333734326232623065396138326139633438393463333830663834316466323661663036636138\\\\\\\\n36326237623137343537373866396639613437376366356237383539653338613437316265613365\\\\\\\\n35613231333463333632666232386265316433616231383939643837623933346161373561386661\\\\\\\\n66386538363033343962613131323162323038366339666132396161393036353637333939333265\\\\\\\\n39623163383365656231633530353631396665313731383036313239393030616564356236656135\\\\\\\\n3331303738626434353033396130323264333534333533653264\\\\\\\\n\\\\\": net/url: invalid control character in URL\\\\n\\\\n\", \"stderr\": \"amtool: error: failed to validate 1 file(s)\\\\n\\\\n\", \"failed\": true, \"msg\": \"failed to validate\", \"invocation\": {\"module_args\": {\"force\": true, \"src\": \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\", \"dest\": \"/etc/alertmanager/alertmanager.yml\", \"owner\": \"alertmanager\", \"group\": \"alertmanager\", \"mode\": 420, \"validate\": \"/usr/local/bin/amtool check-config %s\", \"follow\": false, \"_original_basename\": \"alertmanager.yml.j2\", \"checksum\": \"a5088dc2e29843fa3f88d3021e8de4bd7fcf1208\", \"backup\": false, \"unsafe_writes\": false, \"content\": null, \"directory_mode\": null, \"remote_src\": null, \"local_follow\": null, \"seuser\": null, \"serole\": null, \"selevel\": null, \"setype\": null, \"attributes\": null}}}\\r\\n', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 1\\r\\nShared connection to game.tactifools.co.uk closed.\\r\\n\")\r\n<game.tactifools.co.uk> Failed to connect to the host via ssh: OpenSSH_9.7p1, LibreSSL 3.3.6\r\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\r\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\r\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\r\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\r\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\r\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\r\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\r\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 59652\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\r\ndebug2: Received exit status from master 1\r\nShared connection to game.tactifools.co.uk closed.\r\n<game.tactifools.co.uk> ESTABLISH SSH CONNECTION FOR USER: christopher\r\n<game.tactifools.co.uk> SSH: EXEC ssh -vvvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"christopher\"' -o ConnectTimeout=10 -o 'ControlPath=\"/Users/ccn510/.ansible/cp/9fe1b87357\"' game.tactifools.co.uk '/bin/sh -c '\"'\"'rm -f -r /home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<game.tactifools.co.uk> (0, b'', b\"OpenSSH_9.7p1, LibreSSL 3.3.6\\r\\ndebug1: Reading configuration data /Users/ccn510/.ssh/config\\r\\ndebug3: /Users/ccn510/.ssh/config line 1: Including file /Users/ccn510/.orbstack/ssh/config depth 0\\r\\ndebug1: Reading configuration data /Users/ccn510/.orbstack/ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/* matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 54: Applying options for *\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/Users/ccn510/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/Users/ccn510/.ssh/known_hosts2'\\r\\ndebug1: Authenticator provider $SSH_SK_PROVIDER did not resolve; disabling\\r\\ndebug1: auto-mux: Trying existing master at '/Users/ccn510/.ansible/cp/9fe1b87357'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 59652\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nfatal: [game.tactifools.co.uk]: FAILED! => {\r\n    \"changed\": false,\r\n    \"checksum\": \"a5088dc2e29843fa3f88d3021e8de4bd7fcf1208\",\r\n    \"diff\": [],\r\n    \"exit_status\": 1,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_original_basename\": \"alertmanager.yml.j2\",\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": \"a5088dc2e29843fa3f88d3021e8de4bd7fcf1208\",\r\n            \"content\": null,\r\n            \"dest\": \"/etc/alertmanager/alertmanager.yml\",\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"force\": true,\r\n            \"group\": \"alertmanager\",\r\n            \"local_follow\": null,\r\n            \"mode\": 420,\r\n            \"owner\": \"alertmanager\",\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": \"/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml\",\r\n            \"unsafe_writes\": false,\r\n            \"validate\": \"/usr/local/bin/amtool check-config %s\"\r\n        }\r\n    },\r\n    \"msg\": \"failed to validate\",\r\n    \"stderr\": \"amtool: error: failed to validate 1 file(s)\\n\\n\",\r\n    \"stderr_lines\": [\r\n        \"amtool: error: failed to validate 1 file(s)\",\r\n        \"\"\r\n    ],\r\n    \"stdout\": \"Checking '/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml'  FAILED: parse \\\"$ANSIBLE_VAULT;1.1;AES256\\\\n62306461353230396566653264353935343361393830343631613731656161326566336434393036\\\\n3761396261313261393765343062346630663935663366330a336164363162316261613462306561\\\\n38636366613365373932356135623538386131363566386637356263303530363533656637633135\\\\n6530653865353637660a656437386636313832316131333933303763653861326564303462343538\\\\n32333734326232623065396138326139633438393463333830663834316466323661663036636138\\\\n36326237623137343537373866396639613437376366356237383539653338613437316265613365\\\\n35613231333463333632666232386265316433616231383939643837623933346161373561386661\\\\n66386538363033343962613131323162323038366339666132396161393036353637333939333265\\\\n39623163383365656231633530353631396665313731383036313239393030616564356236656135\\\\n3331303738626434353033396130323264333534333533653264\\\\n\\\": net/url: invalid control character in URL\\n\\n\",\r\n    \"stdout_lines\": [\r\n        \"Checking '/home/christopher/.ansible/tmp/ansible-tmp-1732391996.292172-60585-104042242713332/.source.yml'  FAILED: parse \\\"$ANSIBLE_VAULT;1.1;AES256\\\\n62306461353230396566653264353935343361393830343631613731656161326566336434393036\\\\n3761396261313261393765343062346630663935663366330a336164363162316261613462306561\\\\n38636366613365373932356135623538386131363566386637356263303530363533656637633135\\\\n6530653865353637660a656437386636313832316131333933303763653861326564303462343538\\\\n32333734326232623065396138326139633438393463333830663834316466323661663036636138\\\\n36326237623137343537373866396639613437376366356237383539653338613437316265613365\\\\n35613231333463333632666232386265316433616231383939643837623933346161373561386661\\\\n66386538363033343962613131323162323038366339666132396161393036353637333939333265\\\\n39623163383365656231633530353631396665313731383036313239393030616564356236656135\\\\n3331303738626434353033396130323264333534333533653264\\\\n\\\": net/url: invalid control character in URL\",\r\n        \"\"\r\n    ]\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-23T20:01:01Z",
        "user": "chriscn",
        "labels": [
            "bug",
            "affects_2.18"
        ]
    },
    {
        "number": 84360,
        "title": "Need ability to close stdin",
        "body": "### Summary\n\nFeature request: add the ability for `stdin` to be None or False in `command`/`shell`/`raw`.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncommand\n\n### Additional Information\n\nExample:\r\n\r\n```yaml\r\nshell:\r\n  no_stdin: true\r\n  cmd: op item create testing\r\n```\r\n\r\n---\r\n\r\nI am trying to use the 1Password command line tool, [`op`](https://developer.1password.com/docs/cli/reference/management-commands/item), from Ansible. The `op item edit` and `op item create` commands can take command-line arguments to modify items in the password manager. They can also take JSON on stdin, which provides a base to any command-line args.\r\n\r\nThe `shell` (and `command` and `raw`) tasks always open stdin. This means that a simple command line `op item create --title testing` gives the error:\r\n\r\n```\r\ninvalid JSON in piped input\r\n```\r\n\r\nWe've been working around this for `create` by feeding in stdin, e.g.\r\n\r\n```yaml\r\nshell:\r\n  stdin: '{\"fields\": []}'\r\n  cmd: op item create --title testing 'whatever[password]=big secret'\r\n  delegate_to: localhost\r\n```\r\n\r\nBut for `edit` it needs the entirety of the existing value, so we have to do a more complicated dance (I'll show it here for others trying to figure this out):\r\n\r\n```yaml\r\n- name: build update json\r\n  shell:\r\n    cmd: >-\r\n      op item get 'testing' --format json |\r\n      jq '.fields = (.fields | map(if (.label == \"whatever\") then (.value = \"bigger secret\") else . end))'\r\n  delegate_to: localhost\r\n  register: onepass_input\r\n\r\n- name: update 1pass\r\n  shell:\r\n    stdin: \"{{ onepass_input.stdout | string }}\"\r\n    cmd: op item edit testing\r\n  delegate_to: localhost\r\n```\r\n\r\nAnd what if I want to add a new value that isn't in the existing JSON? Then I need to read even more `jq` docs ...\r\n\r\nPoint is, this is all because [stdin cannot be false](https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/command.py#L259). If it could be false, we could simply call `op item edit testing 'whatever=bigger secret'` without parsing JSON.\r\n\r\n---\r\n\r\nAs a minimal reproduction, I made a quick program:\r\n\r\n```c\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n\r\nint\r\nmain(void)\r\n{\r\n\tfd_set readfds;\r\n\tFD_ZERO(&readfds);\r\n\r\n\tstruct timeval timeout;\r\n\ttimeout.tv_sec = 0;\r\n\ttimeout.tv_usec = 0;\r\n\r\n\tFD_SET(STDIN_FILENO, &readfds);\r\n\r\n\tif (select(1, &readfds, NULL, NULL, &timeout)) {\r\n\t\tprintf(\"stdin is open\\n\");\r\n\t} else {\r\n\t\tprintf(\"stdin is closed\\n\");\r\n\t}\r\n\r\n\treturn 0;\r\n}\r\n```\r\n\r\nAnd a quick playbook:\r\n\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: false\r\n\r\n  tasks:\r\n    - name: running command\r\n      shell:\r\n        cmd: \"/home/mike/t/a.out\"\r\n      delegate_to: localhost\r\n      register: output\r\n\r\n    - debug:\r\n        msg: \"{{ output.stdout }}\"\r\n```\r\n\r\nWorks like so:\r\n\r\n```\r\n~/t% cc foo.c                \r\n~/t% ./a.out       \r\nstdin is closed\r\n~/t% echo | ./a.out\r\nstdin is open\r\n```\r\n\r\n```\r\n~/t% ansible-playbook foo.yml\r\nTASK [running command] *********************************************************\r\nchanged: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"stdin is open\"\r\n}\r\n\r\n```\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-21T14:02:24Z",
        "user": "mike-burns",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 84344,
        "title": "Copy plugin code bug",
        "body": "### Summary\r\n\r\nWhen i read code in lib/ansible/plugins/action/copy.py, i find a bug in it:\r\n```python\r\nclass ActionModule(ActionBase):\r\n\r\n    TRANSFERS_FILES = True\r\n    \r\n    # ...\r\n    \r\n    def run(self, tmp=None, task_vars=None):\r\n        ''' handler for file transfer operations '''\r\n        \r\n        # ...\r\n        \r\n        implicit_directories = set()\r\n        for source_full, source_rel in source_files['files']:\r\n            # copy files over.  This happens first as directories that have\r\n            # a file do not need to be created later\r\n\r\n            # We only follow symlinks for files in the non-recursive case\r\n            if source_files['directories']:\r\n                follow = False\r\n            else:\r\n                follow = boolean(self._task.args.get('follow', False), strict=False)\r\n            module_return = self._copy_file(source_full, source_rel, content, content_tempfile, dest, task_vars, follow)\r\n            if module_return is None:\r\n                continue\r\n\r\n            if module_return.get('failed'):   \r\n                result.update(module_return)\r\n                return self._ensure_invocation(result)\r\n\r\n            ###################bug here !!!!###################\r\n            paths = os.path.split(source_rel)\r\n            dir_path = ''\r\n            for dir_component in paths:\r\n                os.path.join(dir_path, dir_component)\r\n                implicit_directories.add(dir_path)\r\n            ##############################################\r\n            if 'diff' in result and not result['diff']:\r\n                del result['diff']\r\n            module_executed = True\r\n            changed = changed or module_return.get('changed', False)\r\n\r\n            # ...\r\n```\r\nlook at example code as follow:\r\n```python\r\n>>> import os\r\n>>> dir_path = ''\r\n>>> os.path.join(dir_path, 'xxxxx')\r\n'xxxxx'\r\n>>> dir_path\r\n''\r\n>>> \r\n```\r\ndir_path always be empty string and thus implicit_directories always be a set with one empty data!!!!\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncopy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.6]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/python3.12/lib/python3.12/site-packages/ansible_core-2.17.6-py3.12.egg/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/python3.12/bin/ansible\r\n  python version = 3.12.4 (main, Nov 13 2024, 10:46:13) [GCC 10.2.1 20200825 (Alibaba 10.2.1-3.8 2.32)] (/opt/python3.12/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAlibaba Cloud Linux release 3 (Soaring Falcon\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n- create directories:\r\n```shell\r\n[store@spyinx ~]$ cat create_dirs.sh \r\n#! /bin/bash\r\n\r\nfor i in `seq 1 100`\r\ndo\r\n    mkdir test-create-$i\r\n    cd test-create-$i\r\ndone\r\n\r\ntouch test.txt\r\n[store@spyinx ~]$ sh create_dirs.sh \r\n```\r\n- run ansible\r\n```shell\r\n[store@spyinx ~]$ rm -rf dest\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"\r\nspyinx | CHANGED => {\r\n    \"changed\": true,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m34.394s\r\nuser\t0m2.923s\r\nsys\t0m1.169s\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"    # \u518d\u6b21\u6267\u884c\r\nspyinx | SUCCESS => {\r\n    \"changed\": false,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m36.739s\r\nuser\t0m3.141s\r\nsys\t0m1.301s\r\n```\r\nbecause it will use file module to create all the directories, then it is slow !!!\r\n\r\n### Expected Results\r\n\r\ni change the code:\r\n```shell\r\n[root@spyinx ansible]# git diff lib/ansible/plugins/action/copy.py\r\ndiff --git a/lib/ansible/plugins/action/copy.py b/lib/ansible/plugins/action/copy.py\r\nindex 2047671b47..f3abf22985 100644\r\n--- a/lib/ansible/plugins/action/copy.py\r\n+++ b/lib/ansible/plugins/action/copy.py\r\n@@ -525,11 +525,13 @@ class ActionModule(ActionBase):\r\n                 result.update(module_return)\r\n                 return self._ensure_invocation(result)\r\n \r\n-            paths = os.path.split(source_rel)\r\n+            paths = source_rel.split(os.path.sep)\r\n             dir_path = ''\r\n-            for dir_component in paths:\r\n-                os.path.join(dir_path, dir_component)\r\n+            # skip last file name\r\n+            for dir_component in paths[:-1]:\r\n+                dir_path = os.path.join(dir_path, dir_component)\r\n                 implicit_directories.add(dir_path)\r\n+\r\n             if 'diff' in result and not result['diff']:\r\n                 del result['diff']\r\n             module_executed = True\r\n```\r\nthen run it again:\r\n```shell\r\n[store@spyinx ~]$ rm -rf dest\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"\r\nspyinx | CHANGED => {\r\n    \"changed\": true,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m4.098s\r\nuser\t0m1.167s\r\nsys\t0m0.224s\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"    # \u518d\u6b21\u6267\u884c\r\nspyinx | SUCCESS => {\r\n    \"changed\": false,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m3.710s\r\nuser\t0m0.993s\r\nsys\t0m0.216s\r\n```\r\nonly leaf directories will be created by file module, the others have already been created when using copy module to transfer file\r\n\r\n### Actual Results\r\n\r\n```console\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"\r\nspyinx | CHANGED => {\r\n    \"changed\": true,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m34.394s\r\nuser\t0m2.923s\r\nsys\t0m1.169s\r\n[store@spyinx ~]$ time ansible spyinx -i hosts -m copy -a \"src=/home/store/test-create-1 dest=dest\"    # \u518d\u6b21\u6267\u884c\r\nspyinx | SUCCESS => {\r\n    \"changed\": false,\r\n    \"dest\": \"dest/\",\r\n    \"src\": \"/home/store/test-create-1\"\r\n}\r\n\r\nreal\t0m36.739s\r\nuser\t0m3.141s\r\nsys\t0m1.301s\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-20T04:49:47Z",
        "user": "spyinx",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 84342,
        "title": "Remove useless error messages when an exception occurs without specific information",
        "body": "### Summary\r\n\r\nwhen i run ansible command, there a  confusing output:\r\n```shell\r\n[store@spyinx ~]$ ansible spyinx -i hosts -m unarchive -a \"xxxx=xxxx\"\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None\r\nspyinx | FAILED! => {\r\n    \"changed\": false,\r\n    \"msg\": \"src (or content) and dest are required\"\r\n}\r\n```\r\n'NoneType: None' as a error message seems unnecessary, i think it can be removed from the error info. i find the source of the string:\r\n```python\r\n>>> from ansible.errors import AnsibleActionFail\r\n>>> try:\r\n...     raise AnsibleActionFail(\"xxxx\")\r\n... except Exception as e:\r\n...     print(e.result)\r\n... \r\n{'failed': True, 'msg': 'xxxx', 'exception': 'NoneType: None\\n'}\r\n>>> \r\n```\r\nso i think we can do something to avoid this situation:\r\n- first, define a tuple that contains unnecessary message:\r\n```python\r\n# lib/ansible/plugins/callback/__init__.py\r\n\r\nclass CallbackBase(AnsiblePlugin):\r\n\r\n    def __init__(self, display=None, options=None):\r\n    \r\n    \t# ...\r\n        self._hide_in_debug = ('changed', 'failed', 'skipped', 'invocation', 'skip_reason')\r\n        self._no_display_errors = ('NoneType: None',)   # here\r\n        \r\n    # ...\r\n```\r\n- then modify base callback plugin:\r\n```python\r\n# lib/ansible/plugins/callback/__init__.py\r\n\r\nclass CallbackBase(AnsiblePlugin):\r\n    # ...\r\n    \r\n    def _handle_exception(self, result, use_stderr=False):\r\n\r\n        if 'exception' in result:\r\n            msg = \"An exception occurred during task execution. \"\r\n            exception_str = to_text(result['exception'])\r\n            if self._display.verbosity < 3:\r\n                # extract just the actual error message from the exception text\r\n                error = exception_str.strip().split('\\n')[-1]\r\n                ### here split error in two parts #################\r\n                # msg += \"To see the full traceback, use -vvv. The error was: %s\" % error\r\n                msg += \"To see the full traceback, use -vvv.\"\r\n                if error and not error.strip() in self._no_display_errors:\r\n                    msg += \" The error was: %s\" % error\r\n                #########################################\r\n            else:\r\n                msg = \"The full traceback is:\\n\" + exception_str\r\n                del result['exception']\r\n\r\n            self._display.display(msg, color=C.COLOR_ERROR, stderr=use_stderr)\r\n    # ...  \r\n```\r\n- also need same change in oneline callback plugin:\r\n```python\r\nclass CallbackModule(CallbackBase):\r\n    # ...\r\n    \r\n    def v2_runner_on_failed(self, result, ignore_errors=False):\r\n        if 'exception' in result._result:\r\n            if self._display.verbosity < 3:\r\n                # extract just the actual error message from the exception text\r\n                error = result._result['exception'].strip().split('\\n')[-1]\r\n                # msg = \"An exception occurred during task execution. To see the full traceback, use -vvv. The error was: %s\" % error\r\n                ### here split error in two parts #################\r\n                msg = \"An exception occurred during task execution. To see the full traceback, use -vvv.\"\r\n                if error and not error.strip() in self._no_display_errors:\r\n                    msg += \" The error was: %s\" % error\r\n                #########################################\r\n            else:\r\n                msg = \"An exception occurred during task execution. The full traceback is:\\n\" + result._result['exception'].replace('\\n', '')\r\n\r\n            # ...\r\n    \r\n    # ...\r\n```\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\ncallback\r\n\r\n### Additional Information\r\n\r\nafter change the code above, i run ansible command again:\r\n```python\r\n[store@spyinx ~]$ ansible spyinx -i hosts -m unarchive -a \"xxxx=xxxx\"\r\nAn exception occurred during task execution. To see the full traceback, use -vvv.\r\nspyinx | FAILED! => {\r\n    \"changed\": false,\r\n    \"msg\": \"src (or content) and dest are required\"\r\n}\r\n[store@spyinx ~]$ ansible spyinx -i hosts -m unarchive -a \"xxxx=xxxx\" --one-line\r\nAn exception occurred during task execution. To see the full traceback, use -vvv.\r\nspyinx | FAILED! => {\"changed\": false,\"msg\": \"src (or content) and dest are required\"}\r\n```\r\nno error info.\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-20T02:52:42Z",
        "user": "spyinx",
        "labels": [
            "has_pr",
            "feature",
            "data_tagging"
        ]
    },
    {
        "number": 84340,
        "title": "Track datatagging fixes for devel",
        "body": "### Summary\r\n\r\nThis issue is to track the changes that have been merged into stable-2.18 and will need to be merged in devel before the next release. They should be covered by the new data tagging feature but recorded here to make sure it happens in that PR or as part of a forward commit.\r\n\r\n+ https://github.com/ansible/ansible/pull/83922\r\n+ https://github.com/ansible/ansible/pull/83949\r\n+ https://github.com/ansible/ansible/pull/84339\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible\r\n\r\n### Ansible Version\r\n\r\n```console\r\ndevel\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nN/A\r\n\r\n### Steps to Reproduce\r\n\r\nN/A\r\n\r\n### Expected Results\r\n\r\nN/A\r\n\r\n### Actual Results\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-20T01:17:16Z",
        "user": "jborean93",
        "labels": [
            "bug",
            "has_pr"
        ]
    },
    {
        "number": 84332,
        "title": "inconsistent behavior between delegate_to: \"\" and delegate_to: \"{{ undef() | default('') }}\"",
        "body": "### Summary\r\n\r\nHello,\r\n\r\nI'm opening this issue because I'm seeing a weird behavior of the `delegate_to` when it's combined with conditional set to `false`\r\n\r\nFor example, with conditional set to false, if delegate_to contains a variable that contains an empty string, I have the following error message : \r\n```\r\nfatal: [localhost -> {{ my_var }}]: FAILED! => {\"msg\": \"Empty hostname produced from delegate_to: \\\"{{ my_var  }}\\\"\"}\r\n```\r\n\r\nBut instead, if delegate_to is defined like this `delegate_to: \"\"` there is no error message like the previous one. \r\n\r\nWhy ???\r\n\r\nDelegate_to shouldn't be evaluated when he's surrounded by conditional defined to false.\r\n\r\nKnowing my playbook, I have some block of tasks with conditional. This conditional can be set to false for specific use case and then the variable inside the block shouldn't have to be set because we know that the block will be skipped.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/vars/manager.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.18.0]\r\n  config file = None\r\n  configured module search path = ['/home/ubuntu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ubuntu/.local/share/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/ubuntu/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/ubuntu/.local/bin/ansible\r\n  python version = 3.12.3 (main, Sep 11 2024, 14:17:37) [GCC 13.2.0] (/home/ubuntu/.local/share/pipx/venvs/ansible-core/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu, RHEL9\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nHere is the block that produce the error\r\n```yaml (paste below)\r\n---\r\n- name: Debug\r\n  hosts: localhost\r\n  vars:\r\n    my_var: \"\"\r\n\r\n - name : Debug block\r\n    when: false\r\n    block:\r\n      - name: Echo toto\r\n        ansible.builtin.debug:\r\n          msg: \"toto should be skipped\"\r\n        delegate_to: \"{{ my_var }}\"\r\n\r\n      - name: Echo titi\r\n        ansible.builtin.debug:\r\n          msg: \"titi should be skipped\"\r\n        delegate_to: \"{{ my_var }}\"\r\n```\r\n\r\nHere is the block that doesn't produce the error\r\n```yaml (paste below)\r\n---\r\n- name: Debug\r\n  hosts: localhost\r\n\r\n - name : Debug block\r\n    when: false\r\n    block:\r\n      - name: Echo toto\r\n        ansible.builtin.debug:\r\n          msg: \"toto should be skipped\"\r\n        delegate_to: \"\"\r\n\r\n      - name: Echo titi\r\n        ansible.builtin.debug:\r\n          msg: \"titi should be skipped\"\r\n        delegate_to: \"\"\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nHere is the expect result for the block that have delegate_to with variable :\r\n```\r\nTASK [Echo toto] *******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Echo titi] *******************************************************************************************\r\nskipping: [localhost]\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nHere is the result for the block that produce the error :\r\n\r\nTASK [Echo toto] *******************************************************************************************\r\nfatal: [localhost -> {{ my_var }}]: FAILED! => {\"msg\": \"Empty hostname produced from delegate_to: \\\"{{ my_var }}\\\"\"}\r\n```\r\n\r\nHere is the result for the block that doesn't produce the error :\r\n```\r\nTASK [Echo toto] *******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Echo titi] *******************************************************************************************\r\nskipping: [localhost]\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct\r\n\r\n",
        "created_at": "2024-11-19T08:15:33Z",
        "user": "craph",
        "labels": [
            "bug",
            "P3",
            "verified",
            "affects_2.18"
        ]
    },
    {
        "number": 84328,
        "title": "include_tasks does not work well with include_role.tasks_from if task is in subdirectory",
        "body": "### Summary\n\nIf I specify a task within a subdirectory in `tasks_from`, and this task uses `import_tasks` or `include_tasks`, ansible can't find the imported/included task files. This is not a problem if you don't have subdirectories (?).\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ninclude_role, include_tasks, import_tasks\n\n### Ansible Version\n\n```console\nansible [core 2.15.12]\r\n  config file = None\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/.venv/test/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/user/.venv/test/bin/ansible\r\n  python version = 3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0] (/home/user/.venv/test/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = nvim\n```\n\n\n### OS / Environment\n\nUbuntu 22.04\n\n### Steps to Reproduce\n\n```tree\r\ninclude_issue\r\n\u251c\u2500\u2500 roles\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 issue\r\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 tasks\r\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 subdir\r\n\u2502\u00a0\u00a0             \u251c\u2500\u2500 include.yml\r\n\u2502\u00a0\u00a0             \u2514\u2500\u2500 main.yml\r\n\u2514\u2500\u2500 test.yml\r\n```\r\n`test.yml`\r\n```yaml (paste below)\r\n- name: Test\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: Include from subdir\r\n      ansible.builtin.include_role:\r\n        name: issue\r\n        tasks_from: subdir/main.yml\r\n```\r\n\r\n`roles/issue/tasks/subdir/main.yml`\r\n```yaml\r\n- name: Include another task\r\n  ansible.builtin.include_tasks: include.yml\r\n```\r\n`roles/issue/tasks/subdir/include.yml`\r\n```yaml\r\n- name: Print stuff\r\n  ansible.builtin.debug:\r\n    msg: Hello\r\n```\r\n\r\nAnd finally\r\n```terminal\r\nansible-playbook test.yml\r\n```\r\n\n\n### Expected Results\n\nI expected the path of the included task file to be relative to the path of the file that calls `include_tasks`, but ansible doesn't look inside the subdirectory.\r\nIt works if I move both `main.yml` and `include.yml` up to the `tasks` directory (and remove the `subdir/` in `test.yml`) and that's fine, but it also works if I only move `include.yml`, which doesn't seem intuitive to me.\n\n### Actual Results\n\n```console\nPLAY [Test] *****************************************************************************************************************************************************************\r\n\r\nTASK [Include from subdir] **************************************************************************************************************************************************\r\n\r\nTASK [issue : Include another task] *****************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"reason\": \"Could not find or access '/home/user/include_issue/include.yml' on the Ansible Controller.\"}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-18T16:11:11Z",
        "user": "Lun4m",
        "labels": [
            "module",
            "bug",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 84311,
        "title": "Windows Defender Application Control for PowerShell",
        "body": "### Summary\n\nThis tracks the work needed to support Windows Defender Application Control ([WDAC](https://learn.microsoft.com/en-us/hololens/windows-defender-application-control-wdac)) for Windows. WDAC can be used as a way to block all software and scripts on a Windows host except for an explicitly allowed list of publishers. Ansible needs to provide a mechanism to sign content for WDAC and execute it in a way that works in WDAC.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\npowershell\n\n### Additional Information\n\nN/A\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-13T18:24:23Z",
        "user": "jborean93",
        "labels": [
            "P2",
            "feature"
        ]
    },
    {
        "number": 84286,
        "title": "use makedirs_safe() to create ~/.ssh should have a specific permissions\uff080o700\uff09",
        "body": "### Summary\n\nwhen i read the code in paramiko_ssh.py, i found that ansible use  makedirs_safe()  to create ~/.ssh without  a specific permissions  in close() method\uff08also in _save_ssh_host_keys()\uff09,\r\nbut it should better be 0o700, so i think the makedirs_safe() in close() and  _save_ssh_host_keys() should add mode param with the value of 0o700\uff0clike makedirs_safe(path, mode=0o700)\u3002There are two code snippets containing makedirs_safe():\r\n```shell\r\nclass Connection(ConnectionBase):\r\n    ''' SSH based connections with Paramiko '''\r\n\r\n    transport = 'paramiko'\r\n    _log_channel: str | None = None\r\n\r\n    # ...\r\n\r\n    def _save_ssh_host_keys(self, filename: str) -> None:\r\n        # ...\r\n\r\n        path = os.path.expanduser(\"~/.ssh\")\r\n        makedirs_safe(path)                                      # makedirs_safe(dirname, mode=0o700) \r\n\r\n        # ...\r\n\r\n    def close(self) -> None:\r\n        # ...\r\n\r\n        if self.get_option('host_key_checking') and self.get_option('record_host_keys') and self._any_keys_added():\r\n            lockfile = self.keyfile.replace(\"known_hosts\", \".known_hosts.lock\")\r\n            dirname = os.path.dirname(self.keyfile)   # self.keyfile is os.path.expanduser(\"~/.ssh/known_hosts\"), see in _connect_uncached()\r\n            makedirs_safe(dirname)                            # makedirs_safe(dirname, mode=0o700) \r\n\r\n            # ...\r\n\r\n        # ...\r\n            \r\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlib/ansible/plugins/connection/paramiko_ssh.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.17.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/store/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/python3.12/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/store/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/python3.12/bin/ansible\r\n  python version = 3.12.4 (main, Jul 17 2024, 16:22:20) [GCC 10.2.1 20200825 (Alibaba 10.2.1-3.8 2.32)] (/opt/python3.12/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\nAlibaba Cloud Linux release 3 (Soaring Falcon)\n\n### Steps to Reproduce\n\nsimple test: \r\n```shell\r\n[store@spyinx ~]$ rm -rf ~/.ssh/\r\n[store@spyinx ~]$ ls ~/.ssh\r\nls: cannot access '/home/store/.ssh': No such file or directory\r\n[store@spyinx ~]$ ansible all -i hosts -m ping \r\n\r\nparamiko: The authenticity of host 'spyinx' can't be established.\r\nThe ssh-ed25519 key fingerprint is b'5c67b2b4b6b32535e4e8ef84fc239a64'.\r\nAre you sure you want to continue connecting (yes/no)?\r\nyes^M[WARNING]: Platform linux on host spyinx is using the discovered Python interpreter at /opt/python3.12/bin/python3.12, but future installation of\r\nanother Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-\r\ncore/2.17/reference_appendices/interpreter_discovery.html for more information.\r\nspyinx | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/opt/python3.12/bin/python3.12\"\r\n    },\r\n    \"changed\": false,\r\n    \"ping\": \"pong\"\r\n}\r\n[store@spyinx ~]$ ls ~/.ssh -ld\r\ndrwxrwxr-x 2 store store 4096 Nov  8 16:40 /home/store/.ssh\r\n```\r\n\n\n### Expected Results\n\ni add mode param in makedirs_safe() and then run ansible command again:\r\n```shell\r\n[store@spyinx ~]$ rm -rf ~/.ssh/\r\n[store@spyinx ~]$ ansible all -i hosts -m ping \r\n\r\nparamiko: The authenticity of host 'spyinx' can't be established.\r\nThe ssh-ed25519 key fingerprint is b'5c67b2b4b6b32535e4e8ef84fc239a64'.\r\nAre you sure you want to continue connecting (yes/no)?\r\nyes^M[WARNING]: Platform linux on host spyinx is using the discovered Python interpreter at /opt/python3.12/bin/python3.12, but future installation of\r\nanother Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-\r\ncore/2.17/reference_appendices/interpreter_discovery.html for more information.\r\nspyinx | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/opt/python3.12/bin/python3.12\"\r\n    },\r\n    \"changed\": false,\r\n    \"ping\": \"pong\"\r\n}\r\n[store@spyinx ~]$ ls -ld  ~/.ssh/\r\ndrwx------ 2 store store 4096 Nov  8 17:30 /home/store/.ssh/\r\n```\r\n\n\n### Actual Results\n\n```console\nsee above\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-08T09:33:17Z",
        "user": "spyinx",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 84274,
        "title": "Support for GET parameters in module_utils.urls.Request",
        "body": "### Summary\r\n\r\nI'd like to use `module_utils.urls.Request` to issue HTTP requests with parameters embedded in the URL.\r\n\r\nToday, I need to take care of properly URL-encoding these and appending them to the URL myself, e.g. with something like:\r\n```python\r\nurl = 'https://example.com/'\r\nif params:\r\n  url += '?' + six.moves.urllib.parse.urlencode(params)\r\n\u2026\r\n```\r\n\r\nThe Python `requests` library has this nice feature, that if you pass `params={'some': 'parameter'}` to a GET request, it will automatically convert this for us (see https://requests.readthedocs.io/en/latest/user/quickstart/#passing-parameters-in-urls):\r\n```\r\npayload = {'key1': 'value1', 'key2': 'value2'}\r\nr = requests.get('https://httpbin.org/get', params=payload)\r\nprint(r.url)\r\n> https://httpbin.org/get?key2=value2&key1=value1\r\n```\r\n\r\nI'd love to have the same functionality in `module_utils.urls.Request` :)\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nlib/ansible/module_utils/urls.py\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-07T08:15:20Z",
        "user": "evgeni",
        "labels": [
            "waiting_on_contributor",
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 84244,
        "title": "ansible-test prints upstream python modules coverage on unit tests",
        "body": "### Summary\n\nWhen testing a custom collection, I run unit tests using `ansible-test` on venvs with coverage report enabled. As a result I get coverage reports of all the installed python modules in all the venvs being used to execute the tests, in stead of just the code that I am actually trying to test.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-test\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.17.5]\r\n  config file = None\r\n  configured module search path = ['/Users/diegom/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/diegom/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] (/usr/local/opt/python@3.12/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nMacOS, Python 3.12\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\nansible-test units --coverage --color --venv\r\nansible-test coverage report\r\n```\r\n\n\n### Expected Results\n\nOnly the code that I wrote should be in the report, like what happens with integration or sanity tests, I expect to see something like this:\r\n\r\n```\r\nName                                                                                                    Stmts   Miss Branch BrPart  Cover\r\n-----------------------------------------------------------------------------------------------------------------------------------------\r\ntests/unit/plugins/modules/test_demo_module.py                                                              2      0      0      0   100%\r\n-----------------------------------------------------------------------------------------------------------------------------------------\r\nTOTAL                                                                                                       2      0      0      0   100%\r\n```\n\n### Actual Results\n\n```console\n> ansible-test coverage report\r\nName                                                                                                    Stmts   Miss Branch BrPart  Cover\r\n-----------------------------------------------------------------------------------------------------------------------------------------\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_distutils_hack/__init__.py             98     93     36      0     7%\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_pytest/__init__.py                      3      0      0      0   100%\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_pytest/_argcomplete.py                 37     23     12      1    31%\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_pytest/_code/__init__.py               10      0      0      0   100%\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_pytest/_code/code.py                  724    470    306     39    30%\r\ntests/output/.tmp/delegation/python3.7/lib/python3.7/site-packages/_pytest/_code/source.py                145    107     63      2    19%\r\n....\r\ntests/output/.tmp/delegation/python3.12/lib/python3.12/site-packages/yaml/resolver.py                     135     97     96      2    21%\r\ntests/output/.tmp/delegation/python3.12/lib/python3.12/site-packages/yaml/scanner.py                      758    677    352      0     7%\r\ntests/output/.tmp/delegation/python3.12/lib/python3.12/site-packages/yaml/serializer.py                    85     70     36      0    12%\r\ntests/output/.tmp/delegation/python3.12/lib/python3.12/site-packages/yaml/tokens.py                        76     27      0      0    64%\r\ntests/unit/plugins/modules/test_demo_module.py                                                              2      0      0      0   100%\r\n-----------------------------------------------------------------------------------------------------------------------------------------\r\nTOTAL                                                                                                  134826  80010  53092   6069    35%\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-11-04T16:31:51Z",
        "user": "dmarav",
        "labels": [
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 84232,
        "title": "Create stable branches for default container repos",
        "body": "### Summary\n\nThis should be done immediately following code freeze.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\n`ansible-test`",
        "created_at": "2024-11-01T18:59:04Z",
        "user": "mattclay",
        "labels": [
            "feature",
            "ansible-test"
        ]
    },
    {
        "number": 84148,
        "title": "SSH mux does not distinguish different inventory files",
        "body": "### Summary\n\nI have to run an Ansible playbook on two sets of machines; each of them has an `inventory.ini` file that identifies them using their SSH config (the rest is the same). \r\n\r\nWhen I actually ran it, I found that it ended up as the same playbook was run twice on the same set of machines (first inventory file used). After digging using Wireshark, I saw it only established a connection to the bastion of the first set of machines, and I could only see one ssh mux process in the background.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nssh\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\nansible [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/unics/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/unics/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.3 (main, Sep 11 2024, 14:17:37) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nUbuntu 24.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nPlaybook:\r\n```yaml (paste below)\r\n- name: Install openvpn\r\n  hosts: bastion\r\n  gather_facts: true\r\n  become: true\r\n  tasks:\r\n    - name: debug host\r\n      debug:\r\n        var: ansible_ssh_common_args\r\n    - name: Check if openvpn@bastion service exists\r\n      systemd:\r\n        name: openvpn@bastion\r\n        state: started \r\n      register: service_status\r\n      ignore_errors: yes \r\n\r\n    - debug:\r\n        var: service_status\r\n```\r\n\r\nInventory files (two are the same except ssh_conf path)\r\n```\r\n[all:vars]\r\nansible_ssh_common_args=\"-F ./vpc-unics-office/ssh_config -o ControlMaster=no\"\r\nglobal_comm_password=\"xxxx\"\r\nglobal_comm_ip=\"34.221.xx.xx\"\r\nvpc_cidr=\"10.1.0.0/16\"\r\nbastion_ip=\"10.1.100.10\"\r\n\r\n[static]\r\nrouter ansible_host=router ansible_user=ubuntu\r\nbastion ansible_host=bastion ansible_user=ubuntu\r\nlogger ansible_host=logger ansible_user=ubuntu\r\n```\r\n\r\nSSH config (two are the same except public IP and identity file)\r\n```\r\nHost *\r\n   StrictHostKeyChecking no\r\n   UserKnownHostsFile=/dev/null\r\n   User ubuntu\r\n\r\nHost bastion 52.27.xx.xx\r\n    HostName 52.27.xx.xx\r\n    IdentityFile ./vpc-unics-office/id_rsa\r\n```\r\n\r\nShell script for running it\r\n```\r\nANSIBLE_FACT_CACHING=none ansible-playbook --inventory vpc-unics-office/inventory.ini inf/ansible/vpn_openvpn.yml --extra-vars vpc=unics-office --ssh-common-args='-o ControlMaster=no'\r\nANSIBLE_FACT_CACHING=none ansible-playbook --inventory vpc-unics-cloud/inventory.ini inf/ansible/vpn_openvpn.yml --extra-vars vpc=unics-cloud --flush-cache --ssh-common-args='-o ControlMaster=no'\r\n```\r\n\r\nI have OpenVPN up and running on one of the host but not even installed on the other. This shell script always gives the same result, both running or both dne, depending on which inventory used first.\r\n\n\n### Expected Results\n\nIt should connect to the correct machine and give the true result. For the machine that has OpenVPN running, it should say OK, and for the machine without OpenVPN installed, it should report the error detail but not failing (since I set it to ignore errors). Since I have configured OpenVPN only on one machine, the result shouldn't be the same.\n\n### Actual Results\n\n```console\nThey are the same; either both are shown as running or both are shown as doesn't exist, which is not the truth. Due to the concern for private info in the -vvvv output, I'd rather not post it here.\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-20T10:31:17Z",
        "user": "yuxiaolejs",
        "labels": [
            "bug",
            "affects_2.16"
        ]
    },
    {
        "number": 84147,
        "title": "\u200eURL safe b64encode and \u200eb64decode",
        "body": "### Summary\r\n\r\nThe current \u200eb64encode and \u200eb64decode filters do not allow for producing encoded strings according to [RFC 4648 section 5](https://datatracker.ietf.org/doc/html/rfc4648#section-5), commonly referred to as base64url, which are intended for use in URLs and file names. I recently had cause to require this for building a URL in a template, and had to resort to a custom filter plugin. This wasn't difficult at all, however I thought the community may benefit from this being made available to all in the core filters.\r\n\r\nPython's base64 module used by the current filter implementation provides this out of the box; so before I rattle off a PR, are we in agreement that such a thing would be useful?\r\n\r\nShould such a feature be implemented by adding an optional parameter to the existing base64 filters, or by implementation of an altogether new pair? Python's module provides different functions, but my thoughts were that fewer similarly named filters in the same namespace would be the preferable option for Ansible.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nplugins\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n# My config file\r\nurl_param = {{ my_variable | b64encode(urlsafe=True) }}\r\n```\r\nOr alternately something like\r\n```\r\n# My config file\r\nurl_param = {{ my_variable | urlsafe_b64encode }}\r\n```\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-20T03:16:44Z",
        "user": "andrensairr",
        "labels": [
            "waiting_on_contributor",
            "feature"
        ]
    },
    {
        "number": 84123,
        "title": "`ansible.builtin.yum:` list always return \"repo\": \"@System\" as result",
        "body": "### Summary\r\n\r\nwhen I try running the following:\r\n```\r\n- name: Retrieve all installed RPM information\r\n  ansible.builtin.yum:\r\n    list=installed\r\n  register: rpm_packages\r\n\r\n- name: debug\r\n  ansible.builtin.debug:\r\n    var: rpm_packages.results\r\n```\r\n\r\nthe result has always \"repo\": \"@System\" in every entry despite when running `dnf list --installed`, the repo varies. for instance:\r\n`rpm_packages.results` entry:\r\n```\r\n{\r\n            \"arch\": \"noarch\",\r\n            \"envra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"epoch\": \"0\",\r\n            \"name\": \"yum\",\r\n            \"nevra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"release\": \"20.el8\",\r\n            \"repo\": \"@System\",\r\n            \"version\": \"4.7.0\",\r\n            \"yumstate\": \"installed\"\r\n        }\r\n```\r\nand the corresponding `dnf list --installed | grep yum` resulted in:\r\n```\r\nyum.noarch                                                 4.7.0-20.el8                                  @anaconda\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ndnf\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.13.13]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/mrorange/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/mrorange/.local/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/mrorange/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/mrorange/.local/bin/ansible\r\n  python version = 3.8.20 (default, Sep  7 2024, 18:35:08) [GCC 11.4.0]\r\n  jinja version = 3.1.4\r\n  libyaml = False\r\n```\r\nupdate: also tested on 2.16.11, (last known working version before broken in 2.17: https://github.com/ansible/ansible/issues/82068) still same issue\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nansible-config dump --only-changed\r\nDEFAULT_ROLES_PATH(env: ANSIBLE_ROLES_PATH) = ['<our local path>']\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nTarget node: RHEL8.10\r\n\r\nTrying to running newer version of ansible on the control node (2.17.5) resulting in another issue stated in  https://github.com/ansible/ansible/issues/82068 so need to fallback to version 2.13.13.\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Retrieve all installed RPM information\r\n  ansible.builtin.yum:\r\n    list=installed\r\n  register: rpm_packages\r\n\r\n- name: debug\r\n  ansible.builtin.debug:\r\n    var: rpm_packages.results\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n{\r\n            \"arch\": \"noarch\",\r\n            \"envra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"epoch\": \"0\",\r\n            \"name\": \"yum\",\r\n            \"nevra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"release\": \"20.el8\",\r\n            \"repo\": \"@anaconda\",\r\n            \"version\": \"4.7.0\",\r\n            \"yumstate\": \"installed\"\r\n        }\r\n\r\n### Actual Results\r\n\r\n```console\r\n{\r\n            \"arch\": \"noarch\",\r\n            \"envra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"epoch\": \"0\",\r\n            \"name\": \"yum\",\r\n            \"nevra\": \"0:yum-4.7.0-20.el8.noarch\",\r\n            \"release\": \"20.el8\",\r\n            \"repo\": \"@System\",\r\n            \"version\": \"4.7.0\",\r\n            \"yumstate\": \"installed\"\r\n        }\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-14T20:21:02Z",
        "user": "yhzs8",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 84117,
        "title": "any_errors_fatal stops further play even if the hosts have passed rescue",
        "body": "### Summary\r\n\r\nThe problem occurs if the any_errors_fatal parameter is enabled and one of the hosts is expected to fail with an error.\r\n\r\nAnsible correctly transitions all hosts into rescue mode, but when plays are subsequently launched, Ansible only replays roles on the host where the error occurred, ignoring all others.\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlinear.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.5]\r\n  config file = /tests/ansible.cfg\r\n  configured module search path = ['/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /venv_test_ansible/lib/python3.11/site-packages/ansible\r\n  executable location = /venv_test_ansible/bin/ansible\r\n  python version = 3.11.6 (v3.11.6:8b6ee5ba3b, Oct  2 2023, 11:18:21) [Clang 13.0.0 (clang-1300.0.29.30)] (/venv_test_ansible/bin/python3.11)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\nANY_ERRORS_FATAL(ansible.cfg) = True\r\nCACHE_PLUGIN(ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(ansible.cfg) = cache.json\r\nCONFIG_FILE() = ansible.cfg\r\nDEFAULT_DEBUG(env: ANSIBLE_DEBUG) = False\r\nDEFAULT_FORKS(ansible.cfg) = 20\r\nDEFAULT_GATHERING(ansible.cfg) = smart\r\nDEFAULT_STDOUT_CALLBACK(ansible.cfg) = yaml\r\nDEFAULT_TIMEOUT(ansible.cfg) = 600\r\nDEPRECATION_WARNINGS(ansible.cfg) = False\r\nDISPLAY_SKIPPED_HOSTS(ansible.cfg) = False\r\nENABLE_TASK_DEBUGGER(env: ANSIBLE_ENABLE_TASK_DEBUGGER) = False\r\nHOST_KEY_CHECKING(ansible.cfg) = False\r\nINVENTORY_ENABLED(ansible.cfg) = ['script', 'ini', 'yaml']\r\nPAGER(env: PAGER) = less\r\nVARIABLE_PRECEDENCE(ansible.cfg) = ['all_plugins_play', 'all_inventory', 'all_plugins_inventory', 'groups_plugins_play', 'groups_inventory', 'groups_plugins_inventory']\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_uri(ansible.cfg) = cache.json\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\ndisplay_skipped_hosts(ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(ansible.cfg) = False\r\nssh_args(ansible.cfg) = -o ControlMaster=auto -o ControlPersist=600s\r\ntimeout(ansible.cfg) = 600\r\n\r\nssh:\r\n___\r\ncontrol_path(ansible.cfg) = %(directory)s/%%h-%%r\r\nhost_key_checking(ansible.cfg) = False\r\npipelining(ansible.cfg) = True\r\nssh_args(ansible.cfg) = -o ControlMaster=auto -o ControlPersist=600s\r\ntimeout(ansible.cfg) = 600\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 8, DEBIAN 10\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Get ping response\r\n  hosts: all\r\n  tasks:\r\n\r\n    - name: checkup\r\n      block:\r\n\r\n        - name: debug\r\n          debug:\r\n            msg: 'start'\r\n\r\n        - ansible.builtin.debug: msg=\"{{ test_msg }}\"\r\n          when: inventory_hostname == 'host_3'\r\n\r\n        - block:\r\n            - name: debug\r\n              debug:\r\n                msg: 'test1'\r\n\r\n            - name: debug\r\n              debug:\r\n                msg: 'test2'\r\n\r\n          when: inventory_hostname in groups[\"test_group\"]\r\n\r\n        - name: debug\r\n          debug:\r\n            msg: 'finish'\r\n\r\n      rescue:\r\n\r\n\r\n        - ansible.builtin.debug:\r\n            msg: \"{{ ansible_failed_result | d(false) }}\"     \r\n\r\n      always:\r\n        - name: debug\r\n          debug:\r\n            msg: 'finish always'\r\n\r\n- name: test\r\n  hosts: all\r\n  tasks:\r\n\r\n    - ansible.builtin.debug:\r\n        msg: \"{{ play_hosts }}\"\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n```\r\nPLAY [Get ping response] *******************************************************************************************************************************************************************************************************\r\n\r\nTASK [debug] *******************************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:8\r\nok: [host_1] => \r\n  msg: start\r\nok: [host_2] => \r\n  msg: start\r\nok: [host_3] => \r\n  msg: start\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:12\r\nfatal: [host_3]: FAILED! => \r\n  msg: |-\r\n    The task includes an option with an undefined variable.. 'test_msg' is undefined\r\n  \r\n    The error appears to be in '1.yml': line 12, column 11, but may\r\n    be elsewhere in the file depending on the exact syntax problem.\r\n  \r\n    The offending line appears to be:\r\n  \r\n  \r\n            - ansible.builtin.debug: msg=\"{{ test_msg }}\"\r\n              ^ here\r\n    We could be wrong, but this one looks like it might be an issue with\r\n    missing quotes. Always quote template expression brackets when they\r\n    start a value. For instance:\r\n  \r\n        with_items:\r\n          - {{ foo }}\r\n  \r\n    Should be written as:\r\n  \r\n        with_items:\r\n          - \"{{ foo }}\"\r\nMETA: cleared host errors\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:35\r\nok: [host_1] => \r\n  msg: false\r\nok: [host_2] => \r\n  msg: false\r\nok: [host_3] => \r\n  msg:\r\n    failed: true\r\n    msg: |-\r\n      The task includes an option with an undefined variable.. 'test_msg' is undefined\r\n  \r\n      The error appears to be in '1.yml': line 12, column 11, but may\r\n      be elsewhere in the file depending on the exact syntax problem.\r\n  \r\n      The offending line appears to be:\r\n  \r\n  \r\n              - ansible.builtin.debug: msg=\"{{ test_msg }}\"\r\n                ^ here\r\n      We could be wrong, but this one looks like it might be an issue with\r\n      missing quotes. Always quote template expression brackets when they\r\n      start a value. For instance:\r\n  \r\n          with_items:\r\n            - {{ foo }}\r\n  \r\n      Should be written as:\r\n  \r\n          with_items:\r\n            - \"{{ foo }}\"\r\n\r\nTASK [debug] *******************************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:39\r\nok: [host_1] => \r\n  msg: finish always\r\nok: [host_2] => \r\n  msg: finish always\r\nok: [host_3] => \r\n  msg: finish always\r\n\r\nPLAY [test] ********************************************************************************************************************************************************************************************************************\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:47\r\nok: [host_1] => \r\n  msg:\r\n  - host_1\r\n  - host_2\r\n  - host_3\r\nok: [host_2] => \r\n  msg:\r\n  - host_1\r\n  - host_2\r\n  - host_3\r\nok: [host_3] => \r\n  msg:\r\n  - host_1\r\n  - host_2\r\n  - host_3\r\n\r\nPLAY RECAP *********************************************************************************************************************************************************************************************************************\r\nhost_1                     : ok=4    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost_2                     : ok=4    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost_3                     : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0  \r\n```\r\n\r\nThe expected result can be achieved by adding the following task on rescue:\r\n\r\nmeta: clear_host_errors\r\nHowever, it seems that the playbook should either completely fail or replay all subsequent hosts.\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [Get ping response] *******************************************************************************************************************************************************************************************************\r\n\r\nTASK [debug] *******************************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:8\r\nok: [host_1] => \r\n  msg: start\r\nok: [host_2] => \r\n  msg: start\r\nok: [host_3] => \r\n  msg: start\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:12\r\nfatal: [host_3]: FAILED! => \r\n  msg: |-\r\n    The task includes an option with an undefined variable.. 'test_msg' is undefined\r\n  \r\n    The error appears to be in '1.yml': line 12, column 11, but may\r\n    be elsewhere in the file depending on the exact syntax problem.\r\n  \r\n    The offending line appears to be:\r\n  \r\n  \r\n            - ansible.builtin.debug: msg=\"{{ test_msg }}\"\r\n              ^ here\r\n    We could be wrong, but this one looks like it might be an issue with\r\n    missing quotes. Always quote template expression brackets when they\r\n    start a value. For instance:\r\n  \r\n        with_items:\r\n          - {{ foo }}\r\n  \r\n    Should be written as:\r\n  \r\n        with_items:\r\n          - \"{{ foo }}\"\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:33\r\nok: [host_1] => \r\n  msg: false\r\nok: [host_2] => \r\n  msg: false\r\nok: [host_3] => \r\n  msg:\r\n    failed: true\r\n    msg: |-\r\n      The task includes an option with an undefined variable.. 'test_msg' is undefined\r\n  \r\n      The error appears to be in '1.yml': line 12, column 11, but may\r\n      be elsewhere in the file depending on the exact syntax problem.\r\n  \r\n      The offending line appears to be:\r\n  \r\n  \r\n              - ansible.builtin.debug: msg=\"{{ test_msg }}\"\r\n                ^ here\r\n      We could be wrong, but this one looks like it might be an issue with\r\n      missing quotes. Always quote template expression brackets when they\r\n      start a value. For instance:\r\n  \r\n          with_items:\r\n            - {{ foo }}\r\n  \r\n      Should be written as:\r\n  \r\n          with_items:\r\n            - \"{{ foo }}\"\r\n\r\nTASK [debug] *******************************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:37\r\nok: [host_1] => \r\n  msg: finish always\r\nok: [host_2] => \r\n  msg: finish always\r\nok: [host_3] => \r\n  msg: finish always\r\n\r\nPLAY [test] ********************************************************************************************************************************************************************************************************************\r\n\r\nTASK [ansible.builtin.debug] ***************************************************************************************************************************************************************************************************\r\ntask path: 1.yml:45\r\nok: [host_3] => \r\n  msg:\r\n  - host_3\r\n\r\nPLAY RECAP *********************************************************************************************************************************************************************************************************************\r\nhost_1                     : ok=3    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost_2                     : ok=3    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost_3                     : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0\r\n```\r\n\r\nAs I understand, this effect appeared after the following PR: \r\n\r\nhttps://github.com/ansible/ansible/pull/78680/commits/dc3891420077ac499944b9ebea4fb595a15e2fbc#diff-0ede8d71618eb5bdee10d0d8c7b802a2415dc130ce819a715afa157db818ca09\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-13T16:09:10Z",
        "user": "Cmertho",
        "labels": [
            "bug",
            "has_pr",
            "verified",
            "affects_2.17"
        ]
    },
    {
        "number": 84107,
        "title": "`ansible.builtin.command` module creates `stdout` data on it's own even when command itself is not run",
        "body": "### Summary\n\nWhen using `ansible.builtin.command` with `creates` field (and `removes` for that matter), which runs the command only if FS object in question does not exits, command is correctly not being run.\r\n\r\nHowever if one also uses `stdout` in tasks further down, the command creates bogus output: `skipped, since XXX exists`.\r\n\r\nThis is rather confusing, as it blurs the certainty of `stdout`'s origin. I guess some ansible users just \"grep\" for this output and act accordingly, or create some other logic hacks, but it would be much \"safer\" if `command` module never even registered bogus `stdout`, because it in fact does not originate from command's executable itself, but from ansible command module internal's instead.\r\n\r\nI believe that in task's skipped state, when `creates` FS object already exists, `command` should have not even \"defined\" `stdout` variable. Then subsequent task logic could be much more simpler.\r\n\r\nUnfortunately this would probably break lot of other scripts/playbooks that relay on this hackish behaviour.\r\n\r\nSo instead I propose new boolean variable, something akin to `no_stdout_on_skipped`, set by default to `false`, that when set to `ture`, skips creation of `stdout` completely.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.command\n\n### Ansible Version\n\n```console\n#$ ansible --version\r\nall versions\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nOracleLinux9\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n```sh\r\nssh ansible-user@remote_host 'touch /tmp/file'\r\n```\r\n\r\n```yaml (paste below)\r\n---\r\n- name: Create bogus output and set it as variable\r\n  hosts: remote_host\r\n  tasks:\r\n    - name: Skipped if remote file exists\r\n      ansible.builtin.command:\r\n        cmd: /usr/bin/echo \"actual output\"\r\n        creates: /tmp/file\r\n      register: cmdoutput\r\n\r\n    - name: Dump the registered value\r\n      debug:\r\n        var: cmdoutput\r\n```\r\n\n\n### Expected Results\n\n`cmdoutput` should have `stdout` and `stdout_lines`, preferably empty, or undefined:\r\n\r\n```\r\nTASK [Dump the registered value] ****************************************************************************************\r\nok: [remote_host] => {\r\n    \"cmdoutput\": {\r\n        \"changed\": false,\r\n        \"cmd\": [\r\n            \"/usr/bin/echo\",\r\n            \"actual output\"\r\n        ],\r\n        \"delta\": null,\r\n        \"end\": null,\r\n        \"failed\": false,\r\n        \"msg\": \"Did not run command since '/tmp/file' exists\",\r\n        \"rc\": 0,\r\n        \"start\": null,\r\n        \"stderr\": \"\",\r\n        \"stderr_lines\": [],\r\n        \"stdout\": \"\",\r\n        \"stdout_lines\": []\r\n    }\r\n}\r\n```\n\n### Actual Results\n\n```console\nTASK [Dump the registered value] *****************************************************************************************ok: [remote_host] => {\r\n    \"cmdoutput\": {\r\n        \"changed\": false,\r\n        \"cmd\": [\r\n            \"/usr/bin/echo\",\r\n            \"actual output\"\r\n        ],\r\n        \"delta\": null,\r\n        \"end\": null,\r\n        \"failed\": false,\r\n        \"msg\": \"Did not run command since '/tmp/file' exists\",\r\n        \"rc\": 0,\r\n        \"start\": null,\r\n        \"stderr\": \"\",\r\n        \"stderr_lines\": [],\r\n        \"stdout\": \"skipped, since /tmp/file exists\",\r\n        \"stdout_lines\": [\r\n            \"skipped, since /tmp/file exists\"\r\n        ]\r\n    }\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-10T17:07:54Z",
        "user": "skt-mmisuth",
        "labels": [
            "module",
            "bug",
            "data_tagging"
        ]
    },
    {
        "number": 84101,
        "title": "Deprecate a few esoteric playbook syntax cases",
        "body": "### Summary\n\nThe core team discussed and agreed to deprecate three relatively ancient and undocumented playbook syntax features that exist in the code but did not have tests, and caused difficulties with new feature implementations:\r\n\r\n```yaml\r\n  # DEPRECATION 1\r\n  - name: action-as-dict (static-only, template-to-dict never worked anyway)\r\n    action:\r\n      module: \"{{ 'echo' }}\"\r\n      args: \"{{ echo_args }}\"  # note that `module` and `args` are children of `action`\r\n    vars:\r\n      echo_args:\r\n        a: 1'\r\n```\r\n\r\n```yaml\r\n  # DEPRECATION 2\r\n  - name: silent shadowing of task args dict resolved from a template by variable params dict resolved from a template\r\n    echo: '{{ variable_params }}'\r\n    args: '{{ task_args }}'\r\n    vars:\r\n      variable_params:\r\n        a: from_vp\r\n        c: from_vp\r\n      task_args:\r\n        a: from_task_args\r\n        b: from_task_args  # note that `b` is completely omitted because all task args are lost\r\n```\r\n\r\n```yaml\r\n  # DEPRECATION 3\r\n  - name: kv and task args at the same time\r\n    echo: kv1=kv\r\n    args:\r\n      kv1: task_arg\r\n      kv2: task_arg\r\n```\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nmod_args.py\n\n### Additional Information\n\nTo be clear: these deprecations *do not* affect the general ability to use dynamic/templated values for the `action` keyword, dynamic arguments, or old-style k=v arguments.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-09T22:27:44Z",
        "user": "nitzmahone",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 84075,
        "title": "`ansible-test` host properties detection sometimes tracebacks in CI",
        "body": "### Summary\r\n\r\nSpecifically, this https://github.com/ansible/ansible/blob/f1f0d9bd5355de5b45b894a9adf649abb2f97df5/test/lib/ansible_test/_internal/docker_util.py#L327C31-L327C37 causes an `IndexError`, meaning that blocks is sometimes a list of 2 elements and not 3.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-test\r\n\r\n### Ansible Version\r\n\r\n```console\r\ndevel\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 24.04 in our CI\r\n\r\n### Steps to Reproduce\r\n\r\nContext: https://dev.azure.com/ansible/ansible/_build/results?buildId=125234&view=logs&j=6ce7cab1-69aa-56f4-11b1-869c767eb409&t=84972f9e-94d6-5fa2-afad-226d677b2f72&l=150\r\n\r\n### Expected Results\r\n\r\nException is handled, but I don't know what causes `ansible-test-probe` to print out less lines.\r\n\r\n### Actual Results\r\n\r\n```python-traceback\r\nTraceback (most recent call last):\r\n  File \"/__w/1/ansible/bin/ansible-test\", line 44, in <module>\r\n    main()\r\n  File \"/__w/1/ansible/bin/ansible-test\", line 35, in main\r\n    cli_main(args)\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/__init__.py\", line 65, in main\r\n    main_internal(cli_args)\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/__init__.py\", line 91, in main_internal\r\n    args.func(config)\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/commands/integration/posix.py\", line 43, in command_posix_integration\r\n    host_state, internal_targets = command_integration_filter(args, all_targets)\r\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/commands/integration/__init__.py\", line 941, in command_integration_filter\r\n    cloud_init(args, internal_targets)\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/commands/integration/cloud/__init__.py\", line 162, in cloud_init\r\n    provider.setup()\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/commands/integration/cloud/httptester.py\", line 57, in setup\r\n    descriptor = run_support_container(\r\n                 ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/containers.py\", line 157, in run_support_container\r\n    max_open_files = detect_host_properties(args).max_open_files\r\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/__w/1/ansible/test/lib/ansible_test/_internal/docker_util.py\", line 327, in detect_host_properties\r\n    mounts = MountEntry.loads(blocks[2])\r\n                              ~~~~~~^^^\r\nIndexError: list index out of range\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-08T13:34:04Z",
        "user": "webknjaz",
        "labels": [
            "bug",
            "has_pr"
        ]
    },
    {
        "number": 84074,
        "title": "Expose more timeout-related context in `ansible-test`",
        "body": "### Summary\r\n\r\nSo sometimes our CI gets stuck on a single task for so long that it gets killed after a 50-minute timeout. And there wouldn't be any context regarding what was the state of processes at that point.\r\n\r\nHere's an example: https://dev.azure.com/ansible/ansible/_build/results?buildId=125233&view=logs&j=decc2f6c-caaf-5327-9dc2-edc5c3d85ed8&t=c5b61780-1e0c-5015-76da-ae0f2062a595&l=11894. Following the source code is just a guessing game. My guess is that the file system access is slow somewhere since `assert` does templating, but I'm pretty sure I won't be able to reproduce it w/o knowing where to look more precisely.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-test\r\n\r\n### Ansible Version\r\n\r\n```\r\nstable-2.15\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nalpine container @ azure pipelines\r\n\r\n### Steps to Reproduce\r\n\r\nN/A\r\n\r\n### Expected Results\r\n\r\nThere should be more info printed out.\r\nI think the signal handler @ https://github.com/ansible/ansible/blob/f1f0d9bd5355de5b45b894a9adf649abb2f97df5/test/lib/ansible_test/_internal/timeout.py#L115-L119 should attempt retrieving more context to show us.\r\nWhat occurred to me was that maybe it could call `py-spy` and perhaps integrate [the stdlib `faulthandler`](https://docs.python.org/3/library/faulthandler.html#dumping-the-traceback-on-a-user-signal).\r\n\r\ncc @mattclay any other ideas?\r\n\r\n### Actual Results\r\n\r\n```console\r\nNo useful context that would provide any clues regarding what's happening beyond the timestamps that vaguely point to the action plugin that's hanging:\r\n\r\n15:14 TASK [assert] ******************************************************************\r\n15:14 ok: [localhost] => {\r\n15:14     \"changed\": false,\r\n15:14     \"msg\": \"All assertions passed\"\r\n15:14 }\r\n15:14 \r\n15:14 TASK [Less than 1] *************************************************************\r\n15:15 Pausing for 1 seconds\r\n15:15 ok: [localhost] => {\"changed\": false, \"delta\": 1, \"echo\": true, \"rc\": 0, \"start\": \"2024-10-08 07:20:03.109197\", \"stderr\": \"\", \"stdout\": \"Paused for 1.0 seconds\", \"stop\": \"2024-10-08 07:20:04.112144\", \"user_input\": \"\"}\r\n15:15 \r\n15:15 TASK [assert] ******************************************************************\r\n50:10 \r\n50:10 NOTICE: Killed command to avoid an orphaned child process during handling of an unexpected exception.\r\n50:10 Run command with stdout: docker exec -i ansible-test-controller-fNcVkXOj sh -c 'tar cf - -C /root/ansible/test --exclude .tmp results | gzip'\r\n50:10 Run command with stdin: tar oxzf - -C /__w/1/ansible/test\r\n50:10 FATAL: Tests aborted after exceeding the 50 minute time limit.\r\n50:10 Run command: docker stop --time 0 ansible-test-controller-fNcVkXOj\r\n50:10 Run command: docker rm ansible-test-controller-fNcVkXOj\r\n50:11 Run command: docker stop --time 0 48cbf6f96fc859d835848038445a1164ddfe08ea7695b68f39636c8cb6693599\r\n50:11 Run command: docker rm 48cbf6f96fc859d835848038445a1164ddfe08ea7695b68f39636c8cb6693599\r\n\r\n##[error]Bash exited with code '1'.\r\nFinishing: Run Tests\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-08T13:24:55Z",
        "user": "webknjaz",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 84072,
        "title": "ansible.builtin.iptables does not add rule",
        "body": "### Summary\n\nI'm having a problem with the iptables builtin module.  The module does not add the rule to iptables. The `changed` state is always `false`\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.iptables\n\n### Ansible Version\n\n```console\nansible-playbook [core 2.16.11]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/tobster/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/tobster/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.12.6 (main, Sep  9 2024, 00:00:00) [GCC 14.2.1 20240801 (Red Hat 14.2.1-1)] (/usr/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = /usr/bin/nano\n```\n\n\n### OS / Environment\n\nDebian 12\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: \"add ipset rules\"\r\n  ansible.builtin.shell: \"ipset -! add {{ item.set }} {{ item.ip }}\"\r\n  with_items:\r\n    - { set: \"ADMIN_PC\", ip: \"10.66.100.0/24\" }\r\n    \r\n- name: \"add iptables ipset match rules\"\r\n  ansible.builtin.iptables:\r\n    action: \"insert\"\r\n    chain: \"{{ item.chain }}\"\r\n    jump: \"{{ item.jump }}\"\r\n    match_set: \"{{ item.match }}\"\r\n    match_set_flags: \"{{ item.flag }}\"\r\n    policy: \"{{ item.policy }}\"\r\n    rule_num: \"{{ item.pos }}\"\r\n  with_items:\r\n    - { chain: \"INPUT\", flag: \"src\", policy: \"DROP\", match: \"ADMIN_PC\", jump: \"ACCEPT\", pos: 1 }\r\n    - { chain: \"FORWARD\", flag: \"src\", policy: \"DROP\", match: \"ADMIN_PC\", jump: \"ACCEPT\", pos: 1 }\r\n```\r\n\n\n### Expected Results\n\nI would expect the above code to add the iptables rules. But as the `changed` is always false the iptables rules are not added. Although the rules do not exist on server\r\n```\r\niptables-save | grep ADMIN_PC\r\n$\r\n\r\nansible-playbook -i productionhosts firewall.yml --limit=msa\r\n[...]\r\nTASK [add iptables ipset match rules] \r\nok: [scanner01] => (item={'chain': 'INPUT', 'flag': 'src', 'policy': 'DROP', 'match': 'ADMIN_PC', 'jump': 'ACCEPT', 'pos': 1}) => {\"ansible_loop_var\": \"item\", \"chain\": \"INPUT\", \"chain_management\": false, \"changed\": false, \"flush\": false, \"ip_version\": \"ipv4\", \"item\": {\"chain\": \"INPUT\", \"flag\": \"src\", \"jump\": \"ACCEPT\", \"match\": \"ADMIN_PC\", \"policy\": \"DROP\", \"pos\": 1}, \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\", \"state\": \"present\", \"table\": \"filter\"}\r\nok: [scanner01] => (item={'chain': 'FORWARD', 'flag': 'src', 'policy': 'DROP', 'match': 'ADMIN_PC', 'jump': 'ACCEPT', 'pos': 1}) => {\"ansible_loop_var\": \"item\", \"chain\": \"FORWARD\", \"chain_management\": false, \"changed\": false, \"flush\": false, \"ip_version\": \"ipv4\", \"item\": {\"chain\": \"FORWARD\", \"flag\": \"src\", \"jump\": \"ACCEPT\", \"match\": \"ADMIN_PC\", \"policy\": \"DROP\", \"pos\": 1}, \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\", \"state\": \"present\", \"table\": \"filter\"}\r\n\r\niptables-save | grep ADMIN_PC\r\n$\r\n```\n\n### Actual Results\n\n```console\nTASK [add iptables ipset match rules] ******************************************\r\ntask path: /work/private/git/ansible/include/test-firewall.yml:7\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'/root\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278 `\" && echo ansible-tmp-1728375990.6715071-36517-207640702944278=\"` echo /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278 `\" ) && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'ansible-tmp-1728375990.6715071-36517-207640702944278=/root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /usr/lib/python3.12/site-packages/ansible/modules/iptables.py\r\n<<REDACTED>> PUT /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmp3w2ngb39 TO /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py\r\n<<REDACTED>> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' '[<REDACTED>]'\r\n<<REDACTED>> (0, b'sftp> put /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmp3w2ngb39 /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py\\n', b'OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched \\'final\\'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched \\'final\\'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/tobster/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/tobster/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master at \\'/home/tobster/.ansible/cp/9c664ae9b4\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /root\\r\\ndebug3: Looking up /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmp3w2ngb39\\r\\ndebug2: Sending SSH2_FXP_STAT \"/root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmp3w2ngb39\" to remote \"/root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:140632\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 140632 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/ /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' -tt <REDACTED> '/bin/sh -c '\"'\"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/AnsiballZ_iptables.py && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'\\r\\n{\"changed\": false, \"failed\": false, \"ip_version\": \"ipv4\", \"table\": \"filter\", \"chain\": \"INPUT\", \"flush\": false, \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\", \"state\": \"present\", \"chain_management\": false, \"invocation\": {\"module_args\": {\"action\": \"insert\", \"chain\": \"INPUT\", \"jump\": \"ACCEPT\", \"match_set\": \"ADMIN_PC\", \"match_set_flags\": \"src\", \"policy\": \"DROP\", \"rule_num\": \"1\", \"table\": \"filter\", \"state\": \"present\", \"ip_version\": \"ipv4\", \"match\": [], \"destination_ports\": [], \"ctstate\": [], \"syn\": \"ignore\", \"flush\": false, \"chain_management\": false, \"numeric\": false, \"protocol\": null, \"wait\": null, \"source\": null, \"to_source\": null, \"destination\": null, \"to_destination\": null, \"tcp_flags\": null, \"gateway\": null, \"log_prefix\": null, \"log_level\": null, \"goto\": null, \"in_interface\": null, \"out_interface\": null, \"fragment\": null, \"set_counters\": null, \"source_port\": null, \"destination_port\": null, \"to_ports\": null, \"set_dscp_mark\": null, \"set_dscp_mark_class\": null, \"comment\": null, \"src_range\": null, \"dst_range\": null, \"limit\": null, \"limit_burst\": null, \"uid_owner\": null, \"gid_owner\": null, \"reject_with\": null, \"icmp_type\": null}}}\\r\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to <REDACTED> closed.\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1728375990.6715071-36517-207640702944278/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nok: [scanner01] => (item={'chain': 'INPUT', 'flag': 'src', 'policy': 'DROP', 'match': 'ADMIN_PC', 'jump': 'ACCEPT', 'pos': 1}) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"chain\": \"INPUT\",\r\n    \"chain_management\": false,\r\n    \"changed\": false,\r\n    \"flush\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"action\": \"insert\",\r\n            \"chain\": \"INPUT\",\r\n            \"chain_management\": false,\r\n            \"comment\": null,\r\n            \"ctstate\": [],\r\n            \"destination\": null,\r\n            \"destination_port\": null,\r\n            \"destination_ports\": [],\r\n            \"dst_range\": null,\r\n            \"flush\": false,\r\n            \"fragment\": null,\r\n            \"gateway\": null,\r\n            \"gid_owner\": null,\r\n            \"goto\": null,\r\n            \"icmp_type\": null,\r\n            \"in_interface\": null,\r\n            \"ip_version\": \"ipv4\",\r\n            \"jump\": \"ACCEPT\",\r\n            \"limit\": null,\r\n            \"limit_burst\": null,\r\n            \"log_level\": null,\r\n            \"log_prefix\": null,\r\n            \"match\": [],\r\n            \"match_set\": \"ADMIN_PC\",\r\n            \"match_set_flags\": \"src\",\r\n            \"numeric\": false,\r\n            \"out_interface\": null,\r\n            \"policy\": \"DROP\",\r\n            \"protocol\": null,\r\n            \"reject_with\": null,\r\n            \"rule_num\": \"1\",\r\n            \"set_counters\": null,\r\n            \"set_dscp_mark\": null,\r\n            \"set_dscp_mark_class\": null,\r\n            \"source\": null,\r\n            \"source_port\": null,\r\n            \"src_range\": null,\r\n            \"state\": \"present\",\r\n            \"syn\": \"ignore\",\r\n            \"table\": \"filter\",\r\n            \"tcp_flags\": null,\r\n            \"to_destination\": null,\r\n            \"to_ports\": null,\r\n            \"to_source\": null,\r\n            \"uid_owner\": null,\r\n            \"wait\": null\r\n        }\r\n    },\r\n    \"ip_version\": \"ipv4\",\r\n    \"item\": {\r\n        \"chain\": \"INPUT\",\r\n        \"flag\": \"src\",\r\n        \"jump\": \"ACCEPT\",\r\n        \"match\": \"ADMIN_PC\",\r\n        \"policy\": \"DROP\",\r\n        \"pos\": 1\r\n    },\r\n    \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\",\r\n    \"state\": \"present\",\r\n    \"table\": \"filter\"\r\n}\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'/root\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775 `\" && echo ansible-tmp-1728375991.141793-36517-29020194618775=\"` echo /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775 `\" ) && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'ansible-tmp-1728375991.141793-36517-29020194618775=/root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /usr/lib/python3.12/site-packages/ansible/modules/iptables.py\r\n<<REDACTED>> PUT /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmpkrgzvfw4 TO /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py\r\n<<REDACTED>> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' '[<REDACTED>]'\r\n<<REDACTED>> (0, b'sftp> put /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmpkrgzvfw4 /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py\\n', b'OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched \\'final\\'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched \\'final\\'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/tobster/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/tobster/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master at \\'/home/tobster/.ansible/cp/9c664ae9b4\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /root\\r\\ndebug3: Looking up /home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmpkrgzvfw4\\r\\ndebug2: Sending SSH2_FXP_STAT \"/root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/home/tobster/.ansible/tmp/ansible-local-364675py02gba/tmpkrgzvfw4\" to remote \"/root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:140632\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 140632 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/ /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' -tt <REDACTED> '/bin/sh -c '\"'\"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/AnsiballZ_iptables.py && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'\\r\\n{\"changed\": false, \"failed\": false, \"ip_version\": \"ipv4\", \"table\": \"filter\", \"chain\": \"FORWARD\", \"flush\": false, \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\", \"state\": \"present\", \"chain_management\": false, \"invocation\": {\"module_args\": {\"action\": \"insert\", \"chain\": \"FORWARD\", \"jump\": \"ACCEPT\", \"match_set\": \"ADMIN_PC\", \"match_set_flags\": \"src\", \"policy\": \"DROP\", \"rule_num\": \"1\", \"table\": \"filter\", \"state\": \"present\", \"ip_version\": \"ipv4\", \"match\": [], \"destination_ports\": [], \"ctstate\": [], \"syn\": \"ignore\", \"flush\": false, \"chain_management\": false, \"numeric\": false, \"protocol\": null, \"wait\": null, \"source\": null, \"to_source\": null, \"destination\": null, \"to_destination\": null, \"tcp_flags\": null, \"gateway\": null, \"log_prefix\": null, \"log_level\": null, \"goto\": null, \"in_interface\": null, \"out_interface\": null, \"fragment\": null, \"set_counters\": null, \"source_port\": null, \"destination_port\": null, \"to_ports\": null, \"set_dscp_mark\": null, \"set_dscp_mark_class\": null, \"comment\": null, \"src_range\": null, \"dst_range\": null, \"limit\": null, \"limit_burst\": null, \"uid_owner\": null, \"gid_owner\": null, \"reject_with\": null, \"icmp_type\": null}}}\\r\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to <REDACTED> closed.\\r\\n\")\r\n<<REDACTED>> ESTABLISH SSH CONNECTION FOR USER: root\r\n<<REDACTED>> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/tobster/.ansible/cp/9c664ae9b4\"' <REDACTED> '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1728375991.141793-36517-29020194618775/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<<REDACTED>> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.2 4 Jun 2024\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname <REDACTED> is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/tobster/.ssh/config\\r\\ndebug1: /home/tobster/.ssh/config line 16: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 55: Including file /etc/ssh/ssh_config.d/50-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/50-redhat.conf\\r\\ndebug2: checking match for 'final all' host <REDACTED> originally <REDACTED>\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/50-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512]\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/tobster/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/tobster/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/tobster/.ansible/cp/9c664ae9b4'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 36487\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nok: [scanner01] => (item={'chain': 'FORWARD', 'flag': 'src', 'policy': 'DROP', 'match': 'ADMIN_PC', 'jump': 'ACCEPT', 'pos': 1}) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"chain\": \"FORWARD\",\r\n    \"chain_management\": false,\r\n    \"changed\": false,\r\n    \"flush\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"action\": \"insert\",\r\n            \"chain\": \"FORWARD\",\r\n            \"chain_management\": false,\r\n            \"comment\": null,\r\n            \"ctstate\": [],\r\n            \"destination\": null,\r\n            \"destination_port\": null,\r\n            \"destination_ports\": [],\r\n            \"dst_range\": null,\r\n            \"flush\": false,\r\n            \"fragment\": null,\r\n            \"gateway\": null,\r\n            \"gid_owner\": null,\r\n            \"goto\": null,\r\n            \"icmp_type\": null,\r\n            \"in_interface\": null,\r\n            \"ip_version\": \"ipv4\",\r\n            \"jump\": \"ACCEPT\",\r\n            \"limit\": null,\r\n            \"limit_burst\": null,\r\n            \"log_level\": null,\r\n            \"log_prefix\": null,\r\n            \"match\": [],\r\n            \"match_set\": \"ADMIN_PC\",\r\n            \"match_set_flags\": \"src\",\r\n            \"numeric\": false,\r\n            \"out_interface\": null,\r\n            \"policy\": \"DROP\",\r\n            \"protocol\": null,\r\n            \"reject_with\": null,\r\n            \"rule_num\": \"1\",\r\n            \"set_counters\": null,\r\n            \"set_dscp_mark\": null,\r\n            \"set_dscp_mark_class\": null,\r\n            \"source\": null,\r\n            \"source_port\": null,\r\n            \"src_range\": null,\r\n            \"state\": \"present\",\r\n            \"syn\": \"ignore\",\r\n            \"table\": \"filter\",\r\n            \"tcp_flags\": null,\r\n            \"to_destination\": null,\r\n            \"to_ports\": null,\r\n            \"to_source\": null,\r\n            \"uid_owner\": null,\r\n            \"wait\": null\r\n        }\r\n    },\r\n    \"ip_version\": \"ipv4\",\r\n    \"item\": {\r\n        \"chain\": \"FORWARD\",\r\n        \"flag\": \"src\",\r\n        \"jump\": \"ACCEPT\",\r\n        \"match\": \"ADMIN_PC\",\r\n        \"policy\": \"DROP\",\r\n        \"pos\": 1\r\n    },\r\n    \"rule\": \"-j ACCEPT -m set --match-set ADMIN_PC src\",\r\n    \"state\": \"present\",\r\n    \"table\": \"filter\"\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-08T08:29:42Z",
        "user": "jahlives",
        "labels": [
            "module",
            "bug",
            "needs_verified"
        ]
    },
    {
        "number": 84061,
        "title": "deb822_repository: Provide diff for changed files",
        "body": "### Summary\n\nI am using the deb822_repository module and noticed that it does not provide diffs for changed files. I would like to request that feature.\r\n\r\nIs there a particular reason why no diffs are being generated? Would you accept a PR for this?\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ndeb822_repository\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-10-07T13:28:22Z",
        "user": "ltog",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 84021,
        "title": "include support for using the --prompt parameter when creating virtual environments with pip/python",
        "body": "### Summary\n\nA lot of software we install through ansible relies on a virtual environment. Typically those are installed in a directory called venv/ for each of those softwares. When activating an environment it will thus be indicated as (venv) in the linux prompt, which will be the same for all kind of software.\nAllowing to use (or configure ) the --prompt parameter when crreating those environment would allow one to better indicate which environment is currently active.\nOne could change the install dir for the virtual environments to reflect the software but using always the same venv folder for those virtualenvs has it advantages as well as this allows us to configure the git repo's to omit those kind of directories.\n\nI don't have a solution for it being as it is right now (except changing the install dir, but I really would like to avoid this! ). \n\nI've noticed a post on the google-groups that mentions this as well, but it's a very old post and there does not have been any reaction on it?\n[https://groups.google.com/g/ansible-project/c/DDVmvHWYXNc/m/qvwwyls_OfcJ](https://groups.google.com/g/ansible-project/c/DDVmvHWYXNc/m/qvwwyls_OfcJ)\n\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\npip\n\n### Additional Information\n\nperhaps extending the configurable options in the yml files could solve this?\nAdding something like \"virtualenv_prompt\" in analogy of \"virtualenv\" , \"virtualenv_python\" , ... and passing that on to the pip module might be an option?\nWhen \"virtualenv_prompt\" is not set it could simply fall back to the default as it is right now, so very little chance in breaking existing things \n\n### Code of Conduct\n\n- [ ] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-30T09:48:50Z",
        "user": "lsterck",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 84017,
        "title": "Repeated encryption attempts when overriding inline vault variables with `include_vars` and `hash_behaviour: merge`",
        "body": "### Summary\r\n\r\nWhen using `include_vars` with the `hash_behaviour`-parameter set to `merge` in a playbook to import a variables file already imported by the `host_group_vars`-Plugin, the inline vault variables defined in this file are decrypted multiple times when accessing them later in the playbook. This results in slow execution, especially in larger playbooks with a lot of secrets.\r\n\r\nBackground: I am working with an unusual setup, where the group_vars/all.yml variables are located in a collection, outside of my playbook directory. To be able to correctly import the file with it's correct precedence, I import all variable files manually  as the first step in my playbook, as shown here: https://gist.github.com/x-oswald/689389cf5d1e2266e9e05edab3bc632e\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible vault, include_vars, host_group_vars\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.4]\r\n  config file = /Users/xaver.oswald/.ansible.cfg\r\n  configured module search path = ['/usr/share/ansible']\r\n  ansible python module location = /usr/local/Cellar/ansible/10.4.0/libexec/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/xaver.oswald/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.12.6 (main, Sep  6 2024, 19:03:47) [Clang 15.0.0 (clang-1500.3.9.4)] (/usr/local/Cellar/ansible/10.4.0/libexec/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEFAULT_HASH_BEHAVIOUR(/Users/xaver.oswald/.ansible.cfg) = merge\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nMacOS 14.7\r\n\r\n### Steps to Reproduce\r\n\r\nThis repository contains a minimal playbook reproducing this issue: https://github.com/x-oswald/ansible-include_vars-issue\r\n\r\n### Expected Results\r\n\r\nI expected the secret to only be decrypted once, just like how it behaves when not importing the secret multiple times trough include_vars \r\n\r\n### Actual Results\r\n\r\n```console\r\nThe relevant output when accessing the secret:\r\nTASK [debug] *************************************************************************************************\r\ntask path: /Users/xaver.oswald/ansible-test/playbook.yml:10\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nok: [localhost] => {\r\n    \"testrole\": {\r\n        \"password\": \"secretPass2\"\r\n    }\r\n}\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\n```\r\nCompared to not importing the file with include_vars:\r\n```console\r\nTrying secret FileVaultSecret(filename='/Users/xaver.oswald/ansible-test/pw_file') for vault_id=default\r\nok: [localhost] => {\r\n    \"testrole\": {\r\n        \"password\": \"secretPass2\"\r\n    }\r\n}\r\n```\r\nThe output of the entire playbook run can be found here: https://gist.github.com/x-oswald/9d8a95d0c6313b2eeba20b1d13ed553f\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-27T09:37:39Z",
        "user": "x-oswald",
        "labels": [
            "module",
            "bug",
            "affects_2.17",
            "data_tagging"
        ]
    },
    {
        "number": 83972,
        "title": "copy task changes file permissions of the existing destination file when becoming an unprivileged user although mode is not specified",
        "body": "### Summary\r\n\r\nI try to copy a file with ansible to a remote machine where a file already exists. Both the connection user and the `become_user` are unprivileged. File content is modified as is expected but file permissions are also modified which by the [documentation](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#parameter-mode) is **not** expected. `copy` tasks `mode` parameter is not specified.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncopy, atomic_move\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under\r\ndevelopment. This is a rapidly changing source of code and can become unstable at any point.\r\nansible [core 2.18.0.dev0] (devel 40ade1f84b) last updated 2024/09/20 16:04:47 (GMT +300)\r\n  config file = /home/martinraie/projects/ansible/ansible.cfg\r\n  configured module search path = ['/home/martinraie/projects/ansible/library/modules', '/home/martinraie/.local/lib/python3.10/site-packages']\r\n  ansible python module location = /home/martinraie/external-projects/ansible/lib/ansible\r\n  ansible collection location = /home/martinraie/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/martinraie/external-projects/ansible/bin/ansible\r\n  python version = 3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0] (/usr/bin/python)\r\n  jinja version = 3.0.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under\r\ndevelopment. This is a rapidly changing source of code and can become unstable at any point.\r\nCALLBACKS_ENABLED(/home/martinraie/projects/ansible/ansible.cfg) = ['profile_tasks']\r\nCONFIG_FILE() = /home/martinraie/projects/ansible/ansible.cfg\r\nDEFAULT_LOG_PATH(/home/martinraie/projects/ansible/ansible.cfg) = /home/martinraie/projects/ansible/ansible/ansible.log\r\nDEFAULT_MODULE_PATH(/home/martinraie/projects/ansible/ansible.cfg) = ['/home/martinraie/projects/ansible/library/modules', '/home/martinraie/.local/lib/python3.10/site-packages']\r\nDEFAULT_STDOUT_CALLBACK(/home/martinraie/projects/ansible/ansible.cfg) = debug\r\nPAGER(env: PAGER) = less\r\n\r\nGALAXY_SERVERS:\r\n\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\nreconnection_retries(/home/martinraie/projects/ansible/ansible.cfg) = 7\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 22.04.5 LTS\r\n\r\n### Steps to Reproduce\r\n\r\nCreate initial file on the remote server:\r\n```bash\r\necho 'initial content' | sudo -u ubuntu tee /home/ubuntu/test.txt\r\n```\r\nCheck file permissions:\r\n```bash\r\nls -l /home/ubuntu/test.txt\r\n```\r\nresult:\r\n```\r\n-rw-rw-r-- 1 ubuntu ubuntu 17 Sep 20 14:58 /home/ubuntu/test.txt\r\n```\r\nRun following ansible playbook \r\n```yaml (paste below)\r\n  tasks:\r\n    - copy:\r\n        content: \"new file content\"\r\n        dest: \"/home/ubuntu/test.txt\"\r\n      become: yes\r\n      become_user: ubuntu # unprivileged user\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expected the file to be overwritten with new content leaving permissions as before. Content was modified as expected but for some reason the permissions also changed from `-rw-rw-r--` to `-rw-r-x---`.\r\n```console\r\nls -l /home/ubuntu/test.txt\r\n-rw-rw-r-- 1 ubuntu ubuntu 16 Sep 20 14:58 /home/ubuntu/test.txt\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nls -l /home/ubuntu/test.txt\r\n-rw-r-x--- 1 ubuntu ubuntu 16 Sep 20 14:58 /home/ubuntu/test.txt\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-20T15:07:18Z",
        "user": "martinraie",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.18"
        ]
    },
    {
        "number": 83958,
        "title": "Windows command works with winrm but hangs with SSH",
        "body": "### Summary\r\n\r\nWith OpenSSH and WinRM enabled on Windows Server 2025 build 26100 I have hundreds of tasks that work all ok using both ssh and winrm. Ansible version in use is 2.17.4, authentication, shell type, etc have all been set and almost everything seems to work perfectly.\r\n\r\nThere is, however, one single command that for some reason works only with winrm but gets stuck with ssh unless redirecting stderr. The hang could be also reproduced on PowerShell command line so the root cause could be a PowerShell/Windows issue but I'm filing this issue to at least raise awareness even if fixing it would be out of scope for the Ansible project.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nwindows\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.4]\r\n  config file = None\r\n  configured module search path = ['/home/testuser/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/testuser/ansible/ansible-2.17/lib64/python3.11/site-packages/ansible\r\n  ansible collection location = /home/testuser/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/testuser/ansible/ansible-2.17/bin/ansible\r\n  python version = 3.11.7 (main, Aug 23 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/home/testuser/ansible/ansible-2.17/bin/python3.11)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n$ ansible-galaxy collection list | grep windows\r\nansible.windows             2.5.0\r\ncommunity.windows           2.3.0\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vi\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 9\r\n\r\n### Steps to Reproduce\r\n\r\nTo reproduce, first initialize the test file on the target with:\r\n\r\n`echo test | Set-Content C:\\ProgramData\\ssh\\sshd_config.test`\r\n\r\nThen, this works with winrm but fails with ssh, same thing if using the win_shell module instead:\r\n\r\n```yaml\r\n- name: Validate sshd configuration file\r\n  ansible.windows.win_command: >\r\n    C:\\Windows\\System32\\OpenSSH\\sshd.exe -tf C:\\ProgramData\\ssh\\sshd_config.test\r\n  changed_when: false\r\n```\r\n\r\nSo far the only way I have gotten it to work is like this:\r\n\r\n```yaml\r\n- name: Validate sshd configuration file\r\n  ansible.windows.win_powershell:\r\n    error_action: stop\r\n    script: |\r\n      $p = Start-Process `\r\n      -FilePath C:\\Windows\\System32\\OpenSSH\\sshd.exe `\r\n      -ArgumentList \"-tf C:\\ProgramData\\ssh\\sshd_config.test\" `\r\n      -WorkingDirectory C:\\ProgramData\\ssh `\r\n      -RedirectStandardError .\\.tmp `\r\n      -NoNewWindow `\r\n      -PassThru `\r\n      -Wait\r\n      if ($p.ExitCode) {\r\n        $Ansible.Failed = $true\r\n        $Ansible.Result = Get-Content -Raw .\\.tmp\r\n        del .\\.tmp\r\n      }\r\n  changed_when: false\r\n```\r\n\r\nRemoving the RedirectStandardError option would cause this to fail as well.\r\n\r\nNote that if logging in to the same Windows host over SSH then the same Start-Process command would similarly complete or not depending on the RedirectStandardError option. If omitting the option one could however press enter and get back to the command prompt.\r\n\r\n### Expected Results\r\n\r\nThe task completes normally using SSH.\r\n\r\n### Actual Results\r\n\r\nThe task gets stuck using SSH.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-18T10:51:26Z",
        "user": "myllynen",
        "labels": [
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 83950,
        "title": "Error in atomic_move when path is filename only",
        "body": "### Summary\r\n\r\nAfter upgrading to Ansible 2.16.11, I had an issue with the community.crypto.openssl_csr module, although I think this can be a problem for other modules as well. When defining a filename not containing a full path, the task fails. When changing path to include full path or relative path, the task works as expected.\r\n\r\n\r\nI suspect this may be related to the following change https://github.com/ansible/ansible/pull/83718/files#diff-f349dd7dd94c979d979664b11f27222e562b7444ec38407a4a511614fc5248edR1688\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\natomic_move\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.11]\r\n  config file = None\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.12.6 (main, Sep 12 2024, 21:12:04) [GCC 12.2.0] (/usr/local/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_FORCE_COLOR(env: ANSIBLE_FORCE_COLOR) = True\r\nCONFIG_FILE() = None\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(env: ANSIBLE_LOAD_CALLBACK_PLUGINS) = True\r\nDEFAULT_STDOUT_CALLBACK(env: ANSIBLE_STDOUT_CALLBACK) = yaml\r\nHOST_KEY_CHECKING(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\nINTERPRETER_PYTHON(env: ANSIBLE_PYTHON_INTERPRETER) = auto\r\nCONNECTION:\r\n==========\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\nssh:\r\n___\r\nhost_key_checking(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 8\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nThe following fails, when just supplying a filename in path\r\n```\r\n- name: Create CSR\r\n  community.crypto.openssl_csr:\r\n    path: selfsigned.csr\r\n    common_name: \"common-name\"\r\n    privatekey_path: \"{{ key_file }}\"\r\n    organization_name: \"XXXXXX\"\r\n```\r\n\r\nTo fix the issue, I changed the CSR task to include relative path, the following works:\r\n```\r\n- name: Create CSR\r\n  community.crypto.openssl_csr:\r\n    path: ./selfsigned.csr\r\n    common_name: \"common-name\"\r\n    privatekey_path: \"{{ key_file }}\"\r\n    organization_name: \"XXXXXX\"\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect atomic_move to not fail when supplying just a filename in path.\r\n\r\n### Actual Results\r\n\r\n```console\r\nFile \"/tmp/ansible_community.crypto.openssl_csr_payload_0h7qzfoi/ansible_community.crypto.openssl_csr_payload.zip/ansible_collections/community/crypto/plugins/module_utils/io.py\", line 95, in write_file\r\n    module.atomic_move(tmp_name, file_args['path'])\r\n  File \"/tmp/ansible_community.crypto.openssl_csr_payload_0h7qzfoi/ansible_community.crypto.openssl_csr_payload.zip/ansible/module_utils/basic.py\", line 1762, in atomic_move\r\n    dest_dir_stat = os.stat(os.path.dirname(b_dest))\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-17T14:11:16Z",
        "user": "thorsteinbn",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.16"
        ]
    },
    {
        "number": 83886,
        "title": "[TODO] See if we can start uploading test results to Codecov as well",
        "body": "### Summary\n\nCurrently, we push such uploads to Azure DevOps. We'll need to refresh the `codecov-cli` binary we use to be able to start also uploading the junit test results there.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nCI\n\n### Additional Information\n\nhttps://app.codecov.io/gh/ansible/ansible/tests/new/codecov-cli\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-09-03T12:21:30Z",
        "user": "webknjaz",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 83872,
        "title": "Ansible exits prematurely without error message using `ansible.builtin.reboot`",
        "body": "### Summary\n\nWhen I try to reboot my device using the `ansible.builtin.reboot` module, Ansible exits prematurely without any error message.\r\n\r\nThe reboot itself works, but the first connection after a reboot seems to fail.\r\n`ansible.builtin.reboot` is attempting to get the system boot time by executing the default command (`cat /proc/sys/kernel/random/boot_id`) via SSH.\r\nThe connection itself also seems to establish itself, but during establishment something goes wrong.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nreboot,ssh\n\n### Ansible Version\n\n```console\nansible [core 2.15.12]\r\n  config file = /Users/me/code/repo/ansible.cfg\r\n  configured module search path = ['/Users/me/code/repo/{{ ANSIBLE_HOME ~ \"/plugins/modules', '/Users/me/code/repo/playbooks/library\" }}']\r\n  ansible python module location = /Users/me/.pyenv/versions/3.12.5/envs/repo/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/me/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/me/.pyenv/versions/3.12.5/envs/repo/bin/ansible\r\n  python version = 3.12.5 (main, Aug 19 2024, 14:07:47) [Clang 15.0.0 (clang-1500.3.9.4)] (/Users/me/.pyenv/versions/3.12.5/envs/repo/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = /Users/me/code/repo/ansible.cfg\r\nDEFAULT_ACTION_PLUGIN_PATH(/Users/me/code/repo/ansible.cfg) = ['/Users/me/code/repo/{{ ANSIBLE_HOME ~ \"/plugins/action', '/Users/me/code/repo/playbooks/action_plugins\" }}']\r\nDEFAULT_BECOME_METHOD(/Users/me/code/repo/ansible.cfg) = su\r\nDEFAULT_BECOME_USER(/Users/me/code/repo/ansible.cfg) = root\r\nDEFAULT_EXECUTABLE(/Users/me/code/repo/ansible.cfg) = /bin/bash\r\nDEFAULT_FILTER_PLUGIN_PATH(/Users/me/code/repo/ansible.cfg) = ['/Users/me/code/repo/{{ ANSIBLE_HOME ~ \"/plugins/filter', '/Users/me/code/repo/playbooks/filter_plugins\" }}']\r\nDEFAULT_HOST_LIST(/Users/me/code/repo/ansible.cfg) = ['/Users/me/code/repo/utils/hosts.py']\r\nDEFAULT_LOG_PATH(/Users/me/code/repo/ansible.cfg) = /Users/me/code/repo/ansible.log\r\nDEFAULT_MODULE_PATH(/Users/me/code/repo/ansible.cfg) = ['/Users/me/code/repo/{{ ANSIBLE_HOME ~ \"/plugins/modules', '/Users/me/code/repo/playbooks/library\" }}']\r\nDEFAULT_REMOTE_USER(/Users/me/code/repo/ansible.cfg) = root\r\nDEFAULT_STRATEGY(/Users/me/code/repo/ansible.cfg) = free\r\nDIFF_ALWAYS(/Users/me/code/repo/ansible.cfg) = True\r\nEDITOR(env: EDITOR) = nano\r\nHOST_KEY_CHECKING(/Users/me/code/repo/ansible.cfg) = False\r\nPAGER(env: PAGER) = less\r\n\r\nBECOME:\r\n======\r\n\r\nrunas:\r\n_____\r\nbecome_user(/Users/me/code/repo/ansible.cfg) = root\r\n\r\nsu:\r\n__\r\nbecome_user(/Users/me/code/repo/ansible.cfg) = root\r\n\r\nsudo:\r\n____\r\nbecome_user(/Users/me/code/repo/ansible.cfg) = root\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/Users/me/code/repo/ansible.cfg) = False\r\nremote_user(/Users/me/code/repo/ansible.cfg) = root\r\n\r\nssh:\r\n___\r\nhost_key_checking(/Users/me/code/repo/ansible.cfg) = False\r\nremote_user(/Users/me/code/repo/ansible.cfg) = root\n```\n\n\n### OS / Environment\n\nTarget OS: Poky (Yocto) 2.6.4\r\nNetwork connection over Wireguard VPN\n\n### Steps to Reproduce\n\nThe playbook itself is quite simple.\r\n\r\nI have an `ansible.builtin.reboot` task that is executed if the var `reboot_required` is set and `true`.\r\nThe SSH options are set to:\r\n```yaml\r\nansible_become_pass: \"{{ lookup('env', 'ROOT_PWD') }}\" \r\nansible_ssh_common_args: -o ControlMaster=no -o PasswordAuthentication=no\r\n```\r\n\r\nThe SSH connection uses pubkey authentication and strictly disallows password auth.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Reboot\r\n  become: true\r\n  tags: always\r\n  when: reboot_required is defined and reboot_required | bool\r\n  block:\r\n    - name: Notify of reboot\r\n      ansible.builtin.debug:\r\n        msg: \"Rebooting the device now...\"\r\n\r\n    - name: Reboot\r\n      ansible.builtin.reboot:\r\n        reboot_timeout: 300\r\n```\r\n\r\nI have also tried to run the `reboot` command using `ansible.builtin.command` with `async` and `poll` followed by `ansible.builtin.wait_for_connection`, but without success.\r\nThe behaviour was exactly the same.\r\nThe `use_tty` option also does not seem to affect the behaviour and resulted in fails.\r\nExperimenting with the `pre/post_reboot_delays` also did not make a difference.\r\n\r\nRunning with the highest verbosity and debug mode enabled, I was able to trace it into into this loop inside `plugins/connection/ssh.py`: https://github.com/ansible/ansible/blob/9a5a9e48fcbee1bb42ae2c486c391d3650fe1ff6/lib/ansible/plugins/connection/ssh.py#L1036\r\n\n\n### Expected Results\n\nThe device should reboot and Ansible should reconnect thereafter.\n\n### Actual Results\n\n```console\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | ansible.builtin.reboot: attempting to get system boot time\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> ESTABLISH SSH CONNECTION FOR USER: remote_username\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=60s)\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: ANSIBLE_HOST_KEY_CHECKING/host_key_checking disabled: (-o)(StrictHostKeyChecking=no)\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"remote_username\")\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=10)\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: Set ssh_common_args: (-o)(ControlMaster=no)(-o)(PasswordAuthentication=no)\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: Set ssh_extra_args: ()\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: found only ControlPersist; added ControlPath: (-o)(ControlPath=\"/Users/me/.ansible/cp/339a7562cb\")\r\n2024-08-29 07:51:20,779 p=29027 u=me n=ansible | <CM4M_029> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"remote_username\"' -o ConnectTimeout=10 -o ControlMaster=no -o PasswordAuthentication=no -o 'ControlPath=\"/Users/me/.ansible/cp/339a7562cb\"' -tt CM4M_029 '/bin/bash -c '\"'\"'su  root -c '\"'\"'\"'\"'\"'\"'\"'\"'/bin/bash -c '\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-sxmeqolmmdylrparpublnjjoqewceduj ; cat /proc/sys/kernel/random/boot_id'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"''\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\n\r\n\r\n--------------------------------------------------\r\nUsing `debug=True`, the last log received in the terminal is:\r\n--------------------------------------------------\r\n\r\n\r\n 44251 1724914041.38348: stderr chunk (state=0):\r\n>>>debug3: receive packet: type 53\r\ndebug3: input_userauth_banner: entering\r\n\r\n#=====================================================================#\r\n#  WARNING: This is a secure system.                                  #\r\n#                                                                     #\r\n#    DO NOT access this device unless you are authorized to do so.    #\r\n#                                                                     #\r\n#=====================================================================#\r\n\r\n\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey\r\ndebug3: start over, passed a different list publickey\r\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug3: ssh_get_authentication_socket_path: path '/private/tmp/com.apple.launchd.ITbPO3GqIX/Listeners'\r\n<<<\r\n 44185 1724914041.38421: next free host: CM4M_029\r\n 44185 1724914041.38422: getting the next task for host CM4M_029\r\n 44185 1724914041.38423: done getting next task for host CM4M_029\r\n 44185 1724914041.38424:  ^ task is: TASK: meta (flush_handlers)\r\n 44185 1724914041.38425:  ^ state is: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38426 [CM4M_029]: free host state: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38426 [CM4M_029]: free host task: TASK: meta (flush_handlers)\r\n 44185 1724914041.38427 [CM4M_029]: this host has work to do\r\n 44185 1724914041.38427: CM4M_029 is blocked, skipping for now\r\n 44185 1724914041.38556: next free host: CM4M_029\r\n 44185 1724914041.38557: getting the next task for host CM4M_029\r\n 44185 1724914041.38558: done getting next task for host CM4M_029\r\n 44185 1724914041.38559:  ^ task is: TASK: meta (flush_handlers)\r\n 44185 1724914041.38560:  ^ state is: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38560 [CM4M_029]: free host state: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38561 [CM4M_029]: free host task: TASK: meta (flush_handlers)\r\n 44185 1724914041.38565 [CM4M_029]: this host has work to do\r\n 44185 1724914041.38566: CM4M_029 is blocked, skipping for now\r\n 44185 1724914041.38695: next free host: CM4M_029\r\n 44185 1724914041.38696: getting the next task for host CM4M_029\r\n 44185 1724914041.38697: done getting next task for host CM4M_029\r\n 44185 1724914041.38698:  ^ task is: TASK: meta (flush_handlers)\r\n 44185 1724914041.38699:  ^ state is: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38699 [CM4M_029]: free host state: HOST STATE: block=5, task=1, rescue=0, always=0, handlers=2, run_state=1, fail_state=0, pre_flushing_run_state=1, update_handlers=True, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n 44185 1724914041.38700 [CM4M_029]: free host task: TASK: meta (flush_handlers)\r\n 44185 1724914041.38701 [CM4M_029]: this host has work to do\r\n 44185 1724914041.38701: CM4M_029 is blocked, skipping for now\r\n 44251 1724914041.38706: stderr chunk (state=0):\r\n>>>debug1: get_agent_identities: bound agent to hostkey\r\n<<<\r\n 44251 1724914041.38711: stderr chunk (state=0):\r\n>>>debug1: get_agent_identities: ssh_fetch_identitylist: agent contains no identities\r\n<<<\r\n 44251 1724914041.38715: stderr chunk (state=0):\r\n>>>debug1: Will attempt key: /Users/me/.ssh/CM4M_029_rsa  explicit\r\ndebug2: pubkey_prepare: done\r\ndebug1: Trying private key: /Users/me/.ssh/CM4M_029_rsa\r\n<<<\r\n\r\n\r\n--------------------------------------------------\r\nThis is the last log. Afterwards, Ansible exits without an error or anything.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-29T06:49:59Z",
        "user": "Stausssi",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 83867,
        "title": "Integration test suite revamp",
        "body": "### Summary\n\nI'm filing this as \"feature request\" to encourage discussion with the ansible team, and file actionable bug/feature requests or send PRs once a consensus has been reached.\r\n\r\nI've been setting up test coverage for ansible-core that's packaged in Debian for the laste few weeks, and now have a somewhat working setup through patching/working around some issues. While working with the tests, I've noticed several somewhat related issues:\r\n\r\n1. All integration tests on azure CI are always run as root, regardless of whether `needs/root` is set in the aliases file or not. This seems to be [somewhat documented](https://docs.ansible.com/ansible/latest/dev_guide/testing_running_locally.html#custom-containers), though this causes some tests to run differently than expected. One example is #83837, though there are a few other examples (many test depending on `setup_remote_tmp_dir`, `facts_d`) where permission checks do not work as intended due to root always having right of way. I believe, ideally, any test that doesn't have `needs/root` set should not only be able to, but to actually run as unprivileged user on azure CI.\r\n2. Due to all tests running as root, there is no consistency on how to handle package dependencies needed for the test. Some test assume they're installed, others install them as root, yet others use a task via `become: yes`. Would be nice to establish one consistent way to do it, document that, and fix up the tests that do it differently.\r\n3. Related to 2., it's unclear what `needs/root` means *exactly*. Tests that change iptables rules, mount filesystems, or create LVM images surely fall in this category. However, should tests that install system packages be marked as such? What if they otherwise run fine when the package dependencies are installed? What about tests that call other tests that require root (one example: `omit` calls `setup_test_user`, the latter requiring root to create new system users).\r\n4. Some tests install system python packages, some use pip to install them. I believe it would be best to always use system packages, as that would show distro-specific issues with the shipped python libraries. The respective pip implementation between distros varies very little.\r\n5. It's unclear if tests should be able to run from the release tarball. The `infra` module fails due to `hacking/test-module.py` not being present.\r\n6. Some tests fail if `en_US.UTF-8` locale is not present (`preflight_encoding`, `tags`). If this is intentional, would be nice to document this.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible-core integration tests\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-27T18:06:18Z",
        "user": "leegarrett",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 83863,
        "title": "Silent mantissa truncation on FieldAttribute `int` coercion",
        "body": "### Summary\r\n\r\nFloating-point values passed to Playbook FieldAttributes configured for `isa='int'` coercion will silently truncate (not round) any floating-point mantissa. This alone is somewhat excusable, since it's the default Python behavior for `int([floating-point value])`, but the silent truncation leads to unintuitive results in a number of cases, especially for values between zero and one. All user-accessible `isa='int'` FAs described below:\r\n\r\n`async_val: 0.9999` == 0, reverts to infinite (!)\r\n`delay: 0.9999` == 0, reverts to no delay (!)\r\n`poll: 0.9999` == 0, disables polling entirely (!)\r\n`retries: 0.9999` == 0, should be an error?\r\n`port: 0.9999` - == 0, should be an error?\r\n`throttle: 0.9999` == 0, should be an error?\r\n`timeout: 0.9999` == 0, reverts to no timeout (!)\r\n`gather_timeout: 0.9999` - [truthy check](https://github.com/ansible/ansible/blob/2a676ff897cd32d6cc34c7bc00b71ae5d54d32a4/lib/ansible/module_utils/facts/ansible_collector.py#L131), silently reverts to `DEFAULT_GATHER_TIMEOUT` \r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nPlaybook object hierarchy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n(2.18 devel)\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nN/A\r\n\r\n### Steps to Reproduce\r\n\r\nPass a floating point number between zero and one to an integer-expecting playbook attr that accepts zero- hilarity ensues.\r\n\r\n### Expected Results\r\n\r\nLack of hilarity. Floating-point values should actually be accepted and preserved where possible (async_val, delay, poll, as well as timeout and gather_timeout if we implemented them without signals). For pure-integer values (ports, ordinal numbers), unless non-zero mantissas can be reliably detected through the entire acceptable value range, floating point inputs should be a hard error.\r\n\r\n### Actual Results\r\n(see description above)\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-26T21:58:41Z",
        "user": "nitzmahone",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 83829,
        "title": "If `ANSIBLE_VAULT_PASSWORD_FILE=\"\"` it treats the current directory as the vault password file and tries to execute it",
        "body": "### Summary\r\n\r\nIf `ANSIBLE_VAULT_PASSWORD_FILE=\"\"` it treats the current directory as the vault password file and tries to execute it.\r\n\r\nIssue #42960 locked and closed as \u00abFixed by #83384\u00bb but not actually fixed.\r\n\r\nThe author of #42960 wants to override the `vault_password_file` setting in the `ansible.cfg` with the `ANSIBLE_VAULT_PASSWORD_FILE=\"\"` environment variable but it doesn't work.\r\n\r\n#83384 has nothing to do with this. It is still exactly the same as described in #42960 with the same error message with `ansible v2.17.3`.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nAnsible core\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible [core 2.17.3]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n-\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAny\r\n\r\n### Steps to Reproduce\r\n\r\n```console\r\n$ ANSIBLE_VAULT_PASSWORD_FILE=\"\" ansible-playbook playbooks/ping.yml\r\n\r\nERROR! Problem running vault password script /path/to/repo ([Errno 13] Permission denied: '/path/to/repo'). If this is not a script, remove the executable bit from the file.\r\n\r\n$ cd /path/to/repo/roles\r\n$ ANSIBLE_VAULT_PASSWORD_FILE=\"\" ansible-playbook ../playbooks/ping.yml\r\n\r\nERROR! Problem running vault password script /path/to/repo/roles ([Errno 13] Permission denied: '/path/to/repo/roles'). If this is not a script, remove the executable bit from the file.\r\n```\r\nIf `ANSIBLE_VAULT_PASSWORD_FILE=\"\"` it treats the current directory as the vault password file and tries to execute it.\r\n\r\n### Expected Results\r\n\r\nSet the `vault_password_file` setting in the `ansible.cfg` to `None`.\r\n\r\n### Actual Results\r\n\r\nhttps://github.com/ansible/ansible/blob/718ce136736cbe5d76cd01bc5da295c792d79b52/lib/ansible/cli/__init__.py#L601-L609\r\n\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-19T21:01:02Z",
        "user": "DeadNews",
        "labels": [
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 83813,
        "title": "`ssh_connection.sftp_batch_mode` missing description `TODO: write it`",
        "body": "### Summary\r\n\r\nFor `ssh_connection`.`sftp_batch_mode`, the description is `TODO: write it`\r\n\r\nSame for environment variable:\r\n- `ANSIBLE_SFTP_BATCH_MODE`\r\n- `ANSIBLE_LIBSSH_HOST_KEY_AUTO_ADD`\r\n- `ANSIBLE_LIBSSH_LOOK_FOR_KEYS`\r\n- `ANSIBLE_LIBSSH_PTY`\r\n\r\n\r\nhttps://docs.ansible.com/ansible/latest/collections/ansible/builtin/ssh_connection.html#parameter-sftp_batch_mode\r\nhttps://docs.ansible.com/ansible/latest/collections/environment_variables.html#envvar-ANSIBLE_SFTP_BATCH_MODE\r\n\r\n![image](https://github.com/user-attachments/assets/c6980f36-b8a3-4fa1-8850-a52c28e8ef39)\r\n\r\n\r\n### Issue Type\r\n\r\nDocumentation Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/plugins/connection/ssh.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n-\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n-\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu, Chrome\r\n\r\n### Additional Information\r\n\r\nWell we will know how to use this parameter\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-16T23:42:43Z",
        "user": "BourgoisMickael",
        "labels": [
            "has_pr"
        ]
    },
    {
        "number": 83798,
        "title": "callback_plugins activating 'inside a role'",
        "body": "### Summary\n\nThe documentation (https://docs.ansible.com/ansible/latest/plugins/callback.html) states:\r\nYou can activate a custom callback by either dropping it into a callback_plugins directory adjacent to your play, **inside a role**, or by putting it in one of the callback directory sources configured in [ansible.cfg](https://docs.ansible.com/ansible/2.8/reference_appendices/config.html#ansible-configuration-settings)\r\n\r\nI'm not sure how activating a callback plugin would work from 'inside a role' and seems like it wouldn't work.  I tried it just for kicks and nothing happened but maybe I'm missing it.  If there is a way to include a callback plugin in a role, maybe there is a better way of wording this?\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\ncallback_plugins\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.10]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Jul 29 2024, 16:56:48) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nGALAXY_SERVER_LIST(/etc/ansible/ansible.cfg) = ['published', 'rh-certified']\n```\n\n\n### OS / Environment\n\nDistributor ID: Ubuntu\r\nDescription:    Ubuntu 22.04.4 LTS\r\nRelease:        22.04\r\nCodename:       jammy\n\n### Additional Information\n\nClarity on callback plugin loading (specifically autoloading)\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-14T22:23:22Z",
        "user": "jmitchell0926",
        "labels": [
            "affects_2.16"
        ]
    },
    {
        "number": 83780,
        "title": "`copy` writes contents before setting permissions",
        "body": "### Summary\r\n\r\nin `ansible.builtin.copy`, ansible sets permissions on the file *after* it writes the contents of the file. This seems unsafe. An attacker could easily read the file repeatedly and learn sensitive information between the time that ansible writes the file and the time that ansible sets the permissions. \r\n\r\nIn my case, I got a `chown` permission denied error, and the module quit halfway through, leaving the contents of my file world readable.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncopy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Jul 29 2024, 16:56:48) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_FORCE_COLOR(.../ansible.cfg) = True\r\nANSIBLE_PIPELINING(.../ansible.cfg) = True\r\nCACHE_PLUGIN(.../ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(.../ansible.cfg) = $HOME/.cache/ansible\r\nCACHE_PLUGIN_TIMEOUT(.../ansible.cfg) = 86400\r\nCOLLECTIONS_PATHS(.../ansible.cfg) = ['.../collections']\r\nCONFIG_FILE() = .../ansible.cfg\r\nDEFAULT_FORKS(.../ansible.cfg) = 200\r\nDEFAULT_GATHERING(.../ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(.../ansible.cfg) = ['.../inventory.d']\r\nDEFAULT_MANAGED_STR(.../ansible.cfg) = This file is managed by Ansible.%n\r\nDEFAULT_ROLES_PATH(.../ansible.cfg) = ['.../roles']\r\nDEFAULT_STDOUT_CALLBACK(.../ansible.cfg) = yaml\r\nDIFF_ALWAYS(.../ansible.cfg) = True\r\nHOST_KEY_CHECKING(.../ansible.cfg) = False\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(.../ansible.cfg) = 86400\r\n_uri(.../ansible.cfg) = /home/simonleary_umass_edu/.cache/ansible\r\n\r\nCONNECTION:\r\n==========\r\n\r\nlocal:\r\n_____\r\npipelining(.../ansible.cfg) = True\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(.../ansible.cfg) = False\r\nssh_args(.../ansible.cfg) = -o ControlMaster=auto -o ControlPersist=60s\r\n\r\npsrp:\r\n____\r\npipelining(.../ansible.cfg) = True\r\n\r\nssh:\r\n___\r\nhost_key_checking(.../ansible.cfg) = False\r\npipelining(.../ansible.cfg) = True\r\nssh_args(.../ansible.cfg) = -o ControlMaster=auto -o ControlPersist=60s\r\n\r\nwinrm:\r\n_____\r\npipelining(.../ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nubuntu focal\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: playbook\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: write secret\r\n      ansible.builtin.copy:\r\n        content: super secret key\r\n        dest: /tmp/foobar\r\n        owner: root\r\n        mode: \"0600\"\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nIn this case, I don't have permission to make files owned by root. Ansible should not write anything into the file until it has the specified permissions. I should see an empty file, or no file at all.\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [playbook] ***************************************************************************************************************************\r\n\r\nTASK [write secret] ***********************************************************************************************************************\r\nfatal: [localhost]: FAILED! => changed=false \r\n  checksum: 676b327686e5ce2122d5a90fbeaef2cf28824e13\r\n  gid: ...\r\n  group: ...\r\n  mode: '0664'\r\n  msg: 'chown failed: [Errno 1] Operation not permitted: b''/tmp/foobar'''\r\n  owner: ...\r\n  path: /tmp/foobar\r\n  size: 16\r\n  state: file\r\n  uid: ...\r\n\r\nPLAY RECAP ********************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n\r\n$ ls -l /tmp/foobar\r\n-rw-rw-r-- ... /tmp/foobar\r\n\r\n$ cat /tmp/foobar\r\nsuper secret key\r\n```\r\n\r\nmy secret key is now world readable.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-13T21:00:54Z",
        "user": "simonLeary42",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.17"
        ]
    },
    {
        "number": 83747,
        "title": "ansible.builtin.apt autoremove doesn't remove anything while similar ansible.builtin.command does",
        "body": "### Summary\r\n\r\nIn some occasion (it worked fine before), `ansible.builtin.apt` with `autoremove: true` seems to not work properly (= no package to remove - but there is!).\r\n\r\nI've tried with and without `purge: true` / `--purge` -> same issue.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.2]\r\n  config file = /home/foobar/ansible/ansible.cfg\r\n  configured module search path = ['/home/foobar/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/pipx/venvs/ansible/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/foobar/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.11.2 (main, May  2 2024, 11:59:08) [GCC 12.2.0] (/opt/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/home/foobar/ansible/ansible.cfg) = ['timer', 'profile_roles']\r\nCONFIG_FILE() = /home/foobar/ansible/ansible.cfg\r\nDEFAULT_BECOME_METHOD(/home/foobar/ansible/ansible.cfg) = sudo\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nDebian 12.6 in wsl\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: ONE apt autoremove builtin module\r\n  ansible.builtin.apt:\r\n    autoremove: true\r\n    purge: true\r\n  # Doesnt work in check_mode..\r\n  # https://github.com/ansible/ansible/issues/83626\r\n  #diff: yes\r\n  tags:\r\n    - apt-autoremove\r\n\r\n- name: TWO apt autoremove with command module\r\n  ansible.builtin.command:\r\n    cmd: sudo apt autoremove --purge --dry-run\r\n  register: cmd_output\r\n  tags:\r\n    - apt-autoremove\r\n\r\n- name: show command output\r\n  debug:\r\n    msg: \"{{ cmd_output}}\"\r\n  tags:\r\n    - apt-autoremove\r\n```\r\n\r\nPlaybook run: `ansible-playbook -i inventories/test/ playbook.yml --limit \"myhost\" --tags apt-autoremove --diff`\r\n\r\n### Expected Results\r\n\r\nI expect task `ONE` to actually remove the packages that need to be autoremoved (`libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*`).\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [apt : apt autoremove builtin module] ***************************************************\r\ntask path: /home/foobar/ansible/roles/apt/tasks/main.yml:126\r\nThursday 08 August 2024  10:45:54 +0200 (0:00:00.011)       0:00:00.011 *******\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'echo ~ansible && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'/home/ansible\\n', b'OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/foobar/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/foobar/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/home/foobar/.ansible/cp/707b007166\" does not exist\\r\\ndebug3: ssh_connect_direct: entering\\r\\ndebug1: Connecting to 176.149.236.226 [176.149.236.226] port 442.\\r\\ndebug3: set_sock_tos: set socket 3 IP_TOS 0x10\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9984 ms remain after connect\\r\\ndebug1: identity file /home/foobar/.ssh/id_rsa type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_rsa-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ecdsa type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ecdsa_sk type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ecdsa_sk-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ed25519 type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ed25519-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ed25519_sk type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_ed25519_sk-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_xmss type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_xmss-cert type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_dsa type -1\\r\\ndebug1: identity file /home/foobar/.ssh/id_dsa-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u3\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_8.4p1 Debian-5+deb11u3\\r\\ndebug1: compat_banner: match: OpenSSH_8.4p1 Debian-5+deb11u3 pat OpenSSH* compat 0x04000000\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to 176.149.236.226:442 as \\'ansible\\'\\r\\ndebug3: put_host_port: [176.149.236.226]:442\\r\\ndebug3: record_hostkey: found key type ECDSA in file /home/foobar/.ssh/known_hosts:9\\r\\ndebug3: record_hostkey: found key type ED25519 in file /home/foobar/.ssh/known_hosts:12\\r\\ndebug3: load_hostkeys_file: loaded 2 keys from [176.149.236.226]:442\\r\\ndebug1: load_hostkeys: fopen /home/foobar/.ssh/known_hosts2: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory\\r\\ndebug3: order_hostkeyalgs: have matching best-preference key type ssh-ed25519-cert-v01@openssh.com, using HostkeyAlgorithms verbatim\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c,kex-strict-c-v00@openssh.com\\r\\ndebug2: host key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,kex-strict-s-v00@openssh.com\\r\\ndebug2: host key algorithms: rsa-sha2-512,rsa-sha2-256,ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug3: kex_choose_conf: will use strict KEX ordering\\r\\ndebug1: kex: algorithm: curve25519-sha256\\r\\ndebug1: kex: host key algorithm: ssh-ed25519\\r\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: SSH2_MSG_KEX_ECDH_REPLY received\\r\\ndebug1: Server host key: ssh-ed25519 SHA256:NXFKpmmV4eHTo6AIqaBcbx0/M3GEz9i/hnvYuRsJo\\r\\ndebug3: put_host_port: [176.149.236.226]:442\\r\\ndebug3: put_host_port: [176.149.236.226]:442\\r\\ndebug3: record_hostkey: found key type ECDSA in file /home/foobar/.ssh/known_hosts:9\\r\\ndebug3: record_hostkey: found key type ED25519 in file /home/foobar/.ssh/known_hosts:12\\r\\ndebug3: load_hostkeys_file: loaded 2 keys from [176.149.236.226]:442\\r\\ndebug1: load_hostkeys: fopen /home/foobar/.ssh/known_hosts2: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory\\r\\ndebug1: Host \\'[176.149.236.226]:442\\' is known and matches the ED25519 host key.\\r\\ndebug1: Found key in /home/foobar/.ssh/known_hosts:12\\r\\ndebug3: send packet: type 21\\r\\ndebug1: ssh_packet_send2_wrapped: resetting send seqnr 3\\r\\ndebug2: ssh_set_newkeys: mode 1\\r\\ndebug1: rekey out after 134217728 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: ssh_packet_read_poll2: resetting read seqnr 3\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: ssh_set_newkeys: mode 0\\r\\ndebug1: rekey in after 134217728 blocks\\r\\ndebug3: ssh_get_authentication_socket_path: path \\'/tmp/ssh-XXXXXXE5JBLx/agent.19957\\'\\r\\ndebug1: get_agent_identities: bound agent to hostkey\\r\\ndebug1: get_agent_identities: agent returned 1 keys\\r\\ndebug1: Will attempt key: foobar@foobar.com ED25519 SHA256:SXxYIsmbKc2QZbd8ZkpOmimTLwpqiC5vy2I agent\\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_rsa \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_ecdsa \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_ecdsa_sk \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_ed25519 \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_ed25519_sk \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_xmss \\r\\ndebug1: Will attempt key: /home/foobar/.ssh/id_dsa \\r\\ndebug2: pubkey_prepare: done\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com,webauthn-sk-ecdsa-sha2-nistp256@openssh.com>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey\\r\\ndebug3: start over, passed a different list publickey\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: foobar@foobar.com ED25519 SHA256:SXxYIsambKc0Eg2QZbd8ZkpOpmipppqiC5vy2I agent\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: foobar@foobar.com ED25519 SHA256:SXxYIambKcEgOxf2QZd8ZkpOpmimpqiC5vy2I agent\\r\\ndebug3: sign_and_send_pubkey: using publickey with ED25519 SHA256:SXxYIsambc0EgOxfQZbd8ZmimTLwpqiC5uvy2I\\r\\ndebug3: sign_and_send_pubkey: signing using ssh-ed25519 SHA256:SXxYIsambKc0EgOxf2bd8ZkpOpimTLwpqiCviy2I\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\nAuthenticated to 176.149.236.226 ([176.149.236.226]:442) using \"publickey\".\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /home/foobar/.ansible/cp/707b007166.LaArg3vnlnisFkiE\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug1: channel 0: new mux listener [/home/foobar/.ansible/cp/707b007166] (inactive timeout: 0)\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 4\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: set_sock_tos: set socket 3 IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 35290\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug3: client_repledge: enter\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 1: new mux-control [mux-control] (inactive timeout: 0)\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: mux_master_process_hello: channel 1 client version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: mux_master_process_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 107\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: mux_master_process_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo ~ansible && sleep 0\\'\", env 1\\r\\ndebug3: mux_master_process_new_session: got fds stdin 6, stdout 7, stderr 8\\r\\ndebug2: fd 7 setting O_NONBLOCK\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug1: channel 2: new session [client-session] (inactive timeout: 0)\\r\\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug3: client_input_hostkeys: received RSA key SHA256:g7pOtO5TeitrdtmBVOY/diQ+UZRTuikmWCMQUnwZc\\r\\ndebug3: client_input_hostkeys: received ECDSA key SHA256:D/dxVTzGwyim9QXyN8D/iTxzbg+c7lJ/8NARIRN80\\r\\ndebug3: client_input_hostkeys: received ED25519 key SHA256:NXFKpm8mV4eTo6AI6qBcbx0/M3GEzi/hnuvYuRsJo\\r\\ndebug3: put_host_port: [176.149.236.226]:442\\r\\ndebug1: client_input_hostkeys: searching /home/foobar/.ssh/known_hosts for [176.149.236.226]:442 / (none)\\r\\ndebug3: hostkeys_foreach: reading file \"/home/foobar/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_find: found ecdsa-sha2-nistp256 key at /home/foobar/.ssh/known_hosts:9\\r\\ndebug3: hostkeys_find: found ssh-ed25519 key at /home/foobar/.ssh/known_hosts:12\\r\\ndebug1: client_input_hostkeys: searching /home/foobar/.ssh/known_hosts2 for [176.149.236.226]:442 / (none)\\r\\ndebug1: client_input_hostkeys: hostkeys file /home/foobar/.ssh/known_hosts2 does not exist\\r\\ndebug3: client_input_hostkeys: 3 server keys: 1 new, 1 retained, 1 incomplete match. 0 to remove\\r\\ndebug3: client_input_hostkeys: asking server to prove ownership for 1 keys\\r\\ndebug3: send packet: type 80\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /home/ansible/.ssh/authorized_keys:1: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /home/ansible/.ssh/authorized_keys:1: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: channel 2: setting env LANG = \"en_US.UTF-8\"\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo ~ansible && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: client_repledge: enter\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: receive packet: type 81\\r\\ndebug1: client_global_hostkeys_prove_confirm: server used untrusted RSA signature algorithm ssh-rsa for key 0, disregarding\\r\\ndebug3: hostkeys_foreach: reading file \"/home/foobar/.ssh/known_hosts\"\\r\\ndebug3: host_delete: ECDSA key already at /home/foobar/.ssh/known_hosts:9\\r\\ndebug3: host_delete: ED25519 key already at /home/foobar/.ssh/known_hosts:12\\r\\ndebug1: update_known_hosts: known hosts file /home/foobar/.ssh/known_hosts2 does not exist\\r\\ndebug3: client_repledge: enter\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: chan_shutdown_write: channel 2: (i0 o1 sock -1 wfd 7 efd 8 [write])\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: chan_shutdown_read: channel 2: (i0 o3 sock -1 wfd 6 efd 8 [write])\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: chan_shutdown_read: channel 1: (i0 o1 sock 5 wfd 5 efd -1 [closed])\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 [mux-control] nr0 i3/0 o1/16 e[closed]/0 fd 5/5/-1 sock 5 cc -1 io 0x03/0x00)\\r\\n  #2 client-session (t4 [session] r0 i3/0 o3/0 e[write]/0 fd -1/-1/8 sock -1 cc -1 io 0x00/0x00)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: chan_shutdown_write: channel 1: (i3 o1 sock 5 wfd 5 efd -1 [closed])\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 [mux-control] nr0 i3/0 o3/0 e[closed]/0 fd 5/5/-1 sock 5 cc -1 io 0x00/0x00)\\r\\n\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/ansible/.ansible/tmp `\"&& mkdir \"` echo /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175 `\" && echo ansible-tmp-1723106756.1697943-35288-225708478567175=\"` echo /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175 `\" ) && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'ansible-tmp-1723106756.1697943-35288-225708478567175=/home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175\\n', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /opt/pipx/venvs/ansible/lib/python3.11/site-packages/ansible/modules/apt.py\r\n<176.149.236.226> PUT /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmp74kyvlir TO /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py\r\n<176.149.236.226> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' '[176.149.236.226]'\r\n<176.149.236.226> (0, b'sftp> put /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmp74kyvlir /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py\\n', b'OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/foobar/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/foobar/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH2_FXP_REALPATH . -> /home/ansible\\r\\ndebug3: Looking up /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmp74kyvlir\\r\\ndebug2: Sending SSH2_FXP_STAT \"/home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: do_upload: upload local \"/home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmp74kyvlir\" to remote \"/home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:3 P:/home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:131072 S:25353\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 25353 bytes at 131072\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'chmod u+x /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/ /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' -tt 176.149.236.226 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-qvigsopgyazcrjgnlmsgrvkjujgwfswn ; /usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/AnsiballZ_apt.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<176.149.236.226> (0, b'\\r\\n{\"changed\": false, \"cache_updated\": false, \"cache_update_time\": 1723104476, \"invocation\": {\"module_args\": {\"force_apt_get\": true, \"update_cache\": true, \"cache_valid_time\": 3600, \"autoremove\": true, \"state\": \"present\", \"update_cache_retries\": 5, \"update_cache_retry_max_delay\": 12, \"purge\": false, \"force\": false, \"upgrade\": null, \"dpkg_options\": \"force-confdef,force-confold\", \"autoclean\": false, \"fail_on_autoremove\": false, \"only_upgrade\": false, \"clean\": false, \"allow_unauthenticated\": false, \"allow_downgrade\": false, \"allow_change_held_packages\": false, \"lock_timeout\": 60, \"package\": null, \"deb\": null, \"default_release\": null, \"install_recommends\": null, \"policy_rc_d\": null}}}\\r\\n', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to 176.149.236.226 closed.\\r\\n\")\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'rm -f -r /home/ansible/.ansible/tmp/ansible-tmp-1723106756.1697943-35288-225708478567175/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nok: [myhost] => {\r\n    \"cache_update_time\": 1723104476,\r\n    \"cache_updated\": false,\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_change_held_packages\": false,\r\n            \"allow_downgrade\": false,\r\n            \"allow_unauthenticated\": false,\r\n            \"autoclean\": false,\r\n            \"autoremove\": true,\r\n            \"cache_valid_time\": 3600,\r\n            \"clean\": false,\r\n            \"deb\": null,\r\n            \"default_release\": null,\r\n            \"dpkg_options\": \"force-confdef,force-confold\",\r\n            \"fail_on_autoremove\": false,\r\n            \"force\": false,\r\n            \"force_apt_get\": true,\r\n            \"install_recommends\": null,\r\n            \"lock_timeout\": 60,\r\n            \"only_upgrade\": false,\r\n            \"package\": null,\r\n            \"policy_rc_d\": null,\r\n            \"purge\": false,\r\n            \"state\": \"present\",\r\n            \"update_cache\": true,\r\n            \"update_cache_retries\": 5,\r\n            \"update_cache_retry_max_delay\": 12,\r\n            \"upgrade\": null\r\n        }\r\n    }\r\n}\r\n\r\nTASK [apt : apt autoremove with command module] ********************************************************************************************\r\ntask path: /home/foobar/ansible/roles/apt/tasks/main.yml:139\r\nThursday 08 August 2024  10:45:57 +0200 (0:00:02.166)       0:00:02.178 *******\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'echo ~ansible && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'/home/ansible\\n', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/ansible/.ansible/tmp `\"&& mkdir \"` echo /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515 `\" && echo ansible-tmp-1723106757.0734124-35299-172020640331515=\"` echo /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515 `\" ) && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'ansible-tmp-1723106757.0734124-35299-172020640331515=/home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515\\n', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /opt/pipx/venvs/ansible/lib/python3.11/site-packages/ansible/modules/command.py\r\n<176.149.236.226> PUT /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmpc1j01exk TO /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py\r\n<176.149.236.226> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' '[176.149.236.226]'\r\n<176.149.236.226> (0, b'sftp> put /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmpc1j01exk /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py\\n', b'OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/foobar/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/foobar/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH2_FXP_REALPATH . -> /home/ansible\\r\\ndebug3: Looking up /home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmpc1j01exk\\r\\ndebug2: Sending SSH2_FXP_STAT \"/home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: do_upload: upload local \"/home/foobar/.ansible/tmp/ansible-local-35285iu2kspvy/tmpc1j01exk\" to remote \"/home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:3 P:/home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:98304 S:20951\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 20951 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'chmod u+x /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/ /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' -tt 176.149.236.226 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-txpvwbwgbtjscimcypkekunjofxwobnd ; /usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/AnsiballZ_command.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<176.149.236.226> (0, b'\\r\\n{\"changed\": true, \"stdout\": \"Reading package lists...\\\\nBuilding dependency tree...\\\\nReading state information...\\\\nThe following packages will be REMOVED:\\\\n  libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*\\\\n0 upgraded, 0 newly installed, 3 to remove and 0 not upgraded.\\\\nPurg libgpgme11 [1.14.0-1+b2]\\\\nPurg libtokyocabinet9 [1.4.48-13]\\\\nPurg linux-image-5.10.0-26-amd64 [5.10.197-1]\", \"stderr\": \"\\\\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\", \"rc\": 0, \"cmd\": [\"sudo\", \"apt\", \"autoremove\", \"--purge\", \"--dry-run\"], \"start\": \"2024-08-08 10:45:54.528234\", \"end\": \"2024-08-08 10:45:55.120425\", \"delta\": \"0:00:00.592191\", \"msg\": \"\", \"invocation\": {\"module_args\": {\"_raw_params\": \"sudo apt autoremove --purge --dry-run\", \"_uses_shell\": false, \"expand_argument_vars\": true, \"stdin_add_newline\": true, \"strip_empty_ends\": true, \"argv\": null, \"chdir\": null, \"executable\": null, \"creates\": null, \"removes\": null, \"stdin\": null}}}\\r\\n', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to 176.149.236.226 closed.\\r\\n\")\r\n<176.149.236.226> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<176.149.236.226> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o Port=442 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/foobar/.ansible/cp/707b007166\"' 176.149.236.226 '/bin/sh -c '\"'\"'rm -f -r /home/ansible/.ansible/tmp/ansible-tmp-1723106757.0734124-35299-172020640331515/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<176.149.236.226> (0, b'', b\"OpenSSH_9.2p1 Debian-2+deb12u3, OpenSSL 3.0.13 30 Jan 2024\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug1: /etc/ssh/ssh_config line 21: Applying options for *\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for 176.149.236.226\\r\\ndebug2: resolve_canonicalize: hostname 176.149.236.226 is address\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/foobar/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/foobar/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 35292\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nchanged: [myhost] => {\r\n    \"changed\": true,\r\n    \"cmd\": [\r\n        \"sudo\",\r\n        \"apt\",\r\n        \"autoremove\",\r\n        \"--purge\",\r\n        \"--dry-run\"\r\n    ],\r\n    \"delta\": \"0:00:00.592191\",\r\n    \"end\": \"2024-08-08 10:45:55.120425\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"sudo apt autoremove --purge --dry-run\",\r\n            \"_uses_shell\": false,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": null,\r\n            \"executable\": null,\r\n            \"expand_argument_vars\": true,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true\r\n        }\r\n    },\r\n    \"msg\": \"\",\r\n    \"rc\": 0,\r\n    \"start\": \"2024-08-08 10:45:54.528234\",\r\n    \"stderr\": \"\\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\",\r\n    \"stderr_lines\": [\r\n        \"\",\r\n        \"WARNING: apt does not have a stable CLI interface. Use with caution in scripts.\"\r\n    ],\r\n    \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nThe following packages will be REMOVED:\\n  libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*\\n0 upgraded, 0 newly installed, 3 to remove and 0 not upgraded.\\nPurg libgpgme11 [1.14.0-1+b2]\\nPurg libtokyocabinet9 [1.4.48-13]\\nPurg linux-image-5.10.0-26-amd64 [5.10.197-1]\",\r\n    \"stdout_lines\": [\r\n        \"Reading package lists...\",\r\n        \"Building dependency tree...\",\r\n        \"Reading state information...\",\r\n        \"The following packages will be REMOVED:\",\r\n        \"  libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*\",\r\n        \"0 upgraded, 0 newly installed, 3 to remove and 0 not upgraded.\",\r\n        \"Purg libgpgme11 [1.14.0-1+b2]\",\r\n        \"Purg libtokyocabinet9 [1.4.48-13]\",\r\n        \"Purg linux-image-5.10.0-26-amd64 [5.10.197-1]\"\r\n    ]\r\n}\r\n\r\nTASK [apt : show command output] ****************************************************************************\r\ntask path: /home/foobar/ansible/roles/apt/tasks/main.yml:146\r\nThursday 08 August 2024  10:45:58 +0200 (0:00:01.208)       0:00:03.386 *******\r\nok: [myhost] => {\r\n    \"msg\": {\r\n        \"changed\": true,\r\n        \"cmd\": [\r\n            \"sudo\",\r\n            \"apt\",\r\n            \"autoremove\",\r\n            \"--purge\",\r\n            \"--dry-run\"\r\n        ],\r\n        \"delta\": \"0:00:00.592191\",\r\n        \"end\": \"2024-08-08 10:45:55.120425\",\r\n        \"failed\": false,\r\n        \"msg\": \"\",\r\n        \"rc\": 0,\r\n        \"start\": \"2024-08-08 10:45:54.528234\",\r\n        \"stderr\": \"\\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\",\r\n        \"stderr_lines\": [\r\n            \"\",\r\n            \"WARNING: apt does not have a stable CLI interface. Use with caution in scripts.\"\r\n        ],\r\n        \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nThe following packages will be REMOVED:\\n  libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*\\n0 upgraded, 0 newly installed, 3 to remove and 0 not upgraded.\\nPurg libgpgme11 [1.14.0-1+b2]\\nPurg libtokyocabinet9 [1.4.48-13]\\nPurg linux-image-5.10.0-26-amd64 [5.10.197-1]\",\r\n        \"stdout_lines\": [\r\n            \"Reading package lists...\",\r\n            \"Building dependency tree...\",\r\n            \"Reading state information...\",\r\n            \"The following packages will be REMOVED:\",\r\n            \"  libgpgme11* libtokyocabinet9* linux-image-5.10.0-26-amd64*\",\r\n            \"0 upgraded, 0 newly installed, 3 to remove and 0 not upgraded.\",\r\n            \"Purg libgpgme11 [1.14.0-1+b2]\",\r\n            \"Purg libtokyocabinet9 [1.4.48-13]\",\r\n            \"Purg linux-image-5.10.0-26-amd64 [5.10.197-1]\"\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-08T08:56:00Z",
        "user": "4wk-",
        "labels": [
            "module",
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 83727,
        "title": "raw module produces non-zero return code when using network_cli connection",
        "body": "### Summary\r\n\r\nWhen I'm setting the `ansible_connection: network_cli` the `ansible.builtin.raw` module produces the following error.  \r\n```\r\n$ ansible -i inventory/dev/hosts.yml datadomain -m raw -a \"system show all\" -vvvvv\r\nansible [core 2.15.12]\r\n  config file = /sapmnt/home/JOHN/repositories/ansible-networker/ansible.cfg\r\n  configured module search path = ['/sapmnt/home/JOHN/repositories/ansible-networker/plugins/modules']\r\n  ansible python module location = /sapmnt/home/JOHN/.pyenv/versions/3.10.14/envs/ansible/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /sapmnt/home/JOHN/repositories/ansible-networker/collections\r\n  executable location = /sapmnt/home/JOHN/.pyenv/versions/ansible/bin/ansible\r\n  python version = 3.10.14 (main, May  6 2024, 09:28:46) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/sapmnt/home/JOHN/.pyenv/versions/3.10.14/envs/ansible/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\nUsing /sapmnt/home/JOHN/repositories/ansible-networker/ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /sapmnt/home/JOHN/repositories/ansible-networker/inventory/dev/hosts.yml as it did not pass its verify_file() method\r\nParsed /sapmnt/home/JOHN/repositories/ansible-networker/inventory/dev/hosts.yml inventory source with yaml plugin\r\nLoading callback plugin minimal of type stdout, v2.0 from /sapmnt/home/JOHN/.pyenv/versions/3.10.14/envs/ansible/lib/python3.10/site-packages/ansible/plugins/callback/minimal.py\r\nAttempting to use 'default' callback.\r\nSkipping callback 'default', as we already have a stdout callback.\r\nAttempting to use 'junit' callback.\r\nAttempting to use 'minimal' callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nAttempting to use 'oneline' callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\nAttempting to use 'tree' callback.\r\nLoading collection ansible.netcommon from /sapmnt/home/JOHN/repositories/ansible-networker/collections/ansible_collections/ansible/netcommon\r\nLoading collection ansible.utils from /sapmnt/home/JOHN/repositories/ansible-networker/collections/ansible_collections/ansible/utils\r\n<myhost.example.com> attempting to start connection\r\n<myhost.example.com> using connection plugin ansible.netcommon.network_cli\r\nFound ansible-connection at path /sapmnt/home/JOHN/.pyenv/versions/ansible/bin/ansible-connection\r\n<myhost.example.com> local domain socket does not exist, starting it\r\n<myhost.example.com> control socket path is /sapmnt/home/JOHN/.ansible/pc/be4d7c2276\r\n<myhost.example.com> Loading collection ansible.builtin from \r\n<myhost.example.com> Loading collection ansible.netcommon from /sapmnt/home/JOHN/repositories/ansible-networker/collections/ansible_collections/ansible/netcommon\r\n<myhost.example.com> Loading collection ansible.utils from /sapmnt/home/JOHN/repositories/ansible-networker/collections/ansible_collections/ansible/utils\r\n<myhost.example.com> local domain socket listeners started successfully\r\n<myhost.example.com> loaded cliconf plugin datadomain from path /sapmnt/home/JOHN/repositories/ansible-networker/plugins/cliconf/datadomain.py for network_os datadomain\r\n<myhost.example.com> ssh type is set to paramiko\r\n<myhost.example.com> Loading collection ansible.builtin from \r\n<myhost.example.com> local domain socket path is /sapmnt/home/JOHN/.ansible/pc/be4d7c2276\r\n<myhost.example.com> ESTABLISH LOCAL CONNECTION FOR USER: JOHN\r\n<myhost.example.com> EXEC system show all\r\nmyhost.example.com | FAILED | rc=127 >>\r\n/bin/sh: system: command not found\r\nnon-zero return code\r\n```\r\nWithout setting those connection variables, the `raw` module works as expected. \r\nI would expect the `raw` module to work in either case. One of the benefits of the `raw` module is that it returns a non-zero code when the command fails. This is a benefit that the customer wants to use against their device. \r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.raw\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.2]\r\n  config file = /sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg\r\n  configured module search path = ['/sapmnt/home/C5377732/repositories/ansible-networker/plugins/modules']\r\n  ansible python module location = /sapmnt/home/C5377732/venvs/ansible2.18/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /sapmnt/home/C5377732/repositories/ansible-networker/collections\r\n  executable location = /sapmnt/home/C5377732/venvs/ansible2.18/bin/ansible\r\n  python version = 3.10.14 (main, May  6 2024, 09:28:46) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/sapmnt/home/C5377732/venvs/ansible2.18/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCACHE_PLUGIN(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = facts.d\r\nCACHE_PLUGIN_TIMEOUT(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = 86400\r\nCOLLECTIONS_PATHS(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-networker/co>\r\nCONFIG_FILE() = /sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg\r\nDEFAULT_ACTION_PLUGIN_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-net>\r\nDEFAULT_CLICONF_PLUGIN_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-ne>\r\nDEFAULT_CONNECTION_PLUGIN_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible>\r\nDEFAULT_MODULE_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-networker/>\r\nDEFAULT_ROLES_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-networker/r>\r\nDEFAULT_TERMINAL_PLUGIN_PATH(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['/sapmnt/home/C5377732/repositories/ansible-n>\r\nHOST_KEY_CHECKING(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = False\r\nINVENTORY_ENABLED(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = ['auto', 'host_list', 'yaml', 'ini']\r\nINVENTORY_UNPARSED_IS_FAILED(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = True\r\nTRANSFORM_INVALID_GROUP_CHARS(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = silently\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = 86400\r\n_uri(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = /sapmnt/home/C5377732/repositories/ansible-networker/facts.d\r\n\r\nCONNECTION:\r\n==========\r\n\r\nnetwork_cli:\r\n___________\r\nhost_key_checking(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = False\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = False\r\npipelining(/sapmnt/home/C5377732/repositories/ansible-networker/ansible.cfg) = True\r\n\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 8\r\n\r\n### Steps to Reproduce\r\n\r\nCommands provided in description\r\n\r\n\r\n### Expected Results\r\n\r\nAnsible's `raw` module should behave the same using `ssh` or `network_cli` connection plugin. It should definitely not return a non-zero return code as show in description.\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible -i inventory/dev/hosts.yml datadomain -m raw -a \"system show all\" -e ansible_connection=network_cli -e ansible_network_os=cisco.ios.ios\r\nmyhost.example.com | FAILED | rc=127 >>\r\n/bin/sh: system: command not found\r\nnon-zero return code\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-06T18:51:04Z",
        "user": "ansiblejunky",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.15",
            "affects_2.17"
        ]
    },
    {
        "number": 83699,
        "title": "ansible-galaxy silently ignores invalid parameters in requirements.yml",
        "body": "### Summary\n\nWhen installing a collection from a git repository using ansible-galaxy, if an invalid parameter is specified in a requirements.yml, it's silently ignored and ansible-galaxy proceeds with default values, which may not have been what the user wanted.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-galaxy\n\n### Ansible Version\n\n```console\nansible-galaxy [core 2.17.2]\r\npython version = 3.12.3\n```\n\n\n### Configuration\n\n```console\nN/A\n```\n\n\n### OS / Environment\n\nUbuntu\n\n### Steps to Reproduce\n\nThis example requirements.yml will successfully install a collection from git, but not using the correct tag because the user hypothetically confused `version` with `tag` but ansible-galaxy did not complain about it and proceeded to install from the main branch:\r\n\r\n```yaml\r\ncollections:\r\n  - name: https://github.com/theforeman/foreman-ansible-modules\r\n    type: git\r\n    tag: v4.1.0\r\n```\n\n### Expected Results\n\nansible-galaxy should complain that `tag` is not a valid parameter and refuse to install the collection (maybe check the file against a schema).\n\n### Actual Results\n\n```console\n# ansible-galaxy install -r ./requirements.yml\r\nCloning into '/root/.ansible/tmp/ansible-local-5721z5h_xyre/tmp53g5mloa/foreman-ansible-modulesbptnb1q3'...\r\nremote: Enumerating objects: 1542, done.\r\nremote: Counting objects: 100% (1542/1542), done.\r\nremote: Compressing objects: 100% (767/767), done.\r\nremote: Total 1542 (delta 1125), reused 947 (delta 732), pack-reused 0\r\nReceiving objects: 100% (1542/1542), 2.35 MiB | 3.86 MiB/s, done.\r\nResolving deltas: 100% (1125/1125), done.\r\nYour branch is up to date with 'origin/develop'.\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nStarting collection install process\r\nInstalling 'theforeman.foreman:4.2.0-dev' to '/root/.ansible/collections/ansible_collections/theforeman/foreman'\r\nCreated collection for theforeman.foreman:4.2.0-dev at /root/.ansible/collections/ansible_collections/theforeman/foreman\r\ntheforeman.foreman:4.2.0-dev was installed successfully\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-08-01T12:00:38Z",
        "user": "gtirloni",
        "labels": [
            "bug",
            "has_pr",
            "P3"
        ]
    },
    {
        "number": 83682,
        "title": "user parameter shouldn't be required when adding a variable with cron_file set on cron module",
        "body": "### Summary\n\nUsing the `cron` module, when I try to add an environment variable to a file under `/etc/cron.d`, it requires me to set `user` parameter, even `user` isn't present in the added line.\r\nSet `user` makes sense in the jobs because under `/etc/cron.d` the user that will execute couldn't be the same as root, but since when adding an environment variable the user doesn't matter, shouldn't be mandatory.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncron\n\n### Ansible Version\n\n```console\nansible [core 2.17.1]\r\n  config file = None\r\n  configured module search path = ['/Users/marcos.alano/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/Cellar/ansible/10.1.0/libexec/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/marcos.alano/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] (/opt/homebrew/Cellar/ansible/10.1.0/libexec/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = None\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nTarget OS: Ubuntu 20.04.5\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Add path for ansible-pull entry\r\n  ansible.builtin.cron:\r\n    name: PATH\r\n    env: true\r\n    job: /usr/local/bin:$PATH\r\n    cron_file: ansible-pull\r\n```\r\n\n\n### Expected Results\n\nNo errors.\n\n### Actual Results\n\n```console\nTASK [Add path for ansible-pull entry] *****************************************\r\nFAILED! => {\"changed\": false, \"msg\": \"To use cron_file=... parameter you must specify user=... as well\"}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-29T18:31:24Z",
        "user": "mhalano",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.17"
        ]
    },
    {
        "number": 83661,
        "title": "apt_repository attempt to use the unsupported Python.",
        "body": "### Summary\r\n\r\nWhen I try to run ansible.builtin.apt_repository with ansible-core from the devel branch on GitHub, it breaks by using an unsupported /usr/bin/python interpreter and raises an error.\r\n\r\nThis occurs under the environment where the target server's /usr/bin/python points to an unsupported version by ansible-core (e.g., Python 2.7), /usr/bin/python3 points to a supported version by ansible-core (e.g., Python 3.8), /usr/bin/python has the python-apt package installed, and /usr/bin/python3 doesn't have the python3-apt package installed. As a result, ansible.builtin.apt_repository runs /tmp/ansible_ansible.builtin.apt_repository_payload_xxxxxx/ansible_ansible.builtin.apt_repository_payload.zip/ansible/module_utils/basic.py on the unsupported /usr/bin/python interpreter and raises an error.\r\n\r\n\r\n#### Error message\r\n> fatal: [managed]: FAILED! => {\"changed\": false, \"module_stderr\": \"Shared connection to managed closed.\\r\\n\", \"module_stdout\": \"Traceback (most recent call last):\\r\\n  File \\\"<string>\\\", line 1, in <module>\\r\\nModuleNotFoundError: No module named 'apt'\\r\\nTraceback (most recent call last):\\r\\n  File \\\"<stdin>\\\", line 12, in <module>\\r\\n  File \\\"/tmp/ansible_ansible.builtin.apt_repository_payload_wj5e52mi/ansible_ansible.builtin.apt_repository_payload.zip/ansible/module_utils/basic.py\\\", line 17\\r\\n    msg=f\\\"ansible-core requires a minimum of Python version {'.'.join(map(str, _PY_MIN))}. Current version: {''.join(sys.version.splitlines())}\\\",\\r\\n                                                                                                                                               ^\\r\\nSyntaxError: invalid syntax\\r\\n\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}\r\n\r\n\r\n#### Reason for the error\r\nIf the ansible.builtin.apt_repository module does not find the apt package on /usr/bin/python3 on the target server (and HAVE_PYTHON_APT = False)  but finds it on /usr/bin/python, it will use /usr/bin/python.\r\n\r\n> found the Python bindings; respawn this module under the interpreter where we found them https://github.com/ansible/ansible/blob/79f819dc54e4cf5dc3853aea6b39626ee5e6fef4/lib/ansible/modules/apt_repository.py#L673-L680\r\n\r\nAs a result, it executes /tmp/ansible_ansible.builtin.apt_repository_payload_wj5e52mi/ansible_ansible.builtin.apt_repository_payload.zip/ansible/module_utils/basic.py using /usr/bin/python, which is unsupported python 2.\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt_repository\r\n\r\n### Ansible Version\r\n\r\n```console\r\n# ansible --version\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are\r\nmodifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\nansible [core 2.18.0.dev0]\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /root/venv/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /root/venv/bin/ansible\r\n  python version = 3.12.3 (main, Apr 10 2024, 05:33:47) [GCC 13.2.0] (/root/venv/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n(venv) root@014ebbcf24fe:/#\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are\r\nmodifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\n/bin/sh: 1: less: not found\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04, Cumulus Linux 4.2\r\n\r\nI used Ubuntu 20.04 for the reproduction test. My Cumulus Linux 4.2 has /usr/bin/python3 pointing to Python 3.7 and /usr/bin/python pointing to Python 2.7. Therefore, I encountered the same issue with ansible-core 2.17.2 which supports Python 3.7 as target server interpreter.\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n* Create playbook.yml on current directory.\r\n```yaml (paste below)\r\n---\r\n- name: Simple Playbook\r\n  hosts: managed\r\n  become: yes\r\n  tasks:\r\n    - name: Add nginx stable repository from PPA and install its signing key on Ubuntu target\r\n      ansible.builtin.apt_repository:\r\n        repo: ppa:nginx/stable\r\n        install_python_apt: true\r\n```\r\n\r\n* Create docker-compose.yml on same directory. This compose file sets up an environment to reproduce the issue.\r\n```yaml\r\nversion: '3.8'\r\n\r\nservices:\r\n  managed:\r\n    image: docker-hub-mirror.linecorp.com/ubuntu:20.04\r\n    container_name: managed\r\n    tty: true\r\n    environment:\r\n      - DEBIAN_FRONTEND=noninteractive\r\n    command: >\r\n      /bin/bash -c \"\r\n      apt-get update &&\r\n      apt-get install -y python2 python-apt python3 openssh-server gnupg2 &&\r\n      update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1 &&\r\n      mkdir -p /var/run/sshd && echo 'root:root' | chpasswd &&\r\n      sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config &&\r\n      service ssh start && tail -f /dev/null\"\r\n    networks:\r\n      - ansible-net\r\n\r\n  controller:\r\n    image: docker-hub-mirror.linecorp.com/ubuntu:24.04\r\n    container_name: controller\r\n    tty: true\r\n    environment:\r\n      - DEBIAN_FRONTEND=noninteractive\r\n    depends_on:\r\n      - managed\r\n    volumes:\r\n      - ./playbook.yml:/root/playbook.yml\r\n    command: >\r\n      /bin/bash -c \"\r\n      apt-get update &&\r\n      apt-get install -y python3 python3-pip python3-venv openssh-client sshpass netcat-openbsd &&\r\n      python3 -m venv /root/venv &&\r\n      source /root/venv/bin/activate &&\r\n      pip install https://github.com/ansible/ansible/archive/devel.tar.gz &&\r\n      ssh-keygen -t rsa -N '' -f /root/.ssh/id_rsa &&\r\n      while ! nc -z managed 22; do sleep 1; done &&\r\n      sshpass -p root ssh-copy-id -o StrictHostKeyChecking=no root@managed &&\r\n      ansible-playbook -i 'managed,' -u root /root/playbook.yml &&\r\n      tail -f /dev/null\"\r\n    networks:\r\n      - ansible-net\r\n\r\nnetworks:\r\n  ansible-net:\r\n    driver: bridge\r\n```\r\n\r\n* Run `docker compose up -d` on same directory  \r\n\r\n\r\n### Expected Results\r\n\r\nI expected python3-apt packages to be installed for /usr/bin/python3 and use this interpreter because I asuumed Ansible to work as long as a supported Python 3 is installed even if an unsupported Python 2 is installed.\r\n\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible-playbook -i 'managed,' -u root /root/playbook.yml\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are\r\nmodifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\n\r\nPLAY [Simple Playbook] ***************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************\r\nok: [managed]\r\n\r\nTASK [Add nginx stable repository from PPA and install its signing key on Ubuntu target] *********************************\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: SyntaxError: invalid syntax\r\nfatal: [managed]: FAILED! => {\"changed\": false, \"module_stderr\": \"Shared connection to managed closed.\\r\\n\", \"module_stdout\": \"Traceback (most recent call last):\\r\\n  File \\\"<string>\\\", line 1, in <module>\\r\\nModuleNotFoundError: No module named 'apt'\\r\\nTraceback (most recent call last):\\r\\n  File \\\"<stdin>\\\", line 12, in <module>\\r\\n  File \\\"/tmp/ansible_ansible.builtin.apt_repository_payload_gclwgc3s/ansible_ansible.builtin.apt_repository_payload.zip/ansible/module_utils/basic.py\\\", line 17\\r\\n    msg=f\\\"ansible-core requires a minimum of Python version {'.'.join(map(str, _PY_MIN))}. Current version: {''.join(sys.version.splitlines())}\\\",\\r\\n                                                                                                                                               ^\\r\\nSyntaxError: invalid syntax\\r\\n\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}\r\n\r\nPLAY RECAP ***************************************************************************************************************\r\nmanaged                    : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n-vvvv option log is too long and I cannot submit it with following GitHub error.\r\n> There was an error creating your issue: body is too long (maximum is 65536 characters).\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-23T13:20:56Z",
        "user": "Miyoshi-Ryota",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.18"
        ]
    },
    {
        "number": 83647,
        "title": "ansible_shell_executable also allow list",
        "body": "### Summary\n\nCurrently `ansible_shell_executable` is only able to be a path to a single executable. It would be great if `ansible_shell_executable` could also accept a list to do e.g.:\r\n`ansible_shell_executable: [ /usr/bin/env, -i, /bin/bash ]`\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible_shell_executable\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-21T23:57:31Z",
        "user": "agowa",
        "labels": [
            "feature",
            "P3"
        ]
    },
    {
        "number": 83633,
        "title": "There are no definitions for valid color options",
        "body": "### Summary\r\n\r\nOther than the defaults listed for the `COLOR_*` variables, there are no examples for what are valid choices for colors. Looking at [`parsecolor()`](https://github.com/ansible/ansible/blob/36e5b21807cbe072631c2019a9f5ca61be71d079/lib/ansible/utils/color.py#L55-L69) in `ansible.utils.color`, there appear to be ways to select colors aside from using predefined color names that appear to also be undocumented.\r\n\r\nHaving the list of pre-defined colors, and valid examples of how to use the alternate color methods would be useful when trying to modify output to suit custom display configurations and/or address accessibility needs.\r\n\r\n### Issue Type\r\n\r\nDocumentation Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/utils/color.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['${HOME}/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = ${PYTHON_HOME}/python/3.12.4/lib/python3.12/site-packages/ansible\r\n  ansible collection location = ${HOME}/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = ${PYTHON_HOME}/python/3.12.4/bin/ansible\r\n  python version = 3.12.4 (main, Jun 14 2024, 08:26:51) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (${PYTHON_HOME}/python/3.12.4/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = vim\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n> cat /etc/os-release\r\nNAME=\"Red Hat Enterprise Linux\"\r\nVERSION=\"8.9 (Ootpa)\"\r\nID=\"rhel\"\r\nID_LIKE=\"fedora\"\r\nVERSION_ID=\"8.9\"\r\nPLATFORM_ID=\"platform:el8\"\r\nPRETTY_NAME=\"Red Hat Enterprise Linux 8.9 (Ootpa)\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:redhat:enterprise_linux:8::baseos\"\r\nHOME_URL=\"https://www.redhat.com/\"\r\nDOCUMENTATION_URL=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\n\r\nREDHAT_BUGZILLA_PRODUCT=\"Red Hat Enterprise Linux 8\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=8.9\r\nREDHAT_SUPPORT_PRODUCT=\"Red Hat Enterprise Linux\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"8.9\"\r\n\r\n### Additional Information\r\n\r\nWhen the improvement is applied, it will be easier to know what options are available when configuring colors for the ansible output types.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-19T14:47:26Z",
        "user": "dylannorthrup",
        "labels": [
            "docs",
            "P3",
            "affects_2.17"
        ]
    },
    {
        "number": 83632,
        "title": "Using from_yaml_all with data which contains a date gets \"AnsibleUnsafeText\"",
        "body": "### Summary\n\nWhen I read a yaml file to parse it with `from_yaml_all` and the file contains an entry with a date (like: `date: 2024-03-12`) and safe (register) this to a variable, the variable will be of type `AnsibleUnsafeText`.  I would expect it to be of type `list` or `dict`. If I would work directly with the result of `from_yaml_all` it seems to work as expected. If the date would be text (like: `date: \"2024-03-12\"`) it works as it should.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nfrom_yaml_all\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/rztal/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/rztal/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.3 (main, Jun 19 2024, 10:06:03) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3.12)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\ntested on rhel8 and manjaro as ansible server and target system and rhel9 as target system\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nExample:\r\ntest.yml file with following content:\r\n```yaml\r\ndate: 2026-06-21\r\n```\r\nPlaybook (site.yml):\r\n```yaml\r\n- name: Playbook\r\n  hosts: localhost\r\n  tasks:\r\n    - name: Read file\r\n      ansible.builtin.slurp:\r\n        src: test.yml\r\n      register: __podman_kube_content\r\n    - name: Test\r\n      ansible.builtin.debug:\r\n        msg: \"{{  __podman_kube | type_debug }}\"\r\n      vars:\r\n        __podman_kube: \"{{ __podman_kube_content.content | b64decode |from_yaml_all }}\"\r\n```\r\nTo execute:\r\n```sh\r\nansible-playbook site.yml\r\n```\n\n### Expected Results\n\nI exepected to get `dict` from the debug message but got `AnsibleUnsafeText` instead\n\n### Actual Results\n\n```console\nOutput of ansible-playbook -vvvv site.yml:\r\n\r\nansible-playbook [core 2.16.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.12.3 (main, Jun 19 2024, 10:06:03) [GCC 8.5.0 20210514 (Red Hat 8.5.0-22)] (/usr/bin/python3.12)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python3.12/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: site.yml ***************************************************************************************************************************\r\nPositional arguments: site.yml\r\nverbosity: 4\r\nconnection: ssh\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/etc/ansible/hosts',)\r\nforks: 5\r\n1 plays in site.yml\r\n\r\nPLAY [Playbook] ******************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************************\r\ntask path: /home/user/tmp/site.yml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: user\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~user && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/user/.ansible/tmp `\"&& mkdir \"` echo /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349 `\" && echo ansible-tmp-1721392919.6683378-205444-262941304964349=\"` echo /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.12/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/user/.ansible/tmp/ansible-local-205441a04slcfz/tmpca93iiei TO /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349/ /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3.12 /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/user/.ansible/tmp/ansible-tmp-1721392919.6683378-205444-262941304964349/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [Read file] *****************************************************************************************************************************\r\ntask path: /home/user/tmp/site.yml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: user\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~user && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/user/.ansible/tmp `\"&& mkdir \"` echo /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346 `\" && echo ansible-tmp-1721392920.911871-205499-110511430123346=\"` echo /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.12/site-packages/ansible/modules/slurp.py\r\n<127.0.0.1> PUT /home/user/.ansible/tmp/ansible-local-205441a04slcfz/tmp2zoiniz7 TO /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346/AnsiballZ_slurp.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346/ /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346/AnsiballZ_slurp.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3.12 /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346/AnsiballZ_slurp.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/user/.ansible/tmp/ansible-tmp-1721392920.911871-205499-110511430123346/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"content\": \"ZGF0ZTogMjAyNi0wNi0yMQo=\",\r\n    \"encoding\": \"base64\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"src\": \"test.yml\"\r\n        }\r\n    },\r\n    \"source\": \"test.yml\"\r\n}\r\n\r\nTASK [Test] **********************************************************************************************************************************\r\ntask path: /home/user/tmp/site.yml:9\r\nok: [localhost] => {\r\n    \"msg\": \"AnsibleUnsafeText\"\r\n}\r\n\r\nPLAY RECAP ***********************************************************************************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0  \r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-19T12:56:05Z",
        "user": "someplace53",
        "labels": [
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 83626,
        "title": "apt autoremove diff mode doesn't work in check mode",
        "body": "### Summary\n\nI'm surprised I didn't find a previous issue or documentation mentioning this, but.. When I run a cleanup task with diff in order to run `apt autoremove --purge`, it doesn't show me the detailed list of packages that would be uninstalled in check mode.\r\nOther \"subcommands\" of apt are working fine with ansible diff in check mode (such as installing or removing packages).\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\napt\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.17.2]\r\n  config file = /home/foobar/ansible/ansible.cfg\r\n  configured module search path = ['/home/foobar/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/pipx/venvs/ansible/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/foobar/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.11.2 (main, May  2 2024, 11:59:08) [GCC 12.2.0] (/opt/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/home/foobar/ansible/ansible.cfg) = ['timer', 'profile_roles']\r\nCONFIG_FILE() = /home/foobar/ansible/ansible.cfg\r\nDEFAULT_BECOME_METHOD(/home/foobar/ansible/ansible.cfg) = sudo\n```\n\n\n### OS / Environment\n\nDebian 12.6 in wsl\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Make sure autoremovable packages are removed\r\n  ansible.builtin.apt:\r\n    autoremove: true\r\n    purge: true\r\n  # Doesnt work in check_mode.. why?\r\n  diff: yes\r\n  tags:\r\n    - apt-autoremove                                                                                                                   \r\n```\r\n\r\nran with `ansible-playbook -i inventories/test/ playbook.yml --limit \"myhost\" --tags apt-autoremove --diff --check` \n\n### Expected Results\n\nIn check mode with diff mode, I expect ansible to list me the package that would be autoremoved by my task, in the same way as standard removal.\r\nSomething like:\r\n\r\n```\r\nThe following packages will be REMOVED:\r\n  libgpgme11* libtokyocabinet9*\r\n0 upgraded, 0 newly installed, 2 to remove and 0 not upgraded.\r\n```\r\n\r\nAfter all, `apt autoremove --purge` command already has a `--dry-run` option:\r\n```\r\n$ sudo apt autoremove --purge --dry-run\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nThe following packages will be REMOVED:\r\n  libgpgme11* libtokyocabinet9*\r\n0 upgraded, 0 newly installed, 2 to remove and 0 not upgraded.\r\nPurg libgpgme11 [1.14.0-1+b2]\r\nPurg libtokyocabinet9 [1.4.48-13]\r\n```\n\n### Actual Results\n\n```console\nTASK [apt : Make sure autoremovable packages are removed] ***************************************************************\r\nWednesday 17 July 2024  17:47:32 +0200 (0:00:00.012)       0:00:00.012 ********\r\nok: [tagada]\r\n\r\nPLAY RECAP **************************************************************************************************************\r\ntagada                     : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\nPlaybook run took 0 days, 0 hours, 0 minutes, 1 seconds\r\nWednesday 17 July 2024  17:47:33 +0200 (0:00:01.231)       0:00:01.244 ********\r\n===============================================================================\r\napt --------------------------------------------------------------------- 1.23s\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\ntotal ------------------------------------------------------------------- 1.23s\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-17T16:01:11Z",
        "user": "4wk-",
        "labels": [
            "module",
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 83623,
        "title": "Unable to configure url credentials for private collection installed by url",
        "body": "### Summary\r\n\r\nI try to install a collection from an private https-fileserver, as described for roles [in the docs](https://cn-ansibledoc.readthedocs.io/zh-cn/latest/galaxy/user_guide.html#installing-multiple-roles-from-a-file).\r\n\r\nTo not include the authentication-credentials in the `requirements.yml` file, I would like to configure those in the `ansible.cfg` file and found a matching paragraph in the [galaxy-client docs](https://docs.ansible.com/ansible/2.9/user_guide/collections_using.html#configuring-the-ansible-galaxy-client).\r\n\r\nBut this configuration doesn't work for https-fileservers.\r\n\r\n### Issue Type\r\n\r\nFeature Request\r\n\r\n### Component Name\r\n\r\nansible-galaxy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.2]\r\n  config file = /Users/frankbartnitzek/tmp/ansible-issue/ansible.cfg\r\n  configured module search path = ['/Users/frankbartnitzek/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/frankbartnitzek/tmp/ansible-issue/.venv/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/frankbartnitzek/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/frankbartnitzek/tmp/ansible-issue/.venv/bin/ansible\r\n  python version = 3.12.3 (main, Apr 12 2024, 17:16:04) [Clang 15.0.0 (clang-1500.1.0.2.5)] (/Users/frankbartnitzek/tmp/ansible-issue/.venv/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /Users/frankbartnitzek/tmp/ansible-issue/ansible.cfg\r\nGALAXY_SERVER_LIST(/Users/frankbartnitzek/tmp/ansible-issue/ansible.cfg) = ['dacoso']\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n```\r\nProductName:\t\tmacOS\r\nProductVersion:\t\t14.5\r\nBuildVersion:\t\t23F79\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nIf I store the fileserver-credentials into an `ansible.cfg` file:\r\n\r\n```\r\n[galaxy]\r\nserver_list = dacoso\r\n\r\n[galaxy_server.dacoso]\r\nurl=https://MY_HOST\r\nusername=MY_USER\r\npassword=MY_TOKEN\r\n```\r\n\r\nAnd declare the requirements without credentials in `requirements.yml`:\r\n\r\n```yaml\r\ncollections:\r\n  - name: dacoso.connection_reports\r\n    type: url\r\n    source: https://MY_HOST/MY_PATH/connection_reports/dacoso-connection_reports-1.0.1.tar.gz\r\n```\r\n\r\nThe authentication against the fileserver fails.\r\n\r\n### Expected Results\r\n\r\nI expect that the ansible-galaxy client in the `ansible.cfg` file also supports a fileserver with username + password/token authentication.\r\n\r\nWith an `requirements_with_credentials.yml` exposing the credentials in the source-url:\r\n\r\n```yaml\r\ncollections:\r\n  - name: dacoso.connection_reports\r\n    type: url\r\n    source: https://MY_USER:MY_TOKEN@MY_HOST/MY_PATH/connection_reports/dacoso-connection_reports-1.0.1.tar.gz\r\n```\r\n\r\nThe installation of the collection works as expected:\r\n\r\n```sh\r\n$ ansible-galaxy install -r requirements_with_credentials.yml\r\nDownloading https://MY_USER:MY_TOKEN@MY_HOST/MY_PATH/connection_reports/dacoso-connection_reports-1.0.1.tar.gz to /Users/frankbartnitzek/.ansible/tmp/ansible-local-12889g9yxe5qv/tmpbk2cwvvf/dacoso-connection_reports-1.0.1-rl953_6y\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nStarting collection install process\r\nInstalling 'dacoso.connection_reports:1.0.1' to '/Users/frankbartnitzek/.ansible/collections/ansible_collections/dacoso/connection_reports'\r\ndacoso.connection_reports:1.0.1 was installed successfully\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible-galaxy install -r requirements.yml -vvvv\r\nansible-galaxy [core 2.17.2]\r\n  config file = /Users/frankbartnitzek/tmp/ansible-issue/ansible.cfg\r\n  configured module search path = ['/Users/frankbartnitzek/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/frankbartnitzek/tmp/ansible-issue/.venv/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/frankbartnitzek/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/frankbartnitzek/tmp/ansible-issue/.venv/bin/ansible-galaxy\r\n  python version = 3.12.3 (main, Apr 12 2024, 17:16:04) [Clang 15.0.0 (clang-1500.1.0.2.5)] (/Users/frankbartnitzek/tmp/ansible-issue/.venv/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\nUsing /Users/frankbartnitzek/tmp/ansible-issue/ansible.cfg as config file\r\nReading requirement file at '/Users/frankbartnitzek/tmp/ansible-issue/requirements.yml'\r\nCollection requirement 'dacoso.connection_reports' is a URL to a tar artifact\r\nDownloading https://MY_HOST/MY_PATH/connection_reports/dacoso-connection_reports-1.0.1.tar.gz to /Users/frankbartnitzek/.ansible/tmp/ansible-local-605343zbi_7bo/tmpzlphvfjz/dacoso-connection_reports-1.0.1-w_do_yrj\r\nERROR! Failed to download collection tar from 'https://MY_HOST/MY_PATH/connection_reports/dacoso-connection_reports-1.0.1.tar.gz': HTTP Error 401: . HTTP Error 401:\r\n\r\n# statuscode 401 hides the existence of non-authorized resources\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-17T11:42:15Z",
        "user": "fbartnitzek",
        "labels": [
            "waiting_on_contributor",
            "feature",
            "affects_2.17"
        ]
    },
    {
        "number": 83622,
        "title": "ansible_fail_result is undefined",
        "body": "### Summary\r\n\r\nWhen in playbook include non existed role, the execution enter into rescue mode but ansible_fail_result is undefined.\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-core\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.17.1]\r\n  config file = None\r\n  configured module search path = ['~/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/Cellar/ansible/10.1.0/libexec/lib/python3.12/site-packages/ansible\r\n  ansible collection location = ~/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] (/opt/homebrew/Cellar/ansible/10.1.0/libexec/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nmac OS, FEDORA 38, amzn2, amzn2023, etc...\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml \r\n\r\n- name: empty ansible_fail_result\r\n  hosts: all\r\n      \r\n  tasks:\r\n  - block:\r\n  \r\n    - include_role:\r\n        name: unexist_role\r\n\r\n    - debug:\r\n        msg: complete successfuly\r\n      \r\n    rescue:\r\n      - debug:\r\n          msg: \"complete with error. ansible_failed_result is {{  'defined' if ansible_failed_result is defined else 'undefined' }}\" \r\n```\r\n\r\n### Expected Results\r\n\r\nansible_failed_result defined and ansible_failed_result.msg contain error information\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook --connection=local --inventory 127.0.0.1, --limit 127.0.0.1 bug.yml\r\n\r\nPLAY [empty ansible_fail_result] ***************************************************************************************\r\n\r\nTASK [Gathering Facts] *************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [include_role : unexist_role] *************************************************************************************\r\nERROR! the role 'unexist_role' was not found in [path]\r\n\r\nThe error appears to be in '[absolute path]/bug.yml': line 8, column 15, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n    - include_role:\r\n        name: unexist_role\r\n              ^ here\r\nfatal: [127.0.0.1]: FAILED! => {\"changed\": false, \"reason\": \"the role 'unexist_role' was not found in [absolute path]\\n\\nThe error appears to be in '[absolute path]/bug.yml': line 8, column 15, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n    - include_role:\\n        name: unexist_role\\n              ^ here\\n\"}\r\n\r\nTASK [debug] ***********************************************************************************************************\r\nok: [127.0.0.1] => {\r\n    \"msg\": \"complete with error. ansible_failed_result is undefined\"\r\n}\r\n\r\nPLAY RECAP *************************************************************************************************************\r\n127.0.0.1                  : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n\r\n\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-17T07:05:20Z",
        "user": "alex-inqwise",
        "labels": [
            "bug",
            "affects_2.17"
        ]
    },
    {
        "number": 83618,
        "title": "FileNotFoundError when executing chmod on directory",
        "body": "### Summary\n\nWhen I run a task like this\r\n```\r\n- name: ensure permissions\r\n  ansible.builtin.file:\r\n    dest: /app/var/run\r\n    owner: appUser\r\n    group: appGroup\r\n    recurse: true\r\n```\r\nsometimes a FileNotFoundError occurs. This happens, because a temporary file has removed during execution of the task.\r\n\r\nThe complete trace of this error:\r\n```\r\n        Traceback (most recent call last):\r\n          File \"<stdin>\", line 107, in <module>\r\n          File \"<stdin>\", line 99, in _ansiballz_main\r\n          File \"<stdin>\", line 47, in invoke_module\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n            return _run_module_code(code, init_globals, run_name, mod_spec)\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n            _run_code(code, mod_globals, init_globals,\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n            exec(code, run_globals)\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 987, in <module>\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 973, in main\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 683, in ensure_directory\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 353, in recursive_set_attributes\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1178, in set_fs_attributes_if_different\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_group_if_different\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 713, in user_and_group\r\n        FileNotFoundError: [Errno 2] No such file or directory: b'/splunk/splunk/var/run/splunk/dispatch/remote_abc__SplunkEnterpriseSecuritySuite__RMD57f02abc0263583b0_1721042819.2963_7D442330-4F31-416D-9A63-F9B9C4E68531/pipeline_sets'\r\n        \r\n```\r\n\r\nThis file disappeard during task execution:\r\n`/splunk/splunk/var/run/splunk/dispatch/remote_abc__SplunkEnterpriseSecuritySuite__RMD57f02abc0263583b0_1721042819.2963_7D442330-4F31-416D-9A63-F9B9C4E68531/pipeline_sets`\r\n\r\nI thinks this error should be captured, to avoid this problem.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.file\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.12]\r\n  config file = /home/sf9enzx/OPS_SPLUNK_SUPPORT_ANSIBLE/ansible.cfg\r\n  configured module search path = ['/home/sf9enzx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/sf9enzx/venv/lib64/python3.9/site-packages/ansible\r\n  ansible collection location = /home/sf9enzx/OPS_SPLUNK_SUPPORT_ANSIBLE/collections\r\n  executable location = /home/sf9enzx/venv/bin/ansible\r\n  python version = 3.9.18 (main, May 16 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/home/sf9enzx/venv/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nRHEL 9\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: ensure permissions\r\n  ansible.builtin.file:\r\n    dest: /app/var/run\r\n    owner: appUser\r\n    group: appGroup\r\n    recurse: true\r\n```\r\nIt's a bit difficult, because during the task run files need to disappear. \n\n### Expected Results\n\nI'ld expect, that the file module gives an exit code, when this error appears.\n\n### Actual Results\n\n```console\nTraceback (most recent call last):\r\n          File \"<stdin>\", line 107, in <module>\r\n          File \"<stdin>\", line 99, in _ansiballz_main\r\n          File \"<stdin>\", line 47, in invoke_module\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n            return _run_module_code(code, init_globals, run_name, mod_spec)\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n            _run_code(code, mod_globals, init_globals,\r\n          File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n            exec(code, run_globals)\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 987, in <module>\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 973, in main\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 683, in ensure_directory\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 353, in recursive_set_attributes\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1178, in set_fs_attributes_if_different\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_group_if_different\r\n          File \"/tmp/ansible_ansible.builtin.file_payload_uqmvaw41/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 713, in user_and_group\r\n        FileNotFoundError: [Errno 2] No such file or directory: b'/splunk/splunk/var/run/splunk/dispatch/remote_abc__SplunkEnterpriseSecuritySuite__RMD57f02abc0263583b0_1721042819.2963_7D442330-4F31-416D-9A63-F9B9C4E68531/pipeline_sets'\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-16T10:26:38Z",
        "user": "staehler",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 83604,
        "title": "group module with local=true can be very slow when machine is joined to an LDAP domain",
        "body": "### Summary\n\nWe have several ansible roles which have a task to add a group, something like this:\r\n```\r\n- name: create group\r\n  group: name=jenkins gid=162 system=true local=true\r\n```\r\nOur machines are joined to an LDAP domain but we specifically want to create *local* users in these roles. These tasks are very slow to run in our environment - even when the group already exists or in `--check` mode. I have tracked it down to this code in `https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/group.py`:\r\n```\r\n    def _local_check_gid_exists(self):\r\n        if self.gid:\r\n            for gr in grp.getgrall():\r\n                if self.gid == gr.gr_gid and self.name != gr.gr_name:\r\n                    self.module.fail_json(msg=\"GID '{0}' already exists with group '{1}'\".format(self.gid, gr.gr_name))\r\n```\r\nOn our machines it takes a couple of minutes to enumerate all groups on a good day\r\n```\r\n$ /usr/bin/time python3 -c 'import grp; print(len(grp.getgrall()))'\r\n12740\r\n0.06user 0.04system 2:02.21elapsed 0%CPU (0avgtext+0avgdata 22180maxresident)k\r\n0inputs+0outputs (0major+4107minor)pagefaults 0swaps\r\n```\r\nMaybe this is because we have over 12000 groups, or maybe our LDAP servers are just slow. Both of those things are out of my control.\r\n\r\nIt seems weird that the group module enumerates all groups in order to find one with a specific gid, as there is an API to do exactly that `getgrgid`. Replacing the existing implementation of `_local_check_gid_exists` with:\r\n```\r\ndef _local_check_gid_exists(self):\r\n    if self.gid:\r\n        try:\r\n            gr = grp.getgrgid(self.gid)\r\n        except KeyError:\r\n            gr = None\r\n        if gr is not None:\r\n            if self.gid == gr.gr_gid and self.name != gr.gr_name:\r\n                self.module.fail_json(msg=\"GID '{0}' already exists with group '{1}'\".format(self.gid, gr.gr_name))\r\n```\r\nExecutes quickly and should be equivalent. Is there any reason not to use this instead?\r\n\r\nI looked at the history of this code; it was added in https://github.com/ansible/ansible/commit/4898b0a4a298448677c2aee2a03157ba5b662759\r\nthen fixed in\r\nhttps://github.com/ansible/ansible/commit/f94772f807fed7fd6329faae25aa600dd9f030cf\r\notherwise unchanged since 2019 as far as I can see.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngroup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.4]\r\n  config file = $HOME/code/ansible/ansible.cfg\r\n  configured module search path = ['$HOME/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = $HOME/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Mar 22 2024, 16:50:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS($HOME/code/ansible/ansible.cfg) = True\r\nCONFIG_FILE() = $HOME/code/ansible/ansible.cfg\r\nDEFAULT_FORKS($HOME/code/ansible/ansible.cfg) = 30\r\nDEFAULT_GATHERING($HOME/code/ansible/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(env: ANSIBLE_INVENTORY) = ['$HOME/code/ansible/hosts.yml']\r\nDEFAULT_TIMEOUT($HOME/code/ansible/ansible.cfg) = 60\r\nDEFAULT_VAULT_PASSWORD_FILE($HOME/code/ansible/ansible.cfg) = <omitted>\r\nEDITOR(env: EDITOR) = nvim\r\nINTERPRETER_PYTHON($HOME/code/ansible/ansible.cfg) = auto\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nssh_args($HOME/code/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=600s -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null\r\ntimeout($HOME/code/ansible/ansible.cfg) = 60\r\n\r\nssh:\r\n___\r\npipelining($HOME/code/ansible/ansible.cfg) = True\r\nssh_args($HOME/code/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=600s -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null\r\ntimeout($HOME/code/ansible/ansible.cfg) = 60\r\n\r\nSHELL:\r\n=====\r\n\r\nsh:\r\n__\r\nremote_tmp($HOME/code/ansible/ansible.cfg) = /tmp/ansible-$USER\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.4 LTS\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: create group\r\n  group: name=jenkins gid=162 system=true local=true\r\n```\r\n\n\n### Expected Results\n\nShould execute in reasonable time\n\n### Actual Results\n\n```console\nIs very slow when joined to an LDAP domain with many groups/slow response time.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-15T14:57:36Z",
        "user": "tspurden-broadcom",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 83590,
        "title": "Unexpected behaviour when applying `copy` to vaulted variable",
        "body": "### Summary\r\n\r\nWhen I use the `ansible.builtin.copy` module with an encrypted value, the value is inconsistently decrypted depending on various circumstances.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.copy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.4]\r\n  config file = REDACTED/ansible/ansible.cfg\r\n  configured module search path = ['REDACTED/ansible/modules']\r\n  ansible python module location = /nix/store/18bjvmjpn468ql6g7ji75cgkqghxnpvx-python3.11-ansible-core-2.16.4/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/bert/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /nix/store/18bjvmjpn468ql6g7ji75cgkqghxnpvx-python3.11-ansible-core-2.16.4/bin/ansible\r\n  python version = 3.11.8 (main, Feb  6 2024, 21:21:21) [GCC 13.2.0] (/nix/store/gd3shnza1i50zn8zs04fa729ribr88m9-python3-3.11.8/bin/python3.11)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/bert/Documents/ansible-repro/ansible.cfg) = /home/bert/Documents/ansible-repro/vault-pass\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nconfig:\r\n______\r\n_terms(None) = None\r\n\r\ndict:\r\n____\r\n_terms(None) = None\r\n\r\nenv:\r\n___\r\n_terms(None) = None\r\n\r\nfile:\r\n____\r\n_terms(None) = None\r\n\r\nfileglob:\r\n________\r\n_terms(None) = None\r\n\r\nindexed_items:\r\n_____________\r\n_terms(None) = None\r\n\r\nini:\r\n___\r\n_terms(None) = N\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu/NixOS\r\n\r\n### Steps to Reproduce\r\n\r\nApply the following playbook:\r\n\r\n```yaml (paste below)\r\n---\r\n- hosts: localhost\r\n  vars:\r\n    my_value:\r\n      my_secret: !vault |\r\n              $ANSIBLE_VAULT;1.1;AES256\r\n              30343733626635623263373433643933613832373939623833653566313962383039393062306161\r\n              6638346238643631656162383063333732616165633866610a616537383865316464383834663035\r\n              36333732346635636634393732376239343030623363326635323837303933613434333233303965\r\n              3339646331353436630a376533313837323162383462336536326466663338386562386565383037\r\n              3163\r\n\r\n\r\n    my_wrapper:\r\n      secrets: \"{{ my_value }}\"\r\n  tasks:\r\n    - ansible.builtin.copy:\r\n        dest: \"/tmp/secret.yml\"\r\n        content: \"{{ my_value | to_nice_yaml }}\"\r\n\r\n    - ansible.builtin.copy:\r\n        dest: \"/tmp/visible.yml\"\r\n        content: \"{{ my_wrapper | to_nice_yaml }}\"\r\n```\r\n\r\nThe vault password is `password`.\r\n\r\n### Expected Results\r\n\r\nI expect the secret word to be decrypted in both of the files created in `/tmp`, but is decrypted only in one of them.\r\n\r\n### Actual Results\r\n\r\nIn `/tmp/secret.yml`:\r\n\r\n```yaml\r\nmy_secret: !vault |\r\n    $ANSIBLE_VAULT;1.1;AES256\r\n    30343733626635623263373433643933613832373939623833653566313962383039393062306161\r\n    6638346238643631656162383063333732616165633866610a616537383865316464383834663035\r\n    36333732346635636634393732376239343030623363326635323837303933613434333233303965\r\n    3339646331353436630a376533313837323162383462336536326466663338386562386565383037\r\n    3163\r\n```\r\n\r\nWhile in `/tmp/visible.yml`:\r\n\r\n```yaml\r\nsecrets:\r\n    my_secret: test\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-12T15:03:39Z",
        "user": "bertptrs",
        "labels": [
            "module",
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 83582,
        "title": "Junit Callback prefix with include_role",
        "body": "### Summary\n\nHi!\r\nI am using the Junit callback plugin with a prefix to generate a junit XML file.\r\nI wanted to use this process on some tasks from a role but when you include a role from a absolute path, the path is added as a prefix to the task name.\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\njunit callback plugin\n\n### Additional Information\n\nAn example with the prefix `_test_` and a role with a task named \"_test_ hello from my favorite role\"\r\n```\r\n    - name: Include my favorite role\r\n      include_role:\r\n        name:  \"/path/to/mt/favorite/role\"\r\n```\r\n> [TASK /path/to/mt/favorite/role _test_  hello from my favorite role]\r\nThe Junit callback plugin does not take into account this task in the JUNIT report because there is the path of the role before the prefix. \n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-11T13:56:51Z",
        "user": "capolrik",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 83576,
        "title": "Ansible uses SHA-1 for checksums",
        "body": "### Summary\r\n\r\nAnsible uses SHA-1 for verifying file integrity in a variety of places and it's the only option for the `copy` command.  SHA-1 is known to be insecure and has had collisions demonstrated, and as a result, Ansible does not update data when it should and doesn't provide suitable integrity mechanisms for things like `copy`.\r\n\r\nSHA-256 and other secure hashes have been available in Python and in OpenSSL for well beyond the life of the standard enterprise Linux distribution, and thus there should be no compatibility concerns with picking one of those for data integrity.  Thus, `copy` should allow the user to specify a secure hash of the user's choice, and should default to using a secure option if nothing is specified.\r\n\r\nThere may be other situations in which SHA-1 is the default or only option, which should also be addressed.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncopy\r\n\r\n### Ansible Version\r\n```\r\nansible [core 2.17.1]\r\n  config file = None\r\n  configured module search path = ['/home/bmc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/bmc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.4 (main, Jun 12 2024, 19:06:53) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n### Configuration\r\n```\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = nvim-gtk --no-fork --\r\nPAGER(env: PAGER) = less -R\r\n```\r\n\r\n### OS / Environment\r\n\r\nDebian sid (unstable) amd64\r\n\r\nThe Ansible version is from Debian.\r\n\r\n### Steps to Reproduce\r\n\r\nfoo.yaml:\r\n```yaml (paste below)\r\n---\r\n- name: Test Ansible\r\n  hosts: all\r\n  gather_facts: true\r\n  vars:\r\n  tasks:\r\n    - name: Copy file\r\n      copy:\r\n        src: file\r\n        dest: /tmp/file\r\n        force: true\r\n```\r\n\r\ntest.sh\r\n```sh\r\n#!/bin/sh\r\n\r\nmkdir ansible-test\r\ncp foo.yaml ansible-test\r\ncd ansible-test\r\n\r\ncurl -LO https://shattered.io/static/shattered-1.pdf\r\ncurl -LO https://shattered.io/static/shattered-2.pdf\r\n\r\nsha256sum shattered*.pdf\r\n\r\ncp shattered-1.pdf file\r\nansible-playbook -v --connection=local -i localhost, foo.yaml\r\n\r\nsha256sum /tmp/file | tee first\r\n\r\ncp shattered-2.pdf file\r\nansible-playbook -v --connection=local -i localhost, foo.yaml\r\n\r\nsha256sum /tmp/file | tee second\r\n\r\nif diff -u first second\r\nthen\r\n    echo \"File is not updated!\" >&2\r\n    exit 1\r\nfi\r\nexit 0\r\n```\r\n\r\n1. Download both files to the same directory\r\n2. `chmod 700 test.sh`\r\n3. `./test.sh`\r\n4. Notice that the file is not updated on the remote side and continues to have the old SHA-256 hash.\r\n\r\nFor clarity, the two PDFs in question are specifically engineered to demonstrate a SHA-1 collision and have the same SHA-1 hash, but they differ in contents and have different hashes when using a secure cryptographic hash like SHA-256 or BLAKE2b.\r\n\r\n### Expected Results\r\n\r\nI expected that the file would be updated because I assumed that Ansible would use a secure cryptographic hash, especially given the Python documentation which mentions the weaknesses of SHA-1, and was shocked that it did not.  It also expected it to allow me to provide a checksum using a secure cryptographic hash of my choice, like in `get_url`, and the documentation states that it does not do so.\r\n\r\n### Actual Results\r\n```\r\n./test.sh\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  412k  100  412k    0     0  1571k      0 --:--:-- --:--:-- --:--:-- 1574k\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  412k  100  412k    0     0  1645k      0 --:--:-- --:--:-- --:--:-- 1650k\r\n2bb787a73e37352f92383abe7e2902936d1059ad9f1ba6daaa9c1e58ee6970d0  shattered-1.pdf\r\nd4488775d29bdef7993367d541064dbdda50d383f89f0aa13a6ff2e0894ba5ff  shattered-2.pdf\r\nNo config file found; using defaults\r\n\r\nPLAY [Test Ansible] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************************************************************************************\r\n[WARNING]: Platform linux on host localhost is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See\r\nhttps://docs.ansible.com/ansible-core/2.17/reference_appendices/interpreter_discovery.html for more information.\r\nok: [localhost]\r\n\r\nTASK [Copy file] ****************************************************************************************************************************************************************************************************\r\nok: [localhost] => {\"changed\": false, \"dest\": \"/tmp/file\", \"src\": \"/tmp/user/1000/ansible-test/file\"}\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n2bb787a73e37352f92383abe7e2902936d1059ad9f1ba6daaa9c1e58ee6970d0  /tmp/file\r\nNo config file found; using defaults\r\n\r\nPLAY [Test Ansible] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************************************************************************************\r\n[WARNING]: Platform linux on host localhost is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See\r\nhttps://docs.ansible.com/ansible-core/2.17/reference_appendices/interpreter_discovery.html for more information.\r\nok: [localhost]\r\n\r\nTASK [Copy file] ****************************************************************************************************************************************************************************************************\r\nok: [localhost] => {\"changed\": false, \"dest\": \"/tmp/file\", \"src\": \"/tmp/user/1000/ansible-test/file\"}\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n2bb787a73e37352f92383abe7e2902936d1059ad9f1ba6daaa9c1e58ee6970d0  /tmp/file\r\nFile is not updated!\r\n```\r\n### Code of Conduct\r\n\r\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-10T21:58:15Z",
        "user": "bk2204",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.17"
        ]
    },
    {
        "number": 83557,
        "title": "AdHoc host expression does not support templates",
        "body": "### Summary\n\n`ansible {{\"localhost\"}} -m ping` doesn't do what it should- core playbook host expressions support it, but adhoc does not.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nadhoc\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n< 2.18\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nN/A\n```\n\n\n### OS / Environment\n\nN/A\n\n### Steps to Reproduce\n\nSee description\n\n### Expected Results\n\nHosts are templated as in playbook.\n\n### Actual Results\n\n```console\nFail\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-09T15:18:57Z",
        "user": "nitzmahone",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 83537,
        "title": "`vars` doesn't accept a dictionary if it's dynamically generated",
        "body": "### Summary\n\nWhen trying to include a Role with dynamic variables:\r\n\r\n```yaml\r\n    # Use the `create-zfs-pool` role to create the root pool.\r\n    - name: \"Creating `rpool` ZFS pool for operating system.\"\r\n      ansible.builtin.include_role:\r\n        name: \"create-zfs-pool\"\r\n      vars: \"{{ { 'name': 'rpool' } | ansible.builtin.combine(hostvars[inventory_hostname].storage.root) }}\"\r\n```\r\n\r\nThe following error occurs:\r\n\r\n```\r\nERROR! Vars in a IncludeRole must be specified as a dictionary\r\n\r\n...\r\n\r\nThe offending line appears to be:\r\n\r\n        name: \"create-zfs-pool\"\r\n      vars: \"{{ { 'name': 'rpool' } | ansible.builtin.combine(hostvars[inventory_hostname].storage.root) }}\"\r\n            ^ here\r\n\r\n...\r\n```\r\n\r\nI have confirmed that the output of this jijna2 template is a `dict`:\r\n\r\n```yaml\r\n      - debug:\r\n        msg: \"{{ { 'name': 'rpool' } | ansible.builtin.combine(hostvars[inventory_hostname].storage.root) | type_debug }}\"\r\n```\r\n\r\nWith the following output:\r\n\r\n```\r\nTASK [provision-ubuntu : debug] ******************************************************************************************************************************\r\nok: [new-host.opc.lab.andrewvaughan.io] => \r\n  msg: dict\r\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-core\n\n### Ansible Version\n\n```console\n$ .venv/bin/ansible --version\r\n\r\nansible [core 2.17.1]\r\n  config file = /Users/andrew/Repositories/Personal/homelab/ansible.cfg\r\n  configured module search path = ['/Users/andrew/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/andrew/Repositories/Personal/homelab/.venv/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/andrew/Repositories/Personal/homelab\r\n  executable location = .venv/bin/ansible\r\n  python version = 3.12.4 (main, Jun  6 2024, 18:26:44) [Clang 15.0.0 (clang-1500.3.9.4)] (/Users/andrew/Repositories/Personal/homelab/.venv/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ .venv/bin/ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = True\r\nCOLLECTIONS_PATHS(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = ['/Users/andrew/Repositories/Personal/homelab']\r\nCONFIG_FILE() = /Users/andrew/Repositories/Personal/homelab/ansible.cfg\r\nDEFAULT_HOST_LIST(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = ['/Users/andrew/Repositories/Personal/homelab/hosts.yml']\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = True\r\nDEFAULT_ROLES_PATH(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = ['/Users/andrew/Repositories/Personal/homelab/roles']\r\nDEFAULT_STDOUT_CALLBACK(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = yaml\r\nDISPLAY_SKIPPED_HOSTS(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = /usr/bin/python3\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\ndisplay_failed_stderr(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = True\r\ndisplay_ok_hosts(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = True\r\ndisplay_skipped_hosts(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = False\r\nshow_task_path_on_failure(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = True\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\ncontrol_path(/Users/andrew/Repositories/Personal/homelab/ansible.cfg) = /tmp/%%h-%%r\n```\n\n\n### OS / Environment\n\nmacOS 14.1.2 (23B92)\n\n### Steps to Reproduce\n\n1. Create a task with a jinja2 template as the `vars` output, with a `dict` type.\n\n### Expected Results\n\nI expected the `vars` argument to accept the `dict` created from the formula.\n\n### Actual Results\n\n```console\nERROR! Vars in a IncludeRole must be specified as a dictionary.\r\n```\r\n\r\nAs described in the summary.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-07-05T17:07:42Z",
        "user": "andrewvaughan",
        "labels": [
            "bug",
            "affects_2.17",
            "data_tagging"
        ]
    },
    {
        "number": 83496,
        "title": "Gather more facts from `/etc/os-release` (`IMAGE_VERSION`, `IMAGE_ID`, `VARIANT_ID`, `ID_LIKE`)",
        "body": "### Summary\n\nI am trying to distinguish several hosts which have the same `VERSION_ID` but a different `IMAGE_VERSION`. Currently this is not gathered by setup but often quite useful. Similarly `IMAGE_ID` and `VARIANT_ID` can be used to differentiate machines which have otherwise the same base distribution (e.g. Ubuntu vs Ubuntu Server, but image_id mostly for more enterprise stuff where custom images are build). Finally, ID like can be used to figure out like which mainstream distro some niche behaves more like (e.g. Ubuntu has it set as Debian).\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nsetup\n\n### Additional Information\n\nThese variables [are all specified](https://www.freedesktop.org/software/systemd/man/256/os-release.html) and widely used by any distro from the last few years (except maybe a few exotic ones like Alpine).\r\n\r\n---\r\n\r\nIf there is agreement that this is desirable I would be happy to write a proposal and - if nudged in the right direction - could work on implementing this (though no guarantees on the timeframe)\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-26T23:16:58Z",
        "user": "septatrix",
        "labels": [
            "waiting_on_contributor",
            "module",
            "feature"
        ]
    },
    {
        "number": 83449,
        "title": "File descriptor leak in lib/ansible/plugins/connection/ssh.py",
        "body": "### Summary\n\n`reset()` in `ssh.py` calls `_build_command()`, which allocates a pipe when sshpass is used. `_bare_run()` frees this normally, but `reset()` calls `Popen()` directly, causing a file descriptor leak. \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nconnection/ssh.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.3]\r\n  config file = /root/.ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.2 (main, Mar 13 2023, 12:18:29) [GCC 12.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /root/.ansible.cfg\r\nHOST_KEY_CHECKING(/root/.ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/root/.ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/root/.ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nOriginally noticed on Devuan daedalus. Also present on Fedora 38.\n\n### Steps to Reproduce\n\nUse the following playbook:\r\n```yaml\r\n---\r\n- name: Test play\r\n  gather_facts: false\r\n  hosts: unreachable\r\n  tasks:\r\n    - name: Wait for connection \r\n      ansible.builtin.wait_for_connection:\r\n        timeout: 9000\r\n```\r\nwith this inventory (where 192.168.15.102 is replaced with any unreachable host):\r\n```yaml\r\nall:\r\n  hosts:\r\n    unreachable:\r\n      ansible_host: 192.168.15.102\r\n      ansible_user: root\r\n      ansible_password: password\r\n```\r\n\r\nWatch the output with -vvv.\r\n\n\n### Expected Results\n\nAnsible should fail to connect to the server, but continue trying.\n\n### Actual Results\n\n```console\nAfter about 500 seconds it ceases trying to connect. Checking `lsof` reveals 1000 file descriptors for Ansible, mostly pipes, hitting the default cap. Also, when Ansible is run with -vvv, the file descriptor referenced in -d{{fd}} keeps incrementing.\r\n\r\n<192.168.15.102> SSH: EXEC sshpass -d12 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/nick/.ansible/cp/0cfd1cec36\"' 192.168.15.102 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-14T20:14:08Z",
        "user": "nicksms",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 83436,
        "title": "systemd module silently fails to enable generated serviced unit",
        "body": "### Summary\n\nWhen trying to enable a systemd service for which the Unit file was [generated](https://www.freedesktop.org/software/systemd/man/latest/systemd.generator.html) and saved in the default output directory by systemd, Ansible silently fails to enable the service.\r\nThe systemd generators output files to `/run/systemd/generator` which isn't supported by systemd for enabling a service.\r\nHere a PostgreSQL container managed by Podman for which system generated a Unit file, when checking its state:\r\n```\r\n# systemctl status postgresql\r\n\u25cf postgresql.service - PostgreSQL Container - postgresql\r\n     Loaded: loaded (/etc/containers/systemd/postgresql.container; generated)\r\n     Active: active (running)\r\n# systemctl is-enabled postgresql\r\ngenerated\r\n# systemctl enable postgresql\r\nFailed to enable unit: Unit /run/systemd/generator/postgresql.service is transient or generated.\r\n```\r\n\r\nYet, when using the builtin systemd module in Ansible to enable the service, no error is reported by Ansible.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsystemd\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = None\r\n  configured module search path = ['/Users/xxx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/xxx/Library/Python/3.11/lib/python/site-packages/ansible\r\n  ansible collection location = /Users/xxx/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/xxx/Library/Python/3.11/bin/ansible\r\n  python version = 3.11.9 (main, Apr  4 2024, 13:30:03) [Clang 15.0.0 (clang-1500.3.9.4)] (/Users/xxx/macports/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nRHEL 9\n\n### Steps to Reproduce\n\nCreate a systemd service for Podman using the Quadlet format, [see](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/building_running_and_managing_containers/assembly_porting-containers-to-systemd-using-podman_building-running-and-managing-containers)\r\nSave it under `/run/systemd/generator` as expected by default for systemd generators. Systemd will then automatically look it up when reloaded\r\n```yaml\r\n- name: Start and enable containerized Service\r\n  ansible.builtin.systemd:\r\n    name: \"{{ service_name }}\"\r\n    enabled: true\r\n    state: started\r\n    daemon_reload: true\r\n```\r\n\r\nAnsible will be able to start the service but not enable it, yet no error will be reported.\n\n### Expected Results\n\nAnsible should fail just like `systemctl` does when attempting the same manually on the target host.\n\n### Actual Results\n\n```console\nAnsible will report OK or CHANGED depending on the `state` value passed but failure to enable won't be reported.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-13T11:19:47Z",
        "user": "tux-o-matic",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.14",
            "affects_2.17"
        ]
    },
    {
        "number": 83435,
        "title": "`file`: incomplete/misleading/missing diff when recursively setting attributes",
        "body": "### Summary\r\n\r\nWhen recursively setting file attributes, I expect to see all changes in the diff, but there are none. When the directory's attributes are modified as well as the files within, the diff shows that only the directory has been modified, when in fact much more is being done.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nfile\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.17.0]\r\n...\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu Focal\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n- name: play\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: create directory with same perms\r\n      ansible.builtin.file:\r\n        path: /tmp/foo/bar\r\n        state: directory\r\n        mode: \"0755\"\r\n      diff: false\r\n\r\n    - name: create directory with different perms\r\n      ansible.builtin.file:\r\n        path: /tmp/fu/bar\r\n        state: directory\r\n        mode: \"0770\"\r\n      diff: false\r\n\r\n    - name: create file with different perms\r\n      ansible.builtin.file:\r\n        path: \"{{ item }}\"\r\n        state: touch\r\n        mode: \"0770\"\r\n      diff: false\r\n      loop:\r\n        - /tmp/foo/bar/file1\r\n        - /tmp/foo/bar/file2\r\n        - /tmp/fu/bar/file1\r\n        - /tmp/fu/bar/file2\r\n\r\n    - name: recursively modify permissions on directory with same perms\r\n      ansible.builtin.file:\r\n        path: /tmp/foo/bar\r\n        mode: \"0755\"\r\n        recurse: true\r\n      diff: true\r\n\r\n    - name: recursively modify permissions on directory with different perms\r\n      ansible.builtin.file:\r\n        path: /tmp/fu/bar\r\n        mode: \"0755\"\r\n        recurse: true\r\n      diff: true\r\n\r\n```\r\n\r\n### Expected Results\r\n\r\n```console\r\nPLAY [play] *******************************************************************************************************************************\r\n\r\nTASK [create directory with same perms] ***************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [create directory with different perms] **********************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [create file with different perms] ***************************************************************************************************\r\nchanged: [localhost] => (item=/tmp/foo/bar/file1)\r\nchanged: [localhost] => (item=/tmp/foo/bar/file2)\r\nchanged: [localhost] => (item=/tmp/fu/bar/file1)\r\nchanged: [localhost] => (item=/tmp/fu/bar/file2)\r\n\r\nTASK [recursively modify permissions on directory with same perms] ************************************************************************\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/foo/bar/file2\r\n\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/foo/bar/file1\r\n\r\nchanged: [localhost]\r\n\r\nTASK [recursively modify permissions on directory with different perms] *******************************************************************\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/fu/bar\r\n\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/fu/bar/file2\r\n\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/fu/bar/file1\r\n\r\nchanged: [localhost]\r\n\r\nPLAY RECAP ********************************************************************************************************************************\r\nlocalhost                  : ok=5    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [play] *******************************************************************************************************************************\r\n\r\nTASK [create directory with same perms] ***************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [create directory with different perms] **********************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [create file with different perms] ***************************************************************************************************\r\nchanged: [localhost] => (item=/tmp/foo/bar/file1)\r\nchanged: [localhost] => (item=/tmp/foo/bar/file2)\r\nchanged: [localhost] => (item=/tmp/fu/bar/file1)\r\nchanged: [localhost] => (item=/tmp/fu/bar/file2)\r\n\r\nTASK [recursively modify permissions on directory with same perms] ************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [recursively modify permissions on directory with different perms] *******************************************************************\r\n--- before\r\n+++ after\r\n@@ -1,2 +1,2 @@\r\n-mode: '0770'\r\n+mode: '0755'\r\n path: /tmp/fu/bar\r\n\r\nchanged: [localhost]\r\n\r\nPLAY RECAP ********************************************************************************************************************************\r\nlocalhost                  : ok=5    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-13T00:29:08Z",
        "user": "simonLeary42",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 83434,
        "title": "`file`: incomplete diff when creating parent directories",
        "body": "### Summary\r\n\r\nIf I create a directory and ansible automatically creates nonexistent parent directories, ansible should tell about all the directories it created, not just the deepest one.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nfile\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.17.0]\r\n...\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu Focal\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n- name: play\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: create directory\r\n      ansible.builtin.file:\r\n        path: /tmp/fu/bar\r\n        state: directory\r\n        mode: \"0770\"\r\n      diff: true\r\n\r\nchanged: [localhost]\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n```console\r\nTASK [create directory] ************************************************************************************************\r\n--- before\r\n+++ after\r\n-mode: '0775'\r\n+mode: '0770'\r\n path: /tmp/fu\r\n-state: absent\r\n+state: directory\r\n\r\n-mode: '0775'\r\n+mode: '0770'\r\n path: /tmp/fu/bar\r\n-state: absent\r\n+state: directory\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [create directory] *************************************************************************************************\r\n--- before\r\n+++ after\r\n@@ -1,3 +1,3 @@\r\n-mode: '0775'\r\n+mode: '0770'\r\n path: /tmp/fu/bar\r\n-state: absent\r\n+state: directory\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-13T00:22:52Z",
        "user": "simonLeary42",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 83421,
        "title": "if ansible.builtin.fileglob plugin is used in ansible.builtin.template, it searches under files/ ",
        "body": "### Summary\r\n\r\nIf `ansible.builtin.fileglob` plugin is used in `ansible.builtin.template` - whether it's via `loop+query()` or via `with_fileglob:`, it searches under `files/` instead of `templates/` when used inside a role.\r\n\r\nIt also requires at least `./` prepended to search at all.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.fileglob, ansible.builtin.template\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.17.0]\r\n  config file = /home/nozo/iliad/nussknacker-ansible/ansible.cfg\r\n  configured module search path = ['/home/nozo/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/nozo/iliad/nussknacker-ansible/ans/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/nozo/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/nozo/iliad/nussknacker-ansible/ans/bin/ansible\r\n  python version = 3.12.3 (main, Apr 23 2024, 09:16:07) [GCC 13.2.1 20240417] (/home/nozo/iliad/nussknacker-ansible/ans/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOWS(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = True\r\nCONFIG_FILE() = /home/nozo/iliad/nussknacker-ansible/ansible.cfg\r\nDEFAULT_PRIVATE_ROLE_VARS(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = True\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = /home/nozo/iliad/nussknacker-ansible/.vault_password\r\nDISPLAY_SKIPPED_HOSTS(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = True\r\nEDITOR(env: EDITOR) = vim\r\nHOST_KEY_CHECKING(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = False\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\ndisplay_skipped_hosts(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = True\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = False\r\nssh_args(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=3600s -o ServerAliveInterval=60\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = False\r\npipelining(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = True\r\nssh_args(/home/nozo/iliad/nussknacker-ansible/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=3600s -o ServerAliveInterval=60\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nArchlinux\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n- name: Prepare .bashrc.d files\r\n  ansible.builtin.template:\r\n    src: \"{{ item }}\"\r\n    dest: \"/home/{{ nu_user }}/.bashrc.d/\"\r\n    owner: \"{{ nu_user }}\"\r\n    group: \"{{ nu_group }}\"\r\n    mode: '0644'\r\n  loop: \"{{ query('ansible.builtin.fileglob', './[0-9][0-9]-bashrc*.sh') }}\"\r\n```\r\n\r\n\r\n\r\n### Expected Results\r\n\r\n`Fileglob plugin` while called in context of `template` should search under templates. Prepending `./` to the glob probably shouldn't be necessary either.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [common : Prepare .bashrc.d files] ***********************************************************************************************************************************************\r\ntask path: /home/nozo/iliad/nussknacker-ansible/roles/common/tasks/main.yml:35\r\nlooking for \".\" at \"/home/nozo/iliad/nussknacker-ansible/roles/common/files/.\"\r\nlooking for \".\" at \"/home/nozo/iliad/nussknacker-ansible/roles/common/.\"\r\nskipping: [nuans5] => {\r\n    \"changed\": false,\r\n    \"skipped_reason\": \"No items in the list\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-11T11:15:07Z",
        "user": "msoltyspl",
        "labels": [
            "module",
            "bug",
            "affects_2.17",
            "data_tagging"
        ]
    },
    {
        "number": 83402,
        "title": "Avoid doing ssh connection if _remote_expand_user already failed",
        "body": "### Summary\r\n\r\nWhen I try to I execute a module without pipelining ansible try to guess where to put the module.\r\n\r\nThe relevant lines:\r\nhttps://github.com/ansible/ansible/blob/2e60bef85587f88d1d851afea30e656f0253580f/lib/ansible/plugins/action/__init__.py#L469\r\nhttps://github.com/ansible/ansible/blob/2e60bef85587f88d1d851afea30e656f0253580f/lib/ansible/plugins/action/__init__.py#L905-L916\r\n\r\nIf first connect and try to display `~` and if it fail (rc=5) it retry with `pwd`? If it fail (rc=5) the default value `~/.ansible/tmp` is used.\r\n\r\nHere it use the path found but obiously fail again with (rc=5)\r\nhttps://github.com/ansible/ansible/blob/2e60bef85587f88d1d851afea30e656f0253580f/lib/ansible/plugins/action/__init__.py#L476-L499\r\nand display finally a unreachable message.\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nssh\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.5]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = nano\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nNon-relevant\r\n\r\n### Steps to Reproduce\r\n\r\n1. my_ssh_wrapper:\r\n```\r\n#!/bin/sh\r\n# Simulate auth failure because openssh seems to only return 255 even on\r\n# (255, b'', b'root@localhost: Permission denied (publickey,password).\\r\\n')\r\nexit 5\r\n```\r\n2. `chmod u+x ./my_ssh_wrapper`\r\n3. Any ansible command ad-hoc or module.\r\n`ansible -e ansible_ssh_executable=./my_ssh_wrapper -e ansible_pipelining=False -vvv -i localhost, -m ping `\r\n\r\n### Expected Results\r\n\r\n`Authentication failure.` should be displayed on first failure of ssh with exit code 5 or not at all.\r\n255 is handled in other spot:\r\nhttps://github.com/ansible/ansible/blob/2e60bef85587f88d1d851afea30e656f0253580f/lib/ansible/plugins/connection/ssh.py#L454\r\nSo maybe 5 is for winrm or another connection mode and should be moved to the appropriate connection module.\r\n\r\n### Actual Results\r\n\r\n```console\r\nFails 3 times and the display the message.\r\n```\r\n\r\n\r\n### Workaround\r\nuse 255 in my wrapper instead of 5 because it has the desired behavior.\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-09T01:44:46Z",
        "user": "Et7f3",
        "labels": [
            "bug",
            "affects_2.16"
        ]
    },
    {
        "number": 83394,
        "title": "rpm_key module does nothing if it finds a partial match of already installed keys",
        "body": "### Summary\r\n\r\nI want to install a GPG key file that contains multiple keys. If Ansible finds that one of the keys in the file is already installed, it quits successfully instead of continuing to install the other key(s). \r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nrpm_key\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.6]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/fedora/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/fedora/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.2 (main, Feb 21 2024, 00:00:00) [GCC 14.0.1 20240217 (Red Hat 14.0.1-0)] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n\r\n$ rpm -qa | grep ansible\r\nansible-core-2.16.6-1.fc40.noarch\r\nansible-9.5.1-1.fc40.noarch\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = /usr/bin/nano\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 40\r\n\r\n### Steps to Reproduce\r\n\r\n1. Start an Almalinux 8.8 VM , it has this [issue](https://almalinux.org/blog/2023-12-20-almalinux-8-key-update/) so I need to install the newer GPG key `https://repo.almalinux.org/almalinux/RPM-GPG-KEY-AlmaLinux` as a workaround.\r\n1. Try to update the key:\r\n```\r\n$ cat hosts \r\n[nodes]\r\nalma8\tansible_user=almalinux\tansible_host=10.1.2.3\r\n$ ansible -b -i hosts -m ansible.builtin.rpm_key -a \"state=present key=https://repo.almalinux.org/almalinux/RPM-GPG-KEY-AlmaLinux\"  nodes \r\nalma8 | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\r\n    },\r\n    \"changed\": false\r\n}\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nAnsible should report a change because it should install ALL of the keys in https://repo.almalinux.org/almalinux/RPM-GPG-KEY-AlmaLinux .  On the node, this should be confirmed by `rpm -q gpg-pubkey-ced7258b-6525146f` showing the installed key.\r\n\r\n\r\n### Actual Results\r\nAnsible reported success and took no action because it thought the key was already installed.\r\nBut on the node, the key was NOT installed.\r\n\r\nThis shows the keys that are expected in the new key file:\r\n```\r\n$ curl -s https://repo.almalinux.org/almalinux/RPM-GPG-KEY-AlmaLinux -o newkey\r\n$ gpg newkey \r\ngpg: WARNING: no command supplied.  Trying to guess what you mean ...\r\npub   rsa4096 2021-01-12 [C] [expired: 2024-01-12]\r\n      5E9B8F5617B5066CE92057C3488FCF7C3ABB34F8 ## NOTE this is gpg-pubkey-3abb34f8-5ffd890e\r\nuid           AlmaLinux <packager@almalinux.org>\r\nsub   rsa3072 2021-01-12 [S] [expired: 2024-01-12]\r\npub   rsa4096 2023-10-10 [SC]\r\n      BC5EDDCADF502C077F1582882AE81E8ACED7258B ## NOTE this is gpg-pubkey-ced7258b-6525146f\r\nuid           AlmaLinux OS 8 <packager@almalinux.org>\r\n```\r\nAfter the Ansible command ran, the result on the node is only the old key (3ABB34F8) is present because it was originally there, and the new key gpg-pubkey-ced7258b-6525146f is missing:\r\n```\r\n$ rpm -qa|grep gpg-pubkey\r\ngpg-pubkey-3abb34f8-5ffd890e\r\n```\r\n\r\n\r\n### Code of Conduct\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-06T19:02:21Z",
        "user": "rptaylor",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 83367,
        "title": "git module can \"lose\" local commits",
        "body": "### Summary\r\n\r\nansible.builtin.git (with default force: false and update: true) carefully doesn't clobber uncommitted local modifications in the destination directory, but it does run `cmd = \"%s reset --hard %s/%s\" % (git_path, remote, version)` which can result in losing track of local **commits** not yet pushed to origin.\r\n\r\nNote: my environment happens to be 2.13.3, but I can still see the problem in https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/git.py#L1044\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ngit\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/dmrz/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/dmrz/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/dmrz/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/dmrz/.local/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 22.04.4 LTS\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\ntest-git.yml:\r\n```yaml\r\n- hosts: localhost\r\n  tasks:\r\n  - git:\r\n      dest: mygitdir\r\n      repo: https://github.com/ansible/ansible.git\r\n      version: devel\r\n```\r\n1. Initial run\r\n```\r\ndmrz@golbez:~$ ansible-playbook test-git.yml \r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [localhost] ***********************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *****************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [git] *****************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP *****************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n2. Make a new git commit\r\n```\r\ndmrz@golbez:~$ echo \"DUMMY CHANGE\" >> mygitdir/README.md; git -C mygitdir commit -m \"DUMMY CHANGE\" README.md\r\n[devel a1c34a79cd] DUMMY CHANGE\r\n 1 file changed, 1 insertion(+)\r\n\r\ndmrz@golbez:~$ git -C mygitdir log -2\r\ncommit a1c34a79cd43d49dcb8689951be08ea82c24e604 (HEAD -> devel)\r\nAuthor: David Zych <dmrz@REDACTED>\r\nDate:   Tue Jun 4 11:43:29 2024 -0500\r\n\r\n    DUMMY CHANGE\r\n\r\ncommit c77ed376c4f2df1ce619690ddf1fd02b33d328aa (origin/devel, origin/HEAD)\r\nAuthor: Brian Coca <bcoca@users.noreply.github.com>\r\nDate:   Tue Jun 4 11:42:15 2024 -0400\r\n\r\n    timeout give extra info (#83206)\r\n    \r\n    the new field shows the python code in execution when it timed out, 99% of the time it will be on a selector waiting for output from ssh to remote.\r\n```\r\n3. Rerun the playbook\r\n```\r\ndmrz@golbez:~$ ansible-playbook test-git.yml\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [localhost] ***********************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *****************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [git] *****************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP *****************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n4. Observe that branch `devel` has been reset to match `origin/devel` and our commit a1c34a79cd is gone!\r\n```\r\ndmrz@golbez:~$ git -C mygitdir log -2\r\ncommit c77ed376c4f2df1ce619690ddf1fd02b33d328aa (HEAD -> devel, origin/devel, origin/HEAD)\r\nAuthor: Brian Coca <bcoca@users.noreply.github.com>\r\nDate:   Tue Jun 4 11:42:15 2024 -0400\r\n\r\n    timeout give extra info (#83206)\r\n    \r\n    the new field shows the python code in execution when it timed out, 99% of the time it will be on a selector waiting for output from ssh to remote.\r\n\r\ncommit e07b4edc547e2a5bd429d1027c0102235616db6c\r\nAuthor: MajesticMagikarpKing <69774548+yctomwang@users.noreply.github.com>\r\nDate:   Mon Jun 3 23:51:32 2024 +1000\r\n\r\n    Fix Test failure with cowsay installed/present (#83347)\r\n```\r\n\r\nOkay, it's not _completely_ gone, I can find it again with `git reflog`, but only if I realize that something is amiss (which is not at all obvious).\r\n\r\n### Expected Results\r\n\r\nThe current behavior (make local branch head match remote no matter what) would be completely reasonable/expected if I had set `force: true`.\r\n\r\nIn the absence of `force: true`, I would expect `update: true` to update my local branch head (and working tree) with [\"new revisions from the origin repository\"](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html#parameter-update) only if it can do so **without endangering my work in the destination directory**.\r\n\r\nI think perhaps `git merge --ff-only origin/devel` would provide the right behavior here:\r\n- if I had no local commits, it would have the same result as status quo\r\n- if I have local commits but origin/devel has not advanced since then, it would succeed (\"Already up to date.\") **without** modifying my local branch head, i.e. no-op\r\n- if I have local commits and origin/devel _has_ advanced, it would fail with \"fatal: Not possible to fast-forward, aborting.\", resulting in an Ansible task failure (similar to the failure that occurs now if I have uncommitted local modifications)\r\n\r\n\r\n### Actual Results\r\n\r\nBranch `devel` has been reset to match `origin/devel` and our commit a1c34a79cd is gone (see Steps to Reproduce)\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-05T01:15:56Z",
        "user": "dmrzzz",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.13",
            "affects_2.15"
        ]
    },
    {
        "number": 83359,
        "title": "to_yaml / to_nice_yaml is not able to decrypt Vault password",
        "body": "### Summary\r\n\r\nFollow-up of https://github.com/ansible/ansible/issues/77771.\r\n\r\nJSON decoder `to_json` proposes a `vault_to_text`(default to `true`) parameter to be able to decrypt Vault password.\r\n\r\nThe YAML decoder `to_yaml` and `to_nice_yaml` does not have this parameter.\r\n\r\nCurrent workaround:\r\n\r\n`my_var_yaml: \"{{ my_var | to_json(vault_to_text=True) | from_json | to yaml }}\"`\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nto_yaml\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.7]\r\n  config file = /Users/myuser/Code/ansible/ansible.cfg\r\n  configured module search path = ['/Users/myuser/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/myuser/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.12.3 (main, Apr  9 2024, 08:09:14) [Clang 15.0.0 (clang-1500.3.9.4)] (/opt/homebrew/opt/python@3.12/bin/python3.12)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nmacOS 14\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  gather_facts: false\r\n  vars:\r\n    testvar: !vault |\r\n      $ANSIBLE_VAULT;1.1;AES256\r\n      REDACTED\r\n    testvar_json: \"{{ testvar | to_json }}\"\r\n    testvar_yaml: \"{{ testvar | to_nice_yaml }}\"\r\n  tasks:\r\n    - name: Print results\r\n      ansible.builtin.debug:\r\n        msg: \"JSON: {{ testvar_json }}, YAML: {{ testvar_yaml }}\"\r\n```\r\n\r\n### Expected Results\r\n\r\n```\r\nok: [localhost] => {\r\n    \"msg\": \"JSON: \\\"bugfix\\\", YAML: \\\"bugfix\\\"\"\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nok: [localhost] => {\r\n    \"msg\": \"JSON: \\\"bugfix\\\", YAML: !vault |\\n    $ANSIBLE_VAULT;1.1;AES256\\nREDACTEDn\"\r\n}\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-06-04T09:53:38Z",
        "user": "boutetnico",
        "labels": [
            "bug",
            "affects_2.16"
        ]
    },
    {
        "number": 83323,
        "title": "no_log does not honor variable interpretation.",
        "body": "### Summary\r\n\r\nUsing `no_log` is essential for removing sensitive material from logs during production execution, however, it can interfere with complex roles during development and debugging.\r\n\r\nUsing a role variable or even a role default allows for toggling `no_log` off in development and molecule testing environments. However:\r\n\r\n* The variable is never honored when used with `no_log`.\r\n* It seems that the presence of *any* value except static boolean values is interpreted as `no_log: true`.\r\n* There seems to be order of operations error interpreting values provided to `no_log`.\r\n\r\nAs the steering committee voted against the ability to [toggle individual variables appearing in `no_log` ](https://github.com/ansible/proposals/issues/109); this is a good middle path that doesn't change the how `no_log` works, just how *easy* it is to toggle on/off for development of roles (and removing errors from leaving it accidentially disabled).\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nno_log\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.7]\r\n  config file = None\r\n  configured module search path = ['/home/{REDACTED}/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/{REDACTED}/.config/venv/ansible/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/{REDACTED}/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/{REDACTED}/.config/venv/ansible/bin/ansible\r\n  python version = 3.12.3 (main, Apr 23 2024, 09:16:07) [GCC 13.2.1 20240417] (/home/{REDACTED}/.config/venv/ansible/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n(ansible)\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\n(ansible)\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n``` bash\r\n$ cat /etc/lsb-release \r\nDISTRIB_ID=\"ManjaroLinux\"\r\nDISTRIB_RELEASE=\"24.0.0\"\r\nDISTRIB_CODENAME=\"Wynsdey\"\r\nDISTRIB_DESCRIPTION=\"Manjaro Linux\"\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nroles/example/defaults/main.yml\r\n``` yaml\r\nsensitive_info:\r\n  - '{{ vault_example_user_password }}'\r\n```\r\n\r\nroles/example/vars/main.yml\r\n``` yaml\r\nexample_debug_false: false\r\nexample_debug_true: true\r\n```\r\n\r\nroles/example/tasks/main.yml\r\n``` yaml\r\n- name: 'Example debug values'\r\n  ansible.builtin.debug:\r\n    msg: |\r\n      example_debug_false: '{{ example_debug_false }}'\r\n      example_debug_true: '{{ example_debug_true }}'\r\n\r\n- name: 'Loop through sensitive user data (log should NOT appear)'\r\n  ansible.builtin.include_tasks: 'task.yml'\r\n  loop: '{{ sensitive_info | default([]) }}'\r\n  no_log: '{{ example_debug_true }}'  # passwords\r\n\r\n- name: 'Loop through sensitive user data (log should NOT appear)'\r\n  ansible.builtin.include_tasks: 'task.yml'\r\n  loop: '{{ sensitive_info | default([]) }}'\r\n  no_log: true  # passwords\r\n\r\n- name: 'Loop through sensitive user data (log *SHOULD* appear)'\r\n  ansible.builtin.include_tasks: 'task.yml'\r\n  loop: '{{ sensitive_info | default([]) }}'\r\n  no_log: '{{ example_debug_false }}'  # passwords\r\n\r\n- name: 'Loop through sensitive user data (log *SHOULD* appear)'\r\n  ansible.builtin.include_tasks: 'task.yml'\r\n  loop: '{{ sensitive_info | default([]) }}'\r\n  no_log: false  # passwords\r\n```\r\n\r\n\r\n### Expected Results\r\n```\r\nTASK [example : Value of example_debug'] *******************************************\r\nok: [molecule-test] => {\r\n    \"msg\": \"example_debug_false: 'False'\\nexample_debug_true: 'True'\"\r\n}\r\n\r\nTASK [example : Loop through sensitive user data (log should NOT appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=(censored due to no_log))\r\n\r\nTASK [example : Loop through sensitive user data (log should NOT appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=(censored due to no_log))\r\n\r\nTASK [example : Loop through sensitive user data (log *SHOULD* appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=my_super_secret_password)\r\n\r\nTASK [example : Loop through sensitive user data (log *SHOULD* appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=my_super_secret_password)\r\n```\r\n### Actual Results\r\n\r\n```console\r\nTASK [example : Value of example_debug'] *******************************************\r\nok: [molecule-test] => {\r\n    \"msg\": \"example_debug_false: 'False'\\nexample_debug_true: 'True'\"\r\n}\r\n\r\nTASK [example : Loop through sensitive user data (log should NOT appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=(censored due to no_log))\r\n\r\nTASK [example : Loop through sensitive user data (log should NOT appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=(censored due to no_log))\r\n\r\nTASK [example : Loop through sensitive user data (log *SHOULD* appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=(censored due to no_log))\r\n\r\nTASK [example : Loop through sensitive user data (log *SHOULD* appear)'] ********************************************\r\nincluded: /home/{REDACTED}/test_case/roles/example/tasks/main.yml for molecule-test => (item=my_super_secret_password)\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-29T20:05:08Z",
        "user": "r-pufky",
        "labels": [
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 83321,
        "title": "rpm_key does not work with ftp:// URLs",
        "body": "### Summary\n\nThe documentation for ansible.builtin.rpm_key states that the \"key\" parameter is \"Key that will be modified. Can be a url, a file on the managed node, or a keyid if the key already exists in the database.\" It does not specify that the URL must be an http/https. I have found that if I pass an ftp:// URL as the \"key\" parameter to rpm_key then the play will fail.\r\n\r\nLooking at the code in ansible/modules/rpm_key.py, the RPMKey.fetch_key function uses the fetch_url function from ansible.module_utils.urls to download an RPM key from a URL. The fetch_url command supports FTP URLs. However the test on line 155 of rpm_key.py checks the results of fetch_url for an info['status'] value of 200, categorizing any other return code as a failure. The corresponding return code from fetch_url for FTP is \"None\" on success and \"-1\" on various errors (at least \"server not found\" and \"file not found on server\" in my testing). In other words, FTP works but the test on line 155 categorizes all FTP-related return codes as a failure.\r\n\r\nMy suggested fixes for this issue are to either:\r\n1. Change the documentation of the rpm_key module to specify that URLs must be http/https only.\r\n2. Adjust the test on line 155 of rpm_key.py to accept FTP URLs, for example:\r\n`        if not ( ( url.startswith('http') and info['status'] == 200 ) or ( url.startswith('ftp:') and info['status'] == None ) ):`\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nrpm_key\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.5 (main, Oct 25 2023, 16:19:59) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (/usr/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOLOR(/etc/ansible/ansible.cfg) = False\r\nANSIBLE_NOCOWS(/etc/ansible/ansible.cfg) = True\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\r\nDEFAULT_MANAGED_STR(/etc/ansible/ansible.cfg) = Ansible managed: {file} modified on %Y-%m-%d %H:%M:%S by {uid} on {host}\r\nDEFAULT_PRIVATE_KEY_FILE(/etc/ansible/ansible.cfg) = /root/.ssh/id_ed25519\r\nDEFAULT_REMOTE_USER(/etc/ansible/ansible.cfg) = root\r\nDEFAULT_ROLES_PATH(/etc/ansible/ansible.cfg) = ['/etc/ansible/roles', '/usr/share/ansible/roles', '/usr/local/ansible/roles']\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 5\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nprivate_key_file(/etc/ansible/ansible.cfg) = /root/.ssh/id_ed25519\r\nremote_user(/etc/ansible/ansible.cfg) = root\r\nssh_args(/etc/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=30m -o AddressFamily=inet\r\ntimeout(/etc/ansible/ansible.cfg) = 5\r\n\r\nssh:\r\n___\r\npipelining(/etc/ansible/ansible.cfg) = True\r\nprivate_key_file(/etc/ansible/ansible.cfg) = /root/.ssh/id_ed25519\r\nremote_user(/etc/ansible/ansible.cfg) = root\r\nssh_args(/etc/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=30m -o AddressFamily=inet\r\ntimeout(/etc/ansible/ansible.cfg) = 5\n```\n\n\n### OS / Environment\n\nRocky Linux 8.9 x86_64.\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Install all repo GPG keys\r\n  ansible.builtin.rpm_key:\r\n    state: present\r\n    key: \"{{ item }}\"\r\n  with_items:\r\n    - 'ftp://10.24.76.199/cuda/repos/rhel8/x86_64/7fa2af80.pub'\r\n    - 'ftp://10.24.76.199/cuda/repos/rhel8/x86_64/D42D0685.pub'\r\n    ```\n\n### Expected Results\n\nTASK [feature/nvidia-binary-driver : Install all repo GPG keys] ***********************************************************************************************************************************************************************************\r\nok: [xxxxx.internal] => (item=ftp://10.24.76.199/cuda/repos/rhel8/x86_64/7fa2af80.pub)\r\nok: [xxxxx.internal] => (item=ftp://10.24.76.199/cuda/repos/rhel8/x86_64/D42D0685.pub)\n\n### Actual Results\n\n```console\nTASK [feature/nvidia-binary-driver : Install all repo GPG keys] ***********************************************************************************************************************************************************************************\r\nfailed: [xxxxx.internal] (item=ftp://10.24.76.199/cuda/repos/rhel8/x86_64/7fa2af80.pub) => {\"ansible_loop_var\": \"item\", \"changed\": false, \"item\": \"ftp://10.24.76.199/cuda/repos/rhel8/x86_64/7fa2af80.pub\", \"msg\": \"failed to fetch key at ftp://10.24.76.199/cuda/repos/rhel8/x86_64/7fa2af80.pub , error was: OK (1633 bytes)\"}\r\nfailed: [xxxxx.internal] (item=ftp://10.24.76.199/cuda/repos/rhel8/x86_64/D42D0685.pub) => {\"ansible_loop_var\": \"item\", \"changed\": false, \"item\": \"ftp://10.24.76.199/cuda/repos/rhel8/x86_64/D42D0685.pub\", \"msg\": \"failed to fetch key at ftp://10.24.76.199/cuda/repos/rhel8/x86_64/D42D0685.pub , error was: OK (1650 bytes)\"}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-29T17:56:30Z",
        "user": "melauer",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 83316,
        "title": "Blank line at start of stderr/stdout with script module and become with password",
        "body": "### Summary\r\n\r\nA \"script\" task when run with become and requiring a password yields a spurious blank line at the start of captured output. When using local connection, this is visible in stderr; when ssh, in stdout. The behaviour is the same with both sudo and su become methods.\r\n\r\nI cannot replicate the issue when not using become, when using become but no password is required for privilege escalation, or when using become with a password but using command or shell modules instead of script.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nscript\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.7]\r\n  config file = None\r\n  configured module search path = ['/home/xxx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/xxx/venv/lib64/python3.12/site-packages/ansible\r\n  ansible collection location = /home/xxx/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/xxx/venv/bin/ansible\r\n  python version = 3.12.1 (main, Feb 19 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/home/xxx/venv/bin/python3.12)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAlmaLinux release 9.4 (Seafoam Ocelot)\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - script:\r\n        cmd: id\r\n      register: result\r\n      connection: \"{{ item }}\"\r\n      loop:\r\n        - local\r\n        - ssh\r\n\r\n    - debug: var=result\r\n```\r\nwith files/id containing:\r\n```\r\n#!/bin/sh\r\nid\r\n```\r\n\r\nInvoked with (eg):\r\n```\r\nansible-playbook -i localhost, -b --become-method su -K test.yml \r\n```\r\n\r\n### Expected Results\r\n\r\nNo blank line at the start of output.\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible-playbook -i localhost, -b --become-method su -K test.yml\r\nBECOME password:\r\n\r\nPLAY [localhost] ***************************************************************\r\n\r\nTASK [script] ******************************************************************\r\nchanged: [localhost] => (item=local)\r\nchanged: [localhost] => (item=ssh)\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"result\": {\r\n        \"changed\": true,\r\n        \"msg\": \"All items completed\",\r\n        \"results\": [\r\n            {\r\n                \"ansible_loop_var\": \"item\",\r\n                \"changed\": true,\r\n                \"failed\": false,\r\n                \"item\": \"local\",\r\n                \"rc\": 0,\r\n                \"stderr\": \"\\n\",\r\n                \"stderr_lines\": [\r\n                    \"\"\r\n                ],\r\n                \"stdout\": \"uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\\n\",\r\n                \"stdout_lines\": [\r\n                    \"uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\"\r\n                ]\r\n            },\r\n            {\r\n                \"ansible_loop_var\": \"item\",\r\n                \"changed\": true,\r\n                \"failed\": false,\r\n                \"item\": \"ssh\",\r\n                \"rc\": 0,\r\n                \"stderr\": \"Shared connection to localhost closed.\\r\\n\",\r\n                \"stderr_lines\": [\r\n                    \"Shared connection to localhost closed.\"\r\n                ],\r\n                \"stdout\": \"\\r\\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\\r\\n\",\r\n                \"stdout_lines\": [\r\n                    \"\",\r\n                    \"uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\"\r\n                ]\r\n            }\r\n        ],\r\n        \"skipped\": false\r\n    }\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-29T10:40:57Z",
        "user": "ghadf",
        "labels": [
            "module",
            "bug",
            "affects_2.15",
            "affects_2.16"
        ]
    },
    {
        "number": 83314,
        "title": "`required_one_of` doesn't check variable type",
        "body": "### Summary\r\n\r\nIn `argument_specs`,`required_one_of` and `required_if` don't check the type of the variable. This is not the expected behavior.\r\n\r\nIn comparison, this issue doesn't show up when using `required: true`.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nvalidate_argument_spec\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.16.7]\r\n  config file = /home/libvoid/Documents/aw-security/pki/ansible.cfg\r\n  configured module search path = ['/home/libvoid/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/libvoid/.cache/pypoetry/virtualenvs/cve-jzrDeld9-py3.10/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/libvoid/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/libvoid/.cache/pypoetry/virtualenvs/cve-jzrDeld9-py3.10/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/home/libvoidfre/.cache/pypoetry/virtualenvs/cve-jzrDeld9-py3.10/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nDebian 12\r\n\r\n### Steps to Reproduce\r\n\r\nMinimal role:\r\n\r\n```yaml\r\n---\r\n- debug:\r\n   msg: \"{{ users.a }}\"\r\n```\r\n\r\nMinimal `meta/argument_specs.yml.yml`:\r\n\r\n```yaml\r\n---\r\nargument_specs:\r\n  main:\r\n    options:\r\n      users:\r\n        required: true\r\n        type: dict\r\n        required_one_of:\r\n          - [a, b]\r\n        options:\r\n          a:\r\n            required: false\r\n            type: list\r\n            elements: str\r\n          b:\r\n            required: false\r\n            type: list\r\n            elements: str\r\n```\r\n\r\nMinimal playbook:\r\n\r\n```yaml\r\n---\r\n- name: test\r\n  hosts: localhost\r\n  roles:\r\n    - { role: roles/test, tags: [all] }\r\n```\r\n\r\n`host_vars/localhost`:\r\n\r\n```\r\nusers:\r\n  a:\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n`a` variable is a boolean whereas it is defined as a `list` in the `meta/argument_specs.yml` file.\r\n\r\nThe automatic *Validating arguments against arg* task should **fail** if the type of the variable is wrong when using `required_one_of`.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [roles/test : Validating arguments against arg spec 'main'] *********************************************************************\r\nok: [localhost]\r\n\r\nTASK [roles/test : debug] ************************************************************************************************************\r\nok: [localhost] => \r\n    msg: true\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-28T16:04:31Z",
        "user": "libvoid",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.16",
            "affects_2.17",
            "affects_2.18"
        ]
    },
    {
        "number": 83292,
        "title": "Ansible 2.17 returns code 2 when some hosts are failing and rescued",
        "body": "### Summary\r\n\r\nWhen using block/rescue functionality in combination with `run_once` the ansible-playbook command returns code 2 when only some hosts are failing+rescued. When running the same playbook with --limit to only include a failing+rescued host it returns code 0. When running with --limit to only include a succeeding host it also returns code 0.\r\nSuspecting changes from #78680 to be causing this.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.17.0]\r\n  config file = None\r\n  configured module search path = ['/home/holbech/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/holbech/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/holbech/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/holbech/.local/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 22.04.4 LTS\r\n\r\n### Steps to Reproduce\r\n\r\nUsing a similar playbook as the integration test added in #78680\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n# inventory.yml\r\nall:\r\n  hosts:\r\n    testhost:\r\n    testhost2:\r\n\r\n# playbook.yml\r\n- hosts: testhost,testhost2\r\n  gather_facts: false\r\n  any_errors_fatal: true\r\n  tasks:\r\n    - block:\r\n        - debug:\r\n            msg: Some task running for all hosts\r\n        - fail:\r\n          run_once: true\r\n        - name: any_errors_fatal fails all hosts when any of them fails\r\n          debug:\r\n            msg: SHOULD NOT HAPPEN\r\n      rescue:\r\n        - name: Rescues both hosts\r\n          debug:\r\n            msg: rescue\r\n    - name: You can recover from fatal errors by adding a rescue section to the block.\r\n      debug:\r\n        msg: recovered\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nExpecting return code 0.\r\n\r\nExample from running with ansible-core version 2.16.7\r\n```console\r\n$ ansible-playbook -i inventory.yml playbook.yml ; echo $? \r\n\r\nPLAY [testhost,testhost2] ***************************************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [debug] ****************************************************************************************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"Some task running for all hosts\"\r\n}\r\nok: [testhost2] => {\r\n    \"msg\": \"Some task running for all hosts\"\r\n}\r\n\r\nTASK [fail] *****************************************************************************************************************************************************************************************************************************************************************************\r\nfatal: [testhost]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\n\r\nTASK [Rescues both hosts] ***************************************************************************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"rescue\"\r\n}\r\nok: [testhost2] => {\r\n    \"msg\": \"rescue\"\r\n}\r\n\r\nTASK [You can recover from fatal errors by adding a rescue section to the block.] *******************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"recovered\"\r\n}\r\nok: [testhost2] => {\r\n    \"msg\": \"recovered\"\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************\r\ntesthost                   : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   \r\ntesthost2                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n0\r\n```\r\nThe last 0 is the return code.\r\n\r\n### Actual Results\r\n\r\nGetting return code 2.\r\n\r\nExample from running with ansible-core version 2.17.0\r\n\r\n```console\r\n$ ansible-playbook -i inventory.yml playbook.yml ; echo $? \r\n\r\nPLAY [testhost,testhost2] ***************************************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [debug] ****************************************************************************************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"Some task running for all hosts\"\r\n}\r\nok: [testhost2] => {\r\n    \"msg\": \"Some task running for all hosts\"\r\n}\r\n\r\nTASK [fail] *****************************************************************************************************************************************************************************************************************************************************************************\r\nfatal: [testhost]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\n\r\nTASK [Rescues both hosts] ***************************************************************************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"rescue\"\r\n}\r\n\r\nTASK [You can recover from fatal errors by adding a rescue section to the block.] *******************************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"recovered\"\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************\r\ntesthost                   : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   \r\ntesthost2                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n2\r\n\r\nThe last 2 is the return code.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-22T12:38:41Z",
        "user": "ClausHolbechArista",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.17"
        ]
    },
    {
        "number": 83270,
        "title": "Allow usage of extra vars in `ansible.builtin.generator` inventory plugin, enabling the dynamic generation of inventory host names at runtime.",
        "body": "### Summary\r\n\r\n# Use Cases\r\n##  VM Creation\r\n- *Scenario:* Using Ansible to both create VMs and configure them. Consistency in hostname generation is critical to ensure seamless transitions between creation and configuration phases.\r\n- *Solution:* By enabling the `ansible.builtin.generator` plugin to use extra vars, it will be possible to dynamically generate consistent hostnames based on variables provided at runtime. This ensures consistency across already existing virtual machines (that may be sourced from dynamic inventory plugin) and newly created virtual machines. This consistency is important for the use of `group_vars` and `host_vars` in the configuration phase.\r\n\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nplugins/inventory/generator.py\r\n\r\n### Additional Information\r\n\r\nIn `inventory.yaml` file:\r\n```yaml\r\nplugin: ansible.builtin.generator\r\nhosts:\r\n    # The `region` variable is provided at runtime\r\n    name: \"{{ region }}{{ machine_type }}\"\r\nlayers:\r\n    machine_type:\r\n        - web\r\n        - db\r\n```\r\nRunning:\r\n```sh\r\nansible-inventory -i inventory.yaml -e region=region10 --list\r\n```\r\nShould output:\r\n```\r\n@all:\r\n  |--@ungrouped:\r\n  |  |--region10web\r\n  |  |--region10db\r\n```\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-19T07:56:26Z",
        "user": "Roysav",
        "labels": [
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 83255,
        "title": "Plugin development documentation requires updates which address handling Unsafe value wrappers",
        "body": "### Summary\n\nSince the changes introduced in #82293 it is unclear how plugin developers are meant to intentionally access the the raw value/types which are wrapped in various `AnsibleUnsafe` proxy wrappers. The current ansible code calls a private method `_strip_unsafe` against various proxy objects, but [that same method is marked for deprecation](https://github.com/ansible/ansible/issues/82414#issuecomment-1852977791) in the 2.17 release.\r\n\r\nThe documentation would benefit from a clear explanation as to why the unsafe proxy types are used along with some examples of how such objects can be worked with in code paths which require the concrete underlying types. For example, the current developer documentation could demonstrate passing some `AnsibleUnsafe` wrapped values which have been captured in a callback plugin's `v2_runner_on_ok` method to an external JSON/YAML/Protobuf based API.\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\ndevel/docs/docsite/rst/dev_guide/developing_plugins.rst\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.14]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/vagrant/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/vagrant/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.18 (main, Jan 24 2024, 00:00:00) [GCC 11.4.1 20231218 (Red Hat 11.4.1-3)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\nRedhat Enterprise Linux 9.4\n\n### Additional Information\n\nWithout the documentation guidance as requested I fear that the overall quality of plugins will degrade as various plugin developers reach for a wide range of arcane solutions which may be unnecessary or become broken again in a future release when the next code/logic changes in the proxy wrappers happens.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-15T17:58:29Z",
        "user": "drawks",
        "labels": [
            "affects_2.14",
            "data_tagging"
        ]
    },
    {
        "number": 83238,
        "title": "Implement Attribute Specific No Log Parameter",
        "body": "### Summary\r\n\r\nWhen writing playbooks and roles, it would be very helpful for the process of debugging to allow for functionality that either stands alongside the typical \"no_log: true\" or changes it in some way to _only_ remove logging for specific attributes of a task.\r\n\r\nFor example, I add a host to the current play, but I want to see all other information printed to the logs/stdout _except_ the password, with current no_log functionality, this is not possible -- it's either all or nothing.\r\n\r\nI was looking through the Ansible Core code to see if this was something that I could just put a PR up for myself, but the no_log functionality is quite intertwined with a lot of other stuff -- and is out of my purview for myself (I don't know Python lol); so this may be a feature that is too much work for too little reward, but I think it's a very good nice-to have (I just can't implement it myself)\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible-core core\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Add Host to Play\r\n  add_host:\r\n    name: \"{{ target.host.ip }}\"\r\n    groups: target-platform\r\n    ansible_connection: ssh\r\n    ansible_user: \"{{ target.host.user }}\"\r\n    ansible_password: \"{{ passwd }}\"\r\n  no_log_attr: true, ansible_password\r\n\r\n# Select, 'True' to enable no logging of specific attribute. Referance ansible_password as the argument to specify the attribute to not be logged.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-13T14:42:38Z",
        "user": "Poseidon6473",
        "labels": [
            "feature",
            "data_tagging"
        ]
    },
    {
        "number": 83219,
        "title": "`Unexpected failure during module execution: 'ansible_job_id'` when using multiple facts modules on Windows on ansible-core 2.16.0 and later",
        "body": "### Summary\n\nHello!\r\n\r\nWhen I configure a Windows machine to use multiple `ansible_facts_modules`, I get `Unexpected failure during module execution: 'ansible_job_id'` during the gathering facts stage of any playbook.  This error didn't previously occur (in Ansible 2.14) with the same configuration, but occurs now in 2.16.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngather_facts\n\n### Ansible Version\n\n```console\n# See also Steps to Reproduce - this is the version I happened to have installed while writing this report.\r\n$ ansible --version\r\nansible [core 2.16.0]\r\n  config file = /home/samueln/ansible-error-test/ansible.cfg\r\n  configured module search path = ['/home/samueln/ansible-error-test/modules', '/home/samueln/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible\r\n  ansible collection location = /home/samueln/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/samueln/ansible-error-test/venv/bin/ansible\r\n  python version = 3.11.5 (main, Oct 25 2023, 16:19:59) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (/home/samueln/ansible-error-test/venv/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_COW_ACCEPTLIST(/home/samueln/ansible-error-test/ansible.cfg) = [\"['bunny'\", 'default', 'hellokitty', 'koala', 'moofasa', 'moose', 'sheep', 'small', 'three-eyes', \"'tux']\"]\r\nANSIBLE_COW_SELECTION(/home/samueln/ansible-error-test/ansible.cfg) = random\r\nANSIBLE_NOCOWS(/home/samueln/ansible-error-test/ansible.cfg) = True\r\nCONFIG_FILE() = /home/samueln/ansible-error-test/ansible.cfg\r\nDEFAULT_ASK_PASS(/home/samueln/ansible-error-test/ansible.cfg) = True\r\nDEFAULT_BECOME_ASK_PASS(/home/samueln/ansible-error-test/ansible.cfg) = True\r\nDEFAULT_FORKS(/home/samueln/ansible-error-test/ansible.cfg) = 20\r\nDEFAULT_HOST_LIST(/home/samueln/ansible-error-test/ansible.cfg) = ['/home/samueln/ansible-error-test/inventory.yml']\r\nDEFAULT_LOG_PATH(/home/samueln/ansible-error-test/ansible.cfg) = /home/samueln/ansible-error-test/logs/latest.log\r\nDEFAULT_MODULE_PATH(/home/samueln/ansible-error-test/ansible.cfg) = ['/home/samueln/ansible-error-test/modules', '/home/samueln/.ansible/plugins/modules', '/usr/share/ansible/plugin>\r\nEDITOR(env: EDITOR) = nano\r\nHOST_KEY_CHECKING(/home/samueln/ansible-error-test/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/samueln/ansible-error-test/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/samueln/ansible-error-test/ansible.cfg) = False\r\n(END)\n```\n\n\n### OS / Environment\n\nThe control node has Rocky 8.  Failing hosts have Windows 10.\n\n### Steps to Reproduce\n\nThe error seems to have been introduced in ansible-core 2.16.0.  I have tested the following versions of ansible-core for the error:\r\n\r\n- 2.13.4: does not occur\r\n- 2.15.11: does not occur\r\n- 2.16.0: occurs\r\n- 2.16.6: occurs\r\n\r\nThe following `ansible_` variables are set via inventory on the affected Windows machines.  I don't expect them to be relevant, but I'm including them in case they are:\r\n\r\n```\r\nansible_connection: ssh\r\nansible_shell_type: cmd\r\nansible_become_method: runas\r\nansible_become_user: System\r\n```\r\n\r\nBeyond that, perhaps the simplest way to reproduce the error is to create a simple custom facts module:\r\n\r\n`win_helloworld_facts.ps1`\r\n```powershell\r\n#!powershell\r\n\r\n#AnsibleRequires -CSharpUtil Ansible.Basic\r\n\r\n$spec = @{\r\n    supports_check_mode = $true\r\n}\r\n\r\n$module = [Ansible.Basic.AnsibleModule]::Create($args, $spec)\r\n\r\n$module.Result.ansible_facts = @{\r\n    helloworld = \"Hello World!\"\r\n}\r\n\r\n$module.ExitJson()\r\n```\r\n\r\n...then configure a Windows machine to use both that module and `smart` (although you'd get the same result with 2 custom facts modules instead):\r\n\r\n`group_vars/windows.yml`, or however you see fit to introduce this variable:\r\n```\r\nansible_facts_modules:\r\n- smart\r\n- win_helloworld_facts\r\n```\r\n\r\n...then run a basic do-nothing playbook with fact gathering enabled:\r\n\r\n`test.yml`\r\n```yml\r\n- name: test\r\n  hosts: all\r\n  tasks:\r\n\r\n  - name: debug\r\n    ansible.builtin.debug:\r\n      msg: \"Hello World!\"\r\n```\r\n\r\n`ansible-playbook --limit some-windows-machine test.yml`\n\n### Expected Results\n\nI expect the playbook to run through and print \"Hello World!\"\n\n### Actual Results\n\n```console\n(venv) [samueln@[redacted] ansible-error-test]$ ansible-playbook --limit [redacted] test.yml -vvvv\r\nansible-playbook [core 2.16.0]\r\n  config file = /home/samueln/ansible-error-test/ansible.cfg\r\n  configured module search path = ['/home/samueln/ansible-error-test/modules', '/home/samueln/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible\r\n  ansible collection location = /home/samueln/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/samueln/ansible-error-test/venv/bin/ansible-playbook\r\n  python version = 3.11.5 (main, Oct 25 2023, 16:19:59) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (/home/samueln/ansible-error-test/venv/bin/python)\r\n  jinja version = 3.1.4\r\n  libyaml = True\r\nUsing /home/samueln/ansible-error-test/ansible.cfg as config file\r\nSSH password: \r\nBECOME password[defaults to SSH password]: \r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /home/samueln/ansible-error-test/inventory.yml as it did not pass its verify_file() method\r\nscript declined parsing /home/samueln/ansible-error-test/inventory.yml as it did not pass its verify_file() method\r\nSkipping empty key (hosts) in group (windows_11)\r\nParsed /home/samueln/ansible-error-test/inventory.yml inventory source with yaml plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: test.yml ***************************************************************************************************************************************************************************\r\nPositional arguments: test.yml\r\nverbosity: 4\r\nconnection: ssh\r\nask_pass: True\r\nbecome_method: sudo\r\nbecome_ask_pass: True\r\ntags: ('all',)\r\ninventory: ('/home/samueln/ansible-error-test/inventory.yml',)\r\nsubset: [redacted]\r\nforks: 20\r\n1 plays in test.yml\r\n\r\nPLAY [test] **********************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************************************************************************\r\ntask path: /home/samueln/ansible-error-test/test.yml:1\r\nRunning win_helloworld_facts\r\nUsing module file /home/samueln/ansible-error-test/modules/win_helloworld_facts.ps1\r\nPipelining is enabled.\r\n<[redacted]> ESTABLISH SSH CONNECTION FOR USER: None\r\n<[redacted]> SSH: EXEC sshpass -d13 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o ConnectTimeout=10 -o 'ControlPath=\"/home/samueln/.ansible/cp/0eaef8ca5a\"' [redacted] 'chcp.com 65001 >nul 2>&1 && PowerShell -NoProfile -NonInteractive -ExecutionPolicy Unrestricted -EncodedCommand UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAASgBnAEIAagBBAEcAZwBBAFkAdwBCAHcAQQBDADQAQQBZAHcAQgB2AEEARwAwAEEASQBBAEEAMgBBAEQAVQBBAE0AQQBBAHcAQQBEAEUAQQBJAEEAQQArAEEAQwBBAEEASgBBAEIAdQBBAEgAVQBBAGIAQQBCAHMAQQBBAG8AQQBhAFEAQgBtAEEAQwBBAEEASwBBAEEAawBBAEYAQQBBAFUAdwBCAFcAQQBHAFUAQQBjAGcAQgB6AEEARwBrAEEAYgB3AEIAdQBBAEYAUQBBAFkAUQBCAGkAQQBHAHcAQQBaAFEAQQB1AEEARgBBAEEAVQB3AEIAVwBBAEcAVQBBAGMAZwBCAHoAQQBHAGsAQQBiAHcAQgB1AEEAQwBBAEEATABRAEIAcwBBAEgAUQBBAEkAQQBCAGIAQQBGAFkAQQBaAFEAQgB5AEEASABNAEEAYQBRAEIAdgBBAEcANABBAFgAUQBBAGkAQQBEAE0AQQBMAGcAQQB3AEEAQwBJAEEASwBRAEEAZwBBAEgAcwBBAEMAZwBBAG4AQQBIAHMAQQBJAGcAQgBtAEEARwBFAEEAYQBRAEIAcwBBAEcAVQBBAFoAQQBBAGkAQQBEAG8AQQBkAEEAQgB5AEEASABVAEEAWgBRAEEAcwBBAEMASQBBAGIAUQBCAHoAQQBHAGMAQQBJAGcAQQA2AEEAQwBJAEEAUQBRAEIAdQBBAEgATQBBAGEAUQBCAGkAQQBHAHcAQQBaAFEAQQBnAEEASABJAEEAWgBRAEIAeABBAEgAVQBBAGEAUQBCAHkAQQBHAFUAQQBjAHcAQQBnAEEARgBBAEEAYgB3AEIAMwBBAEcAVQBBAGMAZwBCAFQAQQBHAGcAQQBaAFEAQgBzAEEARwB3AEEASQBBAEIAMgBBAEQATQBBAEwAZwBBAHcAQQBDAEEAQQBiAHcAQgB5AEEAQwBBAEEAYgBnAEIAbABBAEgAYwBBAFoAUQBCAHkAQQBDAEkAQQBmAFEAQQBuAEEAQQBvAEEAWgBRAEIANABBAEcAawBBAGQAQQBBAGcAQQBEAEUAQQBDAGcAQgA5AEEAQQBvAEEASgBBAEIAbABBAEgAZwBBAFoAUQBCAGoAQQBGADgAQQBkAHcAQgB5AEEARwBFAEEAYwBBAEIAdwBBAEcAVQBBAGMAZwBCAGYAQQBIAE0AQQBkAEEAQgB5AEEAQwBBAEEAUABRAEEAZwBBAEMAUQBBAGEAUQBCAHUAQQBIAEEAQQBkAFEAQgAwAEEAQwBBAEEAZgBBAEEAZwBBAEUAOABBAGQAUQBCADAAQQBDADAAQQBVAHcAQgAwAEEASABJAEEAYQBRAEIAdQBBAEcAYwBBAEMAZwBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQQBnAEEARAAwAEEASQBBAEEAawBBAEcAVQBBAGUAQQBCAGwAQQBHAE0AQQBYAHcAQgAzAEEASABJAEEAWQBRAEIAdwBBAEgAQQBBAFoAUQBCAHkAQQBGADgAQQBjAHcAQgAwAEEASABJAEEATABnAEIAVABBAEgAQQBBAGIAQQBCAHAAQQBIAFEAQQBLAEEAQgBBAEEAQwBnAEEASQBnAEIAZwBBAEQAQQBBAFkAQQBBAHcAQQBHAEEAQQBNAEEAQgBnAEEARABBAEEASQBnAEEAcABBAEMAdwBBAEkAQQBBAHkAQQBDAHcAQQBJAEEAQgBiAEEARgBNAEEAZABBAEIAeQBBAEcAawBBAGIAZwBCAG4AQQBGAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAUABBAEgAQQBBAGQAQQBCAHAAQQBHADgAQQBiAGcAQgB6AEEARgAwAEEATwBnAEEANgBBAEYASQBBAFoAUQBCAHQAQQBHADgAQQBkAGcAQgBsAEEARQBVAEEAYgBRAEIAdwBBAEgAUQBBAGUAUQBCAEYAQQBHADQAQQBkAEEAQgB5AEEARwBrAEEAWgBRAEIAegBBAEMAawBBAEMAZwBCAEoAQQBHAFkAQQBJAEEAQQBvAEEAQwAwAEEAYgBnAEIAdgBBAEgAUQBBAEkAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQQB1AEEARQB3AEEAWgBRAEIAdQBBAEcAYwBBAGQAQQBCAG8AQQBDAEEAQQBMAFEAQgBsAEEASABFAEEASQBBAEEAeQBBAEMAawBBAEkAQQBCADcAQQBDAEEAQQBkAEEAQgBvAEEASABJAEEAYgB3AEIAMwBBAEMAQQBBAEkAZwBCAHAAQQBHADQAQQBkAGcAQgBoAEEARwB3AEEAYQBRAEIAawBBAEMAQQBBAGMAQQBCAGgAQQBIAGsAQQBiAEEAQgB2AEEARwBFAEEAWgBBAEEAaQBBAEMAQQBBAGYAUQBBAEsAQQBGAE0AQQBaAFEAQgAwAEEAQwAwAEEAVgBnAEIAaABBAEgASQBBAGEAUQBCAGgAQQBHAEkAQQBiAEEAQgBsAEEAQwBBAEEATABRAEIATwBBAEcARQBBAGIAUQBCAGwAQQBDAEEAQQBhAGcAQgB6AEEARwA4AEEAYgBnAEIAZgBBAEgASQBBAFkAUQBCADMAQQBDAEEAQQBMAFEAQgBXAEEARwBFAEEAYgBBAEIAMQBBAEcAVQBBAEkAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQgBiAEEARABFAEEAWABRAEEASwBBAEMAUQBBAFoAUQBCADQAQQBHAFUAQQBZAHcAQgBmAEEASABjAEEAYwBnAEIAaABBAEgAQQBBAGMAQQBCAGwAQQBIAEkAQQBJAEEAQQA5AEEAQwBBAEEAVwB3AEIAVABBAEcATQBBAGMAZwBCAHAAQQBIAEEAQQBkAEEAQgBDAEEARwB3AEEAYgB3AEIAagBBAEcAcwBBAFgAUQBBADYAQQBEAG8AQQBRAHcAQgB5AEEARwBVAEEAWQBRAEIAMABBAEcAVQBBAEsAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQgBiAEEARABBAEEAWABRAEEAcABBAEEAbwBBAEoAZwBBAGsAQQBHAFUAQQBlAEEAQgBsAEEARwBNAEEAWAB3AEIAMwBBAEgASQBBAFkAUQBCAHcAQQBIAEEAQQBaAFEAQgB5AEEAQQA9AD0A'\r\n<[redacted]> (0, b'{\"changed\":false,\"invocation\":{\"module_args\":{}},\"ansible_facts\":{\"helloworld\":\"Hello World!\"}}\\r\\n\\r\\n', b'OpenSSH_8.0p1, OpenSSL 1.1.1k  FIPS 25 Mar 2021\\r\\ndebug1: Reading configuration data /home/samueln/.ssh/config\\r\\ndebug2: checking match for \\'user [redacted]\\' host [redacted] originally [redacted]\\r\\ndebug3: /home/samueln/.ssh/config line 1: not matched \\'user \"samueln\"\\' \\r\\ndebug2: match not found\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host [redacted] originally [redacted]\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: not matched \\'final\\'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/samueln/.ssh/config\\r\\ndebug2: checking match for \\'user [redacted]\\' host [redacted] originally [redacted]\\r\\ndebug3: /home/samueln/.ssh/config line 1: not matched \\'user \"samueln\"\\' \\r\\ndebug2: match not found\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host [redacted] originally [redacted]\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: matched \\'final\\'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 2615185\\r\\ndebug3: mux_client_request_session: session request sent\\r\\n#< CLIXML\\r\\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><Obj S=\"progress\" RefId=\"1\"><TNRef RefId=\"0\" /><MS><I64 N=\"SourceId\">2</I64><PR N=\"Record\"><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>debug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nRunning ansible.legacy.setup\r\nredirecting (type: modules) ansible.builtin.setup to ansible.windows.setup\r\nLoading collection ansible.windows from /home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible_collections/ansible/windows\r\nUsing module file /home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible_collections/ansible/windows/plugins/modules/setup.ps1\r\nPipelining is enabled.\r\n<[redacted]> ESTABLISH SSH CONNECTION FOR USER: None\r\n<[redacted]> SSH: EXEC sshpass -d13 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o ConnectTimeout=10 -o 'ControlPath=\"/home/samueln/.ansible/cp/0eaef8ca5a\"' [redacted] 'chcp.com 65001 >nul 2>&1 && PowerShell -NoProfile -NonInteractive -ExecutionPolicy Unrestricted -EncodedCommand UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAASgBnAEIAagBBAEcAZwBBAFkAdwBCAHcAQQBDADQAQQBZAHcAQgB2AEEARwAwAEEASQBBAEEAMgBBAEQAVQBBAE0AQQBBAHcAQQBEAEUAQQBJAEEAQQArAEEAQwBBAEEASgBBAEIAdQBBAEgAVQBBAGIAQQBCAHMAQQBBAG8AQQBhAFEAQgBtAEEAQwBBAEEASwBBAEEAawBBAEYAQQBBAFUAdwBCAFcAQQBHAFUAQQBjAGcAQgB6AEEARwBrAEEAYgB3AEIAdQBBAEYAUQBBAFkAUQBCAGkAQQBHAHcAQQBaAFEAQQB1AEEARgBBAEEAVQB3AEIAVwBBAEcAVQBBAGMAZwBCAHoAQQBHAGsAQQBiAHcAQgB1AEEAQwBBAEEATABRAEIAcwBBAEgAUQBBAEkAQQBCAGIAQQBGAFkAQQBaAFEAQgB5AEEASABNAEEAYQBRAEIAdgBBAEcANABBAFgAUQBBAGkAQQBEAE0AQQBMAGcAQQB3AEEAQwBJAEEASwBRAEEAZwBBAEgAcwBBAEMAZwBBAG4AQQBIAHMAQQBJAGcAQgBtAEEARwBFAEEAYQBRAEIAcwBBAEcAVQBBAFoAQQBBAGkAQQBEAG8AQQBkAEEAQgB5AEEASABVAEEAWgBRAEEAcwBBAEMASQBBAGIAUQBCAHoAQQBHAGMAQQBJAGcAQQA2AEEAQwBJAEEAUQBRAEIAdQBBAEgATQBBAGEAUQBCAGkAQQBHAHcAQQBaAFEAQQBnAEEASABJAEEAWgBRAEIAeABBAEgAVQBBAGEAUQBCAHkAQQBHAFUAQQBjAHcAQQBnAEEARgBBAEEAYgB3AEIAMwBBAEcAVQBBAGMAZwBCAFQAQQBHAGcAQQBaAFEAQgBzAEEARwB3AEEASQBBAEIAMgBBAEQATQBBAEwAZwBBAHcAQQBDAEEAQQBiAHcAQgB5AEEAQwBBAEEAYgBnAEIAbABBAEgAYwBBAFoAUQBCAHkAQQBDAEkAQQBmAFEAQQBuAEEAQQBvAEEAWgBRAEIANABBAEcAawBBAGQAQQBBAGcAQQBEAEUAQQBDAGcAQgA5AEEAQQBvAEEASgBBAEIAbABBAEgAZwBBAFoAUQBCAGoAQQBGADgAQQBkAHcAQgB5AEEARwBFAEEAYwBBAEIAdwBBAEcAVQBBAGMAZwBCAGYAQQBIAE0AQQBkAEEAQgB5AEEAQwBBAEEAUABRAEEAZwBBAEMAUQBBAGEAUQBCAHUAQQBIAEEAQQBkAFEAQgAwAEEAQwBBAEEAZgBBAEEAZwBBAEUAOABBAGQAUQBCADAAQQBDADAAQQBVAHcAQgAwAEEASABJAEEAYQBRAEIAdQBBAEcAYwBBAEMAZwBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQQBnAEEARAAwAEEASQBBAEEAawBBAEcAVQBBAGUAQQBCAGwAQQBHAE0AQQBYAHcAQgAzAEEASABJAEEAWQBRAEIAdwBBAEgAQQBBAFoAUQBCAHkAQQBGADgAQQBjAHcAQgAwAEEASABJAEEATABnAEIAVABBAEgAQQBBAGIAQQBCAHAAQQBIAFEAQQBLAEEAQgBBAEEAQwBnAEEASQBnAEIAZwBBAEQAQQBBAFkAQQBBAHcAQQBHAEEAQQBNAEEAQgBnAEEARABBAEEASQBnAEEAcABBAEMAdwBBAEkAQQBBAHkAQQBDAHcAQQBJAEEAQgBiAEEARgBNAEEAZABBAEIAeQBBAEcAawBBAGIAZwBCAG4AQQBGAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAUABBAEgAQQBBAGQAQQBCAHAAQQBHADgAQQBiAGcAQgB6AEEARgAwAEEATwBnAEEANgBBAEYASQBBAFoAUQBCAHQAQQBHADgAQQBkAGcAQgBsAEEARQBVAEEAYgBRAEIAdwBBAEgAUQBBAGUAUQBCAEYAQQBHADQAQQBkAEEAQgB5AEEARwBrAEEAWgBRAEIAegBBAEMAawBBAEMAZwBCAEoAQQBHAFkAQQBJAEEAQQBvAEEAQwAwAEEAYgBnAEIAdgBBAEgAUQBBAEkAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQQB1AEEARQB3AEEAWgBRAEIAdQBBAEcAYwBBAGQAQQBCAG8AQQBDAEEAQQBMAFEAQgBsAEEASABFAEEASQBBAEEAeQBBAEMAawBBAEkAQQBCADcAQQBDAEEAQQBkAEEAQgBvAEEASABJAEEAYgB3AEIAMwBBAEMAQQBBAEkAZwBCAHAAQQBHADQAQQBkAGcAQgBoAEEARwB3AEEAYQBRAEIAawBBAEMAQQBBAGMAQQBCAGgAQQBIAGsAQQBiAEEAQgB2AEEARwBFAEEAWgBBAEEAaQBBAEMAQQBBAGYAUQBBAEsAQQBGAE0AQQBaAFEAQgAwAEEAQwAwAEEAVgBnAEIAaABBAEgASQBBAGEAUQBCAGgAQQBHAEkAQQBiAEEAQgBsAEEAQwBBAEEATABRAEIATwBBAEcARQBBAGIAUQBCAGwAQQBDAEEAQQBhAGcAQgB6AEEARwA4AEEAYgBnAEIAZgBBAEgASQBBAFkAUQBCADMAQQBDAEEAQQBMAFEAQgBXAEEARwBFAEEAYgBBAEIAMQBBAEcAVQBBAEkAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQgBiAEEARABFAEEAWABRAEEASwBBAEMAUQBBAFoAUQBCADQAQQBHAFUAQQBZAHcAQgBmAEEASABjAEEAYwBnAEIAaABBAEgAQQBBAGMAQQBCAGwAQQBIAEkAQQBJAEEAQQA5AEEAQwBBAEEAVwB3AEIAVABBAEcATQBBAGMAZwBCAHAAQQBIAEEAQQBkAEEAQgBDAEEARwB3AEEAYgB3AEIAagBBAEcAcwBBAFgAUQBBADYAQQBEAG8AQQBRAHcAQgB5AEEARwBVAEEAWQBRAEIAMABBAEcAVQBBAEsAQQBBAGsAQQBIAE0AQQBjAEEAQgBzAEEARwBrAEEAZABBAEIAZgBBAEgAQQBBAFkAUQBCAHkAQQBIAFEAQQBjAHcAQgBiAEEARABBAEEAWABRAEEAcABBAEEAbwBBAEoAZwBBAGsAQQBHAFUAQQBlAEEAQgBsAEEARwBNAEEAWAB3AEIAMwBBAEgASQBBAFkAUQBCAHcAQQBIAEEAQQBaAFEAQgB5AEEAQQA9AD0A'\r\n<[redacted]> (0, b'{\"changed\":false,\"invocation\":{\"module_args\":{\"_measure_subset\":false,\"gather_timeout\":10,\"gather_subset\":[\"all\"],\"fact_path\":null}},\"ansible_facts\":{\"ansible_ip_addresses\":[redacted],\"ansible_windows_domain_role\":\"Member workstation\",\"ansible_architecture2\":\"x86_64\",\"ansible_user_gecos\":\"\",\"ansible_distribution_major_version\":\"10\",\"ansible_pagefiletotal_mb\":4864,\"ansible_os_name\":\"Microsoft Windows 10 Pro\",\"ansible_system_description\":\"\",\"ansible_machine_id\":\"[redacted]\",\"ansible_product_serial\":\"[redacted]\",\"ansible_system_vendor\":\"oVirt\",\"gather_subset\":[\"all\"],\"ansible_bios_version\":\"1.11.0-2.el7\",\"ansible_user_id\":\"samueln\",\"ansible_date_time\":{\"epoch_local\":\"1715183500.47678\",\"epoch_int\":1715201500,\"date\":\"2024-05-08\",\"second\":\"40\",\"tz\":\"Central Standard Time\",\"iso8601_micro\":\"2024-05-08T20:51:40.476780Z\",\"iso8601_basic_short\":\"20240508T155140\",\"minute\":\"51\",\"day\":\"08\",\"weekday\":\"Wednesday\",\"iso8601\":\"2024-05-08T20:51:40Z\",\"tz_offset\":\"-05:00\",\"iso8601_basic\":\"20240508T155140476780\",\"epoch\":\"1715201500.47678\",\"weekday_number\":\"3\",\"hour\":\"15\",\"year\":\"2024\",\"month\":\"05\",\"time\":\"15:51:40\",\"weeknumber\":\"18\"},\"ansible_user_dir\":\"C:\\\\\\\\Users\\\\\\\\samueln\",\"ansible_processor_vcpus\":2,\"ansible_user_sid\":\"[redacted]\",\"ansible_owner_contact\":\"\",\"ansible_distribution\":\"Microsoft Windows 10 Pro\",\"ansible_processor\":[\"0\",\"GenuineIntel\",\"Intel Core i7 9xx (Nehalem Class Core i7)\",\"1\",\"GenuineIntel\",\"Intel Core i7 9xx (Nehalem Class Core i7)\"],\"ansible_powershell_version\":5,\"ansible_uptime_seconds\":432705,\"module_setup\":true,\"ansible_interfaces\":[{\"dns_domain\":\"[redacted]\",\"connection_name\":\"Ethernet\",\"default_gateway\":\"[redacted]\",\"mtu\":1500,\"interface_name\":\"Red Hat VirtIO Ethernet Adapter\",\"ipv6\":{},\"macaddress\":\"[redacted]\",\"speed\":100000,\"interface_index\":5,\"ipv4\":{\"address\":\"[redacted]\",\"prefix\":\"16\"}},{\"dns_domain\":null,\"connection_name\":\"vEthernet (Default Switch)\",\"default_gateway\":null,\"mtu\":1500,\"interface_name\":\"Hyper-V Virtual Ethernet Adapter\",\"ipv6\":{},\"macaddress\":\"[redacted]\",\"speed\":10000,\"interface_index\":9,\"ipv4\":{\"address\":\"[redacted]\",\"prefix\":\"20\"}}],\"ansible_distribution_version\":\"10.0.19045.0\",\"ansible_windows_domain_member\":true,\"ansible_swaptotal_mb\":0,\"ansible_hostname\":\"[redacted]\",\"ansible_virtualization_role\":\"guest\",\"ansible_memfree_mb\":27610,\"ansible_processor_count\":1,\"ansible_os_product_type\":\"workstation\",\"ansible_netbios_name\":\"[redacted]\",\"ansible_product_name\":\"oVirt Node\",\"ansible_virtualization_type\":\"kvm\",\"ansible_os_installation_type\":\"Client\",\"ansible_lastboot\":\"2024-05-03 15:39:57Z\",\"ansible_architecture\":\"64-bit\",\"ansible_bios_date\":\"04/01/2014\",\"ansible_processor_cores\":2,\"ansible_fqdn\":\"[redacted]\",\"ansible_domain\":\"[redacted]\",\"ansible_memtotal_mb\":32768,\"ansible_kernel\":\"10.0.19045.0\",\"ansible_pagefilefree_mb\":4763,\"ansible_nodename\":\"[redacted]\",\"ansible_os_family\":\"Windows\",\"ansible_processor_threads_per_core\":1,\"ansible_owner_name\":\"[redacted]\",\"ansible_env\":{\"HOME\":\"C:\\\\\\\\Users\\\\\\\\samueln\",\"CVSIGNORE\":\"*.aps *.ncb *.opt *.plg *.pyc Debug Release\",\"ComSpec\":\"C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\cmd.exe\",\"DriverData\":\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Drivers\\\\\\\\DriverData\",\"ANSIBLE_ASYNC_DIR\":\"%USERPROFILE%\\\\\\\\.ansible_async\",\"SystemRoot\":\"C:\\\\\\\\Windows\",\"Path\":\"C:\\\\\\\\Program Files\\\\\\\\openjdk_11_0_14\\\\\\\\bin;C:\\\\\\\\Program Files\\\\\\\\Python310\\\\\\\\Scripts\\\\\\\\;C:\\\\\\\\Program Files\\\\\\\\Python310\\\\\\\\;C:\\\\\\\\Windows\\\\\\\\system32;C:\\\\\\\\Windows;C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\Wbem;C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\\\\\\;C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\OpenSSH\\\\\\\\;C:\\\\\\\\bin;C:\\\\\\\\Program Files\\\\\\\\Git\\\\\\\\cmd;C:\\\\\\\\Program Files\\\\\\\\nodejs\\\\\\\\;C:\\\\\\\\Program Files\\\\\\\\dotnet\\\\\\\\;C:\\\\\\\\Program Files (x86)\\\\\\\\WiX Toolset v3.11\\\\\\\\bin;C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\config\\\\\\\\systemprofile\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Microsoft\\\\\\\\WindowsApps;C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Microsoft\\\\\\\\WindowsApps;C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\npm;C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\.dotnet\\\\\\\\tools\",\"OneDrive\":\"C:\\\\\\\\Users\\\\\\\\Administrator\\\\\\\\OneDrive\",\"CommonProgramFiles(x86)\":\"C:\\\\\\\\Program Files (x86)\\\\\\\\Common Files\",\"SSH_CONNECTION\":\"[redacted] 36558 [redacted] 22\",\"ProgramW6432\":\"C:\\\\\\\\Program Files\",\"HOMEPATH\":\"\\\\\\\\Users\\\\\\\\samueln\",\"USERPROFILE\":\"C:\\\\\\\\Users\\\\\\\\samueln\",\"OS\":\"Windows_NT\",\"PSModulePath\":\"C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\Documents\\\\\\\\WindowsPowerShell\\\\\\\\Modules;C:\\\\\\\\Program Files\\\\\\\\WindowsPowerShell\\\\\\\\Modules;C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\\\\\\Modules\",\"ProgramFiles(x86)\":\"C:\\\\\\\\Program Files (x86)\",\"PSExecutionPolicyPreference\":\"Unrestricted\",\"SHELL\":\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\",\"SystemDrive\":\"C:\",\"CVSROOT\":\"[redacted]\",\"CommonProgramFiles\":\"C:\\\\\\\\Program Files\\\\\\\\Common Files\",\"LOGNAME\":\"[redacted]\",\"ProgramFiles\":\"C:\\\\\\\\Program Files\",\"USERDOMAIN\":\"[redacted]\",\"PATHEXT\":\".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.PY;.PYW;.CPL\",\"PROCESSOR_LEVEL\":\"6\",\"WIX\":\"C:\\\\\\\\Program Files (x86)\\\\\\\\WiX Toolset v3.11\",\"SSH_CLIENT\":\"[redacted] 36558 22\",\"COMPUTERNAME\":\"[redacted]\",\"USER\":\"[redacted]\",\"NUMBER_OF_PROCESSORS\":\"2\",\"TEMP\":\"C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Temp\",\"LOCALAPPDATA\":\"C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Local\",\"PUBLIC\":\"C:\\\\\\\\Users\\\\\\\\Public\",\"PROCESSOR_REVISION\":\"1a03\",\"APPDATA\":\"C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Roaming\",\"ProgramData\":\"C:\\\\\\\\ProgramData\",\"PROCESSOR_IDENTIFIER\":\"Intel64 Family 6 Model 26 Stepping 3, GenuineIntel\",\"HOMEDRIVE\":\"C:\",\"PROCESSOR_ARCHITECTURE\":\"AMD64\",\"JAVA_HOME\":\"C:\\\\\\\\Program Files\\\\\\\\openjdk_11_0_14\",\"CommonProgramW6432\":\"C:\\\\\\\\Program Files\\\\\\\\Common Files\",\"PROMPT\":\"[redacted] $P$G\",\"windir\":\"C:\\\\\\\\Windows\",\"ALLUSERSPROFILE\":\"C:\\\\\\\\ProgramData\",\"USERNAME\":\"samueln\",\"c28fc6f98a2c44abbbd89d6a3037d0d9_POSIX_FD_STATE\":\"AAAAAAICAgA=\",\"CVS_RSH\":\"C:\\\\\\\\Windows\\\\\\\\Sysnative\\\\\\\\OpenSSH\\\\\\\\ssh.exe\",\"TMP\":\"C:\\\\\\\\Users\\\\\\\\samueln\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Temp\"},\"ansible_windows_domain\":\"[redacted]\",\"ansible_reboot_pending\":true,\"ansible_system\":\"Win32NT\"}}\\r\\n\\r\\n', b'OpenSSH_8.0p1, OpenSSL 1.1.1k  FIPS 25 Mar 2021\\r\\ndebug1: Reading configuration data /home/samueln/.ssh/config\\r\\ndebug2: checking match for \\'user [redacted]\\' host [redacted] originally [redacted]\\r\\ndebug3: /home/samueln/.ssh/config line 1: not matched \\'user \"samueln\"\\' \\r\\ndebug2: match not found\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host [redacted] originally [redacted]\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: not matched \\'final\\'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/samueln/.ssh/config\\r\\ndebug2: checking match for \\'user [redacted]\\' host [redacted] originally [redacted]\\r\\ndebug3: /home/samueln/.ssh/config line 1: not matched \\'user \"samueln\"\\' \\r\\ndebug2: match not found\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host [redacted] originally [redacted]\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: matched \\'final\\'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 2615185\\r\\ndebug3: mux_client_request_session: session request sent\\r\\n#< CLIXML\\r\\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><Obj S=\"progress\" RefId=\"1\"><TNRef RefId=\"0\" /><MS><I64 N=\"SourceId\">2</I64><PR N=\"Record\"><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>debug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible/executor/task_executor.py\", line 165, in run\r\n    res = self._execute()\r\n          ^^^^^^^^^^^^^^^\r\n  File \"/home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible/executor/task_executor.py\", line 641, in _execute\r\n    result = self._handler.run(task_vars=vars_copy)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/samueln/ansible-error-test/venv/lib64/python3.11/site-packages/ansible/plugins/action/gather_facts.py\", line 139, in run\r\n    poll_args = {'jid': jobs[module]['ansible_job_id'], '_async_dir': os.path.dirname(jobs[module]['results_file'])}\r\n                        ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\r\nKeyError: 'ansible_job_id'\r\nfatal: [[redacted]]: FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution: 'ansible_job_id'\",\r\n    \"stdout\": \"\"\r\n}\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************\r\n[redacted]              : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-08T21:11:31Z",
        "user": "samueln-w",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 83181,
        "title": "Displaying file information for include_tasks when using the ansible-playbook command with the --list-tasks option",
        "body": "### Summary\n\nWhen running the ansible-playbook command with the --list-tasks option, if tasks are referenced using `include_tasks` and lack a `name` value, the output is as shown below (AS-IS). I find this output format to be less visible. It would be better if the names of the referenced files were also displayed.\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ntaskmsg\n\n### Additional Information\n\n**[AS-IS]**\r\n\r\n```go\r\n  play #8 (test): test\tTAGS: []\r\n    tasks:\r\n      include_tasks\tTAGS: [test]\r\n      include_tasks\tTAGS: [test]\r\n      include_tasks\tTAGS: [test]\r\n\r\n```\r\n\r\n**[TO-BE]**\r\n\r\n```go\r\n  play #8 (test): test\tTAGS: []\r\n    tasks:\r\n      include_tasks INCLUDE: test1.yml\tTAGS: [test]\r\n      include_tasks INCLUDE: test2.yml\tTAGS: [test]\r\n      include_tasks INCLUDE: test3.yml\tTAGS: [test]\r\n```\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-05-02T05:20:09Z",
        "user": "chungeun-choi",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 83159,
        "title": "When fatal: happens when using iteration, all results are lost even if ignore_errors is true",
        "body": "### Summary\n\nI am trying to write simple fact-setting check verifying that user can `become` certain roles. As playbook can run either as unprivileged user (without `-K`) or as `root`, sudo password is not always provided. This check iterates over names of `become` users and attempts to become each of them either successfully or not. Goal was to collect results and set facts based on them so that other tasks/roles can be skipped using simple `when: has_root`, `when: has_user`, etc.\r\n\r\nProblem is that when `sudo` password is not provided (and required), it results in fatal and _ALL_ results are lost even if some hosts actually pass and `ignore_errors` (or `failed_when: false`) is in place.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nbecome\n\n### Ansible Version\n\n```console\nansible [core 2.16.6]\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.9 (main, Apr 10 2024, 13:16:36) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nDebian GNU/Linux 12\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: \"Checking Become\"\r\n  command:\r\n    cmd: \"/bin/true\"\r\n  become: true\r\n  become_user: \"{{ item }}\"\r\n  register: out\r\n  ignore_errors: true\r\n  with_items:\r\n    - \"test\"\r\n    - \"root\"\r\n\r\n- debug:\r\n    var: out\r\n```\r\nWhere `test` is the user configured to connect to managed node, root requires sudo password which is not provided at this moment.\n\n### Expected Results\n\n```\r\nTASK [Checking Become] **************************************************************************************************************\r\nok: [vm] => (item=test)\r\nfailed: [vm] => (item=root)\r\n...ignoring\r\n\r\nTASK [debug] ************************************************************************************************************************\r\nok: [vm] => {\r\n    \"out\": {\r\n        \"changed\": false,\r\n        \"failed\": true\r\n        \"msg\": \"Some items failed\",\r\n        \"results\": [\r\n           {\r\n                ...\r\n                \"item\": \"test\",\r\n                \"failed\": false,\r\n                ...\r\n            },\r\n           {\r\n                ...\r\n                \"item\": \"root\",\r\n                \"failed\": true,\r\n                ...\r\n            },\r\n        ],\r\n        \"skipped\": false\r\n    }\r\n}\r\n```\n\n### Actual Results\n\n```console\nTASK [Checking Become] **************************************************************************************************************\r\nok: [vm] => (item=test)\r\nfatal: [vm]: FAILED! => {\"msg\": \"Missing sudo password\"}\r\n...ignoring\r\n\r\nTASK [debug] ************************************************************************************************************************\r\nok: [vm] => {\r\n    \"out\": {\r\n        \"failed\": true,\r\n        \"msg\": \"Missing sudo password\"\r\n    }\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-29T16:12:36Z",
        "user": "blami",
        "labels": [
            "bug",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 83146,
        "title": "`git` module: `Failed to init/update submodules: warning: could not look up configuration 'remote.origin.url'`",
        "body": "### Summary\n\nThe `git` module fails to properly clone submodules when using:\r\n\r\n  1. A relative submodule path\r\n  1. A non-standard value for `remote`\r\n  1. A non-standard value for `version`\r\n\r\nI am able to consistently reproduce the issue with the below \"Steps to reproduce\".  My hypothesis is that something along the following is happening:\r\n\r\n  1. The `git` module tries to clone the repo submodule, but it doesn't know what protocol to use because the git submodule URL is relative\r\n  1. The `git` module is then hardcoded to find the protocol via `remote.origin.url`, not taking into account that the remote is `github`, and thus fails to find the correct protocol for cloning the repo submodule.\r\n  1. The `git` module tries to clone with a relative path, which fails because it's supposed to use HTTPS.\r\n  \r\nI don't know how the `version` field plays into this, but the module works fine when a custom `version` field is not specified.  It also works fine if I keep the `version` field and remove the `remote` field.  It's only the combination which appears to cause the issue.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngit\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.6]\r\n  config file = None\r\n  configured module search path = ['/home/wtcline/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/wtcline/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/wtcline/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\n```\n\n\n### OS / Environment\n\nUbuntu 22.04 LTS\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nI created two public repos that are capable of reproducing the problem:\r\n\r\n  * https://github.com/wtcline-intc/submod-relpath-test-mainrepo.git which contains the \"main\" repo that includes the submodule\r\n  * https://github.com/wtcline-intc/submod-relpath-test-submodule.git which contains the submodule\r\n\r\nThe following playbook tries to clone the main repo with its submodule and then fails.\r\n\r\n```yaml (paste below)\r\n- name: Checkout repos\r\n  hosts: localhost\r\n  tasks:\r\n  - git:\r\n      repo: https://github.com/wtcline-intc/submod-relpath-test-mainrepo.git\r\n      dest: submod-relpath-test-mainrepo\r\n      remote: github\r\n      version: \"v0.1\"\r\n```\n\n### Expected Results\n\nI expected the main repo to be cloned with its source (remote) named `github` and its submodule cloned as expected (though the submodule's remote would be named `origin`); instead, the submodules were not cloned!\n\n### Actual Results\n\n```console\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nansible-playbook [core 2.16.6]\r\n  config file = None\r\n  configured module search path = ['/home/wtcline/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/wtcline/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/wtcline/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\nNo config file found; using defaults\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nLoading callback plugin default of type stdout, v2.0 from /home/wtcline/.local/lib/python3.10/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: main.yaml ************************************************************\r\nPositional arguments: main.yaml\r\nverbosity: 4\r\nconnection: ssh\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/etc/ansible/hosts',)\r\nforks: 5\r\n1 plays in main.yaml\r\n\r\nPLAY [Checkout repos] **********************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /home/wtcline/main.yaml:1\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: wtcline\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~wtcline && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/wtcline/.ansible/tmp `\"&& mkdir \"` echo /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971 `\" && echo ansible-tmp-1714095341.5799274-5820-229251185465971=\"` echo /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971 `\" ) && sleep 0'\r\nUsing module file /home/wtcline/.local/lib/python3.10/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/wtcline/.ansible/tmp/ansible-local-5816xbdj7yow/tmp2hh3hnw7 TO /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971/ /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/wtcline/.ansible/tmp/ansible-tmp-1714095341.5799274-5820-229251185465971/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [git] *********************************************************************\r\ntask path: /home/wtcline/main.yaml:4\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: wtcline\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~wtcline && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/wtcline/.ansible/tmp `\"&& mkdir \"` echo /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159 `\" && echo ansible-tmp-1714095342.2404609-5881-217583858493159=\"` echo /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159 `\" ) && sleep 0'\r\nUsing module file /home/wtcline/.local/lib/python3.10/site-packages/ansible/modules/git.py\r\n<127.0.0.1> PUT /home/wtcline/.ansible/tmp/ansible-local-5816xbdj7yow/tmp8xkgvqnk TO /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159/AnsiballZ_git.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159/ /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159/AnsiballZ_git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159/AnsiballZ_git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/wtcline/.ansible/tmp/ansible-tmp-1714095342.2404609-5881-217583858493159/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"accept_hostkey\": false,\r\n            \"accept_newhostkey\": false,\r\n            \"archive\": null,\r\n            \"archive_prefix\": null,\r\n            \"bare\": false,\r\n            \"clone\": true,\r\n            \"depth\": null,\r\n            \"dest\": \"submod-relpath-test-mainrepo\",\r\n            \"executable\": null,\r\n            \"force\": false,\r\n            \"gpg_whitelist\": [],\r\n            \"key_file\": null,\r\n            \"recursive\": true,\r\n            \"reference\": null,\r\n            \"refspec\": null,\r\n            \"remote\": \"github\",\r\n            \"repo\": \"https://github.com/wtcline-intc/submod-relpath-test-mainrepo.git\",\r\n            \"separate_git_dir\": null,\r\n            \"single_branch\": false,\r\n            \"ssh_opts\": null,\r\n            \"track_submodules\": false,\r\n            \"umask\": null,\r\n            \"update\": true,\r\n            \"verify_commit\": false,\r\n            \"version\": \"v0.1\"\r\n        }\r\n    },\r\n    \"msg\": \"Failed to init/update submodules: warning: could not look up configuration 'remote.origin.url'. Assuming this repository is its own authoritative upstream.\\nSubmodule 'submod-relpath-test-submodule' (/home/wtcline/submod-relpath-test-submodule.git) registered for path 'submod-relpath-test-submodule'\\nfatal: repository '/home/wtcline/submod-relpath-test-submodule.git' does not exist\\nfatal: clone of '/home/wtcline/submod-relpath-test-submodule.git' into submodule path '/home/wtcline/submod-relpath-test-mainrepo/submod-relpath-test-submodule' failed\\nFailed to clone 'submod-relpath-test-submodule'. Retry scheduled\\nfatal: repository '/home/wtcline/submod-relpath-test-submodule.git' does not exist\\nfatal: clone of '/home/wtcline/submod-relpath-test-submodule.git' into submodule path '/home/wtcline/submod-relpath-test-mainrepo/submod-relpath-test-submodule' failed\\nFailed to clone 'submod-relpath-test-submodule' a second time, aborting\\n\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-26T02:06:56Z",
        "user": "wtcline-intc",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 83087,
        "title": "Need ansible.builtin.dpkg_selections to hold package even if not already installed",
        "body": "### Summary\n\nWhen I try to use **ansible.builtin.dpkg_selections** to put a hold on **python2.7-minimal** (or any **python2.7** package) in Ubuntu 22.04.4 it fails. This appears to be related to [dpkg_selections: Check if package exists before selection operation](https://github.com/ansible/ansible/pull/81406). I would expect **dpkg_selections** to be able to put holds on _**any**_ package in the repos regardless of whether it is installed or not, similar to how **`apt-mark hold`** works manually. My goal is to prevent the installation of **python2.7**.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ndpkg_selections\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.5]\r\n  config file = /srv/home/rlilly/repos/ansible/ansible.cfg\r\n  configured module search path = ['/home/rlillyx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/rlillyx/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /srv/home/rlilly/repos/ansible/ansible.cfg\r\nDEFAULT_FORKS(/srv/home/rlilly/repos/ansible/ansible.cfg) = 50\r\nDEFAULT_HOST_LIST(/srv/home/rlilly/repos/ansible/ansible.cfg) = ['/srv/home/rlilly/repos/ansible/inventory.yml']\r\nDEFAULT_JINJA2_EXTENSIONS(/srv/home/rlilly/repos/ansible/ansible.cfg) = jinja2.ext.do\r\nDEFAULT_PRIVATE_KEY_FILE(/srv/home/rlilly/repos/ansible/ansible.cfg) = /home/szollin/.ssh/internal.key\r\nHOST_KEY_CHECKING(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/srv/home/rlilly/repos/ansible/ansible.cfg) = auto\r\nINVENTORY_CACHE_ENABLED(/srv/home/rlilly/repos/ansible/ansible.cfg) = True\r\nINVENTORY_CACHE_PLUGIN(/srv/home/rlilly/repos/ansible/ansible.cfg) = jsonfile\r\nINVENTORY_CACHE_PLUGIN_CONNECTION(/srv/home/rlilly/repos/ansible/ansible.cfg) = /tmp/ansible_inventory\r\nPAGER(env: PAGER) = less\r\nRETRY_FILES_ENABLED(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n:...skipping...\r\nCONFIG_FILE() = /srv/home/rlilly/repos/ansible/ansible.cfg\r\nDEFAULT_FORKS(/srv/home/rlilly/repos/ansible/ansible.cfg) = 50\r\nDEFAULT_HOST_LIST(/srv/home/rlilly/repos/ansible/ansible.cfg) = ['/srv/home/rlilly/repos/ansible/inventory.yml']\r\nDEFAULT_JINJA2_EXTENSIONS(/srv/home/rlilly/repos/ansible/ansible.cfg) = jinja2.ext.do\r\nDEFAULT_PRIVATE_KEY_FILE(/srv/home/rlilly/repos/ansible/ansible.cfg) = /home/szollin/.ssh/internal.key\r\nHOST_KEY_CHECKING(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/srv/home/rlilly/repos/ansible/ansible.cfg) = auto\r\nINVENTORY_CACHE_ENABLED(/srv/home/rlilly/repos/ansible/ansible.cfg) = True\r\nINVENTORY_CACHE_PLUGIN(/srv/home/rlilly/repos/ansible/ansible.cfg) = jsonfile\r\nINVENTORY_CACHE_PLUGIN_CONNECTION(/srv/home/rlilly/repos/ansible/ansible.cfg) = /tmp/ansible_inventory\r\nPAGER(env: PAGER) = less\r\nRETRY_FILES_ENABLED(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\nprivate_key_file(/srv/home/rlilly/repos/ansible/ansible.cfg) = /home/szollin/.ssh/internal.key\r\n\r\nssh:\r\n___\r\nhost_key_checking(/srv/home/rlilly/repos/ansible/ansible.cfg) = False\r\npipelining(/srv/home/rlilly/repos/ansible/ansible.cfg) = True\r\nprivate_key_file(/srv/home/rlilly/repos/ansible/ansible.cfg) = /home/szollin/.ssh/internal.key\r\nscp_if_ssh(/srv/home/rlilly/repos/ansible/ansible.cfg) = true\n```\n\n\n### OS / Environment\n\nBoth the control machine and the target are Ubuntu 22.04.4\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nVars:\r\n```\r\nbase_pkg_setup_apt_pkg_hold:\r\n  - \"python2.7-minimal\"\r\n\r\n```\r\nPlay:\r\n```\r\n    - name: Hold selected package(s) Ubuntu 22 and above\r\n      ansible.builtin.dpkg_selections:\r\n        name: \"{{ item }}\"\r\n        selection: hold\r\n      with_items: \"{{ base_pkg_setup_apt_pkg_hold }}\"\r\n      when:\r\n        - ansible_facts['distribution'] == \"Ubuntu\"\r\n        - ansible_facts['distribution_major_version'] >= \"22\"\r\n        - \"item not in held_packages.stdout_lines\"\r\n```\n\n### Expected Results\n\nI expect the package **python2.7-minimal** to be held even if it's not installed, similar to how **`apt-mark hold python2.7-minimal`** works.\n\n### Actual Results\n\n```console\nTASK [base_pkg_setup : Hold selected package(s) Ubuntu 22 and above] **************************************************************************\r\nfailed: [upgrade-test-ws.ostc.intel.com] (item=python2.7-minimal) => {\"ansible_loop_var\": \"item\", \"changed\": false, \"item\": \"python2.7-minimal\", \"msg\": \"Failed to find package 'python2.7-minimal' to perform selection 'hold'.\"}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-18T19:15:43Z",
        "user": "rclilly",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 83081,
        "title": "ansible winrm connection hangs when connection is bad  ",
        "body": "### Summary\r\n\r\n### Problem: \r\n\r\nWe discovered that Ansible somehow hangs when the internet connection is bad and no timeout exception was thrown.\r\nAnsible will hang on some random tasks and not finish or fail.\r\n\r\nsee log: after the Warning '[WARNING]: ERROR DURING WINRM SEND INPUT - attempting to recover' the process does not continue \r\n\r\n### Expectation:\r\n\r\nIf a task does not finish, a timeout error should be thrown and ansible should exit.\r\n\r\n### Test scenario\r\n\r\nI set up an environment where I simulate a bad internet connection and check what ansible does.\r\n\r\n- Ubuntu 22.04 \r\n- latest ansible \r\n- Bandwidth limiting Traffic Toll (https://github.com/cryzed/TrafficToll) \r\n   - download: 1kbps\r\n   - upload: 1kbps\r\n   - download-minimum: 1kbps\r\n   - upload-minimum: 1kbps\r\n   `sudo tt eth1 throttle.yaml --delay 0.5`\r\n- some playbook (see below)\r\n\r\n### similar issues \r\nhttps://github.com/ansible/ansible/issues/72991\r\nhttps://github.com/ansible/ansible/issues/47255\r\nhttps://github.com/ansible/ansible/issues/79016\r\nhttps://github.com/ansible-collections/ansible.windows/issues/516\r\n\r\n### possible solution \r\n\r\nI am not familiar with WinRM, but I have created a solution that seems to work. \r\nhttps://github.com/ansible/ansible/compare/devel...ChristianGeiger3:ansible:bugfix/winrm_hang\r\n\r\nIf this could be a solution, can I create a PR?\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nwinrm.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.16.6]\r\n  config file = /home/vagrant/ansible.cfg\r\n  configured module search path = ['/home/vagrant/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/vagrant/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/vagrant/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/vagrant/.local/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCALLBACKS_ENABLED(/home/vagrant/ansible.cfg) = ['xxxx']\r\nCONFIG_FILE() = /home/vagrant/ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nhost: ubuntu 22.04 \r\ntarget: win10 \r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- name: Install\r\n  hosts: all\r\n\r\n  vars:\r\n    template_file_path: \"{{ run_directory_path }}/project/main.yaml\"\r\n  vars_files:\r\n    - \"{{ template_file_path }}\"\r\n\r\n  tasks:\r\n    # These variables comes from the installer\r\n    - name: Check variables from the installer\r\n      ansible.builtin.validate_argument_spec:\r\n        argument_spec: '{{required_data}}'\r\n      vars:\r\n        required_data:\r\n          # from download_component role\r\n          local_tmp_root_path:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The temporary root path. It is the path where the components temporary stored on the control node.\"\r\n\r\n          target_path:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The root path on the target, where components will be stored.\"\r\n\r\n\r\n          source_type:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The source type, where the content packages are stored.\"\r\n            choices: ['upack']\r\n\r\n          source_arg_0:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The first argument to be passed to the get_data plugin. This depends on the type of the get_data plugin selected by 'source_type' Upack-> ProGet api endpoint.\"\r\n          \r\n          source_arg_1:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The second argument to be passed to the get_data plugin. This depends on the type of the get_data plugin selected by 'source_type' Upack -> cache folder.\"\r\n          \r\n          # from install_component role\r\n          run_directory_path:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The path where ansible runner runs.\"\r\n\r\n          component_bundle_path:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The path to the component bundle. It is relative to the template.\"\r\n\r\n          # from ipc_password role\r\n          serial_number_machine:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The serial number of the machine. It is part of the id to save the password.\"\r\n          \r\n          password_service_url:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The url of the password service.\"\r\n\r\n          password_service_username:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The user name of the password service.\"\r\n\r\n          password_service_password:\r\n            type: \"str\"\r\n            required: true\r\n            description: \"The password of the password service.\"\r\n\r\n    # Check if template file exists and is not empty\r\n    - name: Check if template file exists\r\n      ansible.builtin.stat:\r\n        path: \"{{ template_file_path }}\"\r\n      register: template_file_stat_results\r\n      delegate_to: localhost\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nWhen an Task will not finish, an Timeout error should be thrown and ansible should finish\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook [core 2.16.6]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/vagrant/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/vagrant/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/vagrant/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/vagrant/.local/bin/ansible-playbook\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nLoading collection edna.installer from /home/vagrant/.ansible/collections/ansible_collections/edna/installer\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /home/vagrant/Documents/edna-installer-template-development/runner/inventory/hosts as it did not pass its verify_file() method\r\nscript declined parsing /home/vagrant/Documents/edna-installer-template-development/runner/inventory/hosts as it did not pass its verify_file() method\r\nauto declined parsing /home/vagrant/Documents/edna-installer-template-development/runner/inventory/hosts as it did not pass its verify_file() method\r\nParsed /home/vagrant/Documents/edna-installer-template-development/runner/inventory/hosts inventory source with yaml plugin\r\nrunning playbook inside collection edna.installer\r\nLoading collection ansible.windows from /home/vagrant/.ansible/collections/ansible_collections/ansible/windows\r\nLoading callback plugin default of type stdout, v2.0 from /home/vagrant/.local/lib/python3.10/site-packages/ansible/plugins/callback/default.py\r\nLoading callback plugin awx_display of type stdout, v2.0 from /usr/local/lib/python3.10/dist-packages/ansible_runner/display_callback/callback/awx_display.py\r\nAttempting to use 'awx_display' callback.\r\nSkipping callback 'awx_display', as we already have a stdout callback.\r\nAttempting to use 'default' callback.\r\nSkipping callback 'default', as we already have a stdout callback.\r\nAttempting to use 'junit' callback.\r\nAttempting to use 'minimal' callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nAttempting to use 'oneline' callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\nAttempting to use 'tree' callback.\r\n\r\nPLAYBOOK: start_installation.yaml **********************************************\r\nPositional arguments: edna.installer.start_installation\r\nverbosity: 6\r\nconnection: ssh\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/home/vagrant/Documents/yyyyyy/runner/inventory',)\r\nextra_vars: ('@/home/vagrant/Documents/yyyyy/runner/env/extravars',)\r\nforks: 5\r\n1 plays in /home/vagrant/.ansible/collections/ansible_collections/edna/installer/playbooks/start_installation.yaml\r\nRead vars_file '{{ template_file_path }}'\r\nRead vars_file '{{ template_file_path }}'\r\nRead vars_file '{{ template_file_path }}'\r\n\r\nPLAY [Install] *****************************************************************\r\nRead vars_file '{{ template_file_path }}'\r\n\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /home/vagrant/.ansible/collections/ansible_collections/edna/installer/playbooks/start_installation.yaml:2\r\nredirecting (type: modules) ansible.builtin.setup to ansible.windows.setup\r\nUsing module file /home/vagrant/.ansible/collections/ansible_collections/ansible/windows/plugins/modules/setup.ps1\r\nPipelining is enabled.\r\n<192.168.1.12> ESTABLISH WINRM CONNECTION FOR USER: vagrant on PORT 5986 TO 192.168.1.12\r\n<192.168.1.12> WINRM CONNECT: transport=ssl endpoint=https://192.168.1.12:5986/wsman\r\n<192.168.1.12> WINRM OPEN SHELL: 3B1566BE-788A-4B13-8538-DFB14D2AE53A\r\nEXEC (via pipeline wrapper)\r\n<192.168.1.12> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', 'xxxxxxx'\r\n[WARNING]: ERROR DURING WINRM SEND INPUT - attempting to recover:\r\nConnectionError ('Connection aborted.', TimeoutError('The write operation timed\r\nout'))\r\n.......\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-18T07:27:09Z",
        "user": "ChristianGeiger3",
        "labels": [
            "bug",
            "affects_2.16"
        ]
    },
    {
        "number": 83021,
        "title": "pkg_mgr.py looks in wrong directories for installp and dnf on AIX 7(.2)",
        "body": "### Summary\r\n\r\nHello!\r\n\r\nI was looking why the ansible_pkg_mgr fact was returned as \"unknown\" on my AIX 7.2 servers, event though I have, additional to the required bos.rte.install *1 (for installp) the DNF environment from the \"AIX Toolbox for Linux\" *2 installed:\r\n\r\n ) find /usr -name \"installp\" -ls 2>/dev/null\r\n \r\n      1130    740 -r-x------   1 root     system     755811 Aug 15  2023 **/usr/sbin/installp**\r\n      \r\n  )  find /opt/freeware/bin -name \"dnf*\" 2>/dev/null -ls\r\n  \r\n     5258      0 lrwxrwxrwx   1 root     system          5 Jun 20  2023 /opt/freeware/bin/dnf -> dnf-3\r\n     5411      4 -rwxr-xr-x   1 root     system       1960 Apr 28  2023 **/opt/freeware/bin/dnf-3**\r\n     5299      4 -rwxr-xr-x   1 root     system       1297 Apr 28  2023 /opt/freeware/bin/dnf-automatic\r\n     \r\n  ) lslpp -w /usr/sbin/installp\r\n  \r\n`File                                        Fileset               Type `\r\n`/usr/sbin/installp                          bos.rte.install       File`\r\n  \r\n *1: )  lslpp -L bos.rte.install\r\n \r\n `Fileset                      Level  State  Type  Description (Uninstaller)`\r\n`bos.rte.install          7.2.5.205    CE    F    LPP Install Commands`\r\n  \r\n ) rpm -qa|grep ^dnf\r\ndnf-automatic-4.2.17-32_51.ppc\r\ndnf-plugins-core-4.0.16-32_52.ppc\r\ndnf-data-4.2.17-32_51.ppc\r\ndnf-4.2.17-32_51.ppc\r\ndnf-utils-4.0.16-32_52.ppc\r\n\r\n*2: https://www.ibm.com/support/pages/node/6585774\r\n\r\nComparing this to https://github.com/ansible/ansible/blob/devel/lib/ansible/module_utils/facts/system/pkg_mgr.py :\r\n\r\nLine 23:\r\n            {'path': '**/usr/bin/dnf-3**', 'name': 'dnf'},\r\nLine 47:\r\n            {'path': '**/usr/bin/installp**', 'name': 'installp'},\r\n\r\nA workaround would be to `ln -s` the paths, but maybe this could be adapted to the \"correct\" AIX paths?\r\n\r\nThanks!\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npkg_mgr.py\r\n\r\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/module_utils/facts/system/pkg_mgr.py#L23\r\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/module_utils/facts/system/pkg_mgr.py#L47\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.13]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/freeware/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /usr/share/ansible/collections\r\n  executable location = /opt/freeware/bin/ansible.orig\r\n  python version = 3.9.19 (main, Apr  5 2024, 05:08:51) [GCC 10.3.0] (/opt/freeware/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto_legacy_silent\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nIBM AIX 7.2 TL 5 SP 7 (7200-05-07-2346)\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\ngather_facts: true\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n```console\r\n \"ansible_pkg_mgr\": \"installp\"\r\n```\r\n\\# or \r\n\r\n```console\r\n\"ansible_pkg_mgr\": \"dnf\"\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n\"ansible_pkg_mgr\": \"unknown\"\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-11T18:34:51Z",
        "user": "StevePOI",
        "labels": [
            "bug",
            "affects_2.14"
        ]
    },
    {
        "number": 83018,
        "title": "'reboot' module not working as expected: failure to setup for boot_time_command's execution gets treated as result of boot_time_command",
        "body": "### Summary\n\nTo verify that a reboot actually took place, the `ansible.builtin.reboot` module compares an initial output of `boot_time_command` (execution # 1) with successive ones (execution # 2, # 3, # 4, ...) and considers the host as rebooted the first time they differ to continue with post-reboot checks.\r\n\r\nIt however fails to correctly handle certain cases where setup for the execution of `boot_time_command` fails before even executing that command and interprets the output of that failure as the actual output of `boot_time_command` which consequently differ from a correct execution and mark the host as rebooted.\r\n\r\nFailure of setting up for the execution of `boot_time_command` is to be considered a normal case while the host is rebooting as various parts of the system no longer work as normal (filesystems get umounted, ...).\r\n\r\nA work around is to set `post_reboot_delay` with a \"high-enough\" value, but a safe threshold to be found varies with the speed at which a system properly shut downs.\r\n\r\nFor an end user, the result is similar to #78007: the module may completes and mark the host as successfully rebooted while it is in fact still rebooting, neither verifying if the reboots was indeed successful and possibly failing in the middle of following tasks.\r\n\r\nThe work around of #78007 does not work since `boot_time_commmand` is not even executed in our case. The associated PR was also rejected and doesn't look like it would solve this instance of the problem.\r\n\r\nThe issue can be reproduced about 50% of the time on a freshly installed debian12 systems running in a virtual machine on vmware and executing the `reboot` module as an adhoc command with the latest currently released version of ansible (2.16.5).\r\n\r\nWhile reproducing the issue may be difficult due to it possibly be a race condition, I encourage to understand the kind of error that get's generated in the attached exeuction and verify that this particular category of error is not treated as such by the current source code and rather as the normal execution of `boot_time_command`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.reboot\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.5]\r\n  config file = None\r\n  configured module search path = ['/home/shk3bq4d/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/shk3bq4d/.virtualenvs/ansible-latest/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/shk3bq4d/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/shk3bq4d/.virtualenvs/ansible-latest/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/home/shk3bq4d/.virtualenvs/ansible-latest/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\nCOLLECTIONS_PATHS(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans']\r\nCONFIG_FILE() = /home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg\r\nDEFAULT_ACTION_PLUGIN_PATH(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/actions', '/home/shk3bq4d/git/myotherproject/myproject-master/ans/actions-external']\r\nDEFAULT_FILTER_PLUGIN_PATH(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/filter_plugins']\r\nDEFAULT_FORKS(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = 18\r\nDEFAULT_HOST_LIST(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/inventory.yml']\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = True\r\nDEFAULT_MODULE_PATH(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/modules-external/ansible-graylog-modules/plugins/modules']\r\nDEFAULT_MODULE_UTILS_PATH(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/modules-external/ansible-graylog-modules/module_utils']\r\nDEFAULT_ROLES_PATH(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = ['/home/shk3bq4d/git/myotherproject/myproject-master/ans/roles', '/home/shk3bq4d/git/myotherproject/myproject-master/ans/roles-external']\r\nDEFAULT_STDOUT_CALLBACK(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = yaml\r\nDEFAULT_TIMEOUT(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = 8\r\nEDITOR(env: EDITOR) = vim\r\nINVENTORY_UNPARSED_IS_FAILED(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = True\r\nPAGER(env: PAGER) = less\r\nUSE_PERSISTENT_CONNECTIONS(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = True\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nssh_args(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=3600s -o ControlPath=~/.ssh/c/%h_%r_%p\r\ntimeout(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = 8\r\nuse_persistent_connections(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = True\r\n\r\nssh:\r\n___\r\nssh_args(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=3600s -o ControlPath=~/.ssh/c/%h_%r_%p\r\ntimeout(/home/shk3bq4d/git/myotherproject/myproject-master/ans/ansible.cfg) = 8\n```\n\n\n### OS / Environment\n\ncontroller: ubuntu 22.04\r\ntarget host: debian12\n\n### Steps to Reproduce\n\n```sh\r\nansible -bm reboot -vvvvvvvvvv debian12-image.mydomain\r\n```\n\n### Expected Results\n\n* elapsed time can't be 5, but more like 30-35\r\n* line 226 contains `cb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n` which is the first execution of `cat /proc/sys/kernel/random/boot_id` which is the default value of boot_time_command\r\n* line 294 is execution of the shutdown command\r\n* lines 308 and 320 are successful execution of `boot_time_command` # 2 and # 3\r\n* line 332 contains `Could not chdir to home directory /home/automation: No such file or directory\\r\\ncb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n` which is a mixup of the error generated by setting up the execution of `boot_time_command`'s # 4 and its own output. Due to the race conditions getting involved, we have seen multiple kind of errors messages. In this particular instance, we may speculate that /home had been unmounted and as such /home/automation no longer existed. We have been able to reproduce similar errors even if changing `remote_tmp` in `ansible.cfg`.\r\n* line 333 acknowledges that the module considers the host as already rebooted\r\n  \r\n Note:\r\n This is our partition table for full disclosure\r\n ```\r\n mount | grep vg\r\n /dev/mapper/vgroot-lvroot on / type ext4 (rw,relatime,seclabel,errors=remount-ro)\r\n/dev/mapper/vgroot-lvhome on /home type ext4 (rw,nodev,relatime,seclabel)\r\n/dev/mapper/vgroot-lvopt on /opt type ext4 (rw,nodev,relatime,seclabel)\r\n/dev/mapper/vgroot-lvvar on /var type ext4 (rw,relatime,seclabel)\r\n/dev/mapper/vgroot-lvtmp on /tmp type ext4 (rw,nosuid,nodev,relatime,seclabel)\r\n/dev/mapper/vgroot-lvvarlog on /var/log type ext4 (rw,nosuid,nodev,noexec,relatime,seclabel)\r\n/dev/mapper/vgroot-lvvartmp on /var/tmp type ext4 (rw,nosuid,nodev,noexec,relatime,seclabel)\r\n/dev/mapper/vgroot-lvvarlogaudit on /var/log/audit type ext4 (rw,nosuid,nodev,noexec,relatime,seclabel)\r\n```\n\n### Actual Results\n\n```console\nansible [core 2.16.5]\r\n  config file = /home/shk3bq4d/git/myotherproject/myproject/ans/ansible.cfg\r\n  configured module search path = ['/home/shk3bq4d/git/myotherproject/myproject/ans/modules-external/ansible-graylog-modules/plugins/modules']\r\n  ansible python module location = /home/shk3bq4d/.virtualenvs/ansible-latest/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/shk3bq4d/git/myotherproject/myproject/ans\r\n  executable location = /home/shk3bq4d/.virtualenvs/ansible-latest/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/home/shk3bq4d/.virtualenvs/ansible-latest/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\nUsing /home/shk3bq4d/git/myotherproject/myproject/ans/ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from\r\nhost_list declined parsing /home/shk3bq4d/git/myotherproject/myproject/ans/inventory.yml as it did not pass its verify_file() method\r\nscript declined parsing /home/shk3bq4d/git/myotherproject/myproject/ans/inventory.yml as it did not pass its verify_file() method\r\nParsed /home/shk3bq4d/git/myotherproject/myproject/ans/inventory.yml inventory source with yaml plugin\r\nredirecting (type: callback) ansible.builtin.yaml to community.general.yaml\r\nLoading collection community.general from /home/shk3bq4d/git/myotherproject/myproject/ans/ansible_collections/community/general\r\nredirecting (type: callback) ansible.builtin.yaml to community.general.yaml\r\nLoading callback plugin community.general.yaml of type stdout, v2.0 from /home/shk3bq4d/git/myotherproject/myproject/ans/ansible_collections/community/general/plugins/callback/yaml.py\r\nAttempting to use 'default' callback.\r\nSkipping callback 'default', as we already have a stdout callback.\r\nAttempting to use 'junit' callback.\r\nAttempting to use 'minimal' callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nAttempting to use 'oneline' callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\nAttempting to use 'tree' callback.\r\n\r\nPLAYBOOK: __adhoc_playbook__ ***************************************************\r\nPositional arguments: d e b i a n 1 2 - i m a g e . m y d o m a i n\r\nverbosity: 10\r\nbecome: True\r\nbecome_method: sudo\r\ninventory: ('/home/shk3bq4d/git/myotherproject/myproject/ans/inventory.yml',)\r\npoll_interval: 15\r\nconnection: ssh\r\nforks: 18\r\nmodule_name: reboot\r\n\r\nPLAY [Ansible Ad-Hoc] **********************************************************\r\n\r\nTASK [reboot] ******************************************************************\r\nMerge variables with suffix: _ansible_ssh_extra_args__to_merge\r\nThe following variables will be merged: ['all_ansible_ssh_extra_args__to_merge']\r\nLoading collection ansible.utils from /home/shk3bq4d/.virtualenvs/ansible-latest/lib/python3.10/site-packages/ansible_collections/ansible/utils\r\nMerge variables with suffix: _ansible_ssh_extra_args__to_merge\r\nThe following variables will be merged: ['all_ansible_ssh_extra_args__to_merge']\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'echo ~automation && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'/home/automation\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/automation/.ansible/tmp `\"&& mkdir \"` echo /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354 `\" && echo ansible-tmp-1712823989.226468-599523-140907275976354=\"` echo /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354 `\" ) && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'ansible-tmp-1712823989.226468-599523-140907275976354=/home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nIncluding module_utils file ansible/__init__.py\r\nIncluding module_utils file ansible/module_utils/__init__.py\r\nIncluding module_utils file ansible/module_utils/basic.py\r\nIncluding module_utils file ansible/module_utils/_text.py\r\nIncluding module_utils file ansible/module_utils/common/_json_compat.py\r\nIncluding module_utils file ansible/module_utils/common/__init__.py\r\nIncluding module_utils file ansible/module_utils/common/_utils.py\r\nIncluding module_utils file ansible/module_utils/common/arg_spec.py\r\nIncluding module_utils file ansible/module_utils/common/file.py\r\nIncluding module_utils file ansible/module_utils/common/locale.py\r\nIncluding module_utils file ansible/module_utils/common/parameters.py\r\nIncluding module_utils file ansible/module_utils/common/collections.py\r\nIncluding module_utils file ansible/module_utils/common/process.py\r\nIncluding module_utils file ansible/module_utils/common/sys_info.py\r\nIncluding module_utils file ansible/module_utils/common/text/converters.py\r\nIncluding module_utils file ansible/module_utils/common/text/__init__.py\r\nIncluding module_utils file ansible/module_utils/common/text/formatters.py\r\nIncluding module_utils file ansible/module_utils/common/validation.py\r\nIncluding module_utils file ansible/module_utils/common/warnings.py\r\nIncluding module_utils file ansible/module_utils/compat/selectors.py\r\nIncluding module_utils file ansible/module_utils/compat/__init__.py\r\nIncluding module_utils file ansible/module_utils/compat/_selectors2.py\r\nIncluding module_utils file ansible/module_utils/compat/selinux.py\r\nIncluding module_utils file ansible/module_utils/distro/__init__.py\r\nIncluding module_utils file ansible/module_utils/distro/_distro.py\r\nIncluding module_utils file ansible/module_utils/errors.py\r\nIncluding module_utils file ansible/module_utils/facts/ansible_collector.py\r\nIncluding module_utils file ansible/module_utils/compat/typing.py\r\nIncluding module_utils file ansible/module_utils/facts/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/collector.py\r\nIncluding module_utils file ansible/module_utils/facts/compat.py\r\nIncluding module_utils file ansible/module_utils/facts/default_collectors.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/aix.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/base.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/darwin.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/dragonfly.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/freebsd.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/hpux.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/hurd.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/linux.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/netbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/openbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/hardware/sunos.py\r\nIncluding module_utils file ansible/module_utils/facts/namespace.py\r\nIncluding module_utils file ansible/module_utils/facts/network/aix.py\r\nIncluding module_utils file ansible/module_utils/facts/network/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/network/base.py\r\nIncluding module_utils file ansible/module_utils/facts/network/darwin.py\r\nIncluding module_utils file ansible/module_utils/facts/network/dragonfly.py\r\nIncluding module_utils file ansible/module_utils/facts/network/fc_wwn.py\r\nIncluding module_utils file ansible/module_utils/facts/network/freebsd.py\r\nIncluding module_utils file ansible/module_utils/facts/network/generic_bsd.py\r\nIncluding module_utils file ansible/module_utils/facts/network/hpux.py\r\nIncluding module_utils file ansible/module_utils/facts/network/hurd.py\r\nIncluding module_utils file ansible/module_utils/facts/network/iscsi.py\r\nIncluding module_utils file ansible/module_utils/facts/network/linux.py\r\nIncluding module_utils file ansible/module_utils/facts/network/netbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/network/nvme.py\r\nIncluding module_utils file ansible/module_utils/facts/network/openbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/network/sunos.py\r\nIncluding module_utils file ansible/module_utils/facts/other/facter.py\r\nIncluding module_utils file ansible/module_utils/facts/other/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/other/ohai.py\r\nIncluding module_utils file ansible/module_utils/facts/sysctl.py\r\nIncluding module_utils file ansible/module_utils/facts/system/apparmor.py\r\nIncluding module_utils file ansible/module_utils/facts/system/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/system/caps.py\r\nIncluding module_utils file ansible/module_utils/facts/system/chroot.py\r\nIncluding module_utils file ansible/module_utils/facts/system/cmdline.py\r\nIncluding module_utils file ansible/module_utils/facts/system/date_time.py\r\nIncluding module_utils file ansible/module_utils/compat/datetime.py\r\nIncluding module_utils file ansible/module_utils/facts/system/distribution.py\r\nIncluding module_utils file ansible/module_utils/facts/system/dns.py\r\nIncluding module_utils file ansible/module_utils/facts/system/env.py\r\nIncluding module_utils file ansible/module_utils/facts/system/fips.py\r\nIncluding module_utils file ansible/module_utils/facts/system/loadavg.py\r\nIncluding module_utils file ansible/module_utils/facts/system/local.py\r\nIncluding module_utils file ansible/module_utils/facts/system/lsb.py\r\nIncluding module_utils file ansible/module_utils/facts/system/pkg_mgr.py\r\nIncluding module_utils file ansible/module_utils/facts/system/platform.py\r\nIncluding module_utils file ansible/module_utils/facts/system/python.py\r\nIncluding module_utils file ansible/module_utils/facts/system/selinux.py\r\nIncluding module_utils file ansible/module_utils/facts/system/service_mgr.py\r\nIncluding module_utils file ansible/module_utils/compat/version.py\r\nIncluding module_utils file ansible/module_utils/facts/system/ssh_pub_keys.py\r\nIncluding module_utils file ansible/module_utils/facts/system/user.py\r\nIncluding module_utils file ansible/module_utils/facts/timeout.py\r\nIncluding module_utils file ansible/module_utils/facts/utils.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/base.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/__init__.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/dragonfly.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/freebsd.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/hpux.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/linux.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/netbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/openbsd.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/sunos.py\r\nIncluding module_utils file ansible/module_utils/facts/virtual/sysctl.py\r\nIncluding module_utils file ansible/module_utils/parsing/convert_bool.py\r\nIncluding module_utils file ansible/module_utils/parsing/__init__.py\r\nIncluding module_utils file ansible/module_utils/pycompat24.py\r\nIncluding module_utils file ansible/module_utils/six/__init__.py\r\n<debian12-image.mydomain> Attempting python interpreter discovery\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.12'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.11'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.10'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.9'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.8'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python3.11\\n/usr/bin/python3\\nENDFOUND\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'/usr/bin/python3.11 && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'{\"platform_dist_result\": [], \"osrelease_content\": \"PRETTY_NAME=\\\\\"Debian GNU/Linux 12 (bookworm)\\\\\"\\\\nNAME=\\\\\"Debian GNU/Linux\\\\\"\\\\nVERSION_ID=\\\\\"12\\\\\"\\\\nVERSION=\\\\\"12 (bookworm)\\\\\"\\\\nVERSION_CODENAME=bookworm\\\\nID=debian\\\\nHOME_URL=\\\\\"https://www.debian.org/\\\\\"\\\\nSUPPORT_URL=\\\\\"https://www.debian.org/support\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.debian.org/\\\\\"\\\\n\"}\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nUsing module file /home/shk3bq4d/.virtualenvs/ansible-latest/lib/python3.10/site-packages/ansible/modules/setup.py\r\n<10.2.1.6> PUT /home/shk3bq4d/.ansible/tmp/ansible-local-599520jlnnj9o1/tmpmhmex9e7 TO /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_setup.py\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set sftp_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no '[10.2.1.6]'\r\n<10.2.1.6> (0, b'sftp> put /home/shk3bq4d/.ansible/tmp/ansible-local-599520jlnnj9o1/tmpmhmex9e7 /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_setup.py\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'chmod u+x /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/ /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-oibnruilkwddbhmroibfijqoyvlhflbf ; /usr/bin/python3 /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_setup.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'\\r\\n{\"ansible_facts\": {\"ansible_distribution\": \"Debian\", \"ansible_distribution_release\": \"bookworm\", \"ansible_distribution_version\": \"12.5\", \"ansible_distribution_major_version\": \"12\", \"ansible_distribution_file_path\": \"/etc/os-release\", \"ansible_distribution_file_variety\": \"Debian\", \"ansible_distribution_file_parsed\": true, \"ansible_distribution_minor_version\": \"5\", \"ansible_os_family\": \"Debian\", \"ansible_local\": {}, \"ansible_selinux_python_present\": true, \"ansible_selinux\": {\"status\": \"enabled\", \"policyvers\": 33, \"config_mode\": \"permissive\", \"mode\": \"permissive\", \"type\": \"default\"}, \"ansible_date_time\": {\"year\": \"2024\", \"month\": \"04\", \"weekday\": \"Thursday\", \"weekday_number\": \"4\", \"weeknumber\": \"15\", \"day\": \"11\", \"hour\": \"08\", \"minute\": \"26\", \"second\": \"31\", \"epoch\": \"1712823991\", \"epoch_int\": \"1712823991\", \"date\": \"2024-04-11\", \"time\": \"08:26:31\", \"iso8601_micro\": \"2024-04-11T08:26:31.225339Z\", \"iso8601\": \"2024-04-11T08:26:31Z\", \"iso8601_basic\": \"20240411T082631225339\", \"iso8601_basic_short\": \"20240411T082631\", \"tz\": \"UTC\", \"tz_dst\": \"UTC\", \"tz_offset\": \"+0000\"}, \"ansible_system_capabilities_enforced\": \"False\", \"ansible_system_capabilities\": [], \"ansible_fips\": false, \"ansible_dns\": {\"nameservers\": [\"10.8.2.1\", \"10.9.2.1\"]}, \"ansible_user_id\": \"root\", \"ansible_user_uid\": 0, \"ansible_user_gid\": 0, \"ansible_user_gecos\": \"root\", \"ansible_user_dir\": \"/root\", \"ansible_user_shell\": \"/bin/bash\", \"ansible_real_user_id\": 0, \"ansible_effective_user_id\": 0, \"ansible_real_group_id\": 0, \"ansible_effective_group_id\": 0, \"ansible_apparmor\": {\"status\": \"disabled\"}, \"ansible_system\": \"Linux\", \"ansible_kernel\": \"6.1.0-18-amd64\", \"ansible_kernel_version\": \"#1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01)\", \"ansible_machine\": \"x86_64\", \"ansible_python_version\": \"3.11.2\", \"ansible_fqdn\": \"localhost\", \"ansible_hostname\": \"localhost\", \"ansible_nodename\": \"localhost\", \"ansible_domain\": \"\", \"ansible_userspace_bits\": \"64\", \"ansible_architecture\": \"x86_64\", \"ansible_userspace_architecture\": \"x86_64\", \"ansible_machine_id\": \"d8260323ccb24ffdbe9620c18a1b4b33\", \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBALjEcfIRhH0DPlVnbiw8pwC0Hrp0zINEOS+3apnuIwUabpMY4N9SkPGL4EjiaDy+mAeLj598BK7LvAzoZudDVQ7LYI3YooChC9TNtewt6DMI7cjWzb7XqJRmKGnfgEE7U9HLqlimhTBfsOk7jnkG3AfYK009EtlUxgovbxSJN21HAAAAFQCz/4hQ7pYkkRMZ4w2hQiwGOkfTUwAAAIAK0tT5FPDCZl1Ey1GAQAby6XUjLhjabMwn3D+usx5z0JtyRVs5EBo7v+tw7G4jnf6F+CZ4jLSCSZ4QKVeRiUgm9ZQhugZEkpHxnqByGHw5JQd3/+C3uecIKD+4Prtv8gtA26iTuGV6kn/F5OE2qsEsCKjxGShS7+c+Lb05bPSK3gAAAIEAnayEtfH6zokr1D54LoGT94EoX3KSfDGFyh3H13Dj3MchsmxT6svUN9bF17u/DUdvvFx33o3F7RWvg9iBSetZ0XHKyF9daPOCT/5gbi9rdwz4vkF442jvphwTXwxfivf+xFomRyxy3nVVbpwqhwLjB9+N82Q8WQXWcVky3S1AAzA=\", \"ansible_ssh_host_key_dsa_public_keytype\": \"ssh-dss\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABgQCo5OcAgqytuJ+WwIvq380F2c/5YREcRjnkYtFahbGGLrEc8EKlLmRuHHOihqa20hvq/qDPbR/bvocL3HvXQZRiTQj8IgRXFdVL9ZkdPBFcJ2ZZllR7vORCt0SQU5uWzQ6LCVIju7jOWMr+B9dFAyXhNR/unRO2FVOhe9ZxMh0YrLVc1Ni3D8sMXj1oyOY7Hwte6Iu0NtI9/oUGebCMUTanjZq2AqIikMUuOD0EecENZfAnnPtr6CZu0p744DMoVVlkaHRj5GzQ5ij996vFUlZFj4uwlKoSNDD8eWtZqN3unN+Kpwrke7SfXSGI0lreYNwHGUFuKYdyXcA6l+v9epPM8iPg8CUryWjNHBIWZpBQMt/Ez6diCMNeNVRIl+tn9wzaAMtOr7oV/5pfsY+LPrbpbxB4wtc6cJj2o/ol+pUK48lU2vN3WHweY7OADm5umWaj+SkWbs1j2ZSdski3G9sK633KWUT63BN0h0tR61jfpGkg7UKf/JZuDAZr5o1lwI0=\", \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIxaFd/duQxIZBLQc5g7VYQs773nJpVzSqOWZseKLM5R8YLpgX5x2ineXqso3BPTSJQgqCddyoy/8iZbqv3lBGU=\", \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAIDi+ADi+fxA+V7Uu+od6CDETdahnJNOSHsScW6ush8om\", \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_python\": {\"version\": {\"major\": 3, \"minor\": 11, \"micro\": 2, \"releaselevel\": \"final\", \"serial\": 0}, \"version_info\": [3, 11, 2, \"final\", 0], \"executable\": \"/usr/bin/python3\", \"has_sslcontext\": true, \"type\": \"cpython\"}, \"ansible_lsb\": {\"id\": \"Debian\", \"description\": \"Debian GNU/Linux 12 (bookworm)\", \"release\": \"12\", \"codename\": \"bookworm\", \"major_release\": \"12\"}, \"ansible_pkg_mgr\": \"apt\", \"ansible_service_mgr\": \"systemd\", \"ansible_cmdline\": {\"BOOT_IMAGE\": \"/vmlinuz-6.1.0-18-amd64\", \"root\": \"/dev/mapper/vgroot-lvroot\", \"ro\": true, \"security\": \"selinux\", \"ipv6.disable\": \"1\", \"quiet\": true}, \"ansible_proc_cmdline\": {\"BOOT_IMAGE\": \"/vmlinuz-6.1.0-18-amd64\", \"root\": \"/dev/mapper/vgroot-lvroot\", \"ro\": true, \"security\": \"selinux\", \"ipv6.disable\": \"1\", \"quiet\": true}, \"ansible_env\": {\"SUDO_GID\": \"7053\", \"MAIL\": \"/var/mail/root\", \"USER\": \"root\", \"HOME\": \"/root\", \"SUDO_UID\": \"7053\", \"LOGNAME\": \"root\", \"TERM\": \"xterm-256color\", \"PATH\": \"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\", \"LANG\": \"en_US.UTF-8\", \"SUDO_COMMAND\": \"/bin/sh -c echo BECOME-SUCCESS-oibnruilkwddbhmroibfijqoyvlhflbf ; /usr/bin/python3 /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_setup.py\", \"SHELL\": \"/bin/bash\", \"SUDO_USER\": \"automation\", \"PWD\": \"/home/automation\"}, \"gather_subset\": [\"min\"], \"module_setup\": true}, \"invocation\": {\"module_args\": {\"gather_subset\": [\"min\"], \"gather_timeout\": 10, \"filter\": [], \"fact_path\": \"/etc/ansible/facts.d\"}}}\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-gadpdtstjjsfgyqxiksoemmmkwtvihaa ; cat /proc/sys/kernel/random/boot_id'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'cb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nIncluding module_utils file ansible/__init__.py\r\nIncluding module_utils file ansible/module_utils/__init__.py\r\nIncluding module_utils file ansible/module_utils/basic.py\r\nIncluding module_utils file ansible/module_utils/_text.py\r\nIncluding module_utils file ansible/module_utils/common/_json_compat.py\r\nIncluding module_utils file ansible/module_utils/common/__init__.py\r\nIncluding module_utils file ansible/module_utils/common/_utils.py\r\nIncluding module_utils file ansible/module_utils/common/arg_spec.py\r\nIncluding module_utils file ansible/module_utils/common/file.py\r\nIncluding module_utils file ansible/module_utils/common/locale.py\r\nIncluding module_utils file ansible/module_utils/common/parameters.py\r\nIncluding module_utils file ansible/module_utils/common/collections.py\r\nIncluding module_utils file ansible/module_utils/common/process.py\r\nIncluding module_utils file ansible/module_utils/common/sys_info.py\r\nIncluding module_utils file ansible/module_utils/common/text/converters.py\r\nIncluding module_utils file ansible/module_utils/common/text/__init__.py\r\nIncluding module_utils file ansible/module_utils/common/text/formatters.py\r\nIncluding module_utils file ansible/module_utils/common/validation.py\r\nIncluding module_utils file ansible/module_utils/common/warnings.py\r\nIncluding module_utils file ansible/module_utils/compat/selectors.py\r\nIncluding module_utils file ansible/module_utils/compat/__init__.py\r\nIncluding module_utils file ansible/module_utils/compat/_selectors2.py\r\nIncluding module_utils file ansible/module_utils/compat/selinux.py\r\nIncluding module_utils file ansible/module_utils/distro/__init__.py\r\nIncluding module_utils file ansible/module_utils/distro/_distro.py\r\nIncluding module_utils file ansible/module_utils/errors.py\r\nIncluding module_utils file ansible/module_utils/parsing/convert_bool.py\r\nIncluding module_utils file ansible/module_utils/parsing/__init__.py\r\nIncluding module_utils file ansible/module_utils/pycompat24.py\r\nIncluding module_utils file ansible/module_utils/six/__init__.py\r\nUsing module file /home/shk3bq4d/.virtualenvs/ansible-latest/lib/python3.10/site-packages/ansible/modules/find.py\r\n<10.2.1.6> PUT /home/shk3bq4d/.ansible/tmp/ansible-local-599520jlnnj9o1/tmp46b3pnd9 TO /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_find.py\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set sftp_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no '[10.2.1.6]'\r\n<10.2.1.6> (0, b'sftp> put /home/shk3bq4d/.ansible/tmp/ansible-local-599520jlnnj9o1/tmp46b3pnd9 /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_find.py\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'chmod u+x /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/ /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_find.py && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-qhplcifveevqagonjtmuodsyavaihwac ; /usr/bin/python3 /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/AnsiballZ_find.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'\\r\\n{\"files\": [{\"path\": \"/sbin/shutdown\", \"mode\": \"0777\", \"isdir\": false, \"ischr\": false, \"isblk\": false, \"isreg\": false, \"isfifo\": false, \"islnk\": true, \"issock\": false, \"uid\": 0, \"gid\": 0, \"size\": 14, \"inode\": 395601, \"dev\": 65024, \"nlink\": 1, \"atime\": 1712773804.2942214, \"mtime\": 1706305716.0, \"ctime\": 1712772945.7159996, \"gr_name\": \"root\", \"pw_name\": \"root\", \"wusr\": true, \"rusr\": true, \"xusr\": true, \"wgrp\": true, \"rgrp\": true, \"xgrp\": true, \"woth\": true, \"roth\": true, \"xoth\": true, \"isuid\": false, \"isgid\": false}, {\"path\": \"/usr/sbin/shutdown\", \"mode\": \"0777\", \"isdir\": false, \"ischr\": false, \"isblk\": false, \"isreg\": false, \"isfifo\": false, \"islnk\": true, \"issock\": false, \"uid\": 0, \"gid\": 0, \"size\": 14, \"inode\": 395601, \"dev\": 65024, \"nlink\": 1, \"atime\": 1712773804.2942214, \"mtime\": 1706305716.0, \"ctime\": 1712772945.7159996, \"gr_name\": \"root\", \"pw_name\": \"root\", \"wusr\": true, \"rusr\": true, \"xusr\": true, \"wgrp\": true, \"rgrp\": true, \"xgrp\": true, \"woth\": true, \"roth\": true, \"xoth\": true, \"isuid\": false, \"isgid\": false}], \"changed\": false, \"msg\": \"All paths examined\", \"matched\": 2, \"examined\": 2058, \"skipped_paths\": {}, \"invocation\": {\"module_args\": {\"paths\": [\"/sbin\", \"/bin\", \"/usr/sbin\", \"/usr/bin\", \"/usr/local/sbin\"], \"patterns\": [\"shutdown\"], \"file_type\": \"any\", \"read_whole_file\": false, \"age_stamp\": \"mtime\", \"recurse\": false, \"hidden\": false, \"follow\": false, \"get_checksum\": false, \"use_regex\": false, \"exact_mode\": true, \"excludes\": null, \"contains\": null, \"age\": null, \"size\": null, \"depth\": null, \"mode\": null}}}\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: rebooting server...\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-fgxbnllajzhtepxmakhkrjugxwxvdkwm ; /sbin/shutdown -r 0 \"Reboot initiated by Ansible\"'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b\"Reboot scheduled for Thu 2024-04-11 08:26:32 UTC, use 'shutdown -c' to cancel.\\r\\r\\n\", b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: validating reboot\r\nreboot: attempting to get system boot time\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-nvymqkznhorvconcyqxlusbsmnwbomub ; cat /proc/sys/kernel/random/boot_id'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'cb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: last boot time check fail 'boot time has not changed', retrying in 1.7250 seconds...\r\nreboot: attempting to get system boot time\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-iinnsimfvcsirskrbducjgkauuiuekit ; cat /proc/sys/kernel/random/boot_id'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'cb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: last boot time check fail 'boot time has not changed', retrying in 2.6180 seconds...\r\nreboot: attempting to get system boot time\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-fojflfozsjntdodrgempmvsqngjwzdcs ; cat /proc/sys/kernel/random/boot_id'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'Could not chdir to home directory /home/automation: No such file or directory\\r\\ncb8d4303-f662-496a-b5de-df2a4ac85da7\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: attempting post-reboot test command\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no -tt 10.2.1.6 '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-viwdyiuphreetwczidqvcowwwmgascxv ; whoami'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<10.2.1.6> (0, b'Could not chdir to home directory /home/automation: No such file or directory\\r\\nroot\\r\\n', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nreboot: system successfully rebooted\r\n<10.2.1.6> ESTABLISH SSH CONNECTION FOR USER: automation\r\n<10.2.1.6> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=3600s)(-o)(ControlPath=~/.ssh/c/%h_%r_%p)\r\n<10.2.1.6> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<10.2.1.6> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"automation\")\r\n<10.2.1.6> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=8)\r\n<10.2.1.6> SSH: Set ssh_common_args: ()\r\n<10.2.1.6> SSH: Set ssh_extra_args: (-F)(/home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config)(-o)(ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain)(-o)(StrictHostKeyChecking=no)\r\n<10.2.1.6> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=3600s -o 'ControlPath=~/.ssh/c/%h_%r_%p' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"automation\"' -o ConnectTimeout=8 -F /home/shk3bq4d/git/myotherproject/myproject/ans/group_vars/ssh_config -o 'ProxyCommand=ssh -W %h:%p -p 22 -o ControlMaster=auto -o ControlPersist=30s -o ControlPath=~/.ssh/c/nmrud.mydomain_automation_22 -o StrictHostKeyChecking=no automation@nmrud.mydomain' -o StrictHostKeyChecking=no 10.2.1.6 '/bin/sh -c '\"'\"'rm -f -r /home/automation/.ansible/tmp/ansible-tmp-1712823989.226468-599523-140907275976354/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<10.2.1.6> (0, b'', b'OpenSSH_8.9p1 Ubuntu-3ubuntu0.6, OpenSSL 3.0.2 15 Mar 2022\\r\\ndebug1: Truncating as irrelevant\\r\\n')\r\nchanged: [debian12-image.mydomain] => changed=true\r\n  elapsed: 5\r\n  rebooted: true\r\n\r\nPLAY RECAP *********************************************************************\r\ndebian12-image.mydomain : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-11T12:01:45Z",
        "user": "shk3bq4d",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82984,
        "title": "Variable `services` set by ansible.builtin.service_facts",
        "body": "### Summary\r\n\r\nI've on several occasions run into a strange issue involving the variable `services` and the `ansible.builtin.service_facts` module. When ever I gather service facts, the variable `services` is set. This has, in a role that I use (developed in-house) caused all sorts of issues as it's not expected that `services` should be set by anything other than the role.\r\n\r\nAfter racking my head about it, I came across the ` inject_facts_as_vars` Ansible configuration setting, and read that by default all `ansible_facts` dictionaries are exposed to the global namespace. When I disable it, the `services` variable is no longer set by calling `ansible.builtin.service_facts`.\r\n\r\nGiven the documentation of `inject_facts_as_vars`, I would expect the `ansible_facts.services` dictionary to be exposed/injected as `ansible_services`, but this is not the case!\r\n\r\n#### Edit 1\r\n\r\nI guess this might be related to https://github.com/ansible/ansible/issues/74060\r\n\r\n### Issue Type\r\n\r\n~Bug  Report~\r\nDocs Issue\r\n\r\n### Component Name\r\n\r\nfeature\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.5]\r\n  config file = <some project path>/ansible.cfg\r\n  configured module search path = ['<some project path>/library']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = <some project path>/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.8 (main, Feb 12 2024, 14:50:05) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS(<some project path>/ansible.cfg) = True\r\nANY_ERRORS_FATAL(<some project path>/ansible.cfg) = True\r\nCACHE_PLUGIN(<some project path>/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(<some project path>/ansible.cfg) = /tmp/facts_cache\r\nCACHE_PLUGIN_TIMEOUT(<some project path>/ansible.cfg) = 86400\r\nCALLBACKS_ENABLED(<some project path>/ansible.cfg) = ['ansible.posix.profile_tasks', 'community.general.counter_enabled']\r\nCOLLECTIONS_PATHS(<some project path>/ansible.cfg) = ['<some project path>/collections']\r\nCONFIG_FILE() = <some project path>/ansible.cfg\r\nDEFAULT_FORKS(<some project path>/ansible.cfg) = 5\r\nDEFAULT_GATHERING(<some project path>/ansible.cfg) = smart\r\nDEFAULT_JINJA2_NATIVE(<some project path>/ansible.cfg) = True\r\nDEFAULT_MANAGED_STR(<some project path>/ansible.cfg) = Ansible managed template: {file}\r\nDEFAULT_MODULE_PATH(<some project path>/ansible.cfg) = ['<some project path>/library']\r\nDEFAULT_ROLES_PATH(<some project path>/ansible.cfg) = ['<some project path>/roles']\r\nDEFAULT_STDOUT_CALLBACK(<some project path>/ansible.cfg) = ansible.builtin.default\r\nDEFAULT_TIMEOUT(<some project path>/ansible.cfg) = 60\r\nDEFAULT_VAULT_PASSWORD_FILE(<some project path>/ansible.cfg) = <some project path>/defaults/vault/vault_hpce_password.sh\r\nDEPRECATION_WARNINGS(<some project path>/ansible.cfg) = False\r\nDISPLAY_SKIPPED_HOSTS(<some project path>/ansible.cfg) = False\r\nEDITOR(env: EDITOR) = /usr/bin/vim\r\nHOST_KEY_CHECKING(<some project path>/ansible.cfg) = False\r\nINVENTORY_ENABLED(<some project path>/ansible.cfg) = ['yaml', 'ini', 'kubernetes.core.k8s']\r\nINVENTORY_IGNORE_EXTS(<some project path>/ansible.cfg) = ['~', '.orig', '.bak', '.ini', '.cfg', '.retry', '.pyc', '.pyo', '.creds', '.gpg']\r\nINVENTORY_IGNORE_PATTERNS(<some project path>/ansible.cfg) = ['artifacts', 'credentials']\r\nTRANSFORM_INVALID_GROUP_CHARS(<some project path>/ansible.cfg) = ignore\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(<some project path>/ansible.cfg) = 86400\r\n_uri(<some project path>/ansible.cfg) = /tmp/facts_cache\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\ndisplay_skipped_hosts(<some project path>/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(<some project path>/ansible.cfg) = False\r\ntimeout(<some project path>/ansible.cfg) = 60\r\n\r\nssh:\r\n___\r\nhost_key_checking(<some project path>/ansible.cfg) = False\r\npipelining(<some project path>/ansible.cfg) = True\r\ntimeout(<some project path>/ansible.cfg) = 60\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nArchLinux\r\n\r\n### Steps to Reproduce\r\n\r\nIf I call the `ansible.builtin.service_facts` module, I expect that `ansible_facts.services` should be filled. As per my understanding of the documentation regarding [`INJECT_FACTS_AS_VARS`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#inject-facts-as-vars), the `ansible_facts` fields should be exposed to the global namespace but with `ansible_` text prefixed to it, e.g. `ansible_services`.\r\n\r\n```sh\r\nansible -m service_facts localhost\r\nansible -m debug -a 'var=services' localhost\r\nansible -m debug -a 'var=ansible_services' localhost\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nThe variable `services` should not be set, and show the following:\r\n\r\n```\r\nlocalhost | SUCCESS => {\r\n    \"services\": \"VARIABLE IS NOT DEFINED!\"\r\n}\r\n```\r\n\r\nwhile `ansible_services` should be set:\r\n\r\n```\r\nlocalhost | SUCCESS => {\r\n    \"ansible_services\": {\r\n        ... complete list of services on localhost ...\r\n    }\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible [core 2.16.5]\r\n  config file = <some project path>/ansible.cfg\r\n  configured module search path = ['<some project path>/library']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = <some project path>/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.8 (main, Feb 12 2024, 14:50:05) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\nUsing <some project path>/ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nLoading collection kubernetes.core from /usr/lib/python3.11/site-packages/ansible_collections/kubernetes/core\r\nSet default localhost to localhost\r\nParsed /etc/ansible/hosts inventory source with yaml plugin\r\nLoading callback plugin minimal of type stdout, v2.0 from /usr/lib/python3.11/site-packages/ansible/plugins/callback/minimal.py\r\nLoading collection ansible.posix from /usr/lib/python3.11/site-packages/ansible_collections/ansible/posix\r\nLoading collection community.general from /usr/lib/python3.11/site-packages/ansible_collections/community/general\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\nSkipping callback 'community.general.counter_enabled', as we already have a stdout callback.\r\nlocalhost | SUCCESS => {\r\n    \"services\": {\r\n       ... list of services on localhost ...\r\n    }\r\n}\r\n\r\n############# and for ansible_services (-vvvv output is otherwise the same) #############\r\n\r\nlocalhost | SUCCESS => {\r\n    \"ansible_services\": \"VARIABLE IS NOT DEFINED!: 'ansible_services' is undefined. 'ansible_services' is undefined\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-04T12:21:20Z",
        "user": "hv15",
        "labels": [
            "docs",
            "affects_2.16"
        ]
    },
    {
        "number": 82958,
        "title": "systemd_service: Support for the \"machine\" parameter",
        "body": "### Summary\r\n\r\nWhen trying to run systemd as another user, the following is advised: \r\n\r\n```yaml\r\n- name: Run a user service when XDG_RUNTIME_DIR is not set on remote login\r\n  ansible.builtin.systemd_service:\r\n    name: myservice\r\n    state: started\r\n    scope: user\r\n  environment:\r\n    XDG_RUNTIME_DIR: \"/run/user/{{ myuid }}\"\r\n```\r\n\r\nHowever, this may not always work and can fail in various ways, typically:\r\n\r\n```\r\nFailed to connect to bus: Operation not permitted\r\n```\r\n\r\nSince [systemd 248](https://lists.freedesktop.org/archives/systemd-devel/2021-March/046289.html), the `--machine` option is available to to open a connection to the session bus of a specific user.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nsystemd_service\r\n\r\n### Additional Information\r\n\r\n```yaml\r\n- name: Run from within a specific user session\r\n  ansible.builtin.systemd_service:\r\n    name: myservice\r\n    state: started\r\n    scope: user\r\n    machine: myuser@.host\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-02T18:44:51Z",
        "user": "jimmy-lt",
        "labels": [
            "module",
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 82955,
        "title": "strings templated using a lookup in a loop shouldn't be cached and re-used",
        "body": "### Summary\r\n\r\nI was trying to run ansible playbook with the following tasks to frequently monitor if a host's IP was changed or not. Once the IP was changed, I expected the playbook exited the retries loop. The actual result that I got is: the playbook couldn't detect the ip address' change.\r\n```\r\n- name: Get initial deployment engine ip address\r\n  ansible.builtin.set_fact:\r\n    initial_deployment_engine_ip: \"{{ lookup('community.general.dig', deployment_engine_fqdn) }}\"\r\n\r\n- name: Print initial deployment engine ip address\r\n  ansible.builtin.debug:\r\n    msg: \"{{ initial_deployment_engine_ip }}\"\r\n\r\n- name: Check every 2 mins if the deployment completes\r\n  ansible.builtin.set_fact:\r\n    deployment_engine_ip: \"{{ lookup('community.general.dig', deployment_engine_fqdn) }}\"\r\n  until: deployment_engine_ip != initial_deployment_engine_ip \r\n  retries: 60\r\n  delay: 12 \r\n```\r\nIt might be a bug in Ansible. The issue might be the template string gets rendered once, but the set_fact probably does fire off multiple times (with the now constant value from the templated string). Strings templated using a lookup in a loop shouldn't be cached and re-used.\r\n\r\n### Issue Type\r\n\r\nFeature Request\r\n\r\n### Component Name\r\n\r\nset_fact\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.2]\r\n  config file = /home/qwa/.ansible.cfg\r\n  configured module search path = ['/home/qwa/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/qwa/.local/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/qwa/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/qwa/.local/bin/ansible\r\n  python version = 3.12.0 (main, Oct  2 2023, 00:00:00) [GCC 13.2.1 20230918 (Red Hat 13.2.1-3)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/qwa/.ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora\r\n\r\n### Steps to Reproduce\r\n\r\nYou can use the following way to reproduce the issue.\r\n```\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n    - name: Set original fact\r\n      ansible.builtin.set_fact:\r\n        original_value: \"{{ lookup('ansible.builtin.file', '/home/jrb/experiments/set_fact/foo.txt') }}\"\r\n\r\n    - name: Show the value\r\n      ansible.builtin.debug:\r\n        var: original_value\r\n\r\n    - name: Wait until the value changes\r\n      ansible.builtin.set_fact:\r\n        new_value: \"{{ lookup('ansible.builtin.file', '/home/jrb/experiments/set_fact/foo.txt') }}\"\r\n      until: new_value != original_value\r\n      retries: 3\r\n      delay: 10\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect the above playbook would exit the retries loop when it detected the changes in the foo.txt file.\r\n\r\n### Actual Results\r\n\r\n```console\r\nI did an echo \"Bar\" > foo.txt after the first iteration of the task, so it ought to have changed.\r\n\r\n[jrb@unknown8c1645fec0e5 set_fact]$ ansible-playbook -vvvv playbook.yml\r\nansible-playbook [core 2.16.3]\r\n  config file = /home/jrb/experiments/set_fact/ansible.cfg\r\n  configured module search path = ['/home/jrb/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/jrb/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/jrb/experiments/set_fact/collections\r\n  executable location = /home/jrb/.local/bin/ansible-playbook\r\n  python version = 3.10.11 (main, Apr  5 2023, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\nUsing /home/jrb/experiments/set_fact/ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from \r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nLoading callback plugin default of type stdout, v2.0 from /home/jrb/.local/lib/python3.10/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.PLAYBOOK: playbook.yml *********************************************************\r\nPositional arguments: playbook.yml\r\nverbosity: 4\r\nconnection: ssh\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/etc/ansible/hosts',)\r\nforks: 5\r\n1 plays in playbook.ymlPLAY [localhost] ***************************************************************TASK [Gathering Facts] *********************************************************\r\ntask path: /home/jrb/experiments/set_fact/playbook.yml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: jrb\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~jrb && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/jrb/.ansible/tmp `\"&& mkdir \"` echo /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406 `\" && echo ansible-tmp-1712002162.820464-19670-61381277522406=\"` echo /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406 `\" ) && sleep 0'\r\nUsing module file /home/jrb/.local/lib/python3.10/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/jrb/.ansible/tmp/ansible-local-19667_pcff9o9/tmpykyc9ynl TO /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406/ /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/jrb/.ansible/tmp/ansible-tmp-1712002162.820464-19670-61381277522406/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]TASK [Set original fact] *******************************************************\r\ntask path: /home/jrb/experiments/set_fact/playbook.yml:4\r\nFile lookup using /home/jrb/experiments/set_fact/foo.txt as file\r\nok: [localhost] => {\r\n    \"ansible_facts\": {\r\n        \"original_value\": \"Foo\"\r\n    },\r\n    \"changed\": false\r\n}TASK [Show the value] **********************************************************\r\ntask path: /home/jrb/experiments/set_fact/playbook.yml:8\r\nok: [localhost] => {\r\n    \"original_value\": \"Foo\"\r\n}TASK [Wait until the value changes] ********************************************\r\ntask path: /home/jrb/experiments/set_fact/playbook.yml:12\r\nFile lookup using /home/jrb/experiments/set_fact/foo.txt as file\r\nFAILED - RETRYING: [localhost]: Wait until the value changes (3 retries left).Result was: {\r\n    \"ansible_facts\": {\r\n        \"new_value\": \"Foo\"\r\n    },\r\n    \"attempts\": 1,\r\n    \"changed\": false,\r\n    \"retries\": 4\r\n}\r\nFAILED - RETRYING: [localhost]: Wait until the value changes (2 retries left).Result was: {\r\n    \"ansible_facts\": {\r\n        \"new_value\": \"Foo\"\r\n    },\r\n    \"attempts\": 2,\r\n    \"changed\": false,\r\n    \"retries\": 4\r\n}\r\nFAILED - RETRYING: [localhost]: Wait until the value changes (1 retries left).Result was: {\r\n    \"ansible_facts\": {\r\n        \"new_value\": \"Foo\"\r\n    },\r\n    \"attempts\": 3,\r\n    \"changed\": false,\r\n    \"retries\": 4\r\n}\r\nfatal: [localhost]: FAILED! => {\r\n    \"ansible_facts\": {\r\n        \"new_value\": \"Foo\"\r\n    },\r\n    \"attempts\": 3,\r\n    \"changed\": false\r\n}PLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n```\r\nThe ansible_facts value is output 3 times, indicating to me that set_fact is firing off all 3 times, but the log message \"File lookup using /home/jrb/experiments/set_fact/foo.txt as file\" message was output only once on the first loop indicating that the value is reused.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-04-02T14:56:26Z",
        "user": "qiwangrh",
        "labels": [
            "module",
            "feature",
            "P3",
            "affects_2.16"
        ]
    },
    {
        "number": 82930,
        "title": "Define dnf4/dnf5 selection preference and ensure internal consistency",
        "body": "### Summary\r\n\r\nThe `dnf5` [change entry for Fedora 41](https://fedoraproject.org/wiki/Changes/SwitchToDnf5) was recently updated, and it clarifies some open questions we had around what the final state of side-by-side `dnf4`/`dnf5` CLI and `libdnf` will look like when dnf5 becomes the default package manager in F41+.\r\n\r\nIn light of this information, we'll need to take another pass over our dnf5 support to ensure things behave in a reasonable fashion.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\ndnf\r\n\r\n### Additional Information\r\n\r\nTL;DR from the change entry, it sounds like `/usr/bin/dnf` will be pointed to `dnf5`, `libdnf5` will keep the `5` in its name, and `libdnf` will continue to refer to the `dnf4` version (if present). At least for upgrades, the `dnf4` CLI and `libdnf` will remain present. It's unclear from the change entry if fresh installs will be dnf5-only, but I would assume so. Regardless, once `dnf5` is present (at least in an F41+ env), it should always be preferred. The RPMDB is the shared source of truth between dnf4/dnf5, but metadata that is not part of RPMDB (eg explicit install vs implicit dep tracking) will be siloed by each dnf impl. A best-effort migration of the existing dnf4 DB will apparently be attempted the first time dnf5 is actually used, but after that, the two are completely independent.\r\n\r\nWe'll need to decide what our final package manager selection heuristic and fallback will be, and ensure that it's implemented consistently between facts, the `dnf` shim action plugin, and the module(s) to ensure that we're always talking to the correct implementation. A few possibilities:\r\n\r\n1) Change ansible-core 2.18+ to *always* prefer `dnf5` over `dnf4` if present, regardless of distro/version.\r\n2) Resurrect a table-driven hint approach (ala interpreter discovery) to default package manager selection.\r\n3) Attempt to glean which `dnf` version is the system default package manager by inspecting/running `/usr/bin/dnf` (or via PATH) and default the fact/plugin values accordingly.\r\n\r\nIn any case, we'll need to ensure that whatever behavior we choose behaves consistently, since the logic is somewhat distributed between facts and the `dnf` shim action. Some of the cases we'll want to ensure are being tested:\r\n* Presence of dnf5/libdnf5 on pre-F41\r\n* Presence of dnf4/libdnf on F41+\r\n* `dnf5`/`libdnf5` present, but `libdnf5` Python bindings are missing (should *not* fall back to dnf4)\r\n* `libdnf5` present but `dnf5` is not (?)\r\n\r\nThere will also apparently be some [interim side-tags](https://fedoraproject.org/wiki/Changes/SwitchToDnf5#Side-tag_for_testing) made available to test the new functionality before it becomes the default in rawhide- we should check that out when it's available...\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-29T17:18:32Z",
        "user": "nitzmahone",
        "labels": [
            "module",
            "feature"
        ]
    },
    {
        "number": 82834,
        "title": "any_errors_fatal doesn't work when a remote host is unreachable in the given batch",
        "body": "### Summary\n\nIt seems that any_errors_fatal is not always working as expected. If there is an unreachable host in the current batch the any_errors_fatal stops working completely:\r\n\r\n```\r\nPLAY [Testing] ***********************************************************************************************************************************************************************************************************\r\n\r\nTASK [Testing] ***********************************************************************************************************************************************************************************************************\r\nMonday 18 March 2024  14:54:08 +0100 (0:00:00.036)       0:00:00.036 ********** \r\nMonday 18 March 2024  14:54:08 +0100 (0:00:00.035)       0:00:00.035 ********** \r\nchanged: [testhost2]\r\nfatal: [testhost1]: FAILED! => {\"changed\": true, \"cmd\": [\"/test/check_users\", \"30\", \"40\"], \"delta\": \"0:00:00.031467\", \"end\": \"2024-03-18 14:54:13.072137\", \"failed_when_result\": true, \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2024-03-18 14:54:13.040670\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"Warning: 33 user(s) currently logged in\", \"stdout_lines\": [\"Warning: 33 user(s) currently logged in\"]}\r\nchanged: [testhost3]\r\nchanged: [testhost4]\r\nfatal: [testhost5]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host 111.111.111.111 port 22: Connection timed out\", \"unreachable\": true}\r\n\r\nNO MORE HOSTS LEFT *******************************************************************************************************************************************************************************************************\r\n\r\nPLAY [Testing] ***********************************************************************************************************************************************************************************************************\r\n\r\nTASK [Testing] ***********************************************************************************************************************************************************************************************************\r\nMonday 18 March 2024  14:54:13 +0100 (0:00:05.093)       0:00:05.129 ********** \r\nMonday 18 March 2024  14:54:13 +0100 (0:00:05.093)       0:00:05.128 ********** \r\nfatal: [testhost6]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: Could not resolve hostname 222.222.222.222\\\\305\\\\261: Name or service not known\", \"unreachable\": true}\r\nchanged: [testhost7]\r\nchanged: [testhost8]\r\nchanged: [testhost9]\r\nfatal: [testhost10]: FAILED! => {\"changed\": true, \"cmd\": [\"/test/check_users\", \"30\", \"40\"], \"delta\": \"0:00:00.033527\", \"end\": \"2024-03-18 14:54:14.477162\", \"failed_when_result\": true, \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2024-03-18 14:54:14.443635\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"Warning: 33 user(s) currently logged in\", \"stdout_lines\": [\"Warning: 33 user(s) currently logged in\"]}\r\nchanged: [testhost11]\r\nchanged: [testhost12]\r\nchanged: [testhost13]\r\n```\r\n\r\nIt should have stopped the whole playbook because of on testhost1 the task failed.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nany_errors_fatal\n\n### Ansible Version\n\n```console\nansible [core 2.12.10]\r\n  config file = /home/ak3/projects/asd-controller/ansible.cfg\r\n  configured module search path = ['/home/ak3/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/ak3/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.6 (main, Mar 10 2023, 10:55:28) [GCC 11.3.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nANSIBLE_PIPELINING(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nCALLBACKS_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = ['timer', 'profile_tasks', 'profile_roles']\r\nDEFAULT_ASK_VAULT_PASS(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nDEFAULT_FORKS(/home/ak3/projects/asd-controller/ansible.cfg) = 50\r\nDEFAULT_GATHER_TIMEOUT(/home/ak3/projects/asd-controller/ansible.cfg) = 5\r\nDEFAULT_TIMEOUT(/home/ak3/projects/asd-controller/ansible.cfg) = 5\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/ak3/projects/asd-controller/ansible.cfg) = /home/ak3/projects/asd-controller/.ansible_vault_password\r\nDEPRECATION_WARNINGS(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nHOST_KEY_CHECKING(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/ak3/projects/asd-controller/ansible.cfg) = /usr/bin/python\r\nINVENTORY_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = ['host_list', 'script', 'auto', 'yaml', 'ini', 'toml']\r\nRETRY_FILES_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/home/ak3/projects/asd-controller/ansible.cfg) = /home/ak3/projects/asd-controller\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nssh_args(/home/ak3/projects/asd-controller/ansible.cfg) = -C -o ServerAliveInterval=30 -o ControlMaster=auto -o ControlPersist=60s\r\n\r\nssh:\r\n___\r\n...skipping...\r\nANSIBLE_PIPELINING(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nCALLBACKS_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = ['timer', 'profile_tasks', 'profile_roles']\r\nDEFAULT_ASK_VAULT_PASS(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nDEFAULT_FORKS(/home/ak3/projects/asd-controller/ansible.cfg) = 50\r\nDEFAULT_GATHER_TIMEOUT(/home/ak3/projects/asd-controller/ansible.cfg) = 5\r\nDEFAULT_TIMEOUT(/home/ak3/projects/asd-controller/ansible.cfg) = 5\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/ak3/projects/asd-controller/ansible.cfg) = /home/ak3/projects/asd-controller/.ansible_vault_password\r\nDEPRECATION_WARNINGS(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nHOST_KEY_CHECKING(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/ak3/projects/asd-controller/ansible.cfg) = /usr/bin/python\r\nINVENTORY_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = ['host_list', 'script', 'auto', 'yaml', 'ini', 'toml']\r\nRETRY_FILES_ENABLED(/home/ak3/projects/asd-controller/ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/home/ak3/projects/asd-controller/ansible.cfg) = /home/ak3/projects/asd-controller\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nssh_args(/home/ak3/projects/asd-controller/ansible.cfg) = -C -o ServerAliveInterval=30 -o ControlMaster=auto -o ControlPersist=60s\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\npipelining(/home/ak3/projects/asd-controller/ansible.cfg) = False\r\nssh_args(/home/ak3/projects/asd-controller/ansible.cfg) = -C -o ServerAliveInterval=30 -o ControlMaster=auto -o ControlPersist=60s\r\ntimeout(/home/ak3/projects/asd-controller/ansible.cfg) = 5\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.2 LTS\r\nWSL1\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n---\r\n- name: Testing\r\n  hosts: all\r\n  any_errors_fatal: true\r\n  gather_facts: false\r\n  become: true\r\n  serial:\r\n    - 5\r\n    - 20\r\n  remote_user: ansible\r\n  tasks:\r\n    - name: Testing\r\n      ansible.builtin.command: /test/check_users 30 40\r\n      changed_when: true\r\n      register: command_result\r\n      failed_when: command_result.rc != 0\r\n\r\n```\r\n\n\n### Expected Results\n\nI expect that the playbook will stop the execution for the current batch in case of failures even though there is one or more unreachable hosts.\n\n### Actual Results\n\n```console\nThe playbook execution did not stop even though there was a failed task in the execution on the first 5 hosts. On testhost1 a task has failed, and testhost5 was unreachable and as a result the playbook did not stop. If there are no unreachable hosts in the given batch, it behaves correctly and stops in case of failures.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-18T14:24:27Z",
        "user": "kurzandras",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.12",
            "affects_2.16"
        ]
    },
    {
        "number": 82832,
        "title": "DOCUMENTATION block suboptions in dynamic inventory plugin do not work as expected",
        "body": "### Summary\r\n\r\nIm writing the DOCUMENTATION variable for my dynamic inventory plugin.\r\n[documentation ](https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_documenting.html#documentation-block)\r\n (same for modules from what I understand) and I encountered a non desired behavior.\r\n\r\n```\r\noptions:\r\n  parent:\r\n    description: test\r\n    type: dict\r\n    required: true\r\n    suboptions:\r\n      child:\r\n        description: test2\r\n        type: int\r\n        required: true\r\n```\r\n\r\nWhenever suboptions is used, `required` and `default` are ignored for suboptions.\r\nIn this example, 'parent' will be required, but 'child' (parent.child) will not be required, even though it is the desired behavior, and I stated 'required: true'\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nDynamic Inventory Plugin \r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nNot relevant but 2.11.9\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nNot relevant\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 7\r\n\r\n### Steps to Reproduce\r\nCreate a Dynamic Inventory Plugin python file, in the DOCUMENTATION block variable set the following: (after name description, short_description)\r\n\r\n```yaml (paste below)\r\noptions:\r\n  parent:\r\n    description: test\r\n    type: dict\r\n    required: true\r\n    suboptions:\r\n      child:\r\n        description: test2\r\n        type: int\r\n        required: true\r\n```\r\nNow try to parse using this logic.\r\nansible-inventory -i file.yml --list\r\n\r\n### Expected Results\r\n\r\nI expected the 'child' suboption to be 'required' but it is not. Only 'parent' is required, same with 'default'.\r\n\r\n### Actual Results\r\n\r\n```console\r\n'child' suboption is not 'required' even though 'required: true' was set. Same behavior happens with 'default'\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-17T22:57:49Z",
        "user": "Hapshanko",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 82820,
        "title": "Provide guidance as to how to fix non UTF-8 JSON response from \"ansible.builtin.git\" module",
        "body": "### Summary\r\n\r\nI have the following deprecation warning:\r\n\r\n```\r\n[DEPRECATION WARNING]: Module \"ansible.builtin.git\" returned non UTF-8 data in\r\nthe JSON response. This will become an error in the future. This feature will\r\nbe removed in version 2.18. Deprecation warnings can be disabled by setting\r\ndeprecation_warnings=False in ansible.cfg.\r\n```\r\n\r\nIt would be great to provide some guidance as to how to address this problem. I'm not sure how to workaround the problem, and whether there will be an option in the future to bypass the deprecation or not.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ngit\r\n\r\n### Additional Information\r\n\r\nI would do 2 things.\r\n1. Explicit whether there is a change needed because there will be no way of supporting non UTF-8 anymore, or whether there will an option, for example \"unsafe\" or whatever that would re-assure us to not be suddenly blocked by this deprecation\r\n2. Provide some hints to what the error is related to and link to resources to fix the problem. \r\n\r\nI'm currently unsure exactly what needs to happen, whether it's related to the content of the git repo I'm cloning, or if it's something else. And in any case, not sure what we can or should do about it.\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-14T10:13:35Z",
        "user": "rayrutjes",
        "labels": [
            "module",
            "bug",
            "has_pr"
        ]
    },
    {
        "number": 82796,
        "title": "include_role in loop fails to return result",
        "body": "### Summary\n\nThis task list, in a role named toy, works as I expect:\r\n\r\n```\r\n- include_role:\r\n    name:                       'debian'\r\n  register:                     include_role_result\r\n\r\n- debug:\r\n    var:                        include_role_result\r\n```\r\n\r\nWhen I deploy the role to a host named neuron I see this:\r\n\r\n```\r\nTASK [toy : debug] ******************************************************************************************************************************************\r\nok: [neuron] => \r\n  include_role_result:\r\n    changed: false\r\n    include_args:\r\n      name: debian\r\n\r\n```\r\n\r\nThis version of the task list fails to register the variable containing the result:\r\n\r\n```\r\n---\r\n- include_role:\r\n    name:                       \"{{ role }}\"\r\n  register:                     include_role_result\r\n  loop:\r\n    - 'debian'\r\n  loop_control:\r\n    loop_var:                   role\r\n\r\n- debug:\r\n    var:                        include_role_result\r\n```\r\n...\r\n```\r\nTASK [toy : debug] ******************************************************************************************************************************************\r\nok: [neuron] => \r\n  include_role_result: VARIABLE IS NOT DEFINED!\r\n```\r\n\r\nAs an example of expected behavior, here is a version of the task list using the service module, instead:\r\n\r\n```\r\n---\r\n- service:\r\n    name:               \"{{ restart_service }}\"\r\n    state:              'restarted'\r\n  register:             restart_services_result\r\n  loop:\r\n    - 'cron'\r\n  loop_control:\r\n    loop_var:           restart_service\r\n\r\n- debug:\r\n    var:                restart_services_result\r\n```\r\n\r\n...\r\n\r\n```\r\nTASK [toy : debug] ******************************************************************************************************************************************\r\nok: [neuron] => \r\n  restart_services_result:\r\n    changed: true\r\n    msg: All items completed\r\n    results:\r\n    - ansible_loop_var: restart_service\r\n      changed: true\r\n      failed: false\r\n      invocation:\r\n        module_args:\r\n          arguments: null\r\n          daemonize: false\r\n          enabled: null\r\n          name: cron\r\n          pattern: null\r\n          runlevels: null\r\n          sleep: 1\r\n          state: restarted\r\n      name: cron\r\n      restart_service: cron\r\n      status:\r\n        enabled:\r\n          changed: false\r\n          rc: null\r\n          stderr: null\r\n          stdout: null\r\n        restarted:\r\n          changed: true\r\n          rc: 0\r\n          stderr: ''\r\n          stdout: |-\r\n            Starting periodic command scheduler: cron.\r\n    skipped: false\r\n```\r\n\r\nFirst observed on `core 2.14.13`.  Replicated on `core 2.16.4`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ninclude_role\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.4]\r\n  config file = /home/aaron/control-center/ansible/ansible.cfg\r\n  configured module search path = ['/home/aaron/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/aaron/.venv/ansible/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/aaron/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/aaron/bin/ansible\r\n  python version = 3.11.8 (main, Feb  7 2024, 21:52:08) [GCC 13.2.0] (/home/aaron/.venv/ansible/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCACHE_PLUGIN(/home/aaron/control-center/ansible/ansible.cfg) = memory\r\nCONFIG_FILE() = /home/aaron/control-center/ansible/ansible.cfg\r\nDEFAULT_ACTION_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/action_plugins']\r\nDEFAULT_BECOME(/home/aaron/control-center/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_METHOD(/home/aaron/control-center/ansible/ansible.cfg) = 'sudo'\r\nDEFAULT_BECOME_USER(/home/aaron/control-center/ansible/ansible.cfg) = 'root'\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/callback_plugins']\r\nDEFAULT_CONNECTION_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/connection_plugins']\r\nDEFAULT_FILTER_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/filter_plugins']\r\nDEFAULT_FORKS(/home/aaron/control-center/ansible/ansible.cfg) = 10\r\nDEFAULT_GATHERING(/home/aaron/control-center/ansible/ansible.cfg) = explicit\r\nDEFAULT_HOST_LIST(/home/aaron/control-center/ansible/ansible.cfg) = ['/home/aaron/control-center/ansible/inventory/inventory.d']\r\nDEFAULT_JINJA2_EXTENSIONS(/home/aaron/control-center/ansible/ansible.cfg) = jinja2.ext.do,jinja2.ext.i18n,jinja2.ext.loopcontrols\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/home/aaron/control-center/ansible/ansible.cfg) = True\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/lookup_plugins']\r\nDEFAULT_MANAGED_STR(/home/aaron/control-center/ansible/ansible.cfg) = Ansible managed: {file} modified on %Y-%m-%d %H:%M:%S by {uid} on {host}\r\nDEFAULT_POLL_INTERVAL(/home/aaron/control-center/ansible/ansible.cfg) = 15\r\nDEFAULT_ROLES_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/home/aaron/control-center/ansible/roles']\r\nDEFAULT_STDOUT_CALLBACK(/home/aaron/control-center/ansible/ansible.cfg) = yaml\r\nDEFAULT_TIMEOUT(/home/aaron/control-center/ansible/ansible.cfg) = 10\r\nDEFAULT_TRANSPORT(/home/aaron/control-center/ansible/ansible.cfg) = smart\r\nDEFAULT_VARS_PLUGIN_PATH(/home/aaron/control-center/ansible/ansible.cfg) = ['/usr/share/ansible_plugins/vars_plugins']\r\nRETRY_FILES_ENABLED(/home/aaron/control-center/ansible/ansible.cfg) = False\r\n\r\nBECOME:\r\n======\r\n\r\nrunas:\r\n_____\r\nbecome_user(/home/aaron/control-center/ansible/ansible.cfg) = 'root'\r\n\r\nsu:\r\n__\r\nbecome_user(/home/aaron/control-center/ansible/ansible.cfg) = 'root'\r\n\r\nsudo:\r\n____\r\nbecome_user(/home/aaron/control-center/ansible/ansible.cfg) = 'root'\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\ntimeout(/home/aaron/control-center/ansible/ansible.cfg) = 10\r\n\r\nssh:\r\n___\r\npipelining(/home/aaron/control-center/ansible/ansible.cfg) = True\r\ntimeout(/home/aaron/control-center/ansible/ansible.cfg) = 10\r\n\r\nSHELL:\r\n=====\r\n\r\nsh:\r\n__\r\nremote_tmp(/home/aaron/control-center/ansible/ansible.cfg) = $HOME/.ansible/tmp\n```\n\n\n### OS / Environment\n\nDevuan 6, Excalibur\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- include_role:\r\n    name:                       \"{{ role }}\"\r\n  register:                     include_role_result\r\n  loop:\r\n    - 'debian'\r\n  loop_control:\r\n    loop_var:                   role\r\n\r\n- debug:\r\n    var:                        include_role_result\r\n```\n\n### Expected Results\n\nI expected the variable `include_role_result` to be set.  It was empty.\n\n### Actual Results\n\n```console\nTASK [toy : debug] ******************************************************************************************************************************************\r\nok: [neuron] => \r\n  include_role_result: VARIABLE IS NOT DEFINED!\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-08T00:39:52Z",
        "user": "abugher",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 82793,
        "title": "\"'ansible connection' is undefined.\" when templating conditionals in meta tasks.",
        "body": "### Summary\r\n\r\nWhen using the `ansible.builtin.meta` module with a `when:` condition which includes the `ansible_connection` variable, Ansible fails to evaluate the conditional, instead reporting that \"'ansible_connection' is undefined\".\r\n\r\nThe debug module shows that the variable is defined and other modules do not seem to have the same problem.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nmeta\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/dmn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/dmn/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.7 (main, Jan 29 2024, 16:03:57) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n```\r\nArch Linux\r\nLinux 6.7.6-arch1-1 #1 SMP PREEMPT_DYNAMIC Fri, 23 Feb 2024 16:31:48 +0000 x86_64 GNU/Linux\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nConfigure a minimal test host with Python 3 and SSH. I tested against a Debian 12 container.\r\n\r\n\r\n\r\nThen run the following playbook:\r\n\r\n```yaml (paste below)\r\n---\r\n\r\n- hosts:\r\n    - 172.17.0.3\r\n  tasks:\r\n    - name: \"Debug\"\r\n      ansible.builtin.debug:\r\n        var: \"ansible_connection\"\r\n      when:\r\n        - \"ansible_connection != 'docker'\"\r\n\r\n    - name: \"Meta task\"\r\n      ansible.builtin.meta: end_play\r\n      when:\r\n        - \"ansible_connection != 'docker'\"\r\n```\r\n\r\nWith:\r\n\r\n```console\r\nansible-playbook -i \"172.17.0.3,\" -e 'ansible_user=root' ./test.yml\r\n```\r\n\r\nReplacing the IP as necessary. Note that the example uses the `end_play` command with `ansible.builtin.meta`, but the other commands exhibit the same behaviour.\r\n\r\n### Expected Results\r\n\r\nThe conditional is evaluated correctly and the value of `ansible_connection` is tested.\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/dmn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/dmn/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.11.7 (main, Jan 29 2024, 16:03:57) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\nNo config file found; using defaults\r\nsetting up inventory plugins\r\nLoading collection ansible.builtin from\r\nParsed 172.17.0.3, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python3.11/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: test.yml ***********************************************************************\r\nPositional arguments: ./test.yml\r\nverbosity: 4\r\nconnection: ssh\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('172.17.0.3,',)\r\nextra_vars: ('ansible_user=root',)\r\nforks: 5\r\n1 plays in ./test.yml\r\n\r\nPLAY [172.17.0.3] ************************************************************************\r\n\r\nTASK [Gathering Facts] *******************************************************************\r\ntask path: /tmp/tmp.yJxXPtD5N4/test.yml:3\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'/root\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334 `\" && echo ansible-tmp-1709819051.1516669-704634-205607261149334=\"` echo /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334 `\" ) && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'ansible-tmp-1709819051.1516669-704634-205607261149334=/root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<172.17.0.3> Attempting python interpreter discovery\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.12'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.11'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.10'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.9'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.8'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python3.11\\n/usr/bin/python3\\nENDFOUND\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'/usr/bin/python3.11 && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'{\"platform_dist_result\": [], \"osrelease_content\": \"PRETTY_NAME=\\\\\"Debian GNU/Linux 12 (bookworm)\\\\\"\\\\nNAME=\\\\\"Debian GNU/Linux\\\\\"\\\\nVERSION_ID=\\\\\"12\\\\\"\\\\nVERSION=\\\\\"12 (bookworm)\\\\\"\\\\nVERSION_CODENAME=bookworm\\\\nID=debian\\\\nHOME_URL=\\\\\"https://www.debian.org/\\\\\"\\\\nSUPPORT_URL=\\\\\"https://www.debian.org/support\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.debian.org/\\\\\"\\\\n\"}\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nUsing module file /usr/lib/python3.11/site-packages/ansible/modules/setup.py\r\n<172.17.0.3> PUT /home/dmn/.ansible/tmp/ansible-local-704631krqkqxg9/tmplpgayege TO /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py\r\n<172.17.0.3> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' '[172.17.0.3]'\r\n<172.17.0.3> (0, b'sftp> put /home/dmn/.ansible/tmp/ansible-local-704631krqkqxg9/tmplpgayege /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py\\n', b'OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts\\' -> \\'/home/dmn/.ssh/known_hosts\\'\\r\\ndebug3: expanded UserKnownHostsFile \\'~/.ssh/known_hosts2\\' -> \\'/home/dmn/.ssh/known_hosts2\\'\\r\\ndebug1: auto-mux: Trying existing master at \\'/home/dmn/.ansible/cp/499371f37a\\'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"limits@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"expand-path@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"copy-data\" revision 1\\r\\ndebug2: Unrecognised server extension \"home-directory\"\\r\\ndebug2: Server supports extension \"users-groups-by-id@openssh.com\" revision 1\\r\\ndebug3: Sent message limits@openssh.com I:1\\r\\ndebug3: Received limits reply T:201 I:1\\r\\ndebug3: server upload/download buffer sizes 261120 / 261120; using 261120 / 261120\\r\\ndebug3: server handle limit 1019; using 64\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:2\\r\\ndebug3: SSH2_FXP_REALPATH . -> /root\\r\\ndebug3: Looking up /home/dmn/.ansible/tmp/ansible-local-704631krqkqxg9/tmplpgayege\\r\\ndebug2: Sending SSH2_FXP_STAT \"/root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:3\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: sftp_upload: upload local \"/home/dmn/.ansible/tmp/ansible-local-704631krqkqxg9/tmplpgayege\" to remote \"/root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:4 P:/root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:0 S:261120\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 261120 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:261120 S:35145\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 35145 bytes at 261120\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:5\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/ /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' -tt 172.17.0.3 '/bin/sh -c '\"'\"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'\\r\\n{\"ansible_facts\": {\"ansible_virtualization_type\": \"docker\", \"ansible_virtualization_role\": \"guest\", \"ansible_virtualization_tech_guest\": [\"docker\", \"container\"], \"ansible_virtualization_tech_host\": [\"kvm\", \"virtualbox\"], \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABgQCydyuCn8vjVhABWvqgbTR7mPekfr68aClTFIshb+XQz4hkcFg1VujN4iIxhllgSni7IFrYwiPAPele+Vhvk4BIYy1YHXMhbY8dg141cuS34a68tfzL9DWEKeUz64ERq/qo6/yks6w7l47csWVUOqQux7zeZIi5ch7m4z+2vfo9z6W6uTTfWpRaqb2gP3gY4qG548wHjn8Ru23YulcXHFHxjGsqPF/pje4w8TNKzXM4QrIt5TqJKBmp4UZr3LqHcHcyfRj0ap/Rg99tSOpsznHgG+qFtvRlFHjOL68SeT7ICdAwhBKwAVDHl+dGTIC0FyccA93ZJvXPodQX0yf3rgpkxJRxhxpqGUJk3RVmSCIgRwFVsx0gYcaFk2RisjQO3hv6DllsJKYZch1gEU0mOLRlZvZuSm7MqU6JbuhCI3fuvblFnKwU1IX+LVtkhH0wIAkhQcHk7S8AA7lVXOJuqjJlsiSpM+4zkuEwZ/zMYBCICPC5ApKKMh3/Id0SDrKewV8=\", \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBv73uld4+I7brs3FhV6zTReoiFvq5jIKs5qUdH96luLX5KjCd8wUEyvDnaoB6RaePOLRQ6uQYEUEvks7PVOkE0=\", \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAIJEAQrzyJZBxAUorrWkuiXApzpmX3U2m1CQw1k9jALPA\", \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_user_id\": \"root\", \"ansible_user_uid\": 0, \"ansible_user_gid\": 0, \"ansible_user_gecos\": \"root\", \"ansible_user_dir\": \"/root\", \"ansible_user_shell\": \"/bin/bash\", \"ansible_real_user_id\": 0, \"ansible_effective_user_id\": 0, \"ansible_real_group_id\": 0, \"ansible_effective_group_id\": 0, \"ansible_system\": \"Linux\", \"ansible_kernel\": \"6.7.6-arch1-1\", \"ansible_kernel_version\": \"#1 SMP PREEMPT_DYNAMIC Fri, 23 Feb 2024 16:31:48 +0000\", \"ansible_machine\": \"x86_64\", \"ansible_python_version\": \"3.11.2\", \"ansible_fqdn\": \"dd6bf1057105\", \"ansible_hostname\": \"dd6bf1057105\", \"ansible_nodename\": \"dd6bf1057105\", \"ansible_domain\": \"\", \"ansible_userspace_bits\": \"64\", \"ansible_architecture\": \"x86_64\", \"ansible_userspace_architecture\": \"x86_64\", \"ansible_machine_id\": \"2816098d987d498b9e77fab101506687\", \"ansible_distribution\": \"Debian\", \"ansible_distribution_release\": \"bookworm\", \"ansible_distribution_version\": \"12.4\", \"ansible_distribution_major_version\": \"12\", \"ansible_distribution_file_path\": \"/etc/os-release\", \"ansible_distribution_file_variety\": \"Debian\", \"ansible_distribution_file_parsed\": true, \"ansible_distribution_minor_version\": \"4\", \"ansible_os_family\": \"Debian\", \"ansible_is_chroot\": false, \"ansible_env\": {\"USER\": \"root\", \"SSH_CLIENT\": \"172.17.0.1 37392 22\", \"SHLVL\": \"0\", \"MOTD_SHOWN\": \"pam\", \"HOME\": \"/root\", \"SSH_TTY\": \"/dev/pts/1\", \"LOGNAME\": \"root\", \"_\": \"/bin/sh\", \"TERM\": \"screen-256color\", \"PATH\": \"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\", \"SHELL\": \"/bin/bash\", \"PWD\": \"/root\", \"SSH_CONNECTION\": \"172.17.0.1 37392 172.17.0.3 22\", \"LC_CTYPE\": \"C.UTF-8\"}, \"ansible_lsb\": {}, \"ansible_hostnqn\": \"\", \"ansible_system_capabilities_enforced\": \"N/A\", \"ansible_system_capabilities\": \"N/A\", \"ansible_iscsi_iqn\": \"\", \"ansible_processor\": [\"0\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"1\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"2\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"3\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"4\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"5\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"6\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\", \"7\", \"GenuineIntel\", \"Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz\"], \"ansible_processor_count\": 1, \"ansible_processor_cores\": 4, \"ansible_processor_threads_per_core\": 2, \"ansible_processor_vcpus\": 8, \"ansible_processor_nproc\": 8, \"ansible_memtotal_mb\": 15656, \"ansible_memfree_mb\": 566, \"ansible_swaptotal_mb\": 20479, \"ansible_swapfree_mb\": 17681, \"ansible_memory_mb\": {\"real\": {\"total\": 15656, \"used\": 15090, \"free\": 566}, \"nocache\": {\"free\": 4018, \"used\": 11638}, \"swap\": {\"total\": 20479, \"free\": 17681, \"used\": 2798, \"cached\": 353}}, \"ansible_bios_date\": \"08/30/2022\", \"ansible_bios_vendor\": \"LENOVO\", \"ansible_bios_version\": \"N2WET38W (1.28 )\", \"ansible_board_asset_tag\": \"Not Available\", \"ansible_board_name\": \"20U9CTO1WW\", \"ansible_board_serial\": \"L1HF0AB03V7\", \"ansible_board_vendor\": \"LENOVO\", \"ansible_board_version\": \"SDK0J40697 WIN\", \"ansible_chassis_asset_tag\": \"No Asset Information\", \"ansible_chassis_serial\": \"PF1TPHDS\", \"ansible_chassis_vendor\": \"LENOVO\", \"ansible_chassis_version\": \"None\", \"ansible_form_factor\": \"Notebook\", \"ansible_product_name\": \"20U9CTO1WW\", \"ansible_product_serial\": \"PF1TPHDS\", \"ansible_product_uuid\": \"28fa87cc-2b8b-11b2-a85c-fd11f30284f1\", \"ansible_product_version\": \"ThinkPad X1 Carbon Gen 8\", \"ansible_system_vendor\": \"LENOVO\", \"ansible_devices\": {\"dm-1\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"\", \"sectors\": \"41943040\", \"sectorsize\": \"512\", \"size\": \"20.00 GB\", \"host\": \"\", \"holders\": []}, \"nvme0n1\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": \"WDC PC SN730 SDBQNTY-512G-1001\", \"sas_address\": null, \"sas_device_handle\": null, \"serial\": \"203654804717\", \"removable\": \"0\", \"support_discard\": \"512\", \"partitions\": {\"nvme0n1p1\": {\"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"532480\", \"sectorsize\": 512, \"size\": \"260.00 MB\", \"uuid\": null, \"holders\": []}, \"nvme0n1p2\": {\"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": [\"dm-0\"]}, \"start\": \"534528\", \"sectors\": \"999680655\", \"sectorsize\": 512, \"size\": \"476.68 GB\", \"uuid\": null, \"holders\": [\"cryptlvm\"]}}, \"rotational\": \"0\", \"scheduler_mode\": \"none\", \"sectors\": \"1000215216\", \"sectorsize\": \"512\", \"size\": \"476.94 GB\", \"host\": \"\", \"holders\": []}, \"dm-2\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"\", \"sectors\": \"67108864\", \"sectorsize\": \"512\", \"size\": \"32.00 GB\", \"host\": \"\", \"holders\": []}, \"dm-0\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": [\"dm-1\", \"dm-2\", \"dm-3\"]}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"\", \"sectors\": \"999647887\", \"sectorsize\": \"512\", \"size\": \"476.67 GB\", \"host\": \"\", \"holders\": [\"cryptvols-swap\", \"cryptvols-root\", \"cryptvols-home\"]}, \"dm-3\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"\", \"sectors\": \"890593280\", \"sectorsize\": \"512\", \"size\": \"424.67 GB\", \"host\": \"\", \"holders\": []}}, \"ansible_device_links\": {\"ids\": {}, \"uuids\": {}, \"labels\": {}, \"masters\": {\"dm-0\": [\"dm-1\", \"dm-2\", \"dm-3\"], \"nvme0n1p2\": [\"dm-0\"]}}, \"ansible_uptime_seconds\": 321762, \"ansible_lvm\": \"N/A\", \"ansible_mounts\": [{\"mount\": \"/etc/resolv.conf\", \"device\": \"/dev/mapper/cryptvols-home\", \"fstype\": \"ext4\", \"options\": \"rw,relatime,bind\", \"size_total\": 447676506112, \"size_available\": 132925648896, \"block_size\": 4096, \"block_total\": 109296022, \"block_available\": 32452551, \"block_used\": 76843471, \"inode_total\": 27836416, \"inode_available\": 23518539, \"inode_used\": 4317877, \"uuid\": \"N/A\"}, {\"mount\": \"/etc/hostname\", \"device\": \"/dev/mapper/cryptvols-home\", \"fstype\": \"ext4\", \"options\": \"rw,relatime,bind\", \"size_total\": 447676506112, \"size_available\": 132925648896, \"block_size\": 4096, \"block_total\": 109296022, \"block_available\": 32452551, \"block_used\": 76843471, \"inode_total\": 27836416, \"inode_available\": 23518539, \"inode_used\": 4317877, \"uuid\": \"N/A\"}, {\"mount\": \"/etc/hosts\", \"device\": \"/dev/mapper/cryptvols-home\", \"fstype\": \"ext4\", \"options\": \"rw,relatime,bind\", \"size_total\": 447676506112, \"size_available\": 132925648896, \"block_size\": 4096, \"block_total\": 109296022, \"block_available\": 32452551, \"block_used\": 76843471, \"inode_total\": 27836416, \"inode_available\": 23518539, \"inode_used\": 4317877, \"uuid\": \"N/A\"}], \"ansible_selinux_python_present\": true, \"ansible_selinux\": {\"status\": \"disabled\"}, \"ansible_fibre_channel_wwn\": [], \"ansible_cmdline\": {\"BOOT_IMAGE\": \"/vmlinuz-linux\", \"root\": \"/dev/cryptvols/root\", \"rw\": true, \"loglevel\": \"3\", \"quiet\": true, \"cryptdevice\": \"UUID=1bf69699-2d2f-4a7c-aa47-20a4f2e39a70:cryptlvm\", \"resume\": \"/dev/cryptvols/swap\"}, \"ansible_proc_cmdline\": {\"BOOT_IMAGE\": \"/vmlinuz-linux\", \"root\": [\"/dev/mapper/cryptvols-root\", \"/dev/cryptvols/root\"], \"rw\": true, \"loglevel\": \"3\", \"quiet\": true, \"cryptdevice\": \"UUID=1bf69699-2d2f-4a7c-aa47-20a4f2e39a70:cryptlvm\", \"resume\": \"/dev/cryptvols/swap\"}, \"ansible_loadavg\": {\"1m\": 1.19873046875, \"5m\": 0.94482421875, \"15m\": 0.8896484375}, \"ansible_python\": {\"version\": {\"major\": 3, \"minor\": 11, \"micro\": 2, \"releaselevel\": \"final\", \"serial\": 0}, \"version_info\": [3, 11, 2, \"final\", 0], \"executable\": \"/usr/bin/python3\", \"has_sslcontext\": true, \"type\": \"cpython\"}, \"ansible_apparmor\": {\"status\": \"disabled\"}, \"ansible_dns\": {\"domain\": \"dmn.one\", \"nameservers\": [\"192.168.1.1\"]}, \"ansible_date_time\": {\"year\": \"2024\", \"month\": \"03\", \"weekday\": \"Thursday\", \"weekday_number\": \"4\", \"weeknumber\": \"10\", \"day\": \"07\", \"hour\": \"13\", \"minute\": \"44\", \"second\": \"11\", \"epoch\": \"1709819051\", \"epoch_int\": \"1709819051\", \"date\": \"2024-03-07\", \"time\": \"13:44:11\", \"iso8601_micro\": \"2024-03-07T13:44:11.875417Z\", \"iso8601\": \"2024-03-07T13:44:11Z\", \"iso8601_basic\": \"20240307T134411875417\", \"iso8601_basic_short\": \"20240307T134411\", \"tz\": \"UTC\", \"tz_dst\": \"UTC\", \"tz_offset\": \"+0000\"}, \"ansible_local\": {}, \"ansible_service_mgr\": \"systemd\", \"ansible_fips\": false, \"ansible_pkg_mgr\": \"apt\", \"gather_subset\": [\"all\"], \"module_setup\": true}, \"invocation\": {\"module_args\": {\"gather_subset\": [\"all\"], \"gather_timeout\": 10, \"filter\": [], \"fact_path\": \"/etc/ansible/facts.d\"}}}\\r\\n', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to 172.17.0.3 closed.\\r\\n\")\r\n<172.17.0.3> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.17.0.3> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/dmn/.ansible/cp/499371f37a\"' 172.17.0.3 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1709819051.1516669-704634-205607261149334/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<172.17.0.3> (0, b'', b\"OpenSSH_9.6p1, OpenSSL 3.2.1 30 Jan 2024\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug2: resolve_canonicalize: hostname 172.17.0.3 is address\\r\\ndebug1: hostname canonicalisation enabled, will re-parse configuration\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /home/dmn/.ssh/config\\r\\ndebug1: /home/dmn/.ssh/config line 51: Applying options for 172.17.0.*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 2: include /etc/ssh/ssh_config.d/*.conf matched no files\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/dmn/.ssh/known_hosts'\\r\\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/dmn/.ssh/known_hosts2'\\r\\ndebug1: auto-mux: Trying existing master at '/home/dmn/.ansible/cp/499371f37a'\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 703710\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet_timeout: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n\")\r\nok: [172.17.0.3]\r\n\r\nTASK [Debug] *****************************************************************************\r\ntask path: /tmp/tmp.yJxXPtD5N4/test.yml:6\r\nok: [172.17.0.3] => {\r\n    \"ansible_connection\": \"ssh\"\r\n}\r\n\r\nTASK [Meta task] *************************************************************************\r\ntask path: /tmp/tmp.yJxXPtD5N4/test.yml:12\r\nERROR! The conditional check 'ansible_connection != 'docker'' failed. The error was: error while evaluating conditional (ansible_connection != 'docker'): 'ansible_connection' is undefined. 'ansible_connection' is undefined\r\n\r\nThe error appears to be in '/tmp/tmp.yJxXPtD5N4/test.yml': line 12, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n    - name: \"Meta task\"\r\n      ^ here\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-07T13:50:13Z",
        "user": "DMNh",
        "labels": [
            "module",
            "bug",
            "docs",
            "affects_2.16"
        ]
    },
    {
        "number": 82792,
        "title": "RFE: sort entries in FILES.json for reproducibility",
        "body": "### Summary\n\nI'm working on reproducible builds in Fedora (https://docs.fedoraproject.org/en-US/reproducible-builds/) and the ansible-collection-community-general is different on each rebuild. The difference is that the `/usr/share/ansible/collections/ansible_collections/community/general/FILES.json` generated by `ansible-galaxy collection build` has files in some semi-random order.\r\n\r\nPlease sort the entries in the JSON file.\r\n\r\nAdvantages:\r\n- this is of course necessary for reproducible build efforts\r\n- it reduces churn between updates, because if a user compares what changed, they don't get a huge diff, but only a diff for newly inserted or removed files.\r\n- it allows skipping a file transfer when using rsync or something similar to avoid transferring unchanged files.\r\n- the file is easier to read for humans ;)\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible-galaxy\n\n### Additional Information\n\nExample diff below.\r\n\r\n<details>\r\n\r\n```diff\r\ndiff -u FILES.json FILES.json.rebuild                   \r\n--- FILES.json\t2024-02-27 01:00:00.000000000 +0100\r\n+++ FILES.json.rebuild\t2024-02-27 01:00:00.000000000 +0100\r\n@@ -1233,213 +1233,213 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/counter.py\",\r\n+   \"name\": \"plugins/filter/hashids_decode.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"bd04527cdb0039fc57a451d255a4b23d8e4e75f924e6e32475209aa20c2016f2\",\r\n+   \"chksum_sha256\": \"10d4a64c9948a36cdcf4e6d2ca43061da23c8af53d01ac502fc18b8513cf8a41\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/crc32.py\",\r\n+   \"name\": \"plugins/filter/hashids_encode.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"741ebab408518e97a2b871e5bc71fa0d8f4bc83d3c81d37ca897bd7bbf7a0feb\",\r\n+   \"chksum_sha256\": \"ae43679d22bf67efb49103d96e6484877338c9a4845f4d790b077725947ab780\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/dict.py\",\r\n+   \"name\": \"plugins/filter/lists_difference.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"cb5ac62a79cf46de7802145e19d70cedbd372a80abae7c202252ae02be12d081\",\r\n+   \"chksum_sha256\": \"00ac85de38a8ef6ab75722f025667beb2324d2962a8a7f4323ed00fc1606dce9\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/dict_kv.py\",\r\n+   \"name\": \"plugins/filter/lists_intersect.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"9e7596ccf359e5e7305b07c05a4ae481d609ec2e2f0dfd90fe77ebf264fc2ec5\",\r\n+   \"chksum_sha256\": \"7b0fd37bfb4096c42bcef42ad7d4dbf01d8a8eb1733952c60de64da92255eefd\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/from_csv.py\",\r\n+   \"name\": \"plugins/filter/lists_symmetric_difference.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"ac7a7798b2c9cea258f5a59b8e80dc9b0f9eea811393dfa0e760db8c670179fd\",\r\n+   \"chksum_sha256\": \"2b064bc49e8ad1f2fb8152b06362c6228c6db493e4f141e6d6a3ced6bfadae43\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/from_ini.py\",\r\n+   \"name\": \"plugins/filter/lists_union.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"aa388a5cdd894e1c3d1e66580dbd2947abc2a60b8a30b05fee1a5fb8bb8cc642\",\r\n+   \"chksum_sha256\": \"e51e23e662bc871f8f2f79a7eac15bb1c21ca11e00ab7a20ecb71ef4a7e40dd2\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/groupby_as_dict.py\",\r\n+   \"name\": \"plugins/filter/to_days.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"ec705d8d9f440c5bf405183c6f95fd30b65d33edd55533ef3c5a5eb10d0673f0\",\r\n+   \"chksum_sha256\": \"e9d41efc784e3ef852c0f5c7ef44949c1d0afd4a3a922d7b1e21ee25f17576b2\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/hashids.py\",\r\n+   \"name\": \"plugins/filter/to_hours.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"0b47c5dc7c6b91a8c10dbab0a1d5b6277dcc965d0b3b6b23e7e26716c73a7ba5\",\r\n+   \"chksum_sha256\": \"b4af30e3d234deade9f214501eec8bc0cd2cc6e375deab29f684f5f8932afe9f\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/hashids_decode.yml\",\r\n+   \"name\": \"plugins/filter/to_milliseconds.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"10d4a64c9948a36cdcf4e6d2ca43061da23c8af53d01ac502fc18b8513cf8a41\",\r\n+   \"chksum_sha256\": \"c937ba86ce4f062cacb06f7fa1b8ede66750c6b39b3759ebd0d1af78670d2f32\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/hashids_encode.yml\",\r\n+   \"name\": \"plugins/filter/to_minutes.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"ae43679d22bf67efb49103d96e6484877338c9a4845f4d790b077725947ab780\",\r\n+   \"chksum_sha256\": \"a8fba82f4e4694a0834da995e94ee80ec334932d710f0e2d635b63bf0bb5b0bf\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/jc.py\",\r\n+   \"name\": \"plugins/filter/to_months.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"48d32c91e676999459560646027ac3002b7259353fb65dcfbacae951f0e8b19c\",\r\n+   \"chksum_sha256\": \"50a81390b0dfe9dd18ecc7bc7b98e1e4c0c71b411048853002d3bb2d07e6c0ea\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/json_query.py\",\r\n+   \"name\": \"plugins/filter/to_seconds.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"5b7c9ced4f1477a1196b93a163f3edbd880e6e46966522d144248541730f783d\",\r\n+   \"chksum_sha256\": \"77cf3d8f7e35edef479c65af4b5c14a797be8d78c5abb9a74402005a26e8b780\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists.py\",\r\n+   \"name\": \"plugins/filter/to_time_unit.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"564b7cabed78c74d48379ee8abb4232833ba4876c2952297b14cddc0930877bb\",\r\n+   \"chksum_sha256\": \"18d09d11d3414ee06a6574893cde91d5f6ef1ea4ba3ff32e2474d138272cd9dc\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists_difference.yml\",\r\n+   \"name\": \"plugins/filter/to_weeks.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"00ac85de38a8ef6ab75722f025667beb2324d2962a8a7f4323ed00fc1606dce9\",\r\n+   \"chksum_sha256\": \"e3ecf563747db2ae2c8326dbfd0fa78ba17411a8830f2be64a27fae521424a41\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists_intersect.yml\",\r\n+   \"name\": \"plugins/filter/to_years.yml\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"7b0fd37bfb4096c42bcef42ad7d4dbf01d8a8eb1733952c60de64da92255eefd\",\r\n+   \"chksum_sha256\": \"57af52768feb05e97694effcb0da2d6fff564d359150c3875150cd8562db7b0f\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists_mergeby.py\",\r\n+   \"name\": \"plugins/filter/counter.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"4163df17512c4388bf020417cdd3f9919db9c6f1c23b2a57852bd10523a0abbe\",\r\n+   \"chksum_sha256\": \"bd04527cdb0039fc57a451d255a4b23d8e4e75f924e6e32475209aa20c2016f2\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists_symmetric_difference.yml\",\r\n+   \"name\": \"plugins/filter/crc32.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"2b064bc49e8ad1f2fb8152b06362c6228c6db493e4f141e6d6a3ced6bfadae43\",\r\n+   \"chksum_sha256\": \"741ebab408518e97a2b871e5bc71fa0d8f4bc83d3c81d37ca897bd7bbf7a0feb\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/lists_union.yml\",\r\n+   \"name\": \"plugins/filter/dict.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"e51e23e662bc871f8f2f79a7eac15bb1c21ca11e00ab7a20ecb71ef4a7e40dd2\",\r\n+   \"chksum_sha256\": \"cb5ac62a79cf46de7802145e19d70cedbd372a80abae7c202252ae02be12d081\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/random_mac.py\",\r\n+   \"name\": \"plugins/filter/dict_kv.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"11d31c3d49d45c995a5251adc719156a7e329df8681c8432cce467549b0d0c39\",\r\n+   \"chksum_sha256\": \"9e7596ccf359e5e7305b07c05a4ae481d609ec2e2f0dfd90fe77ebf264fc2ec5\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/time.py\",\r\n+   \"name\": \"plugins/filter/from_csv.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"551bf41b7c11d40606add85d4e2bc7b327951950dbdfc9714a9bd49bdb01bd38\",\r\n+   \"chksum_sha256\": \"ac7a7798b2c9cea258f5a59b8e80dc9b0f9eea811393dfa0e760db8c670179fd\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_days.yml\",\r\n+   \"name\": \"plugins/filter/from_ini.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"e9d41efc784e3ef852c0f5c7ef44949c1d0afd4a3a922d7b1e21ee25f17576b2\",\r\n+   \"chksum_sha256\": \"aa388a5cdd894e1c3d1e66580dbd2947abc2a60b8a30b05fee1a5fb8bb8cc642\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_hours.yml\",\r\n+   \"name\": \"plugins/filter/groupby_as_dict.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"b4af30e3d234deade9f214501eec8bc0cd2cc6e375deab29f684f5f8932afe9f\",\r\n+   \"chksum_sha256\": \"ec705d8d9f440c5bf405183c6f95fd30b65d33edd55533ef3c5a5eb10d0673f0\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_ini.py\",\r\n+   \"name\": \"plugins/filter/hashids.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"d1012ffb9f4d8626c948dc52bf36a4c42287e1deaf65eca1ecf954170d61fdc0\",\r\n+   \"chksum_sha256\": \"0b47c5dc7c6b91a8c10dbab0a1d5b6277dcc965d0b3b6b23e7e26716c73a7ba5\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_milliseconds.yml\",\r\n+   \"name\": \"plugins/filter/jc.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"c937ba86ce4f062cacb06f7fa1b8ede66750c6b39b3759ebd0d1af78670d2f32\",\r\n+   \"chksum_sha256\": \"48d32c91e676999459560646027ac3002b7259353fb65dcfbacae951f0e8b19c\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_minutes.yml\",\r\n+   \"name\": \"plugins/filter/json_query.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"a8fba82f4e4694a0834da995e94ee80ec334932d710f0e2d635b63bf0bb5b0bf\",\r\n+   \"chksum_sha256\": \"5b7c9ced4f1477a1196b93a163f3edbd880e6e46966522d144248541730f783d\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_months.yml\",\r\n+   \"name\": \"plugins/filter/lists.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"50a81390b0dfe9dd18ecc7bc7b98e1e4c0c71b411048853002d3bb2d07e6c0ea\",\r\n+   \"chksum_sha256\": \"564b7cabed78c74d48379ee8abb4232833ba4876c2952297b14cddc0930877bb\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_seconds.yml\",\r\n+   \"name\": \"plugins/filter/lists_mergeby.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"77cf3d8f7e35edef479c65af4b5c14a797be8d78c5abb9a74402005a26e8b780\",\r\n+   \"chksum_sha256\": \"4163df17512c4388bf020417cdd3f9919db9c6f1c23b2a57852bd10523a0abbe\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_time_unit.yml\",\r\n+   \"name\": \"plugins/filter/random_mac.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"18d09d11d3414ee06a6574893cde91d5f6ef1ea4ba3ff32e2474d138272cd9dc\",\r\n+   \"chksum_sha256\": \"11d31c3d49d45c995a5251adc719156a7e329df8681c8432cce467549b0d0c39\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_weeks.yml\",\r\n+   \"name\": \"plugins/filter/time.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"e3ecf563747db2ae2c8326dbfd0fa78ba17411a8830f2be64a27fae521424a41\",\r\n+   \"chksum_sha256\": \"551bf41b7c11d40606add85d4e2bc7b327951950dbdfc9714a9bd49bdb01bd38\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/filter/to_years.yml\",\r\n+   \"name\": \"plugins/filter/to_ini.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"57af52768feb05e97694effcb0da2d6fff564d359150c3875150cd8562db7b0f\",\r\n+   \"chksum_sha256\": \"d1012ffb9f4d8626c948dc52bf36a4c42287e1deaf65eca1ecf954170d61fdc0\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n@@ -1807,339 +1807,423 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/_filelock.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"2603646cf6b8836bf9463fac12303285bbe1c71b81b95210e5c69526b58839f6\",\r\n+   \"name\": \"plugins/module_utils/identity\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/_mount.py\",\r\n+   \"name\": \"plugins/module_utils/identity/keycloak\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/identity/keycloak/keycloak.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"da86be51799ca16fa74fcd61b73e41789f2a42248e0832963b7c2ddb581d94e9\",\r\n+   \"chksum_sha256\": \"b3f1080b3b46444e8eebd03321d1bba8a599b845b8d8bbc846ae2225ee2a33fe\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/_stormssh.py\",\r\n+   \"name\": \"plugins/module_utils/identity/keycloak/keycloak_clientsecret.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"5043afba5520af2aaf27770e7394c672529e45dad295d0d2f003e23ba8c1c562\",\r\n+   \"chksum_sha256\": \"9eda737610357453490d4a9c589776cc5649056abf6f76ae1f4f9e787c1ad966\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/alicloud_ecs.py\",\r\n+   \"name\": \"plugins/module_utils/mh\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/mh/mixins\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/mh/mixins/deprecate_attrs.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"c27a5ba6e76e100af34ee0e3b70591240e41912287c8b4025ab016738f4cb1c9\",\r\n+   \"chksum_sha256\": \"a466625f014edee543016f1949945e79f9c6f675e3c2ebe039d2a63347ce40d3\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/btrfs.py\",\r\n+   \"name\": \"plugins/module_utils/mh/mixins/deps.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"6eac9c40bf7e97f4074121acfcf470e0430236d891d0da214425251e88445d88\",\r\n+   \"chksum_sha256\": \"3aaf0f3bee07c87b4e9108cb474bcb96b715bbad0e77f578987d71ce7fe8dbdf\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/cloud.py\",\r\n+   \"name\": \"plugins/module_utils/mh/mixins/state.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"40dd033fc9af53f39d0b47c7a925f9d934f486eb786cf0d0683e06d982fc9cce\",\r\n+   \"chksum_sha256\": \"9b8aa982effd77ab1c8155fd0315830dad9ce4668c5e3cc716f62a2b4f0e4e3d\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/cmd_runner.py\",\r\n+   \"name\": \"plugins/module_utils/mh/mixins/vars.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"62306950ca87a1a83c8e7bb6e3072609181175687ac02e4ad30de2481112b5e4\",\r\n+   \"chksum_sha256\": \"a34c555587e819fa58b076b872b7d7ae05e129818a98b259ead8c4f1a2fbc733\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/consul.py\",\r\n+   \"name\": \"plugins/module_utils/mh/base.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"8e49aca4e0089787abc8810e5fff2ffe525bee5c122553bd7218526657c6edc4\",\r\n+   \"chksum_sha256\": \"581669bb552f09d82dd4855d39bec70c9e73d9eb35a482c9b28cf6c12a928ad5\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/csv.py\",\r\n+   \"name\": \"plugins/module_utils/mh/deco.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"b324abd90f80888cc4b919a4e1249086f145e308cf9b1081643d888708d2515a\",\r\n+   \"chksum_sha256\": \"7cc2ae2e5d80912be166f4db149ed1701ed63716885cdd766ce0b3db786c540d\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/database.py\",\r\n+   \"name\": \"plugins/module_utils/mh/exceptions.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"a98f22b0a6cebc84175c7c0d90b328f27d30a043827a66df8bf696a81ab265ad\",\r\n+   \"chksum_sha256\": \"bc4cbbb1e854ab9c1813a4a7275cb01c9675bbd1b81fb8a4a777b92013e0d3ae\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/deps.py\",\r\n+   \"name\": \"plugins/module_utils/mh/module_helper.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"b1108ffc323383fd8b06053d3dc8242e332569f9e9a17d0bd4819f18d3c6f924\",\r\n+   \"chksum_sha256\": \"f5070037ffb959097becab8baac019d21ee6fbb305f46f687977500fbcd5fa5f\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/dimensiondata.py\",\r\n+   \"name\": \"plugins/module_utils/net_tools\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/net_tools/pritunl\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/net_tools/pritunl/api.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"b556a6bf6166c9044197ba7d2fd8bd78a30f9b52ea40a1327626810028d100ff\",\r\n+   \"chksum_sha256\": \"7152edad51e8f5abad1f98f00bc5e1005be7756e1bd1b86a3a39f5cdbd2fdfb1\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/gandi_livedns_api.py\",\r\n+   \"name\": \"plugins/module_utils/oracle\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/oracle/oci_utils.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"77ca8211234201bd301a6728b0e7943ddba5e1c946f8b4c603a1035527fc8ff9\",\r\n+   \"chksum_sha256\": \"a4be8160601f53b3520d63dc70a852c3395c3a31e4e9d8f22046e8d9e4285afb\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/gconftool2.py\",\r\n+   \"name\": \"plugins/module_utils/remote_management\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/remote_management/lxca\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/remote_management/lxca/common.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"e3c3dfdfac5ebea89af206f0e103cf9b7e01e0b8797c9dc4558d393009ab5cad\",\r\n+   \"chksum_sha256\": \"bad7676e1b303f03c1371d4b7f961cd68a0ddbf329ad3ae578406b71416a451e\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/gio_mime.py\",\r\n+   \"name\": \"plugins/module_utils/source_control\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/source_control/bitbucket.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"4cf1fd084311a0c06d81c72cc424fa4d10a76c85aadb459f4ad9e5ac34ca0309\",\r\n+   \"chksum_sha256\": \"94390a592b98b0245d7dfe28fa0c40ec09b613a7b29ac5647f2ac32a4e3e3d9f\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/gitlab.py\",\r\n+   \"name\": \"plugins/module_utils/storage\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/storage/emc\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/storage/emc/emc_vnx.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"11504e0b1cc93424e0ab0c496737eb412537558268624b36ab7860ca0a89e6ec\",\r\n+   \"chksum_sha256\": \"bcdc4934ef73ba3afe20ec4465315b26da7b0d181272701b859d4818d02821b2\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/heroku.py\",\r\n+   \"name\": \"plugins/module_utils/storage/hpe3par\",\r\n+   \"ftype\": \"dir\",\r\n+   \"chksum_type\": null,\r\n+   \"chksum_sha256\": null,\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n+   \"name\": \"plugins/module_utils/storage/hpe3par/hpe3par.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"cbda8c10463f77d4d61da5932c65ecc02d8f33c45d91a4de5a3a83c65d0226b3\",\r\n+   \"chksum_sha256\": \"4948a4b9c921b801acd5b3cee30ec5c298a543fa0bc01e9606e04ffe0c8f3104\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/hwc_utils.py\",\r\n+   \"name\": \"plugins/module_utils/_filelock.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"902d6f842f07d568a019ccf99123aa23cceecc60527b839678b38246331e9e0b\",\r\n+   \"chksum_sha256\": \"2603646cf6b8836bf9463fac12303285bbe1c71b81b95210e5c69526b58839f6\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/ibm_sa_utils.py\",\r\n+   \"name\": \"plugins/module_utils/_mount.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"aca525a27aa45ca5801357ff1ef64d450c5a60f594195b5d494188735d90658f\",\r\n+   \"chksum_sha256\": \"da86be51799ca16fa74fcd61b73e41789f2a42248e0832963b7c2ddb581d94e9\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/identity\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/_stormssh.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"5043afba5520af2aaf27770e7394c672529e45dad295d0d2f003e23ba8c1c562\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/identity/keycloak\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/alicloud_ecs.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"c27a5ba6e76e100af34ee0e3b70591240e41912287c8b4025ab016738f4cb1c9\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/identity/keycloak/keycloak.py\",\r\n+   \"name\": \"plugins/module_utils/btrfs.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"b3f1080b3b46444e8eebd03321d1bba8a599b845b8d8bbc846ae2225ee2a33fe\",\r\n+   \"chksum_sha256\": \"6eac9c40bf7e97f4074121acfcf470e0430236d891d0da214425251e88445d88\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/identity/keycloak/keycloak_clientsecret.py\",\r\n+   \"name\": \"plugins/module_utils/cloud.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"9eda737610357453490d4a9c589776cc5649056abf6f76ae1f4f9e787c1ad966\",\r\n+   \"chksum_sha256\": \"40dd033fc9af53f39d0b47c7a925f9d934f486eb786cf0d0683e06d982fc9cce\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/ilo_redfish_utils.py\",\r\n+   \"name\": \"plugins/module_utils/cmd_runner.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"854a02d4935924d19e8ef87f68b231a019c609b6d69daede43f12f65d258a778\",\r\n+   \"chksum_sha256\": \"62306950ca87a1a83c8e7bb6e3072609181175687ac02e4ad30de2481112b5e4\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/influxdb.py\",\r\n+   \"name\": \"plugins/module_utils/consul.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"2b60218d62295883947047697e6604c8b55ff3e419ed5520b2912e13e3e46d99\",\r\n+   \"chksum_sha256\": \"8e49aca4e0089787abc8810e5fff2ffe525bee5c122553bd7218526657c6edc4\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/ipa.py\",\r\n+   \"name\": \"plugins/module_utils/csv.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"2fbe8b6da9a2d3be12640df88c4ce8907f52706e0175228a8f2e03aacf0f0f60\",\r\n+   \"chksum_sha256\": \"b324abd90f80888cc4b919a4e1249086f145e308cf9b1081643d888708d2515a\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/jenkins.py\",\r\n+   \"name\": \"plugins/module_utils/database.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"706fc70da922c6d1657faf6d5faa307e7c5c8608a4420368d7061e53fd0905ab\",\r\n+   \"chksum_sha256\": \"a98f22b0a6cebc84175c7c0d90b328f27d30a043827a66df8bf696a81ab265ad\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/known_hosts.py\",\r\n+   \"name\": \"plugins/module_utils/deps.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"eb78405e49c65fb5651f17bbbb60208a237a7cdc63e07cf58fa7f75e46e6b533\",\r\n+   \"chksum_sha256\": \"b1108ffc323383fd8b06053d3dc8242e332569f9e9a17d0bd4819f18d3c6f924\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/ldap.py\",\r\n+   \"name\": \"plugins/module_utils/dimensiondata.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"d0f34a3cc0472876585d6fb72e1b56b1e2584788e20c0b17cf8f8b03da6f8694\",\r\n+   \"chksum_sha256\": \"b556a6bf6166c9044197ba7d2fd8bd78a30f9b52ea40a1327626810028d100ff\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/linode.py\",\r\n+   \"name\": \"plugins/module_utils/gandi_livedns_api.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"fc5fcd782d4fb9fc2c885ff7a193afdc7db1f3c5a3333d76839e9fc2398c6a86\",\r\n+   \"chksum_sha256\": \"77ca8211234201bd301a6728b0e7943ddba5e1c946f8b4c603a1035527fc8ff9\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/locale_gen.py\",\r\n+   \"name\": \"plugins/module_utils/gconftool2.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"6064b7e307cb9e5f0808bc20fdc153c286f08372051844adb208dce2efce8942\",\r\n+   \"chksum_sha256\": \"e3c3dfdfac5ebea89af206f0e103cf9b7e01e0b8797c9dc4558d393009ab5cad\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/lxd.py\",\r\n+   \"name\": \"plugins/module_utils/gio_mime.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"41a8e13e308e969a72aa9d23c19300bc572c13e6bd2a4fdfdfc9a2c29cbd669b\",\r\n+   \"chksum_sha256\": \"4cf1fd084311a0c06d81c72cc424fa4d10a76c85aadb459f4ad9e5ac34ca0309\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/manageiq.py\",\r\n+   \"name\": \"plugins/module_utils/gitlab.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"ea7eedc9cb9baa248dbddb63fa3df90d3b78a101b5bc91f3bfb09488d92250a0\",\r\n+   \"chksum_sha256\": \"11504e0b1cc93424e0ab0c496737eb412537558268624b36ab7860ca0a89e6ec\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/memset.py\",\r\n+   \"name\": \"plugins/module_utils/heroku.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"95fd5a2e0e92f049e0f700a3ba8cd0eac4d95ccea9e706a106135fa3973716e1\",\r\n+   \"chksum_sha256\": \"cbda8c10463f77d4d61da5932c65ecc02d8f33c45d91a4de5a3a83c65d0226b3\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/hwc_utils.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"902d6f842f07d568a019ccf99123aa23cceecc60527b839678b38246331e9e0b\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/base.py\",\r\n+   \"name\": \"plugins/module_utils/ibm_sa_utils.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"581669bb552f09d82dd4855d39bec70c9e73d9eb35a482c9b28cf6c12a928ad5\",\r\n+   \"chksum_sha256\": \"aca525a27aa45ca5801357ff1ef64d450c5a60f594195b5d494188735d90658f\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/deco.py\",\r\n+   \"name\": \"plugins/module_utils/ilo_redfish_utils.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"7cc2ae2e5d80912be166f4db149ed1701ed63716885cdd766ce0b3db786c540d\",\r\n+   \"chksum_sha256\": \"854a02d4935924d19e8ef87f68b231a019c609b6d69daede43f12f65d258a778\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/exceptions.py\",\r\n+   \"name\": \"plugins/module_utils/influxdb.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"bc4cbbb1e854ab9c1813a4a7275cb01c9675bbd1b81fb8a4a777b92013e0d3ae\",\r\n+   \"chksum_sha256\": \"2b60218d62295883947047697e6604c8b55ff3e419ed5520b2912e13e3e46d99\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/mixins\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/ipa.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"2fbe8b6da9a2d3be12640df88c4ce8907f52706e0175228a8f2e03aacf0f0f60\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/mixins/deprecate_attrs.py\",\r\n+   \"name\": \"plugins/module_utils/jenkins.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"a466625f014edee543016f1949945e79f9c6f675e3c2ebe039d2a63347ce40d3\",\r\n+   \"chksum_sha256\": \"706fc70da922c6d1657faf6d5faa307e7c5c8608a4420368d7061e53fd0905ab\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/mixins/deps.py\",\r\n+   \"name\": \"plugins/module_utils/known_hosts.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"3aaf0f3bee07c87b4e9108cb474bcb96b715bbad0e77f578987d71ce7fe8dbdf\",\r\n+   \"chksum_sha256\": \"eb78405e49c65fb5651f17bbbb60208a237a7cdc63e07cf58fa7f75e46e6b533\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/mixins/state.py\",\r\n+   \"name\": \"plugins/module_utils/ldap.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"9b8aa982effd77ab1c8155fd0315830dad9ce4668c5e3cc716f62a2b4f0e4e3d\",\r\n+   \"chksum_sha256\": \"d0f34a3cc0472876585d6fb72e1b56b1e2584788e20c0b17cf8f8b03da6f8694\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/mixins/vars.py\",\r\n+   \"name\": \"plugins/module_utils/linode.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"a34c555587e819fa58b076b872b7d7ae05e129818a98b259ead8c4f1a2fbc733\",\r\n+   \"chksum_sha256\": \"fc5fcd782d4fb9fc2c885ff7a193afdc7db1f3c5a3333d76839e9fc2398c6a86\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/mh/module_helper.py\",\r\n+   \"name\": \"plugins/module_utils/locale_gen.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"f5070037ffb959097becab8baac019d21ee6fbb305f46f687977500fbcd5fa5f\",\r\n+   \"chksum_sha256\": \"6064b7e307cb9e5f0808bc20fdc153c286f08372051844adb208dce2efce8942\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/module_helper.py\",\r\n+   \"name\": \"plugins/module_utils/lxd.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"7eb6f642db5f83ec87a06e04f8d62436a9eec0058cff531cdebf20865c571b09\",\r\n+   \"chksum_sha256\": \"41a8e13e308e969a72aa9d23c19300bc572c13e6bd2a4fdfdfc9a2c29cbd669b\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/net_tools\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/manageiq.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"ea7eedc9cb9baa248dbddb63fa3df90d3b78a101b5bc91f3bfb09488d92250a0\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/net_tools/pritunl\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n+   \"name\": \"plugins/module_utils/memset.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"95fd5a2e0e92f049e0f700a3ba8cd0eac4d95ccea9e706a106135fa3973716e1\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/net_tools/pritunl/api.py\",\r\n+   \"name\": \"plugins/module_utils/module_helper.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"7152edad51e8f5abad1f98f00bc5e1005be7756e1bd1b86a3a39f5cdbd2fdfb1\",\r\n+   \"chksum_sha256\": \"7eb6f642db5f83ec87a06e04f8d62436a9eec0058cff531cdebf20865c571b09\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n@@ -2185,20 +2269,6 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/oracle\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/oracle/oci_utils.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"a4be8160601f53b3520d63dc70a852c3395c3a31e4e9d8f22046e8d9e4285afb\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n    \"name\": \"plugins/module_utils/pipx.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -2255,27 +2325,6 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/remote_management\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/remote_management/lxca\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/remote_management/lxca/common.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"bad7676e1b303f03c1371d4b7f961cd68a0ddbf329ad3ae578406b71416a451e\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n    \"name\": \"plugins/module_utils/rundeck.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -2304,20 +2353,6 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/source_control\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/source_control/bitbucket.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"94390a592b98b0245d7dfe28fa0c40ec09b613a7b29ac5647f2ac32a4e3e3d9f\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n    \"name\": \"plugins/module_utils/ssh.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -2325,41 +2360,6 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/module_utils/storage\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/storage/emc\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/storage/emc/emc_vnx.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"bcdc4934ef73ba3afe20ec4465315b26da7b0d181272701b859d4818d02821b2\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/storage/hpe3par\",\r\n-   \"ftype\": \"dir\",\r\n-   \"chksum_type\": null,\r\n-   \"chksum_sha256\": null,\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n-   \"name\": \"plugins/module_utils/storage/hpe3par/hpe3par.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"4948a4b9c921b801acd5b3cee30ec5c298a543fa0bc01e9606e04ffe0c8f3104\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n    \"name\": \"plugins/module_utils/univention_umc.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -3298,13 +3298,6 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/modules/grove.py\",\r\n-   \"ftype\": \"file\",\r\n-   \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"c2c377a014a2c7339d9b4146606a4cae0b1b4e58d922a2f4393bd2a01d86db3b\",\r\n-   \"format\": 1\r\n-  },\r\n-  {\r\n    \"name\": \"plugins/modules/gitlab_project_members.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -3340,6 +3333,13 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n+   \"name\": \"plugins/modules/grove.py\",\r\n+   \"ftype\": \"file\",\r\n+   \"chksum_type\": \"sha256\",\r\n+   \"chksum_sha256\": \"c2c377a014a2c7339d9b4146606a4cae0b1b4e58d922a2f4393bd2a01d86db3b\",\r\n+   \"format\": 1\r\n+  },\r\n+  {\r\n    \"name\": \"plugins/modules/gunicorn.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n@@ -5013,17 +5013,17 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/modules/pacman.py\",\r\n+   \"name\": \"plugins/modules/packet_volume_attachment.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"7529ef49870407d3bff76639118b21ec4e785c05a31c4cd6adba51209029f9e8\",\r\n+   \"chksum_sha256\": \"f23b67e3cbbd4c2c5d13609223b3b38ccb9c3313d8435d11c50191fb3b028ff9\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/modules/packet_volume_attachment.py\",\r\n+   \"name\": \"plugins/modules/pacman.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"f23b67e3cbbd4c2c5d13609223b3b38ccb9c3313d8435d11c50191fb3b028ff9\",\r\n+   \"chksum_sha256\": \"7529ef49870407d3bff76639118b21ec4e785c05a31c4cd6adba51209029f9e8\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n@@ -5881,17 +5881,17 @@\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/modules/scaleway_private_network.py\",\r\n+   \"name\": \"plugins/modules/scaleway_organization_info.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"24868dbc94e52824f8d42e1281dab81840a2c6864e670d8155932ef349e12c81\",\r\n+   \"chksum_sha256\": \"fb68f0b3241398ea6172248a24bcb5f66902e9b16643b53364f867c9ed952ffb\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n-   \"name\": \"plugins/modules/scaleway_organization_info.py\",\r\n+   \"name\": \"plugins/modules/scaleway_private_network.py\",\r\n    \"ftype\": \"file\",\r\n    \"chksum_type\": \"sha256\",\r\n-   \"chksum_sha256\": \"fb68f0b3241398ea6172248a24bcb5f66902e9b16643b53364f867c9ed952ffb\",\r\n+   \"chksum_sha256\": \"24868dbc94e52824f8d42e1281dab81840a2c6864e670d8155932ef349e12c81\",\r\n    \"format\": 1\r\n   },\r\n   {\r\n```\r\n\r\n</details>\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-07T11:21:58Z",
        "user": "keszybz",
        "labels": [
            "easyfix",
            "has_pr",
            "feature",
            "P3"
        ]
    },
    {
        "number": 82780,
        "title": "module_utils/urls.py MAXHEADERS",
        "body": "### Summary\r\n\r\nWhen using a module that uses the underlying module_utils/urls.py and a API response returns more than 100 headers an error is thrown.\r\n\r\nThe default is set to return a max of 100 headers. However we are doing a API call agains VMWare Cloud Director and this API call returns 109 headers and thus throws an error. \r\n\r\nA quick and dirty fix is to set: `http.client._MAXHEADERS = 1000` for example under module_utils/urls.py.\r\n\r\nThere is probably a better way to handle this.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\n/lib/ansible/module_utils/urls.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.16.4]\r\n  config file = None\r\n  configured module search path = ['/home/roelc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/linuxbrew/.linuxbrew/Cellar/ansible/9.3.0/libexec/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/roelc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/linuxbrew/.linuxbrew/bin/ansible\r\n  python version = 3.12.2 (main, Feb  6 2024, 20:19:44) [GCC 11.4.0] (/home/linuxbrew/.linuxbrew/Cellar/ansible/9.3.0/libexec/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nansible-vcd-collection \u276f ansible-config dump --only-changed                                                                                    on \ue0a0 development [!+] via \ud83d\udc0d v3.12.2 (base)\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = nvim\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 24.04 (workstation)\r\nCentOS Stream9 (Ansible Execution Environment)\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n- name: Login VCD API\r\n  hosts: localhost\r\n  connection: local\r\n\r\n  tasks:\r\n    - name: Login VCD\r\n      vcd_api_login:\r\n        username: \"{{ vcd_user }}\"\r\n        password: \"{{ vcd_password }}\"\r\n        api_version: \"38.1\" ## Defaults to 38.1\r\n        provider: True ## Defaults to false\r\n      register: auth\r\n      no_log: False\r\n\r\n    - name: Get DC group ID\r\n      ansible.builtin.uri:\r\n        url: \"https://portal.xyz.com/cloudapi/1.0.0/vdcGroups?page=1&pageSize=100&sort&links=false\"\r\n        headers:\r\n          Authorization: \"Bearer {{ auth.token }}\"\r\n          Accept: \"application/json;version=38.1\"\r\n        method: GET\r\n        status_code: 200\r\n      register: result\r\n\r\n    - name: debug\r\n      debug:\r\n        msg: \"{{ result }}\"\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n```console\r\nPLAY [Login VCD API] ***********************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [Login VCD] ***************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [Get VDC Group] ***********************************************************\r\nchanged: [localhost]\r\n\r\nTASK [Get DC group ID] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"msg\": {\r\n        \"cache_control\": \"no-store, must-revalidate\",\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_location\": \"https://portal.xyz.com/cloudapi/1.0.0/vdcGroups\",\r\n        \"content_type\": \"application/json;version=38.1\",\r\n        \"cookies\": {},\r\n        \"cookies_string\": \"\",\r\n        \"date\": \"Wed, 06 Mar 2024 21:45:46 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"associations\": null,\r\n            \"page\": 1,\r\n            \"pageCount\": 1,\r\n            \"pageSize\": 100,\r\n            \"resultTotal\": 31,\r\n            \"values\": []\r\n....\r\n```\r\n### Actual Results\r\n\r\n```console\r\nPLAY [Login VCD API] ***********************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [Login VCD] ***************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [Get VDC Group] ***********************************************************\r\nchanged: [localhost]\r\n\r\nTASK [Get DC group ID] *********************************************************\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: http.client.HTTPException: got more than 100 headers\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"elapsed\": 0, \"msg\": \"Status code was -1 and not [200]: An unknown error occurred: got more than 100 headers\", \"redirected\": false, \"status\": -1, \"url\": \"https://portal.simaccloud.com/cloudapi/1.0.0/vdcGroups?page=1&pageSize=100&sort&links=false\"}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-06T21:53:20Z",
        "user": "dc-tec",
        "labels": [
            "bug",
            "P3",
            "affects_2.16"
        ]
    },
    {
        "number": 82771,
        "title": "Jinja exception line numbers are incorrect",
        "body": "### Summary\r\n\r\nWhen an exception is raised while processing a jinja template, the line numbers reported in the template are incorrect.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ntemplate\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.4]\r\n  config file = None\r\n  configured module search path = ['/home/phemmer/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/phemmer/.local/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/phemmer/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/phemmer/.local/bin/ansible\r\n  python version = 3.12.1 (main, Dec 18 2023, 00:00:00) [GCC 13.2.1 20231205 (Red Hat 13.2.1-6)] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = less -Ri\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 39, Fedora 38, Debian Buster, Debian Bullseye\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n#### `playbook.yml`\r\n```yaml\r\n- hosts: localhost\r\n  tasks:\r\n    - template:\r\n        src: test.j2\r\n        dest: /dev/null\r\n\r\n```\r\n\r\n#### `test.j2`\r\n```jinja\r\n{% import \"test2.j2\" as i with context %}\r\n{{ i.m() }}\r\n```\r\n\r\n#### `test2.j2`\r\n```jinja\r\n{% macro m() %}\r\n{% set foo, bar = none %}\r\n{% endmacro %}\r\n```\r\n\r\n#### shell\r\n```bash\r\nansible-playbook -vvv playbook.yml\r\n```\r\n\r\n### Expected Results\r\n\r\nI expect the exception to contain correct line numbers.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [template] *********************************************************************************************************************************************************************\r\ntask path: /tmp/jtest/playbook.yml:3\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: phemmer\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~phemmer && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/phemmer/.ansible/tmp `\"&& mkdir \"` echo /home/phemmer/.ansible/tmp/ansible-tmp-1709602183.0105805-667431-79776538526983 `\" && echo ansible-tmp-1709602183.0105805-667431-79776538526983=\"` echo /home/phemmer/.ansible/tmp/ansible-tmp-1709602183.0105805-667431-79776538526983 `\" ) && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/phemmer/.ansible/tmp/ansible-tmp-1709602183.0105805-667431-79776538526983/ > /dev/null 2>&1 && sleep 0'\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/ansible/template/__init__.py\", line 1010, in do_template\r\n    res = myenv.concat(rf)\r\n          ^^^^^^^^^^^^^^^^\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/ansible/template/native_helpers.py\", line 83, in ansible_concat\r\n    return ''.join([to_text(v) for v in nodes])\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"<template>\", line 14, in root\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/ansible/template/__init__.py\", line 381, in call\r\n    return super().call(obj, *args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/jinja2/runtime.py\", line 299, in call\r\n    return __obj(*args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/jinja2/runtime.py\", line 764, in __call__\r\n    return self._invoke(arguments, autoescape)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/jinja2/runtime.py\", line 783, in _invoke\r\n    raise e\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/jinja2/runtime.py\", line 780, in _invoke\r\n    rv = self._func(*arguments)\r\n         ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/tmp/jtest/test2.j2\", line 16, in macro\r\nTypeError: cannot unpack non-iterable NoneType object\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/ansible/plugins/action/template.py\", line 152, in run\r\n    resultant = templar.do_template(template_data, preserve_trailing_newlines=True, escape_backslashes=False, overrides=overrides)\r\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/phemmer/.local/lib/python3.12/site-packages/ansible/template/__init__.py\", line 1021, in do_template\r\n    raise AnsibleError(\"Unexpected templating type error occurred on (%s): %s\" % (to_native(data), to_native(te)), orig_exc=te)\r\nansible.errors.AnsibleError: Unexpected templating type error occurred on ({% import \"test2.j2\" as i with context %}\r\n{{ i.m() }}\r\n): cannot unpack non-iterable NoneType object. cannot unpack non-iterable NoneType object\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"msg\": \"AnsibleError: Unexpected templating type error occurred on ({% import \\\"test2.j2\\\" as i with context %}\\n{{ i.m() }}\\n): cannot unpack non-iterable NoneType object. cannot unpack non-iterable NoneType object\"\r\n}\r\n```\r\n\r\n^ note specifically:\r\n```\r\n  File \"/tmp/jtest/test2.j2\", line 16, in macro\r\n```\r\nThere is no line 16 of `test2.j2`. The line number changes depending on the number of parsed tokens in the template. For example if you change `macro m()` to `macro m(a=1, b=2, c=3, d=4)`, you get an error on line 24 instead. You can pretty much change anything in either file to get the effect.\r\n\r\nThis could be reproduced with a single file as well, but then the filename is a literal `<templated>` string, so using 2 files in the example makes the issue clearer.\r\n\r\nIn addition, when I run this through jinja in a native python script, the line numbers are correct. So it's something ansible is doing.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-03-05T01:35:40Z",
        "user": "phemmer",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 82749,
        "title": "Unexpected behavior of failed_when with lookups",
        "body": "### Summary\n\n`failed_when: false` and `ignore_errors: true` behave different within a lookup task, but should not.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nbuiltin\n\n### Ansible Version\n\n```console\nansible-playbook [core 2.16.0]\r\n  config file = None\r\n  configured module search path = ['/home/<user>/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/dist-packages/ansible\r\n  ansible collection location = /home/<user>/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.3\r\n  libyaml = True\r\n\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.3 LTS\n\n### Steps to Reproduce\n\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: no\r\n  tasks:\r\n\r\n    - name: fact with ignore error\r\n      ansible.builtin.set_fact:\r\n        variable: \"{{ lookup('file', '/nosuchfile', errors='ignore') }}\"\r\n      failed_when: false\r\n\r\n    - name: fact with ignore_errors\r\n      ansible.builtin.set_fact:\r\n        variable: \"{{ lookup('file', '/nosuchfile' ) }}\"\r\n      ignore_errors: true\r\n\r\n    - name: fact no lookup errors\r\n      ansible.builtin.set_fact:\r\n        variable: \"{{ lookup('file', '/nosuchfile' ) }}\"\r\n      failed_when: false\r\n\r\n```\r\n```\r\nTASK [fact with ignore error] **************************************************************************************************\r\n[WARNING]: Unable to find '/nosuchfile' in expected paths (use -vvvvv to see paths)\r\nok: [localhost]\r\n\r\nTASK [fact with ignore_errors] *************************************************************************************************\r\n[WARNING]: Unable to find '/nosuchfile' in expected paths (use -vvvvv to see paths)\r\nfatal: [localhost]: FAILED! => {\"msg\": \"An unhandled exception occurred while running the lookup plugin 'file'. Error was a <class 'ansible.errors.AnsibleError'>, original message: could not locate file in lookup: /nosuchfile. could not locate file in lookup: /nosuchfile\"}\r\n...ignoring\r\n\r\nTASK [fact no lookup errors] ***************************************************************************************************\r\n[WARNING]: Unable to find '/nosuchfile' in expected paths (use -vvvvv to see paths)\r\nfatal: [localhost]: FAILED! => {\"msg\": \"An unhandled exception occurred while running the lookup plugin 'file'. Error was a <class 'ansible.errors.AnsibleError'>, original message: could not locate file in lookup: /nosuchfile. could not locate file in lookup: /nosuchfile\"}\r\n\r\nPLAY RECAP *********************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   \r\n```\r\n\n\n### Expected Results\n\nThe third task (fact no lookup errors) is failing, but it is expected to not fail, the same way as the 2 other tasks.\n\n### Actual Results\n\n```console\nThe third task is failing but it shouldn't.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-26T19:35:06Z",
        "user": "megabreit",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 82742,
        "title": "String is evaluated as integer list under jinja2_native = True",
        "body": "### Summary\n\nWith `jinja2_native` set to `True`, a template string result such as `1,2,3`  is passed on as `[1,2,3]`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ntemplate\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/juser/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/juser/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.1 (main, Dec 18 2023, 00:00:00) [GCC 13.2.1 20231205 (Red Hat 13.2.1-6)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nFedora 39\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nplaybook blah.yml:\r\n```yaml (paste below)\r\n- name: blah\r\n  hosts: localhost\r\n  connection: local\r\n  gather_facts: false\r\n\r\n  tasks:\r\n    - name: test cron\r\n      cron:\r\n          cron_file: \"{{ lookup('env', 'PWD') }}/blah\"\r\n          name: blah\r\n          user: \"{{ lookup('env', 'USER') }}\"\r\n          job: whomai\r\n          hour: \"{{ range(1, 3) | join(',') }}\"\r\n          minute: \"23\"\r\n    - name: show debug output\r\n      debug:\r\n        msg: \"{{ range(1, 3) | join(',') }}\"\r\n    - name: show type\r\n      debug:\r\n        msg: \"{{ range(1, 3) | join(',') | type_debug }}\"\r\n    - name: show join result through string filter\r\n      debug:\r\n        msg: \"{{ range(1, 3) | join(',') | string }}\"\r\n    - name: show string list through string filter\r\n      debug:\r\n        msg: \"{{ [1, 2] | string }}\"\r\n```\r\nExcecute:\r\n\r\n```\r\nrm -f blah\r\nANSIBLE_JINJA2_NATIVE=0 ansible-playbook blah.yml -i localhost, --diff\r\nANSIBLE_JINJA2_NATIVE=1 ansible-playbook blah.yml -i localhost, --diff\r\n```\n\n### Expected Results\n\nI expect that both ansible-playbook invocations yield the same results independent of the `ANSIBLE_JINJA2_NATIVE` / `jinja2_native` setting, i.e. especially for the first two tasks, i.e. like this:\r\n\r\n```\r\n\r\nPLAY [blah] **************************************************************************************************************************************************************************************\r\n\r\nTASK [test cron] *********************************************************************************************************************************************************************************\r\n--- before: /home/juser/del/blah\r\n+++ after: /home/juser/del/blah\r\n@@ -0,0 +1,2 @@\r\n+#Ansible: blah\r\n+23 1,2 * * * juser whomai\r\n\r\nchanged: [localhost]\r\n\r\nTASK [show debug output] *************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"1,2\"\r\n}\r\n\r\nTASK [show type] *********************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"str\"\r\n}\r\n\r\nTASK [show join result through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"1,2\"\r\n}\r\n\r\nTASK [show string list through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"[1, 2]\"\r\n}\r\n```\n\n### Actual Results\n\n```console\n$ rm -f blah\r\n$ ANSIBLE_JINJA2_NATIVE=0 ansible-playbook blah.yml -i localhost, --diff\r\n\r\nPLAY [blah] **************************************************************************************************************************************************************************************\r\n\r\nTASK [test cron] *********************************************************************************************************************************************************************************\r\n--- before: /home/juser/del/blah\r\n+++ after: /home/juser/del/blah\r\n@@ -0,0 +1,2 @@\r\n+#Ansible: blah\r\n+23 1,2 * * * juser whomai\r\n\r\nchanged: [localhost]\r\n\r\nTASK [show debug output] *************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"1,2\"\r\n}\r\n\r\nTASK [show type] *********************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"str\"\r\n}\r\n\r\nTASK [show join result through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"1,2\"\r\n}\r\n\r\nTASK [show string list through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"[1, 2]\"\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n$ ANSIBLE_JINJA2_NATIVE=1 ansible-playbook blah.yml -i localhost, --diff\r\n\r\nPLAY [blah] **************************************************************************************************************************************************************************************\r\n\r\nTASK [test cron] *********************************************************************************************************************************************************************************\r\n--- before: /home/juser/del/blah\r\n+++ after: /home/juser/del/blah\r\n@@ -1,2 +1,2 @@\r\n #Ansible: blah\r\n-23 1,2 * * * juser whomai\r\n+23 [1, 2] * * * juser whomai\r\n\r\nchanged: [localhost]\r\n\r\nTASK [show debug output] *************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": [\r\n        1,\r\n        2\r\n    ]\r\n}\r\n\r\nTASK [show type] *********************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"str\"\r\n}\r\n\r\nTASK [show join result through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"1,2\"\r\n}\r\n\r\nTASK [show string list through string filter] ****************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"[1, 2]\"\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-25T12:12:39Z",
        "user": "gsauthof",
        "labels": [
            "module",
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 82724,
        "title": "`check_required_one_of` does not check for null params values",
        "body": "### Summary\n\nI am trying to use the `check_required_one_of` validation function during the module execution.\r\n\r\nWe want to make sure that one of 2 parameters are provided, but only when we create a resource.\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nmodule_utils\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.3]\r\n  config file = None\r\n  configured module search path = ['/home/jo/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/pipx/venvs/ansible-core/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/jo/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.11.2 (main, Mar 13 2023, 12:18:29) [GCC 12.2.0] (/opt/pipx/venvs/ansible-core/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nDebian 12\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```py\r\nfrom ansible.module_utils.basic import AnsibleModule\r\nfrom ansible.module_utils.common.text.converters import to_native\r\nfrom ansible.module_utils.common.validation import check_required_one_of\r\n\r\n\r\ndef main():\r\n    module = AnsibleModule(\r\n        argument_spec=dict(\r\n            id={\"type\": \"int\"},\r\n            name={\"type\": \"str\"},\r\n            type={\"choices\": [\"ipv4\", \"ipv6\"]},\r\n            datacenter={\"type\": \"str\"},\r\n            server={\"type\": \"str\"},\r\n            state={\"choices\": [\"absent\", \"present\"], \"default\": \"present\"},\r\n        ),\r\n        required_one_of=[[\"id\", \"name\"]],\r\n        supports_check_mode=True,\r\n    )\r\n\r\n    result = {\r\n        \"changed\": False,\r\n        \"params\": module.params,\r\n    }\r\n\r\n    resource_does_not_exist = True  # API lookup\r\n    if resource_does_not_exist:\r\n        module.fail_on_missing_params(required_params=[\"type\", \"name\"])\r\n        try:\r\n            check_required_one_of([[\"server\", \"datacenter\"]], module.params)\r\n        except TypeError as e:\r\n            module.fail_json(msg=to_native(e))\r\n\r\n    module.exit_json(**result)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\n```\r\n\r\n\r\n```\r\nansible -m path.to.module localhost -a 'name=test, type=ipv4' -vvv\r\n```\n\n### Expected Results\n\nI expect the check_required_one_of to check for null values and fails, as fields that are not provided are set to null automatically.\r\n\r\nA workaround is to filter the parameters by None values before passing them to the function.\n\n### Actual Results\n\n```console\nlocalhost | SUCCESS => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"datacenter\": null,\r\n            \"id\": null,\r\n            \"name\": \"test,\",\r\n            \"server\": null,\r\n            \"state\": \"present\",\r\n            \"type\": \"ipv4\"\r\n        }\r\n    },\r\n    \"params\": {\r\n        \"datacenter\": null,\r\n        \"id\": null,\r\n        \"name\": \"test,\",\r\n        \"server\": null,\r\n        \"state\": \"present\",\r\n        \"type\": \"ipv4\"\r\n    }\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-21T08:37:23Z",
        "user": "jooola",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 82685,
        "title": "'gather_facts' with 'parallel' set no longer works in check mode under 2.16",
        "body": "### Summary\n\nThe documentation indicates that _gather_facts_ has full support for check mode - as of 2.16, this appears to no longer be true.\r\n\r\nWhen running under check mode, the _gather_facts_ task hangs indefinitely if the _parallel_ attribute is set. Debug logging shows the following looping non-fatal error:\r\n\r\n```\r\nEscalation succeeded\r\n<host> (0, b'\\n{\"skipped\": true, \"msg\": \"remote module (ansible.legacy.async_status) does not support check mode\", \"invocation\": {\"module_args\": {\"jid\": \"j352380961407.926212\", \"_async_dir\": \"/root/.ansible_async\", \"mode\": \"status\"}}}\\n', b'')\r\nUsing module file /Users/adamb/Library/Python/3.12/lib/python/site-packages/ansible/modules/async_status.py\r\nPipelining is enabled.\r\n```\r\n\r\nRemoving the _parallel_ keyword is a workaround, as is downgrading to 2.15. I have done a clean install of ansible, removed all custom facts, and all galaxy modules, testing with just _ansible_ and _ansible-core_ installed to verify this issue is present with a minimal install.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.gather_facts\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.3]\r\n  config file = /Users/adamb/Developer/ansible/ansible.cfg\r\n  configured module search path = ['/Users/adamb/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules', '/Users/adamb/Developer/ansible/plugins/modules', '/Users/adamb/.ansible/collections/*/modules']\r\n  ansible python module location = /Users/adamb/Library/Python/3.12/lib/python/site-packages/ansible\r\n  ansible collection location = /Users/adamb/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/adamb/Library/Python/3.12/bin/ansible\r\n  python version = 3.12.2 (main, Feb  6 2024, 20:19:44) [Clang 15.0.0 (clang-1500.1.0.2.5)] (/usr/local/opt/python@3.12/bin/python3.12)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nERROR! Unexpected Exception, this is probably a bug: 'AnsibleSequence' object has no attribute 'get'\r\n\r\n$ cat ansible.cfg\r\n\r\n[defaults]\r\ninventory = inventory\r\ninterpreter_python = python3\r\nbecome_method = sudo\r\nhost_key_checking = false\r\nvault_password_file = ./contrib/vault/lastpass-client.py\r\nlibrary = ~/.ansible/plugins/modules:/usr/share/ansible/plugins/modules:./plugins/modules:~/.ansible/collections/*/modules\r\nlookup_plugins = ~/.ansible/plugins/lookup:/usr/share/ansible/plugins/lookup:./plugins/lookup\r\naction_plugins = ~/.ansible/plugins/action:/usr/share/ansible/plugins/action:./plugins/action\r\nroles_path = ~/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:./roles:~/.ansible/collections/*/roles/\r\nmodule_utils = ~/.ansible/plugins/module_utils:/usr/share/ansible/plugins/module_utils:~/.ansible/collections/*/module_utils\r\nplaybook_dir = ./playbooks:./jobs\r\nuse_persistent_connections = true\r\nnocows = 1\r\nfilter_plugins = ~/.ansible/plugins/filter:/usr/share/ansible/plugins/filter:./plugins/filter\r\njinja2_native = True\r\nansible_managed = Ansible managed: {{{{ lookup('git_info', template_fullpath | quote) }}}}\r\nforks = 9\r\nlog_path = ~/.ansible/ansible.log\r\nmax_diff_size = 208896\r\nstdout_callback = yaml\r\nbin_ansible_callbacks = True\r\ndeprecation_warnings = False\r\n\r\n[ssh_connection]\r\nssh_args = -C -o ControlMaster=auto -o ControlPersist=600 -o PreferredAuthentications=publickey\r\npipelining = True\n```\n\n\n### OS / Environment\n\nMacOS 13 Controller, RHEL8 Managed Node\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nPlease note that this is a contrived example - in our real play there are a couple of tasks that run to set up credentials before _gather_facts_ is executed, otherwise we would just set _gather_facts: true_.\r\n\r\n```\r\n$ ansible-playbook ./playbooks/lb.yml --diff --check\r\n```\r\n```yaml (paste below)\r\n- name: Install and configure load balancers\r\n  hosts: \"{{ target | default('all') }}\"\r\n  gather_facts: false\r\n  pre_tasks:\r\n    - name: Gather facts\r\n      ansible.builtin.gather_facts:\r\n        parallel: true\r\n      become: true\r\n```\n\n### Expected Results\n\nGather facts should succeed with _parallel_ set, as it does under 2.15, or outside of check mode.\n\n### Actual Results\n\n```console\nEscalation succeeded\r\n<host> (0, b'\\n{\"skipped\": true, \"msg\": \"remote module (ansible.legacy.async_status) does not support check mode\", \"invocation\": {\"module_args\": {\"jid\": \"j352380961407.926212\", \"_async_dir\": \"/root/.ansible_async\", \"mode\": \"status\"}}}\\n', b'')\r\nUsing module file /Users/adamb/Library/Python/3.12/lib/python/site-packages/ansible/modules/async_status.py\r\nPipelining is enabled.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-13T23:48:17Z",
        "user": "TheMysteriousX",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82661,
        "title": "job stay stuck in running status due to defunct (or nfs stale or ...) process on the host  ",
        "body": "### Summary\r\n\r\nHi\r\n\r\nI am running a job (via awx on in command line) that simply upgrade my Red Hat servers but on 2 hosts dnf is in defunct status so job/adhoc command stuck in running status\r\n\r\nCan you please advise ?\r\n\r\nCan I configure ansible to abort on specific host (note that timeout does not work on such issue)\r\n\r\nthanks for your support\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.15.8]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/runner/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.18 (main, Sep 22 2023, 17:58:34) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nbash-4.4# ansible-config dump --only-changed -t all\r\nANSIBLE_FORCE_COLOR(env: ANSIBLE_FORCE_COLOR) = True\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nDEFAULT_CALLBACK_PLUGIN_PATH(env: ANSIBLE_CALLBACK_PLUGINS) = ['/runner/artifacts/10114/callback']\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(env: ANSIBLE_LOAD_CALLBACK_PLUGINS) = True\r\nDEFAULT_STDOUT_CALLBACK(env: ANSIBLE_STDOUT_CALLBACK) = awx_display\r\nDEFAULT_TIMEOUT(env: ANSIBLE_TIMEOUT) = 600\r\nHOST_KEY_CHECKING(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\nINVENTORY_UNPARSED_IS_FAILED(env: ANSIBLE_INVENTORY_UNPARSED_FAILED) = True\r\nRETRY_FILES_ENABLED(env: ANSIBLE_RETRY_FILES_ENABLED) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\nrecord_host_keys(env: ANSIBLE_PARAMIKO_RECORD_HOST_KEYS) = False\r\ntimeout(env: ANSIBLE_TIMEOUT) = 600\r\n\r\nssh:\r\n___\r\nhost_key_checking(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\nsftp_batch_mode(env: ANSIBLE_SFTP_BATCH_MODE) = False\r\ntimeout(env: ANSIBLE_TIMEOUT) = 600\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nrhel 8.8\r\n4.18.0-477.27.1.el8_8.x86_64\r\n\r\n### Steps to Reproduce\r\n\r\nYou can mount nfs client on vm, stop nfsd server\r\nrun adhoc command with yum update on the server\r\nadhoc command stuck indefinitely\r\n\r\n\r\n### Expected Results\r\n\r\nadhoc command complete successfully\r\n\r\n### Actual Results\r\n\r\n```console\r\nadhoc command hang/stuck indefinitely\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-08T10:50:44Z",
        "user": "birb57",
        "labels": [
            "bug",
            "affects_2.15"
        ]
    },
    {
        "number": 82660,
        "title": "meta: refresh_inventory does not remove hosts added with add_host since 2.14.0",
        "body": "### Summary\r\n\r\nI'm testing some complex playbooks that make use of the `add_host` task, combined with `meta: refresh_inventory` to remove them. I've checked that on versions lower than `2.14.0` of `ansible-core` this works as expected (adding a new host with `add_host` and then executing the `refresh_inventory` removes it from the in-memory inventory) but, since version `2.14.0`, the `meta` task does not remove the hosts.\r\n\r\nI think this is a bug, but if it's the intended behavior, this should be considered a breaking changed, and thus a workaround should exist (maybe a `remove_host` task?).\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nrefresh_inventory\r\n\r\n### Ansible Version\r\n\r\n\"Legacy\" behavior:\r\n\r\n```sh\r\n$ ansible --version\r\nansible [core 2.13.13]\r\n  config file = None\r\n  configured module search path = ['/home/xabier.napal/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/xabier.napal/.pyenv/versions/3.10.2/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/xabier.napal/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/xabier.napal/.pyenv/versions/3.10.2/bin/ansible\r\n  python version = 3.10.2 (main, Feb 21 2022, 15:42:38) [GCC 11.1.0]\r\n  jinja version = 3.1.1\r\n  libyaml = True\r\n```\r\n\r\nCurrent behavior:\r\n\r\n```sh\r\nansible [core 2.14.0]\r\n  config file = None\r\n  configured module search path = ['/home/xabier.napal/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/xabier.napal/.pyenv/versions/3.10.2/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/xabier.napal/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/xabier.napal/.pyenv/versions/3.10.2/bin/ansible\r\n  python version = 3.10.2 (main, Feb 21 2022, 15:42:38) [GCC 11.1.0] (/home/xabier.napal/.pyenv/versions/3.10.2/bin/python3.10)\r\n  jinja version = 3.1.1\r\n  libyaml = True\r\n```\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nManjaro Linux\r\n\r\n### Steps to Reproduce\r\n\r\nUsing the following dummy inventory and test playbook.\r\n\r\n```ini\r\n[group1]\r\nhost1\r\n\r\n[group2]\r\nhost2\r\n```\r\n\r\n```yaml\r\n- name: test add host and refresh inventory\r\n  hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - name: print original inventory groups\r\n      ansible.builtin.debug:\r\n        var: groups\r\n\r\n    - name: add host to inventory in runtime\r\n      ansible.builtin.add_host:\r\n        host: host3\r\n        groups:\r\n          - group3\r\n\r\n    - name: print modified inventory groups\r\n      ansible.builtin.debug:\r\n        var: groups\r\n\r\n    - name: refresh inventory to clear runtime added hosts\r\n      ansible.builtin.meta: refresh_inventory\r\n\r\n    - name: check inventory status\r\n      ansible.builtin.debug:\r\n        var: groups\r\n```\r\n\r\nThe playbook prints the inventory before and after dynamically adding a new host, and it then refreshes the inventory to clear all included hosts.\r\n\r\n### Expected Results\r\n\r\nWith this setup, I expect the last task to output only `host1` and `host2` groups and their groups. In older versions ( `< 2.14.0`), this works as expected:\r\n\r\n```sh\r\nPLAY [test add host and refresh inventory] **********************************************************\r\n\r\nTASK [print original inventory groups] **************************************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n\r\nTASK [add host to inventory in runtime] *************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [print modified inventory groups] **************************************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host3\",\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"group3\": [\r\n            \"host3\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n\r\nTASK [refresh inventory to clear runtime added hosts] ***********************************************\r\n\r\nTASK [check inventory status] ***********************************************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\nStarting on `2.14.0`, the `group3` group and `host3` host are still present after refreshing the inventory:\r\n\r\n```sh\r\nPLAY [test add host and refresh inventory] ***************************************\r\n\r\nTASK [print original inventory groups] *******************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n\r\nTASK [add host to inventory in runtime] ******************************************\r\nchanged: [localhost]\r\n\r\nTASK [print modified inventory groups] *******************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host3\",\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"group3\": [\r\n            \"host3\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n\r\nTASK [refresh inventory to clear runtime added hosts] ****************************\r\n\r\nTASK [check inventory status] ****************************************************\r\nok: [localhost] => {\r\n    \"groups\": {\r\n        \"all\": [\r\n            \"host3\",\r\n            \"host1\",\r\n            \"host2\"\r\n        ],\r\n        \"group1\": [\r\n            \"host1\"\r\n        ],\r\n        \"group2\": [\r\n            \"host2\"\r\n        ],\r\n        \"group3\": [\r\n            \"host3\"\r\n        ],\r\n        \"ungrouped\": []\r\n    }\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-08T09:20:00Z",
        "user": "xabinapal",
        "labels": [
            "bug",
            "docs",
            "affects_2.13"
        ]
    },
    {
        "number": 82652,
        "title": "`password_hash` deprecation message does not suggest any alternative",
        "body": "### Summary\r\n\r\nWhen I use `password_hash` filter with `pbkdf2_sha512` hash type, I get the following deprecation message:\r\n\r\n```\r\n[DEPRECATION WARNING]: Checking for unsupported password_hash passlib hashtype 'pbkdf2_sha512'. This will be an error in the future as all supported hashtypes must be documented. This feature will be removed in version 2.19. Deprecation \r\nwarnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\n```\r\n\r\nUnfortunately, the deprecation message does not contain any information about an appropriate replacement for the current solution. I don't know what I need to do to get hashed string using `pbkdf2_sha512` after Ansible 2.19 was released.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.password_hash\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.12.1 (main, Dec 18 2023, 00:00:00) [GCC 13.2.1 20231205 (Red Hat 13.2.1-6)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = flatpak run --branch=stable --arch=x86_64 --command=emacsclient --file-forwarding org.gnu.emacs --create-frame\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 39\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nUse something like this in any appropriate task:\r\n\r\n```yaml (paste below)\r\npassword_variable|password_hash('pbkdf2_sha512', salt_variable)\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect the deprecation message to contain some information about an alternative to my current workable solution.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [role : task] ****************************************************************************************************************************************************************************************\r\n[DEPRECATION WARNING]: Checking for unsupported password_hash passlib hashtype 'pbkdf2_sha512'. This will be an error in the future as all supported hashtypes must be documented. This feature will be removed in version 2.19. Deprecation \r\nwarnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\n\r\n...\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-07T08:37:42Z",
        "user": "ivanov17",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 82643,
        "title": "Passing host ip as argument to ansible-playbook not shows expected stdout",
        "body": "### Summary\r\n\r\n\r\nCommand:\r\n`ansible-playbook playbook.yaml  -e \"host_ip=192.168.1.1\"\r\n`\r\n\r\nIn the output it does not show real ip address.\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nModule\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.3]\r\n```\r\n\r\n### OS / Environment\r\n\r\nmacOS Sonoma 14.2.1\r\nLinux Ubuntu\r\n\r\n### Configuration\r\nCONFIG_FILE() = /Users/hasan/opt/ansible/ansible.cfg\r\nDEFAULT_HOST_LIST(/Users/hasan/opt/ansible/ansible.cfg) = ['/Users/hasan/opt/ansible/inventory']\r\nDEFAULT_PRIVATE_KEY_FILE(/Users/hasan/opt/ansible/ansible.cfg) = /Users/hasan/opt/ansible_private_key\r\nDEFAULT_REMOTE_USER(/Users/hasan/opt/ansible/ansible.cfg) = root\r\nHOST_KEY_CHECKING(/Users/hasan/opt/ansible/ansible.cfg) = False\r\nPAGER(env: PAGER) = less\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\ninventory:\r\n```yaml\r\nservers:\r\n  hosts:\r\n    \"{{ host_ip }}\"\r\n```\r\n\r\nplaybook\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: false\r\n  remote_user: root\r\n  roles:\r\n    - registrator\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nExptected to see :\r\n```\r\nTASK [registrator : debug] *******************************************************************************************************************************************************************************************\r\nok: [192.168.1.1] => {\r\n    \"msg\": \"Logged in as user root\"\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nOutput:\r\n\r\nTASK [registrator : debug] *******************************************************************************************************************************************************************************************\r\nok: [{{ host_ip }}] => {\r\n    \"msg\": \"Logged in as user root\"\r\n}\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-02-03T20:52:17Z",
        "user": "AliyevH",
        "labels": [
            "bug",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 82598,
        "title": "Cannot delegate to a host defined by a variable whose value is determined using ansible_facts, for package module",
        "body": "### Summary\r\n\r\nWhen delegating to a host, you might have some logic that decides which host to delegate to.\r\n\r\nAn example of that might be using the CPU architecture from ansible_facts to delegate a task to another host which must be the same architecture. This is a contrived example for the purpose of this bug report.\r\n\r\nIf the logic that determines the delegate_to target uses a regular host variable the resulting type will be AnsibleUnicode and whatever is passed to delegate_to is templated correctly. If ansible_facts[] is used to determine the delegate_to target then the type will be AnsibleUnsafeText and templating of the variable will not happen.\r\n\r\ngit-bisect indicates that this change behaviour was introduced in https://github.com/ansible/ansible/commit/fea130480d261ea5bf6fcd5cf19a348f1686ceb1\r\n\r\nThis https://github.com/ansible/ansible/blob/v2.15.8/lib/ansible/plugins/action/package.py#L49\r\nleads to https://github.com/ansible/ansible/blob/v2.15.8/lib/ansible/template/__init__.py#L744-L746\r\nand returns the original untemplated text as the module name\r\n\r\nThere are other action plugins (service for example) which use the same templating pattern for delegation and I expect these fail in the same way.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npackage, service\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible [core 2.15.8]\r\n  config file = None\r\n  configured module search path = ['/Users/jrosser/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/jrosser/cloud/venv2/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /Users/jrosser/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/jrosser/cloud/venv2/bin/ansible\r\n  python version = 3.11.6 (main, Oct  2 2023, 20:14:46) [Clang 14.0.0 (clang-1400.0.29.202)] (/Users/jrosser/cloud/venv2/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nDarwin RD012343 21.6.0 Darwin Kernel Version 21.6.0: Wed Oct  4 23:55:28 PDT 2023; root:xnu-8020.240.18.704.15~1/RELEASE_X86_64 x86_64\r\n\r\nAlso reproducible on ubuntu 22.04\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: a\r\n  vars:\r\n    my_other_hosts:\r\n      x86_64: mist100.test.mist.rd.bbc.co.uk\r\n\r\n    architecture: x86_64\r\n    delegate_host1: \"{{ my_other_hosts[architecture] }}\"\r\n    delegate_host2: \"{{ my_other_hosts[ansible_facts['architecture']] }}\"\r\n  tasks:\r\n    - debug:\r\n        msg: \"{{ delegate_host1 | type_debug }}\"\r\n\r\n    - debug:\r\n        msg: \"{{ delegate_host2 | type_debug }}\"\r\n\r\n    - package:\r\n        name: vim\r\n        state: present\r\n      delegate_to: \"{{ delegate_host1 }}\"\r\n\r\n    - package:\r\n        name: vim\r\n        state: present\r\n      delegate_to: \"{{ delegate_host2 }}\"\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expected the task to be delegated to the host computed by the variable delegate_host2 as has happened in ansible versions prior to 2.15.7.\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook -i inventory.yml test.yml\r\n\r\nPLAY [a] *****************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************************************************\r\nok: [mist0.test.mist.rd.bbc.co.uk]\r\n\r\nTASK [debug] *************************************************************************************************************************************************************************************************\r\nok: [mist0.test.mist.rd.bbc.co.uk] => {\r\n    \"msg\": \"AnsibleUnicode\"\r\n}\r\n\r\nTASK [debug] *************************************************************************************************************************************************************************************************\r\nok: [mist0.test.mist.rd.bbc.co.uk] => {\r\n    \"msg\": \"AnsibleUnsafeText\"\r\n}\r\n\r\nTASK [package] ***********************************************************************************************************************************************************************************************\r\nok: [mist0.test.mist.rd.bbc.co.uk -> mist100.test.mist.rd.bbc.co.uk]\r\n\r\nTASK [package] ***********************************************************************************************************************************************************************************************\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None\r\nfatal: [mist0.test.mist.rd.bbc.co.uk -> mist100.test.mist.rd.bbc.co.uk]: FAILED! => {\"changed\": false, \"msg\": \"Could not find a module for {{hostvars['mist100.test.mist.rd.bbc.co.uk']['ansible_facts']['pkg_mgr']}}.\"}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************************************************\r\nmist0.test.mist.rd.bbc.co.uk : ok=4    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-24T17:29:56Z",
        "user": "jrosser",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.15",
            "data_tagging"
        ]
    },
    {
        "number": 82538,
        "title": "Allow to silence warning about loop variable already in use",
        "body": "### Summary\n\nI'm recursively including a tasks file in one of my roles and I noticed that currently it is not possible to silence the warning about reusing the loop variable. It would be great to be able to somehow say that overwriting a variable is intentional.\r\n\r\nExample: https://gitlab.agowa338.de/agowa338-ansible/ansible-arch-makepkg/-/blob/14eb6f1d65e4dff29281b87006d0a60057c360dd/tasks/build/jack.yml#L5\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nloop_control\n\n### Additional Information\n\n\r\n```yaml\r\n- include_tasks: ../build.yml\r\n  loop_control:\r\n    loop_var: item\r\n    loop_var_overwrites: True\r\n  loop:\r\n    - loopItem1\r\n    - loopItem2\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-14T21:36:22Z",
        "user": "agowa",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 82535,
        "title": "\"No such file or directory\" error when using local modules and python installed on Mac in \"Library/Application Support\" venvs",
        "body": "### Summary\n\nThe path to the python interpreter seems not to be correctly escaped when using local modules resulting in a \"No such file or directory\" error.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-playbook\n\n### Ansible Version\n\n```console\nansible [core 2.16.2]\r\n  config file = /Users/jh/projekte/tourenbuch/server/ansible.cfg\r\n  configured module search path = ['/Users/jh/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/jh/Library/Application Support/pipx/venvs/ansible/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/jh/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/jh/.local/bin/ansible\r\n  python version = 3.12.1 (main, Dec  7 2023, 20:45:44) [Clang 15.0.0 (clang-1500.0.40.1)] (/Users/jh/Library/Application Support/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = /Users/jh/projekte/tourenbuch/server/ansible.cfg\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nMacOs Sonoma 14.2.1\n\n### Steps to Reproduce\n\nWhen issuing a \"synchronize\" task to copy some files from my local system to a remote server, e.g.:\r\n\r\n```\r\n- name: Copy DEV files to /data-srv\r\n  synchronize:\r\n    src: files/\r\n    dest: /data-srv\r\n    delete: yes\r\n```\r\n\n\n### Expected Results\n\nThe command should work.\n\n### Actual Results\n\n```console\nThen this task fails with:\r\n\r\n\r\nTASK [services-mapserver : Copy DEV files to /data-srv] ******************************************************************************************************************************************************\r\ntask path: /Users/jh/projekte/tourenbuch/server/roles/services-mapserver/tasks/main.yml:1\r\nredirecting (type: modules) ansible.builtin.synchronize to ansible.posix.synchronize\r\nredirecting (type: action) ansible.builtin.synchronize to ansible.posix.synchronize\r\nredirecting (type: action) ansible.builtin.synchronize to ansible.posix.synchronize\r\n[DEPRECATION WARNING]: The connection's stdin object is deprecated. Call display.prompt_until(msg) instead. This feature will be removed in version 2.19. Deprecation warnings can be disabled by setting \r\ndeprecation_warnings=False in ansible.cfg.\r\n<mapserver.adventurelog.io> ESTABLISH LOCAL CONNECTION FOR USER: jh\r\n<mapserver.adventurelog.io> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr `\"&& mkdir \"` echo /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980 `\" && echo ansible-tmp-1705150406.936408-75812-206974495734980=\"` echo /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980 `\" ) && sleep 0'\r\nUsing module file /Users/jh/.ansible/collections/ansible_collections/ansible/posix/plugins/modules/synchronize.py\r\n<mapserver.adventurelog.io> PUT /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/tmpl7lm2cze TO /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/AnsiballZ_synchronize.py\r\n<mapserver.adventurelog.io> EXEC /bin/sh -c 'chmod u+x /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/ /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/AnsiballZ_synchronize.py && sleep 0'\r\n<mapserver.adventurelog.io> EXEC /bin/sh -c '/Users/jh/Library/Application Support/pipx/venvs/ansible/bin/python /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/AnsiballZ_synchronize.py && sleep 0'\r\n<mapserver.adventurelog.io> EXEC /bin/sh -c 'rm -f -r /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [mapserver]: FAILED! => {\r\n    \"changed\": false,\r\n    \"module_stderr\": \"/bin/sh: /Users/jh/Library/Application: No such file or directory\\n\",\r\n    \"module_stdout\": \"\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 127\r\n}\r\n```\r\n\r\nThe problem is the command `EXEC /bin/sh -c '/Users/jh/Library/Application Support/pipx/venvs/ansible/bin/python /Users/jh/.ansible/tmp/ansible-local-7581028yvwxxr/ansible-tmp-1705150406.936408-75812-206974495734980/AnsiballZ_synchronize.py && sleep 0'`. \r\n\r\nThe path to python is not correctly escaped. This leads to the \"No such file or directory\" error.\r\n\r\nI'm not sure if this is a bug or a configuration problem, but it feels like spaces in the folder of the python interpreter should be properly handled. This bug also affects other modules that run locally.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-13T13:20:09Z",
        "user": "lukey78",
        "labels": [
            "easyfix",
            "bug",
            "has_pr",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82523,
        "title": "inconsistent backslash requirements with regex_replace()",
        "body": "### Summary\r\n\r\nWhen using the regex_replace() filter, double backslashes are required in the second parameter but not in the first.  Usage should be consistent.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nregex_replace\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n#> ansible --version\r\nansible [core 2.15.8]\r\n  config file = /home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg\r\n  configured module search path = ['/home/rowagn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /sso/sfw/virtualenv/ansible2_15_8/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/rowagn/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /sso/sfw/virtualenv/ansible2_15_8/bin/ansible\r\n  python version = 3.9.18 (main, Jan  4 2024, 13:17:05) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)] (/sso/sfw/virtualenv/ansible2_15_8/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n> ansible-config dump --only-changed\r\nCONFIG_FILE() = /home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg\r\nDEFAULT_EXECUTABLE(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = /etc/ansible-wrapper\r\nDEFAULT_TIMEOUT(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = 20\r\nEDITOR(env: EDITOR) = /bin/vim\r\nPAGER(env: PAGER) = /bin/less\r\nRETRY_FILES_ENABLED(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n#> cat /etc/redhat-release\r\nRed Hat Enterprise Linux Server release 7.9 (Maipo)\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nThe three tasks extract the integer from the list of strings in t and look for their presence in string s.\r\n```\r\n#> cat bug.yml\r\n- hosts: all\r\n  gather_facts: no\r\n  vars:\r\n    s: 'This is a string containing 1 and 2.'\r\n    t:\r\n      - p1_xyz\r\n      - p2_xyz\r\n      - p4_xyz\r\n\r\n  tasks:\r\n  - name: single backslash in first parameter\r\n    debug:\r\n      msg: '{{ item }} is in s'\r\n    loop: '{{ t }}'\r\n    when: ( item | regex_replace('^p(\\d+).*$', '\\\\1') ) in s\r\n\r\n  - name: double backslash in first parameter\r\n    debug:\r\n      msg: '{{ item }} is in s'\r\n    loop: '{{ t }}'\r\n    when: ( item | regex_replace('^p(\\\\d+).*$', '\\\\1') ) in s\r\n\r\n  - name: single backslash in second parameter\r\n    debug:\r\n      msg: '{{ item }} is in s'\r\n    loop: '{{ t }}'\r\n    when: ( item | regex_replace('^p(\\\\d+).*$', '\\1') ) in s\r\n```\r\n```\r\n#> cat l\r\nlocalhost\r\n```\r\n```\r\n#> ansible-playbook bug.yml -i ./l\r\n```\r\n\r\n### Expected Results\r\n\r\nFrom the examples at https://docs.ansible.com/ansible/latest/collections/ansible/builtin/regex_replace_filter.html, it looks like double backslashes are always required.  However, these results show that double backslashes are only required for the second parameter.  I would therefore expect the first task to not match anything.\r\n\r\n \r\n\r\n### Actual Results\r\n\r\n```console\r\n#> ansible-playbook bug.yml -i ./l\r\n\r\nPLAY [all] *********************************************************************************************************\r\n\r\nTASK [single backslash in first parameter] *************************************************************************\r\nok: [localhost] => (item=p1_xyz) => {\r\n    \"msg\": \"p1_xyz is in s\"\r\n}\r\nok: [localhost] => (item=p2_xyz) => {\r\n    \"msg\": \"p2_xyz is in s\"\r\n}\r\nskipping: [localhost] => (item=p4_xyz)\r\n\r\nTASK [double backslash in first parameter] *************************************************************************\r\nok: [localhost] => (item=p1_xyz) => {\r\n    \"msg\": \"p1_xyz is in s\"\r\n}\r\nok: [localhost] => (item=p2_xyz) => {\r\n    \"msg\": \"p2_xyz is in s\"\r\n}\r\nskipping: [localhost] => (item=p4_xyz)\r\n\r\nTASK [single backslash in second parameter] ************************************************************************\r\nskipping: [localhost] => (item=p1_xyz)\r\nskipping: [localhost] => (item=p2_xyz)\r\nskipping: [localhost] => (item=p4_xyz)\r\nskipping: [localhost]\r\n\r\nPLAY RECAP *********************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-11T15:28:46Z",
        "user": "rwagnergit",
        "labels": [
            "bug",
            "docs",
            "affects_2.15"
        ]
    },
    {
        "number": 82505,
        "title": "Validating arguments against arg spec occuring on all tagged roles",
        "body": "### Summary\r\n\r\nWhen specifying a `/meta/argument_specs.yml` file in multiples roles and running a playbook with tagged roles, the **Validating arguments against arg spec** task occurs for all roles even if the role will not run (no associated tag).\r\n\r\nThis behavior seems like a bug because this task (associated to a role) doesn't follow the role tagging system normal behavior.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nvalidate_argument_spec\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.16.2]\r\n  config file = /home/libvoid/Documents/*****/ansible.cfg\r\n  configured module search path = ['/home/libvoid/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/libvoid/.cache/pypoetry/virtualenvs/prod-jzrDeld9-py3.10/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/libvoid/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/libvoid/.cache/pypoetry/virtualenvs/prod-jzrDeld9-py3.10/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/home/libvoid/.cache/pypoetry/virtualenvs/prod-jzrDeld9-py3.10/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_PIPELINING(xxxxxx/ansible.cfg) = True\r\nCONFIG_FILE() = xxxxxx/ansible.cfg\r\nDEFAULT_HOST_LIST(xxxxxx/ansible.cfg) = ['xxxxxx/hosts']\r\nDEFAULT_ROLES_PATH(xxxxxx/ansible.cfg) = ['xxxxxx/roles']\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\nresult_format(xxxxxx/ansible.cfg) = yaml\r\nshow_task_path_on_failure(xxxxxx/ansible.cfg) = True\r\n\r\nminimal:\r\n_______\r\nresult_format(xxxxxx/ansible.cfg) = yaml\r\n\r\nCONNECTION:\r\n==========\r\n\r\nlocal:\r\n_____\r\npipelining(xxxxxx/ansible.cfg) = True\r\n\r\npsrp:\r\n____\r\npipelining(xxxxxx/ansible.cfg) = True\r\n\r\nssh:\r\n___\r\npipelining(xxxxxx/ansible.cfg) = True\r\n\r\nwinrm:\r\n_____\r\npipelining(xxxxxx/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nDebian 10/11/12\r\n\r\n### Steps to Reproduce\r\n\r\n1) Create a simple playbook `site.yml` with several tagged roles\r\n\r\n```yaml\r\n- name: Agents\r\n  hosts: agents\r\n  roles:\r\n    - { role: role1, tags: [agents, role1] }\r\n    - { role: role2, tags: [agents, role2] }\r\n    - { role: role3, tags: [agents, role3] }\r\n```\r\n\r\n2) Each role should have a `/meta/argument_specs.yml`. For instance :\r\n\r\n```yaml\r\nargument_specs:\r\n  # roles/role1/tasks/main.yml entry point\r\n  main:\r\n    options:\r\n      var1:\r\n        required: true\r\n        type: str\r\n```\r\n\r\n3) Run the playbook with the tag `role1`\r\n\r\n```bash\r\nansible-playbook site.yml -t role1 -CD\r\n```\r\n\r\n### Expected Results\r\n\r\nThe automatic **Validating arguments against arg** task should only run for the roles that will be executed (based on the tags).\r\n\r\n### Actual Results\r\n\r\nThe task is run for all the roles of the playbook.\r\n\r\n```console\r\nTASK [role1 : Validating arguments against arg spec 'main'] ************************************************************************************************\r\nok: [host1]\r\nok: [host2]\r\nTASK [role2 : Validating arguments against arg spec 'main'] ************************************************************************************************\r\nok: [host1]\r\nok: [host2]\r\nTASK [role3 : Validating arguments against arg spec 'main'] ************************************************************************************************\r\nok: [host1]\r\nok: [host2]\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-09T16:55:28Z",
        "user": "libvoid",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.16"
        ]
    },
    {
        "number": 82497,
        "title": "\"apt-key did not return an error, but failed to add the key (check that the id is correct and *not* a subkey)\" for expired key - but the key is added",
        "body": "### Summary\r\n\r\nI try to add a trusted key with `apt_key` from a URL and it fails with \"apt-key did not return an error, but failed to add the key (check that the id is correct and *not* a subkey)\"\r\n\r\nSame error as #76143, but in Ansible 2.16.2 and the key actually _is_ added to /etc/apt/trusted.gpg on the target.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt_key\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.2]\r\n  config file = /media/sf_work/lops2/ansible/ansible.cfg\r\n  configured module search path = ['/home/em/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/em/.direnv/python-3.12.1/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/em/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/em/.direnv/python-3.12.1/bin/ansible\r\n  python version = 3.12.1 (main, Dec 10 2023, 15:16:41) [GCC 9.4.0] (/home/em/.direnv/python-3.12.1/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /media/sf_work/lops2/ansible/ansible.cfg\r\nDEFAULT_BECOME(/media/sf_work/lops2/ansible/ansible.cfg) = True\r\nDEFAULT_FILTER_PLUGIN_PATH(/media/sf_work/lops2/ansible/ansible.cfg) = ['/media/sf_work/lops2/ansible/filter_plugins']\r\nDEFAULT_HASH_BEHAVIOUR(/media/sf_work/lops2/ansible/ansible.cfg) = merge\r\nDEFAULT_LOG_PATH(/media/sf_work/lops2/ansible/ansible.cfg) = /media/sf_work/lops2/ansible/ansible.log\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/media/sf_work/lops2/ansible/ansible.cfg) = ['/media/sf_work/lops2/ansible/lookup_plugins']\r\nDEFAULT_ROLES_PATH(/media/sf_work/lops2/ansible/ansible.cfg) = ['/media/sf_work/lops2/ansible/roles']\r\nDEFAULT_STDOUT_CALLBACK(/media/sf_work/lops2/ansible/ansible.cfg) = debug\r\nDEFAULT_TRANSPORT(/media/sf_work/lops2/ansible/ansible.cfg) = ssh\r\nDEFAULT_VAULT_PASSWORD_FILE(/media/sf_work/lops2/ansible/ansible.cfg) = /media/sf_work/lops2/ansible/tools/vault-keyring.sh\r\nDIFF_ALWAYS(/media/sf_work/lops2/ansible/ansible.cfg) = True\r\nEDITOR(env: EDITOR) = nano\r\nRETRY_FILES_ENABLED(/media/sf_work/lops2/ansible/ansible.cfg) = False\r\nTRANSFORM_INVALID_GROUP_CHARS(/media/sf_work/lops2/ansible/ansible.cfg) = ignore\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\npipelining(/media/sf_work/lops2/ansible/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nControl: Linux Mint 20\r\nTarget: Ubuntu 22.04.3\r\n\r\n### Steps to Reproduce\r\n\r\n`ansible -m apt_key -a 'url=https://www.mongodb.org/static/pgp/server-3.6.asc state=present' ansible-test -i test-inventory -vvvv`\r\n\r\nAlso happens with the key URL in #76143.\r\n\r\n### Expected Results\r\n\r\nThe module succeeds.\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible -m apt_key -a 'url=https://www.mongodb.org/static/pgp/server-3.6.asc state=present' ansible-test -i test-inventory -vvvv\r\nansible [core 2.16.2]\r\n  config file = /media/sf_work/lops2/ansible/ansible.cfg\r\n  configured module search path = ['/home/em/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/em/.direnv/python-3.12.1/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /home/em/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/em/.direnv/python-3.12.1/bin/ansible\r\n  python version = 3.12.1 (main, Dec 10 2023, 15:16:41) [GCC 9.4.0] (/home/em/.direnv/python-3.12.1/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n...\r\ndebug1: Sending command: /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-eltpfvjzyxewexzhzkfvecypdkwhodrm ; python3'\"'\"' && sleep 0'\r\ndebug2: channel 2: request exec confirm 1\r\ndebug3: send packet: type 98\r\ndebug3: mux_session_confirm: sending success reply\r\ndebug2: channel_input_open_confirmation: channel 2: callback done\r\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\r\ndebug2: channel 2: rcvd adjust 2097152\r\ndebug3: receive packet: type 99\r\ndebug2: channel_input_status_confirm: type 99 id 2\r\ndebug2: exec request accepted on channel 2\r\ndebug2: channel 2: rcvd adjust 65536\r\ndebug2: channel 2: read<=0 rfd 6 len 0\r\ndebug2: channel 2: read failed\r\ndebug2: channel 2: chan_shutdown_read (i0 o0 sock -1 wfd 6 efd 8 [write])\r\ndebug2: channel 2: input open -> drain\r\ndebug2: channel 2: ibuf empty\r\ndebug2: channel 2: send eof\r\ndebug3: send packet: type 96\r\ndebug2: channel 2: input drain -> closed\r\ndebug3: receive packet: type 96\r\ndebug2: channel 2: rcvd eof\r\ndebug2: channel 2: output open -> drain\r\ndebug2: channel 2: obuf empty\r\ndebug2: channel 2: chan_shutdown_write (i3 o1 sock -1 wfd 7 efd 8 [write])\r\ndebug2: channel 2: output drain -> closed\r\ndebug3: receive packet: type 98\r\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\r\ndebug3: mux_exit_message: channel 2: exit message, exitval 1\r\ndebug3: receive packet: type 97\r\ndebug2: channel 2: rcvd close\r\ndebug3: channel 2: will not send data after close\r\ndebug2: channel 2: send close\r\ndebug3: send packet: type 97\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: gc: notify user\r\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\r\ndebug2: channel 1: rcvd close\r\ndebug2: channel 1: output open -> drain\r\ndebug2: channel 1: chan_shutdown_read (i0 o1 sock 5 wfd 5 efd -1 [closed])\r\ndebug2: channel 1: input open -> closed\r\ndebug2: channel 2: gc: user detached\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: garbage collecting\r\ndebug1: channel 2: free: client-session, nchannels 3\r\ndebug3: channel 2: status: The following connections are open:\r\n  #1 mux-control (t16 nr0 i3/0 o1/16 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\r\n  #2 client-session (t4 r0 i3/0 o3/0 e[write]/0 fd -1/-1/8 sock -1 cc -1)\r\n\r\ndebug2: channel 1: obuf empty\r\ndebug2: channel 1: chan_shutdown_write (i3 o1 sock 5 wfd 5 efd -1 [closed])\r\ndebug2: channel 1: output drain -> closed\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: gc: notify user\r\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\r\ndebug2: channel 1: gc: user detached\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: garbage collecting\r\ndebug1: channel 1: free: mux-control, nchannels 2\r\ndebug3: channel 1: status: The following connections are open:\r\n  #1 mux-control (t16 nr0 i3/0 o3/0 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\r\n\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 1\r\nansible-test | FAILED! => {\r\n    \"after\": [\r\n        \"EB3E94ADBE1229CF\",\r\n        \"D94AA3F0EFE21092\",\r\n        \"871920D1991BC93C\"\r\n    ],\r\n    \"before\": [\r\n        \"EB3E94ADBE1229CF\",\r\n        \"D94AA3F0EFE21092\",\r\n        \"871920D1991BC93C\"\r\n    ],\r\n    \"changed\": true,\r\n    \"fp\": \"58712A2291FA4AD5\",\r\n    \"id\": \"58712A2291FA4AD5\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"data\": null,\r\n            \"file\": null,\r\n            \"id\": null,\r\n            \"keyring\": null,\r\n            \"keyserver\": null,\r\n            \"state\": \"present\",\r\n            \"url\": \"https://www.mongodb.org/static/pgp/server-3.6.asc\",\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"key_id\": \"58712A2291FA4AD5\",\r\n    \"msg\": \"apt-key did not return an error, but failed to add the key (check that the id is correct and *not* a subkey)\",\r\n    \"short_id\": \"91FA4AD5\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-08T15:21:07Z",
        "user": "loop-evgeny",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82471,
        "title": "When nr of forks > 74 then tasks are not executed since version 2.15.0",
        "body": "### Summary\r\n\r\nWe are using Ansible to patch Windows servers. I'm currently trying to upgrade our ansible version to the most recent one but I'm stuck on an issue with forks. Which I could have worked around if async would be working with the latest win_updates module but that is giving me issues too. \r\n\r\nWe are applying patches to a large number of hosts and are doing that in parallel to speed up things. Up to version 2.15.0 I can set forks to whatever number pleases me so that we can patch everything in parallel. When I use a version greater than 2.14.12 then the gathering of facts stops at 75 hosts without any error message and the task is not executed. There's no error message. I do get an exit code 2 after the summary but that's probably because not all of the host are reachable.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nnot sure\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ /root/.local/bin/ansible --version\r\n\r\nansible [core 2.16.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /root/.local/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /root/.local/bin/ansible\r\n  python version = 3.11.6 (main, Oct 13 2023, 15:52:55) [GCC 13.1.1 20230722] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\nACTION_WARNINGS(default) = True\r\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['profile_tasks']\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nWIN_ASYNC_STARTUP_TIMEOUT(/etc/ansible/ansible.cfg) = 20\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAlpine 3.19\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\nOutput dynamic Inventory:\r\n\r\n {\r\n    \"_meta\": {\r\n        \"hostvars\": {}\r\n\t}\r\n    \"windows\": {\r\n        \"vars\": {\r\n            \"ansible_port\": 5985,\r\n            \"ansible_connection\": \"winrm\",\r\n            \"ansible_winrm_server_cert_validation\": \"ignore\",\r\n            \"ansible_winrm_transport\": \"kerberos\",\r\n            \"ansible_user\": \"piet@SOMEDOMAIN.LOCAL\"\r\n         },\r\n        \"hosts\": [\r\n            \"dsad02\",\r\n            \"asdd01\",\r\n            \"saddasd\",\r\n            ...\r\n\t\t\t100 more hosts\r\n           ...\r\n        ]\r\n    }\r\n}\r\n\r\nplay:\r\n---\r\n- name: Test\r\n  hosts: windows\r\n  tasks:\r\n    - name: Test\r\n      ansible.windows.win_ping:\r\n\r\n\r\ncommand:\r\n\r\n/root/.local/bin/ansible-playbook -i inv/ -f 200 -e \"ansible_password=$PASS\" play.yml\r\n\r\n```\r\n\r\n### Expected Results\r\n\r\nExpected all hosts to be displayed under gather facts and under TASK [Test]. Task is never executed.\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [Test] *********************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************\r\nWednesday 03 January 2024  16:10:12 +0000 (0:00:00.033)       0:00:00.033 *****\r\n[WARNING]: The Windows version '6.3' is no longer supported or tested by Ansible.\r\nok: [dsad02]\r\nok: [asdd01]\r\nok: [saddasd]\r\n...\r\n>>> 75 out of +100 hosts\r\n...\r\n\r\nTASK [Test] *********************************************************************************************************************************************************************************************************************************\r\nWednesday 03 January 2024  16:10:28 +0000 (0:00:16.170)       0:00:16.203 *****\r\n>>> Nothing here !\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************************************************************************\r\ndsad02               : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\nasdd01               : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\nsaddasd               : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n...\r\n>>> all hosts\r\n...\r\n\r\nWednesday 03 January 2024  16:10:28 +0000 (0:00:00.002)       0:00:16.206 *****\r\n===============================================================================\r\nGathering Facts --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 16.17s\r\nTest --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.00s\r\n\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2024-01-03T16:40:32Z",
        "user": "jandunk",
        "labels": [
            "bug",
            "has_pr",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82459,
        "title": "Unarchive module inherits permissions from original zip-file. Docs not clear",
        "body": "### Summary\n\nFrom docs about \"mode\" opts in archive we read:\r\n\r\n> The permissions the resulting filesystem object should have.\r\n> \r\n> If [mode](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/unarchive_module.html#ansible-collections-ansible-builtin-unarchive-module-parameter-mode) is not specified and the destination filesystem object does not exist, the default umask on the system will be used when setting the mode for the newly created filesystem object.\r\n> \r\n> If [mode](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/unarchive_module.html#ansible-collections-ansible-builtin-unarchive-module-parameter-mode) is not specified and the destination filesystem object does exist, the mode of the existing filesystem object will be used.\r\n\r\nBut this description is not clear for me. Because zip-files can save original permissions. For example:\r\n```\r\nvodka@vodka-PC:/tmp$ zipinfo /tmp/555.zip \r\nArchive:  /tmp/555.zip\r\nZip file size: 572 bytes, number of entries: 4\r\ndrwxrwxr-x  3.0 unx        0 bx stor 23-Dec-25 21:42 555/\r\n-rwxrwx---  3.0 unx        0 bx stor 23-Dec-25 21:42 555/2\r\n-rwxrwxrwx  3.0 unx        0 bx stor 23-Dec-25 21:42 555/3\r\n-rwx------  3.0 unx        0 bx stor 23-Dec-25 21:42 555/1\r\n4 files, 0 bytes uncompressed, 0 bytes compressed:  0.0%\r\n\r\n```\r\n\r\nAnd after extraction:\r\n```\r\n---\r\n- name: \"unzip yaml\"\r\n  hosts: localhost\r\n  tasks:\r\n    - name: \"Unzip 555.zip\"\r\n      unarchive:\r\n        src: /tmp/555.zip\r\n        dest: /tmp/888/\r\n```\r\n\r\nWe get original permissions as in zip archive:\r\n```\r\nvodka@vodka-PC:/tmp$ ll ./888/555/\r\ntotal 8\r\ndrwxrwxr-x 2 vodka vodka 4096 \u0434\u0435\u043a 25 21:42 ./\r\ndrwxrwxrwx 3 vodka vodka 4096 \u0434\u0435\u043a 25 22:06 ../\r\n-rwx------ 1 vodka vodka    0 \u0434\u0435\u043a 25 21:42 1*\r\n-rwxrwx--- 1 vodka vodka    0 \u0434\u0435\u043a 25 21:42 2*\r\n-rwxrwxrwx 1 vodka vodka    0 \u0434\u0435\u043a 25 21:42 3*\r\n```\r\n\r\nBut we do not specify \"mode\" opts and according to docs our new files should have 775 permissions (as my 0002 umask).\r\n\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/modules/unarchive.py\n\n### Ansible Version\n\n```console\nansible [core 2.14.9]\r\n  config file = /home/vodka/.ansible.cfg\r\n  configured module search path = ['/home/vodka/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/vodka/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.6 (main, Oct  8 2023, 05:06:43) [GCC 13.2.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = /home/vodka/.ansible.cfg\r\nDEFAULT_FORKS(/home/vodka/.ansible.cfg) = 4\r\nDEFAULT_TIMEOUT(/home/vodka/.ansible.cfg) = 60\r\nHOST_KEY_CHECKING(/home/vodka/.ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/vodka/.ansible.cfg) = auto_silent\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/vodka/.ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/vodka/.ansible.cfg) = False\r\ntimeout(/home/vodka/.ansible.cfg) = 60\n```\n\n\n### OS / Environment\n\nUbuntu 23.10\n\n### Additional Information\n\nNeed add information that file permissions can be inherits in some cases if \"mode\" opts is not specified.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-25T19:14:37Z",
        "user": "4815162342lost",
        "labels": [
            "module",
            "P3",
            "needs_verified",
            "affects_2.14"
        ]
    },
    {
        "number": 82433,
        "title": "[get_url] fails with DNS errors when http_proxy and https_proxy are undefined and omitted",
        "body": "### Summary\r\n\r\nansible.builtin.get_url does not ignore proxy environment variables set with ... | default(None) | default(omit) filters and fails with irrelevant \"**Temporary failure in name resolution**\" error message.\r\nIt should ignore proxy settings if not set as ansible.builtin.apt and other modules do.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nget_url\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.2]\r\n  config file = /mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg\r\n  configured module search path = ['/home/yaroslav/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/yaroslav/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/yaroslav/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/yaroslav/.local/bin/ansible\r\n  python version = 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg\r\nDEFAULT_JINJA2_NATIVE(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = False\r\nPERSISTENT_COMMAND_TIMEOUT(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = 60\r\nPERSISTENT_CONNECT_TIMEOUT(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = 60\r\nSHOW_CUSTOM_STATS(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = True\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\nshow_custom_stats(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = True\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = False\r\nscp_if_ssh(/mnt/d/OneDrive/Code/Infrastructure-ansible/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n```console\r\n$ cat /etc/lsb-release\r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=22.04\r\nDISTRIB_CODENAME=jammy\r\nDISTRIB_DESCRIPTION=\"Ubuntu 22.04.3 LTS\"\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Implement the following playbook (initially tried by using tasks from community.zabbix collection to install zabbix agents):\r\nhttps://github.com/ansible-collections/community.zabbix/blob/main/roles/zabbix_agent/tasks/Debian.yml\r\nFilename: url_get_test.yml\r\n```\r\n---\r\n- hosts: localhost\r\n\r\n  tasks:\r\n  - name: \"Debian | Download gpg key\"\r\n    ansible.builtin.get_url:\r\n      url: http://repo.zabbix.com/zabbix-official-repo.key\r\n      dest: \"~/zabbix-official-repo.key\"\r\n      mode: \"0644\"\r\n      force: true\r\n    environment:\r\n      http_proxy: \"{{ zabbix_http_proxy | default(None) | default(omit) }}\"\r\n      https_proxy: \"{{ zabbix_https_proxy | default(None) | default(omit) }}\"\r\n    become: false\r\n    tags:\r\n      - install\r\n```      \r\n 2. ansible-playbook -i inventory/inventory.ini -k -u <your_username> -vvv url_get_test.yml\r\n 3. Get the error: \"msg\": \"Request failed: <urlopen error [Errno -3] Temporary failure in name resolution>\"\r\n\r\n### Expected Results\r\n\r\n# Achieved when the proxy vars are commented out\r\n```console\r\nTASK [Debian | Download gpg key] *******************************************************************************************************************************************************************************************************************************************************\r\ntask path: /mnt/d/OneDrive/Code/Infrastructure-ansible/url_get_test.yml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: yaroslav\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~yaroslav && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/yaroslav/.ansible/tmp `\"&& mkdir \"` echo /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981 `\" && echo ansible-tmp-1702912074.8073697-28185-127121582242981=\"` echo /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981 `\" ) && sleep 0'\r\nUsing module file /home/yaroslav/.local/lib/python3.10/site-packages/ansible/modules/get_url.py\r\n<127.0.0.1> PUT /home/yaroslav/.ansible/tmp/ansible-local-28076tfwahq35/tmp49w51j6t TO /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/AnsiballZ_get_url.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/ /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/AnsiballZ_get_url.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/AnsiballZ_get_url.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/ > /dev/null 2>&1 && sleep 0'\r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"checksum_dest\": null,\r\n    \"checksum_src\": \"2e9c2a85f0ef5f81e21734833f61e7774441bd48\",\r\n    \"dest\": \"/home/yaroslav/zabbix-official-repo.key\",\r\n    \"elapsed\": 0,\r\n    \"gid\": 1000,\r\n    \"group\": \"yaroslav\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": \"\",\r\n            \"ciphers\": null,\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"decompress\": true,\r\n            \"dest\": \"/home/yaroslav/zabbix-official-repo.key\",\r\n            \"force\": true,\r\n            \"force_basic_auth\": false,\r\n            \"group\": null,\r\n            \"headers\": null,\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"mode\": \"0644\",\r\n            \"owner\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"timeout\": 10,\r\n            \"tmp_dest\": null,\r\n            \"unredirected_headers\": [],\r\n            \"unsafe_writes\": false,\r\n            \"url\": \"http://repo.zabbix.com/zabbix-official-repo.key\",\r\n            \"url_password\": null,\r\n            \"url_username\": null,\r\n            \"use_gssapi\": false,\r\n            \"use_netrc\": true,\r\n            \"use_proxy\": true,\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"md5sum\": \"29dd6f8234591edc38ac53272b1666df\",\r\n    \"mode\": \"0644\",\r\n    \"msg\": \"OK (2938 bytes)\",\r\n    \"owner\": \"yaroslav\",\r\n    \"size\": 2938,\r\n    \"src\": \"/home/yaroslav/.ansible/tmp/ansible-tmp-1702912074.8073697-28185-127121582242981/tmpe7g9g8p0\",\r\n    \"state\": \"file\",\r\n    \"status_code\": 200,\r\n    \"uid\": 1000,\r\n    \"url\": \"http://repo.zabbix.com/zabbix-official-repo.key\"\r\n}\r\n```\r\n### Actual Results\r\n\r\n```console\r\nTASK [Debian | Download gpg key] *******************************************************************************************************************************************************************************************************************************************************\r\ntask path: /mnt/d/OneDrive/Code/Infrastructure-ansible/url_get_test.yml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: yaroslav\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~yaroslav && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/yaroslav/.ansible/tmp `\"&& mkdir \"` echo /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943 `\" && echo ansible-tmp-1702912042.7635632-28051-129180776043943=\"` echo /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943 `\" ) && sleep 0'\r\nUsing module file /home/yaroslav/.local/lib/python3.10/site-packages/ansible/modules/get_url.py\r\n<127.0.0.1> PUT /home/yaroslav/.ansible/tmp/ansible-local-27942f8v4ws0s/tmpsor0a4lg TO /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943/AnsiballZ_get_url.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943/ /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943/AnsiballZ_get_url.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'http_proxy=None https_proxy=None /usr/bin/python3 /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943/AnsiballZ_get_url.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/yaroslav/.ansible/tmp/ansible-tmp-1702912042.7635632-28051-129180776043943/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"dest\": \"/home/yaroslav/zabbix-official-repo.key\",\r\n    \"elapsed\": 0,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": \"\",\r\n            \"ciphers\": null,\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"decompress\": true,\r\n            \"dest\": \"/home/yaroslav/zabbix-official-repo.key\",\r\n            \"force\": true,\r\n            \"force_basic_auth\": false,\r\n            \"group\": null,\r\n            \"headers\": null,\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"mode\": \"0644\",\r\n            \"owner\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"timeout\": 10,\r\n            \"tmp_dest\": null,\r\n            \"unredirected_headers\": [],\r\n            \"unsafe_writes\": false,\r\n            \"url\": \"http://repo.zabbix.com/zabbix-official-repo.key\",\r\n            \"url_password\": null,\r\n            \"url_username\": null,\r\n            \"use_gssapi\": false,\r\n            \"use_netrc\": true,\r\n            \"use_proxy\": true,\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"msg\": \"Request failed: <urlopen error [Errno -3] Temporary failure in name resolution>\",\r\n    \"url\": \"http://repo.zabbix.com/zabbix-official-repo.key\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-18T15:46:04Z",
        "user": "yaroslavhlushko",
        "labels": [
            "module",
            "bug",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 82424,
        "title": "Lookup or filter variant of include_vars",
        "body": "### Summary\n\n`include_vars` reads a file as YAML then renders Jinja inside string nodes and replaces them with results. There is no equivalent lookup or filter.\r\n\r\n`lookup('template', file) | from_yaml` reads a file as Jinja, then parses YAML.\r\n\r\nPlease add equivalent of `include_vars` as a lookup and/or filter: `lookup('file', file) | read_vars`, `lookup('read_vars', file)`\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nbase\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-14T15:11:20Z",
        "user": "Vladimir-csp",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 82408,
        "title": "backup option: implement custom naming for files ( ansible_managed like )",
        "body": "### Summary\n\nThis feature requests is based on  [issue 16305](https://github.com/ansible/ansible/issues/16305) but takes out of the way  the management of the permissions for the new files that would be created, since we are just adding more control over the naming scheme (except for #3, maybe )\r\nIt would be great if the naming of the backup file can be controlled via something similar to the [ansible_managed](https://docs.ansible.com/archive/ansible/2.4/intro_configuration.html#ansible-managed) inside the `ansible.cfg` \r\n\r\nin this way setting it I could address the following use cases:\r\n1. decide to create a single backup file ( setting it to `${filename}.backup` ) \r\n2. change the format of the backup name  ( `$filename.$( date \"+%s\")`)\r\n3.  change the path of the file ( `.backup/$filename.$( date \"+%s\")` . **Creation of the backup directory must be handled by another task** \r\n\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ntemplate, copy\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nansible.cfg \r\n```cfg\r\n[defaults]\r\nansible_backup = {target_file}.%Y%m%d_%H%M%S\r\n```\r\n\r\ntask.yml\r\n```yaml \r\n- name: Apply the template\r\n  hosts: your_hosts\r\n  vars:\r\n    dest_file: /path/to/your/file.conf\r\n\r\n  tasks:\r\n    - name: Apply the template\r\n      template:\r\n        src: your_template.j2\r\n        dest: \"{{ dest_file }}\"\r\n        backup: true\r\n```\r\n\r\nThis will create `/path/to/your/file.conf.20231212.142835`\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-12T13:29:40Z",
        "user": "andreagrax",
        "labels": [
            "module",
            "feature"
        ]
    },
    {
        "number": 82393,
        "title": "apt_repository errors out with multiline strings with trailing newline",
        "body": "### Summary\r\n\r\nI tried to switch from Ansible 2.15.7 to 2.16.1 and discovered, that apt_repository fails on me when I try to run a task as described in the steps to reproduce.\r\n\r\nI did some quick debugging and saw, that in [module_utils/basic.py:376](https://github.com/ansible/ansible/blob/a9919dd7f62c9efe17b8acaebf7c627606ae9f66/lib/ansible/module_utils/basic.py#L376) the buffere contains some json including the input with its newline. The newline then causes `json.loads` to fail. \r\n\r\nMy simple (and probably correct) fix was to replace `>` with `>-` to strip the trailing newline. However, I did not find any mention of this behaviour change in the porting guide (since this did work in 2.15.7) and without some debugging I could have never known the true reason for this error, so the error message could be improved (verbose logging did not help).\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt_repository\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.1]\r\n  config file = /home/poehler/dev/ansible/ansible.cfg\r\n  configured module search path = ['/home/poehler/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/poehler/dev/ansible/venv/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/poehler/dev/ansible/collections:/home/poehler/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/poehler/dev/ansible/venv/bin/ansible\r\n  python version = 3.11.6 (main, Oct  8 2023, 05:06:43) [GCC 13.2.0] (/home/poehler/dev/ansible/venv/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/home/poehler/dev/ansible/ansible.cfg) = ['foconis_prometheus_push_callback']\r\nCOLLECTIONS_PATHS(/home/poehler/dev/ansible/ansible.cfg) = ['/home/poehler/dev/ansible/collections', '/home/poehler/.ansible/collections', '/usr/share/ansible/collections']\r\nCONFIG_FILE() = /home/poehler/dev/ansible/ansible.cfg\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/home/poehler/dev/ansible/ansible.cfg) = ['/usr/share/ansible/plugins/callback', '/home/poehler/dev/ansible/plugins/callback']\r\nDEFAULT_FORKS(/home/poehler/dev/ansible/ansible.cfg) = 10\r\nDEFAULT_GATHERING(/home/poehler/dev/ansible/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/poehler/dev/ansible/ansible.cfg) = ['/home/poehler/dev/ansible/hosts']\r\nDEFAULT_ROLES_PATH(/home/poehler/dev/ansible/ansible.cfg) = ['/home/poehler/dev/ansible/roles', '/home/poehler/.ansible/roles', '/usr/share/ansible/roles', '/etc/ansible/roles']\r\nDEFAULT_STDOUT_CALLBACK(/home/poehler/dev/ansible/ansible.cfg) = yaml\r\nDEFAULT_VARS_PLUGIN_PATH(/home/poehler/dev/ansible/ansible.cfg) = ['/usr/share/ansible/plugins/vars', '/home/poehler/dev/ansible/plugins/vars']\r\nDISPLAY_SKIPPED_HOSTS(/home/poehler/dev/ansible/ansible.cfg) = False\r\nPAGER(env: PAGER) = less\r\n\r\nCALLBACK:\r\n========\r\n\r\nfoconis_prometheus_push_callback:\r\n________________________________\r\ngateway_url(/home/poehler/dev/ansible/ansible.cfg) = https://some.url\r\n\r\ndefault:\r\n_______\r\ndisplay_skipped_hosts(/home/poehler/dev/ansible/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\npipelining(/home/poehler/dev/ansible/ansible.cfg) = True\r\n\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 23.10 running on WSL\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n- name: \"Remove old docker repository configuration\"\r\n  ansible.builtin.apt_repository:\r\n    repo: >\r\n      deb [arch=amd64]\r\n      https://download.docker.com/linux/{{ ansible_distribution | lower if ansible_distribution == 'Debian' or\r\n      ansible_distribution == 'Ubuntu' else omit }} {{ ansible_lsb.codename }} stable\r\n    filename: docker\r\n    state: absent\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nEither this just works (as in 2.15) or the error I get is more helpful for me to actually understand, what I'm doing wrong.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [docker : Remove old docker repository configuration] *********************************************************************************************************************************************************************************************************************************************************\r\ntask path: /home/poehler/dev/ansible/roles/docker/tasks/install.yml:30\r\nfatal: [localhost]: FAILED! => changed=false \r\n  msg: 'Error: Module unable to decode valid JSON on stdin.  Unable to figure out what parameters were passed'\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-11T09:05:28Z",
        "user": "jonasPoehler",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82366,
        "title": "lookup return a list instead of a string",
        "body": "### Summary\n\nWith ansible 2.17.0 and 2.14.12 ; `lookup(\u2026, allow_unsafe=True)` return a list.\r\n\r\nEven if we force wantlist to false: `lookup(\u2026, allow_unsafe=True, wantlist=False)`\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlookup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.17.0.dev0] (official-devel 6ebefaceb6) last updated 2023/12/06 13:22:42 (GMT +200)\r\n  config file = /home/max/.ansible.cfg\r\n  configured module search path = ['/home/max/.ansible/modules']\r\n  ansible python module location = /home/max/Documents/repositories/github.com/ansible/ansible/lib/ansible\r\n  ansible collection location = /home/max/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/max/Documents/repositories/github.com/ansible/ansible/bin/ansible\r\n  python version = 3.11.6 (main, Nov 14 2023, 09:36:21) [GCC 13.2.1 20230801] (/home/max/Documents/repositories/github.com/ansible/ansible/venv/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/max/.ansible.cfg\r\nDEFAULT_FORCE_HANDLERS(/home/max/.ansible.cfg) = True\r\nDEFAULT_HOST_LIST(/home/max/.ansible.cfg) = ['/home/max/.ansible/oxalide-full-hosts']\r\nDEFAULT_MODULE_PATH(/home/max/.ansible.cfg) = ['/home/max/.ansible/modules']\r\nDEFAULT_MODULE_UTILS_PATH(/home/max/.ansible.cfg) = ['/home/max/.ansible/module_utils']\r\nDIFF_ALWAYS(/home/max/.ansible.cfg) = True\r\nEDITOR(env: EDITOR) = nvim\r\nINTERPRETER_PYTHON(/home/max/.ansible.cfg) = auto_silent\r\nRETRY_FILES_ENABLED(/home/max/.ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nArchlinux\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - debug:\r\n        msg: toto {{ lookup('config', 'INTERPRETER_PYTHON', allow_unsafe=False) }}\r\n    - debug:\r\n        msg: toto {{ lookup('config', 'INTERPRETER_PYTHON', wantlist=True) }}\r\n    - debug:\r\n        msg: toto {{ lookup('config', 'INTERPRETER_PYTHON', allow_unsafe=True, wantlist=False) }}\r\n```\n\n### Expected Results\n\n```\r\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto auto_silent\"\r\n}\r\n\r\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto ['auto_silent']\"\r\n}\r\n\r\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto auto_silent\"\r\n}\r\n```\n\n### Actual Results\n\n```console\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto auto_silent\"\r\n}\r\n\r\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto ['auto_silent']\"\r\n}\r\n\r\nTASK [debug] ***********************\r\nok: [localhost] => {\r\n    \"msg\": \"toto ['auto_silent']\"\r\n}\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-06T14:09:43Z",
        "user": "tchernomax",
        "labels": [
            "bug",
            "P3",
            "affects_2.17"
        ]
    },
    {
        "number": 82358,
        "title": "Calling `display.deprecated` with `removed=True` break the `proxy_display` method",
        "body": "### Summary\r\n\r\nWhen calling display.deprecated method with `removed` set to True, the code will raise an `AnsibleError` that won't be caught here: https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/strategy/__init__.py#L118 leading while loop crashing\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-core\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.1]\r\n  config file = None\r\n  configured module search path = ['/Users/gm/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/gm/.pyenv/versions/3.10.3/envs/ansible-avd/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /Users/gm/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/guillaumemulocher/.pyenv/versions/ansible-avd/bin/ansible\r\n  python version = 3.10.3 (main, Jul 29 2022, 21:02:56) [Clang 13.0.0 (clang-1300.0.29.30)] (/Users/gm/.pyenv/versions/3.10.3/envs/ansible-avd/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_FORCE_COLOR(env: ANSIBLE_FORCE_COLOR) = True\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\nINTERPRETER_PYTHON(env: ANSIBLE_PYTHON_INTERPRETER) = /Users/gm/.pyenv/shims/python\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nOSX\r\n\r\n### Steps to Reproduce\r\n\r\nWe have a custom module calling display.deprecated with `removed` true to generate the warning.\r\nIn 2.15.7 this works perfectly informing the user that the variable in our schema she is trying to use has been removed and stop the playbook execution.\r\n\r\nIn 2.16 the playbooks never finishes\r\n\r\nrepro: https://github.com/gmuloc/ansible-2.16-remove-display-issue-demo\r\n\r\n### Expected Results\r\n\r\nThe AnsibleError is caught, the deprecation message is printed and the playbook does not hang\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [arista.avd.eos_designs : Set eos_designs facts] **************************\r\ntask path: /Users/gm/Github/ansible-avd/ansible_collections/arista/avd/roles/eos_designs/tasks/main.yml:29\r\nException in thread Thread-6 (results_thread_main):\r\nTraceback (most recent call last):                                                                                                                                                                                                              File \"/Users/gm/.pyenv/versions/3.10.3/lib/python3.10/threading.py\", line 1009, in _bootstrap_inner\r\n    self.run()\r\n  File \"/Users/gm/.pyenv/versions/3.10.3/lib/python3.10/threading.py\", line 946, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/Users/gm/.pyenv/versions/3.10.3/envs/ansible-avd/lib/python3.10/site-packages/ansible/plugins/strategy/__init__.py\", line 120, in results_thread_main\r\n    dmethod(*result.args, **result.kwargs)\r\n  File \"/Users/gm/.pyenv/versions/3.10.3/envs/ansible-avd/lib/python3.10/site-packages/ansible/utils/display.py\", line 134, in proxyit\r\n    return method(self, *args, **kwargs)\r\n  File \"/Users/gm/.pyenv/versions/3.10.3/envs/ansible-avd/lib/python3.10/site-packages/ansible/utils/display.py\", line 519, in deprecated\r\n    raise AnsibleError(message_text)\r\nansible.errors.AnsibleError: [DEPRECATED]: [removed-schema-connected-endpoints]: The input data model 'servers[0].adapters[0].server_ports' was removed. Use 'endpoint_ports' instead. This feature was removed from arista.avd.eos_designs in\r\n version 4.0.0. Please update your playbooks.\r\n^C\r\nAborted!\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-05T12:33:14Z",
        "user": "gmuloc",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 82337,
        "title": "Become with doas on local connections doesn't work",
        "body": "### Summary\r\n\r\nBecome with `doas` works fine on ssh connections, but using local connection it doesn't, forcing a password prompt for every task in the playbook.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nbecome\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$$ ansible --version\r\nansible [core 2.16.0]\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.6 (main, Nov 14 2023, 09:36:21) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nManjaro Linux\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n`local.yml`:\r\n\r\n```yaml (paste below)\r\n---\r\n- name: PoC\r\n  hosts: localhost\r\n  connection: local\r\n  become: true\r\n  tasks:\r\n    - debug:\r\n        msg: \"Test\"\r\n    - command:\r\n        cmd: id\r\n      register: id\r\n    - debug:\r\n        msg: \"{{ id.stdout }}\"\r\n```\r\n\r\n### Expected Results\r\n\r\n```console\r\n$$ ansible-playbook -K local.yml\r\nBECOME password:\r\n\r\nPLAY [PoC] ******************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] ****************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"Test\"\r\n}\r\n\r\nTASK [command] **************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [debug] ****************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"uid=0(root) gid=0(root) groups=0(root)\"\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************\r\nlocalhost                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n$$ ansible-playbook -K --become-method doas local.yml\r\nBECOME password:\r\n\r\nPLAY [PoC] ******************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************************\r\ndoas (user@host) password:\r\nok: [localhost]\r\n\r\nTASK [debug] ****************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"Test\"\r\n}\r\n\r\nTASK [command] **************************************************************************************************************************************\r\ndoas (user@host) password:\r\nchanged: [localhost]\r\n\r\nTASK [debug] ****************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"uid=0(root) gid=0(root) groups=0(root)\"\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************\r\nlocalhost                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-12-04T00:47:25Z",
        "user": "vaygr",
        "labels": [
            "bug",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82312,
        "title": "Allow querying specified user account name in ansible_ssh_common_args",
        "body": "### Summary\r\n\r\nI work for an MSP with many different client environments, and some of them require use of SSH Proxies / Jump hosts. There are a few of us who are Ansible-oriented, who write common playbooks and use them in AWX / AAP.\r\n\r\nFor our workflow it makes the most amount of sense to specify everything unique to a particular client, in the appropriate inventory for that client. (So not in `.ssh/config` or the playbook).\r\n\r\nCurrently, it seems like this should be the best way to do what we need:\r\n    \r\n  * `ansible_ssh_common_args: -J {{ q(\"config\", \"remote_user\", plugin_type=\"connection\", plugin_name=\"ssh\") }}@jumphost`\r\n  \r\n    * But it does not work - the result is `[None]@jumphost`.\r\n    * This was suggested as solution based on a coming feature here: https://groups.google.com/g/ansible-project/c/fY5lAHCEHfA\r\n\r\nShort of creating some kind of custom credential type in AWX / AAP, which I don't know if it'd even work, I can't see a simpler way to fix this.\r\n\r\nAllowing the query plugin to fetch `remote_user` in `ansible_ssh_common_args` seems like a reasonably low-breakage change that would definitely help us in this situation, and I can imagine it'd help others, seeing as this question has been asked a few times before.\r\n\r\nI may have missed something, but I've spent a lot of time trying to find a solution to this, but had no luck so far.\r\n\r\nThis was previously requested here https://github.com/ansible/ansible/issues/74121 and summarily closed. I have asked in the Matrix chat and got no response.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible-core\r\n\r\n### Additional Information\r\n\r\nHere's what I've tried to achieve the same thing, with no success:\r\n\r\n  * `ansible_ssh_common_args: -J jumphost`\r\n\r\n    * This works for me, but breaks the moment that the jump host account name is different to the user ansible is **running from locally**. \r\n    * This includes AWX / AAP as the default `awx-ee` runs either as root (older versions) or as `uid=1000` (with no username)\r\n  \r\n  * `ansible_ssh_common_args: -J nroach44@jumphost`\r\n  \r\n    * This works for me, both locally and in AWX, but won't work for others.\r\n  \r\n  * `ansible_ssh_common_args: -J shared_acct@jumphost`\r\n  \r\n    * This will only work if we're using `shared_acct` on the targets as well, because AWX only allows us to specify one set of machine credentials.\r\n    * Some clients may have rules (perhaps even legally defined) disallowing use of shared accounts when not absolutely necessary.\r\n    \r\n  * `ansible_ssh_common_args: -J {{ ansible_ssh_user }}@jumphost`\r\n  \r\n    * Does not work automatically, as none of the variables that contain the connecting user name are available at this point. \r\n    * This would only work if we specify `ansible_ssh_user` elsewhere, which either means hard-coding the username in the inventory, or modifying all of our AWX / AAP templates to add a survey asking \"what's your username\".\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-29T02:59:36Z",
        "user": "nroach44",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 82310,
        "title": "'Role' object has no attribute '_parent'",
        "body": "### Summary\r\n\r\nSome Taggable-Objects don't have a _parent, etc. which is wrong.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncallback plugin\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.16.0]\r\n  config file = /.../ansible.cfg\r\n  configured module search path = ['/.../library']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /.../.ansible/galaxy\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.6 (main, Nov 14 2023, 09:36:21) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOWS(/.../ansible.cfg) = True\r\nANSIBLE_PIPELINING(/.../ansible.cfg) = True\r\nCOLLECTIONS_PATHS(/.../ansible.cfg) = ['/.../.ansible/galaxy']\r\nCONFIG_FILE() = /.../ansible.cfg\r\nDEFAULT_HOST_LIST(/.../ansible.cfg) = ['/.../production']\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/.../ansible.cfg) = True\r\nDEFAULT_MODULE_PATH(/.../ansible.cfg) = ['/.../library']\r\nDEFAULT_ROLES_PATH(/.../ansible.cfg) = ['/.../.ansible/galaxy/roles']\r\nDEFAULT_STDOUT_CALLBACK(/.../ansible.cfg) = yaml\r\nINTERPRETER_PYTHON(/.../ansible.cfg) = auto_silent\r\nUSE_PERSISTENT_CONNECTIONS(/.../ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nManjaro\r\n\r\n### Steps to Reproduce\r\n\r\n```python\r\nfor role in play.roles:\r\n    # Play stores all roles in play.roles (via role statement or import/include_role)\r\n    if role.from_include:\r\n        continue\r\n\r\n    role_tags = role.tags\r\n    # Combine play and role statement tags, because unlike for import/include_role\r\n    # tasks, the play tags have not already been incorporated.\r\n    role.tags = role.tags + play.tags\r\n    if role.evaluate_tags(play.only_tags, play.skip_tags, []):\r\n        # Roles imported via the `roles` keywords\r\n        pending_roles.add(role.get_name())\r\n    role.tags = role_tags\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nno error\r\n\r\n### Actual Results\r\n\r\n```console\r\n[WARNING]: Failure using method (v2_playbook_on_start) in callback plugin (<ansible.plugins.callback.magic_vault.CallbackModule object at 0x7ffa3604c810>): 'Role' object has no attribute '_parent'\r\nCallback Exception: \r\n  File \"/usr/lib/python3.11/site-packages/ansible/executor/task_queue_manager.py\", line 465, in send_callback\r\n    method(*new_args, **kwargs)\r\n   File \"/.../callback_plugins/magic_vault.py\", line 117, in v2_playbook_on_start\r\n    pending_roles = self._get_pending_roles(play)\r\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   File \"/.../callback_plugins/magic_vault.py\", line 212, in _get_pending_roles\r\n    if role.evaluate_tags(play.only_tags, play.skip_tags, []):\r\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n   File \"/usr/lib/python3.11/site-packages/ansible/playbook/taggable.py\", line 64, in evaluate_tags\r\n    obj = obj._parent\r\n          ^^^^^^^^^^^\r\n66 plays in site.yml\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-28T17:00:05Z",
        "user": "mabezi",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 82281,
        "title": "refresh_inventory stops further handlers",
        "body": "### Summary\n\nWhen `ansible.builtin.meta: refresh_inventory` is one of the handlers, no subsequent handler is executed.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.meta\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.16.0]\r\n  config file = None\r\n  configured module search path = ['/Users/me/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/Cellar/ansible/9.0.1/libexec/lib/python3.12/site-packages/ansible\r\n  ansible collection location = /Users/me/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.12.0 (main, Oct  2 2023, 12:03:24) [Clang 15.0.0 (clang-1500.0.40.1)] (/opt/homebrew/Cellar/ansible/9.0.1/libexec/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nmacOS Sonoma 14.1.1\n\n### Steps to Reproduce\n\n```yaml\r\n- name: Minimal reproducible example\r\n  hosts: localhost\r\n  tasks:\r\n    - debug:\r\n        msg: \"Main\"\r\n      changed_when: true\r\n      notify:\r\n        - handler\r\n  handlers:\r\n    - debug:\r\n        msg: \"Before\"\r\n      listen:\r\n        - handler\r\n    - meta: refresh_inventory\r\n      listen:\r\n        - handler\r\n    - debug:\r\n        msg: \"After\"\r\n      listen:\r\n        - handler\r\n```\r\n\n\n### Expected Results\n\nThe third handler should output \"After\".\r\n\r\n```\r\nPLAY [Minimal reproducible example] ********************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nchanged: [localhost] => {\r\n    \"msg\": \"Main\"\r\n}\r\n\r\nRUNNING HANDLER [debug] ********************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"Before\"\r\n}\r\n\r\nRUNNING HANDLER [meta] *********************************************************\r\n\r\nRUNNING HANDLER [debug] ********************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"After\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\n\n### Actual Results\n\n```console\nThe third handler is never executed.\r\n\r\n\r\n\r\nPLAY [Minimal reproducible example] ********************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nchanged: [localhost] => {\r\n    \"msg\": \"Main\"\r\n}\r\n\r\nRUNNING HANDLER [debug] ********************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"Before\"\r\n}\r\n\r\nRUNNING HANDLER [meta] *********************************************************\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-24T10:23:46Z",
        "user": "fabrykowski",
        "labels": [
            "module",
            "bug",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 82260,
        "title": "How am I supposed to pass galaxy_token?",
        "body": "### Summary\n\nSo according to random tidbits in these bug reports:\r\n\r\nhttps://github.com/ansible/ansible/issues/65933\r\nhttps://github.com/ansible/ansible/issues/70887\r\n\r\nI'm supposed to define my Galaxy token either in `~/.ansible.cfg` or `~/.ansible/galaxy_token`. The former works just fine, the issue is, _sometimes_ `ansible-galaxy` wants to use my (empty) `~/.ansible/galaxy_token` instead, it loads nothing, and the request fails with 403 unauthorized.\r\n\r\n```\r\n$ ansible-galaxy role import noobient ansible-galaxy-nginx -vvvv\r\nansible-galaxy [core 2.15.6]\r\n  config file = /home/bviktor/.ansible.cfg\r\n  configured module search path = ['/home/bviktor/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/bviktor/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/bviktor/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/bviktor/.local/bin/ansible-galaxy\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /home/bviktor/.ansible.cfg as config file\r\nInitial connection to galaxy_server: https://galaxy.ansible.com/api/\r\nOpened /home/bviktor/.ansible/galaxy_token\r\nCalling Galaxy at https://galaxy.ansible.com/api/\r\nFound API version 'v3, pulp-v3, v1' with Galaxy server galaxy-ng (https://galaxy.ansible.com/api/)\r\nCalling Galaxy at https://galaxy.ansible.com/api/v1/imports/\r\nERROR! None (HTTP Code: 403, Message: Forbidden)\r\n```\r\n\r\nSo then I try to put my token in `~/.ansible/galaxy_token` as is, like so:\r\n\r\n```\r\nmy_token\r\n```\r\n\r\nand then:\r\n\r\n```\r\nGalaxy token file /home/bviktor/.ansible/galaxy_token malformed, unable to read it\r\n```\r\n\r\nThen I tried:\r\n\r\n```\r\ntoken: my_token\r\n```\r\n\r\nWhich gives:\r\n\r\n```\r\nOpened /home/bviktor/.ansible/galaxy_token\r\n```\r\n\r\nBut still fails with 403. Same result with:\r\n\r\n```\r\n---\r\ntoken: my_token\r\n```\r\n\r\nOr surrounding the token with '', or \"\". Same result.\r\n\r\nCan someone please explain the correct formatting I have to use in `~/.ansible/galaxy_token` ?\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/galaxy/token.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.6]\r\n  config file = /home/bviktor/.ansible.cfg\r\n  configured module search path = ['/home/bviktor/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/bviktor/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/bviktor/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/bviktor/.local/bin/ansible\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/bviktor/.ansible.cfg\r\nGALAXY_SERVER_LIST(/home/bviktor/.ansible.cfg) = ['galaxy-ng']\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.3 in WSL on Windows 11.\r\n\r\n```\r\nWSL version: 2.0.9.0\r\nKernel version: 5.15.133.1-1\r\nWSLg version: 1.0.59\r\nMSRDC version: 1.2.4677\r\nDirect3D version: 1.611.1-81528511\r\nDXCore version: 10.0.25131.1002-220531-1700.rs-onecore-base2-hyp\r\nWindows version: 10.0.22631.2715\r\n```\r\n\r\n```\r\n$ pip list | grep -i ansible\r\nansible                   8.6.1\r\nansible-builder           3.0.0\r\nansible-compat            4.1.10\r\nansible-core              2.15.6\r\nansible-lint              6.22.0\r\n```\n\n### Additional Information\n\nI would be able to use ansible-galaxy.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-21T13:59:03Z",
        "user": "bviktor",
        "labels": [
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 82245,
        "title": "ansible-playbook does a huge number of repetitive file operations",
        "body": "### Summary\r\n\r\nWith ansible-core 2.15 and 2.16 using a simple playbook to just print \"hi\" once with large inventories ansible still opens some files almost 200k times.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.0]\r\n  config file = /home/testuser/test/ansible.cfg\r\n  configured module search path = ['/home/testuser/test/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible\r\n  ansible collection location = /home/testuser/test/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/testuser/test/ansible/ansible-2.16/bin/ansible\r\n  python version = 3.12.0 (main, Oct  2 2023, 00:00:00) [GCC 13.2.1 20230918 (Red Hat 13.2.1-3)] (/home/testuser/test/ansible/ansible-2.16/bin/python3.12)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_HOME(/home/testuser/test/ansible.cfg) = /home/testuser/test/.ansible\r\nANSIBLE_NOCOWS(/home/testuser/test/ansible.cfg) = True\r\nCALLBACKS_ENABLED(/home/testuser/test/ansible.cfg) = ['ansible.posix.profile_tasks']\r\nCOLLECTIONS_ON_ANSIBLE_VERSION_MISMATCH(/home/testuser/test/ansible.cfg) = error\r\nCOLLECTIONS_SCAN_SYS_PATH(/home/testuser/test/ansible.cfg) = False\r\nCONFIG_FILE() = /home/testuser/test/ansible.cfg\r\nDEFAULT_STDOUT_CALLBACK(/home/testuser/test/ansible.cfg) = ansible.builtin.default\r\nEDITOR(env: EDITOR) = /usr/bin/vim\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\npretty_results(/home/testuser/test/ansible.cfg) = True\r\nresult_format(/home/testuser/test/ansible.cfg) = yaml\r\nshow_task_path_on_failure(/home/testuser/test/ansible.cfg) = True\r\n\r\nminimal:\r\n_______\r\npretty_results(/home/testuser/test/ansible.cfg) = True\r\nresult_format(/home/testuser/test/ansible.cfg) = yaml\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 9, Fedora 39\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n$ echo '[test]' > i ; for i in $(seq 1 10000) ; do echo host$i.example.com >> i ; done ;\r\n$ cat t.yml \r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - debug:\r\n        msg: hi\r\n      delegate_to: localhost\r\n      run_once: true\r\n$ time LC_ALL=C.UTF-8 PYTHONUNBUFFERED=1 ansible-playbook -c local -i ./i t.yml -vvvvvv 2>&1 | ts -m -s \"%.T\"\r\n00:00:00.140569 ansible-playbook [core 2.16.0]\r\n00:00:00.141190   config file = /home/testuser/test/ansible.cfg\r\n00:00:00.141208   configured module search path = ['/home/testuser/test/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n00:00:00.141217   ansible python module location = /home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible\r\n00:00:00.141225   ansible collection location = /home/testuser/test/.ansible/collections:/usr/share/ansible/collections\r\n00:00:00.141233   executable location = /home/testuser/test/ansible/ansible-2.16/bin/ansible-playbook\r\n00:00:00.141240   python version = 3.12.0 (main, Oct  2 2023, 00:00:00) [GCC 13.2.1 20230918 (Red Hat 13.2.1-3)] (/home/testuser/test/ansible/ansible-2.16/bin/python3.12)\r\n00:00:00.141251   jinja version = 3.1.2\r\n00:00:00.141265   libyaml = True\r\n00:00:00.141276 Using /home/testuser/test/ansible.cfg as config file\r\n00:00:00.141290 setting up inventory plugins\r\n00:00:00.222833 Loading collection ansible.builtin from \r\n00:00:00.229008 host_list declined parsing /home/testuser/test/i as it did not pass its verify_file() method\r\n00:00:00.229051 script declined parsing /home/testuser/test/i as it did not pass its verify_file() method\r\n00:00:00.229062 auto declined parsing /home/testuser/test/i as it did not pass its verify_file() method\r\n00:00:00.513121 Parsed /home/testuser/test/i inventory source with ini plugin\r\n00:00:00.636468 Loading callback plugin default of type stdout, v2.0 from /home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/callback/default.py\r\n00:00:00.644860 Loading collection ansible.posix from /home/testuser/test/.ansible/collections/ansible_collections/ansible/posix\r\n00:00:00.646624 Attempting to use 'default' callback.\r\n00:00:00.646656 Skipping callback 'default', as we already have a stdout callback.\r\n00:00:00.646666 Attempting to use 'junit' callback.\r\n00:00:00.646674 Attempting to use 'minimal' callback.\r\n00:00:00.646683 Skipping callback 'minimal', as we already have a stdout callback.\r\n00:00:00.646690 Attempting to use 'oneline' callback.\r\n00:00:00.646701 Skipping callback 'oneline', as we already have a stdout callback.\r\n00:00:00.646744 Attempting to use 'tree' callback.\r\n00:00:00.646754 Attempting to use 'ansible.posix.profile_tasks' callback.\r\n00:00:00.646774 Loading callback plugin ansible.posix.profile_tasks of type aggregate, v2.0 from /home/testuser/test/.ansible/collections/ansible_collections/ansible/posix/plugins/callback/profile_tasks.py\r\n00:00:00.646815 \r\n00:00:00.646830 PLAYBOOK: t.yml ****************************************************************\r\n00:00:00.646857 Positional arguments: t.yml\r\n00:00:00.646876 verbosity: 6\r\n00:00:00.646887 connection: local\r\n00:00:00.646912 become_method: sudo\r\n00:00:00.646923 tags: ('all',)\r\n00:00:00.646936 inventory: ('/home/testuser/test/i',)\r\n00:00:00.646960 forks: 5\r\n00:00:00.646970 1 plays in t.yml\r\n00:00:00.656677 \r\n00:00:00.656732 PLAY [all] *********************************************************************\r\n00:00:23.403621 \r\n00:00:23.403681 TASK [debug] *******************************************************************\r\n00:00:23.403693 task path: /home/testuser/test/t.yml:4\r\n00:00:23.403701 Monday 20 November 2023  08:32:06 +0200 (0:00:22.757)       0:00:22.757 ******* \r\n00:00:23.419098 ok: [host1.example.com -> localhost] => \r\n00:00:23.419186     msg: hi\r\n00:01:12.551074 \r\n00:01:12.551157 PLAY RECAP *********************************************************************\r\n00:01:12.551173 host1.example.com          : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n00:01:12.551181 \r\n00:01:12.551188 Monday 20 November 2023  08:32:55 +0200 (0:00:49.147)       0:01:11.904 ******* \r\n00:01:12.551196 =============================================================================== \r\n00:01:12.551206 debug ------------------------------------------------------------------ 49.15s\r\n00:01:12.551221 /home/testuser/test/t.yml:4 ---------------------------------------------------\r\n\r\nreal\t1m12.677s\r\nuser\t1m11.101s\r\nsys\t0m1.185s\r\n$ strace -ff -s 1024 ansible-playbook -c local -i ./i t.yml > strace-output.txt 2>&1\r\n$ grep 'openat(' strace-output.txt | sort | uniq -c | awk '{if ($1>100) print}'\r\n  60001 [pid  1538] openat(AT_FDCWD, \"/home/testuser/test/.ansible/plugins/connection\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = -1 ENOENT (No such file or directory)\r\n  20001 [pid  1538] openat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/connection\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = 6\r\n  40000 [pid  1538] openat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/connection\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = 8\r\n  20001 [pid  1538] openat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/connection/__pycache__\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = 6\r\n  40000 [pid  1538] openat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/connection/__pycache__\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = 8\r\n  60001 [pid  1538] openat(AT_FDCWD, \"/usr/share/ansible/plugins/connection\", O_RDONLY|O_NONBLOCK|O_CLOEXEC|O_DIRECTORY) = -1 ENOENT (No such file or directory)\r\n$ grep 'statat(' strace-output.txt | sort | uniq -c | awk '{if ($1>100) print}'\r\n  20001 [pid  1538] newfstatat(6, \"\", {st_mode=S_IFDIR|0755, st_size=128, ...}, AT_EMPTY_PATH) = 0\r\n  20001 [pid  1538] newfstatat(6, \"\", {st_mode=S_IFDIR|0755, st_size=187, ...}, AT_EMPTY_PATH) = 0\r\n  40000 [pid  1538] newfstatat(8, \"\", {st_mode=S_IFDIR|0755, st_size=128, ...}, AT_EMPTY_PATH) = 0\r\n  40000 [pid  1538] newfstatat(8, \"\", {st_mode=S_IFDIR|0755, st_size=187, ...}, AT_EMPTY_PATH) = 0\r\n  30000 [pid  1538] newfstatat(AT_FDCWD, \"/home/testuser/test/.ansible/plugins/action\", 0x7fff9471dee0, 0) = -1 ENOENT (No such file or directory)\r\n  30000 [pid  1538] newfstatat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/lib64/python3.12/site-packages/ansible/plugins/action/meta.py\", 0x7fff9471dee0, 0) = -1 ENOENT (No such file or directory)\r\n 180003 [pid  1538] newfstatat(AT_FDCWD, \"/home/testuser/test/i\", {st_mode=S_IFREG|0644, st_size=208901, ...}, 0) = 0\r\n  30000 [pid  1538] newfstatat(AT_FDCWD, \"/usr/share/ansible/plugins/action\", 0x7fff9471dee0, 0) = -1 ENOENT (No such file or directory)\r\n    155 newfstatat(AT_FDCWD, \"/home/testuser/test/ansible/ansible-2.16/bin\", {st_mode=S_IFDIR|0755, st_size=4096, ...}, 0) = 0\r\n  30010 newfstatat(AT_FDCWD, \"/home/testuser/test/i\", {st_mode=S_IFREG|0644, st_size=208901, ...}, 0) = 0\r\n    157 newfstatat(AT_FDCWD, \"/usr/lib64/python3.12\", {st_mode=S_IFDIR|0755, st_size=8192, ...}, 0) = 0\r\n```\r\n\r\n### Expected Results\r\n\r\nAnsible should not do same file operations over and over again.\r\n\r\n### Actual Results\r\n\r\nSee above, same files being checked and opened a huge number of times.\r\n\r\nIt is possible that the count of fstat is high partially due to https://lwn.net/Articles/944214/ but it won't explain everything. I'll try to check if the fixes for this issue have already landed on Fedora 39 but as said it won't explain everything.\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-20T08:28:59Z",
        "user": "myllynen",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 82214,
        "title": "ansible-test uses hardcoded `/tmp` with tempfile.mkdtemp() instead of relying on env vars",
        "body": "### Summary\n\nwhen executing ansible-test on a Linux system having mounted /tmp with the options `noexec,nosuid`, the following error appears:\r\n```\r\nFATAL: Path \"/tmp/ansible-test-xxxxxx-injector/python.py\" should be executable, but is not. Is the filesystem mounted with the \"noexec\" option?\r\n```\r\n\r\nfrom my point of view, the code in question should rather use `os.environment.get('TMPDIR', '/tmp')` instead of just `/tmp` with `tempfile.mkdtemp()`:\r\nhttps://github.com/ansible/ansible/blob/devel/test/lib/ansible_test/_internal/util_common.py#L296\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-test\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = None\r\n  configured module search path = ['/home/me/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/me/projects/ansible/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/me/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/me/.venvs/ansible-2.14.1/bin/ansible\r\n  python version = 3.10.12 (main, Jul  5 2023, 18:54:27) [GCC 11.2.0] (/home/me/.venvs/ansible-2.14.1/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nRHEL 7, any Linux distribution\n\n### Steps to Reproduce\n\nexecute `ansible-test sanity` on any Linux system having `/tmp` mounted with the options `noexec,nosuid,nodev`:\r\n```bash\r\n$ ansible-test sanity -vvv\r\n```\r\n\n\n### Expected Results\n\nrespect the environment variable `TMPDIR` to point to a file-system not having the restrictions of `noexec,nosuid,nodev` when using ansible-test \n\n### Actual Results\n\n```console\n$ ansible-test sanity -vvv\r\nConfigured locale: en_US.UTF-8\r\nCreating container database.\r\n>>> Container Database\r\n{}\r\nRead 0 sanity test ignore line(s) for Ansible 2.14 from: tests/sanity/ignore-2.14.txt\r\nRunning sanity test \"action-plugin-docs\"\r\nInitializing \"/tmp/ansible-test-kvworxnz-injector\" as the temporary directory.\r\nFATAL: Path \"/tmp/ansible-test-kvworxnz-injector/python.py\" should be executable, but is not. Is the filesystem mounted with the \"noexec\" option?\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-14T14:23:47Z",
        "user": "sonomac",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.14"
        ]
    },
    {
        "number": 82188,
        "title": "ansible.builtin.expect echo arg doesn't work as expected",
        "body": "### Summary\r\n\r\nProtecting the whole expect task output with no_log is usually not possible because the output has to be recorded.\r\n\r\nSince a command or a script that is asking for a password is usually already protecting the password not showing it while it's being inserted, it would be very useful if each ansible expect responses containing \"password\" could be hidden from the log.\r\n\r\nAnother viable solution is to have the whole responses arg with `no_log=true` (like the uri password arg)\r\n```\r\n  \"invocation\": {\r\n    \"module_args\": {\r\n      \"command\": \"/usr/bin/foo\",\r\n      \"responses\": {\r\n        \"(?i)Please enter the password for your account name\": \"user\",\r\n        \"(?i)Please enter the password for your account\": \"password in plain text\"\r\n        \"(?i)Please confirm your password\": \"password in plain text\"\r\n      },\r\n```\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nexpect\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-10T16:18:46Z",
        "user": "TyraelTLK",
        "labels": [
            "module",
            "has_pr",
            "feature",
            "needs_verified"
        ]
    },
    {
        "number": 82186,
        "title": "validate_argument_spec `type=list` and `elements=str` convert bool or int in a list of string",
        "body": "### Summary\n\nHi team,\r\n\r\nI notice that the in the validate_argument_spec module, when we validate a list, validation try to convert it in a list and in case of int or boolean (in python bool is intended as int with `isinstance` function) will be \"casted\" to string: https://github.com/ansible/ansible/blob/667526c22ff59bbe7bc790bf505b7f09cae3856f/lib/ansible/module_utils/common/validation.py#L390-L410\r\n\r\nThis is intended?\r\n\r\nMoreover there is a way to force the \"strict\" validation instead a validation that try to \"convert\" data?\r\nSomething like `allow_conversion` that i see in `check_type_str` but that is not used by `validate_argument_spec`.\r\n\r\nBecuase in that way we can strict the value and/or use it in the module as parameters (or add it as keyof model), to have a strinct check .\r\n\r\nThanks\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nvalidate_argument_spec\n\n### Ansible Version\n\n```console\nansible [core 2.15.1]\r\n  python version = 3.10.6\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCACHE_PLUGIN(/etc/ansible/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/etc/ansible/ansible.cfg) = /tmp/facts_cache\r\nCACHE_PLUGIN_TIMEOUT(/etc/ansible/ansible.cfg) = 7200\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = smart\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(/etc/ansible/ansible.cfg) = 7200\r\n_uri(/etc/ansible/ansible.cfg) = /tmp/facts_cache\n```\n\n\n### OS / Environment\n\nUbuntu 22.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Test\r\n  hosts: localhost\r\n  vars:\r\n    params:\r\n      add_options: true\r\n  tasks:\r\n    - name: verify \r\n      ansible.builtin.validate_argument_spec:\r\n        argument_spec: '{{ required_data }}'\r\n        provided_arguments: \"{{ params }}\"\r\n      vars:\r\n        required_data:\r\n          add_options:\r\n            type: list\r\n            default: []\r\n            elements: str\r\n```\r\n\n\n### Expected Results\n\nTask will fail because:\r\n\r\n1. Type of add_options is boolean\r\n2. If will be performet a convertion of single element in a list, i'm expect that element in list will be boolean, but is converted to string\r\n\n\n### Actual Results\n\n```console\nTask will pass\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-10T15:32:27Z",
        "user": "tanganellilore",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 82154,
        "title": "Unexpected role argument spec behavior with transitive dependencies",
        "body": "### Summary\r\n\r\nI've found some unexpected behavior with role's dependency and `argument_spec` mechanisms\r\n\r\nThere are two roles: `role_a` and `role_b`. `role_b` has `role_a` as a dependency. Both roles are stored inside Git repository, are valid and available for installation via `ansible-galaxy` CLI tool.\r\n\r\nWhen I try to run playbook that imports\\includes `role_b`, Ansible runs `validate_argument_spes` for `role_a` with additional \"parameters\": `src`, `scm` and `version` and it fails\r\n\r\nHowever for local roles it works perfectly. For `tar.gz` and Git-cloned roles an error occurs\r\n\r\nAs far as i understood, there is a bug with created task for `validate_argument_spec` module: [somehow `src`  is inside `provided_arguments`](https://github.com/ansible/ansible/blob/v2.16.0/lib/ansible/plugins/action/validate_argument_spec.py#L71) and [after merge with `args_from_vars` `src` is treated as dependency's role variable](https://github.com/ansible/ansible/blob/v2.16.0/lib/ansible/plugins/action/validate_argument_spec.py#L81)\r\n\r\nReleases 2.16.0 and below are affected\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nargument_specs, role_dependency, lib/ansible/plugins/action/validate_argument_spec.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.16.0]\r\n  config file = /home/pavel/Programming/Ansible/ansible-dependency-chain/ansible.cfg\r\n  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/pavel/Programming/Ansible/ansible-dependency-chain/venv/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/pavel/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/pavel/Programming/Ansible/ansible-dependency-chain/venv/bin/ansible\r\n  python version = 3.11.6 (main, Oct  8 2023, 05:06:43) [GCC 13.2.0] (/home/pavel/Programming/Ansible/ansible-dependency-chain/venv/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/pavel/Programming/Ansible/ansible-dependency-chain/ansible.cfg\r\nDEFAULT_ROLES_PATH(/home/pavel/Programming/Ansible/ansible-dependency-chain/ansible.cfg) = ['/home/pavel/Programming/Ansible/ansible-dependency-chain/ext_roles']\r\n\r\n```\r\n\r\n### OS / Environment\r\n\r\n```console\r\n\u276f cat /etc/os-release \r\nPRETTY_NAME=\"Debian GNU/Linux trixie/sid\"\r\nNAME=\"Debian GNU/Linux\"\r\nVERSION_CODENAME=trixie\r\nID=debian\r\nHOME_URL=\"https://www.debian.org/\"\r\nSUPPORT_URL=\"https://www.debian.org/support\"\r\nBUG_REPORT_URL=\"https://bugs.debian.org/\"\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nList of used repositories:\r\n- https://github.com/VorobevPavel-dev/role_a\r\n- https://github.com/VorobevPavel-dev/role_b\r\n- https://github.com/VorobevPavel-dev/ansible-dependency-chain\r\n\r\n1. Clone repo with config, requirements and target playbook\r\n    ```bash\r\n    git clone git@github.com:VorobevPavel-dev/ansible-dependency-chain.git\r\n    cd ./ansible-dependency-chain\r\n    ```\r\n2. Create and activate virtualenv. Install necessary Python packages\r\n    ```bash\r\n    python3.11 -m virtualenv venv\r\n    source ./venv/bin/activate\r\n    pip install -r ./requirements.txt\r\n    ```\r\n3. Install `role_b` from `requirements.yml` via `ansible-galaxy` CLI tool. It will be stored inside `./ext_roles` directory\r\n    ```bash\r\n    ansible-galaxy install -r ./requirements.yml\r\n    ```\r\n4. Run playbook `main.yml`\r\n    ```bash\r\n    ansible-playbook ./main.yml -vvvvv\r\n    ```\r\n\r\n### Expected Results\r\n\r\nSuccessful run\r\n\r\n### Actual Results\r\n\r\nRaw output:\r\n```console\r\n\u276f ansible-playbook ./main.yml \r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [Call role with chain dependency] **************************************************************************************************************************************************\r\n\r\nTASK [Import high-level role] ***********************************************************************************************************************************************************\r\n\r\nTASK [role_a : Validating arguments against arg spec 'main' - Add suffix and prefix to string] ******************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"argument_errors\": [\"scm, src, version. Supported parameters include: role_a_base, role_a_prefix, role_a_suffix.\"], \"argument_spec_data\": {\"role_a_base\": {\"description\": \"String to wrap\", \"required\": true, \"type\": \"str\"}, \"role_a_prefix\": {\"default\": \"Hello, \", \"description\": \"String to add at the beginning of role_a_base\", \"required\": false, \"type\": \"str\"}, \"role_a_suffix\": {\"default\": \"!\", \"description\": \"String to add at the end of role_a_base\", \"required\": false, \"type\": \"str\"}}, \"changed\": false, \"msg\": \"Validation of arguments failed:\\nscm, src, version. Supported parameters include: role_a_base, role_a_prefix, role_a_suffix.\", \"validate_args_context\": {\"argument_spec_name\": \"main\", \"name\": \"role_a\", \"path\": \"/home/pavel/Programming/Ansible/ansible-dependency-chain/ext_roles/role_a\", \"type\": \"role\"}}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nError as JSON:\r\n```json\r\n{\r\n    \"argument_errors\": [\r\n        \"scm, src, version. Supported parameters include: role_a_base, role_a_prefix, role_a_suffix.\"\r\n    ],\r\n    \"argument_spec_data\": {\r\n        \"role_a_base\": {\r\n            \"description\": \"String to wrap\",\r\n            \"required\": true,\r\n            \"type\": \"str\"\r\n        },\r\n        \"role_a_prefix\": {\r\n            \"default\": \"Hello, \",\r\n            \"description\": \"String to add at the beginning of role_a_base\",\r\n            \"required\": false,\r\n            \"type\": \"str\"\r\n        },\r\n        \"role_a_suffix\": {\r\n            \"default\": \"!\",\r\n            \"description\": \"String to add at the end of role_a_base\",\r\n            \"required\": false,\r\n            \"type\": \"str\"\r\n        }\r\n    },\r\n    \"changed\": false,\r\n    \"msg\": \"Validation of arguments failed:\\nscm, src, version. Supported parameters include: role_a_base, role_a_prefix, role_a_suffix.\",\r\n    \"validate_args_context\": {\r\n        \"argument_spec_name\": \"main\",\r\n        \"name\": \"role_a\",\r\n        \"path\": \"/home/pavel/Programming/Ansible/ansible-dependency-chain/ext_roles/role_a\",\r\n        \"type\": \"role\"\r\n    }\r\n}\r\n```\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-07T06:44:11Z",
        "user": "VorobevPavel-dev",
        "labels": [
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.16",
            "affects_2.18"
        ]
    },
    {
        "number": 82135,
        "title": " When using multiple inventory files and nested groups order is significant",
        "body": "### Summary\r\n\r\nThis is precisely #16116. But since it was closed and I can't reopen it, I have to open a new one. The fix in that issue fixes order only for vars, while the issue itself was about host definitions as well.\r\n\r\nSo jump to the issue itself:\r\nWhen using multiple inventory files with nested groups, any inventory file that contains children referenced in an earlier inventory file is not seen and causes an error.\r\n\r\nThe patch was suggested here: https://github.com/ShiwenMa/ansible/pull/1 or here https://github.com/ansible/ansible/commit/47326e8454eb1f94383f936d630da3de6e6da399, but it fixes nothing! It just removes the error message.\r\n\r\nThis is a bug report about documented behavior: https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#managing-inventory-load-order, so probably this is a feature request.\r\n\r\nAlso, if I use multiple YAML inventory files, my tests show that the order is insignificant, and everything works as expected.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ninventory\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible [core 2.15.5]\r\n  config file = None\r\n  configured module search path = ['/home/peter/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/peter/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/lib/python-exec/python3.10/ansible\r\n  python version = 3.10.13 (main, Sep 21 2023, 18:55:47) [GCC 13.2.1 20230826] (/usr/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nDEFAULT_VAULT_PASSWORD_FILE(env: ANSIBLE_VAULT_PASSWORD_FILE) = /home/peter/.ansible_vault_password_lfstrm\r\nEDITOR(env: EDITOR) = /usr/bin/vim\r\nPAGER(env: PAGER) = /usr/bin/less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nCentOS, Gentoo Linux and everywhere\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nThe inventory contains the following inventory files\r\n1.parentgoup\r\n2.childgroup\r\n\r\nContents of inventory files are\r\n$ cat inventory/1.parentgoup \r\n```ini\r\n[testgroup:children]\r\nchildgroup\r\n```\r\n$ cat inventory/2.childgroup \r\n```ini\r\n[childgroup]\r\nchild\r\n```\r\nCommand is\r\n\r\n$ `ansible-playbook playbooks/common.yml --limit 'testgroup' --list-hosts`\r\n\r\n### Expected Results\r\n\r\nplaybook: playbooks/common.yml\r\n```\r\n  play #1 (all): all    TAGS: []\r\n    pattern: [u'all']\r\n    hosts (1):\r\n      child\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nERROR! /etc/ansible/inventory/1.parentgoup:2: Section [testgroup:children] includes undefined group: childgroup\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-05T13:24:44Z",
        "user": "pva",
        "labels": [
            "bug",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 82114,
        "title": "include_tasks' apply recursivity option",
        "body": "### Summary\r\n\r\n# Context\r\nConsider the following architecture:\r\n_main.yml:_\r\n```yml\r\n- name: include factory\r\n  include_tasks: factory.yml\r\n  apply:\r\n    tags:\r\n      - always\r\n  tags:\r\n    - always\r\n```\r\n_factory.yml:_\r\n```yml\r\n- name: include hourly\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - hourly\r\n  loop: \"{{ hourly }}\"\r\n- name: daily\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - daily\r\n  loop: \"{{ daily }}\"\r\n```\r\n\r\nFollowing the documentation this should work in the following manner if we run the playbook with tag `hourly`:\r\n_main.yml_ &rarr; _factory.yml_ &rarr; _generic.yml_ over the items of `hourly` &rarr; exit\r\n\r\nOn the other hand it runs the _generic.yml_ over the elements of the `daily` object too. This is probably because the `apply` option creates a block in which it includes the tasks mentioned in the configuration in the task. This causes the tasks to inherit the options from the block and therefore the tagging downwards will break if the upper block has always on it.\r\n\r\n# The request\r\nIt would be great to have an option to toggle the recursive algorithm on the `include_tasks`' `apply` option. The default could be `yes` so it would keep the backwards compatibility if anyone built playbook using this algorithm.\r\n\r\n# Current workaround\r\n_main.yml:_\r\n```yml\r\n- name: include factory\r\n  include_tasks: factory.yml\r\n  tags:\r\n    - always\r\n```\r\n_factory.yml:_\r\n```yml\r\n- name: include hourly\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - hourly\r\n  loop: \"{{ hourly }}\"\r\n  tags:\r\n    - always\r\n- name: daily\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - daily\r\n  loop: \"{{ daily }}\"\r\n  tags:\r\n    - always\r\n```\r\n# Cause of the request\r\nThis workaround causes redundancy in code and because the documentation doesn't explicitly mentions the recursive meaning of `apply` option it could confuse developers.\r\n\r\n### Issue Type\r\n\r\nDocumentation Report\r\n\r\n### Component Name\r\n\r\ninclude_tasks.py\r\n\r\n### Additional Information\r\n\r\n# Example usage\r\n_main.yml:_\r\n```yml\r\n- name: include factory\r\n  include_tasks: factory.yml\r\n  apply:\r\n    tags:\r\n      - always\r\n    recursive: no\r\n  tags:\r\n    - always\r\n```\r\n_factory.yml:_\r\n```yml\r\n- name: include hourly\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - hourly\r\n  loop: \"{{ hourly }}\"\r\n- name: daily\r\n  include_tasks: generic.yml\r\n  apply:\r\n    tags:\r\n      - daily\r\n  loop: \"{{ daily }}\"\r\n```\r\n# Flow of the example:\r\n_main.yml_ &rarr; _factory.yml_ &rarr; _generic.yml_ over the items of `hourly` &rarr; skipping _generic.yml_ over the items of `daily` since the tag is not present &rarr; exit\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-11-02T08:36:49Z",
        "user": "aklakina",
        "labels": [
            "module",
            "docs",
            "affects_2.18"
        ]
    },
    {
        "number": 82084,
        "title": "Unhandled exception with 'is filter' and 'is test'",
        "body": "### Summary\r\n\r\nIf a non-existent name is checked with `is filter` or `is test`, the test aborts with an error, due to an unhandled exception in the Ansible code. Actually, the test should just evaluate to `false`.\r\n\r\n```jinja2\r\n{{ 'not_existing' is filter }}\r\n{{ 'not_existing' is test }}\r\n```\r\n\r\nIn previous Ansible versions this did not lead to any error. With Ansible Core 2.13.13 the execution works as expected.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\n`lib/ansible/template/__init__.py`\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.5]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/xolyu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/dist-packages/ansible\r\n  ansible collection location = /home/xolyu/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 22.04.3 LTS `jammy`\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n\r\n- name: is filter\r\n  hosts: localhost\r\n  gather_facts: no\r\n\r\n  tasks:\r\n\r\n    - name: Check if 'join' is a filter.\r\n      debug:\r\n        msg: \"{{ 'join' is filter }}\"\r\n\r\n    - name: Check if 'not_existing' is a filter.\r\n      debug:\r\n        msg: \"{{ 'not_existing' is filter }}\"\r\n      ignore_errors: yes\r\n\r\n    - name: Check if 'eq' is a test.\r\n      debug:\r\n        msg: \"{{ 'eq' is test }}\"\r\n\r\n    - name: Check if 'not_existing' is a test.\r\n      debug:\r\n        msg: \"{{ 'not_existing' is test }}\"\r\n      ignore_errors: yes\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI was expecting this issue, however received error listed below.\r\n\r\nThe listed and expected issue is from **Ansible Core 2.13.13** running Ubuntu 20.04 with Python 3.8.10 and Jinja 3.1.2. On the older system **the playbook works flawlessly**.\r\n\r\n```\r\n$ ansible-playbook is_filter.yml\r\n\r\nPLAY [is filter] *****************************************************************************************************\r\n\r\nTASK [Check if 'join' is a filter.] **********************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": true\r\n}\r\n\r\nTASK [Check if 'not_existing' is a filter.] **************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": false\r\n}\r\n\r\nTASK [Check if 'eq' is a test.] **************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": true\r\n}\r\n\r\nTASK [Check if 'not_existing' is a test.] ****************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": false\r\n}\r\n\r\nPLAY RECAP ***********************************************************************************************************\r\nlocalhost                  : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible-playbook is_filter.yml -vvv\r\nansible-playbook [core 2.15.5]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/xolyu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/dist-packages/ansible\r\n  ansible collection location = /home/xolyu/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: is_filter.yml ******************************************************************************************************************\r\n1 plays in is_filter.yml\r\n\r\nPLAY [is filter] *************************************************************************************************************************\r\n\r\nTASK [Check if 'join' is a filter.] ******************************************************************************************************\r\ntask path: /home/xolyu/Ansible-Dev/is_filter.yml:10\r\nok: [localhost] => {\r\n    \"msg\": true\r\n}\r\n\r\nTASK [Check if 'not_existing' is a filter.] **********************************************************************************************\r\ntask path: /home/xolyu/Ansible-Dev/is_filter.yml:14\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 480, in __getitem__\r\n    func = self._delegatee[key]\r\nKeyError: 'not_existing'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/executor/task_executor.py\", line 533, in _execute\r\n    self._task.post_validate(templar=templar)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/playbook/task.py\", line 290, in post_validate\r\n    super(Task, self).post_validate(templar)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/playbook/base.py\", line 548, in post_validate\r\n    value = templar.template(getattr(self, name))\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 786, in template\r\n    d[k] = self.template(\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 760, in template\r\n    result = self.do_template(\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 1004, in do_template\r\n    res = myenv.concat(rf)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/native_helpers.py\", line 43, in ansible_eval_concat\r\n    head = list(islice(nodes, 2))\r\n  File \"<template>\", line 17, in root\r\n  File \"/usr/local/lib/python3.10/dist-packages/jinja2/tests.py\", line 66, in test_filter\r\n    return value in env.filters\r\n  File \"/usr/lib/python3.10/_collections_abc.py\", line 830, in __contains__\r\n    self[key]\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 483, in __getitem__\r\n    raise TemplateSyntaxError('Could not load \"%s\": %s' % (key, to_native(original_exc or e)), 0)\r\njinja2.exceptions.TemplateSyntaxError: Could not load \"not_existing\": 'not_existing'\r\n  line 0\r\nfatal: [localhost]: FAILED! => {}\r\n...ignoring\r\n\r\nTASK [Check if 'eq' is a test.] **********************************************************************************************************\r\ntask path: /home/xolyu/Ansible-Dev/is_filter.yml:19\r\nok: [localhost] => {\r\n    \"msg\": true\r\n}\r\n\r\nTASK [Check if 'not_existing' is a test.] ************************************************************************************************\r\ntask path: /home/xolyu/Ansible-Dev/is_filter.yml:23\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 480, in __getitem__\r\n    func = self._delegatee[key]\r\nKeyError: 'not_existing'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/executor/task_executor.py\", line 533, in _execute\r\n    self._task.post_validate(templar=templar)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/playbook/task.py\", line 290, in post_validate\r\n    super(Task, self).post_validate(templar)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/playbook/base.py\", line 548, in post_validate\r\n    value = templar.template(getattr(self, name))\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 786, in template\r\n    d[k] = self.template(\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 760, in template\r\n    result = self.do_template(\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 1004, in do_template\r\n    res = myenv.concat(rf)\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/native_helpers.py\", line 43, in ansible_eval_concat\r\n    head = list(islice(nodes, 2))\r\n  File \"<template>\", line 17, in root\r\n  File \"/usr/local/lib/python3.10/dist-packages/jinja2/tests.py\", line 88, in test_test\r\n    return value in env.tests\r\n  File \"/usr/lib/python3.10/_collections_abc.py\", line 830, in __contains__\r\n    self[key]\r\n  File \"/usr/local/lib/python3.10/dist-packages/ansible/template/__init__.py\", line 483, in __getitem__\r\n    raise TemplateSyntaxError('Could not load \"%s\": %s' % (key, to_native(original_exc or e)), 0)\r\njinja2.exceptions.TemplateSyntaxError: Could not load \"not_existing\": 'not_existing'\r\n  line 0\r\nfatal: [localhost]: FAILED! => {}\r\n...ignoring\r\n\r\nPLAY RECAP *******************************************************************************************************************************\r\nlocalhost                  : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=2\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-26T20:41:58Z",
        "user": "xolyu",
        "labels": [
            "bug",
            "P3",
            "affects_2.15",
            "data_tagging"
        ]
    },
    {
        "number": 82014,
        "title": "Support testing in \"externally managed\" environments",
        "body": "### Summary\r\n\r\nPEP 668 introduced the concept of \"externally managed\" environments. In these environments, pip 23+ will only install packages within virtual environments by default. Changes to various testing components are required to support this new behavior:\r\n\r\n- ansible-test\r\n- container builds which use `pip` to install packages\r\n- integration tests which use `pip` to install packages\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible-test",
        "created_at": "2023-10-18T18:50:00Z",
        "user": "mattclay",
        "labels": [
            "feature",
            "ansible-test",
            "affects_2.18"
        ]
    },
    {
        "number": 82013,
        "title": "Reduce integration test dependencies on external resources",
        "body": "### Summary\r\n\r\nMany integration tests depend on external resources, aside from `pip` installed packages from PyPI and OS package installs. These dependencies should be replaced with local options where possible.\r\n\r\nExamples of dependencies to consider replacing:\r\n\r\n- File downloads, such as from the ci-files S3 bucket.\r\n- Use of external APIs, such as Galaxy.\r\n- Cloning of git repositories, usually from GitHub.\r\n- Installation of packages from alternative repositories.\r\n\r\nChanges should be backported through stable-2.14, when possible, particularly for tests run on RHEL.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nintegration tests",
        "created_at": "2023-10-18T18:36:53Z",
        "user": "mattclay",
        "labels": [
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 82007,
        "title": "Git module fails to change the current branch if there's no corresponding remote-tracking branch",
        "body": "### Summary\r\n\r\nWhen cloning a git repo while specifying `single_branch: true`, a subsequent attempt to change the branch fails.\r\n\r\n\r\nMy understanding of the issue is that when attempting to change the branch of an already existing repo, ansible implicitly assumes that the corresponding remote-tracking branch already exists, which may very well not be true in various situations.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ngit\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.15.5]\r\n  config file = /etc/ansible/ansible.cfg\r\n[...]\r\n  python version = 3.10.13 (main, Aug 28 2023, 00:00:00) [GCC 13.2.1 20230728 (Red Hat 13.2.1-1)] ([...])\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = most\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 38 Workstation\r\nansible installed via pip in a virtualenv\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  tasks:\r\n    - name: Remove git repo if required\r\n      file:\r\n        path: /tmp/test_clone_repo\r\n        state: absent\r\n\r\n    - name: Clone the git repo with only a single branch\r\n      ansible.builtin.git:\r\n        repo: https://github.com/ansible/ansible-examples.git\r\n        version: master\r\n        dest: /tmp/test_clone_repo\r\n        single_branch: true\r\n\r\n    - name: Attempt to change the branch\r\n      ansible.builtin.git:\r\n        repo: https://github.com/ansible/ansible-examples.git\r\n        version: provisioning\r\n        dest: /tmp/test_clone_repo\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nNo error, and the repo would now be checked-out on the `provisioning` branch.\r\n\r\n### Actual Results\r\n\r\n```console\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/bin/git checkout --track -b provisioning origin/provisioning\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"accept_hostkey\": false,\r\n            \"accept_newhostkey\": false,\r\n            \"archive\": null,\r\n            \"archive_prefix\": null,\r\n            \"bare\": false,\r\n            \"clone\": true,\r\n            \"depth\": null,\r\n            \"dest\": \"/tmp/test_clone_repo\",\r\n            \"executable\": null,\r\n            \"force\": false,\r\n            \"gpg_whitelist\": [],\r\n            \"key_file\": null,\r\n            \"recursive\": true,\r\n            \"reference\": null,\r\n            \"refspec\": null,\r\n            \"remote\": \"origin\",\r\n            \"repo\": \"https://github.com/ansible/ansible-examples.git\",\r\n            \"separate_git_dir\": null,\r\n            \"single_branch\": false,\r\n            \"ssh_opts\": null,\r\n            \"track_submodules\": false,\r\n            \"umask\": null,\r\n            \"update\": true,\r\n            \"verify_commit\": false,\r\n            \"version\": \"provisioning\"\r\n        }\r\n    },\r\n    \"msg\": \"Failed to checkout provisioning\",\r\n    \"rc\": 128,\r\n    \"stderr\": \"fatal: 'origin/provisioning' is not a commit and a branch 'provisioning' cannot be created from it\\n\",\r\n    \"stderr_lines\": [\r\n        \"fatal: 'origin/provisioning' is not a commit and a branch 'provisioning' cannot be created from it\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-18T13:49:40Z",
        "user": "toadjaune",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 81999,
        "title": "Ansible fails trying to connect remote host and get unreachable issue with exit code -13",
        "body": "### Summary\r\n\r\nWhen we are running ansible task, localhost to another remote host we are get unreachable errors intermittently(not reproduceable every time). One task runs on local host and other on remote host. While we are running these task, we are using \"remote_tmp=/var/mcp/lock\" in ansible.cfg file. \r\nAlso may be we can overcome with using /tmp dir for remote_tmp but i want to use \"remote_tmp=/var/mcp/lock\"\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nsetup\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.9.9\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOLOR(/etc/ansible/ansible.cfg) = True\r\nANSIBLE_NOCOWS(/etc/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_RETRIES(/etc/ansible/ansible.cfg) = 3\r\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = smart\r\nDEFAULT_MODULE_PATH(/etc/ansible/ansible.cfg) = ['/var/mcp/raf/commissioning/common/library']\r\nDEFAULT_MODULE_UTILS_PATH(/etc/ansible/ansible.cfg) = ['/var/mcp/raf/commissioning/module_utils']\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 60\r\n[ ~]# cat /etc/ansible/ansible.cfg \r\n[defaults]\r\nansible_python_interpreter = auto\r\nlibrary = /var/mcp/raf/commissioning/common/library\r\nmodule_utils = /var/mcp/raf/commissioning/module_utils\r\ngathering = smart\r\ntimeout = 60\r\nnocows = True\r\nnocolor = True\r\nremote_tmp = /var/mcp/lock\r\n[ssh_connection]\r\nretries = 3\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 8\r\n\r\n### Steps to Reproduce\r\n```\r\n---\r\n- name: test\r\n  hosts: xxx.xx.xx.xxx\r\n  vars:\r\n    ansible_ssh_user: sysuser\r\n    ansible_ssh_pass: xxxx\r\n    ansible_become: yes               \r\n    ansible_become_method: su     \r\n    ansible_become_password: xxxx\r\n  tasks:\r\n    - name: Uptime check\r\n      command: uptime\r\n```\r\n\r\n### Expected Results\r\n\r\nchanged: [AM11]\r\n\r\n### Actual Results\r\n\r\n```console\r\nfatal: [AM11]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to create temporary directory.In some cases, you may have been able to authenticate and did not have permissions on the target directory. Consider changing the remote tmp path in ansible.cfg to a path rooted in \\\"/tmp\\\", for more error information use -vvv. Failed command was: ( umask 77 && mkdir -p \\\"` echo /var/mcp/lock `\\\"&& mkdir /var/mcp/lock/ansible-tmp-1697011485.7946527-2683247-213995000290554 && echo ansible-tmp-1697011485.7946527-2683247-213995000290554=\\\"` echo /var/mcp/lock/ansible-tmp-1697011485.7946527-2683247-213995000290554 `\\\" ), exited with result -13\", \"unreachable\": true}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-17T13:55:13Z",
        "user": "ediz-akarsu",
        "labels": [
            "module",
            "bug",
            "affects_2.9"
        ]
    },
    {
        "number": 81998,
        "title": "Add ability to remove all hosts from dynamic inventory (including those added via add_host)",
        "body": "### Summary\r\n\r\nThe behaviour from Ansible 2.0 to 6.7 was that `meta: refresh_inventory` would clear the inventory; this is actually still documented in 'https://docs.ansible.com/ansible/latest/dev_guide/developing_inventory.html#inventory-plugins': \"_However, you can use the meta: refresh_inventory task to clear the current inventory_\". \r\n\r\nThere is currently no way of completely clearing the inventory (as of https://github.com/ansible/ansible/pull/77944).  This is problematic when hosts are added via `add_host`, and then some part of your playbook deletes a physical host, and you are then unable to derive a valid inventory.  There are various hacks to work around this, but it seems like the more elegant solution would be to restore the ability to clear the inventory completely.\r\n\r\n\r\nPerhaps a new `meta: purge_inventory`, or maybe a `del_host` action plugin (whichever is the most appropriate)?\r\n\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible.builtin.meta\r\n\r\n### Additional Information\r\n\r\n```yaml\r\n- name: Force purge all hosts (including those added via ansible.builtin.add_host) from the inventory\r\n  ansible.builtin.meta: purge_inventory\r\n```\r\nor \r\n```yaml\r\n- name: Delete host from inventory\r\n  ansible.builtin.del_host:\r\n    hostname: '{{ ip_to_del }}'\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-17T13:09:52Z",
        "user": "dseeley",
        "labels": [
            "module",
            "feature",
            "P3"
        ]
    },
    {
        "number": 81944,
        "title": "Error message triggered by ansible.builtin.shell reports error in ansible.legacy.command",
        "body": "### Summary\r\n\r\nWhen using the now deprecated\r\n```\r\nansible.builtin.shell: shell command\r\nargs:\r\n  warn: false\r\n```\r\n`ansible` gives a fatal error regarding unsupported parameters for `ansible.legacy.command` instead of the `ansible.builtin.shell` module that was used in the playbook.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nshell, command\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.4]\r\n  config file = None\r\n  configured module search path = ['/home/andreast/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/dist-packages/ansible\r\n  ansible collection location = /home/andreast/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/local/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\r\n```\r\n\r\n\r\n### OS / Environment\r\nContainer running Ubuntu 22.04.3 LTS\r\n\r\n```console\r\n$ cat /etc/os-release \r\nPRETTY_NAME=\"Ubuntu 22.04.3 LTS\"\r\nNAME=\"Ubuntu\"\r\nVERSION_ID=\"22.04\"\r\nVERSION=\"22.04.3 LTS (Jammy Jellyfish)\"\r\nVERSION_CODENAME=jammy\r\nID=ubuntu\r\nID_LIKE=debian\r\nHOME_URL=\"https://www.ubuntu.com/\"\r\nSUPPORT_URL=\"https://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\nUBUNTU_CODENAME=jammy\r\n```\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- name: Initial greetings\r\n  hosts: localhost\r\n  tasks:\r\n    - name: Say hello\r\n      ansible.builtin.shell: echo \"Hello World!\"\r\n      args:\r\n        warn: false\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI would expect the error message to refer to invalid module arguments to `ansible.builtin.shell`\r\n\r\n### Actual Results\r\n\r\n```console\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"Unsupported parameters for (ansible.legacy.command) module: warn. Supported parameters include: _raw_params, _uses_shell, argv, chdir, creates, executable, removes, stdin, stdin_add_newline, strip_empty_ends.\"}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-10T09:28:12Z",
        "user": "anstrom",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 81847,
        "title": "dnf/yum connects to internet while package is already installed in offline environment",
        "body": "### Summary\r\n\r\nWhen I run the node exporter playbook in an offline environment on RedHat Linux where SELinux is enabled, the playbook wants to update the yum cache.\r\nSince this is an offline environment, this yum cache update will fail. The packages are already installed so there should be no need to update the yum cache. Even if I set the cacheonly parameter to true, the task will still fail because the cache is empty.\r\nThe playbook: https://github.com/prometheus-community/ansible/tree/main/roles/node_exporter\r\nThe task: https://github.com/prometheus-community/ansible/blob/main/roles/node_exporter/tasks/selinux.yml\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nyum\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.15.4]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 9 with SELinux enabled\r\n\r\n### Steps to Reproduce\r\n\r\nRun the https://github.com/prometheus-community/ansible/tree/main/roles/node_exporter playbook in an offline environment on RedHat with SELinux enabled.\r\n\r\n### Expected Results\r\n\r\nIt will run succesfully\r\n\r\n### Actual Results\r\n\r\n\"cannot update repo metadata\"\r\nand\r\n\"cache is empty\" (when cacheonly=true)\r\n`fatal: [vm]: FAILED! => {\"changed\": false, \"msg\": \"Cache-only enabled but no cache for 'rhel-9-for-x86_64-supplementary-rhui-rpms'\", \"rc\": 1, \"results\": []}`\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-10-03T09:30:44Z",
        "user": "avdland",
        "labels": [
            "bug",
            "has_pr",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81813,
        "title": "Inconsistent parsing of input with \"null\"",
        "body": "### Summary\r\n\r\nWhen using `vars_prompt` in a playbook, the way Ansible parses the default values and the inputs is completely inconsistent. It's impossible reason about what kind of data will land in that variable.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.0]\r\n  config file = None\r\n  configured module search path = ['/var/home/yajo/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /nix/store/54cg4i5bj816vd2q1ansfpf6zdkg2jqm-python3.10-ansible-core-2.15.0/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /var/home/yajo/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /nix/store/54cg4i5bj816vd2q1ansfpf6zdkg2jqm-python3.10-ansible-core-2.15.0/bin/ansible\r\n  python version = 3.10.12 (main, Jun  6 2023, 22:43:10) [GCC 12.2.0] (/nix/store/bc45k1n0pkrdkr3xa6w84w1xhkl1kkyp-python3-3.10.12/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = code --wait\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 38 Silverblue\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Test\r\n  hosts: localhost\r\n  vars_prompt:\r\n    - name: options\r\n      default: \"{{ lookup('env', 'OPTIONS', default='{}') }}\"\r\n      unsafe: true\r\n      private: false\r\n      prompt: \"Options YAML\"\r\n  vars:\r\n    parsed: \"{{ options | from_yaml }}\"\r\n  tasks:\r\n    - debug: var=options\r\n    - debug: var=parsed\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect that, no matter what the user or environment provide to `options`, it ends up being a string.\r\n\r\nThen I expect to be able to parse that string as YAML if it is a valid YAML, and saving that result into `parsed`.\r\n\r\nBelow, I'll run the playbook using different values for the `$OPTIONS` env var, to demonstrate inconsistencies.\r\n\r\n### Actual Results\r\n\r\n`parsed` should be `None`, not `\"\"`:\r\n\r\n```console\r\n\u27a4 env OPTIONS=null ansible-playbook ./test.yaml\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nOptions YAML [null]: \r\n\r\nPLAY [Test] ********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"options\": \"null\"\r\n}\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"parsed\": \"\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n---\r\n\r\nErrors:\r\n1. the default value should be `\"{null}\"`, not `{None}`\r\n2. `options` should be `\"{null}\" instead of giving an error\r\n3. `parsed` should give an error instead of being `{\"None\": null}`\r\n\r\n```console\r\n\u27a4 env OPTIONS={null} ansible-playbook ./test.yaml\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nOptions YAML [{None}]: \r\n\r\nPLAY [Test] ********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\n[WARNING]: Failure using method (v2_runner_on_ok) in callback plugin\r\n(<ansible.plugins.callback.default.CallbackModule object at 0x7f35aa06f3d0>):\r\nObject of type set is not JSON serializable\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"parsed\": {\r\n        \"None\": null\r\n    }\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n---\r\n\r\nErrors:\r\n1. the default value should be `[null]`, not `[None]`\r\n2. `options` should be `\"[null]\"`, not `[null]`\r\n3. `parsed` should be `[null]`, not `[\"None\"]`\r\n\r\n```console\r\n\u27a4 env OPTIONS=[null] ansible-playbook ./test.yaml\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\nOptions YAML [[None]]: \r\n\r\nPLAY [Test] ********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\n\r\nok: [localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"options\": [\r\n        null\r\n    ]\r\n}\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"parsed\": [\r\n        \"None\"\r\n    ]\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-29T10:41:31Z",
        "user": "yajo",
        "labels": [
            "bug",
            "affects_2.15",
            "data_tagging",
            "affects_2.18"
        ]
    },
    {
        "number": 81805,
        "title": "'could not find job' on async_status with delegate_to localhost",
        "body": "### Summary\n\nasync_status is looking at a different place for the async_dir as it actually is when the actual async task and async_status are delegated to localhost, HOME environment variable is explicitly set and ANSIBLE_ASYNC_DIR is not explicitly set.\r\n\r\nI think the bug lies somewhere in the `_remote_expand_user` function of the async_module which has its own logic to expand the `~` in the path while async_wrapper uses `os.path.expanduser` to do that.\r\n\r\nI first discovered the issue while using ansible-semaphore: https://github.com/ansible-semaphore/semaphore/issues/943\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nasync_status\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.4]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/jojoob/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/jojoob/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.5 (main, Sep  2 2023, 14:16:33) [GCC 13.2.1 20230801] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['profile_tasks']\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = yaml\r\nEDITOR(env: EDITOR) = vim\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\narch Linux and Ubuntu 20.04\n\n### Steps to Reproduce\n\nTest Playbook (`async-delegate.yml`):\r\n\r\n```yaml\r\n- hosts: all\r\n  gather_facts: no\r\n  tasks:\r\n    - command: sleep 5\r\n      async: 7\r\n      poll: 0\r\n      register: async_task\r\n      delegate_to: localhost\r\n    - async_status:\r\n        jid: \"{{async_task.ansible_job_id}}\"\r\n      register: job_result\r\n      until: job_result.finished\r\n      retries: 7\r\n      delay: 1\r\n      delegate_to: localhost\r\n```\r\n\r\nCommand: `HOME=/tmp/foo ansible-playbook -i example.host, async-delegate.yml --verbose`\r\n\n\n### Expected Results\n\nThe playbook should run without errors, retrying max. 7 times until the sleep command is finished. And this is the case for the following variants:\r\n\r\n* `ansible-playbook -i example.host, async-delegate.yml`\r\n* `ANSIBLE_ASYNC_DIR=/tmp/bar HOME=/tmp/foo ansible-playbook -i example.host, async-delegate.yml`\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] *************************************************************\r\n\r\nTASK [command] ******************************************************\r\nDonnerstag 28 September 2023  08:38:54 +0200 (0:00:00.012)       0:00:00.012 *** \r\nchanged: [example.host -> localhost] => changed=true \r\n  ansible_job_id: j628130553180.21703\r\n  finished: 0\r\n  results_file: /home/jojoob/.ansible_async/j628130553180.21703\r\n  started: 1\r\n\r\nTASK [async_status] ****************************************************\r\nDonnerstag 28 September 2023  08:38:54 +0200 (0:00:00.409)       0:00:00.422 *** \r\nFAILED - RETRYING: [example.host -> localhost]: async_status (7 retries left).\r\nFAILED - RETRYING: [example.host -> localhost]: async_status (6 retries left).\r\nFAILED - RETRYING: [example.host -> localhost]: async_status (5 retries left).\r\nFAILED - RETRYING: [example.host -> localhost]: async_status (4 retries left).\r\nFAILED - RETRYING: [example.host -> localhost]: async_status (3 retries left).\r\nchanged: [example.host -> localhost] => changed=true \r\n  ansible_job_id: j628130553180.21703\r\n  attempts: 6\r\n  cmd:\r\n  - sleep\r\n  - '5'\r\n  delta: '0:00:06.003162'\r\n  end: '2023-09-28 08:39:00.579409'\r\n  finished: 1\r\n  msg: ''\r\n  rc: 0\r\n  results_file: /home/jojoob/.ansible_async/j628130553180.21703\r\n  start: '2023-09-28 08:38:54.576247'\r\n  started: 1\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: ''\r\n  stdout_lines: <omitted>\r\n```\n\n### Actual Results\n\n```console\n$ HOME=/tmp/foo ansible-playbook -i example.host, async-delegate.yml --verbose\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] *************************************************************\r\n\r\nTASK [command] ******************************************************\r\nDonnerstag 28 September 2023  08:26:04 +0200 (0:00:00.012)       0:00:00.012 *** \r\nchanged: [example.host -> localhost] => changed=true \r\n  ansible_job_id: j923045085645.20378\r\n  finished: 0\r\n  results_file: /tmp/foo/.ansible_async/j923045085645.20378\r\n  started: 1\r\n\r\nTASK [async_status] ****************************************************\r\nDonnerstag 28 September 2023  08:26:04 +0200 (0:00:00.401)       0:00:00.413 *** \r\nfatal: [example.host -> localhost]: FAILED! => changed=false \r\n  ansible_job_id: j923045085645.20378\r\n  attempts: 1\r\n  finished: 1\r\n  msg: could not find job\r\n  results_file: /home/jojoob/.ansible_async/j923045085645.20378\r\n  started: 1\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: ''\r\n  stdout_lines: <omitted>\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-28T06:45:53Z",
        "user": "jojoob",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 81800,
        "title": "Meta action is printed as a separate task for each host",
        "body": "### Summary\r\n\r\n...instead of a task with per-host report, or a deduplicated message\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.2]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nany\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: host* # (multiple hosts)\r\n  tasks:\r\n    - meta: flush_handlers\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n```\r\nTASK [meta] ***\r\n```\r\nor\r\n```\r\nTASK [meta] ***\r\nok: [host1]\r\nok: [host2]\r\n...etc\r\n```\r\nor\r\n```\r\nTASK [meta] ***\r\napplied to: host1, host2, etc...\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [meta] ***\r\n\r\nTASK [meta] ***\r\n\r\nTASK [meta] ***\r\n\r\nTASK [meta] ***\r\n\r\nTASK [meta] ***\r\n\r\n...etc\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-27T12:23:00Z",
        "user": "Vladimir-csp",
        "labels": [
            "bug",
            "verified",
            "affects_2.15",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 81777,
        "title": "Task failures with rc -13 (SIGPIPE) related to SSH ControlPersist expiry",
        "body": "### Summary\n\nAfter upgrading from Ansible 4.10 -> Ansible 8.2.0 (ansible-core 2.15.3), our Jenkins pipelines started encountering occasional module failures with several different ansible-playbooks in various `command`, `file` or \"Gathering facts\" -> `setup` tasks, all with `\"rc\": -13` (i.e. `SIGPIPE`):\r\n\r\n```\r\n23:02:04  PLAY [x] *********************************************************************\r\n23:02:04  \r\n23:02:04  TASK [Gathering Facts] *********************************************************\r\n23:02:07  fatal: [x]: FAILED! => {\r\n23:02:07      \"ansible_facts\": {},\r\n23:02:07      \"changed\": false,\r\n23:02:07      \"failed_modules\": {\r\n23:02:07          \"ansible.legacy.setup\": {\r\n23:02:07              \"failed\": true,\r\n23:02:07              \"module_stderr\": \"\",\r\n23:02:07              \"module_stdout\": \"\",\r\n23:02:07              \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n23:02:07              \"rc\": -13\r\n23:02:07          }\r\n23:02:07      }\r\n23:02:07  }\r\n23:02:07  \r\n23:02:07  MSG:\r\n23:02:07  \r\n23:02:07  The following modules failed to execute: ansible.legacy.setup\r\n```\r\n\r\n```\r\n10:29:49  TASK [x : Config directories] ******************************************\r\n10:29:49  failed: [x] (item=/opt/x) => {\r\n10:29:49      \"ansible_loop_var\": \"item\",\r\n10:29:49      \"changed\": false,\r\n10:29:49      \"item\": \"/opt/x\",\r\n10:29:49      \"rc\": -13\r\n10:29:49  }\r\n10:29:49  \r\n10:29:49  MSG:\r\n10:29:49  \r\n10:29:49  MODULE FAILURE\r\n10:29:49  See stdout/stderr for the exact error \r\n```\r\n\r\nInvestigating the issues over a longer period of time, it seems like the issue was occurning when the interval between task executions on a given host coincided with the Ansible ssh plugin's `ControlPersist=60s` idle timeout:\r\n\r\n```\r\n[2023-09-22T19:07:42.331Z] TASK [supercronic : Deploy supercronic container] ***********\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;31m--- before\ufffd[0m\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;31m\ufffd[0m\ufffd[0;32m+++ after\ufffd[0m\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;32m\ufffd[0m\ufffd[0;36m@@ -1,3 +1,3 @@\ufffd[0m\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;36m\ufffd[0m {\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;31m-    \"running\": false\ufffd[0m\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;31m\ufffd[0m\ufffd[0;32m+    \"running\": true\ufffd[0m\r\n[2023-09-22T19:07:44.850Z] \ufffd[0;32m\ufffd[0m }\r\n[2023-09-22T19:07:44.850Z] \r\n[2023-09-22T19:07:44.850Z] \ufffd[0;33mchanged: [xxx.example.com]\ufffd[0m`\r\n```\r\n\r\n```\r\nsyys 22 19:08:42 xxx.example.com sshd[29728]: Received disconnect from 10.52.8.41 port 39688:11: disconnected by user\r\nsyys 22 19:08:42 xxx.example.com sshd[29728]: Disconnected from 10.52.8.41 port 39688\r\nsyys 22 19:08:42 xxx.example.com sshd[29728]: pam_unix(sshd:session): session closed for user root\r\n```\r\n\r\n```\r\n[2023-09-22T19:08:43.079Z] TASK [Gathering Facts] *********************************************************\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31mfatal: [xxx.example.com]: FAILED! => {\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m    \"ansible_facts\": {},\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m    \"changed\": false,\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m    \"failed_modules\": {\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m        \"ansible.legacy.setup\": {\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m            \"failed\": true,\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m            \"module_stderr\": \"\",\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m            \"module_stdout\": \"\",\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m            \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m            \"rc\": -13\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m        }\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m    }\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m}\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31mMSG:\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31mThe following modules failed to execute: ansible.legacy.setup\ufffd[0m\r\n[2023-09-22T19:08:44.524Z] \ufffd[0;31m\ufffd[0m\r\n```\r\n\r\nI believe the `ssh` client process on the Ansible controller is racing the `mux_client_hello_exchange` UNIX socket connect -> write with the auto-mux server closing the control socket. This seems to lead to the SSH client process dying with a SIGPIPE signal from the kernel, and the Ansible ssh connection plugin sees a `-13` process exit code.\r\n\r\nThis issue is probably related to #77450 (same root cause) and #16731 (earlier fix for the same issue).\r\n\r\nThe upstream OpenSSH [bz#3454](https://bugzilla.mindrot.org/show_bug.cgi?id=3454) and https://github.com/openssh/openssh-portable/commit/96faa0de6c673a2ce84736eba37fc9fb723d9e5c fix to `ssh` SIGPIPE handling for this exact case as released in OpenSSH 9.1 are also related.\r\n\r\nThe Python subprocess issue (https://github.com/python/cpython/issues/45993) mentioned in #77450 and related changes to `subprocess.Popen(restore_signals=True)` behavior in Python 3.2 as regards the effective SIGPIPE handler in the `ssh` child process forked by Ansible is probably also related.\r\n\r\nThe end result appears to be that for specific combinations of Python and OpenSSH, the `ssh` client forked by the Ansible ssh connection plugins executes the `mux_client_hello_exchange` socket write with the default `SIGPIPE` handler, leading to an occasional race condition with a -13 exit status code and resulting sporadic Ansible task failures.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nssh\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.4]\r\n  config file = /build/provisioning/ansible.cfg\r\n  configured module search path = ['/home/build/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/build/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.17 (main, Aug 10 2023, 15:11:31) [GCC 8.5.0 20210514 (Red Hat 8.5.0-20)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /build/provisioning/ansible.cfg\r\nDEFAULT_FORKS(/build/provisioning/ansible.cfg) = 20\r\nDEFAULT_STDOUT_CALLBACK(/build/provisioning/ansible.cfg) = debug\r\nDEFAULT_VAULT_PASSWORD_FILE(/build/provisioning/ansible.cfg) = /build/provisioning/vault-password.secret\r\nINVENTORY_ANY_UNPARSED_IS_FAILED(/build/provisioning/ansible.cfg) = True\r\nINVENTORY_CACHE_PLUGIN(/build/provisioning/ansible.cfg) = jsonfile\r\nINVENTORY_CACHE_PLUGIN_CONNECTION(/build/provisioning/ansible.cfg) = ~/.ansible/inventory-cache\r\nINVENTORY_CACHE_TIMEOUT(/build/provisioning/ansible.cfg) = 3600\r\nINVENTORY_ENABLED(/build/provisioning/ansible.cfg) = ['yaml', 'funidata.infra.aws_ec2', 'ini']\r\nTRANSFORM_INVALID_GROUP_CHARS(/build/provisioning/ansible.cfg) = ignore\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\npipelining(/build/provisioning/ansible.cfg) = True\n```\n\n\n### OS / Environment\n\nCentOS Stream 8, from the Docker `quay.io/centos/centos:stream8` image @ `sha256:e4e81a5e6be8f8f7eb511a8df3afcd4e7123e68c56bc03efc40fbd0ab5b2e4fd`\r\n\r\nOpenSSH_8.0p1\n\n### Steps to Reproduce\n\nThis is a timing-related race-condition, and thus difficult to reproduce reliably. The following playbook is an attempt to trigger the ssh control-master race on the \"Test 2\" task with a variable sleep, but I was not able to repro the actual `SIGPIPE` -> rc `-13` on the second `command` task - what did work was to run the same playbook several times in a row in our Jenkins pipeline, and the failure would sometimes occur during the \"Gathering Facts\" -> `setup`  task on a subsequent playbook run, where the previous playbook run completed for that host approximately 10 seconds earlier.\r\n\r\n```yaml (paste below)\r\n- hosts: all\r\n  strategy: free\r\n  vars:\r\n    ansible_ssh_args: \"-o ControlMaster=auto -o ControlPersist=10s -o StrictHostKeyChecking=accept-new -o UserKnownHostsFile={{ playbook_dir }}/ssh/known_hosts.d/{{ inventory_hostname }} -o HashKnownHosts=no -o ServerAliveInterval=5 -o ServerAliveCountMax=1\"\r\n  tasks:\r\n    - name: Test 1\r\n      command: date\r\n    \r\n    - name: Pause\r\n      command: sleep \"{{ 8.0 + (1000 | random / 1000.0) * 3.0 }}\"\r\n      connection: local\r\n\r\n    - name: Test 2\r\n      command: date\r\n\r\n```\n\n### Expected Results\n\nI expect the playbook tasks to run reliably, falling back to a direct SSH connection as necessary.\r\n\r\nBased on the `ansible-playbook -vvvvv` -> `ssh -v` debug logs, the repro case is sufficient to exercise all of the following `ssh` codepaths:\r\n\r\n```\r\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/home/build/.ansible/cp/4bf82cb2a5\" does not exist\\r\\ndebug2: ssh_connect_direct\r\n```\r\n\r\n```\r\nndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: mux_client_hello_exchange: read packet failed\\r\\nmuxclient: master hello exchange failed\\r\\ndebug2: ssh_connect_direct\r\n```\r\n\r\n```\r\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\n\\debug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\r\n```\r\n\r\nIn addition, I would expect to also see a fourth case with `debug: mux_client_hello_exchange: write packet: Broken pipe` -> `muxclient: master hello exchange failed` -> `debug2: ssh_connect_direct`, but this case seems to result in the `ssh` client dying with `SIGPIPE` instead. The `ssh` debug logging in the failure case ends at `debug1: auto-mux: Trying existing master` -> `debug2: fd 3 setting O_NONBLOCK`, so I would assume the `SIGPIPE` is occuring on the [`mux_client_write_packet`](https://github.com/openssh/openssh-portable/blob/V_8_0_P1/mux.c#L1619) in between the [`muxclient` `connect(...)` -> `ENOENT` `Control socket \\\"%.100s\\\" does not exist`](https://github.com/openssh/openssh-portable/blob/V_8_0_P1/mux.c#L2344) and [`mux_client_read_packet` -> `read packet failed`](https://github.com/openssh/openssh-portable/blob/V_8_0_P1/mux.c#L1627) calls.\n\n### Actual Results\n\n```console\n14:20:18  <10.52.9.192> SSH: EXEC ssh -vvv -o ControlMaster=auto -o ControlPersist=10s -o StrictHostKeyChecking=accept-new -o UserKnownHostsFile=/srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx -o HashKnownHosts=no -o ServerAliveInterval=5 -o ServerAliveCountMax=1 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/build/.ansible/cp/74b21c1c30\"' 10.52.9.192 '/bin/sh -c '\"'\"'/usr/bin/python3 && sleep 0'\"'\"''\r\n...\r\n14:20:19  <10.52.9.192> (0, b'\\n{\"changed\": true, \"stdout\": \"Tue Sep 26 11:20:18 UTC 2023\", \"stderr\": \"\", \"rc\": 0, \"cmd\": [\"date\"], \"start\": \"2023-09-26 11:20:18.233335\", \"end\": \"2023-09-26 11:20:18.236518\", \"delta\": \"0:00:00.003183\", \"msg\": \"\", \"invocation\": {\"module_args\": {\"_raw_params\": \"date\", \"_uses_shell\": false, \"stdin_add_newline\": true, \"strip_empty_ends\": true, \"argv\": null, \"chdir\": null, \"executable\": null, \"creates\": null, \"removes\": null, \"stdin\": null}}}\\n', b'OpenSSH_8.0p1, OpenSSL 1.1.1k  FIPS 25 Mar 2021\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host 10.52.9.192 originally 10.52.9.192\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: not matched \\'final\\'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname 10.52.9.192 is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for \\'final all\\' host 10.52.9.192 originally 10.52.9.192\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: matched \\'final\\'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: mux_client_hello_exchange: read packet failed\\r\\nmuxclient: master hello exchange failed\\r\\ndebug2: ssh_connect_direct\\r\\ndebug1: Connecting to 10.52.9.192 [10.52.9.192] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9966 ms remain after connect\\r\\ndebug1: identity file /home/build/.ssh/id_rsa type -1\\r\\ndebug1: identity file /home/build/.ssh/id_rsa-cert type -1\\r\\ndebug1: identity file /home/build/.ssh/id_dsa type -1\\r\\ndebug1: identity file /home/build/.ssh/id_dsa-cert type -1\\r\\ndebug1: identity file /home/build/.ssh/id_ecdsa type -1\\r\\ndebug1: identity file /home/build/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: identity file /home/build/.ssh/id_ed25519 type -1\\r\\ndebug1: identity file /home/build/.ssh/id_ed25519-cert type -1\\r\\ndebug1: identity file /home/build/.ssh/id_xmss type -1\\r\\ndebug1: identity file /home/build/.ssh/id_xmss-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_8.0\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.4\\r\\ndebug1: match: OpenSSH_7.4 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to 10.52.9.192:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx:1\\r\\ndebug3: load_hostkeys: loaded 1 keys from 10.52.9.192\\r\\ndebug3: order_hostkeyalgs: have matching best-preference key type ecdsa-sha2-nistp256-cert-v01@openssh.com, using HostkeyAlgorithms verbatim\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug2: ciphers ctos: aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc\\r\\ndebug2: ciphers stoc: aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc\\r\\ndebug2: MACs ctos: hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512\\r\\ndebug2: MACs stoc: hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512\\r\\ndebug2: compression ctos: none,zlib@openssh.com,zlib\\r\\ndebug2: compression stoc: none,zlib@openssh.com,zlib\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\\r\\ndebug2: host key algorithms: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr\\r\\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: curve25519-sha256\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: aes256-ctr MAC: hmac-sha2-256-etm@openssh.com compression: none\\r\\ndebug1: kex: client->server cipher: aes256-ctr MAC: hmac-sha2-256-etm@openssh.com compression: none\\r\\ndebug1: kex: curve25519-sha256 need=32 dh_need=32\\r\\ndebug1: kex: curve25519-sha256 need=32 dh_need=32\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:L/ealGhXrXp8SxG407o0VuYoTryRpycepLtoF2HcNZk\\r\\ndebug3: hostkeys_foreach: reading file \"/srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx:1\\r\\ndebug3: load_hostkeys: loaded 1 keys from 10.52.9.192\\r\\ndebug1: Host \\'10.52.9.192\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx:1\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey out after 4294967296 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey in after 4294967296 blocks\\r\\ndebug1: Will attempt key: jenkins@xxx-jenkins-dev ED25519 SHA256:mc+kKsOmURu4dJUep5ZfRHx9o7LRHZHMd7RPx2m9S2g agent\\r\\ndebug1: Will attempt key: /home/build/.ssh/id_rsa \\r\\ndebug1: Will attempt key: /home/build/.ssh/id_dsa \\r\\ndebug1: Will attempt key: /home/build/.ssh/id_ecdsa \\r\\ndebug1: Will attempt key: /home/build/.ssh/id_ed25519 \\r\\ndebug1: Will attempt key: /home/build/.ssh/id_xmss \\r\\ndebug2: pubkey_prepare: done\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<rsa-sha2-256,rsa-sha2-512>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 53\\r\\ndebug3: input_userauth_banner\\r\\nAuthorized uses only. All activity may be monitored and reported.\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey\\r\\ndebug3: start over, passed a different list publickey\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: jenkins@xxx-jenkins-dev ED25519 SHA256:mc+kKsOmURu4dJUep5ZfRHx9o7LRHZHMd7RPx2m9S2g agent\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: jenkins@xxx-jenkins-dev ED25519 SHA256:mc+kKsOmURu4dJUep5ZfRHx9o7LRHZHMd7RPx2m9S2g agent\\r\\ndebug3: sign_and_send_pubkey: ED25519 SHA256:mc+kKsOmURu4dJUep5ZfRHx9o7LRHZHMd7RPx2m9S2g\\r\\ndebug3: sign_and_send_pubkey: signing using ssh-ed25519\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to 10.52.9.192 ([10.52.9.192]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /home/build/.ansible/cp/74b21c1c30.cEtnsDBIAFIxv4xs\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/home/build/.ansible/cp/74b21c1c30]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 4\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x20\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 1313\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 10 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: mux_master_process_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: mux_master_process_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 1315\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 115\\r\\ndebug2: mux_master_process_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm\", cmd \"/bin/sh -c \\'/usr/bin/python3 && sleep 0\\'\", env 2\\r\\ndebug3: mux_master_process_new_session: got fds stdin 6, stdout 7, stderr 8\\r\\ndebug2: fd 6 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = C\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending env LC_CTYPE = en_US.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'/usr/bin/python3 && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug2: channel 2: read<=0 rfd 6 len 0\\r\\ndebug2: channel 2: read failed\\r\\ndebug2: channel 2: chan_shutdown_read (i0 o0 sock -1 wfd 6 efd 8 [write])\\r\\ndebug2: channel 2: input open -> drain\\r\\ndebug2: channel 2: ibuf empty\\r\\ndebug2: channel 2: send eof\\r\\ndebug3: send packet: type 96\\r\\ndebug2: channel 2: input drain -> closed\\r\\ndebug2: channel 2: rcvd adjust 65536\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: chan_shutdown_write (i3 o1 sock -1 wfd 7 efd 8 [write])\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: chan_shutdown_read (i0 o1 sock 5 wfd 5 efd -1 [closed])\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o1/16 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 e[write]/0 fd -1/-1/8 sock -1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: chan_shutdown_write (i3 o1 sock 5 wfd 5 efd -1 [closed])\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o3/0 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 10 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n...\r\n14:20:19  TASK [Test 2] ******************************************************************\r\n14:20:19  task path: /srv/jenkins-agent/workspace/xxx-dev/provisioning/ansible-sigpipe.yml:13\r\n14:20:19  changed: [xxx] => {\r\n14:20:19 ...\r\n14:20:19  }\r\n...\r\n14:20:21  PLAY RECAP *********************************************************************\r\n14:20:21  xxx : ok=4    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n...\r\n\r\n14:20:27  PLAYBOOK: ansible-sigpipe.yml **************************************************\r\n...\r\n14:20:27  Using module file /usr/local/lib/python3.9/site-packages/ansible/modules/setup.py\r\n14:20:27  Pipelining is enabled.\r\n14:20:27  <10.52.9.192> ESTABLISH SSH CONNECTION FOR USER: root\r\n14:20:27  <10.52.9.192> SSH: ansible.cfg set ssh_args: (-o)(ControlMaster=auto)(-o)(ControlPersist=10s)(-o)(StrictHostKeyChecking=accept-new)(-o)(UserKnownHostsFile=/srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx)(-o)(HashKnownHosts=no)(-o)(ServerAliveInterval=5)(-o)(ServerAliveCountMax=1)\r\n14:20:27  <10.52.9.192> SSH: ansible_password/ansible_ssh_password not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n14:20:27  <10.52.9.192> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=\"root\")\r\n14:20:27  <10.52.9.192> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=10)\r\n14:20:27  <10.52.9.192> SSH: Set ssh_common_args: ()\r\n14:20:27  <10.52.9.192> SSH: Set ssh_extra_args: ()\r\n14:20:27  <10.52.9.192> SSH: found only ControlPersist; added ControlPath: (-o)(ControlPath=\"/home/build/.ansible/cp/74b21c1c30\")\r\n14:20:27  <10.52.9.192> SSH: EXEC ssh -vvv -o ControlMaster=auto -o ControlPersist=10s -o StrictHostKeyChecking=accept-new -o UserKnownHostsFile=/srv/jenkins-agent/workspace/xxx-dev/provisioning/ssh/known_hosts.d/xxx -o HashKnownHosts=no -o ServerAliveInterval=5 -o ServerAliveCountMax=1 -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"/home/build/.ansible/cp/74b21c1c30\"' 10.52.9.192 '/bin/sh -c '\"'\"'/usr/bin/python3 && sleep 0'\"'\"''\r\n14:20:28  TASK [Gathering Facts] *********************************************************\r\n14:20:28  task path: /srv/jenkins-agent/workspace/xxx-dev/provisioning/ansible-sigpipe.yml:1\r\n14:20:28  fatal: [xxx]: FAILED! => {\r\n14:20:28      \"ansible_facts\": {},\r\n14:20:28      \"changed\": false,\r\n14:20:28      \"failed_modules\": {\r\n14:20:28          \"ansible.legacy.setup\": {\r\n14:20:28              \"failed\": true,\r\n14:20:28              \"module_stderr\": \"OpenSSH_8.0p1, OpenSSL 1.1.1k  FIPS 25 Mar 2021\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for 'final all' host 10.52.9.192 originally 10.52.9.192\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: not matched 'final'\\r\\ndebug2: match not found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1 (parse only)\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: configuration requests final Match pass\\r\\ndebug2: resolve_canonicalize: hostname 10.52.9.192 is address\\r\\ndebug1: re-parsing configuration\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug3: /etc/ssh/ssh_config line 52: Including file /etc/ssh/ssh_config.d/05-redhat.conf depth 0\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config.d/05-redhat.conf\\r\\ndebug2: checking match for 'final all' host 10.52.9.192 originally 10.52.9.192\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 3: matched 'final'\\r\\ndebug2: match found\\r\\ndebug3: /etc/ssh/ssh_config.d/05-redhat.conf line 5: Including file /etc/crypto-policies/back-ends/openssh.config depth 1\\r\\ndebug1: Reading configuration data /etc/crypto-policies/back-ends/openssh.config\\r\\ndebug3: gss kex names ok: [gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-]\\r\\ndebug3: kex names ok: [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1]\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\n\",\r\n14:20:28              \"module_stdout\": \"\",\r\n14:20:28              \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n14:20:28              \"rc\": -13\r\n14:20:28          }\r\n14:20:28      }\r\n14:20:28  }\r\n14:20:28  \r\n14:20:28  MSG:\r\n14:20:28  \r\n14:20:28  The following modules failed to execute: ansible.legacy.setup\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-26T12:22:35Z",
        "user": "SpComb",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.15"
        ]
    },
    {
        "number": 81751,
        "title": "pip module never set to changed when installing from github",
        "body": "### Summary\n\nWhen installing the latest version of a git repository using `ansible.builtin.pip`, the status is never set to changed, not even when using `state:forcereinstall`. If I investigate the virtual environment on the provisioned system using `pip freeze`, I see that the virtual environment was in fact reinstalled, using the latest changes from git. However, since `changed` is never set to true, none of the defined `notify` handlers are triggered. \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\npip\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.4]\r\n  config file = None\r\n  configured module search path = ['/home/username/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/username/.local/pipx/venvs/ansible/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/username/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/username/.local/bin/ansible\r\n  python version = 3.11.5 | packaged by conda-forge | (main, Aug 27 2023, 03:34:09) [GCC 12.3.0] (/home/username/.local/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.3 LTS\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n    - name: Create virtualenv\r\n      become: yes\r\n      become_user: \"{{ user }}\"\r\n      ansible.builtin.pip:\r\n        name:\r\n          - \"git+{{ repo_url }}@{{ repo_tag }}\"\r\n          - gunicorn\r\n        virtualenv: \"{{ exonviz_dir }}/venv\"\r\n        state: forcereinstall\r\n      notify:\r\n        - Restart gunicorn\r\n\r\n```\r\n\n\n### Expected Results\n\nI expect ansible to set the task to `changed` if pip installs a newer version from a git repository.\n\n### Actual Results\n\n```console\nTASK [Create virtualenv] *******************************************************\r\ntask path: /home/username/devel/exonviz-web/playbook.yml:41\r\n<192.168.121.53> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<192.168.121.53> SSH: EXEC ssh -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' 192.168.121.53 '/bin/sh -c '\"'\"'echo ~vagrant && sleep 0'\"'\"''\r\n<192.168.121.53> (0, b'/home/vagrant\\n', b'')\r\n<192.168.121.53> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<192.168.121.53> SSH: EXEC ssh -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' 192.168.121.53 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /var/tmp `\"&& mkdir \"` echo /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004 `\" && echo ansible-tmp-1695297866.1154392-38396-180391496842004=\"` echo /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004 `\" ) && sleep 0'\"'\"''\r\n<192.168.121.53> (0, b'ansible-tmp-1695297866.1154392-38396-180391496842004=/var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004\\n', b'')\r\nUsing module file /home/username/.local/pipx/venvs/ansible/lib/python3.11/site-packages/ansible/modules/pip.py\r\n<192.168.121.53> PUT /home/username/.ansible/tmp/ansible-local-38315rs622_7x/tmp3eds13mw TO /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/AnsiballZ_pip.py\r\n<192.168.121.53> SSH: EXEC sftp -b - -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' '[192.168.121.53]'\r\n<192.168.121.53> (0, b'sftp> put /home/username/.ansible/tmp/ansible-local-38315rs622_7x/tmp3eds13mw /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/AnsiballZ_pip.py\\n', b'')\r\n<192.168.121.53> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<192.168.121.53> SSH: EXEC ssh -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' 192.168.121.53 '/bin/sh -c '\"'\"'setfacl -m u:dcrt:r-x /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/ /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/AnsiballZ_pip.py && sleep 0'\"'\"''\r\n<192.168.121.53> (0, b'', b'')\r\n<192.168.121.53> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<192.168.121.53> SSH: EXEC ssh -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' -tt 192.168.121.53 '/bin/sh -c '\"'\"'sudo -H -S -n  -u dcrt /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-qinjwxxyuxmrdhhrskaqinsyarazdbfs ; /usr/bin/python3 /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/AnsiballZ_pip.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<192.168.121.53> (0, b'\\r\\n{\"changed\": false, \"cmd\": [\"/opt/exonviz/venv/bin/pip3\", \"install\", \"-U\", \"--force-reinstall\", \"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\", \"gunicorn\"], \"name\": [\"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\", \"gunicorn\"], \"version\": null, \"state\": \"forcereinstall\", \"requirements\": null, \"virtualenv\": \"/opt/exonviz/venv\", \"stdout\": \"Collecting git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\\\\n  Cloning https://github.com/Redmar-van-den-Berg/exonviz-web.git (to revision debug) to ./pip-req-build-rgxfub5o\\\\n  Resolved https://github.com/Redmar-van-den-Berg/exonviz-web.git to commit 599150a8c404003d49392229a640fcfc5fcc0b84\\\\n  Preparing metadata (setup.py): started\\\\n  Preparing metadata (setup.py): finished with status \\'done\\'\\\\nCollecting gunicorn\\\\n  Using cached gunicorn-21.2.0-py3-none-any.whl (80 kB)\\\\nCollecting exonviz>=0.1.4\\\\n  Using cached exonviz-0.1.4-py3-none-any.whl (187 kB)\\\\nCollecting flask\\\\n  Using cached flask-2.3.3-py3-none-any.whl (96 kB)\\\\nCollecting packaging\\\\n  Using cached packaging-23.1-py3-none-any.whl (48 kB)\\\\nCollecting svg.py\\\\n  Using cached svg.py-1.4.2-py3-none-any.whl (13 kB)\\\\nCollecting Werkzeug>=2.3.7\\\\n  Using cached werkzeug-2.3.7-py3-none-any.whl (242 kB)\\\\nCollecting Jinja2>=3.1.2\\\\n  Using cached Jinja2-3.1.2-py3-none-any.whl (133 kB)\\\\nCollecting itsdangerous>=2.1.2\\\\n  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\\\\nCollecting click>=8.1.3\\\\n  Using cached click-8.1.7-py3-none-any.whl (97 kB)\\\\nCollecting blinker>=1.6.2\\\\n  Using cached blinker-1.6.2-py3-none-any.whl (13 kB)\\\\nCollecting MarkupSafe>=2.0\\\\n  Using cached MarkupSafe-2.1.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28 kB)\\\\nBuilding wheels for collected packages: exonviz-web\\\\n  Building wheel for exonviz-web (setup.py): started\\\\n  Building wheel for exonviz-web (setup.py): finished with status \\'done\\'\\\\n  Created wheel for exonviz-web: filename=exonviz_web-0.0.1-py3-none-any.whl size=5376 sha256=90ff42f87499732f1b719b3f180739b1ed29ff8721858cf536735bbcd6b4b12f\\\\n  Stored in directory: /tmp/pip-ephem-wheel-cache-2yf669tb/wheels/91/83/19/78e8320f85eac34a87fc84ad2962739fe70108f5b50345b5d9\\\\nSuccessfully built exonviz-web\\\\nInstalling collected packages: svg.py, packaging, MarkupSafe, itsdangerous, click, blinker, Werkzeug, Jinja2, gunicorn, exonviz, flask, exonviz-web\\\\n  Attempting uninstall: svg.py\\\\n    Found existing installation: svg.py 1.4.2\\\\n    Uninstalling svg.py-1.4.2:\\\\n      Successfully uninstalled svg.py-1.4.2\\\\n  Attempting uninstall: packaging\\\\n    Found existing installation: packaging 23.1\\\\n    Uninstalling packaging-23.1:\\\\n      Successfully uninstalled packaging-23.1\\\\n  Attempting uninstall: MarkupSafe\\\\n    Found existing installation: MarkupSafe 2.1.3\\\\n    Uninstalling MarkupSafe-2.1.3:\\\\n      Successfully uninstalled MarkupSafe-2.1.3\\\\n  Attempting uninstall: itsdangerous\\\\n    Found existing installation: itsdangerous 2.1.2\\\\n    Uninstalling itsdangerous-2.1.2:\\\\n      Successfully uninstalled itsdangerous-2.1.2\\\\n  Attempting uninstall: click\\\\n    Found existing installation: click 8.1.7\\\\n    Uninstalling click-8.1.7:\\\\n      Successfully uninstalled click-8.1.7\\\\n  Attempting uninstall: blinker\\\\n    Found existing installation: blinker 1.6.2\\\\n    Uninstalling blinker-1.6.2:\\\\n      Successfully uninstalled blinker-1.6.2\\\\n  Attempting uninstall: Werkzeug\\\\n    Found existing installation: Werkzeug 2.3.7\\\\n    Uninstalling Werkzeug-2.3.7:\\\\n      Successfully uninstalled Werkzeug-2.3.7\\\\n  Attempting uninstall: Jinja2\\\\n    Found existing installation: Jinja2 3.1.2\\\\n    Uninstalling Jinja2-3.1.2:\\\\n      Successfully uninstalled Jinja2-3.1.2\\\\n  Attempting uninstall: gunicorn\\\\n    Found existing installation: gunicorn 21.2.0\\\\n    Uninstalling gunicorn-21.2.0:\\\\n      Successfully uninstalled gunicorn-21.2.0\\\\n  Attempting uninstall: exonviz\\\\n    Found existing installation: exonviz 0.1.4\\\\n    Uninstalling exonviz-0.1.4:\\\\n      Successfully uninstalled exonviz-0.1.4\\\\n  Attempting uninstall: flask\\\\n    Found existing installation: Flask 2.3.3\\\\n    Uninstalling Flask-2.3.3:\\\\n      Successfully uninstalled Flask-2.3.3\\\\n  Attempting uninstall: exonviz-web\\\\n    Found existing installation: exonviz-web 0.0.1\\\\n    Uninstalling exonviz-web-0.0.1:\\\\n      Successfully uninstalled exonviz-web-0.0.1\\\\nSuccessfully installed Jinja2-3.1.2 MarkupSafe-2.1.3 Werkzeug-2.3.7 blinker-1.6.2 click-8.1.7 exonviz-0.1.4 exonviz-web-0.0.1 flask-2.3.3 gunicorn-21.2.0 itsdangerous-2.1.2 packaging-23.1 svg.py-1.4.2\\\\n\", \"stderr\": \"  Running command git clone --filter=blob:none --quiet https://github.com/Redmar-van-den-Berg/exonviz-web.git /tmp/pip-req-build-rgxfub5o\\\\n  Running command git checkout -b debug --track origin/debug\\\\n  Switched to a new branch \\'debug\\'\\\\n  branch \\'debug\\' set up to track \\'origin/debug\\'.\\\\n\", \"invocation\": {\"module_args\": {\"name\": [\"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\", \"gunicorn\"], \"virtualenv\": \"/opt/exonviz/venv\", \"state\": \"forcereinstall\", \"virtualenv_site_packages\": false, \"virtualenv_command\": \"virtualenv\", \"editable\": false, \"version\": null, \"requirements\": null, \"virtualenv_python\": null, \"extra_args\": null, \"chdir\": null, \"executable\": null, \"umask\": null}}}\\r\\n', b'Shared connection to 192.168.121.53 closed.\\r\\n')\r\n<192.168.121.53> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<192.168.121.53> SSH: EXEC ssh -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=22 -o 'IdentityFile=\"/home/username/devel/exonviz-web/.vagrant/machines/default/libvirt/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"vagrant\"' -o ConnectTimeout=30 -o 'ControlPath=\"/home/username/.ansible/cp/c142c507a4\"' 192.168.121.53 '/bin/sh -c '\"'\"'rm -f -r /var/tmp/ansible-tmp-1695297866.1154392-38396-180391496842004/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<192.168.121.53> (0, b'', b'')\r\nok: [default] => {\r\n    \"changed\": false,\r\n    \"cmd\": [\r\n        \"/opt/exonviz/venv/bin/pip3\",\r\n        \"install\",\r\n        \"-U\",\r\n        \"--force-reinstall\",\r\n        \"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\",\r\n        \"gunicorn\"\r\n    ],\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"chdir\": null,\r\n            \"editable\": false,\r\n            \"executable\": null,\r\n            \"extra_args\": null,\r\n            \"name\": [\r\n                \"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\",\r\n                \"gunicorn\"\r\n            ],\r\n            \"requirements\": null,\r\n            \"state\": \"forcereinstall\",\r\n            \"umask\": null,\r\n            \"version\": null,\r\n            \"virtualenv\": \"/opt/exonviz/venv\",\r\n            \"virtualenv_command\": \"virtualenv\",\r\n            \"virtualenv_python\": null,\r\n            \"virtualenv_site_packages\": false\r\n        }\r\n    },\r\n    \"name\": [\r\n        \"git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\",\r\n        \"gunicorn\"\r\n    ],\r\n    \"requirements\": null,\r\n    \"state\": \"forcereinstall\",\r\n    \"stderr\": \"  Running command git clone --filter=blob:none --quiet https://github.com/Redmar-van-den-Berg/exonviz-web.git /tmp/pip-req-build-rgxfub5o\\n  Running command git checkout -b debug --track origin/debug\\n  Switched to a new branch 'debug'\\n  branch 'debug' set up to track 'origin/debug'.\\n\",\r\n    \"stderr_lines\": [\r\n        \"  Running command git clone --filter=blob:none --quiet https://github.com/Redmar-van-den-Berg/exonviz-web.git /tmp/pip-req-build-rgxfub5o\",\r\n        \"  Running command git checkout -b debug --track origin/debug\",\r\n        \"  Switched to a new branch 'debug'\",\r\n        \"  branch 'debug' set up to track 'origin/debug'.\"\r\n    ],\r\n    \"stdout\": \"Collecting git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\\n  Cloning https://github.com/Redmar-van-den-Berg/exonviz-web.git (to revision debug) to ./pip-req-build-rgxfub5o\\n  Resolved https://github.com/Redmar-van-den-Berg/exonviz-web.git to commit 599150a8c404003d49392229a640fcfc5fcc0b84\\n  Preparing metadata (setup.py): started\\n  Preparing metadata (setup.py): finished with status 'done'\\nCollecting gunicorn\\n  Using cached gunicorn-21.2.0-py3-none-any.whl (80 kB)\\nCollecting exonviz>=0.1.4\\n  Using cached exonviz-0.1.4-py3-none-any.whl (187 kB)\\nCollecting flask\\n  Using cached flask-2.3.3-py3-none-any.whl (96 kB)\\nCollecting packaging\\n  Using cached packaging-23.1-py3-none-any.whl (48 kB)\\nCollecting svg.py\\n  Using cached svg.py-1.4.2-py3-none-any.whl (13 kB)\\nCollecting Werkzeug>=2.3.7\\n  Using cached werkzeug-2.3.7-py3-none-any.whl (242 kB)\\nCollecting Jinja2>=3.1.2\\n  Using cached Jinja2-3.1.2-py3-none-any.whl (133 kB)\\nCollecting itsdangerous>=2.1.2\\n  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\\nCollecting click>=8.1.3\\n  Using cached click-8.1.7-py3-none-any.whl (97 kB)\\nCollecting blinker>=1.6.2\\n  Using cached blinker-1.6.2-py3-none-any.whl (13 kB)\\nCollecting MarkupSafe>=2.0\\n  Using cached MarkupSafe-2.1.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28 kB)\\nBuilding wheels for collected packages: exonviz-web\\n  Building wheel for exonviz-web (setup.py): started\\n  Building wheel for exonviz-web (setup.py): finished with status 'done'\\n  Created wheel for exonviz-web: filename=exonviz_web-0.0.1-py3-none-any.whl size=5376 sha256=90ff42f87499732f1b719b3f180739b1ed29ff8721858cf536735bbcd6b4b12f\\n  Stored in directory: /tmp/pip-ephem-wheel-cache-2yf669tb/wheels/91/83/19/78e8320f85eac34a87fc84ad2962739fe70108f5b50345b5d9\\nSuccessfully built exonviz-web\\nInstalling collected packages: svg.py, packaging, MarkupSafe, itsdangerous, click, blinker, Werkzeug, Jinja2, gunicorn, exonviz, flask, exonviz-web\\n  Attempting uninstall: svg.py\\n    Found existing installation: svg.py 1.4.2\\n    Uninstalling svg.py-1.4.2:\\n      Successfully uninstalled svg.py-1.4.2\\n  Attempting uninstall: packaging\\n    Found existing installation: packaging 23.1\\n    Uninstalling packaging-23.1:\\n      Successfully uninstalled packaging-23.1\\n  Attempting uninstall: MarkupSafe\\n    Found existing installation: MarkupSafe 2.1.3\\n    Uninstalling MarkupSafe-2.1.3:\\n      Successfully uninstalled MarkupSafe-2.1.3\\n  Attempting uninstall: itsdangerous\\n    Found existing installation: itsdangerous 2.1.2\\n    Uninstalling itsdangerous-2.1.2:\\n      Successfully uninstalled itsdangerous-2.1.2\\n  Attempting uninstall: click\\n    Found existing installation: click 8.1.7\\n    Uninstalling click-8.1.7:\\n      Successfully uninstalled click-8.1.7\\n  Attempting uninstall: blinker\\n    Found existing installation: blinker 1.6.2\\n    Uninstalling blinker-1.6.2:\\n      Successfully uninstalled blinker-1.6.2\\n  Attempting uninstall: Werkzeug\\n    Found existing installation: Werkzeug 2.3.7\\n    Uninstalling Werkzeug-2.3.7:\\n      Successfully uninstalled Werkzeug-2.3.7\\n  Attempting uninstall: Jinja2\\n    Found existing installation: Jinja2 3.1.2\\n    Uninstalling Jinja2-3.1.2:\\n      Successfully uninstalled Jinja2-3.1.2\\n  Attempting uninstall: gunicorn\\n    Found existing installation: gunicorn 21.2.0\\n    Uninstalling gunicorn-21.2.0:\\n      Successfully uninstalled gunicorn-21.2.0\\n  Attempting uninstall: exonviz\\n    Found existing installation: exonviz 0.1.4\\n    Uninstalling exonviz-0.1.4:\\n      Successfully uninstalled exonviz-0.1.4\\n  Attempting uninstall: flask\\n    Found existing installation: Flask 2.3.3\\n    Uninstalling Flask-2.3.3:\\n      Successfully uninstalled Flask-2.3.3\\n  Attempting uninstall: exonviz-web\\n    Found existing installation: exonviz-web 0.0.1\\n    Uninstalling exonviz-web-0.0.1:\\n      Successfully uninstalled exonviz-web-0.0.1\\nSuccessfully installed Jinja2-3.1.2 MarkupSafe-2.1.3 Werkzeug-2.3.7 blinker-1.6.2 click-8.1.7 exonviz-0.1.4 exonviz-web-0.0.1 flask-2.3.3 gunicorn-21.2.0 itsdangerous-2.1.2 packaging-23.1 svg.py-1.4.2\\n\",\r\n    \"stdout_lines\": [\r\n        \"Collecting git+https://github.com/Redmar-van-den-Berg/exonviz-web.git@debug\",\r\n        \"  Cloning https://github.com/Redmar-van-den-Berg/exonviz-web.git (to revision debug) to ./pip-req-build-rgxfub5o\",\r\n        \"  Resolved https://github.com/Redmar-van-den-Berg/exonviz-web.git to commit 599150a8c404003d49392229a640fcfc5fcc0b84\",\r\n        \"  Preparing metadata (setup.py): started\",\r\n        \"  Preparing metadata (setup.py): finished with status 'done'\",\r\n        \"Collecting gunicorn\",\r\n        \"  Using cached gunicorn-21.2.0-py3-none-any.whl (80 kB)\",\r\n        \"Collecting exonviz>=0.1.4\",\r\n        \"  Using cached exonviz-0.1.4-py3-none-any.whl (187 kB)\",\r\n        \"Collecting flask\",\r\n        \"  Using cached flask-2.3.3-py3-none-any.whl (96 kB)\",\r\n        \"Collecting packaging\",\r\n        \"  Using cached packaging-23.1-py3-none-any.whl (48 kB)\",\r\n        \"Collecting svg.py\",\r\n        \"  Using cached svg.py-1.4.2-py3-none-any.whl (13 kB)\",\r\n        \"Collecting Werkzeug>=2.3.7\",\r\n        \"  Using cached werkzeug-2.3.7-py3-none-any.whl (242 kB)\",\r\n        \"Collecting Jinja2>=3.1.2\",\r\n        \"  Using cached Jinja2-3.1.2-py3-none-any.whl (133 kB)\",\r\n        \"Collecting itsdangerous>=2.1.2\",\r\n        \"  Using cached itsdangerous-2.1.2-py3-none-any.whl (15 kB)\",\r\n        \"Collecting click>=8.1.3\",\r\n        \"  Using cached click-8.1.7-py3-none-any.whl (97 kB)\",\r\n        \"Collecting blinker>=1.6.2\",\r\n        \"  Using cached blinker-1.6.2-py3-none-any.whl (13 kB)\",\r\n        \"Collecting MarkupSafe>=2.0\",\r\n        \"  Using cached MarkupSafe-2.1.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28 kB)\",\r\n        \"Building wheels for collected packages: exonviz-web\",\r\n        \"  Building wheel for exonviz-web (setup.py): started\",\r\n        \"  Building wheel for exonviz-web (setup.py): finished with status 'done'\",\r\n        \"  Created wheel for exonviz-web: filename=exonviz_web-0.0.1-py3-none-any.whl size=5376 sha256=90ff42f87499732f1b719b3f180739b1ed29ff8721858cf536735bbcd6b4b12f\",\r\n        \"  Stored in directory: /tmp/pip-ephem-wheel-cache-2yf669tb/wheels/91/83/19/78e8320f85eac34a87fc84ad2962739fe70108f5b50345b5d9\",\r\n        \"Successfully built exonviz-web\",\r\n        \"Installing collected packages: svg.py, packaging, MarkupSafe, itsdangerous, click, blinker, Werkzeug, Jinja2, gunicorn, exonviz, flask, exonviz-web\",\r\n        \"  Attempting uninstall: svg.py\",\r\n        \"    Found existing installation: svg.py 1.4.2\",\r\n        \"    Uninstalling svg.py-1.4.2:\",\r\n        \"      Successfully uninstalled svg.py-1.4.2\",\r\n        \"  Attempting uninstall: packaging\",\r\n        \"    Found existing installation: packaging 23.1\",\r\n        \"    Uninstalling packaging-23.1:\",\r\n        \"      Successfully uninstalled packaging-23.1\",\r\n        \"  Attempting uninstall: MarkupSafe\",\r\n        \"    Found existing installation: MarkupSafe 2.1.3\",\r\n        \"    Uninstalling MarkupSafe-2.1.3:\",\r\n        \"      Successfully uninstalled MarkupSafe-2.1.3\",\r\n        \"  Attempting uninstall: itsdangerous\",\r\n        \"    Found existing installation: itsdangerous 2.1.2\",\r\n        \"    Uninstalling itsdangerous-2.1.2:\",\r\n        \"      Successfully uninstalled itsdangerous-2.1.2\",\r\n        \"  Attempting uninstall: click\",\r\n        \"    Found existing installation: click 8.1.7\",\r\n        \"    Uninstalling click-8.1.7:\",\r\n        \"      Successfully uninstalled click-8.1.7\",\r\n        \"  Attempting uninstall: blinker\",\r\n        \"    Found existing installation: blinker 1.6.2\",\r\n        \"    Uninstalling blinker-1.6.2:\",\r\n        \"      Successfully uninstalled blinker-1.6.2\",\r\n        \"  Attempting uninstall: Werkzeug\",\r\n        \"    Found existing installation: Werkzeug 2.3.7\",\r\n        \"    Uninstalling Werkzeug-2.3.7:\",\r\n        \"      Successfully uninstalled Werkzeug-2.3.7\",\r\n        \"  Attempting uninstall: Jinja2\",\r\n        \"    Found existing installation: Jinja2 3.1.2\",\r\n        \"    Uninstalling Jinja2-3.1.2:\",\r\n        \"      Successfully uninstalled Jinja2-3.1.2\",\r\n        \"  Attempting uninstall: gunicorn\",\r\n        \"    Found existing installation: gunicorn 21.2.0\",\r\n        \"    Uninstalling gunicorn-21.2.0:\",\r\n        \"      Successfully uninstalled gunicorn-21.2.0\",\r\n        \"  Attempting uninstall: exonviz\",\r\n        \"    Found existing installation: exonviz 0.1.4\",\r\n        \"    Uninstalling exonviz-0.1.4:\",\r\n        \"      Successfully uninstalled exonviz-0.1.4\",\r\n        \"  Attempting uninstall: flask\",\r\n        \"    Found existing installation: Flask 2.3.3\",\r\n        \"    Uninstalling Flask-2.3.3:\",\r\n        \"      Successfully uninstalled Flask-2.3.3\",\r\n        \"  Attempting uninstall: exonviz-web\",\r\n        \"    Found existing installation: exonviz-web 0.0.1\",\r\n        \"    Uninstalling exonviz-web-0.0.1:\",\r\n        \"      Successfully uninstalled exonviz-web-0.0.1\",\r\n        \"Successfully installed Jinja2-3.1.2 MarkupSafe-2.1.3 Werkzeug-2.3.7 blinker-1.6.2 click-8.1.7 exonviz-0.1.4 exonviz-web-0.0.1 flask-2.3.3 gunicorn-21.2.0 itsdangerous-2.1.2 packaging-23.1 svg.py-1.4.2\"\r\n    ],\r\n    \"version\": null,\r\n    \"virtualenv\": \"/opt/exonviz/venv\"\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-21T12:13:22Z",
        "user": "Redmar-van-den-Berg",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81735,
        "title": "role argument spec: allow for notes, seealso, requirements, version_added like with plugins",
        "body": "### Summary\r\n\r\nWhen documenting plugins, one can use `notes`, `requirements`, `version_added` and `seealso` in the `DOCUMENT` block to enhance the docs with references and further explanations that don't fit into `description`.\r\n\r\nThose are currently not accepted in the role argument spec (well, arguably, they do not describe arguments), and thus are missing from the output of `ansible-doc`\r\n\r\nInterestingly, `ansible-lint` does allow `seealso` and `version_added`, but not `notes` and `requirements`: https://github.com/ansible/ansible-lint/blob/9d96cfbbe1e4d468de3a13de1fe49ff7364952b8/src/ansiblelint/schemas/role-arg-spec.json while Ansible docs don't call those out as supported in https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_reuse_roles.html#role-argument-validation\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nrole\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-20T09:48:13Z",
        "user": "evgeni",
        "labels": [
            "waiting_on_contributor",
            "has_pr",
            "feature"
        ]
    },
    {
        "number": 81698,
        "title": "ansible-galaxy collection publish ignores --token argument when custom galaxy server is configured",
        "body": "### Summary\r\n\r\nWhen a custom Galaxy servers configured without token in `ansible.cfg` as follows:\r\n\r\n```ini\r\n[galaxy]\r\nserver_list = private\r\nignore_certs = yes\r\n\r\n[galaxy_server.private]\r\nurl = https://MYSERVER.local/api\r\n```\r\n\r\nThen token passed via command line argument is not used at all,\r\ne.g. `ansible-galaxy collection publish --token <MYTOKEN> <MYCOLLECTION>.tar.gz`\r\nDOES NOT send `Authorization:  Token <MYTOKEN>` header, that results in 401 authorisation error.\r\n\r\nHowever, token IS sent when server url is also passed via command line argument, e.g.following command completes successfully:\r\n`ansible-galaxy collection publish --server https://MYSERVER.local/api --token <MYTOKEN> <MYCOLLECTION>.tar.gz`\r\n\r\n\r\nAlso, token IS sent when `token=<MYTOKEN>` is set in the `[galaxy_server.private]` section, e.g.\r\n```ini\r\n[galaxy]\r\nserver_list = private\r\nignore_certs = yes\r\n\r\n[galaxy_server.private]\r\nurl = https://MYSERVER.local/api\r\ntoken = <MYTOKEN>\r\n```\r\n\r\nThat issue is important for CI integration, because default configuration usually resides in git and secrets are usually passed as either environment variable or command line argument\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/galaxy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible [core 2.15.4]\r\n  config file = /Users/m.shonichev/ansible.cfg\r\n  configured module search path = ['/Users/m.shonichev/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /Users/m.shonichev/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.11.4 (main, Jun 20 2023, 16:52:35) [Clang 13.0.0 (clang-1300.0.29.30)] (/usr/local/opt/python@3.11/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /Users/m.shonichev/ansible.cfg\r\nGALAXY_IGNORE_CERTS(/Users/m.shonichev/ansible.cfg) = True\r\nGALAXY_SERVER_LIST(/Users/m.shonichev/ansible.cfg) = ['private']\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nMac OS\r\n\r\n### Steps to Reproduce\r\n\r\n1. deploy a Galaxy compatible REST API server with token authorization at some URL, e.g. `https://galaxy-ng.local/`\r\nhttps://github.com/ansible/galaxy_ng for example\r\n\r\n2. configure server URL in the ANSIBLE_CONFIG. Do NOT configure token in the config.\r\n\r\n```shell\r\ncat <<EOF >~/ansible.cfg        \r\n[galaxy]\r\nserver_list = private\r\n[galaxy_server.private]\r\nurl = https://galaxy-ng.local/api\r\nEOF\r\n```\r\n\r\n3. create a collection \r\n```shell\r\nansible-galaxy collection init my.test\r\ncd my/test\r\nansible-galaxy collection build\r\n```\r\n\r\n4. try to publish collection, do NOT specify server URL, only pass authorisation token. \r\n```shell\r\nansible-galaxy collection publish --token MYTOKEN my-test-*.tar.gz\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect token to be correctly passed to the configured server and collection published successfully\r\n\r\n### Actual Results\r\ntoken is not passed, 401 authorization error thrown\r\n```console\r\nUsing /Users/m.shonichev/ansible.cfg as config file\r\nPublishing collection artifact '/Users/m.shonichev/my/test/my-test-1.0.0.tar.gz' to private https://galaxy-ng.local/api\r\nERROR! Error when publishing collection to private (https://galaxy-ng.local/api) (HTTP Code: 401, Message: UNAUTHORIZED Code: Unknown)\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-14T00:21:28Z",
        "user": "mshonichev",
        "labels": [
            "bug",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 81687,
        "title": "Galaxy Version syntax breaking installation from local copies",
        "body": "### Summary\n\nI use local copies of galaxy collections and roles for various reasons, supply chain protection, air gapped environments etc, and update my requirements to this purpose.\r\n\r\nRecent changes to Galaxy seems to have started using a 'v' character in front of the collection version.  When I try to install a collection from a local repository where the version tag includes the 'v' the installation will fail stating that the 'v' is a non-integer value.  If the 'v' is removed galaxy stops complaining but cannot find tagged version of the code from the local repository.  If you pull the same version from the internet copy of the collection there are no issues, again as long as the 'v' character is not present.  It seems that for direct internet pull galaxy is pre-pending the 'v' character when needed.  Older version releases do not have the 'v' character and work as expected in both environments.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngalaxy\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.3]\r\n  config file = None\r\n  configured module search path = ['/home/osbourj/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/osbourj/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/osbourj/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/osbourj/.local/bin/ansible\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCOLLECTIONS_PATHS(/home/osbourj/git/devops/ansible/ansible.cfg) = ['/home/osbourj/git/devops/ansible/galaxy/collections']\r\nCONFIG_FILE() = /home/osbourj/git/devops/ansible/ansible.cfg\r\nDEFAULT_HOST_LIST(/home/osbourj/git/devops/ansible/ansible.cfg) = ['/home/osbourj/git/devops/ansible/inventory']\r\nDEFAULT_ROLES_PATH(/home/osbourj/git/devops/ansible/ansible.cfg) = ['/home/osbourj/git/devops/ansible/galaxy/roles', '/home/osbourj/git/devops/ansible/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/osbourj/git/devops/ansible/ansible.cfg) = /home/osbourj/git/devops/ansible/.vault_password\r\nHOST_KEY_CHECKING(/home/osbourj/git/devops/ansible/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/osbourj/git/devops/ansible/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/osbourj/git/devops/ansible/ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nUbuntu 22.04 instance used for running Ansible commands.  Running as a WSL2 instance on Windows 10 workstation.\n\n### Steps to Reproduce\n\ncreate a local clone, with all tags, of a galaxy collection, e.g. ansible.utils\r\ncreate your requirements.yml file and add a definition of the collection you want, e.g.\r\n```\r\ncollections:\r\n- name: ansible.utils\r\n  source: https://git.example.com/scm/ag/ansible.utils.git\r\n  type: git\r\n  version: v2.10.3\r\n```\r\ntry and install using ansible-galaxy, you may need --force\r\n`ansible-galaxy install -r requirements.yml`\n\n### Expected Results\n\nSomething like the following from the internal git server\r\n```\r\n$ ansible-galaxy install -r requirements.yml\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nCloning into '/home/osbourj/.ansible/tmp/ansible-local-1825376tz5s94hl/tmpg88ef51d/ansible-collections.ansible.utilsvcodt2jp'...\r\nremote: Enumerating objects: 4067, done.\r\nremote: Counting objects: 100% (4067/4067), done.\r\nremote: Compressing objects: 100% (1443/1443), done.\r\nremote: Total 4067 (delta 2409), reused 3960 (delta 2362), pack-reused 0\r\nReceiving objects: 100% (4067/4067), 1.14 MiB | 13.39 MiB/s, done.\r\nResolving deltas: 100% (2409/2409), done.\r\nNote: switching to '2.9.0'.\r\n\r\nStarting collection install process\r\nInstalling 'ansible.utils:*' to '/home/osbourj/git/devops/ansible/galaxy/collections/ansible_collections/ansible/utils'\r\nCreated collection for ansible.utils:* at /home/osbourj/git/devops/ansible/galaxy/collections/ansible_collections/ansible/utils\r\nansible.utils:* was installed successfully```\n\n### Actual Results\n\n```console\nWhen you first try you get the following\r\n\r\n$ ansible-galaxy install -r requirements.yml\r\nStarting galaxy collection install process\r\nERROR! Unexpected Exception, this is probably a bug: Non integer values in LooseVersion ('v2.10.3')\r\nto see the full traceback, use -vvv\r\n```\r\nIf you then remove the 'v' from the version\r\n```\r\n$ ansible-galaxy install -r requirements.yml --force\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nCloning into '/home/username/.ansible/tmp/ansible-local-64476pof1nrxd/tmpl2m53bbz/ansible.utilscgfd1gdn'...\r\nremote: Enumerating objects: 4067, done.\r\nremote: Counting objects: 100% (4067/4067), done.\r\nremote: Compressing objects: 100% (1443/1443), done.\r\nremote: Total 4067 (delta 2410), reused 3960 (delta 2362), pack-reused 0\r\nReceiving objects: 100% (4067/4067), 1.14 MiB | 12.66 MiB/s, done.\r\nResolving deltas: 100% (2410/2410), done.\r\nerror: pathspec '2.10.3' did not match any file(s) known to git\r\nERROR! Failed to switch a cloned Git repo `https://git.example.com/scm/ag/ansible.utils.git` to the requested revision `2.10.3`.\r\n```\r\nThe tagged version on the repository has the 'v'\r\n\r\nYou can see this from the git repo local copy and github (truncated output)\r\n```\r\n$ git ls-remote local\r\nFrom ssh://git@git.example.com:7999/ag/ansible.utils.git\r\n4deddf2c3b88b0b1674945da00d9d606faec7a19        HEAD\r\n4deddf2c3b88b0b1674945da00d9d606faec7a19        refs/heads/main\r\n...\r\n06b44d9b9efc5d66eeb14751311ed93b569b1f86        refs/tags/2.8.0\r\n57904bed6434ef39da198cd7777b6a5a63a85770        refs/tags/2.8.0^{}\r\n141eb9e6bd0ee5435fde52723e40254503a825b9        refs/tags/2.9.0\r\n9acd289915bdf69dc2ec2f2432e1cbafb3f626c8        refs/tags/2.9.0^{}\r\nc6ebb51cc0bc6e09eecf9be83ad02e5a5fe47c83        refs/tags/v2.10.2\r\nc0e094637f05fc3eab673afd2635dc83c73c9b47        refs/tags/v2.10.3\r\n```\r\n```\r\n$ git ls-remote galaxy\r\n4deddf2c3b88b0b1674945da00d9d606faec7a19        HEAD\r\n1239820f78a4b2f84e56a95e3ade2a718a02ac1b        refs/heads/chore-push-16\r\n42837a62346f7b9fde8d613cc052e47ad13836a5        refs/heads/chore-push-23\r\n06cb5c837c8c58126da91e01f9d48be1bf2857f0        refs/heads/chore-push-24\r\n532da60bda660f04f5cb4aa7cb7d02de389885ad        refs/heads/chore-push-27\r\n2906db5bc39c2a39e34d2e13f7479f30d714ea58        refs/heads/chore-push-28\r\n65789d776e7a2bfaec199fb266e47e264351fb95        refs/heads/chore-push-29\r\n217c34eb071dba9dcc299ee187f1849b297413f0        refs/heads/chore-push-30\r\n4deddf2c3b88b0b1674945da00d9d606faec7a19        refs/heads/main\r\n0f5e15abf79b01e0d92b2dbe31ec0b7dc4e6974c        refs/heads/pre-commit-ci-update-config\r\n...\r\n06b44d9b9efc5d66eeb14751311ed93b569b1f86        refs/tags/2.8.0\r\n57904bed6434ef39da198cd7777b6a5a63a85770        refs/tags/2.8.0^{}\r\n141eb9e6bd0ee5435fde52723e40254503a825b9        refs/tags/2.9.0\r\n9acd289915bdf69dc2ec2f2432e1cbafb3f626c8        refs/tags/2.9.0^{}\r\nc6ebb51cc0bc6e09eecf9be83ad02e5a5fe47c83        refs/tags/v2.10.2\r\nc0e094637f05fc3eab673afd2635dc83c73c9b47        refs/tags/v2.10.3\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-12T09:22:20Z",
        "user": "jamesosbourn",
        "labels": [
            "bug",
            "has_pr",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81651,
        "title": "Clarification on host targeting in playbooks",
        "body": "### Summary\r\n\r\nI ran into a scenario where I had to target a single host, instead of a group. Since both appeared to use the same `hosts:` syntax this got me thinking, what if both a host and group share the same name? What is the processing order?\r\n\r\nExample inventory:\r\n```\r\nweb\r\nnode\r\n[web]\r\nweb\r\nnode\r\n```\r\n\r\nExample playbook:\r\n```\r\n---\r\n- hosts: web\r\n  tasks:\r\n    - debug: 'msg=test'\r\n```\r\nUsing these files for a quick test shows that Ansible does output a warning, but proceeds by only selecting the host `web`.\r\nIt's not until you set `hosts` to be `web:*` that it will select all hosts within the group `web` instead (which, given the child selector, makes sense).\r\n\r\n[This documentation page](https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html#patterns-targeting-hosts-and-groups) about targeting hosts doesn't appear to mention anything about the order in which ansible selects the matching patterns.\r\n\r\nAlthough I'm sure it's not considered best-practice, nor recommended to have a host share the same name with a group, I think the documentation would still benefit from clarification on what behavior to expect from Ansible.\r\n\r\nGiven my test it would appear that Ansible prioritizes a `host` over a `group` with the same name, until a child-selector is provided. This however, is just an assumption, and would benefit from actual documentation to prevent any unexpected scenarios.\r\n\r\n### Issue Type\r\n\r\nDocumentation Report\r\n\r\n### Component Name\r\n\r\nplaybook\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible 2.9.27\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/ansible/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /bin/ansible\r\n  python version = 2.7.5 (default, Nov 16 2020, 22:23:17) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\n<no output>\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nN/A\r\n\r\n### Additional Information\r\n\r\nIt would help clarify the expected behavior of Ansible in edge-cases like this.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-06T11:15:06Z",
        "user": "xorinzor",
        "labels": [
            "affects_2.9"
        ]
    },
    {
        "number": 81629,
        "title": "[RFE] Make it easier to upgrade all installed collections",
        "body": "### Summary\n\nOften, or at least sometimes, a user would like to upgrade all the locally installed collections to the latest and greatest versions.\r\n\r\nHowever, plain `ansible-galaxy collection install -U` expects collection name(s) or a requirement file and `ansible-galaxy collection list` does not provide output in a format that could be passed directly to `ansible-galaxy collection install -U`.\r\n\r\nIt would helpful if ansible-galaxy collection would make it easier to upgrade all installed collections. Thanks.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncore\n\n### Additional Information\n\nThis would make keeping different environments up-to-date easier and less error prone (due to need to parse output or keep manually a list of installed collections).\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-09-05T07:29:31Z",
        "user": "myllynen",
        "labels": [
            "feature"
        ]
    },
    {
        "number": 81597,
        "title": "Collection signature verification fails with offline collections",
        "body": "### Summary\r\n\r\nWhen installing a signed collection from e.g. Red Hat Automation Hub signature verification works as expected.\r\n\r\nWhen downloading the same collection locally and trying to install from the tarball an exception is thrown.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible-galaxy [core 2.15.0]\r\n  config file = /home/admin/test/ansible.cfg\r\n  configured module search path = ['/home/admin/test/a/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/admin/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/admin/test/a/c\r\n  executable location = /home/admin/.local/bin/ansible-galaxy\r\n  python version = 3.9.16 (main, May 29 2023, 00:00:00) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_HOME(/home/admin/test/ansible.cfg) = /home/admin/test/a\r\nCOLLECTIONS_ON_ANSIBLE_VERSION_MISMATCH(/home/admin/test/ansible.cfg) = error\r\nCOLLECTIONS_PATHS(/home/admin/test/ansible.cfg) = ['/home/admin/test/a/c']\r\nCOLLECTIONS_SCAN_SYS_PATH(/home/admin/test/ansible.cfg) = False\r\nCONFIG_FILE() = /home/admin/test/ansible.cfg\r\nEDITOR(env: EDITOR) = vi\r\nGALAXY_GPG_KEYRING(/home/admin/test/ansible.cfg) = /home/admin/test/a/gnupg/pubring.kbx\r\nGALAXY_SERVER_LIST(/home/admin/test/ansible.cfg) = ['redhat_certified', 'redhat_validated']\r\nPAGER(env: PAGER) = less\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 9 with Ansible 2.15 installed with pip\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n$ gpg -k --no-default-keyring --keyring ./a/gnupg/pubring.kbx\r\n./a/gnupg/pubring.kbx\r\n---------------------\r\npub   rsa4096 2022-04-11 [SC]\r\n      39B5D759361A97464C564A8FE1A4BD708A828AAD\r\nuid           [ unknown] Red Hat, Inc. (Ansible Automation Hub 1) <security@redhat.com>\r\n\r\n$ ansible-galaxy collection install -U ansible.posix\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nStarting collection install process\r\nDownloading https://console.redhat.com/api/automation-hub/v3/plugin/ansible/content/published/collections/artifacts/ansible-posix-1.5.4.tar.gz to /home/admin/test/a/tmp/ansible-local-19526g_2w8m_3/tmptbeh30rm/ansible-posix-1.5.4-g460109r\r\nInstalling 'ansible.posix:1.5.4' to '/home/admin/test/a/c/ansible_collections/ansible/posix'\r\nansible.posix:1.5.4 was installed successfully\r\n$ rm -rf ./a/c\r\n$ ansible-galaxy collection install -U ansible-posix-1.5.4.tar.gz -vvvvvv\r\nERROR! Unexpected Exception, this is probably a bug: 'NoneType' object is not iterable\r\nansible-galaxy [core 2.15.0]\r\n  config file = /home/admin/test/ansible.cfg\r\n  configured module search path = ['/home/admin/test/a/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/admin/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/admin/test/a/c\r\n  executable location = /home/admin/.local/bin/ansible-galaxy\r\n  python version = 3.9.16 (main, May 29 2023, 00:00:00) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /home/admin/test/ansible.cfg as config file\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nStarting collection install process\r\nInstalling 'ansible.posix:1.5.4' to '/home/admin/test/a/c/ansible_collections/ansible/posix'\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/cli/__init__.py\", line 659, in cli_executor\r\n    exit_code = cli.run()\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/cli/galaxy.py\", line 715, in run\r\n    return context.CLIARGS['func']()\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/cli/galaxy.py\", line 117, in method_wrapper\r\n    return wrapped_method(*args, **kwargs)\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/cli/galaxy.py\", line 1369, in execute_install\r\n    self._execute_install_collection(\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/cli/galaxy.py\", line 1406, in _execute_install_collection\r\n    install_collections(\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/galaxy/collection/__init__.py\", line 776, in install_collections\r\n    install(concrete_coll_pin, output_path, artifacts_manager)\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/galaxy/collection/__init__.py\", line 1506, in install\r\n    install_artifact(\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/galaxy/collection/__init__.py\", line 1579, in install_artifact\r\n    verify_artifact_manifest(manifest_file, signatures, keyring, required_signature_count, ignore_signature_errors)\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/galaxy/collection/__init__.py\", line 1556, in verify_artifact_manifest\r\n    if not verify_file_signatures(collection_name, manifest_file, signatures, keyring, required_signature_count, ignore_signature_errors):\r\n  File \"/home/admin/.local/lib/python3.9/site-packages/ansible/galaxy/collection/__init__.py\", line 391, in verify_file_signatures\r\n    for signature in detached_signatures:\r\nTypeError: 'NoneType' object is not iterable\r\n```\r\n\r\n### Expected Results\r\n\r\nNo exception, proper handling of the installation with or without galaxy/gpg_keyring set in the configuration.\r\n\r\n### Actual Results\r\n\r\nSee above. Installation succeeds if commenting out `gpg_keyring` in the `[galaxy]` section.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-08-30T10:18:23Z",
        "user": "myllynen",
        "labels": [
            "bug",
            "P3",
            "verified"
        ]
    },
    {
        "number": 81569,
        "title": "copy module in check mode fails to populate the dest/path attributes of the registered variable",
        "body": "### Summary\n\nwhen using the copy module in check mode, if the file would be updated, the registered variable does not contain the same attributes as it would if the file is not updated, or is not run in check mode. Failure to register the same attributes results in other parts of the playbook to fail on undefined values.\r\n\r\nchanged file in check mode registers\r\n\r\n`{\r\n\t\"changed\": true,\r\n\t\"diff\": [\r\n\t\t{\r\n\t\t\t\"before\": \"xxxx\",\r\n\t\t\t\"after\": \"yyyy\"\r\n\t\t}\r\n\t],\r\n\tfailed\": false\r\n}\r\n`\r\nbut if the file will not be changed the registered variable contains\r\n\r\n`{\r\n\t\"changed\": false,\r\n\t\"checksum\": \"692cb32b7636c2595d506af848cb666478f60acc\",\r\n\t\"dest\": \"/some/path/to/file\",\r\n\t\"diff\": {\r\n\t\t\"after\": {\r\n\t\t\t\"path\": \"/some/path/to/file\"\r\n\t\t},\r\n\t\t\"before\": {\r\n\t\t\t\"path\": \"/some/path/to/file\"\r\n\t\t}\r\n\t},\r\n\t\"failed\": false,\r\n\t\"gid\": 0,\r\n\t\"group\": \"root\",\r\n\t\"mode\": \"0440\",\r\n\t\"owner\": \"root\",\r\n\t\"path\": \"/some/path/to/file\",\r\n\t\"size\": 1679,\r\n\t\"state\": \"file\",\r\n\t\"uid\": 0\r\n}\r\n`\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.core.copy\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.2 (main, Jun  6 2023, 07:39:01) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/usr/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['/etc/ansible/inventory.sh']\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\r\nDEFAULT_PRIVATE_KEY_FILE(/etc/ansible/ansible.cfg) = /etc/ansible/ansible_rsa\r\nDEFAULT_VAULT_PASSWORD_FILE(/etc/ansible/ansible.cfg) = /etc/ansible/.passfile\r\nDEPRECATION_WARNINGS(/etc/ansible/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\nSYSTEM_WARNINGS(/etc/ansible/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nssh:\r\n___\r\npipelining(/etc/ansible/ansible.cfg) = False\r\nprivate_key_file(/etc/ansible/ansible.cfg) = /etc/ansible/ansible_rsa\n```\n\n\n### OS / Environment\n\n[xerr@aardwolf roles]$ cat /etc/redhat-release \r\nRed Hat Enterprise Linux release 8.8 (Ootpa)\r\n\n\n### Steps to Reproduce\n\ninvoke a playbook with --check that uses a copy module to place a file with a \"register: varname\" directive.\r\nThen review the contents of the varname for files that would be changed, and for files that would not be changed.\n\n### Expected Results\n\nThe registered variable should have the same attributes, possibly with different values, in check mode and not in check mode.\n\n### Actual Results\n\n```console\nmany of the attributes are not present for files that would be changed if not running in check mode.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-08-23T21:14:52Z",
        "user": "erempel",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 81549,
        "title": "v2_playbook_on_no_hosts_remaining doesn't fire without any_errors_fatal or max_fail_percentage",
        "body": "### Summary\n\nWhen using a custom callback plugin that handles the v2_playbook_on_no_hosts_remaining callback, this callback is not triggered unless `any_errors_fatal: true` or `max_fail_percentage` is specified.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlinear.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.3]\r\n  config file = None\r\n  configured module search path = ['/home/mark/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/mark/src/ansible-playground/venv-2.15/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/mark/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/mark/src/ansible-playground/venv-2.15/bin/ansible\r\n  python version = 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0] (/home/mark/src/ansible-playground/venv-2.15/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = vim\n```\n\n\n### OS / Environment\n\nUbuntu Jammy 22.04\n\n### Steps to Reproduce\n\nFull reproduction steps are described in https://github.com/markgoddard/ansible-experiments/tree/a8b912efea52d41e3ae6d5bad2d0e6fa65d2b0c0/16-no-hosts-remaining-callback.\r\n\r\nInventory:\r\n\r\n```\r\nh[1:3] ansible_connection=local\r\n```\r\n\r\nCallback plugin:\r\n\r\n```\r\nfrom __future__ import (absolute_import, division, print_function)\r\n__metaclass__ = type\r\n\r\nfrom ansible.plugins.callback import CallbackBase\r\n\r\n\r\nclass CallbackModule(CallbackBase):\r\n    CALLBACK_VERSION = 2.0\r\n    CALLBACK_TYPE = 'aggregate'\r\n    CALLBACK_NAME = 'no_hosts_remaining'\r\n    CALLBACK_NEEDS_ENABLED = False\r\n\r\n    def v2_playbook_on_no_hosts_remaining(self):\r\n        print(\"NO HOSTS REMAINING!\")\r\n```\r\n\r\nPlaybook:\r\n\r\n```\r\n---\r\n- hosts: all\r\n  tasks:\r\n    - fail:\r\n    - debug:\r\n```\r\n\r\nCommand:\r\n\r\n```\r\nansible-playbook -i inventory test.yml\r\n```\n\n### Expected Results\n\nv2_playbook_on_no_hosts_remaining callback fires and prints \"NO HOSTS REMAINING\" to stdout.\n\n### Actual Results\n\n```console\nPLAY [all] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *************************************************************************************************************************************************************************************\r\nok: [h3]\r\nok: [h1]\r\nok: [h2]\r\n\r\nTASK [fail] ************************************************************************************************************************************************************************************************\r\nfatal: [h1]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\nfatal: [h2]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\nfatal: [h3]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nh1                         : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\nh2                         : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\nh3                         : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-08-21T13:40:18Z",
        "user": "markgoddard",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 81522,
        "title": "pip virtualenv creates chdir twice when using a relative path",
        "body": "### Summary\r\n\r\n`pip` module creates the `chdir` argument twice when creating a virtual environment through `venv`.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npip\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.1]\r\n  config file = /home/xeal/work/aitb-ansible/ansible.cfg\r\n  configured module search path = ['/home/xeal/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /nix/store/a0pnfr3z94ws2vclc465wf9m41xjqsy3-python3.10-ansible-core-2.15.1/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/xeal/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /nix/store/a0pnfr3z94ws2vclc465wf9m41xjqsy3-python3.10-ansible-core-2.15.1/bin/ansible\r\n  python version = 3.10.12 (main, Jun  6 2023, 22:43:10) [GCC 12.3.0] (/nix/store/1r6n7v2wam7gkr18gxccpg7p5ywgw551-python3-3.10.12/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/xeal/work/proj/ansible.cfg\r\nDEFAULT_HOST_LIST(/home/xeal/work/proj/ansible.cfg) = ['/home/xeal/work/proj/inventory']\r\nDEFAULT_PRIVATE_KEY_FILE(env: ANSIBLE_PRIVATE_KEY_FILE) = /home/xeal/work/proj/ansible.pem\r\nDEFAULT_ROLES_PATH(/home/xeal/work/proj/ansible.cfg) = ['/home/xeal/work/proj/galaxy', '/home/xeal/work/proj/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(env: ANSIBLE_VAULT_PASSWORD_FILE) = /home/xeal/work/proj/keys/vault\r\nEDITOR(env: EDITOR) = emacs\r\nPAGER(env: PAGER) = less\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nprivate_key_file(env: ANSIBLE_PRIVATE_KEY_FILE) = /home/xeal/work/proj/ansible.pem\r\n\r\nssh:\r\n___\r\nprivate_key_file(env: ANSIBLE_PRIVATE_KEY_FILE) = /home/xeal/work/proj/ansible.pem\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nTargeting Ubuntu 18.04.05, Python 3.6\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nRun below playbook.\r\n\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  tasks:\r\n    - name: Check out repo\r\n      ansible.builtin.git:\r\n        repo: https://github.com/timofurrer/try\r\n        version: master\r\n        dest: checkout-dir\r\n    - name: Check out virtual environment\r\n      ansible.builtin.pip:\r\n        chdir: checkout-dir\r\n        requirements: requirements.txt\r\n        virtualenv: venv\r\n        virtualenv_command: python3 -m venv venv\r\n```\r\n\r\n(arbitrary repository reproducing the issue)\r\n\r\n### Expected Results\r\n\r\nAnsible creates `checkout-dir/venv` containing a virtual environment with packages from `checkout-dir/requirements-dev.txt`.\r\n\r\n### Actual Results\r\n\r\nAnsible creates virtual environments at both `checkout-dir/venv` and `checkout-dir/checkout-dir/venv`, but only the latter contains packages from `requirements.txt`.\r\n\r\n```console\r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"cmd\": [\r\n        \"checkout-dir/venv/bin/pip3\",\r\n        \"install\",\r\n        \"-r\",\r\n        \"requirements.txt\"\r\n    ],\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"chdir\": \"checkout-dir\",\r\n            \"editable\": false,\r\n            \"executable\": null,\r\n            \"extra_args\": null,\r\n            \"name\": null,\r\n            \"requirements\": \"requirements.txt\",\r\n            \"state\": \"present\",\r\n            \"umask\": null,\r\n            \"version\": null,\r\n            \"virtualenv\": \"venv\",\r\n            \"virtualenv_command\": \"python3 -m venv venv\",\r\n            \"virtualenv_python\": null,\r\n            \"virtualenv_site_packages\": false\r\n        }\r\n    },\r\n    \"name\": null,\r\n    \"requirements\": \"requirements.txt\",\r\n    \"state\": \"present\",\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"Collecting click (from -r requirements.txt (line 1))\\n  Using cached https://files.pythonhosted.org/packages/4a/a8/0b2ced25639fb20cc1c9784de90a8c25f9504a7f18cd8b5397bd61696d7d/click-8.0.4-py3-none-any.whl\\nCollecting importlib-metadata; python_version < \\\"3.8\\\" (from click->-r requirements.txt (line 1))\\n  Using cached https://files.pythonhosted.org/packages/a0/a1/b153a0a4caf7a7e3f15c2cd56c7702e2cf3d89b1b359d1f1c5e59d68f4ce/importlib_metadata-4.8.3-py3-none-any.whl\\nCollecting zipp>=0.5 (from importlib-metadata; python_version < \\\"3.8\\\"->click->-r requirements.txt (line 1))\\n  Using cached https://files.pythonhosted.org/packages/bd/df/d4a4974a3e3957fd1c1fa3082366d7fff6e428ddb55f074bf64876f8e8ad/zipp-3.6.0-py3-none-any.whl\\nCollecting typing-extensions>=3.6.4; python_version < \\\"3.8\\\" (from importlib-metadata; python_version < \\\"3.8\\\"->click->-r requirements.txt (line 1))\\n  Using cached https://files.pythonhosted.org/packages/45/6b/44f7f8f1e110027cf88956b59f2fad776cca7e1704396d043f89effd3a0e/typing_extensions-4.1.1-py3-none-any.whl\\nInstalling collected packages: zipp, typing-extensions, importlib-metadata, click\\nSuccessfully installed click-8.0.4 importlib-metadata-4.8.3 typing-extensions-4.1.1 zipp-3.6.0\\n\",\r\n    \"stdout_lines\": [\r\n        \"Collecting click (from -r requirements.txt (line 1))\",\r\n        \"  Using cached https://files.pythonhosted.org/packages/4a/a8/0b2ced25639fb20cc1c9784de90a8c25f9504a7f18cd8b5397bd61696d7d/click-8.0.4-py3-none-any.whl\",\r\n        \"Collecting importlib-metadata; python_version < \\\"3.8\\\" (from click->-r requirements.txt (line 1))\",\r\n        \"  Using cached https://files.pythonhosted.org/packages/a0/a1/b153a0a4caf7a7e3f15c2cd56c7702e2cf3d89b1b359d1f1c5e59d68f4ce/importlib_metadata-4.8.3-py3-none-any.whl\",\r\n        \"Collecting zipp>=0.5 (from importlib-metadata; python_version < \\\"3.8\\\"->click->-r requirements.txt (line 1))\",\r\n        \"  Using cached https://files.pythonhosted.org/packages/bd/df/d4a4974a3e3957fd1c1fa3082366d7fff6e428ddb55f074bf64876f8e8ad/zipp-3.6.0-py3-none-any.whl\",\r\n        \"Collecting typing-extensions>=3.6.4; python_version < \\\"3.8\\\" (from importlib-metadata; python_version < \\\"3.8\\\"->click->-r requirements.txt (line 1))\",\r\n        \"  Using cached https://files.pythonhosted.org/packages/45/6b/44f7f8f1e110027cf88956b59f2fad776cca7e1704396d043f89effd3a0e/typing_extensions-4.1.1-py3-none-any.whl\",\r\n        \"Installing collected packages: zipp, typing-extensions, importlib-metadata, click\",\r\n        \"Successfully installed click-8.0.4 importlib-metadata-4.8.3 typing-extensions-4.1.1 zipp-3.6.0\"\r\n    ],\r\n    \"version\": null,\r\n    \"virtualenv\": \"checkout-dir/venv\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-08-16T07:21:17Z",
        "user": "xeals",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81501,
        "title": "deprecate or extend documentation for AGNOSTIC_BECOME_PROMPT (temp workaround from #34761)",
        "body": "### Summary\n\nI just stumbled across the setting for agnostic become prompts, which was introduced in #34761 as a temporary workaround to avoid breaking ansible tower in 2.5 until 2.6/2.7.\r\n\r\nIts documentation is very confusing and it also has probably outlived its usefulness anyway. Therefore I'd like to suggest deprecating/removing it or updating the documentation to explain why exactly it exists. The current wording is very confusing to people that do not know about ansibles console output from before 2.5.\r\n\r\nCurrently, the description is:\r\n> Display an agnostic become prompt instead of displaying a prompt containing the command line supplied become method\r\n\r\nA better description is probably:\r\n> When set to TRUE, any become password prompt asking for user input will start with \"BECOME\" instead of the used become_method in uppercase. This allows for a become method-agnostic password prompt and thereby allows 3rd party utilizers to be become_method agnostic and provide a simplified way of identifying the need for entering a password.\r\n> NOTE: A special case for the prompt exists if also DEFAULT_ASK_PASS is TRUE. In that case the prompt will also include the string `[defaults to SSH password]` to indicate that the same password as for the SSH transport will be used by default. And it will be asked after an additional prompt for the SSH transport password.\r\n\r\nAlso, a final note if we do NOT end up deprecating this option, we probably should change the word \"SSH\" to \"Transport\" in [ask_passwords()](https://github.com/sivel/ansible/blob/devel/lib/ansible/cli/__init__.py#L336) for the same reason the prompt was changed to a generic BECOME in the first place.\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\nlib/ansible/cli/__init__.py\n\n### Ansible Version\n\n```console\n2.5 and up\n```\n\n\n### Configuration\n\n```console\nAGNOSTIC_BECOME_PROMPT\n```\n\n\n### OS / Environment\n\nany\n\n### Additional Information\n\n/cc @sivel \r\nrelates to: #34761\r\n\r\n/cc @bcoca \r\nrelates to: #33789\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-08-13T10:42:00Z",
        "user": "agowa",
        "labels": [
            "easyfix",
            "has_pr",
            "P3"
        ]
    },
    {
        "number": 81350,
        "title": "ERROR! Unexpected Exception, this is probably a bug: Cannot call rmtree on a symbolic link",
        "body": "### Summary\r\n\r\nCannot run make docker-compose to spin up devel environment if a symlink exists. This can be fixed by manually removing the symlink, but it is not a desirable work flow.\r\n\r\nSet up:\r\n\r\nHave an existing symlink (run `make symlink`)\r\nRun `make docker-compose` \r\nThe environment will not spin up successfully. Instead, you will see the following error:\r\n\r\n```\r\nTraceback:\r\nTraceback (most recent call last): File \"/home/alancoding/repos/ansible/lib/ansible/cli/__init__.py\", line 659, in cli_executor exit_code = cli.run() ^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 736, in run return context.CLIARGS['func']() ^^^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 118, in method_wrapper return wrapped_method(*args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 1390, in execute_install self._execute_install_collection( File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 1439, in _execute_install_collection install_collections( File \"/home/alancoding/repos/ansible/lib/ansible/galaxy/collection/__init__.py\", line 771, in install_collections install(concrete_coll_pin, output_path, artifacts_manager) File \"/home/alancoding/repos/ansible/lib/ansible/galaxy/collection/__init__.py\", line 1493, in install shutil.rmtree(b_collection_path) File \"/usr/lib64/python3.11/shutil.py\", line 744, in rmtree onerror(os.path.islink, path, sys.exc_info()) File \"/usr/lib64/python3.11/shutil.py\", line 742, in rmtree raise OSError(\"Cannot call rmtree on a symbolic link\") OSError: Cannot call rmtree on a symbolic link\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nsymlink\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.2]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOWS(env: ANSIBLE_NOCOWS) = True\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = /usr/bin/nano\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 37\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\nHave an existing symlink (run `make symlink`)\r\nRun `make docker-compose` \r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nSuccessfully spin up devel environment via docker-compose\r\n\r\n### Actual Results\r\n\r\n```console\r\nTraceback (most recent call last): File \"/home/alancoding/repos/ansible/lib/ansible/cli/__init__.py\", line 659, in cli_executor exit_code = cli.run() ^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 736, in run return context.CLIARGS['func']() ^^^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 118, in method_wrapper return wrapped_method(*args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 1390, in execute_install self._execute_install_collection( File \"/home/alancoding/repos/ansible/lib/ansible/cli/galaxy.py\", line 1439, in _execute_install_collection install_collections( File \"/home/alancoding/repos/ansible/lib/ansible/galaxy/collection/__init__.py\", line 771, in install_collections install(concrete_coll_pin, output_path, artifacts_manager) File \"/home/alancoding/repos/ansible/lib/ansible/galaxy/collection/__init__.py\", line 1493, in install shutil.rmtree(b_collection_path) File \"/usr/lib64/python3.11/shutil.py\", line 744, in rmtree onerror(os.path.islink, path, sys.exc_info()) File \"/usr/lib64/python3.11/shutil.py\", line 742, in rmtree raise OSError(\"Cannot call rmtree on a symbolic link\") OSError: Cannot call rmtree on a symbolic link\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-26T20:07:14Z",
        "user": "djyasin",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 81328,
        "title": "`old_style_cache_plugins` integration tests should not use redis",
        "body": "### Summary\n\nThe `old_style_cache_plugins` integration tests currently always build redis from source and test against a real plugin, which is very slow and flaky. We should be able to achieve equal or superior coverage and vastly increase the speed of the tests by writing a surrogate cache plugin that's backed by disk, Python data structures, or some other mechanism much lighter-weight than redis.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nold_style_cache_plugins integration tests\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\n2.16 devel\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nNA\n```\n\n\n### OS / Environment\n\nNA\n\n### Steps to Reproduce\n\nansible-test integration old_style_cache_plugins --docker ubuntu2204 -vvv\n\n### Expected Results\n\nSlow test run due to inline build of latest redis\n\n### Actual Results\n\n```console\nFast test run with minimal-to-no external deps\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-21T18:41:40Z",
        "user": "nitzmahone",
        "labels": [
            "bug"
        ]
    },
    {
        "number": 81292,
        "title": "Recursive copy with remote_src changes parent directory permissions",
        "body": "### Summary\r\n\r\nWhen `copy` module is run with `remote_src: true` the behavior of how permissions are set  using `mode/directory_mode` is different than when run without.\r\nThis has been mentioned couple of times but I didnt find any bug report that had been followed up on.\r\n\r\nFor example here, it is commented here that \"this seems wrong\" but not followed up.\r\nhttps://github.com/ansible/ansible/issues/61187#issuecomment-717564979\r\n\r\nI'm using RHEL8.8, AAP 2.4, Execution Env based on ansible 2.15.0 with Python 3.9.16\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncopy module\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /runner/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.16 (main, May 31 2023, 12:21:58) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nbash-4.4$\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL8.8\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Copy files\r\n  ansible.builtin.copy:\r\n    src: /tmp/etc/\r\n    dest: /usr/local/etc\r\n    mode: \"0644\"\r\n    directory_mode: \"0755\"\r\n    remote_src: true\r\n    owner: root\r\n    group: root\r\n```\r\nThe top-level `/usr/local/etc` directory on the remote server gets changed from 755 to 644 (along with all the files which is expected)\r\n\r\nWhen running the exact same task **but without** `remote_src: true`\r\n```yaml (paste below)\r\n- name: Copy files\r\n  ansible.builtin.copy:\r\n    src: /tmp/etc/\r\n    dest: /usr/local/etc\r\n    mode: \"0644\"\r\n    directory_mode: \"0755\"\r\n    owner: root\r\n    group: root\r\n```\r\n\r\nThe top-level `/usr/local/etc` directory on the remote server does not get touched at all.\r\n\r\n### Expected Results\r\n\r\n The top-level directory should not get its permissions changed when used with remote_src= true\r\n \r\n The behaviour of setting the permissions should be the same whether the `remote_src` is set to `true` or `false`\r\n\r\n### Actual Results\r\n\r\n```console\r\nThe top-level directory permissions get changed when used with remote_src= true\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-18T08:56:41Z",
        "user": "wally007",
        "labels": [
            "module",
            "bug",
            "P3",
            "verified",
            "affects_2.15",
            "jira"
        ]
    },
    {
        "number": 81277,
        "title": "psrp plugin bug with script module using chdir argument",
        "body": "### Summary\r\n\r\nWhen using the ansible script module with the psrp connection plugin, the argument chdir causes the powershell command to fail.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npsrp.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /bin/ansible\r\n  python version = 3.6.8 (default, May 31 2023, 10:28:59) [GCC 8.5.0 20210514 (Red Hat 8.5.0-18)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['/data-00/files/snow365_inventory/ansible/snow365_cmdb_inv_FINAL.yaml']\r\nDEFAULT_LOCAL_TMP(/etc/ansible/ansible.cfg) = /data-00/tmp/ansible/tmp/ansible-local-5996626wnwld91\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAnsible controller: RHEL 8\r\n\r\nRemote host: Windows server 2019\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n---\r\n- hosts: all\r\n\r\n  tasks:\r\n  \r\n  - name: run powershell script\r\n    script: /path/to/my/script.ps1\r\n    args:  \r\n      chdir: c:\\temp\r\n    register: script_output\r\n```\r\n\r\n### Expected Results\r\n\r\n```\r\nPLAY [windows_host] ***********************************************************\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /data-00/tmp/ansible/tmp/ansible-runner3678459533898704052playbook:2\r\nSSH password: \r\nUsing module file /usr/lib/python3.6/site-packages/ansible/modules/windows/setup.ps1\r\nPipelining is enabled.\r\n<windows_host> ESTABLISH WINRM CONNECTION FOR USER: ansible_usr on PORT 5986 TO windows_host\r\nEXEC (via pipeline wrapper)\r\nok: [windows_host]\r\nMETA: ran handlers\r\nTASK [run powershell script] ***************************************************\r\ntask path: /data-00/tmp/ansible/tmp/ansible-runner3678459533898704052playbook:6\r\n<windows_host> ESTABLISH WINRM CONNECTION FOR USER: ansible_usr on PORT 5986 TO windows_host\r\nEXEC (via pipeline wrapper)\r\n<windows_host> PUT \"/path/to/my/script.ps1\" TO \"C:\\Users\\ansible_usr\\AppData\\Local\\Temp\\ansible-tmp-1689580769.2956958-593668-80835029695006\\script.ps1\"\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nchanged: [windows_host] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"FIREWALL_STATUS=True\\r\\n\",\r\n    \"stdout_lines\": [\r\n        \"FIREWALL_STATUS=True\"\r\n    ]\r\n}\r\nTASK [debug] *******************************************************************\r\ntask path: /data-00/tmp/ansible/tmp/ansible-runner3678459533898704052playbook:12\r\nok: [windows_host] => {\r\n    \"script_output\": {\r\n        \"changed\": true,\r\n        \"failed\": false,\r\n        \"rc\": 0,\r\n        \"stderr\": \"\",\r\n        \"stderr_lines\": [],\r\n        \"stdout\": \"FIREWALL_STATUS=True\\r\\n\",\r\n        \"stdout_lines\": [\r\n            \"FIREWALL_STATUS=True\"\r\n        ]\r\n    }\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\nPLAY RECAP *********************************************************************\r\nwindows_host              : ok=3    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [run powershell script] ***************************************************\r\ntask path: /data-00/tmp/ansible/tmp/ansible-runner4814726683080032643playbook:6\r\n<windows_host> ESTABLISH PSRP CONNECTION FOR USER: ansible_usr ON PORT 5986 TO windows_host\r\n<windows_host> PSRP: EXEC Set-StrictMode -Version Latest\r\n$tmp_path = [System.Environment]::ExpandEnvironmentVariables('%TEMP%')\r\n$tmp = New-Item -Type Directory -Path $tmp_path -Name 'ansible-tmp-1689579868.5769358-590491-49138637988427'\r\nWrite-Output -InputObject $tmp.FullName\r\nIf (-not $?) { If (Get-Variable LASTEXITCODE -ErrorAction SilentlyContinue) { exit $LASTEXITCODE } Else { exit 1 } }\r\n<windows_host> PUT /path/to/my/script.ps1 TO C:\\Users\\ansible_usr\\AppData\\Local\\Temp\\ansible-tmp-1689579868.5769358-590491-49138637988427\\script.ps1\r\n<windows_host> PSRP: EXEC cd c:\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Unrestricted -EncodedCommand JgBjAGgAYwBwAC4AYwBvAG0AIAA2ADUAMAAwADEAIAA+ACAAJABuAHUAbABsAAoAJABlAHgAZQBjAF8AdwByAGEAcABwAGUAcgBfAHMAdAByACAAPQAgACQAaQBuAHAAdQB0ACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcACgAkAHMAcABsAGkAdABfAHAAYQByAHQAcwAgAD0AIAAkAGUAeABlAGMAXwB3AHIAYQBwAHAAZQByAF8AcwB0AHIALgBTAHAAbABpAHQAKABAACgAIgBgADAAYAAwAGAAMABgADAAIgApACwAIAAyACwAIABbAFMAdAByAGkAbgBnAFMAcABsAGkAdABPAHAAdABpAG8AbgBzAF0AOgA6AFIAZQBtAG8AdgBlAEUAbQBwAHQAeQBFAG4AdAByAGkAZQBzACkACgBJAGYAIAAoAC0AbgBvAHQAIAAkAHMAcABsAGkAdABfAHAAYQByAHQAcwAuAEwAZQBuAGcAdABoACAALQBlAHEAIAAyACkAIAB7ACAAdABoAHIAbwB3ACAAIgBpAG4AdgBhAGwAaQBkACAAcABhAHkAbABvAGEAZAAiACAAfQAKAFMAZQB0AC0AVgBhAHIAaQBhAGIAbABlACAALQBOAGEAbQBlACAAagBzAG8AbgBfAHIAYQB3ACAALQBWAGEAbAB1AGUAIAAkAHMAcABsAGkAdABfAHAAYQByAHQAcwBbADEAXQAKACQAZQB4AGUAYwBfAHcAcgBhAHAAcABlAHIAIAA9ACAAWwBTAGMAcgBpAHAAdABCAGwAbwBjAGsAXQA6ADoAQwByAGUAYQB0AGUAKAAkAHMAcABsAGkAdABfAHAAYQByAHQAcwBbADAAXQApAAoAJgAkAGUAeABlAGMAXwB3AHIAYQBwAHAAZQByAA==\r\nexit $LASTEXITCODE\r\n<windows_host> PSRP: EXEC Set-StrictMode -Version Latest\r\nRemove-Item 'C:\\Users\\ansible_usr\\AppData\\Local\\Temp\\ansible-tmp-1689579868.5769358-590491-49138637988427\\.' -Force -Recurse;\r\nIf (-not $?) { If (Get-Variable LASTEXITCODE -ErrorAction SilentlyContinue) { exit $LASTEXITCODE } Else { exit 1 } }\r\nfatal: [windows_host]: FAILED! => {\r\n    \"changed\": true,\r\n    \"msg\": \"non-zero return code\",\r\n    \"rc\": 1,\r\n    \"stderr\": \"powershell.exe : invalid payload\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (invalid payload\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe : At line:4 char:39\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (At line:4 char:39\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe : + If (-not $split_parts.Length -eq 2) { throw \\\"invalid payload\\\" }\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (+ If (-not $spl...id payload\\\" }\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe : +                                       ~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (+              ...~~~~~~~~~~~~~\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe :     + CategoryInfo          : OperationStopped: (invalid payload:String) [], RuntimeException\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (    + CategoryI...timeException\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe :     + FullyQualifiedErrorId : invalid payload\\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: (    + FullyQual...valid payload\\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\\r\\npowershell.exe :  \\r\\n\\r\\nAt line:1 char:14\\r\\n+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\\r\\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n    + CategoryInfo          : NotSpecified: ( \\r\\n:String) [], RemoteException\\r\\n    + FullyQualifiedErrorId : NativeCommandError\\r\\nStackTrace:\\r\\nat <ScriptBlock>, <No file>: line 1\",\r\n    \"stderr_lines\": [\r\n        \"powershell.exe : invalid payload\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (invalid payload\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe : At line:4 char:39\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (At line:4 char:39\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe : + If (-not $split_parts.Length -eq 2) { throw \\\"invalid payload\\\" }\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (+ If (-not $spl...id payload\\\" }\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe : +                                       ~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (+              ...~~~~~~~~~~~~~\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe :     + CategoryInfo          : OperationStopped: (invalid payload:String) [], RuntimeException\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (    + CategoryI...timeException\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe :     + FullyQualifiedErrorId : invalid payload\",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: (    + FullyQual...valid payload\",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\",\r\n        \"powershell.exe :  \",\r\n        \"\",\r\n        \"At line:1 char:14\",\r\n        \"+ ... d c:\\\\temp ; PowerShell -NoProfile -NonInteractive -ExecutionPolicy Un ...\",\r\n        \"+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\",\r\n        \"    + CategoryInfo          : NotSpecified: ( \",\r\n        \":String) [], RemoteException\",\r\n        \"    + FullyQualifiedErrorId : NativeCommandError\",\r\n        \"StackTrace:\",\r\n        \"at <ScriptBlock>, <No file>: line 1\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\nPLAY RECAP *********************************************************************\r\nwindows_host              : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-17T08:44:55Z",
        "user": "simon-c-msc",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.9"
        ]
    },
    {
        "number": 81259,
        "title": "apt_repository module breaks with strange UnicodeDecodeError",
        "body": "### Summary\r\n\r\nI think this problem could be the same as https://github.com/ansible/ansible/issues/79523 but for the module apt_repository\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/modules/apt_repository.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\nbash-5.1$ ansible --version\r\nansible [core 2.15.1]\r\n  config file = None\r\n  configured module search path = ['/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /runner/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.11.2 (main, May 24 2023, 00:00:00) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)] (/usr/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 9 (ubi)\r\n\r\nRemote host:\r\nOS: Ubuntu 22.04 LTS\r\nPython: 3.10\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- name: Add Vscode repository\r\n  become: true\r\n  ansible.builtin.apt_repository:\r\n    repo: \"deb [arch=amd64 signed-by=/etc/apt/keyrings/microsoft.asc] https://packages.microsoft.com/repos/vscode stable main\"\r\n    state: present\r\n    filename: vscode\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect that the Microsoft VScode repository will be added.\r\n\r\n### Actual Results\r\n\r\n```console\r\n{\r\n  \"module_stdout\": \"UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 3: invalid continuation byte\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nSystemError: <class 'UnicodeDecodeError'> returned a result with an exception set\\r\\n\\r\\nThe above exception was the direct cause of the following exception:\\r\\n\\r\\nTraceback (most recent call last):\\r\\n  File \\\"/opt/local_users/ansible/.ansible/tmp/ansible-tmp-1689323618.630589-41-38337135334436/AnsiballZ_apt_repository.py\\\", line 107, in <module>\\r\\n    _ansiballz_main()\\r\\n  File \\\"/opt/local_users/ansible/.ansible/tmp/ansible-tmp-1689323618.630589-41-38337135334436/AnsiballZ_apt_repository.py\\\", line 99, in _ansiballz_main\\r\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\r\\n  File \\\"/opt/local_users/ansible/.ansible/tmp/ansible-tmp-1689323618.630589-41-38337135334436/AnsiballZ_apt_repository.py\\\", line 47, in invoke_module\\r\\n    runpy.run_module(mod_name='ansible.modules.apt_repository', init_globals=dict(_module_fqn='ansible.modules.apt_repository', _modlib_path=modlib_path),\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 224, in run_module\\r\\n    return _run_module_code(code, init_globals, run_name, mod_spec)\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 96, in _run_module_code\\r\\n    _run_code(code, mod_globals, init_globals,\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 86, in _run_code\\r\\n    exec(code, run_globals)\\r\\n  File \\\"/tmp/ansible_ansible.builtin.apt_repository_payload_lkwi0eiu/ansible_ansible.builtin.apt_repository_payload.zip/ansible/modules/apt_repository.py\\\", line 763, in <module>\\r\\n  File \\\"/tmp/ansible_ansible.builtin.apt_repository_payload_lkwi0eiu/ansible_ansible.builtin.apt_repository_payload.zip/ansible/modules/apt_repository.py\\\", line 740, in main\\r\\n  File \\\"/usr/lib/python3/dist-packages/apt/cache.py\\\", line 152, in __init__\\r\\n    self.open(progress)\\r\\n  File \\\"/usr/lib/python3/dist-packages/apt/cache.py\\\", line 214, in open\\r\\n    self._cache = apt_pkg.Cache(progress)\\r\\nSystemError: <class 'apt_pkg.Cache'> returned a result with an exception set\\r\\n\",\r\n  \"module_stderr\": \"Shared connection to demulvdi7006 closed.\\r\\n\",\r\n  \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n  \"rc\": 1,\r\n  \"_ansible_no_log\": null,\r\n  \"changed\": false\r\n}\r\n\r\nMoreover the VScode repository will be added and is located in /etc/apt/sources.list.d/vscode.list\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-14T08:42:40Z",
        "user": "manuel-hiller-ebm",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81239,
        "title": "Running service_facts stops Graphites carbon-cache",
        "body": "### Summary\r\n\r\nI experienced the problem, that a run of service_facts stops carbon-cache reproducable. I was wondering why the service was stopped after a rollout and so I looked at the logs, where I found this:\r\n\r\n```\r\nJul 11 13:35:36 szvgraphite python3[2897927]: ansible-ansible.legacy.setup Invoked with gather_subset=['all'] gather_timeout=10 filter=[] fact_path=/etc/ansible/facts.d\r\nJul 11 13:35:45 szvgraphite python3[2898022]: ansible-service_facts Invoked\r\nJul 11 13:35:46 szvgraphite systemd[1]: Stopping Graphite Carbon Cache...\r\nJul 11 13:35:47 szvgraphite systemd[1]: carbon-cache.service: Succeeded.\r\nJul 11 13:35:47 szvgraphite systemd[1]: Stopped Graphite Carbon Cache.\r\n```\r\n\r\nI retried the service_facts run twice and in both cases carbon-cache was stopped directly after the invokement. I have no clue if the problem occurs, because carbon-cache is also a python3 process.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nservice_facts\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.1]\r\n  config file = None\r\n  configured module search path = ['/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /runner/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.16 (main, Mar  7 2023, 00:00:00) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAnsible is running as part of AWX installed with awx-operator 2.2.1.\r\n\r\nThe target host is a Ubuntu 20.04.5 LTS host.\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n---\r\n- hosts: all\r\n  become: true\r\n  become_method: sudo\r\n\r\n  tasks:\r\n    - name: gather service facts\r\n      service_facts:\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nNo services should be stopped accidently when invoking service_facts.\r\n\r\n### Actual Results\r\n\r\n```console\r\nProcess /usr/bin/python3 /usr/bin/carbon-cache will be stopped when invoking service_facts.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-12T10:54:10Z",
        "user": "chgarling",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81168,
        "title": "Inconsistent use of DataLoader in plugins",
        "body": "### Summary\r\n\r\nAt: https://docs.ansible.com/ansible/latest/dev_guide/developing_plugins.html#developing-plugins\r\n\r\nThe DataLoader is used through `self._loader` in one location and as a `loader` parameter to a vars plugin.\r\n\r\nIf the underscore means that it's not part of the public API, why have it in an example? And if it is meant for use, why have the underscore prefix?\r\n\r\nPersonally, I think it would be very useful if all plugins could use the DataLoader in an officially supported manner. Therefore I suggest always providing it in the instance and using it with self.loader everywhere.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nNA\r\n\r\n### Ansible Version\r\n\r\n```console\r\nNA\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nNA\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nNA\r\n\r\n### Steps to Reproduce\r\n\r\nNA\r\n\r\n### Expected Results\r\n\r\nNA\r\n\r\n### Actual Results\r\n\r\n```console\r\nNA\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-07-02T16:00:19Z",
        "user": "tnek213",
        "labels": [
            "bug",
            "data_tagging",
            "affects_2.18"
        ]
    },
    {
        "number": 81155,
        "title": "\"pause\" module should flush Ansible's standard streams if \"prompt\" argument is supplied",
        "body": "### Summary\r\n\r\nFor logging purposes, I have a wrapper shell script in my `/usr/local/bin` directory which invokes Ansible commands (`ansible`, `ansible-playbook` and `ansible-console`) passing `ANSIBLE_FORCE_COLOR=1` environment variable and pipes their standard output and error streams to [ansi2html](https://pypi.org/project/ansi2html/) executable using [tee](https://www.gnu.org/software/coreutils/manual/html_node/tee-invocation.html) and [process substitution](https://www.gnu.org/software/bash/manual/html_node/Process-Substitution.html).\r\n\r\n```\r\n# /usr/local/bin/logansible\r\nme=\"`basename \\\"${0}\\\"`\"\r\nlogFile=\"/tmp/${me:3}-${$}.html\"\r\nexport ANSIBLE_FORCE_COLOR=1\r\n\"${me:3}\" \"${@}\" 2>&1 | stdbuf -o0 -e0 tee --ignore-interrupts >(ansi2html > \"${logFile}\" ; cat)\r\nexit \"${PIPESTATUS[0]}\"\r\n```\r\n\r\n_My actual wrapper is bigger and more complex than that. The real wrapper invokes `tee` 3 times, reads the log path from command line arguments and generates log files in HTML format, in plain text format and in the original format that does not strip ANSI color codes._\r\n\r\nUnder recent versions of Ansible or Python, if the `pause` module is invoked to request user input and Ansible's stdout is being piped to `tee`, the prompt message supplied via the `prompt` argument is only presented **after** user input is supplied. Such behavior prevents the user from seeing what input is actually being requested from them. The `pause` module should flush Ansible's standard streams before requesting user input.\r\n\r\nIf Ansible's stdout is directly connected to the terminal, then the prompt message is presented before the user input is supplied, as expected.\r\n\r\nExporting `PYTHONUNBUFFERED=1` environment variable to Ansible commands also works. Because of that, this bug may be related to #79662.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npause\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.15.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/amg1127/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/amg1127/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.3 (main, Jun  5 2023, 09:32:32) [GCC 13.1.1 20230429] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['profile_tasks']\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\nEDITOR(env: EDITOR) = vim\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAnsible controller: Arch Linux\r\n\r\n### Steps to Reproduce\r\n\r\nFrom an ordinary shell, run the below command line:\r\n\r\n```console\r\n$ ansible localhost -m pause -a 'prompt=\"Type the first letter of the alphabet\"' | cat -u\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nBefore requesting user input, the `pause` module should output the prompt message supplied via the `prompt` argument.\r\n\r\n```console\r\n$ ansible localhost -m pause -a 'prompt=\"Type the first letter of the alphabet\"' | cat -u\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[pause]\r\nType the first letter of the alphabet:\r\n```\r\n\r\n### Actual Results\r\n\r\nThe prompt message supplied via the `prompt` argument is suppressed.\r\n\r\n```console\r\n$ ansible localhost -m pause -a 'prompt=\"Type the first letter of the alphabet\"' | cat -u\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n```\r\n\r\nWith PYTHONUNBUFFERED=1 environment variable exported to Ansible, the expected result is presented.\r\n\r\n```console\r\n$ PYTHONUNBUFFERED=1 ansible localhost -m pause -a 'prompt=\"Type the first letter of the alphabet\"' | cat -u\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[pause]\r\nType the first letter of the alphabet:\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-29T17:33:04Z",
        "user": "amg1127",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81154,
        "title": "Ansible apt module unable to remove packages not in `CURSTATE_INSTALLED`",
        "body": "### Summary\r\n\r\nThe apt module never attempts to remove packages that are in a state other than `CURSTATE_INSTALLED` according to `apt_pkg`. This means that packages in any of `CURSTATE_UNPACKED`, `CURSTATE_HALF_CONFIGURED`, `CURSTATE_HALF_INSTALLED`, or `CURSTATE_CONFIG_FILES` cannot be removed using the ansible apt module. \r\n\r\nAll possible states can be seen [here](https://salsa.debian.org/apt-team/python-apt/-/blob/main/python/apt_pkgmodule.cc#L1082), and the state check can be seen [here](https://github.com/ansible/ansible/blob/0cc50e067346c357c5177677fba41993950ff044/lib/ansible/modules/apt.py#L562). \r\n\r\nThis was an issue for us as we had a package with a bad post install script that left the package in `CURSTATE_HALF_CONFIGURED` and were then unable to remove that package with ansible, and were forced to directly invoke `apt remove` via the ansible `command` module.\r\n\r\nIt may be unexpected behavior by ansible to remove packages in these other states, but at least having a configuration option so that it is possible to remove them would be greatly beneficial.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Additional Information\r\n\r\nAdding a configuration option to the `apt` module to allow removal of packages in these other states would allow packages that were badly installed to be removed by the ansible `apt` module. Currently, we have to update our playbook to use the ansible `command` module to directly run `apt remove` on this package in order to cover the case where the package is badly installed. It would be much better if we could natively use the `apt` module to accomplish this.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-29T14:55:22Z",
        "user": "ZachOldham",
        "labels": [
            "module",
            "feature",
            "P3",
            "verified",
            "affects_2.16"
        ]
    },
    {
        "number": 81153,
        "title": "Allow reload of collection during play",
        "body": "### Summary\n\nFrom what I understood, the collections are loaded at the beginning of a playbook run and can't be reloaded (or refreshed like the inventory for exemple) during the play.\r\n\r\nWe ran into the case where we wanted to have a single playbook that would both install the collections and run collection playbooks/roles. We wanted to ease the process by having an umbrella playbook and not having to first run a playbook that would set the environment (install collections) and then run a second playbook that would use the collection roles.\r\n\r\nThis \"umbrella\" playbook would:\r\n\r\n1. run a pre_task to install collections with '**community.general.ansible_galaxy_install**' module\r\n2. run tasks '**include_role**' to include collection roles that were installed in step 1\r\n\r\n```yaml \r\n---\r\n- name: Install galaxy and import PDP playbook\r\n  hosts: localhost\r\n  gather_facts: false\r\n\r\n  pre_tasks:\r\n    - name: Install collection(s)\r\n      community.general.ansible_galaxy_install:\r\n        type: collection\r\n        requirements_file: requirements.yml\r\n        dest: \"{{ playbook_dir }}/collections\"\r\n\r\n  tasks:\r\n    #will not work because collection role was not installed at the beginning of the play\r\n    - name: Include role from collection\r\n      ansible.builtin.include_role:\r\n        name: my_namespace.my_collection.my_role\r\n```\r\n\r\n \r\n\r\nIt does not work because Ansible will not find the collection role(s) that were installed in the same play as collections are loaded  at the very begining of the playbook and never refreshed during the play.\r\n\r\nThe workaround is to first run the \"install_collection.yml\" playbook and then independently run \"run_collection_roles.yml\" playbook (we can't use \"playbook_import\" to embed the second playbook because the imported playbook still runs in the root playbook context and does not reload collections either).\r\n\r\nThere is the module '**ansible.builtin.meta**' that has a '**refresh_inventory**' to reload the inventory during the run, we could for example imagine an option '**refresh_collections**' the same way?\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncollection\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- name: Install galaxy and import PDP playbook\r\n  hosts: localhost\r\n  gather_facts: false\r\n\r\n  pre_tasks:\r\n    - name: Install collection(s)\r\n      community.general.ansible_galaxy_install:\r\n        type: collection\r\n        requirements_file: requirements.yml\r\n        dest: \"{{ playbook_dir }}/collections\"\r\n    - name: refresh collection\r\n      ansible.builtin.meta: refresh_collections\r\n  \r\n\r\n  tasks:\r\n    - name: Include role from collection\r\n      ansible.builtin.include_role:\r\n        name: my_namespace.my_collection.my_role\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-29T12:42:27Z",
        "user": "larkoie",
        "labels": [
            "test",
            "feature",
            "affects_2.16"
        ]
    },
    {
        "number": 81126,
        "title": "ansible.builtin.copy has unexpected behaviour when copying recursively with remote_src: true",
        "body": "### Summary\n\n*When I copy some files recursively around the remote file system, I want the behaviour to match the documentation, and give me control over file modes.*\r\n\r\nIn the following, I'm specifically talking about the case where `remote_src: true`, and none of the destination files exist yet.\r\n\r\nWhen copying single files, ansible.builtin.copy sets file permissions based on the `mode` that has been set in the config, which may in turn use the default umask. The source mode is ignored, unless `mode: preserve` is set. This gives plenty of control to the ansible script.\r\n\r\nWhen copying files recursively, I would expect the behaviour to be the same, with the exception that directories would take their permissions from `directory_mode` instead of `directory`. As far as I can tell, this is what the [documentation](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html) suggests should happen.\r\n\r\nWhat happens in practice is that the permissions of the source files are always copied, with the exception of enclosing directories: The root directory, if copied (no trailing slash on source) seems to get the system default if the destination has no trailing slash, and `mode` otherwise. `mode` seems to be used for creating enclosing directories, unless the source has no trailing slash and the destination has a trailing slash, in which case `directory_mode` is used.\r\n\r\nThis doesn't seem to match the documentation, or have an obvious logic to it. It also means I can't set the file permissions to a desired value from my ansible script during the copy, unlike with single files.\r\n\r\nMy suggestion is that the documentation just explicitly say that for local recursive copies permissions are preserved, and tidy up how modes are set on the enclosing directories that are created (use `directory_mode`?), and generally improve the documentation around this area.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.copy\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.15.0]\r\n  config file = None\r\n  configured module search path = ['/Users/sgf/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/Cellar/ansible/8.0.0/libexec/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /Users/sgf/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.11.4 (main, Jun 15 2023, 07:52:47) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/Cellar/ansible/8.0.0/libexec/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\r\nEDITOR(env: EDITOR) = emacs\r\nPAGER(env: PAGER) = less\n```\n\n\n### OS / Environment\n\nHost:\r\n```\r\n$ uname -a\r\nDarwin wellington.local 21.6.0 Darwin Kernel Version 21.6.0: Mon Aug 22 20:20:05 PDT 2022; root:xnu-8020.140.49~2/RELEASE_ARM64_T8101 arm64\r\n```\r\n\r\nTarget is a vagrant-based VM: \r\n```\r\nuname -a\r\nLinux controller 5.10.0-22-cloud-arm64 #1 SMP Debian 5.10.178-3 (2023-04-22) aarch64 GNU/Linux\r\n```\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- name: Local directory copy test\r\n  hosts: controller\r\n  tasks:\r\n    - ansible.builtin.command: \"mkdir -p /tmp/test/subdir\"\r\n    - ansible.builtin.command: \"touch /tmp/test/a\"\r\n    - ansible.builtin.command: \"touch /tmp/test/subdir/b\"\r\n    - ansible.builtin.command: \"chmod u=r,g=w,o= /tmp/test/a\"\r\n    - ansible.builtin.command: \"chmod u=rx,g=wx,o=x /tmp/test/subdir/b\"\r\n    - ansible.builtin.command: \"chmod u=rx,g=r,o=x /tmp/test/subdir\"\r\n    - ansible.builtin.command: \"chmod u=rx,g=x,o=w /tmp/test\"\r\n    - name: Copy files 1/4\r\n      ansible.builtin.copy:\r\n        src: /tmp/test\r\n        dest: /tmp/no_trailing_to_no_trailing\r\n        remote_src: true\r\n        mode: u=rw,g=,o=r\r\n        directory_mode: u=rwx,g=rx,o=x\r\n    - name: Copy files 2/4\r\n      ansible.builtin.copy:\r\n        src: /tmp/test/\r\n        dest: /tmp/trailing_to_no_trailing\r\n        remote_src: true\r\n        mode: u=rw,g=,o=r\r\n        directory_mode: u=rwx,g=rx,o=x\r\n    - name: Copy files 3/4\r\n      ansible.builtin.copy:\r\n        src: /tmp/test\r\n        dest: /tmp/no_trailing_to_trailing/\r\n        remote_src: true\r\n        mode: u=rw,g=,o=r\r\n        directory_mode: u=rwx,g=rx,o=x\r\n    - name: Copy files 4/4\r\n      ansible.builtin.copy:\r\n        src: /tmp/test/\r\n        dest: /tmp/trailing_to_trailing/\r\n        remote_src: true\r\n        mode: u=rw,g=,o=r\r\n        directory_mode: u=rwx,g=rx,o=x\r\n```\r\n\n\n### Expected Results\n\nMy expectations, based on the documentation, was that all files that the result of the copy would have file permissions based on the `mode` set in the ansible script, and all directories would have their permissions based on `directory_mode`.\n\n### Actual Results\n\n```console\nvagrant@controller:/tmp$ sudo ls -lR | grep -v total\r\n.:\r\ndrw----r-- 3 vagrant vagrant 4096 Jun 26 14:18 no_trailing_to_no_trailing\r\ndrwxr-x--x 3 vagrant vagrant 4096 Jun 26 14:18 no_trailing_to_trailing\r\ndr-x--x-w- 3 vagrant vagrant 4096 Jun 26 14:18 test\r\ndrw----r-- 3 vagrant vagrant 4096 Jun 26 14:18 trailing_to_no_trailing\r\ndrw----r-- 3 vagrant vagrant 4096 Jun 26 14:18 trailing_to_trailing\r\n\r\n./no_trailing_to_no_trailing:\r\ndrwxr-xr-x 3 vagrant vagrant 4096 Jun 26 14:18 test\r\n\r\n./no_trailing_to_no_trailing/test:\r\n-r---w---- 1 vagrant vagrant    0 Jun 26 14:18 a\r\ndr-xr----x 2 vagrant vagrant 4096 Jun 26 14:18 subdir\r\n\r\n./no_trailing_to_no_trailing/test/subdir:\r\n-r-x-wx--x 1 vagrant vagrant 0 Jun 26 14:18 b\r\n\r\n./no_trailing_to_trailing:\r\ndrw----r-- 3 vagrant vagrant 4096 Jun 26 14:18 test\r\n\r\n./no_trailing_to_trailing/test:\r\n-r---w---- 1 vagrant vagrant    0 Jun 26 14:18 a\r\ndr-xr----x 2 vagrant vagrant 4096 Jun 26 14:18 subdir\r\n\r\n./no_trailing_to_trailing/test/subdir:\r\n-r-x-wx--x 1 vagrant vagrant 0 Jun 26 14:18 b\r\n\r\n./test:\r\n-r---w---- 1 vagrant vagrant    0 Jun 26 14:18 a\r\ndr-xr----x 2 vagrant vagrant 4096 Jun 26 14:18 subdir\r\n\r\n./test/subdir:\r\n-r-x-wx--x 1 vagrant vagrant 0 Jun 26 14:18 b\r\n\r\n./trailing_to_no_trailing:\r\n-r---w---- 1 vagrant vagrant    0 Jun 26 14:18 a\r\ndr-xr----x 2 vagrant vagrant 4096 Jun 26 14:18 subdir\r\n\r\n./trailing_to_no_trailing/subdir:\r\n-r-x-wx--x 1 vagrant vagrant 0 Jun 26 14:18 b\r\n\r\n./trailing_to_trailing:\r\n-r---w---- 1 vagrant vagrant    0 Jun 26 14:18 a\r\ndr-xr----x 2 vagrant vagrant 4096 Jun 26 14:18 subdir\r\n\r\n./trailing_to_trailing/subdir:\r\n-r-x-wx--x 1 vagrant vagrant 0 Jun 26 14:18 b\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-26T16:57:25Z",
        "user": "simon-frankau",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "verified",
            "affects_2.15"
        ]
    },
    {
        "number": 81115,
        "title": "\"service_facts\" module cannot report whether a service is enabled or not if it is in \"failed\" state",
        "body": "### Summary\r\n\r\nI use a playbook that handles failures and restarts a service if it is enabled on a server, and does nothing if it is disabled. To detect whether the playbook should take action on the service, it relies on the `service_facts` module.\r\n\r\n```\r\n- name: Get service facts:\r\n  service_facts:\r\n  become: yes\r\n\r\n- name: Act on the service\r\n  vars:\r\n    app_service: 'foo.service'\r\n    app_service_cache_dir: '/var/cache/foo'\r\n    app_service_user: 'foo'\r\n  when: 'ansible_facts.services[app_service].status == \"enabled\" '\r\n  block:\r\n\r\n    - name: Stop service\r\n      service:\r\n        name: \"{{ app_service }}\"\r\n        state: stopped\r\n      become: yes\r\n\r\n    - name: Clear the cache folder\r\n      file:\r\n        path: \"{{ app_service_cache_dir }}\"\r\n        state: absent\r\n      become: yes\r\n  \r\n    - name: Recreate the cache folder\r\n      file:\r\n        path: \"{{ app_service_cache_dir }}\"\r\n        state: directory\r\n        owner: \"{{ app_service_user }}\"\r\n        mode: \"0700\"\r\n      become: yes\r\n\r\n    - name: Start service\r\n      service:\r\n        name: \"{{ app_service }}\"\r\n        state: started\r\n      become: yes\r\n```\r\n\r\nThe playbook was working fine under Ansible 2.9.27, however it has stopped working under Ansible 2.14.2 if the service enters a _failed_ state in systemd (for example, in case it crashes). Under Ansible 2.14.2, the `service_facts` module sets the `status` attribute to `failed` and, as a result, it is no longer possible to figure out from existing service facts whether the playbook should act on the service or not. As a workaround, I had to manually invoke `systemctl is-enabled foo.service` with the `command` module.\r\n\r\n`git bisect` command has identified that this commit has introduced the error: [82bab063](https://github.com/ansible/ansible/commit/82bab063e7c60b77596c5c87258d5c3398b5efc2)\r\n\r\n```\r\n$ git bisect start\r\n$ git bisect bad v2.12.10\r\n$ git bisect good v2.10.0\r\n$ git bisect run ../bisect.sh\r\n82bab063e7c60b77596c5c87258d5c3398b5efc2 is the first bad commit\r\n```\r\n\r\nI may have code the playbook incorrectly. By reading the existing documentation about the `service_facts` module, I could not figure out the attribute that says whether a service is configured to start at boot time or not, nor the attribute that says whether the service is currently running or not. The definitions of `status` and `state` attributes don't seem clear.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nservice_facts\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can become unstable at any point.\r\nansible [core 2.12.0.dev0] (detached HEAD 82bab063e7) last updated 2023/06/23 23:08:39 (GMT +1300)\r\n  config file = None\r\n  configured module search path = ['/home/admin/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/admin/ansible/lib/ansible\r\n  ansible collection location = /home/admin/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/admin/ansible/bin/ansible\r\n  python version = 3.9.16 (main, Mar  7 2023, 00:00:00) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)]\r\n  jinja version = 2.11.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can become unstable at any point.\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nCentOS Stream 9\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nThis is a minimal playbook that reproduces the issue.\r\n\r\n```yaml (paste below)\r\n---\r\n# service_facts.yml\r\n- hosts: localhost\r\n  gather_facts: no\r\n  vars:\r\n    test_service: 'foo.service'\r\n  tasks:\r\n\r\n    - name: Ensure that a failed service exists\r\n      block:\r\n\r\n        - name: Verify whether a failed service exists\r\n          command:\r\n            argv:\r\n              - systemctl\r\n              - 'is-failed'\r\n              - \"{{ test_service }}\"\r\n\r\n      rescue:\r\n\r\n        - name: Install a service that fails\r\n          copy:\r\n            content: |\r\n              [Unit]\r\n              After=local-fs.target\r\n\r\n              [Service]\r\n              Type=simple\r\n              ExecStart=/bin/false\r\n\r\n              [Install]\r\n              WantedBy=multi-user.target\r\n            dest: \"/etc/systemd/system/{{ test_service }}\"\r\n          become: yes\r\n\r\n        - name: Reload systemd and start the test service\r\n          systemd:\r\n            name: \"{{ test_service }}\"\r\n            state: started\r\n            daemon_reload: yes\r\n          become: yes\r\n          ignore_errors: yes\r\n\r\n        - name: Ensure that the installed failed service exists\r\n          command:\r\n            argv:\r\n              - systemctl\r\n              - 'is-failed'\r\n              - \"{{ test_service }}\"\r\n\r\n    - name: Ensure that the failed service is disabled\r\n      systemd:\r\n        name: \"{{ test_service }}\"\r\n        enabled: no\r\n      become: yes\r\n\r\n    - name: Get service facts\r\n      service_facts:\r\n      become: yes\r\n\r\n    - name: Store facts about the failed service that is disabled\r\n      set_fact:\r\n        test_service_disabled: \"{{ ansible_facts.services[test_service] | dict2items }}\"\r\n\r\n    - name: Ensure that the failed service is enabled\r\n      systemd:\r\n        name: \"{{ test_service }}\"\r\n        enabled: yes\r\n      become: yes\r\n\r\n    - name: Get service facts again\r\n      service_facts:\r\n      become: yes\r\n\r\n    - name: Store facts about the failed service that is enabled\r\n      set_fact:\r\n        test_service_enabled: \"{{ ansible_facts.services[test_service] | dict2items }}\"\r\n\r\n    - name: Compare service details\r\n      vars:\r\n        test_service_symmetric_diff: \"{{ test_service_disabled | symmetric_difference(test_service_enabled) }}\"\r\n      assert:\r\n        that:\r\n          - '(test_service_symmetric_diff | length) > 0'\r\n        success_msg: \"service information is different: '{{ test_service_symmetric_diff | to_json }}'\"\r\n        fail_msg: \"! service information is equal !!! '{{ test_service_disabled | to_json }}'\"\r\n```\r\n\r\nThis is the script used with `git bisect`.\r\n\r\n```\r\n#!/bin/bash\r\nset -o pipefail\r\ncurdir=\"${0}\"\r\n[ -h \"${curdir}\" ] && curdir=\"`readlink -f \\\"${curdir}\\\"`\"\r\ncurdir=\"`dirname \\\"${curdir}\\\"`\"\r\n. \"${curdir}/ansible/hacking/env-setup\" -q\r\ntempfile=\"`mktemp`\"\r\n[ -f \"${tempfile}\" ] || exit 125\r\nif ansible-playbook \"${curdir}/service_facts.yml\" | tee \"${tempfile}\"; then\r\n    rm -f \"${tempfile}\"\r\n    exit 0\r\nelif tail --lines=10 \"${tempfile}\" | grep -qF '! service information is equal !!!'; then\r\n    rm -f \"${tempfile}\"\r\n    exit 1\r\nelse\r\n    rm -fv \"${tempfile}\"\r\n    exit 125\r\nfi\r\n```\r\n\r\n### Expected Results\r\n\r\nAfter invoking the `service_facts` module to get information about a service that has entered a _failed_ state on a managed host, it should be possible to identify whether a service is enabled or not (that is, whether a service is configured to start at boot time or not).\r\n\r\n### Actual Results\r\n\r\n```console\r\nrunning  '../bisect.sh'\r\n[WARNING]: You are running the development version of Ansible. You should only\r\nrun Ansible from \"devel\" if you are modifying the Ansible engine, or trying out\r\nfeatures under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\r\nthe implicit localhost does not match 'all'\r\n\r\nPLAY [localhost] ***************************************************************\r\n\r\nTASK [Verify whether a failed service exists] **********************************\r\nchanged: [localhost]\r\n\r\nTASK [Ensure that the failed service is disabled] ******************************\r\nchanged: [localhost]\r\n\r\nTASK [Get service facts] *******************************************************\r\nok: [localhost]\r\n\r\nTASK [Store facts about the failed service that is disabled] *******************\r\nok: [localhost]\r\n\r\nTASK [Ensure that the failed service is enabled] *******************************\r\nchanged: [localhost]\r\n\r\nTASK [Get service facts again] *************************************************\r\nok: [localhost]\r\n\r\nTASK [Store facts about the failed service that is enabled] ********************\r\nok: [localhost]\r\n\r\nTASK [Compare service details] *************************************************\r\nfatal: [localhost]: FAILED! => {\r\n    \"assertion\": \"(test_service_symmetric_diff | length) > 0\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"! service information is equal !!! '[{\\\"key\\\": \\\"name\\\", \\\"value\\\": \\\"foo.service\\\"}, {\\\"key\\\": \\\"state\\\", \\\"value\\\": \\\"stopped\\\"}, {\\\"key\\\": \\\"status\\\", \\\"value\\\": \\\"failed\\\"}, {\\\"key\\\": \\\"source\\\", \\\"value\\\": \\\"systemd\\\"}]'\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=7    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n\r\n82bab063e7c60b77596c5c87258d5c3398b5efc2 is the first bad commit\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-23T12:23:08Z",
        "user": "amg1127",
        "labels": [
            "module",
            "bug",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 80948,
        "title": "Bug: Native YAML DateTime literals are coming across as DateTime objects",
        "body": "### Summary\r\n\r\nPlaybook:\r\n```\r\n---\r\n- hosts: localhost\r\n  connection: local\r\n\r\n  vars:\r\n    date: 2023-05-19T11:49:52Z\r\n    date_q: '2023-05-19T11:49:52Z'\r\n    ansible_date: '{{ ansible_date_time.iso8601 }}'\r\n  tasks:\r\n    - debug:\r\n        msg: '{{ date }}'\r\n    - debug:\r\n        msg: '{{ date_q }}'\r\n    - debug:\r\n        msg: '{{ ansible_date }}'\r\n```\r\n\r\nExecution:\r\n```\r\nPLAY [localhost] \r\n\r\nTASK [Gathering Facts] \r\nok: [localhost]\r\n\r\nTASK [debug] \r\nok: [localhost] => {\r\n    \"msg\": \"2023-05-19 11:49:52+00:00\"\r\n}\r\n\r\nTASK [debug] \r\nok: [localhost] => {\r\n    \"msg\": \"2023-05-19T11:49:52Z\"\r\n}\r\n\r\nTASK [debug] \r\nok: [localhost] => {\r\n    \"msg\": \"2023-06-01T15:38:26Z\"\r\n}\r\n```\r\n\r\nAnsible converts unquoted string (2023-05-19T11:49:52Z) to different format (2023-05-19 11:49:52+00:00). Why is this happening? Is this documented anywhere?\r\n\r\n\r\n### Issue Type\r\n\r\nDocumentation Report\r\n\r\n### Component Name\r\n\r\nhttps://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.13.4]\r\n  config file = /home/mbialozor/work/tmp/ansible/ansible.cfg\r\n  configured module search path = ['/home/mbialozor/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/mbialozor/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.3 (main, Apr  5 2023, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFedora 37\r\n\r\n### Additional Information\r\n\r\nMore clarity on string conversion.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-06-01T15:46:05Z",
        "user": "mbialozor",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 80883,
        "title": "--ask-become-pass not working when fingerprint is enabled (not MFA)",
        "body": "### Summary\n\nIf you've enabled auth with a fingerprint reader, `ansible-playbook` just hangs when it needs to become root.\r\n\r\nI found this issue that was dismissed as \"Ansible does not support MFA\": https://github.com/ansible/ansible/issues/73308\r\n\r\nI looked through the [mailing list](https://groups.google.com/forum/#!forum/ansible-project) and didn't see this person ask there.\r\n\r\nBut this is not about MFA. `sudo` asks you for a fingerprint and after a set timeout (10 seconds) falls back to password entry. The key here is that Ansible does not need to support fingerprint auth (although it would be nice), but it could wait for the timeout and then enter the password when prompted for it. But today, you can wait many times this timeout and `ansible-playbook` _just_ hangs there. Below, I'll give very detailed repro steps.\r\n\r\n### Workaround\r\n\r\nI can clone my provision repo into the target machine, physically log in to it, change the `host` field from `all` to `localhost`, and run the playbook from there. I'm actually doing that for all the output below. The same bug presents itself _BUT_ when `ansible-playbook` hangs trying to elevate, I can touch the fingerprint reader and that unblocks it :laughing:. Ansible outputs a warning about it. Here is the output of this workaround:\r\n\r\n```\r\nansible-playbook [core 2.14.6]\r\n  config file = /home/stuff/code/provision/ansible.cfg\r\n  configured module search path = ['/home/stuff/.config/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/stuff/.config/ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/stuff/code/provision/.venv/bin/ansible-playbook\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110] (/home/stuff/code/provision/.venv/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /home/stuff/code/provision/ansible.cfg as config file\r\nBECOME password: \r\nsetting up inventory plugins\r\nhost_list declined parsing /home/stuff/code/provision/inventory.yaml as it did not pass its verify_file() method\r\nscript declined parsing /home/stuff/code/provision/inventory.yaml as it did not pass its verify_file() method\r\nParsed /home/stuff/code/provision/inventory.yaml inventory source with yaml plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: sudo_hang.yaml ****************************************************************************************************************\r\nPositional arguments: playbooks/sudo_hang.yaml\r\nverbosity: 4\r\nremote_user: stuff\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\nbecome_ask_pass: True\r\ntags: ('all',)\r\ninventory: ('/home/stuff/code/provision/inventory.yaml',)\r\nforks: 5\r\n1 plays in playbooks/sudo_hang.yaml\r\n\r\nPLAY [Repro sudo hang] ******************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************\r\ntask path: /home/stuff/code/provision/playbooks/sudo_hang.yaml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: stuff\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~stuff && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/stuff/.ansible/tmp `\"&& mkdir \"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863 `\" && echo ansible-tmp-1684983160.0777464-9783-91825797620863=\"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863 `\" ) && sleep 0'\r\nUsing module file /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/stuff/.config/ansible/tmp/ansible-local-9779fz2uhwrs/tmpofwndx3m TO /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863/ /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/home/stuff/code/provision/.venv/bin/python3 /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/stuff/.ansible/tmp/ansible-tmp-1684983160.0777464-9783-91825797620863/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [Create a file] ********************************************************************************************************************\r\ntask path: /home/stuff/code/provision/playbooks/sudo_hang.yaml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: stuff\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~stuff && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/stuff/.ansible/tmp `\"&& mkdir \"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229 `\" && echo ansible-tmp-1684983160.892622-9851-9053023515229=\"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229 `\" ) && sleep 0'\r\nUsing module file /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/modules/file.py\r\n<127.0.0.1> PUT /home/stuff/.config/ansible/tmp/ansible-local-9779fz2uhwrs/tmpk3uoim_p TO /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229/AnsiballZ_file.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229/ /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229/AnsiballZ_file.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'sudo -H -S -p \"[sudo via ansible, key=rbdbbsgdapqaynwmzsbfjookiyxlshwr] password:\" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-rbdbbsgdapqaynwmzsbfjookiyxlshwr ; /home/stuff/code/provision/.venv/bin/python3 /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229/AnsiballZ_file.py'\"'\"' && sleep 0'\r\n[WARNING]: Module invocation had junk after the JSON data: Place your finger on the fingerprint reader\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/stuff/.ansible/tmp/ansible-tmp-1684983160.892622-9851-9053023515229/ > /dev/null 2>&1 && sleep 0'\r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"dest\": \"/root/DELETE_ME\",\r\n    \"diff\": {\r\n        \"after\": {\r\n            \"atime\": 1684983163.059274,\r\n            \"mtime\": 1684983163.059274,\r\n            \"path\": \"/root/DELETE_ME\",\r\n            \"state\": \"touch\"\r\n        },\r\n        \"before\": {\r\n            \"atime\": 1684983163.0549607,\r\n            \"mtime\": 1684983163.0549607,\r\n            \"path\": \"/root/DELETE_ME\",\r\n            \"state\": \"absent\"\r\n        }\r\n    },\r\n    \"gid\": 0,\r\n    \"group\": \"root\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_diff_peek\": null,\r\n            \"_original_basename\": null,\r\n            \"access_time\": null,\r\n            \"access_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"attributes\": null,\r\n            \"follow\": true,\r\n            \"force\": false,\r\n            \"group\": null,\r\n            \"mode\": null,\r\n            \"modification_time\": null,\r\n            \"modification_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"owner\": null,\r\n            \"path\": \"/root/DELETE_ME\",\r\n            \"recurse\": false,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"state\": \"touch\",\r\n            \"unsafe_writes\": false\r\n        }\r\n    },\r\n    \"mode\": \"0644\",\r\n    \"owner\": \"root\",\r\n    \"size\": 0,\r\n    \"state\": \"file\",\r\n    \"uid\": 0\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n> [WARNING]: Module invocation had junk after the JSON data: Place your finger on the fingerprint reader\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsudo? become: true\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.6]\r\n  config file = /home/stuff/code/provision/ansible.cfg\r\n  configured module search path = ['/home/stuff/.config/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/stuff/.config/ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/stuff/code/provision/.venv/bin/ansible\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110] (/home/stuff/code/provision/.venv/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_HOME(env: ANSIBLE_HOME) = /home/stuff/.config/ansible\r\nANSIBLE_NOCOWS(/home/stuff/code/provision/ansible.cfg) = True\r\nCONFIG_FILE() = /home/stuff/code/provision/ansible.cfg\r\nDEFAULT_HOST_LIST(/home/stuff/code/provision/ansible.cfg) = ['/home/stuff/code/provision/inventory.yaml']\r\nDEFAULT_ROLES_PATH(/home/stuff/code/provision/ansible.cfg) = ['/home/stuff/code/provision/roles']\n```\n\n\n### OS / Environment\n\n- Debian Bullseye\r\n- [Lenovo ThinkPad X1 Yoga Gen 7](https://www.lenovo.com/us/en/p/laptops/thinkpad/thinkpadx1/thinkpad-x1-yoga-gen-7-(14-inch-intel)/len101t0010#tech_specs) (Not that I think this is relevant. It just has a fingerprint reader)\r\n- fprintd is enabled for auth, but so is password\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nIf you have a fingerprint reader (required) and haven't enabled it yet, on Debian you can do this:\r\n\r\n```bash\r\nsudo apt install fprintd libpam-fprintd\r\nsudo pam-auth-update --package --enable fprintd\r\nsudo fprintd-enroll $USER\r\n```\r\nIn _/etc/pam.d/common-auth_, `pam-auth-update` would have added a line like this:\r\n\r\n```\r\nauth\t[success=2 default=ignore]\tpam_fprintd.so max_tries=1 timeout=10 # debug\r\n```\r\n\r\nNow you can log in and sudo with your fingerprint. Here's a playbook that does something with elevated permissions:\r\n\r\n```yaml\r\n---\r\n- name: Repro sudo hang\r\n  hosts: all\r\n  tasks:\r\n  - name: Create a file\r\n    become: true\r\n    ansible.builtin.file:\r\n      path: /root/DELETE_ME\r\n      state: touch\r\n```\r\n\r\nI would run this like:\r\n```bash\r\nTARGET_HOST=\"targethost.lan\"\r\nansible-playbook -u $USER playbooks/sudo_hang.yaml -K --limit $TARGET_HOST\r\n```\r\n\n\n### Expected Results\n\nI expect the playbook to run to completion. Once the fingerprint entry times out, it asks for the password. That's when Ansible can entry the provided password.\n\n### Actual Results\n\n```console\nansible-playbook [core 2.14.6]\r\n  config file = /home/stuff/code/provision/ansible.cfg\r\n  configured module search path = ['/home/stuff/.config/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/stuff/.config/ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/stuff/code/provision/.venv/bin/ansible-playbook\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110] (/home/stuff/code/provision/.venv/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /home/stuff/code/provision/ansible.cfg as config file\r\nBECOME password: \r\nsetting up inventory plugins\r\nhost_list declined parsing /home/stuff/code/provision/inventory.yaml as it did not pass its verify_file() method\r\nscript declined parsing /home/stuff/code/provision/inventory.yaml as it did not pass its verify_file() method\r\nParsed /home/stuff/code/provision/inventory.yaml inventory source with yaml plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: sudo_hang.yaml ****************************************************************************************************************\r\nPositional arguments: playbooks/sudo_hang.yaml\r\nverbosity: 4\r\nremote_user: stuff\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\nbecome_ask_pass: True\r\ntags: ('all',)\r\ninventory: ('/home/stuff/code/provision/inventory.yaml',)\r\nforks: 5\r\n1 plays in playbooks/sudo_hang.yaml\r\n\r\nPLAY [Repro sudo hang] ******************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************\r\ntask path: /home/stuff/code/provision/playbooks/sudo_hang.yaml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: stuff\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~stuff && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/stuff/.ansible/tmp `\"&& mkdir \"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300 `\" && echo ansible-tmp-1684983071.0286577-9619-247928224759300=\"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300 `\" ) && sleep 0'\r\nUsing module file /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/stuff/.config/ansible/tmp/ansible-local-9615uv3gb8yw/tmp6iy014gs TO /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300/ /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/home/stuff/code/provision/.venv/bin/python3 /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/stuff/.ansible/tmp/ansible-tmp-1684983071.0286577-9619-247928224759300/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [Create a file] ********************************************************************************************************************\r\ntask path: /home/stuff/code/provision/playbooks/sudo_hang.yaml:5\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: stuff\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~stuff && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/stuff/.ansible/tmp `\"&& mkdir \"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648 `\" && echo ansible-tmp-1684983071.8399367-9686-230194161258648=\"` echo /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648 `\" ) && sleep 0'\r\nUsing module file /home/stuff/code/provision/.venv/lib/python3.9/site-packages/ansible/modules/file.py\r\n<127.0.0.1> PUT /home/stuff/.config/ansible/tmp/ansible-local-9615uv3gb8yw/tmp928oek4o TO /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648/AnsiballZ_file.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648/ /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648/AnsiballZ_file.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'sudo -H -S -p \"[sudo via ansible, key=jbjszufckjypwrbozwjzefymkllkcmrp] password:\" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-jbjszufckjypwrbozwjzefymkllkcmrp ; /home/stuff/code/provision/.venv/bin/python3 /home/stuff/.ansible/tmp/ansible-tmp-1684983071.8399367-9686-230194161258648/AnsiballZ_file.py'\"'\"' && sleep 0'\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-25T02:58:37Z",
        "user": "DevilPepper",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80869,
        "title": "include_role: apply become_user cannot handle jinja-phrased condition",
        "body": "### Summary\n\nWhen using the ansible-core 2.14's include_role module it cannot resolve a condition phrased in jinja-template in the apply parameter for become_user.\r\nIt passes the entire string to the included role and then fails because it is an unprivileged user.\r\nWorked fine on 2.13.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.include_role\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.6]\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.3 (main, May 10 2023, 12:26:31) [GCC 12.2.1 20220924] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = False\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nOracleLinux 8\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nPlaybook\r\n```yaml (paste below)\r\n- name: Test playbook\r\n  hosts: localhost\r\n  gather_facts: no\r\n  vars:\r\n    var1: false\r\n    var2: root\r\n  tasks:\r\n    - name: Test include_role\r\n      ansible.builtin.include_role:\r\n        name: taskname\r\n        apply:\r\n          become: \"{{ var1 | ternary(true, omit) }}\"\r\n          become_user: \"{{  var1 | ternary(var2, omit) }}\"\r\n```\r\n\r\nroles/taskname/tasks/main.yml\r\n```\r\n---\r\n- name: Create a file with root permissions\r\n  ansible.builtin.copy:\r\n    content: ''\r\n    dest: /file\r\n    owner: root\r\n    group: root\r\n\r\n- name: Change file permissions\r\n  ansible.builtin.file:\r\n    path: /file\r\n    mode: '0755'\r\n\r\n- name: Delete file\r\n  ansible.builtin.file:\r\n    path: /file\r\n    state: absent\r\n```\n\n### Expected Results\n\nOutput from ansible-core 2.13.7\r\n```\r\nPLAY [Test playbook] *********************************************************************************\r\n\r\nTASK [Test include_role] *****************************************************************************\r\n\r\nTASK [taskname : Create a file with root permissions] ************************************************\r\nchanged: [localhost]\r\n\r\nTASK [taskname : Change file permissions] ************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [taskname : Change file permissions] ************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP *******************************************************************************************\r\nlocalhost                  : ok=3    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\n\n### Actual Results\n\n```console\nPLAY [Test playbook] *********************************************************************************\r\n\r\nTASK [Test include_role] *****************************************************************************\r\ntask path: /DEV/playbook.yml:9\r\n\r\nTASK [taskname : Create a file with root permissions] ************************************************\r\ntask path: /DEV/roles/taskname/tasks/main.yml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/tmp `\"&& mkdir \"` echo /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811 `\" && echo ansible-tmp-1684848665.7514634-443-23280075011811=\"` echo /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.11/site-packages/ansible/modules/stat.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-4378emxcerv/tmpm57d8jz6 TO /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/AnsiballZ_stat.py\r\n<127.0.0.1> EXEC /bin/sh -c 'setfacl -m '\"'\"'u:{{  var1 | ternary(var2, omit) }}:r-x'\"'\"' /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/ /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/AnsiballZ_stat.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/ /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/AnsiballZ_stat.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'chown '\"'\"'{{  var1 | ternary(var2, omit) }}'\"'\"' /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/ /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/AnsiballZ_stat.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /var/tmp/ansible-tmp-1684848665.7514634-443-23280075011811/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [localhost]: FAILED! => {\r\n    \"msg\": \"Failed to change ownership of the temporary files Ansible (via chmod nor setfacl) needs to create despite connecting as a privileged user. Unprivileged become user would be unable to read the file.\"\r\n}\r\n\r\nPLAY RECAP *******************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-23T13:35:59Z",
        "user": "scholtzj",
        "labels": [
            "module",
            "bug",
            "verified",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 80856,
        "title": "When creating DNAT rules with different destinations then only 1 will be created",
        "body": "### Summary\n\nWhen creating DNAT rules with different destinations then only 1 will be created:\r\n\r\n```\r\n- name: DNAT incoming TCP v6 to the global scope ipv6 address (except first xx addresses)\r\n  ansible.builtin.iptables:\r\n    ip_version: ipv6\r\n    table: nat\r\n    chain: PREROUTING\r\n    protocol: tcp\r\n    destination: \"! {{ _ipv6_prefix }}::/{{ item }}\"\r\n    to_destination: \"{{ _ipv6 }}\"\r\n    jump: DNAT\r\n  with_items: \r\n    - 118\r\n    - 102 \r\n```\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.iptables\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.4]\r\n  config file = /home/tfoerste/devel/tor-relays/ansible.cfg\r\n  configured module search path = ['/home/tfoerste/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/tfoerste/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/lib/python-exec/python3.11/ansible\r\n  python version = 3.11.3 (main, May  6 2023, 19:42:44) [GCC 12.2.1 20230428] (/usr/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nstable Gentoo \n\n### Steps to Reproduce\n\nrun that task\n\n### Expected Results\n\n2 rules\n\n### Actual Results\n\n```console\nTASK [setup : DNAT ******************************************************************************************\r\nchanged: [buddelflink] => (item=118)\r\nok: [buddelflink] => (item=102)\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-21T08:17:47Z",
        "user": "toralf",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.14"
        ]
    },
    {
        "number": 80843,
        "title": "Remove __future__ and metaclass boilerplate from controller code",
        "body": "### Summary\r\n\r\nSince we've dropped 2.x support for the controller, we can remove the old 2.x future and metaclass boilerplate from non-target-side code.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\ncontroller code, sanity tests\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-18T21:57:11Z",
        "user": "nitzmahone",
        "labels": [
            "feature",
            "affects_2.16",
            "code_health",
            "affects_2.17"
        ]
    },
    {
        "number": 80813,
        "title": "the apt module fails to install a package in some cases",
        "body": "### Summary\r\n\r\nThe apt module fails to install the exact package version from a repository with a pin-priority 1001 and higher.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n  config file = /Users/user/.ansible.cfg\r\n  configured module search path = ['/Users/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /Users/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible\r\n  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/opt/python@3.11/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /Users/user/.ansible.cfg\r\nDEFAULT_ACTION_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/action_plugins']\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/callback_plugins']\r\nDEFAULT_CONNECTION_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/collection_plugins']\r\nDEFAULT_FILTER_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/filter_plugins']\r\nDEFAULT_FORKS(/Users/user/.ansible.cfg) = 10\r\nDEFAULT_GATHERING(/Users/user/.ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/Users/user/.ansible.cfg) = ['/Users/user/user/library/ansible-dynamic-inventory/inventory.py']\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/lookup_plugins']\r\nDEFAULT_MODULE_NAME(/Users/user/.ansible.cfg) = shell\r\nDEFAULT_REMOTE_USER(/Users/user/.ansible.cfg) = root\r\nDEFAULT_VARS_PLUGIN_PATH(/Users/user/.ansible.cfg) = ['/Users/user/plugins/var_plugins']\r\nDEPRECATION_WARNINGS(/Users/user/.ansible.cfg) = False\r\nDISPLAY_SKIPPED_HOSTS(/Users/user/.ansible.cfg) = False\r\nHOST_KEY_CHECKING(/Users/user/.ansible.cfg) = False\r\nINTERPRETER_PYTHON(/Users/user/.ansible.cfg) = auto\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\ndisplay_skipped_hosts(/Users/user/.ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/Users/user/.ansible.cfg) = False\r\nremote_user(/Users/user/.ansible.cfg) = root\r\nssh_args(/Users/user/.ansible.cfg) = -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey\r\n\r\nssh:\r\n___\r\ncontrol_path(/Users/user/.ansible.cfg) = ~/.ansible/ssh/%%h-%%rn\r\nhost_key_checking(/Users/user/.ansible.cfg) = False\r\npipelining(/Users/user/.ansible.cfg) = True\r\nremote_user(/Users/user/.ansible.cfg) = root\r\nssh_args(/Users/user/.ansible.cfg) = -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04\r\n\r\n### Steps to Reproduce\r\n\r\n1. Implement the following repository (it is mandatory that the repository contain at least two versions):\r\n```\r\nFilename: /grpcurl_1.100_amd64.deb\r\nDescription: cURL for gRPC\r\nPackage: grpcurl\r\nVersion: 1.100\r\nArchitecture: amd64\r\n\r\nFilename: /grpcurl_1.50_amd64.deb\r\nDescription: cURL for gRPC\r\nPackage: grpcurl\r\nVersion: 1.50\r\nArchitecture: amd64\r\n```\r\n\r\nSorry, I couldn't quickly figure out how to create an InRelease file for it, but that's probably needed as well\r\n\r\n2. Implement following pin for this repository:\r\n```\r\nPackage: *\r\nPin: release o=testrepo, a=stable\r\nPin-Priority: 1001\r\n```\r\n\r\n3. Implement the following playbook:\r\n```yaml\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - name: Install grpcurl\r\n      apt:\r\n        update_cache: false\r\n        pkg:\r\n          - grpcurl=1.50\r\n```\r\n\r\n4. Run ansible-playbook\r\n\r\n5. Get message `no available installation candidate for grpcurl=1.50` from ansible-playbook. \r\n\r\n### Expected Results\r\n\r\nPackage with provided version was installed\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook test.yml -vvvv\r\nansible-playbook [core 2.14.5]\r\n  config file = /Users/user/.ansible.cfg\r\n  configured module search path = ['/Users/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/homebrew/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /Users/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /opt/homebrew/bin/ansible-playbook\r\n  python version = 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] (/opt/homebrew/opt/python@3.11/bin/python3.11)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /Users/user/.ansible.cfg as config file\r\nsetting up inventory plugins\r\nLoading callback plugin default of type stdout, v2.0 from /opt/homebrew/lib/python3.11/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: test.yml *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nPositional arguments: test.yml\r\nverbosity: 4\r\nremote_user: root\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\ntags: ('all',)\r\nforks: 10\r\n1 plays in test.yml\r\n\r\nPLAY [remotehost] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' remotehost '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<remotehost> (0, b'/root\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/Users/user/.ansible/ssh/remotehost-rootn\" does not exist\\r\\ndebug2: resolving \"remotehost\" port 22\\r\\ndebug3: resolve_host: lookup remotehost:22\\r\\ndebug3: ssh_connect_direct: entering\\r\\ndebug1: Connecting to remotehost [2a02:6b8:c14:b1b:0:1459:29ba:0] port 22.\\r\\ndebug3: set_sock_tos: set socket 3 IPV6_TCLASS 0x48\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9992 ms remain after connect\\r\\ndebug1: identity file /Users/user/.ssh/id_rsa type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_rsa-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ecdsa type 2\\r\\ndebug1: identity file /Users/user/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ecdsa_sk type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ecdsa_sk-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ed25519 type 3\\r\\ndebug1: identity file /Users/user/.ssh/id_ed25519-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ed25519_sk type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_ed25519_sk-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_xmss type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_xmss-cert type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_dsa type -1\\r\\ndebug1: identity file /Users/user/.ssh/id_dsa-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_9.3\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_8.2p1 Ubuntu-4ubuntu0.7\\r\\ndebug1: compat_banner: match: OpenSSH_8.2p1 Ubuntu-4ubuntu0.7 pat OpenSSH* compat 0x04000000\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to remotehost:22 as \\'root\\'\\r\\ndebug1: load_hostkeys: fopen /opt/homebrew/etc/ssh/ssh_known_hosts: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /opt/homebrew/etc/ssh/ssh_known_hosts2: No such file or directory\\r\\ndebug3: order_hostkeyalgs: no algorithms matched; accept original\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c\\r\\ndebug2: host key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com,zlib\\r\\ndebug2: compression stoc: none,zlib@openssh.com,zlib\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256\\r\\ndebug2: host key algorithms: rsa-sha2-512,rsa-sha2-256,ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: curve25519-sha256\\r\\ndebug1: kex: host key algorithm: ssh-ed25519\\r\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none\\r\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: SSH2_MSG_KEX_ECDH_REPLY received\\r\\ndebug1: Server host key: ssh-ed25519 SHA256:OcpeqCFlHW11BzmJxUGmOF9hFWDRpuZ1YId3ERt5blg\\r\\ndebug1: load_hostkeys: fopen /opt/homebrew/etc/ssh/ssh_known_hosts: No such file or directory\\r\\ndebug1: load_hostkeys: fopen /opt/homebrew/etc/ssh/ssh_known_hosts2: No such file or directory\\r\\nWarning: Permanently added \\'remotehost\\' (ED25519) to the list of known hosts.\\r\\ndebug3: send packet: type 21\\r\\ndebug2: ssh_set_newkeys: mode 1\\r\\ndebug1: rekey out after 134217728 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: ssh_set_newkeys: mode 0\\r\\ndebug1: rekey in after 134217728 blocks\\r\\ndebug3: ssh_get_authentication_socket_path: path \\'/Users/user/.skotty/sock/default.sock\\'\\r\\ndebug2: get_agent_identities: ssh_agent_bind_hostkey: agent refused operation\\r\\ndebug1: get_agent_identities: agent returned 3 keys\\r\\ndebug1: Will attempt key: Skotty key insecure@secure-enclave on Secure Enclave ECDSA-CERT SHA256:6Wo55ufisgWBgcjhGVfjZoaa+ZgNSJZMYAd0GgL1pFQ agent\\r\\ndebug1: Will attempt key: Skotty key legacy@secure-enclave on Secure Enclave ECDSA SHA256:yRWme8n5edaMLmjDVMOLzu9Ylwg5VG+E7F74rkS3ox8 agent\\r\\ndebug1: Will attempt key: Skotty key secure@secure-enclave on Secure Enclave ECDSA-CERT SHA256:Gr2oSm9OOqCNYHTlRR9foY8LpUIjbSyJsMM/DwjoGgU agent\\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_rsa \\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_ecdsa ECDSA SHA256:ETT164TFBDqr3Pte/1P3/gKz411pkE/8uMpM9QvxCwk\\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_ecdsa_sk \\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_ed25519 ED25519 SHA256:aevL3IHve3RG1OwPGReAG3c/DBpCmVIskKP3Xb7w0cc\\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_ed25519_sk \\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_xmss \\r\\ndebug1: Will attempt key: /Users/user/.ssh/id_dsa \\r\\ndebug2: pubkey_prepare: done\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey\\r\\ndebug3: start over, passed a different list publickey\\r\\ndebug3: preferred publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: \\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: Skotty key insecure@secure-enclave on Secure Enclave ECDSA-CERT SHA256:6Wo55ufisgWBgcjhGVfjZoaa+ZgNSJZMYAd0GgL1pFQ agent\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: Skotty key insecure@secure-enclave on Secure Enclave ECDSA-CERT SHA256:6Wo55ufisgWBgcjhGVfjZoaa+ZgNSJZMYAd0GgL1pFQ agent\\r\\ndebug3: sign_and_send_pubkey: using publickey with ECDSA-CERT SHA256:6Wo55ufisgWBgcjhGVfjZoaa+ZgNSJZMYAd0GgL1pFQ\\r\\ndebug1: sign_and_send_pubkey: no separate private key for certificate \"Skotty key insecure@secure-enclave on Secure Enclave\"\\r\\ndebug3: sign_and_send_pubkey: signing using ecdsa-sha2-nistp256-cert-v01@openssh.com SHA256:6Wo55ufisgWBgcjhGVfjZoaa+ZgNSJZMYAd0GgL1pFQ\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\nAuthenticated to remotehost ([2a02:6b8:c14:b1b:0:1459:29ba:0]:22) using \"publickey\".\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /Users/user/.ansible/ssh/remotehost-rootn.tvI5WTFJFZALDASv\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 0: new mux listener [/Users/user/.ansible/ssh/remotehost-rootn] (inactive timeout: 0)\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 5\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: set_sock_tos: set socket 3 IPV6_TCLASS 0x20\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 26023\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug3: client_repledge: enter\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug3: fd 6 is O_NONBLOCK\\r\\ndebug3: fd 6 is O_NONBLOCK\\r\\ndebug1: channel 1: new mux-control [mux-control] (inactive timeout: 0)\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 6\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: mux_master_process_hello: channel 1 client version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: mux_master_process_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 161\\r\\ndebug2: mux_master_process_new_session: channel 1: request tty 0, X 0, agent 1, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo ~root && sleep 0\\'\", env 3\\r\\ndebug3: mux_master_process_new_session: got fds stdin 7, stdout 8, stderr 9\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug2: fd 9 setting O_NONBLOCK\\r\\ndebug1: channel 2: new session [client-session] (inactive timeout: 0)\\r\\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:3: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:3: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:7: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:7: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:8: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:8: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:12: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:12: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:16: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:16: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:18: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:18: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:23: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:23: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:24: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:24: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:29: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:29: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:31: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:31: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:35: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:35: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:37: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:37: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:39: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:39: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:45: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:45: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:46: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:46: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:49: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:49: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:52: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:52: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:56: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:56: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:58: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:58: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:61: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:61: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:65: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:65: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:66: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:66: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:71: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:71: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:77: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:77: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:80: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:80: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:83: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:83: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:85: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:85: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:88: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:88: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:93: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:93: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:3: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:3: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:7: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:7: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:8: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:8: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:12: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:12: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:16: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:16: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:18: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:18: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:23: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:23: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:24: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:24: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:29: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:29: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:31: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:31: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:35: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:35: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:37: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:37: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:39: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:39: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:45: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:45: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:46: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:46: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:49: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:49: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:52: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:52: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:56: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:56: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:58: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:58: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:61: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:61: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:65: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:65: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:66: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:66: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:71: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:71: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:77: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:77: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:80: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:80: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:83: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:83: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:85: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:85: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:88: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:88: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: Certificate does not contain an authorized principal\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:93: key options: agent-forwarding port-forwarding principals pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:93: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug1: Requesting authentication agent forwarding.\\r\\ndebug2: channel 2: request auth-agent-req@openssh.com confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: channel 2: setting env LANG = \"en_US.UTF-8\"\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: channel 2: setting env LC_TERMINAL = \"iTerm2\"\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: channel 2: setting env LC_TERMINAL_VERSION = \"3.5.0beta10\"\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo ~root && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: client_repledge: enter\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: chan_shutdown_read: channel 2: (i0 o1 sock -1 wfd 7 efd 9 [write])\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: chan_shutdown_write: channel 2: (i3 o1 sock -1 wfd 8 efd 9 [write])\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: chan_shutdown_read: channel 1: (i0 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 [mux-control] nr0 i3/0 o1/0 e[closed]/0 fd 6/6/-1 sock 6 cc -1 io 0x01/0x00)\\r\\n  #2 client-session (t4 [session] r0 i3/0 o3/0 e[write]/0 fd -1/-1/9 sock -1 cc -1 io 0x00/0x00)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: chan_shutdown_write: channel 1: (i3 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 [mux-control] nr0 i3/0 o3/0 e[closed]/0 fd 6/6/-1 sock 6 cc -1 io 0x00/0x00)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' remotehost '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545 `\" && echo ansible-tmp-1684257602.7102752-26020-1391456884545=\"` echo /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545 `\" ) && sleep 0'\"'\"''\r\n<remotehost> (0, b'ansible-tmp-1684257602.7102752-26020-1391456884545=/root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<remotehost> Attempting python interpreter discovery\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' remotehost '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.11'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.10'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.9'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.8'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<remotehost> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python3.8\\n/usr/bin/python3\\n/usr/bin/python2.7\\n/usr/bin/python\\n/usr/bin/python\\nENDFOUND\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' remotehost '/bin/sh -c '\"'\"'/usr/bin/python3.8 && sleep 0'\"'\"''\r\n<remotehost> (0, b'{\"platform_dist_result\": [], \"osrelease_content\": \"NAME=\\\\\"Ubuntu\\\\\"\\\\nVERSION=\\\\\"20.04.6 LTS (Focal Fossa)\\\\\"\\\\nID=ubuntu\\\\nID_LIKE=debian\\\\nPRETTY_NAME=\\\\\"Ubuntu 20.04.6 LTS\\\\\"\\\\nVERSION_ID=\\\\\"20.04\\\\\"\\\\nHOME_URL=\\\\\"https://www.ubuntu.com/\\\\\"\\\\nSUPPORT_URL=\\\\\"https://help.ubuntu.com/\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.launchpad.net/ubuntu/\\\\\"\\\\nPRIVACY_POLICY_URL=\\\\\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\\\\\"\\\\nVERSION_CODENAME=focal\\\\nUBUNTU_CODENAME=focal\\\\n\"}\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /opt/homebrew/lib/python3.11/site-packages/ansible/modules/apt.py\r\n<remotehost> PUT /Users/user/.ansible/tmp/ansible-local-26015sicd0n9y/tmp7c3d0ml0 TO /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py\r\n<remotehost> SSH: EXEC sftp -b - -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' '[remotehost]'\r\n<remotehost> (0, b'sftp> put /Users/user/.ansible/tmp/ansible-local-26015sicd0n9y/tmp7c3d0ml0 /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"lsetstat@openssh.com\" revision 1\\r\\ndebug2: Sending SSH2_FXP_REALPATH \".\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH2_FXP_REALPATH . -> /root\\r\\ndebug3: Looking up /Users/user/.ansible/tmp/ansible-local-26015sicd0n9y/tmp7c3d0ml0\\r\\ndebug2: Sending SSH2_FXP_STAT \"/root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py\"\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug1: stat remote: No such file or directory\\r\\ndebug2: do_upload: upload local \"/Users/user/.ansible/tmp/ansible-local-26015sicd0n9y/tmp7c3d0ml0\" to remote \"/root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py\"\\r\\ndebug2: Sending SSH2_FXP_OPEN \"/root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py\"\\r\\ndebug3: Sent dest message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py M:0x001a\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:131072 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:10 O:163840 S:24776\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 32768 bytes at 131072\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 10 24776 bytes at 163840\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' remotehost '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/ /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py && sleep 0'\"'\"''\r\n<remotehost> (0, b'', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<remotehost> ESTABLISH SSH CONNECTION FOR USER: root\r\n<remotehost> SSH: EXEC ssh -vvv -o Controlmaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o 'ControlPath=\"~/.ansible/ssh/%h-%rn\"' -tt remotehost '/bin/sh -c '\"'\"'/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1684257602.7102752-26020-1391456884545/AnsiballZ_apt.py && sleep 0'\"'\"''\r\n<remotehost> (1, b'apt_pkg\\r\\n\\r\\n{\"cache_updated\": false, \"cache_update_time\": 1684256868, \"failed\": true, \"msg\": \"no available installation candidate for grpcurl=1.50\", \"invocation\": {\"module_args\": {\"update_cache\": false, \"pkg\": [\"grpcurl=1.50\"], \"package\": [\"grpcurl=1.50\"], \"state\": \"present\", \"update_cache_retries\": 5, \"update_cache_retry_max_delay\": 12, \"cache_valid_time\": 0, \"purge\": false, \"force\": false, \"upgrade\": null, \"dpkg_options\": \"force-confdef,force-confold\", \"autoremove\": false, \"autoclean\": false, \"fail_on_autoremove\": false, \"only_upgrade\": false, \"force_apt_get\": false, \"clean\": false, \"allow_unauthenticated\": false, \"allow_downgrade\": false, \"allow_change_held_packages\": false, \"lock_timeout\": 60, \"deb\": null, \"default_release\": null, \"install_recommends\": null, \"policy_rc_d\": null}}}\\r\\n', b'OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\\r\\ndebug1: Reading configuration data /Users/user/.ssh/config\\r\\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\\r\\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\\r\\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 26025\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 1\\r\\nShared connection to remotehost closed.\\r\\n')\r\n<remotehost> Failed to connect to the host via ssh: OpenSSH_9.3p1, OpenSSL 1.1.1t  7 Feb 2023\r\ndebug1: Reading configuration data /Users/user/.ssh/config\r\ndebug1: /Users/user/.ssh/config line 1: Applying options for *\r\ndebug1: /Users/user/.ssh/config line 8: Applying options for remotehost\r\ndebug1: Reading configuration data /opt/homebrew/etc/ssh/ssh_config\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 26025\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 1\r\nShared connection to remotehost closed.\r\n\r\nTASK [Install grpcurl] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\ntask path: /Users/user/test.yml:4\r\nfatal: [remotehost]: FAILED! => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/bin/python3\"\r\n    },\r\n    \"cache_update_time\": 1684256868,\r\n    \"cache_updated\": false,\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_change_held_packages\": false,\r\n            \"allow_downgrade\": false,\r\n            \"allow_unauthenticated\": false,\r\n            \"autoclean\": false,\r\n            \"autoremove\": false,\r\n            \"cache_valid_time\": 0,\r\n            \"clean\": false,\r\n            \"deb\": null,\r\n            \"default_release\": null,\r\n            \"dpkg_options\": \"force-confdef,force-confold\",\r\n            \"fail_on_autoremove\": false,\r\n            \"force\": false,\r\n            \"force_apt_get\": false,\r\n            \"install_recommends\": null,\r\n            \"lock_timeout\": 60,\r\n            \"only_upgrade\": false,\r\n            \"package\": [\r\n                \"grpcurl=1.50\"\r\n            ],\r\n            \"pkg\": [\r\n                \"grpcurl=1.50\"\r\n            ],\r\n            \"policy_rc_d\": null,\r\n            \"purge\": false,\r\n            \"state\": \"present\",\r\n            \"update_cache\": false,\r\n            \"update_cache_retries\": 5,\r\n            \"update_cache_retry_max_delay\": 12,\r\n            \"upgrade\": null\r\n        }\r\n    },\r\n    \"msg\": \"no available installation candidate for grpcurl=1.50\"\r\n}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nremotehost : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-16T17:25:01Z",
        "user": "kemko",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 80785,
        "title": "ansible.builtin.get_url does not respect 307",
        "body": "### Summary\n\nIn check mode, `get_url` does a `HEAD` request. When a server answers this with a `307` redirect, ansible performs a `GET` request against the redirect uri. This causes issues when the redirect uri is only valid for the `HEAD` method.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nget_url\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.5]\r\n  config file = None\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.16 (main, May  3 2023, 09:59:09) [GCC 8.3.0] (/usr/local/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nDocker image based on debian buster.\n\n### Steps to Reproduce\n\n```yaml\r\n  - name: Fetch package\r\n    ansible.builtin.get_url:\r\n      url: \"{{ package_url }}\"\r\n      headers:\r\n        PRIVATE-TOKEN: \"{{ auth_token }}\"\r\n      dest: \"{{ workdir.path }}\"\r\n```\r\n\r\nExecute the above in check mode against a `package_url` that returns a 307. For example, using nginx running on the same host:\r\n\r\n```\r\n    location /testmypackageurl {\r\n        return 307 http://localhost/abigblackhole;\r\n    }\r\n```\n\n### Expected Results\n\nThe following in nginx logs:\r\n\r\n```\r\n127.0.0.1 - - [12/May/2023:13:00:35 +0000] \"HEAD /testmypackageurl HTTP/1.1\" 307 0 \"-\" \"ansible-httpget\" \"-\"\r\n127.0.0.1 - - [12/May/2023:13:00:35 +0000] \"HEAD /abigblackhole HTTP/1.1\" 404 0 \"-\" \"ansible-httpget\" \"-\r\n```\n\n### Actual Results\n\n```console\n127.0.0.1 - - [12/May/2023:13:00:35 +0000] \"HEAD /testmypackageurl HTTP/1.1\" 307 0 \"-\" \"ansible-httpget\" \"-\"\r\n127.0.0.1 - - [12/May/2023:13:00:35 +0000] \"GET /abigblackhole HTTP/1.1\" 404 0 \"-\" \"ansible-httpget\" \"-\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-12T13:36:42Z",
        "user": "setpill",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80747,
        "title": "Implement object data tagging",
        "body": "### Summary\r\n\r\nImplement object data tagging, to replace unsafe, no_log, and add deprecation functionality.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible\r\n",
        "created_at": "2023-05-09T19:05:58Z",
        "user": "mattclay",
        "labels": [
            "P2",
            "has_pr",
            "feature",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 80737,
        "title": "failure in run_once task while using strategy free leads to all other hosts finishing immediately",
        "body": "### Summary\n\nWhen I use the run_once keyword with `strategy: free` and the keyworded task fails, instead of it having no effect on the play, it makes all other running hosts finish their last task and terminates the play.\r\n\r\nThis is especially problematic when including roles from others, where the run_once keyword could be somewhere you didn't know, and it could break your plays if you are using the free strategy.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nrun_once\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.5]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/user/.local/bin/ansible\r\n  python version = 3.11.3 (main, Apr  5 2023, 15:52:25) [GCC 12.2.1 20230201] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\nArchcraft x86_64 - kernel 6.3.1-arch1-1 (Arch)\r\n\r\nBut I also experienced the same issue using \r\nDebian 5.10.103-1\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nplaybook.yml\r\n```yaml (paste below)\r\n- name: Test\r\n  hosts: all\r\n  gather_facts: false\r\n  strategy: free\r\n  tasks:\r\n    - name: fail if success_run_once is false\r\n      fail:\r\n      run_once: true\r\n      when: success_run_once == false\r\n\r\n    - name: wait some time\r\n      ansible.builtin.wait_for:\r\n        timeout: 10\r\n      delegate_to: localhost\r\n\r\n    - name: simulate say hi\r\n      debug:\r\n        msg: \"hi from {{ inventory_hostname }}\"\r\n\r\n    - name: simulate do fail\r\n      fail:\r\n      when: inventory_hostname == 'host1'\r\n\r\n    - name: say hi\r\n      debug:\r\n        msg: \"{{ inventory_hostname }} just finished its tasks\"\r\n```\r\n\r\ninventory.yml\r\n```yaml (paste below)\r\nall:\r\n  hosts:\r\n    host1:\r\n      ansible_hostname: 127.0.0.1\r\n      success_run_once: true\r\n    host2:\r\n      ansible_hostname: 127.0.0.1\r\n      success_run_once: true\r\n    host3:\r\n      ansible_hostname: 127.0.0.1\r\n      success_run_once: false\r\n```\r\n\r\nRun ansible-playbook:\r\n`ansible-playbook -i inventory.yml playbook.yml`\r\n\r\n\r\n\r\n\r\n\r\n\n\n### Expected Results\n\nI expected run_once to not have any effect on the play and tasks, as if it wasn't there.\r\n\r\nSample expected output obtained by removing the run_once keyword:\r\n```\r\nPLAY [Test] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [fail if success_run_once is false] ********************************************************************************************************************************************************************\r\nskipping: [host1]\r\nskipping: [host2]\r\nfatal: [host3]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\n\r\nTASK [wait some time] ***************************************************************************************************************************************************************************************\r\nok: [host1 -> localhost]\r\nok: [host2 -> localhost]\r\n\r\nTASK [simulate say hi] **************************************************************************************************************************************************************************************\r\nok: [host1] => {\r\n    \"msg\": \"hi from host1\"\r\n}\r\nok: [host2] => {\r\n    \"msg\": \"hi from host2\"\r\n}\r\n\r\nTASK [simulate do fail] *************************************************************************************************************************************************************************************\r\nfatal: [host1]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\nskipping: [host2]\r\n\r\nTASK [say hi] ***********************************************************************************************************************************************************************************************\r\nok: [host2] => {\r\n    \"msg\": \"host2 just finished its tasks\"\r\n}\r\n\r\nPLAY RECAP **************************************************************************************************************************************************************************************************\r\nhost1                      : ok=2    changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   \r\nhost2                      : ok=3    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   \r\nhost3                      : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\n\n### Actual Results\n\n```console\nAfter one of the hosts fails in the run_once task, all the other finish their current task, and the play ends reporting stats, with no indication that something went wrong with the other hosts (A part from the lower total of tasks done).\r\n\r\n\r\nPLAY [Test] *************************************************************************************************************************************************************************************************\r\n[WARNING]: Using run_once with the free strategy is not currently supported. This task will still be executed for every host in the inventory list.\r\n\r\nTASK [fail if success_run_once is false] ********************************************************************************************************************************************************************\r\nskipping: [host1]\r\nskipping: [host2]\r\nfatal: [host3]: FAILED! => {\"changed\": false, \"msg\": \"Failed as requested from task\"}\r\n\r\nTASK [wait some time] ***************************************************************************************************************************************************************************************\r\nok: [host2 -> localhost]\r\nok: [host1 -> localhost]\r\n\r\nPLAY RECAP **************************************************************************************************************************************************************************************************\r\nhost1                      : ok=1    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost2                      : ok=1    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   \r\nhost3                      : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-08T08:57:27Z",
        "user": "GlysVenture",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80706,
        "title": "Ansible stuck on inline if when else is missing",
        "body": "### Summary\r\n\r\nInstead of throwing a syntax error ansible gets stuck when parsing an inline if without an else block.\r\n```jinja2\r\n'foo' if false\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.3]\r\n  config file = /workspace/ansible.cfg\r\n  configured module search path = ['/workspace/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /workspace/.pyenv/versions/3.10.4/envs/ansible.venv/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /workspace/collections\r\n  executable location = /workspace/.pyenv/versions/ansible.venv/bin/ansible\r\n  python version = 3.10.4 (main, Mar 16 2023, 19:49:22) [GCC 10.2.1 20210110] (/workspace/.pyenv/versions/3.10.4/envs/ansible.venv/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n# Edit: removed unrelated config after further testing and narrowing down the issue.\r\nDEFAULT_JINJA2_NATIVE(/workspace/ansible.cfg) = True\r\n...\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n$ cat /etc/os-release \r\nPRETTY_NAME=\"Debian GNU/Linux 11 (bullseye)\"\r\nNAME=\"Debian GNU/Linux\"\r\nVERSION_ID=\"11\"\r\nVERSION=\"11 (bullseye)\"\r\nVERSION_CODENAME=bullseye\r\nID=debian\r\nHOME_URL=\"https://www.debian.org/\"\r\nSUPPORT_URL=\"https://www.debian.org/support\"\r\nBUG_REPORT_URL=\"https://bugs.debian.org/\"\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: test\r\n  gather_facts: false\r\n  hosts: localhost\r\n  tasks:\r\n    - debug: msg=\"{{ 'foo' if false }}\"\r\n```\r\n\r\nNote: `jinja2_native=True` has also to be set. Bug does not occur with it set to false.\r\n\r\n### Expected Results\r\n\r\nI'd suggest to do either:\r\n1) fail with a syntax error, as \"else\" is missing and therefore the inline if is incompletely defined\r\n2) Be \"smart\" either return nothing or `omit` (see examples).\r\n\r\nExamples:\r\n```\r\nsomeKey:\r\n  someParameter: \"{{ 'foo' if false }}\"\r\n```\r\n=> evaluating to `omit`, so that `someParameter` is undefined.\r\n```\r\nsomeKey:\r\n  someParameter: \"something{{ '-dev' if false }}\"\r\n```\r\n=> evaluating to `''`, so that `someParameter` is set to `something`\r\n\r\n### Actual Results\r\n\r\n```console\r\nAnsible hangs indefinitely\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-05-03T11:20:03Z",
        "user": "agowa",
        "labels": [
            "bug",
            "has_pr",
            "native_jinja",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80669,
        "title": "user module doesn't output the right 'groups' value in the return values.",
        "body": "### Summary\n\nthe return value 'groups' of user module should output the groups which a user **currently** belongs to, not has now been added to.\r\n\r\nIn the documentation, the description of return value 'groups' says as follows.\r\n> List of groups of which the user is a member.\r\n\r\n[https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#return-groups](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#return-groups)\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nuser\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\nansible [core 2.12.9]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.2 (default, Mar 13 2020, 10:14:16) [GCC 9.3.0]\r\n  jinja version = 2.10.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\n$ lsb_release -a\r\nDistributor ID: Ubuntu\r\nDescription:    Ubuntu 20.04 LTS\r\nRelease:        20.04\r\nCodename:       focal\n\n### Steps to Reproduce\n\nansible-playbook -i hosts user.yml -k -K -vvvv\r\n```\r\n- hosts: all\r\n  become: true\r\n  tasks:\r\n    - name: Create user\r\n      user:\r\n        name: \"testuser\"\r\n        groups: \r\n          - www-data\r\n          - sudo\r\n        append: false\r\n        state: present\r\n    - name: Append a group to the user\r\n      user:\r\n        name: \"testuser\"\r\n        groups:\r\n          - man\r\n        append: true\r\n        state: present\r\n```\r\n\n\n### Expected Results\n\n'groups' should output the groups which a user **currently** belongs to, not has now been added to.\n\n### Actual Results\n\n```console\nThe first \"Create user\" task is right because the user is now created for the first time. However, the second task \"Append a group to the user\" doesn't have the right value for \"groups\" since it outputs the \r\n\r\nTASK [Create user] **********************************************************************************************************************************************************************************\r\ntask path: /root/project/user.yml:5\r\n<10.32.2.155> ESTABLISH SSH CONNECTION FOR USER: ubuntu\r\n(( long output... ))\r\nchanged: [10.32.2.155] => {\r\n    \"changed\": true,\r\n    \"comment\": \"\",\r\n    \"create_home\": true,\r\n    \"group\": 1003,\r\n    \"groups\": \"www-data,sudo\",\r\n    \"home\": \"/home/testuser\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": false,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"www-data\",\r\n                \"sudo\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"testuser\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_expire_max\": null,\r\n            \"password_expire_min\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on agkr-testbox\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"umask\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"name\": \"testuser\",\r\n    \"shell\": \"/bin/sh\",\r\n    \"state\": \"present\",\r\n    \"system\": false,\r\n    \"uid\": 1002\r\n}\r\nTASK [Append a group to the user] *******************************************************************************************************************************************************************\r\ntask path: /root/project/user.yml:13\r\n<10.32.2.155> ESTABLISH SSH CONNECTION FOR USER: ubuntu\r\n(long output...)\r\nchanged: [10.32.2.155] => {\r\n    \"append\": true,\r\n    \"changed\": true,\r\n    \"comment\": \"\",\r\n    \"group\": 1003,\r\n    \"groups\": \"man\",\r\n    \"home\": \"/home/testuser\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": true,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"man\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"testuser\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_expire_max\": null,\r\n            \"password_expire_min\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on agkr-testbox\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"umask\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"move_home\": false,\r\n    \"name\": \"testuser\",\r\n    \"shell\": \"/bin/sh\",\r\n    \"state\": \"present\",\r\n    \"uid\": 1002\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-28T10:28:58Z",
        "user": "agkr234",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 80657,
        "title": "role argument spec: allow for shared fragments, like with plugins",
        "body": "### Summary\n\nWhen writing documentation for plugins, one can use `doc_fragments` to have a library of common things to document.\r\nFor the `AnsibleModule.argument_spec` people usually use Pythons inheritance (or helpers like `url_argument_spec`).\r\n\r\nWhen it comes to role argument specs, there is no comparable feature.\r\nWhen documenting multiple entrypoints in one role, I've seen people using YAML anchors (&/*) to reference the same blocks, but this doesn't work when documenting multiple roles in a collection that share the same \"base\" parameters (credentials, for example).\r\n\r\nIt would be cool if we Ansible would have a place (`collection_root/meta/role_argument_specs.yml`?) that can define a common base that can be referenced later.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nrole\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-27T11:17:38Z",
        "user": "evgeni",
        "labels": [
            "has_pr",
            "feature",
            "P3",
            "affects_2.16"
        ]
    },
    {
        "number": 80644,
        "title": "`dnf` module ignores repo files inside `installroot` path",
        "body": "### Summary\n\nWhen using `installroot` option, `dnf` module ignores repo files inside `installroot` path.\r\n\r\nThe playbook creates an empty directory (actually it is `buildah` mount point, but that should be irrelevant to this issue) and then creates a minimal `dnf` configuration adding `dnf.conf` and repo file inside that empty directory.\r\n\r\n`dnf` command will work just fine:\r\n```\r\n# dnf -c /var/lib/containers/storage/zfs/graph/07ff29954653e299e16949763371a53c633b96a8825023597135cc68c0a0253f/etc/dnf/dnf.conf --installroot /var/lib/containers/storage/zfs/graph/07ff29954653e299e16949763371a53c633b96a8825023597135cc68c0a0253f/ --disablerepo=\"*\" --enablerepo=\"baseos\" --disableplugin=\"subscription-manager\" --releasever=9 install glibc-minimal-langpack coreutils-single\r\nLast metadata expiration check: 0:30:18 ago on \u015bro, 26 kwi 2023, 12:40:31.\r\nDependencies resolved.\r\n==============================================================================================================================================================================\r\n Package                                           Architecture                      Version                                          Repository                         Size\r\n==============================================================================================================================================================================\r\nInstalling:\r\n coreutils-single                                  x86_64                            8.32-32.el9                                      baseos                            601 k\r\n glibc-minimal-langpack                            x86_64                            2.34-40.el9_1.1                                  baseos                             28 k\r\nInstalling dependencies:\r\n almalinux-gpg-keys                                x86_64                            9.1-1.9.el9                                      baseos                            9.6 k\r\n almalinux-release                                 x86_64                            9.1-1.9.el9                                      baseos                             20 k\r\n almalinux-repos                                   x86_64                            9.1-1.9.el9                                      baseos                            9.7 k\r\n basesystem                                        noarch                            11-13.el9                                        baseos                            7.0 k\r\n bash                                              x86_64                            5.1.8-6.el9_1                                    baseos                            1.7 M\r\n filesystem                                        x86_64                            3.16-2.el9                                       baseos                            1.1 M\r\n glibc                                             x86_64                            2.34-40.el9_1.1                                  baseos                            1.9 M\r\n glibc-common                                      x86_64                            2.34-40.el9_1.1                                  baseos                            300 k\r\n libacl                                            x86_64                            2.3.1-3.el9                                      baseos                             24 k\r\n libattr                                           x86_64                            2.5.1-3.el9                                      baseos                             18 k\r\n libcap                                            x86_64                            2.48-8.el9                                       baseos                             68 k\r\n libgcc                                            x86_64                            11.3.1-2.1.el9.alma                              baseos                            115 k\r\n libselinux                                        x86_64                            3.4-3.el9                                        baseos                             85 k\r\n libsepol                                          x86_64                            3.4-1.1.el9                                      baseos                            315 k\r\n ncurses-base                                      noarch                            6.2-8.20210508.el9                               baseos                             61 k\r\n ncurses-libs                                      x86_64                            6.2-8.20210508.el9                               baseos                            323 k\r\n pcre2                                             x86_64                            10.40-2.el9                                      baseos                            236 k\r\n pcre2-syntax                                      noarch                            10.40-2.el9                                      baseos                            143 k\r\n setup                                             noarch                            2.13.7-7.el9                                     baseos                            140 k\r\n tzdata                                            noarch                            2023c-1.el9                                      baseos                            432 k\r\n\r\nTransaction Summary\r\n==============================================================================================================================================================================\r\nInstall  22 Packages\r\n\r\nTotal download size: 7.5 M\r\nInstalled size: 22 M\r\nIs this ok [y/N]: \r\n```\r\n\r\n`dnf` module fails because it tries to use repo files in host `/etc/yum.repos.d` not in the container path. When I copy the repo file to the host path, `dnf` module works fine. \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ndnf\n\n### Ansible Version\n\n```console\n# ansible --version\r\n\r\nansible [core 2.13.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /bin/ansible\r\n  python version = 3.9.14 (main, Nov  7 2022, 00:00:00) [GCC 11.3.1 20220421 (Red Hat 11.3.1-2)]\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nRHEL 9.1\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n    - ansible.builtin.file:\r\n        dest: \"{{ container_path }}{{ item }}\"\r\n        state: \"touch\"\r\n        owner: \"root\"\r\n        group: \"root\"\r\n        mode: \"0644\"\r\n      loop:\r\n        - \"/etc/dnf/dnf.conf\"\r\n        - \"/etc/yum.repos.d/almalinux-baseos.repo\"\r\n    - ansible.builtin.template:\r\n        src: \"dnf.conf.j2\"\r\n        dest: \"{{ container_path }}/etc/dnf/dnf.conf\"\r\n        owner: \"root\"\r\n        group: \"root\"\r\n        mode: \"0644\"\r\n    - ansible.builtin.copy:\r\n        src: \"repos/almalinux-baseos.repo\"\r\n        dest: \"{{ container_path }}/etc/yum.repos.d/almalinux-baseos.repo\"\r\n        owner: \"root\"\r\n        group: \"root\"\r\n        mode: \"0644\"\r\n    - ansible.builtin.dnf:\r\n        name:\r\n          - \"glibc-minimal-langpack\"\r\n          - \"coreutils-single\"\r\n        conf_file: \"{{ container_path }}/etc/dnf/dnf.conf\"\r\n        disablerepo: \"*\"\r\n        enablerepo: \"baseos\"\r\n        disable_plugin:\r\n          - \"subscription-manager\"\r\n        install_weak_deps: false\r\n        releasever: 9\r\n        state: \"latest\"\r\n        disable_gpg_check: true\r\n        installroot: \"{{ container_path }}\"\r\n\r\n```\r\n\n\n### Expected Results\n\n`dnf` module properly installs packages in `installroot` path using repo files inside `installroot`.\n\n### Actual Results\n\n```console\nfatal: [localhost]: FAILED! => {                                                                                                                                              \r\n    \"changed\": false,                                                                                                                                                         \r\n    \"failures\": [                                                                                                                                                             \r\n        \"No package glibc-minimal-langpack available.\",                                                                                                                       \r\n        \"No package coreutils-single available.\"                                                                                                                              \r\n    ],                                                                                                                                                                        \r\n    \"invocation\": {                                                                                                                                                           \r\n        \"module_args\": {                                                                                                                                                      \r\n            \"allow_downgrade\": false,                                                                                                                                         \r\n            \"allowerasing\": false,                                                                                                                                            \r\n            \"autoremove\": false,                                                                                                                                              \r\n            \"bugfix\": false,                                                                                                                                                  \r\n            \"cacheonly\": false,                                                                                                                                               \r\n            \"conf_file\": \"/var/lib/containers/storage/zfs/graph/cb1058f461f79c362c61ed60738366f0e7af91476d5cc61b06eeb41a5b097498/etc/dnf/dnf.conf\",                           \r\n            \"disable_excludes\": null,                                                                                                                                         \r\n            \"disable_gpg_check\": true,                                                                                                                                        \r\n            \"disable_plugin\": [\r\n                \"subscription-manager\"\r\n            ],\r\n            \"disablerepo\": [\r\n                \"*\"\r\n            ],\r\n            \"download_dir\": null,\r\n            \"download_only\": false,\r\n            \"enable_plugin\": [],\r\n            \"enablerepo\": [\r\n                \"baseos\"\r\n            ],\r\n            \"exclude\": [],\r\n            \"install_repoquery\": true,\r\n            \"install_weak_deps\": false,\r\n            \"installroot\": \"/var/lib/containers/storage/zfs/graph/cb1058f461f79c362c61ed60738366f0e7af91476d5cc61b06eeb41a5b097498\",\r\n            \"list\": null,\r\n            \"lock_timeout\": 30,\r\n            \"name\": [\r\n                \"glibc-minimal-langpack\",\r\n                \"coreutils-single\"\r\n            ],\r\n            \"nobest\": false,\r\n            \"releasever\": \"9\",\r\n            \"security\": false,\r\n            \"skip_broken\": false,\r\n            \"sslverify\": true,\r\n            \"state\": \"latest\",\r\n            \"update_cache\": false,\r\n            \"update_only\": false,\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"msg\": \"Failed to install some of the specified packages\",\r\n    \"rc\": 1,\r\n    \"results\": []\r\n}\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-26T11:18:01Z",
        "user": "mskarbek",
        "labels": [
            "module",
            "bug",
            "P3",
            "verified",
            "affects_2.13"
        ]
    },
    {
        "number": 80551,
        "title": "Allow for validate_argument_spec advanced data validation",
        "body": "### Summary\n\nvalidate_argument_spec is a great approach, but it is quite limiting in mostly being focused on defining variable type checks.\r\n\r\nIt would be nice to apply Jinja2 filters against the variables you are validating to verify variable logic.  Like using the regex filter or ipaddr filter.\r\n\r\nIf not you could also create fields to allow for regex validation and new types focused on network variable types like MACs address, IPv4s addresses, IPv6 addresses, IPv4 prefixes, and IPv6 prefixes.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nvalidate_argument_spec\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-18T13:46:52Z",
        "user": "ryanmerolle",
        "labels": [
            "waiting_on_contributor",
            "module",
            "has_pr",
            "feature",
            "affects_2.18"
        ]
    },
    {
        "number": 80532,
        "title": "WinRM winrshost processes hanging after playbook run finishes",
        "body": "### Summary\n\nAfter successful run _a lot_ (literally hundred or so) of `winrshost` processes are seen hanging in Windows Task Manager. Multiple plays of same playbook end up failing as WinRM server starts returning 500 or not even being reachable (likely exhaustion of some limit of processes).\r\n\r\nAuthentication is done using certificate and transport is HTTPS listener with self-signed certificate. Target nodes are Windows 11 22H2 and source host running ansible is Ubuntu 22.04.2. Playbook utilizes `become` using `runas` method to overcome issue with double-hop (become to same non-domain local user).\r\n\r\nI noticed the problem starts when running tasks imported from role (doesn't appear at top of playbook) and gets worse if there's `block` or loop (`with_items`) inside the role task(s). But that might be just coincidence. \r\n\r\nProblem seems to appear since upgrade to PPA version 12.14.4, to remediate I rolled back to OS version which is 2.10.8\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nwinrm\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.4]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/blami/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/blami/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.6 (main, Mar 10 2023, 10:55:28) [GCC 11.3.0] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n# EMPTY (no configuration changes)\n```\n\n\n### OS / Environment\n\nUbuntu 22.04.2 / Windows 11 22H2\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n  win_package:\r\n    product_id: \"{{ item }}\"\r\n    state: absent\r\n  with_items:\r\n    - Clipchamp.Clipchamp\r\n    - DolbyLaboratories.DolbyAccess\r\n    - Microsoft.3DBuilder\r\n    - Microsoft.WindowsAlarms\r\n    - Microsoft.windowscommunicationsapps\r\n    - Microsoft.Windows.Photos\r\n    - Microsoft.Todos\r\n    - Microsoft.ScreenSketch\r\n    - Microsoft.MicrosoftOfficeHub              # Get Office 365\r\n    - Microsoft.BingNews\r\n    - Microsoft.BingWeather\r\n    - Microsoft.BingFinance\r\n    - Microsoft.BingHealthAndFitness\r\n    - Microsoft.BingFoodAndDrink\r\n    - Microsoft.BingSports\r\n    - Microsoft.BingTravel\r\n    - Microsoft.WindowsMaps\r\n    - Microsoft.ZuneMusic                       # Groove Music\r\n    - Microsoft.ZuneVideo                       # Movies & TV\r\n    - Microsoft.YourPhone                       # Phone Companion\r\n    - Microsoft.WindowsPhone                    # Phone Companion\r\n    - Microsoft.OneConnect                      # Paid Wifi & Cellular\r\n    - Microsoft.Getstarted\r\n    - Microsoft.GetHelp\r\n    - Microsoft.MicrosoftSolitaireCollection\r\n    - Microsoft.OneDriveSync                    # OneDrive\r\n    - MicrosoftTeams\r\n    - Microsoft.549981C3F5F10                   # Cortana\r\n    - OneDriveSetup.exe                         # OneDrive\r\n```\r\n\n\n### Expected Results\n\nWhen role with block containing task above finishes and ansible playbook ends, I expect there are no ansible related winrshost processes hanging.\n\n### Actual Results\n\n```console\nThere is about 100 hanging winrshost processes visible in Task Manager.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-16T16:05:45Z",
        "user": "blami",
        "labels": [
            "windows",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.14"
        ]
    },
    {
        "number": 80531,
        "title": "Add option for argument_specs to hide variables in argument_spec_data that did not fail",
        "body": "### Summary\n\nAdding a `meta/argument_specs.yml` to a role is quite helpful for input validation, but it can get quite noisy for roles with quite a few variables in the argument_specs definition.  It would be nice to add to some sort of configuration variable (several possible options one where this could be set), allow you to display either:\r\n\r\n- full (current behavior of showing full argument_spec_data)\r\n- failed (only show the data for variables with errors)\r\n- none (do not show any argument_spec_data since the `argument_errors` and `msg` keys give relevant error details)\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nrole validate_argument_spec\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-16T15:34:02Z",
        "user": "ryanmerolle",
        "labels": [
            "module",
            "feature",
            "affects_2.16"
        ]
    },
    {
        "number": 80508,
        "title": "Extend ansible-doc to list and display information about collection extensions",
        "body": "### Summary\n\nWith the addition of EDA (event driven automation) content to collections, we are establishing a new mechanism for collections to add extensions to the collection structure.\r\n\r\nThe extensions will reside in an `extensions/<product_identifier>/` directory.\r\n\r\nUltimately `ansible-doc` will need the ability to list these extensions. The extensions will likely be exposed explicitly via a new meta file.\r\n\r\nTODO:\r\n\r\n- [ ] This is not ready for action yet\r\n- [ ] Architect the feature!\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nansible-doc\n\n### Additional Information\n\nN/A\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-12T19:05:44Z",
        "user": "sivel",
        "labels": [
            "feature",
            "on_hold",
            "affects_2.17"
        ]
    },
    {
        "number": 80483,
        "title": "`vars_files` depending on host vars no longer fails as of 2.15 with `error_on_undefined_vars` disabled",
        "body": "### Summary\n\nAs of https://github.com/ansible/ansible/pull/80171 `VariableManager.get_vars` is no longer responsible for calculating `delegated_vars`, and instead that is deferred to the `TaskExecutor` to call `VariableManager.get_delegated_vars_and_hostname` explicitly.  As a result `include_delegate_to` changed it's default to `False` since it no longer handles this functionality.\r\n\r\nHowever, when loading `vars_files` we have some logic that made a potential non-exact determination that the failure _**could**_ be related to not having a host or needing a delegated host:\r\n\r\nhttps://github.com/ansible/ansible/blob/62211097cb7627f92841cb4422bf2d19fb1c37be/lib/ansible/vars/manager.py#L370-L373\r\n\r\nI'm pretty sure that logic wasn't capable of making the real determination anyway that the missing var was due to missing host vars or facts, and it seems to have been more a guess.\r\n\r\nAs a result, we never fail, regardless of `error_on_undefined_vars` being disabled.\r\n\r\nThis code is also suspect, and I don't think capable of making a proper determination of whether it was host vars vs facts, or anything else pretty much:\r\n\r\nhttps://github.com/ansible/ansible/blob/62211097cb7627f92841cb4422bf2d19fb1c37be/lib/ansible/vars/manager.py#L374-L377\r\n\r\nHonestly, I'm kind of sad I went looking for this, I've waffled about ignoring it, but the fact that we have code that I don't think is actually capable of doing what it was intended to do bothers me.\r\n\r\nMaybe we just always allow it to skip (with a message), and never make it an error, and allow the fact that any vars from that file would be missing, and would cause a failure later.  Also, for the record I'm also advocating that we deprecate and remove `DEFAULT_UNDEFINED_VAR_BEHAVIOR`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlib/ansible/vars/manager.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n2.15\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEFAULT_UNDEFINED_VAR_BEHAVIOR(.../ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nN/A\n\n### Steps to Reproduce\n\n```\r\n- hosts: localhost\r\n  gather_facts: false\r\n  vars_files:\r\n    - '{{ foo }}'\r\n```\n\n### Expected Results\n\n```\r\nERROR! vars file {{ foo }} was not found\r\nCould not find file on the Ansible Controller.\r\nIf you are using a module and expect the file to exist on the remote, see the remote_src option\r\n```\n\n### Actual Results\n\n```console\nNo failure, and no indication of skipping loading the file.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-11T18:53:28Z",
        "user": "sivel",
        "labels": [
            "bug",
            "has_pr",
            "affects_2.16",
            "data_tagging",
            "affects_2.18"
        ]
    },
    {
        "number": 80393,
        "title": "register variable not available during ignore_errors evaluation",
        "body": "### Summary\n\nIn general, variables are evaluated in an `ignore_errors` expression.  [Ansible error handling documentation](https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_error_handling.html) has examples of the register result being used in `failed_when` and `changed_when`.  It seems inconsistent that register vars specifically are not available in `ignore_errors`, so I've filed this as a bug.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nignore_errors\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/REDACTED/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/REDACTED/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.12 (default, Sep 16 2021, 10:46:05) [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]\r\n  jinja version = 2.10.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_NOCOLOR(env: ANSIBLE_NOCOLOR) = True\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\n```\r\n$ uname -a\r\nLinux REDACTED_HOSTNAME 4.18.0-372.13.1.el8_6.x86_64 #1 SMP Mon Jun 6 15:05:22 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n$ cat /etc/redhat-release\r\nRed Hat Enterprise Linux release 8.6 (Ootpa)\r\n```\n\n### Steps to Reproduce\n\nplaybook:\r\n```\r\n---\r\n- hosts: all:localhost\r\n  name: test register variable use in ignore_errors conditional\r\n  gather_facts: false\r\n  vars:\r\n    - ignore_the_error: True\r\n  tasks:\r\n    - name: sample command output\r\n      shell: \"echo failed ; exit 254\"\r\n      register: sample_command_result\r\n      ignore_errors: \"{{ ignore_the_error and sample_command_result.rc == 254 and 'ail' in sample_command_result.stdout }}\"\r\n#      ignore_errors: \"{{ ignore_the_error }}\"\r\n```\r\ncommand:\r\n```\r\nansible-playbook test_register_ignore_errors.yml\r\n```\r\n\n\n### Expected Results\n\n```\r\nPLAY [test register variable use in ignore_errors conditional] *******************************************************************************************************************************\r\n\r\nTASK [sample command output] *****************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"echo failed ; exit 254\", \"delta\": \"0:00:00.004769\", \"end\": \"2023-04-04 13:57:36.033340\", \"msg\": \"non-zero return code\", \"rc\": 254, \"start\": \"2023-04-04 13:57:36.028571\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"failed\", \"stdout_lines\": [\"failed\"]}\r\n...ignoring\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=1\r\n```\r\n\n\n### Actual Results\n\n```console\nPLAY [test register variable use in ignore_errors conditional] *******************************************************************************************************************************\r\n\r\nTASK [sample command output] *****************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"msg\": \"The field 'ignore_errors' has an invalid value, which includes an undefined variable. The error was: 'sample_command_result' is undefined\\n\\nThe error appears to be in '/home/REDACTED/git/test_register_ignore_errors.yml': line 8, column 7, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n  tasks:\\n    - name: sample command output\\n      ^ here\\n\"}\r\n...ignoring\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=1\n```\n\n\n### Code of Conduct\n\n- [x] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-04-04T14:02:53Z",
        "user": "dchsueh",
        "labels": [
            "bug",
            "P3",
            "verified",
            "affects_2.12"
        ]
    },
    {
        "number": 80374,
        "title": "In Ansible 2.14, loops with action: module: result in \"ERROR! 'item' is undefined\"",
        "body": "### Summary\n\nI have a cluster of nodes, on which a service is running, which I need to restart and then check its port aliveness.  I want to do this _serially_, so as to ensure that only one node of the cluster is not ready at a given time. This occurs in the handler of a (much larger) play, so I can't mark the whole play serial.\r\n\r\nFor Ansible <=6.7.0 the example works well, however for Ansible >= 7.0.0 the loop is apparently not evaluated, and you just get the error: `ERROR! 'item' is undefined. 'item' is undefined`. \n\n### Issue Type\n\nBug Report\n\n### Component Name\n\naction\n\n### Ansible Version\n\n```console\nansible [core 2.14.4]\r\n  config file = /mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg\r\n  configured module search path = ['/home/dseeley/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/dseeley/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /mnt/c/Users/dseeley/Documents/src/opensearch-ansible/collections:/home/dseeley/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/dseeley/.local/bin/ansible\r\n  python version = 3.10.6 (main, Mar 10 2023, 10:55:28) [GCC 11.3.0] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nANSIBLE_PIPELINING(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\r\nCALLBACKS_ENABLED(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = ['ansible.posix.profile_tasks']\r\nCOLLECTIONS_PATHS(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = ['/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/collections', '/home/dseeley/.ansible/collections', '/usr/share/ansible/collections']\r\nCONFIG_FILE() = /mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg\r\nDEFAULT_FORCE_HANDLERS(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\r\nDEFAULT_FORKS(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = 50\r\nDEFAULT_ROLES_PATH(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = ['/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = /mnt/c/Users/dseeley/Documents/src/opensearch-ansible/.vaultpass-client.py\r\nHOST_KEY_CHECKING(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = auto\r\nTRANSFORM_INVALID_GROUP_CHARS(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = ignore\r\n\r\nCONNECTION:\r\n==========\r\n\r\nlocal:\r\n_____\r\npipelining(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = False\r\nssh_args(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = -o 'UserKnownHostsFile=/dev/null' -o 'ControlMaster=auto' -o 'ControlPersist=60s'\r\n\r\npsrp:\r\n____\r\npipelining(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\r\n\r\nssh:\r\n___\r\ncontrol_path_dir(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = /tmp/.ansible/cp\r\nhost_key_checking(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = False\r\npipelining(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\r\nreconnection_retries(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = 10\r\nssh_args(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = -o 'UserKnownHostsFile=/dev/null' -o 'ControlMaster=auto' -o 'ControlPersist=60s'\r\n\r\nwinrm:\r\n_____\r\npipelining(/mnt/c/Users/dseeley/Documents/src/opensearch-ansible/ansible.cfg) = True\n```\n\n\n### OS / Environment\n\nUbuntu 22.04\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: test handler\r\n  hosts: data\r\n  gather_facts: false\r\n  tasks:\r\n    - command: /bin/true\r\n      notify: \"restart opensearch wait and for port to be open\"\r\n\r\n  handlers:\r\n    - name: \"restart opensearch wait and for port to be open\"\r\n      become: yes\r\n      action:\r\n        module: '{{ item.module }}'\r\n      args: '{{ item.args }}'\r\n      loop:\r\n        - module: service\r\n          args:\r\n            name: opensearch\r\n            state: restarted\r\n            enabled: yes\r\n        - module: wait_for\r\n          args:\r\n            host: localhost\r\n            port: 9200\r\n            timeout: 300\r\n      throttle: 1\r\n```\r\n\n\n### Expected Results\n\n```text\r\nchanged: [opensearch-data-a0] => (item={'module': 'service', 'args': {'name': 'opensearch', 'state': 'restarted', 'enabled': True}})\r\nok: [opensearch-data-a0] => (item={'module': 'wait_for', 'args': {'host': 'localhost', 'port': 9200, 'timeout': 300}})\r\nchanged: [opensearch-data-b0] => (item={'module': 'service', 'args': {'name': 'opensearch', 'state': 'restarted', 'enabled': True}})\r\nok: [opensearch-data-b0] => (item={'module': 'wait_for', 'args': {'host': 'localhost', 'port': 9200, 'timeout': 300}})\r\nchanged: [opensearch-data-c0] => (item={'module': 'service', 'args': {'name': 'opensearch', 'state': 'restarted', 'enabled': True}})\r\nok: [opensearch-data-c0] => (item={'module': 'wait_for', 'args': {'host': 'localhost', 'port': 9200, 'timeout': 300}})\r\n```\n\n### Actual Results\n\n```console\nERROR! 'item' is undefined. 'item' is undefined\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-31T11:44:16Z",
        "user": "dseeley",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80333,
        "title": "More useful var templating errors",
        "body": "### Summary\r\n\r\nWhen a templated var fails due to error in template, the error message is unhelpful and hard to read. It consists of:\r\n\r\n- A message `An unhandled exception occured while templating`\r\n- Literal representation of template\r\n- The actual error message, i.e. `Error was a class 'ansible.errors.AnsibleError'>, original message: template error while templating string: expected an expression, got 'end of statement block. String:`\r\n- Another literal representation of template.\r\n\r\nNo indication where in the template (row, column) the error has occured. Also it is hard hard to find the actual template error between two redundant printings of the same template.\r\n\r\nThe feature request is: show the actual template error text, then info on location of the error, and only then a single printing of the template, maybe with the error position marked as it is with yaml errors.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\ntemplate\r\n\r\n### Additional Information\r\n\r\nCurrent error message:\r\n```\r\nfatal: [hostname]: FAILED! => \r\n  msg: |-\r\n    An unhandled exception occurred while templating '{# lots #}\r\n    {# and lots #}\r\n    {# and lots #)\r\n    {# and lots #}\r\n    {# and lots of template text #}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: template error while templating string: Unexpected ')', expected '}'. String: {# lots #}\r\n    {# and lots #}\r\n    {# and lots #)\r\n    {# and lots #}\r\n    {# and lots of template text #}\r\n```\r\nSuggested:\r\n```\r\nfatal: [hostname]: FAILED! => \r\n  msg: |-\r\n    template error while templating string: Unexpected ')', expected '}'. Line 3, Col 14, String: \r\n    {# lots #}\r\n    {# and lots #}\r\n    {# and lots #)\r\n                 ^ here\r\n    {# and lots #}\r\n    {# and lots of template text #}\r\n```\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-28T10:15:00Z",
        "user": "Vladimir-csp",
        "labels": [
            "module",
            "feature",
            "affects_2.15",
            "data_tagging"
        ]
    },
    {
        "number": 80269,
        "title": "template validation fails because of SELinux errors",
        "body": "### Summary\r\n\r\nI am using the [nsenter connection plugin](https://docs.ansible.com/ansible/latest/collections/community/docker/nsenter_connection.html) to run Ansible in a privileged podman container against the local host.\r\nI want to use a template to write a /etc/sysconfig/iptables file, and use `/usr/sbin/iptables-restore` for template validation to avoid accidentally writing invalid iptables rules. This causes a SELinux violation, I believe because the template validation is performed on a file in `/root/.ansible` with SELinux label \"unconfined_u:object_r:admin_home_t:s0\".  It seems like the correct SELinux label would be applied only after the template validation, when the file is placed in /etc/sysconfig/iptables (or perhaps more accurately, the existing label of the destination file would be used and Ansible would not change it).\r\n\r\nIt seems to me that Ansible should perform the template validation on the source file using the SELinux labels that the destination file would have, to avoid general problems with validation commands being denied by SELinux.\r\n\r\nUpdate: the default SELinux rules block it due to the SELinux type of the process in the container, not the type of the template file. Nevertheless SELinux may block different things for different reasons and a handle to adjust the SELinux label of the template file before validation rather than after could be a versatile way to avoid such issues, and in general it may be possible to avoid a SELinux denial by either changing the process type or file type.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.template\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.12.10]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.10 (main, Feb  8 2023, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n$ rpm -q ansible\r\nansible-5.9.0-1.fc36.noarch\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nFresh CentOS8 Stream VM with latest updates as of Mar 21.\r\nThen in a Fedora 36 podman pod, I install and run Ansible.\r\n\r\nPlaybook in the pod is play.yml :\r\n```\r\n- hosts: testhost\r\n  connection: community.docker.nsenter\r\n  tasks:\r\n    - name: Test\r\n      template:\r\n        src: template.j2\r\n        dest: /etc/sysconfig/iptables\r\n        owner: \"root\"\r\n        group: \"root\"\r\n        mode: \"0600\"\r\n        validate: \"/usr/sbin/iptables-restore --test %s\"\r\n#     Setting seuser, setype don't help\r\n#       seuser: system_u\r\n#       setype: etc_t\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nOn CentOS8 Stream:\r\n```\r\nsudo dnf -y install podman\r\nsudo podman run --pull=newer --rm -it --pid=host --privileged fedora:36\r\n# inside the pod\r\ndnf -y install ansible\r\necho testhost >> /etc/ansible/hosts\r\necho whatevs >> template.j2\r\nansible-playbook play.yml --diff -vvv\r\n```\r\n\r\n### Expected Results\r\n\r\nThe source file that the template validation command is executed on should have an appropriate SELinux label (for example that of the destination file) , allowing the template validation command to run on it just as it would on the destination file. \r\n\r\nFailing that I should be able to control the SELinux label of the source file _before_ the validation command is run on it using e.g. the `setype` option of the template module, but this does not work either. It only seems to be applied to the final destination file after template validation.\r\n\r\n### Actual Results\r\n\r\n```console\r\nansible-playbook [core 2.12.10]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.10.10 (main, Feb  8 2023, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: play.yml **********************************************************************************************************************************************************\r\n1 plays in play.yml\r\n\r\nPLAY [testhost] *************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************************************************\r\ntask path: /play.yml:1\r\n<testhost> ESTABLISH NSENTER CONNECTION FOR USER: root\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'echo ~ && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198 `\" && echo ansible-tmp-1679434952.9957507-7775-27679751588198=\"` echo /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198 `\" ) && sleep 0'\r\n<testhost> Attempting python interpreter discovery\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'python3.10'\"'\"'; command -v '\"'\"'python3.9'\"'\"'; command -v '\"'\"'python3.8'\"'\"'; command -v '\"'\"'python3.7'\"'\"'; command -v '\"'\"'python3.6'\"'\"'; command -v '\"'\"'python3.5'\"'\"'; command -v '\"'\"'/usr/bin/python3'\"'\"'; command -v '\"'\"'/usr/libexec/platform-python'\"'\"'; command -v '\"'\"'python2.7'\"'\"'; command -v '\"'\"'python2.6'\"'\"'; command -v '\"'\"'/usr/bin/python'\"'\"'; command -v '\"'\"'python'\"'\"'; echo ENDFOUND && sleep 0'\r\n<testhost> Python interpreter discovery fallback (pipelining support required for extended interpreter discovery)\r\nUsing module file /usr/lib/python3.10/site-packages/ansible/modules/setup.py\r\n<testhost> PUT /root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmpauy31lb1 to /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/AnsiballZ_setup.py\r\n<testhost> EXEC [b'nsenter', b'--ipc', b'--mount', b'--net', b'--pid', b'--uts', b'--preserve-credentials', b'--target=1', b'--', b'tee', b'/root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/AnsiballZ_setup.py']\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/ /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/AnsiballZ_setup.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '/usr/libexec/platform-python /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/AnsiballZ_setup.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1679434952.9957507-7775-27679751588198/ > /dev/null 2>&1 && sleep 0'\r\n[WARNING]: Platform linux on host testhost is using the discovered Python interpreter at /usr/libexec/platform-python, but future installation of another Python interpreter\r\ncould change the meaning of that path. See https://docs.ansible.com/ansible-core/2.12/reference_appendices/interpreter_discovery.html for more information.\r\nok: [testhost]\r\nMETA: ran handlers\r\n\r\nTASK [Test] *****************************************************************************************************************************************************************\r\ntask path: /play.yml:4\r\n<testhost> ESTABLISH NSENTER CONNECTION FOR USER: root\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'echo ~ && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336 `\" && echo ansible-tmp-1679434955.1837838-7840-193608485627336=\"` echo /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.10/site-packages/ansible/modules/stat.py\r\n<testhost> PUT /root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmpm6gi05ja to /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_stat.py\r\n<testhost> EXEC [b'nsenter', b'--ipc', b'--mount', b'--net', b'--pid', b'--uts', b'--preserve-credentials', b'--target=1', b'--', b'tee', b'/root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_stat.py']\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/ /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_stat.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '/usr/libexec/platform-python /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_stat.py && sleep 0'\r\nUsing module file /usr/lib/python3.10/site-packages/ansible/modules/file.py\r\n<testhost> PUT /root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmp7bbxu2rc to /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_file.py\r\n<testhost> EXEC [b'nsenter', b'--ipc', b'--mount', b'--net', b'--pid', b'--uts', b'--preserve-credentials', b'--target=1', b'--', b'tee', b'/root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_file.py']\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/ /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_file.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '/usr/libexec/platform-python /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_file.py && sleep 0'\r\n<testhost> PUT /root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmpzos71xfv/template.j2 to /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source\r\n<testhost> EXEC [b'nsenter', b'--ipc', b'--mount', b'--net', b'--pid', b'--uts', b'--preserve-credentials', b'--target=1', b'--', b'tee', b'/root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source']\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/ /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source && sleep 0'\r\nUsing module file /usr/lib/python3.10/site-packages/ansible/modules/copy.py\r\n<testhost> PUT /root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmpdjr6hgxy to /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_copy.py\r\n<testhost> EXEC [b'nsenter', b'--ipc', b'--mount', b'--net', b'--pid', b'--uts', b'--preserve-credentials', b'--target=1', b'--', b'tee', b'/root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_copy.py']\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/ /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_copy.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c '/usr/libexec/platform-python /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/AnsiballZ_copy.py && sleep 0'\r\n<testhost> EXEC nsenter --ipc --mount --net --pid --uts --preserve-credentials --target=1 -- /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [testhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"checksum\": \"c30b59e5e5af2cf5840483b7ed8932d1bb1a44e3\",\r\n    \"diff\": [\r\n        {\r\n            \"after\": \"whatevs\\n\",\r\n            \"after_header\": \"/root/.ansible/tmp/ansible-local-7771jjwu2f_q/tmpzos71xfv/template.j2\",\r\n            \"before\": \"\"\r\n        }\r\n    ],\r\n    \"exit_status\": 1,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_original_basename\": \"template.j2\",\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": \"c30b59e5e5af2cf5840483b7ed8932d1bb1a44e3\",\r\n            \"content\": null,\r\n            \"dest\": \"/etc/sysconfig/iptables\",\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"force\": true,\r\n            \"group\": \"root\",\r\n            \"local_follow\": null,\r\n            \"mode\": \"0600\",\r\n            \"owner\": \"root\",\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": \"/root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source\",\r\n            \"unsafe_writes\": false,\r\n            \"validate\": \"/usr/sbin/iptables-restore --test %s\"\r\n        }\r\n    },\r\n    \"msg\": \"failed to validate\",\r\n    \"stderr\": \"Can't open /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source: Permission denied\\n\",\r\n    \"stderr_lines\": [\r\n        \"Can't open /root/.ansible/tmp/ansible-tmp-1679434955.1837838-7840-193608485627336/source: Permission denied\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************\r\ntesthost                   : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-21T21:44:18Z",
        "user": "rptaylor",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 80233,
        "title": "ansible.builtin.git ignores become_user when executing without an inventory",
        "body": "### Summary\r\n\r\nThe git submodule launches as root when using a local connection (no inventory defined), ignoring become_user. \r\n\r\nThis leads to the module failing.\r\n\r\nThe module runs fine with an inventory when initiating an SSH connection.\r\n\r\nLeft side of the screenshot is with the supplied inventory through SSH.\r\n\r\nRight side is when inventory is removed and same playbook is ran.\r\n\r\n![image](https://user-images.githubusercontent.com/1641362/225392643-58574ba3-30cc-4b35-9010-61f1e4460f04.png)\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ngit\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/c0rn3j/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/c0rn3j/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.10 (main, Mar  5 2023, 22:26:53) [GCC 12.2.1 20230201] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nArch Linux\r\n\r\n### Steps to Reproduce\r\n\r\n/etc/ansible/hosts\r\n```\r\n all:\r\n   hosts:\r\n   children:\r\n     lxd:\r\n       hosts:\r\n         localhost:\r\n```\r\nProblematic task:\r\n```yaml\r\n- name: Install/update lxd-completion-zsh for {{ username }}\r\n  become: true\r\n  become_user: '{{ username }}'\r\n  ansible.builtin.git:\r\n    repo: https://github.com/endaaman/lxd-completion-zsh\r\n    dest: /home/{{ username }}/.oh-my-zsh/custom/plugins/lxd-completion-zsh\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nModule launches as user specified in become_user\r\n\r\n### Actual Results\r\n\r\nModule only launches as the specified user when an inventory is defined and SSH connection is used.\r\n```console\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"Failed to set a new url https://github.com/endaaman/lxd-completion-zsh for origin:  fatal: detected dubious ownership in repository at '/home/c0rn3j/.oh-my-zsh/custom/plugins/lxd-completion-zsh'\\nTo add an exception for this directory, call:\\n\\n\\tgit config --global --add safe.directory /home/c0rn3j/.oh-my-zsh/custom/plugins/lxd-completion-zsh\\n\"}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-15T17:34:03Z",
        "user": "C0rn3j",
        "labels": [
            "module",
            "bug",
            "affects_2.14"
        ]
    },
    {
        "number": 80232,
        "title": "Using block scoped directives in templates is slow",
        "body": "### Summary\r\n\r\nI never took the chance to upgrade from ansible 2.9.6 because newer versions would take so long to execute my playbooks that it wasn't just possible.\r\n\r\nI tried to hunt down the origin of the problem but I got caught into the \"slow access to hostvars from other hosts\" problem that should have been fixed but it was still slow for me.\r\n\r\nNow I seem to have found the problem : using the block scoped directive takes forever to render. Seek below for a test case.\r\n\r\nSomewhere in the 2.9 series (e.g. 2.9.27), and subsequent releases this takes minutes to render whereas 2.9.6 takes mere seconds. \r\n\r\nNot sure if this is Ansible or Jinja-specific, I don't know how to test since it seems to appear when looping over many hosts.\r\n\r\nJust removing the block scoped directives makes rendering fast again but I found that feature interesting. I can live without it for some time but templates get more cumbersome because without template inheritance stuff must be repeated.\r\n\r\nThank you\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\njinja template\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.7]\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.10 (main, Feb  9 2023, 02:08:34) [GCC 11.2.1 20220219]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n$ cat /etc/os-release \r\nNAME=\"Alpine Linux\"\r\nID=alpine\r\nVERSION_ID=3.16.4\r\nPRETTY_NAME=\"Alpine Linux v3.16\"\r\nHOME_URL=\"https://alpinelinux.org/\"\r\nBUG_REPORT_URL=\"https://gitlab.alpinelinux.org/alpine/aports/-/issues\"\r\n\r\n\r\n### Steps to Reproduce\r\n\r\nuse the following playbook:\r\n\r\n```\r\n\r\n- hosts: all\r\n  gather_facts: no\r\n  tasks:\r\n  - name: template out lots of stuff from a loop in a scoped block\r\n    template:\r\n      src: test_block_scoped.j2\r\n      dest: /tmp/out\r\n    delegate_to: localhost\r\n    run_once: yes\r\n    vars:\r\n      slurm_nodes_hosts: \"{{ ansible_play_hosts_all }}\"\r\n```\r\n\r\nwith the template : \r\n```\r\n\r\n{% for host in slurm_nodes_hosts %}\r\n{% set node_name = hostvars[host][\"slurm_nodeinfo_name\"]|default(host, true) -%}\r\n{% if \"slurm_nodeinfo_mem\" in hostvars[host] %}\r\n{% set node_mem = hostvars[host][\"slurm_nodeinfo_mem\"] -%}\r\n{% set node_cpu = hostvars[host][\"slurm_nodeinfo_cpu\"] -%}\r\n{% set node_core = hostvars[host][\"slurm_nodeinfo_core\"] -%}\r\n{% set node_threads = hostvars[host][\"slurm_nodeinfo_threads\"] -%}\r\n{% block node scoped %}\r\nNodeName={{ node_name }} RealMemory={{ node_mem }} Sockets={{ node_cpu }} CoresPerSocket={{ node_core * node_threads }} ThreadsPerCore=1 State=UNKNOWN\r\n{% endblock %}\r\n{% else%}\r\n# WARNING: Node {{ host }} is listed but no data is found ! Check hostvars !\r\n{% endif %}\r\n{% endfor %}\r\n```\r\n\r\nrun the playbook over lots of dummy hosts. I generated 100 fake hostvars files with the following python  script : \r\n```\r\n\r\nimport random\r\n\r\nfor i in range(100):\r\n  with open('n'+str(i), 'w') as f:\r\n    f.write(\"slurm_nodeinfo_name: n\"+str(i)+'\\n')\r\n    f.write(\"slurm_nodeinfo_mem: \"+str(random.randint(1000,8000))+'\\n')\r\n    f.write(\"slurm_nodeinfo_cpu: \"+str(random.randint(1,4))+'\\n')\r\n    f.write(\"slurm_nodeinfo_core: \"+str(random.randint(1,16))+'\\n')\r\n    f.write(\"slurm_nodeinfo_threads: \"+str(random.randint(1,4))+'\\n')\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nRendering should take seconds, not minutes\r\n\r\n### Actual Results\r\n\r\n```console\r\nThe templates are still rendered correctly but it's too slow.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-15T17:16:24Z",
        "user": "pshunter",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.13",
            "data_tagging"
        ]
    },
    {
        "number": 80197,
        "title": "Fact \"ansible_virtualization_type\" incorrect on Microsoft laptops",
        "body": "### Summary\r\n\r\nAnsible uses [/sys/devices/virtual/dmi/id/sys_vendor](https://github.com/ansible/ansible/blob/7ce951ff48baaf53feab1ca09930281706813c70/lib/ansible/module_utils/facts/virtual/linux.py#L152) to determine if the system is virtualized, but [the test](https://github.com/ansible/ansible/blob/7ce951ff48baaf53feab1ca09930281706813c70/lib/ansible/module_utils/facts/virtual/linux.py#L225) incorrectly assumes that \"Microsoft Corporation\" always means VirtualPC.\r\n\r\nThe facts *ansible_virtualization_tech_guest* and *ansible_virtualization_type* are also incorrect on this laptop.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/module_utils/facts/virtual/linux.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.3]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 22.04\r\n\r\n```\r\n$ cat /sys/devices/virtual/dmi/id/sys_vendor\r\nMicrosoft Corporation\r\n\r\n$ cat /sys/devices/virtual/dmi/id/product_family\r\nSurface\r\n\r\n$ sudo dmidecode | grep -B1 \"Microsoft\\|Surface\"\r\nBIOS Information\r\n        Vendor: Microsoft Corporation\r\n--\r\nSystem Information\r\n        Manufacturer: Microsoft Corporation\r\n        Product Name: Surface Laptop Go\r\n--\r\n        Wake-up Type: Unknown\r\n        SKU Number: Surface_Laptop_Go_1943\r\n        Family: Surface\r\n--\r\nChassis Information\r\n        Manufacturer: Microsoft Corporation\r\n--\r\nBase Board Information\r\n        Manufacturer: Microsoft Corporation\r\n        Product Name: Surface Laptop Go\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n$ ansible -i localhost, all -m setup | grep -A1 ansible_virtualization\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nAnsible should report a physical machine, not virtual.\r\n\r\n### Actual Results\r\n\r\n```console\r\n\"ansible_virtualization_role\": \"guest\",\r\n\"ansible_virtualization_tech_guest\": [\r\n    \"VirtualPC\"\r\n],\r\n\"ansible_virtualization_tech_host\": [\r\n    \"kvm\"\r\n],\r\n\"ansible_virtualization_type\": \"VirtualPC\",\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-12T17:09:54Z",
        "user": "sbivol",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 80177,
        "title": "`retry_with_delays_and_condition` could be extended to accept a display callback",
        "body": "### Summary\r\n\r\nCurrently `retry_with_delays_and_condition` does not display anything in regards to retries, this is largely because the code is implemented in `module_utils`, and has no access to `Display`.  Potentially the decorator could accept a callable that would accept a message.  It would then be up to whatever callable is provided to decide what to do with it.\r\n\r\nA module could just capture it, or in the case of controller code, we could pass in `display.vvv` or something.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nlib/ansible/module_utils/api.py\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-03-08T21:59:53Z",
        "user": "sivel",
        "labels": [
            "feature",
            "affects_2.17"
        ]
    },
    {
        "number": 80104,
        "title": "ansible-core: future installation of another Python interpreter could change the meaning of that path",
        "body": "### Summary\r\n\r\nAnsible is giving the following warning evening though I have python interpreter already defined in the group vars in the inventory file:\r\n\r\n```\r\n[WARNING]: Platform linux on host webserver01 is using the discovered Python interpreter at /usr/bin/python3.10, but future installation of another Python interpreter could\r\nchange the meaning of that path. See https://docs.ansible.com/ansible-core/2.13/reference_appendices/interpreter_discovery.html for more information.\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-core\r\n\r\n### Ansible Version\r\n\r\n```console\r\n# pip3 show ansible\r\nName: ansible\r\nVersion: 6.6.0\r\nSummary: Radically simple IT automation\r\nHome-page: https://ansible.com/\r\nAuthor: Ansible, Inc.\r\nAuthor-email: info@ansible.com\r\nLicense: GPLv3+\r\nLocation: /usr/lib/python3.10/site-packages\r\nRequires: ansible-core\r\nRequired-by:\r\n\r\n# pip3 show ansible-core\r\nName: ansible-core\r\nVersion: 2.13.6\r\nSummary: Radically simple IT automation\r\nHome-page: https://ansible.com/\r\nAuthor: Ansible, Inc.\r\nAuthor-email: info@ansible.com\r\nLicense: GPLv3+\r\nLocation: /usr/lib/python3.10/site-packages\r\nRequires: cryptography, jinja2, packaging, PyYAML, resolvelib\r\nRequired-by: ansible\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nNo specific ansible configuration\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAlpine Linux 3.17\r\nUbuntu Server 22.04 LTS\r\n\r\n\r\n### Steps to Reproduce\r\n\r\nTry to run any ansible play that will use local connection to talk to a rhel7/8/9 guest vm.\r\n\r\n```\r\n- hosts: webserver\r\n  connection: local\r\n  tags: deploy\r\n  gather_facts: no\r\n  tasks:\r\n    - name: Install required packages for http\r\n      include_role:\r\n        name: packageinstall\r\n```\r\n\r\n- inventory file\r\n\r\n```\r\n[webserver]\r\nxxx.xxx.xxx.xxx\r\n\r\n# Node Groups\r\n[nodes:children]\r\nwebserver\r\n\r\n[nodes:vars]\r\nansible_connection=ssh\r\nansible_user=root\r\nansible_password=XXXXXXXX\r\nansible_python_interpreter=/usr/bin/python3\r\nansible_ssh_common_args='-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'\r\n```\r\n\r\n### Expected Results\r\n\r\nPlay should work without any warning as inventory is already having the **ansible_python_interpreter=/usr/bin/python3** entry as required.\r\n\r\nIn the ansible provision server already have the path set for python as well:\r\n\r\n```\r\nbash-5.1# python\r\npython      python3     python3.10\r\nbash-5.1# which python\r\n/usr/bin/python\r\nbash-5.1# which python3\r\n/usr/bin/python3\r\nbash-5.1# which python3.10\r\n/usr/bin/python3.10\r\nbash-5.1#\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n[WARNING]: Platform linux on host webserver01 is using the discovered Python interpreter at /usr/bin/python3.10, but future installation of another Python interpreter could\r\nchange the meaning of that path. See https://docs.ansible.com/ansible-core/2.13/reference_appendices/interpreter_discovery.html for more information.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-02-28T06:20:13Z",
        "user": "pingtouskar",
        "labels": [
            "bug",
            "affects_2.15"
        ]
    },
    {
        "number": 79995,
        "title": "Inventories should be manipulable as normal after deserialization  ",
        "body": "### Summary\n\nWhen I am writing an inventory module and try to use the remove_host function the host was still being left behind.\r\nI traced the problem and found that because of they way I need to parse my inventories I go through the serialization process and when the Group object is deserialized the self.host_names has the incorrect value:\r\nIt should have a set of strings (ie a set of all the host_names) \r\nHowever\r\nIt has a set of host objects\r\n\r\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/inventory/group.py#L164 is\r\n            self._hosts = set(self.hosts)\r\nand I believe should be \r\n            self._hosts = set(i.name for i in self.hosts)\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nlib/ansible/inventory/group.py\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\nAfter a returned inventory parse() it would be nice to then be able to remove hosts (including from groups) to better control access\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-02-14T15:35:02Z",
        "user": "RynLevin",
        "labels": [
            "inventory",
            "has_pr",
            "feature",
            "needs_verified",
            "affects_2.15"
        ]
    },
    {
        "number": 79901,
        "title": "apt module safe upgrade mode should not cause installation of new packages",
        "body": "### Summary\r\n\r\nWhen using safe upgrade or any non dist upgrade mode, my expectation is the only packages which are installed are updated, no updates are install which will cause new packages to be added to the system.\r\n\r\nThis is the default behaviour of apt-get upgrade, aptitude safe-upgrade by default WILL install new packages unless the --no-new-installs flag is provided, it seems in attempt to make the apt-get version of this command consistent with aptitude, the --with-new-pkgs flag was added to apt-get upgrade commands unless full/dist upgrade is used.\r\n\r\nIn my opinion, this is not the default behaviour you want, I appreciate some may want new packages to be installed when doing a \"safe\" upgrade but it is not particularly safe as a default as this can and do go wrong in this mode, such as getting into situations where you unmet dependancies and in-complete package install/configurations.\r\n\r\nI propose you remove --with-new-pkgs flag from apt-get upgrade and add --no-new-installs to aptitude safe-upgrade by default, potentially adding a new argument into the module which maintains the current behaviour optionally.\r\n\r\n### Issue Type\r\n\r\nFeature request\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.2]\r\n  python version = 3.9.15 (main, Oct 11 2022, 22:27:25) [Clang 14.0.0 (clang-1400.0.29.102)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEPRECATION_WARNINGS= False\r\nINTERPRETER_PYTHON = auto_legacy_silent\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n    - name: Install updates\r\n      ansible.builtin.apt:\r\n        update_cache: true\r\n        upgrade: safe\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nWhen using apt-get upgrade, i expect it to be run without --with-new-pkgs and when using aptitude safe-upgrade, i expect it to be run with --no-new-installs.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [Install updates] *********************************************************************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"'/usr/bin/apt-get upgrade --with-new-pkgs ' failed: E: Sub-process /usr/bin/dpkg returned an error code (1)\\n\", \"rc\": 100, \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nCalculating upgrade...\\nThe following NEW packages will be installed\\n  python3-debconf python3.6-distutils python3.6-lib2to3\\nThe following packages have been kept back:\\n  xe-guest-utilities\\nThe following packages will be upgraded:\\n  apt apt-transport-https apt-utils base-files cloud-init command-not-found\\n  distro-info-data grub-common grub-pc grub-pc-bin grub2-common\\n  initramfs-tools initramfs-tools-bin initramfs-tools-core iptables-persistent\\n  kmod language-pack-en language-pack-en-base language-pack-gnome-en\\n  language-pack-gnome-en-base libapt-pkg6.0 libasound2 libasound2-data\\n  libc-bin libc-dev-bin libc6 libc6-dev libkeyutils1 libkmod2 libnetplan0\\n  libnl-3-200 libnl-genl-3-200 libnss-systemd libpam-systemd libpq5\\n  libpython3.6 libpython3.6-dev libpython3.6-minimal libpython3.6-stdlib\\n  libsystemd0 libudev1 linux-firmware locales netfilter-persistent netplan.io\\n  openssh-client openssh-server openssh-sftp-server python-apt-common\\n  python3-apt python3-commandnotfound python3-distupgrade\\n  python3-software-properties python3-update-manager python3.6 python3.6-dev\\n  python3.6-minimal python3.6-venv software-properties-common systemd\\n  systemd-coredump systemd-sysv ubuntu-advantage-tools\\n  ubuntu-release-upgrader-core udev ufw unattended-upgrades\\n  update-manager-core wget\\n69 to upgrade, 3 to newly install, 0 to remove and 1 not to upgrade.\\nNeed to get 169 MB of archives.\\nAfter this operation, 92.4 MB of additional disk space will be used.\\nGet:1 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc6-dev amd64 2.31-0ubuntu9.9 [2519 kB]\\nGet:2 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-dev amd64 3.6.15-1+focal3 [501 kB]\\nGet:3 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-dev amd64 3.6.15-1+focal3 [3433 kB]\\nGet:4 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc-dev-bin amd64 2.31-0ubuntu9.9 [71.8 kB]\\nGet:5 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc6 amd64 2.31-0ubuntu9.9 [2722 kB]\\nGet:6 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6 amd64 3.6.15-1+focal3 [1396 kB]\\nGet:7 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-venv amd64 3.6.15-1+focal3 [1704 kB]\\nGet:8 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 base-files amd64 11ubuntu5.6 [60.4 kB]\\nGet:9 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 locales all 2.31-0ubuntu9.9 [3869 kB]\\nGet:10 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6 amd64 3.6.15-1+focal3 [248 kB]\\nGet:11 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-stdlib amd64 3.6.15-1+focal3 [1758 kB]\\nGet:12 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc-bin amd64 2.31-0ubuntu9.9 [633 kB]\\nGet:13 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 systemd-sysv amd64 245.4-4ubuntu3.19 [10.3 kB]\\nGet:14 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-minimal amd64 3.6.15-1+focal3 [1718 kB]\\nGet:15 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 systemd-coredump amd64 245.4-4ubuntu3.19 [43.6 kB]\\nGet:16 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnss-systemd amd64 245.4-4ubuntu3.19 [95.8 kB]\\nGet:17 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libpam-systemd amd64 245.4-4ubuntu3.19 [186 kB]\\nGet:18 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 udev amd64 245.4-4ubuntu3.19 [1367 kB]\\nGet:19 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-minimal amd64 3.6.15-1+focal3 [569 kB]\\nGet:20 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libudev1 amd64 245.4-4ubuntu3.19 [75.5 kB]\\nGet:21 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 kmod amd64 27-1ubuntu2.1 [94.8 kB]\\nGet:22 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libkmod2 amd64 27-1ubuntu2.1 [45.3 kB]\\nGet:23 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 systemd amd64 245.4-4ubuntu3.19 [3812 kB]\\nGet:24 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-lib2to3 all 3.6.15-1+focal3 [122 kB]\\nGet:25 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-distutils all 3.6.15-1+focal3 [187 kB]\\nGet:26 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libsystemd0 amd64 245.4-4ubuntu3.19 [268 kB]\\nGet:27 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libapt-pkg6.0 amd64 2.0.9 [839 kB]\\nGet:28 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 apt amd64 2.0.9 [1294 kB]\\nGet:29 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 apt-utils amd64 2.0.9 [213 kB]\\nGet:30 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 iptables-persistent all 1.0.14ubuntu1 [6552 B]\\nGet:31 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 netfilter-persistent all 1.0.14ubuntu1 [7268 B]\\nGet:32 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-en all 1:20.04+20220818 [1904 B]\\nGet:33 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-en-base all 1:20.04+20220818 [445 kB]\\nGet:34 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-gnome-en all 1:20.04+20220818 [1924 B]\\nGet:35 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-gnome-en-base all 1:20.04+20220818 [535 kB]\\nGet:36 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 distro-info-data all 0.43ubuntu1.11 [4672 B]\\nGet:37 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnetplan0 amd64 0.104-0ubuntu2~20.04.2 [82.5 kB]\\nGet:38 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools all 0.136ubuntu6.7 [9248 B]\\nGet:39 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools-core all 0.136ubuntu6.7 [47.8 kB]\\nGet:40 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools-bin amd64 0.136ubuntu6.7 [10.8 kB]\\nGet:41 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 netplan.io amd64 0.104-0ubuntu2~20.04.2 [88.0 kB]\\nGet:42 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python-apt-common all 2.0.1 [17.0 kB]\\nGet:43 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-apt amd64 2.0.1 [154 kB]\\nGet:44 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ubuntu-advantage-tools amd64 27.13.3~20.04.1 [173 kB]\\nGet:45 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 command-not-found all 20.04.6 [5264 B]\\nGet:46 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-commandnotfound all 20.04.6 [10.4 kB]\\nGet:47 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libkeyutils1 amd64 1.6-6ubuntu1.1 [10.3 kB]\\nGet:48 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-sftp-server amd64 1:8.2p1-4ubuntu0.5 [51.5 kB]\\nGet:49 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-server amd64 1:8.2p1-4ubuntu0.5 [377 kB]\\nGet:50 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-client amd64 1:8.2p1-4ubuntu0.5 [671 kB]\\nGet:51 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ubuntu-release-upgrader-core all 1:20.04.39 [24.4 kB]\\nGet:52 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-distupgrade all 1:20.04.39 [104 kB]\\nGet:53 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-update-manager all 1:20.04.10.11 [38.0 kB]\\nGet:54 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 update-manager-core all 1:20.04.10.11 [11.6 kB]\\nGet:55 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ufw all 0.36-6ubuntu1 [147 kB]\\nGet:56 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 wget amd64 1.20.3-1ubuntu2 [348 kB]\\nGet:57 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 apt-transport-https all 2.0.9 [1704 B]\\nGet:58 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub2-common amd64 2.04-1ubuntu26.16 [590 kB]\\nGet:59 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-pc amd64 2.04-1ubuntu26.16 [125 kB]\\nGet:60 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-pc-bin amd64 2.04-1ubuntu26.16 [971 kB]\\nGet:61 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-common amd64 2.04-1ubuntu26.16 [1878 kB]\\nGet:62 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libasound2 amd64 1.2.2-2.1ubuntu2.5 [335 kB]\\nGet:63 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libasound2-data all 1.2.2-2.1ubuntu2.5 [20.1 kB]\\nGet:64 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnl-genl-3-200 amd64 3.4.0-1ubuntu0.1 [11.2 kB]\\nGet:65 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnl-3-200 amd64 3.4.0-1ubuntu0.1 [54.4 kB]\\nGet:66 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libpq5 amd64 12.13-0ubuntu0.20.04.1 [118 kB]\\nGet:67 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 linux-firmware all 1.187.35 [131 MB]\\nGet:68 http://gb.archive.ubuntu.com/ubuntu focal/main amd64 python3-debconf all 1.5.73 [4060 B]\\nGet:69 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 software-properties-common all 0.99.9.10 [10.4 kB]\\nGet:70 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-software-properties all 0.99.9.10 [21.7 kB]\\nGet:71 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 unattended-upgrades all 2.3ubuntu0.3 [48.5 kB]\\nGet:72 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 cloud-init all 22.4.2-0ubuntu0~20.04.2 [530 kB]\\nPreconfiguring packages ...\\nFetched 169 MB in 2s (67.7 MB/s)\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../libc6-dev_2.31-0ubuntu9.9_amd64.deb ...\\r\\nUnpacking libc6-dev:amd64 (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\\r\\nPreparing to unpack .../libc-dev-bin_2.31-0ubuntu9.9_amd64.deb ...\\r\\nUnpacking libc-dev-bin (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\\r\\nPreparing to unpack .../libc6_2.31-0ubuntu9.9_amd64.deb ...\\r\\nUnpacking libc6:amd64 (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\\r\\nSetting up libc6:amd64 (2.31-0ubuntu9.9) ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../base-files_11ubuntu5.6_amd64.deb ...\\r\\nWarning: Stopping motd-news.service, but it can still be activated by:\\r\\n  motd-news.timer\\r\\nUnpacking base-files (11ubuntu5.6) over (11ubuntu5.4) ...\\r\\nSetting up base-files (11ubuntu5.6) ...\\r\\n\\r\\nConfiguration file '/etc/issue'\\r\\n ==> Modified (by you or by a script) since installation.\\r\\n ==> Package distributor has shipped an updated version.\\r\\n ==> Keeping old config file as default.\\r\\n\\r\\nConfiguration file '/etc/issue.net'\\r\\n ==> Modified (by you or by a script) since installation.\\r\\n ==> Package distributor has shipped an updated version.\\r\\n ==> Keeping old config file as default.\\r\\nInstalling new version of config file /etc/lsb-release ...\\r\\nmotd-news.service is a disabled or a static unit, not starting it.\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../locales_2.31-0ubuntu9.9_all.deb ...\\r\\nUnpacking locales (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\\r\\nPreparing to unpack .../libc-bin_2.31-0ubuntu9.9_amd64.deb ...\\r\\nUnpacking libc-bin (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\\r\\nSetting up libc-bin (2.31-0ubuntu9.9) ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../0-systemd-sysv_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking systemd-sysv (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nPreparing to unpack .../1-systemd-coredump_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking systemd-coredump (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nPreparing to unpack .../2-libnss-systemd_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking libnss-systemd:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nPreparing to unpack .../3-libpam-systemd_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking libpam-systemd:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nPreparing to unpack .../4-udev_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking udev (245.4-4ubuntu3.19) over (245.4-4ubuntu3.15) ...\\r\\nPreparing to unpack .../5-libudev1_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking libudev1:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.15) ...\\r\\nSetting up libudev1:amd64 (245.4-4ubuntu3.19) ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../kmod_27-1ubuntu2.1_amd64.deb ...\\r\\nUnpacking kmod (27-1ubuntu2.1) over (27-1ubuntu2) ...\\r\\nPreparing to unpack .../libkmod2_27-1ubuntu2.1_amd64.deb ...\\r\\nUnpacking libkmod2:amd64 (27-1ubuntu2.1) over (27-1ubuntu2) ...\\r\\nPreparing to unpack .../systemd_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking systemd (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nPreparing to unpack .../libsystemd0_245.4-4ubuntu3.19_amd64.deb ...\\r\\nUnpacking libsystemd0:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\\r\\nSetting up libsystemd0:amd64 (245.4-4ubuntu3.19) ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../libapt-pkg6.0_2.0.9_amd64.deb ...\\r\\nUnpacking libapt-pkg6.0:amd64 (2.0.9) over (2.0.6) ...\\r\\nSetting up libapt-pkg6.0:amd64 (2.0.9) ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154014 files and directories currently installed.)\\r\\nPreparing to unpack .../archives/apt_2.0.9_amd64.deb ...\\r\\nUnpacking apt (2.0.9) over (2.0.6) ...\\r\\nSetting up apt (2.0.9) ...\\r\\nRemoving obsolete conffile /etc/kernel/postinst.d/apt-auto-removal ...\\r\\n(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 154013 files and directories currently installed.)\\r\\nPreparing to unpack .../00-apt-utils_2.0.9_amd64.deb ...\\r\\nUnpacking apt-utils (2.0.9) over (2.0.6) ...\\r\\nPreparing to unpack .../01-iptables-persistent_1.0.14ubuntu1_all.deb ...\\r\\nUnpacking iptables-persistent (1.0.14ubuntu1) over (1.0.14) ...\\r\\nPreparing to unpack .../02-netfilter-persistent_1.0.14ubuntu1_all.deb ...\\r\\nUnpacking netfilter-persistent (1.0.14ubuntu1) over (1.0.14) ...\\r\\nPreparing to unpack .../03-language-pack-en_1%3a20.04+20220818_all.deb ...\\r\\nUnpacking language-pack-en (1:20.04+20220818) over (1:20.04+20210802) ...\\r\\nPreparing to unpack .../04-language-pack-en-base_1%3a20.04+20220818_all.deb ...\\r\\nUnpacking language-pack-en-base (1:20.04+20220818) over (1:20.04+20210802) ...\\r\\nPreparing to unpack .../05-language-pack-gnome-en_1%3a20.04+20220818_all.deb ...\\r\\nUnpacking language-pack-gnome-en (1:20.04+20220818) over (1:20.04+20210802) ...\\r\\nPreparing to unpack .../06-language-pack-gnome-en-base_1%3a20.04+20220818_all.deb ...\\r\\nUnpacking language-pack-gnome-en-base (1:20.04+20220818) over (1:20.04+20210802) ...\\r\\nPreparing to unpack .../07-python3.6-dev_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking python3.6-dev (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../08-libpython3.6-dev_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking libpython3.6-dev:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../09-libpython3.6_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking libpython3.6:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../10-python3.6-venv_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking python3.6-venv (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../11-python3.6_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking python3.6 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking libpython3.6-stdlib:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\ndpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb (--unpack):\\r\\n trying to overwrite '/usr/lib/python3.6/_sysconfigdata_m_linux_x86_64-linux-gnu.py', which is also in package libpython3.6-minimal:amd64 3.6.15-1+focal1\\r\\nPreparing to unpack .../13-python3.6-minimal_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking python3.6-minimal (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nPreparing to unpack .../14-libpython3.6-minimal_3.6.15-1+focal3_amd64.deb ...\\r\\nUnpacking libpython3.6-minimal:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\\r\\nSelecting previously unselected package python3.6-lib2to3.\\r\\nPreparing to unpack .../15-python3.6-lib2to3_3.6.15-1+focal3_all.deb ...\\r\\nUnpacking python3.6-lib2to3 (3.6.15-1+focal3) ...\\r\\ndpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/15-python3.6-lib2to3_3.6.15-1+focal3_all.deb (--unpack):\\r\\n trying to overwrite '/usr/lib/python3.6/lib2to3/Grammar.txt', which is also in package libpython3.6-stdlib:amd64 3.6.15-1+focal1\\r\\ndpkg-deb: error: paste subprocess was killed by signal (Broken pipe)\\r\\nSelecting previously unselected package python3.6-distutils.\\r\\nPreparing to unpack .../16-python3.6-distutils_3.6.15-1+focal3_all.deb ...\\r\\nUnpacking python3.6-distutils (3.6.15-1+focal3) ...\\r\\ndpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/16-python3.6-distutils_3.6.15-1+focal3_all.deb (--unpack):\\r\\n trying to overwrite '/usr/lib/python3.6/distutils/README', which is also in package libpython3.6-stdlib:amd64 3.6.15-1+focal1\\r\\ndpkg-deb: error: paste subprocess was killed by signal (Broken pipe)\\r\\nPreparing to unpack .../17-distro-info-data_0.43ubuntu1.11_all.deb ...\\r\\nUnpacking distro-info-data (0.43ubuntu1.11) over (0.43ubuntu1.10) ...\\r\\nPreparing to unpack .../18-libnetplan0_0.104-0ubuntu2~20.04.2_amd64.deb ...\\r\\nUnpacking libnetplan0:amd64 (0.104-0ubuntu2~20.04.2) over (0.103-0ubuntu5~20.04.2) ...\\r\\nPreparing to unpack .../19-initramfs-tools_0.136ubuntu6.7_all.deb ...\\r\\nUnpacking initramfs-tools (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\\r\\nPreparing to unpack .../20-initramfs-tools-core_0.136ubuntu6.7_all.deb ...\\r\\nUnpacking initramfs-tools-core (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\\r\\nPreparing to unpack .../21-initramfs-tools-bin_0.136ubuntu6.7_amd64.deb ...\\r\\nUnpacking initramfs-tools-bin (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\\r\\nPreparing to unpack .../22-netplan.io_0.104-0ubuntu2~20.04.2_amd64.deb ...\\r\\nUnpacking netplan.io (0.104-0ubuntu2~20.04.2) over (0.103-0ubuntu5~20.04.2) ...\\r\\nPreparing to unpack .../23-python-apt-common_2.0.1_all.deb ...\\r\\nUnpacking python-apt-common (2.0.1) over (2.0.0ubuntu0.20.04.6) ...\\r\\nPreparing to unpack .../24-python3-apt_2.0.1_amd64.deb ...\\r\\nUnpacking python3-apt (2.0.1) over (2.0.0ubuntu0.20.04.6) ...\\r\\nPreparing to unpack .../25-ubuntu-advantage-tools_27.13.3~20.04.1_amd64.deb ...\\r\\nUnpacking ubuntu-advantage-tools (27.13.3~20.04.1) over (27.3~20.04.1) ...\\r\\nPreparing to unpack .../26-command-not-found_20.04.6_all.deb ...\\r\\nUnpacking command-not-found (20.04.6) over (20.04.4) ...\\r\\nPreparing to unpack .../27-python3-commandnotfound_20.04.6_all.deb ...\\r\\nUnpacking python3-commandnotfound (20.04.6) over (20.04.4) ...\\r\\nPreparing to unpack .../28-libkeyutils1_1.6-6ubuntu1.1_amd64.deb ...\\r\\nUnpacking libkeyutils1:amd64 (1.6-6ubuntu1.1) over (1.6-6ubuntu1) ...\\r\\nPreparing to unpack .../29-openssh-sftp-server_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\\r\\nUnpacking openssh-sftp-server (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\\r\\nPreparing to unpack .../30-openssh-server_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\\r\\nUnpacking openssh-server (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\\r\\nPreparing to unpack .../31-openssh-client_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\\r\\nUnpacking openssh-client (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\\r\\nPreparing to unpack .../32-ubuntu-release-upgrader-core_1%3a20.04.39_all.deb ...\\r\\nUnpacking ubuntu-release-upgrader-core (1:20.04.39) over (1:20.04.36) ...\\r\\nPreparing to unpack .../33-python3-distupgrade_1%3a20.04.39_all.deb ...\\r\\nUnpacking python3-distupgrade (1:20.04.39) over (1:20.04.36) ...\\r\\nPreparing to unpack .../34-python3-update-manager_1%3a20.04.10.11_all.deb ...\\r\\nUnpacking python3-update-manager (1:20.04.10.11) over (1:20.04.10.9) ...\\r\\nPreparing to unpack .../35-update-manager-core_1%3a20.04.10.11_all.deb ...\\r\\nUnpacking update-manager-core (1:20.04.10.11) over (1:20.04.10.9) ...\\r\\nPreparing to unpack .../36-ufw_0.36-6ubuntu1_all.deb ...\\r\\nUnpacking ufw (0.36-6ubuntu1) over (0.36-6) ...\\r\\nPreparing to unpack .../37-wget_1.20.3-1ubuntu2_amd64.deb ...\\r\\nUnpacking wget (1.20.3-1ubuntu2) over (1.20.3-1ubuntu1) ...\\r\\nPreparing to unpack .../38-apt-transport-https_2.0.9_all.deb ...\\r\\nUnpacking apt-transport-https (2.0.9) over (2.0.6) ...\\r\\nPreparing to unpack .../39-grub2-common_2.04-1ubuntu26.16_amd64.deb ...\\r\\nUnpacking grub2-common (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\\r\\nPreparing to unpack .../40-grub-pc_2.04-1ubuntu26.16_amd64.deb ...\\r\\nUnpacking grub-pc (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\\r\\nPreparing to unpack .../41-grub-pc-bin_2.04-1ubuntu26.16_amd64.deb ...\\r\\nUnpacking grub-pc-bin (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\\r\\nPreparing to unpack .../42-grub-common_2.04-1ubuntu26.16_amd64.deb ...\\r\\nUnpacking grub-common (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\\r\\nPreparing to unpack .../43-libasound2_1.2.2-2.1ubuntu2.5_amd64.deb ...\\r\\nUnpacking libasound2:amd64 (1.2.2-2.1ubuntu2.5) over (1.2.2-2.1ubuntu2.4) ...\\r\\nPreparing to unpack .../44-libasound2-data_1.2.2-2.1ubuntu2.5_all.deb ...\\r\\nUnpacking libasound2-data (1.2.2-2.1ubuntu2.5) over (1.2.2-2.1ubuntu2.4) ...\\r\\nPreparing to unpack .../45-libnl-genl-3-200_3.4.0-1ubuntu0.1_amd64.deb ...\\r\\nUnpacking libnl-genl-3-200:amd64 (3.4.0-1ubuntu0.1) over (3.4.0-1) ...\\r\\nPreparing to unpack .../46-libnl-3-200_3.4.0-1ubuntu0.1_amd64.deb ...\\r\\nUnpacking libnl-3-200:amd64 (3.4.0-1ubuntu0.1) over (3.4.0-1) ...\\r\\nPreparing to unpack .../47-libpq5_12.13-0ubuntu0.20.04.1_amd64.deb ...\\r\\nUnpacking libpq5:amd64 (12.13-0ubuntu0.20.04.1) over (12.12-0ubuntu0.20.04.1) ...\\r\\nPreparing to unpack .../48-linux-firmware_1.187.35_all.deb ...\\r\\nUnpacking linux-firmware (1.187.35) over (1.187.20) ...\\r\\nSelecting previously unselected package python3-debconf.\\r\\nPreparing to unpack .../49-python3-debconf_1.5.73_all.deb ...\\r\\nUnpacking python3-debconf (1.5.73) ...\\r\\nPreparing to unpack .../50-software-properties-common_0.99.9.10_all.deb ...\\r\\nUnpacking software-properties-common (0.99.9.10) over (0.98.9.5) ...\\r\\nPreparing to unpack .../51-python3-software-properties_0.99.9.10_all.deb ...\\r\\nUnpacking python3-software-properties (0.99.9.10) over (0.98.9.5) ...\\r\\nPreparing to unpack .../52-unattended-upgrades_2.3ubuntu0.3_all.deb ...\\r\\nUnpacking unattended-upgrades (2.3ubuntu0.3) over (2.3ubuntu0.1) ...\\r\\nPreparing to unpack .../53-cloud-init_22.4.2-0ubuntu0~20.04.2_all.deb ...\\r\\nUnpacking cloud-init (22.4.2-0ubuntu0~20.04.2) over (22.2-0ubuntu1~20.04.3) ...\\r\\nErrors were encountered while processing:\\r\\n /tmp/apt-dpkg-install-0Y3DOI/12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb\\r\\n /tmp/apt-dpkg-install-0Y3DOI/15-python3.6-lib2to3_3.6.15-1+focal3_all.deb\\r\\n /tmp/apt-dpkg-install-0Y3DOI/16-python3.6-distutils_3.6.15-1+focal3_all.deb\\r\\n\", \"stdout_lines\": [\"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"Calculating upgrade...\", \"The following NEW packages will be installed\", \"  python3-debconf python3.6-distutils python3.6-lib2to3\", \"The following packages have been kept back:\", \"  xe-guest-utilities\", \"The following packages will be upgraded:\", \"  apt apt-transport-https apt-utils base-files cloud-init command-not-found\", \"  distro-info-data grub-common grub-pc grub-pc-bin grub2-common\", \"  initramfs-tools initramfs-tools-bin initramfs-tools-core iptables-persistent\", \"  kmod language-pack-en language-pack-en-base language-pack-gnome-en\", \"  language-pack-gnome-en-base libapt-pkg6.0 libasound2 libasound2-data\", \"  libc-bin libc-dev-bin libc6 libc6-dev libkeyutils1 libkmod2 libnetplan0\", \"  libnl-3-200 libnl-genl-3-200 libnss-systemd libpam-systemd libpq5\", \"  libpython3.6 libpython3.6-dev libpython3.6-minimal libpython3.6-stdlib\", \"  libsystemd0 libudev1 linux-firmware locales netfilter-persistent netplan.io\", \"  openssh-client openssh-server openssh-sftp-server python-apt-common\", \"  python3-apt python3-commandnotfound python3-distupgrade\", \"  python3-software-properties python3-update-manager python3.6 python3.6-dev\", \"  python3.6-minimal python3.6-venv software-properties-common systemd\", \"  systemd-coredump systemd-sysv ubuntu-advantage-tools\", \"  ubuntu-release-upgrader-core udev ufw unattended-upgrades\", \"  update-manager-core wget\", \"69 to upgrade, 3 to newly install, 0 to remove and 1 not to upgrade.\", \"Need to get 169 MB of archives.\", \"After this operation, 92.4 MB of additional disk space will be used.\", \"Get:1 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc6-dev amd64 2.31-0ubuntu9.9 [2519 kB]\", \"Get:2 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-dev amd64 3.6.15-1+focal3 [501 kB]\", \"Get:3 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-dev amd64 3.6.15-1+focal3 [3433 kB]\", \"Get:4 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc-dev-bin amd64 2.31-0ubuntu9.9 [71.8 kB]\", \"Get:5 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc6 amd64 2.31-0ubuntu9.9 [2722 kB]\", \"Get:6 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6 amd64 3.6.15-1+focal3 [1396 kB]\", \"Get:7 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-venv amd64 3.6.15-1+focal3 [1704 kB]\", \"Get:8 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 base-files amd64 11ubuntu5.6 [60.4 kB]\", \"Get:9 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 locales all 2.31-0ubuntu9.9 [3869 kB]\", \"Get:10 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6 amd64 3.6.15-1+focal3 [248 kB]\", \"Get:11 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-stdlib amd64 3.6.15-1+focal3 [1758 kB]\", \"Get:12 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libc-bin amd64 2.31-0ubuntu9.9 [633 kB]\", \"Get:13 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 systemd-sysv amd64 245.4-4ubuntu3.19 [10.3 kB]\", \"Get:14 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-minimal amd64 3.6.15-1+focal3 [1718 kB]\", \"Get:15 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 systemd-coredump amd64 245.4-4ubuntu3.19 [43.6 kB]\", \"Get:16 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnss-systemd amd64 245.4-4ubuntu3.19 [95.8 kB]\", \"Get:17 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libpam-systemd amd64 245.4-4ubuntu3.19 [186 kB]\", \"Get:18 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 udev amd64 245.4-4ubuntu3.19 [1367 kB]\", \"Get:19 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 libpython3.6-minimal amd64 3.6.15-1+focal3 [569 kB]\", \"Get:20 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libudev1 amd64 245.4-4ubuntu3.19 [75.5 kB]\", \"Get:21 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 kmod amd64 27-1ubuntu2.1 [94.8 kB]\", \"Get:22 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libkmod2 amd64 27-1ubuntu2.1 [45.3 kB]\", \"Get:23 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 systemd amd64 245.4-4ubuntu3.19 [3812 kB]\", \"Get:24 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-lib2to3 all 3.6.15-1+focal3 [122 kB]\", \"Get:25 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 python3.6-distutils all 3.6.15-1+focal3 [187 kB]\", \"Get:26 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libsystemd0 amd64 245.4-4ubuntu3.19 [268 kB]\", \"Get:27 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libapt-pkg6.0 amd64 2.0.9 [839 kB]\", \"Get:28 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 apt amd64 2.0.9 [1294 kB]\", \"Get:29 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 apt-utils amd64 2.0.9 [213 kB]\", \"Get:30 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 iptables-persistent all 1.0.14ubuntu1 [6552 B]\", \"Get:31 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 netfilter-persistent all 1.0.14ubuntu1 [7268 B]\", \"Get:32 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-en all 1:20.04+20220818 [1904 B]\", \"Get:33 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-en-base all 1:20.04+20220818 [445 kB]\", \"Get:34 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-gnome-en all 1:20.04+20220818 [1924 B]\", \"Get:35 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 language-pack-gnome-en-base all 1:20.04+20220818 [535 kB]\", \"Get:36 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 distro-info-data all 0.43ubuntu1.11 [4672 B]\", \"Get:37 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnetplan0 amd64 0.104-0ubuntu2~20.04.2 [82.5 kB]\", \"Get:38 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools all 0.136ubuntu6.7 [9248 B]\", \"Get:39 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools-core all 0.136ubuntu6.7 [47.8 kB]\", \"Get:40 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 initramfs-tools-bin amd64 0.136ubuntu6.7 [10.8 kB]\", \"Get:41 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 netplan.io amd64 0.104-0ubuntu2~20.04.2 [88.0 kB]\", \"Get:42 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python-apt-common all 2.0.1 [17.0 kB]\", \"Get:43 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-apt amd64 2.0.1 [154 kB]\", \"Get:44 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ubuntu-advantage-tools amd64 27.13.3~20.04.1 [173 kB]\", \"Get:45 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 command-not-found all 20.04.6 [5264 B]\", \"Get:46 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-commandnotfound all 20.04.6 [10.4 kB]\", \"Get:47 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libkeyutils1 amd64 1.6-6ubuntu1.1 [10.3 kB]\", \"Get:48 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-sftp-server amd64 1:8.2p1-4ubuntu0.5 [51.5 kB]\", \"Get:49 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-server amd64 1:8.2p1-4ubuntu0.5 [377 kB]\", \"Get:50 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-client amd64 1:8.2p1-4ubuntu0.5 [671 kB]\", \"Get:51 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ubuntu-release-upgrader-core all 1:20.04.39 [24.4 kB]\", \"Get:52 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-distupgrade all 1:20.04.39 [104 kB]\", \"Get:53 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-update-manager all 1:20.04.10.11 [38.0 kB]\", \"Get:54 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 update-manager-core all 1:20.04.10.11 [11.6 kB]\", \"Get:55 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 ufw all 0.36-6ubuntu1 [147 kB]\", \"Get:56 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 wget amd64 1.20.3-1ubuntu2 [348 kB]\", \"Get:57 http://gb.archive.ubuntu.com/ubuntu focal-updates/universe amd64 apt-transport-https all 2.0.9 [1704 B]\", \"Get:58 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub2-common amd64 2.04-1ubuntu26.16 [590 kB]\", \"Get:59 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-pc amd64 2.04-1ubuntu26.16 [125 kB]\", \"Get:60 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-pc-bin amd64 2.04-1ubuntu26.16 [971 kB]\", \"Get:61 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 grub-common amd64 2.04-1ubuntu26.16 [1878 kB]\", \"Get:62 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libasound2 amd64 1.2.2-2.1ubuntu2.5 [335 kB]\", \"Get:63 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libasound2-data all 1.2.2-2.1ubuntu2.5 [20.1 kB]\", \"Get:64 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnl-genl-3-200 amd64 3.4.0-1ubuntu0.1 [11.2 kB]\", \"Get:65 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libnl-3-200 amd64 3.4.0-1ubuntu0.1 [54.4 kB]\", \"Get:66 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 libpq5 amd64 12.13-0ubuntu0.20.04.1 [118 kB]\", \"Get:67 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 linux-firmware all 1.187.35 [131 MB]\", \"Get:68 http://gb.archive.ubuntu.com/ubuntu focal/main amd64 python3-debconf all 1.5.73 [4060 B]\", \"Get:69 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 software-properties-common all 0.99.9.10 [10.4 kB]\", \"Get:70 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-software-properties all 0.99.9.10 [21.7 kB]\", \"Get:71 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 unattended-upgrades all 2.3ubuntu0.3 [48.5 kB]\", \"Get:72 http://gb.archive.ubuntu.com/ubuntu focal-updates/main amd64 cloud-init all 22.4.2-0ubuntu0~20.04.2 [530 kB]\", \"Preconfiguring packages ...\", \"Fetched 169 MB in 2s (67.7 MB/s)\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../libc6-dev_2.31-0ubuntu9.9_amd64.deb ...\", \"Unpacking libc6-dev:amd64 (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\", \"Preparing to unpack .../libc-dev-bin_2.31-0ubuntu9.9_amd64.deb ...\", \"Unpacking libc-dev-bin (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\", \"Preparing to unpack .../libc6_2.31-0ubuntu9.9_amd64.deb ...\", \"Unpacking libc6:amd64 (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\", \"Setting up libc6:amd64 (2.31-0ubuntu9.9) ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../base-files_11ubuntu5.6_amd64.deb ...\", \"Warning: Stopping motd-news.service, but it can still be activated by:\", \"  motd-news.timer\", \"Unpacking base-files (11ubuntu5.6) over (11ubuntu5.4) ...\", \"Setting up base-files (11ubuntu5.6) ...\", \"\", \"Configuration file '/etc/issue'\", \" ==> Modified (by you or by a script) since installation.\", \" ==> Package distributor has shipped an updated version.\", \" ==> Keeping old config file as default.\", \"\", \"Configuration file '/etc/issue.net'\", \" ==> Modified (by you or by a script) since installation.\", \" ==> Package distributor has shipped an updated version.\", \" ==> Keeping old config file as default.\", \"Installing new version of config file /etc/lsb-release ...\", \"motd-news.service is a disabled or a static unit, not starting it.\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../locales_2.31-0ubuntu9.9_all.deb ...\", \"Unpacking locales (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\", \"Preparing to unpack .../libc-bin_2.31-0ubuntu9.9_amd64.deb ...\", \"Unpacking libc-bin (2.31-0ubuntu9.9) over (2.31-0ubuntu9.7) ...\", \"Setting up libc-bin (2.31-0ubuntu9.9) ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../0-systemd-sysv_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking systemd-sysv (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Preparing to unpack .../1-systemd-coredump_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking systemd-coredump (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Preparing to unpack .../2-libnss-systemd_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking libnss-systemd:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Preparing to unpack .../3-libpam-systemd_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking libpam-systemd:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Preparing to unpack .../4-udev_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking udev (245.4-4ubuntu3.19) over (245.4-4ubuntu3.15) ...\", \"Preparing to unpack .../5-libudev1_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking libudev1:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.15) ...\", \"Setting up libudev1:amd64 (245.4-4ubuntu3.19) ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../kmod_27-1ubuntu2.1_amd64.deb ...\", \"Unpacking kmod (27-1ubuntu2.1) over (27-1ubuntu2) ...\", \"Preparing to unpack .../libkmod2_27-1ubuntu2.1_amd64.deb ...\", \"Unpacking libkmod2:amd64 (27-1ubuntu2.1) over (27-1ubuntu2) ...\", \"Preparing to unpack .../systemd_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking systemd (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Preparing to unpack .../libsystemd0_245.4-4ubuntu3.19_amd64.deb ...\", \"Unpacking libsystemd0:amd64 (245.4-4ubuntu3.19) over (245.4-4ubuntu3.17) ...\", \"Setting up libsystemd0:amd64 (245.4-4ubuntu3.19) ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../libapt-pkg6.0_2.0.9_amd64.deb ...\", \"Unpacking libapt-pkg6.0:amd64 (2.0.9) over (2.0.6) ...\", \"Setting up libapt-pkg6.0:amd64 (2.0.9) ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154014 files and directories currently installed.)\", \"Preparing to unpack .../archives/apt_2.0.9_amd64.deb ...\", \"Unpacking apt (2.0.9) over (2.0.6) ...\", \"Setting up apt (2.0.9) ...\", \"Removing obsolete conffile /etc/kernel/postinst.d/apt-auto-removal ...\", \"(Reading database ... \", \"(Reading database ... 5%\", \"(Reading database ... 10%\", \"(Reading database ... 15%\", \"(Reading database ... 20%\", \"(Reading database ... 25%\", \"(Reading database ... 30%\", \"(Reading database ... 35%\", \"(Reading database ... 40%\", \"(Reading database ... 45%\", \"(Reading database ... 50%\", \"(Reading database ... 55%\", \"(Reading database ... 60%\", \"(Reading database ... 65%\", \"(Reading database ... 70%\", \"(Reading database ... 75%\", \"(Reading database ... 80%\", \"(Reading database ... 85%\", \"(Reading database ... 90%\", \"(Reading database ... 95%\", \"(Reading database ... 100%\", \"(Reading database ... 154013 files and directories currently installed.)\", \"Preparing to unpack .../00-apt-utils_2.0.9_amd64.deb ...\", \"Unpacking apt-utils (2.0.9) over (2.0.6) ...\", \"Preparing to unpack .../01-iptables-persistent_1.0.14ubuntu1_all.deb ...\", \"Unpacking iptables-persistent (1.0.14ubuntu1) over (1.0.14) ...\", \"Preparing to unpack .../02-netfilter-persistent_1.0.14ubuntu1_all.deb ...\", \"Unpacking netfilter-persistent (1.0.14ubuntu1) over (1.0.14) ...\", \"Preparing to unpack .../03-language-pack-en_1%3a20.04+20220818_all.deb ...\", \"Unpacking language-pack-en (1:20.04+20220818) over (1:20.04+20210802) ...\", \"Preparing to unpack .../04-language-pack-en-base_1%3a20.04+20220818_all.deb ...\", \"Unpacking language-pack-en-base (1:20.04+20220818) over (1:20.04+20210802) ...\", \"Preparing to unpack .../05-language-pack-gnome-en_1%3a20.04+20220818_all.deb ...\", \"Unpacking language-pack-gnome-en (1:20.04+20220818) over (1:20.04+20210802) ...\", \"Preparing to unpack .../06-language-pack-gnome-en-base_1%3a20.04+20220818_all.deb ...\", \"Unpacking language-pack-gnome-en-base (1:20.04+20220818) over (1:20.04+20210802) ...\", \"Preparing to unpack .../07-python3.6-dev_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking python3.6-dev (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../08-libpython3.6-dev_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking libpython3.6-dev:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../09-libpython3.6_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking libpython3.6:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../10-python3.6-venv_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking python3.6-venv (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../11-python3.6_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking python3.6 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking libpython3.6-stdlib:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"dpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb (--unpack):\", \" trying to overwrite '/usr/lib/python3.6/_sysconfigdata_m_linux_x86_64-linux-gnu.py', which is also in package libpython3.6-minimal:amd64 3.6.15-1+focal1\", \"Preparing to unpack .../13-python3.6-minimal_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking python3.6-minimal (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Preparing to unpack .../14-libpython3.6-minimal_3.6.15-1+focal3_amd64.deb ...\", \"Unpacking libpython3.6-minimal:amd64 (3.6.15-1+focal3) over (3.6.15-1+focal1) ...\", \"Selecting previously unselected package python3.6-lib2to3.\", \"Preparing to unpack .../15-python3.6-lib2to3_3.6.15-1+focal3_all.deb ...\", \"Unpacking python3.6-lib2to3 (3.6.15-1+focal3) ...\", \"dpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/15-python3.6-lib2to3_3.6.15-1+focal3_all.deb (--unpack):\", \" trying to overwrite '/usr/lib/python3.6/lib2to3/Grammar.txt', which is also in package libpython3.6-stdlib:amd64 3.6.15-1+focal1\", \"dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)\", \"Selecting previously unselected package python3.6-distutils.\", \"Preparing to unpack .../16-python3.6-distutils_3.6.15-1+focal3_all.deb ...\", \"Unpacking python3.6-distutils (3.6.15-1+focal3) ...\", \"dpkg: error processing archive /tmp/apt-dpkg-install-0Y3DOI/16-python3.6-distutils_3.6.15-1+focal3_all.deb (--unpack):\", \" trying to overwrite '/usr/lib/python3.6/distutils/README', which is also in package libpython3.6-stdlib:amd64 3.6.15-1+focal1\", \"dpkg-deb: error: paste subprocess was killed by signal (Broken pipe)\", \"Preparing to unpack .../17-distro-info-data_0.43ubuntu1.11_all.deb ...\", \"Unpacking distro-info-data (0.43ubuntu1.11) over (0.43ubuntu1.10) ...\", \"Preparing to unpack .../18-libnetplan0_0.104-0ubuntu2~20.04.2_amd64.deb ...\", \"Unpacking libnetplan0:amd64 (0.104-0ubuntu2~20.04.2) over (0.103-0ubuntu5~20.04.2) ...\", \"Preparing to unpack .../19-initramfs-tools_0.136ubuntu6.7_all.deb ...\", \"Unpacking initramfs-tools (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\", \"Preparing to unpack .../20-initramfs-tools-core_0.136ubuntu6.7_all.deb ...\", \"Unpacking initramfs-tools-core (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\", \"Preparing to unpack .../21-initramfs-tools-bin_0.136ubuntu6.7_amd64.deb ...\", \"Unpacking initramfs-tools-bin (0.136ubuntu6.7) over (0.136ubuntu6.6) ...\", \"Preparing to unpack .../22-netplan.io_0.104-0ubuntu2~20.04.2_amd64.deb ...\", \"Unpacking netplan.io (0.104-0ubuntu2~20.04.2) over (0.103-0ubuntu5~20.04.2) ...\", \"Preparing to unpack .../23-python-apt-common_2.0.1_all.deb ...\", \"Unpacking python-apt-common (2.0.1) over (2.0.0ubuntu0.20.04.6) ...\", \"Preparing to unpack .../24-python3-apt_2.0.1_amd64.deb ...\", \"Unpacking python3-apt (2.0.1) over (2.0.0ubuntu0.20.04.6) ...\", \"Preparing to unpack .../25-ubuntu-advantage-tools_27.13.3~20.04.1_amd64.deb ...\", \"Unpacking ubuntu-advantage-tools (27.13.3~20.04.1) over (27.3~20.04.1) ...\", \"Preparing to unpack .../26-command-not-found_20.04.6_all.deb ...\", \"Unpacking command-not-found (20.04.6) over (20.04.4) ...\", \"Preparing to unpack .../27-python3-commandnotfound_20.04.6_all.deb ...\", \"Unpacking python3-commandnotfound (20.04.6) over (20.04.4) ...\", \"Preparing to unpack .../28-libkeyutils1_1.6-6ubuntu1.1_amd64.deb ...\", \"Unpacking libkeyutils1:amd64 (1.6-6ubuntu1.1) over (1.6-6ubuntu1) ...\", \"Preparing to unpack .../29-openssh-sftp-server_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\", \"Unpacking openssh-sftp-server (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\", \"Preparing to unpack .../30-openssh-server_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\", \"Unpacking openssh-server (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\", \"Preparing to unpack .../31-openssh-client_1%3a8.2p1-4ubuntu0.5_amd64.deb ...\", \"Unpacking openssh-client (1:8.2p1-4ubuntu0.5) over (1:8.2p1-4ubuntu0.3) ...\", \"Preparing to unpack .../32-ubuntu-release-upgrader-core_1%3a20.04.39_all.deb ...\", \"Unpacking ubuntu-release-upgrader-core (1:20.04.39) over (1:20.04.36) ...\", \"Preparing to unpack .../33-python3-distupgrade_1%3a20.04.39_all.deb ...\", \"Unpacking python3-distupgrade (1:20.04.39) over (1:20.04.36) ...\", \"Preparing to unpack .../34-python3-update-manager_1%3a20.04.10.11_all.deb ...\", \"Unpacking python3-update-manager (1:20.04.10.11) over (1:20.04.10.9) ...\", \"Preparing to unpack .../35-update-manager-core_1%3a20.04.10.11_all.deb ...\", \"Unpacking update-manager-core (1:20.04.10.11) over (1:20.04.10.9) ...\", \"Preparing to unpack .../36-ufw_0.36-6ubuntu1_all.deb ...\", \"Unpacking ufw (0.36-6ubuntu1) over (0.36-6) ...\", \"Preparing to unpack .../37-wget_1.20.3-1ubuntu2_amd64.deb ...\", \"Unpacking wget (1.20.3-1ubuntu2) over (1.20.3-1ubuntu1) ...\", \"Preparing to unpack .../38-apt-transport-https_2.0.9_all.deb ...\", \"Unpacking apt-transport-https (2.0.9) over (2.0.6) ...\", \"Preparing to unpack .../39-grub2-common_2.04-1ubuntu26.16_amd64.deb ...\", \"Unpacking grub2-common (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\", \"Preparing to unpack .../40-grub-pc_2.04-1ubuntu26.16_amd64.deb ...\", \"Unpacking grub-pc (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\", \"Preparing to unpack .../41-grub-pc-bin_2.04-1ubuntu26.16_amd64.deb ...\", \"Unpacking grub-pc-bin (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\", \"Preparing to unpack .../42-grub-common_2.04-1ubuntu26.16_amd64.deb ...\", \"Unpacking grub-common (2.04-1ubuntu26.16) over (2.04-1ubuntu26.13) ...\", \"Preparing to unpack .../43-libasound2_1.2.2-2.1ubuntu2.5_amd64.deb ...\", \"Unpacking libasound2:amd64 (1.2.2-2.1ubuntu2.5) over (1.2.2-2.1ubuntu2.4) ...\", \"Preparing to unpack .../44-libasound2-data_1.2.2-2.1ubuntu2.5_all.deb ...\", \"Unpacking libasound2-data (1.2.2-2.1ubuntu2.5) over (1.2.2-2.1ubuntu2.4) ...\", \"Preparing to unpack .../45-libnl-genl-3-200_3.4.0-1ubuntu0.1_amd64.deb ...\", \"Unpacking libnl-genl-3-200:amd64 (3.4.0-1ubuntu0.1) over (3.4.0-1) ...\", \"Preparing to unpack .../46-libnl-3-200_3.4.0-1ubuntu0.1_amd64.deb ...\", \"Unpacking libnl-3-200:amd64 (3.4.0-1ubuntu0.1) over (3.4.0-1) ...\", \"Preparing to unpack .../47-libpq5_12.13-0ubuntu0.20.04.1_amd64.deb ...\", \"Unpacking libpq5:amd64 (12.13-0ubuntu0.20.04.1) over (12.12-0ubuntu0.20.04.1) ...\", \"Preparing to unpack .../48-linux-firmware_1.187.35_all.deb ...\", \"Unpacking linux-firmware (1.187.35) over (1.187.20) ...\", \"Selecting previously unselected package python3-debconf.\", \"Preparing to unpack .../49-python3-debconf_1.5.73_all.deb ...\", \"Unpacking python3-debconf (1.5.73) ...\", \"Preparing to unpack .../50-software-properties-common_0.99.9.10_all.deb ...\", \"Unpacking software-properties-common (0.99.9.10) over (0.98.9.5) ...\", \"Preparing to unpack .../51-python3-software-properties_0.99.9.10_all.deb ...\", \"Unpacking python3-software-properties (0.99.9.10) over (0.98.9.5) ...\", \"Preparing to unpack .../52-unattended-upgrades_2.3ubuntu0.3_all.deb ...\", \"Unpacking unattended-upgrades (2.3ubuntu0.3) over (2.3ubuntu0.1) ...\", \"Preparing to unpack .../53-cloud-init_22.4.2-0ubuntu0~20.04.2_all.deb ...\", \"Unpacking cloud-init (22.4.2-0ubuntu0~20.04.2) over (22.2-0ubuntu1~20.04.3) ...\", \"Errors were encountered while processing:\", \" /tmp/apt-dpkg-install-0Y3DOI/12-libpython3.6-stdlib_3.6.15-1+focal3_amd64.deb\", \" /tmp/apt-dpkg-install-0Y3DOI/15-python3.6-lib2to3_3.6.15-1+focal3_all.deb\", \" /tmp/apt-dpkg-install-0Y3DOI/16-python3.6-distutils_3.6.15-1+focal3_all.deb\"]}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-02-03T09:51:26Z",
        "user": "mindriot88",
        "labels": [
            "module",
            "bug",
            "feature",
            "P3",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 79778,
        "title": "`ansible_collection_name` VARIABLE IS NOT DEFINED!",
        "body": "### Summary\n\n\r\nA feature [\"Using a playbook from a collection\"](https://docs.ansible.com/ansible/latest/collections_guide/collections_using_playbooks.html#using-a-playbook-from-a-collection),\r\n\r\nA definition **[ansible_collection_name](https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html#magic-variables)** - _The name of the collection the task that is executing is a part of. In the format of namespace.collection_\r\n\r\nAnd two interesting comments arguing together:\r\n\r\n> [... I did add a new var called ansible_collection_name so if you wanted, you could do the following in a role within a collection.](https://github.com/ansible/ansible/pull/68213#issuecomment-603464946)\r\n\r\n> [collections is a list, not a single entry, within the role you already assume 'current collection' iirc](https://github.com/ansible/ansible/pull/68213#issuecomment-603465766)\r\n\r\n\r\nNow a **task** that is executing is part of a collection.\r\nThe **task** belongs to a play and the play belongs to a playbook and the playbook belongs to a collection.\r\nThe **task** sees the light when executing `ansible-playbook namespace.collection.playbook`:\r\n\r\n```yaml\r\n- name: Play namespace.collection.playbook\r\n  any_errors_fatal: true\r\n  gather_facts: false\r\n  collections:\r\n    - namespace.collection\r\n  connection: local\r\n  hosts: localhost\r\n  tasks:\r\n    - name: Debug\r\n      ansible.builtin.debug:\r\n        var: \"{{ ansible_var }}\"\r\n      loop:\r\n        - ansible_collection_name\r\n        - ansible_play_name\r\n      loop_control:\r\n        loop_var: ansible_var\r\n```\r\n\r\nBut stdout releases some signs from the dark side of logic:\r\n\r\n```txt\r\n[WARNING]: running playbook inside collection namespace.collection\r\n\r\nPLAY [Play namespace.collection.playbook] ***************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Debug] ***************************************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=ansible_collection_name) => \r\n  ansible_collection_name: VARIABLE IS NOT DEFINED!\r\n  ansible_loop_var: ansible_var\r\n  ansible_var: ansible_collection_name\r\nok: [localhost] => (item=ansible_play_name) => \r\n  ansible_loop_var: ansible_var\r\n  ansible_play_name: Play namespace.collection.playbook\r\n  ansible_var: ansible_play_name\r\n\r\nPLAY RECAP *****************************************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nKing github let his messengers announce an issue:\r\n\r\nWhy the first sign is a **WARNING** with a relevant info \"running playbook inside collection namespace.collection\" ?\r\nWhy this relevant info is not available at **task** execution time - \"ansible_collection_name: VARIABLE IS NOT DEFINED!\" ?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-core\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = /home/username/git/repo/path/ansible.cfg\r\n  configured module search path = ['/home/username/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/username/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/username/git/repo/path/collections\r\n  executable location = /home/username/.local/bin/ansible\r\n  python version = 3.9.14 (main, Nov  7 2022, 00:00:00) [GCC 11.3.1 20220421 (Red Hat 11.3.1-2.1.0.1)] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\nCACHE_PLUGIN(/home/username/git/repo/path/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/home/username/git/repo/path/ansible.cfg) = /home/username/git/repo/path/tmp/facts_cache\r\nCACHE_PLUGIN_TIMEOUT(/home/username/git/repo/path/ansible.cfg) = 7200\r\nCOLLECTIONS_PATHS(/home/username/git/repo/path/ansible.cfg) = ['/home/username/git/repo/path/collections']\r\nCOLLECTIONS_SCAN_SYS_PATH(/home/username/git/repo/path/ansible.cfg) = False\r\nCONFIG_FILE() = /home/username/git/repo/path/ansible.cfg\r\nDEFAULT_BECOME(/home/username/git/repo/path/ansible.cfg) = True\r\nDEFAULT_GATHERING(/home/username/git/repo/path/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/username/git/repo/path/ansible.cfg) = ['/home/username/git/repo/path/inventory/examples']\r\nDEFAULT_JINJA2_NATIVE(/home/username/git/repo/path/ansible.cfg) = True\r\nDEFAULT_LOCAL_TMP(/home/username/git/repo/path/ansible.cfg) = /home/username/git/repo/path/tmp/ansible-local-26591pob9fw99\r\nDEFAULT_ROLES_PATH(/home/username/git/repo/path/ansible.cfg) = ['/home/username/git/repo/path/roles']\r\nDEFAULT_STDOUT_CALLBACK(/home/username/git/repo/path/ansible.cfg) = yaml\r\nDEFAULT_VAULT_ENCRYPT_IDENTITY(/home/username/git/repo/path/ansible.cfg) = files\r\nDEFAULT_VAULT_IDENTITY(/home/username/git/repo/path/ansible.cfg) = files\r\nDEFAULT_VAULT_IDENTITY_LIST(/home/username/git/repo/path/ansible.cfg) = ['common@/home/username/git/repo/path/inventory/examples/.common_pass', 'files@/home/username/git/repo/path/inventory/examples/.files_pass', 'inline@/home/username/git/repo/path/inventory/examples/.inline_pass']\r\nDEFAULT_VAULT_ID_MATCH(/home/username/git/repo/path/ansible.cfg) = True\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/username/git/repo/path/ansible.cfg) = /home/username/git/repo/path/inventory/examples/.files_pass\r\nHOST_KEY_CHECKING(/home/username/git/repo/path/ansible.cfg) = True\r\nINVENTORY_IGNORE_PATTERNS(/home/username/git/repo/path/ansible.cfg) = ['_files', '_vars', 'scripts', 'README.md', 'Vagrantfile']\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(/home/username/git/repo/path/ansible.cfg) = 7200\r\n_uri(/home/username/git/repo/path/ansible.cfg) = /home/username/git/repo/path/tmp/facts_cache\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/username/git/repo/path/ansible.cfg) = True\r\nssh_args(/home/username/git/repo/path/ansible.cfg) = \r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/username/git/repo/path/ansible.cfg) = True\r\npipelining(/home/username/git/repo/path/ansible.cfg) = True\r\nssh_args(/home/username/git/repo/path/ansible.cfg) = \r\nssh_transfer_method(/home/username/git/repo/path/ansible.cfg) = piped\n```\n\n\n### OS / Environment\n\n$ cat /etc/os-release \r\nNAME=\"Oracle Linux Server\"\r\nVERSION=\"9.1\"\r\nID=\"ol\"\r\nID_LIKE=\"fedora\"\r\nVARIANT=\"Server\"\r\nVARIANT_ID=\"server\"\r\nVERSION_ID=\"9.1\"\r\nPLATFORM_ID=\"platform:el9\"\r\nPRETTY_NAME=\"Oracle Linux Server 9.1\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:oracle:linux:9:1:server\"\r\nHOME_URL=\"https://linux.oracle.com/\"\r\nBUG_REPORT_URL=\"https://github.com/oracle/oracle-linux\"\r\n\r\nORACLE_BUGZILLA_PRODUCT=\"Oracle Linux 9\"\r\nORACLE_BUGZILLA_PRODUCT_VERSION=9.1\r\nORACLE_SUPPORT_PRODUCT=\"Oracle Linux\"\r\nORACLE_SUPPORT_PRODUCT_VERSION=9.1\n\n### Steps to Reproduce\n\nThe playbook below needs to be put into a collection _namespace.collection_ . See the referenced feature.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Play namespace.collection.playbook\r\n  any_errors_fatal: true\r\n  gather_facts: false\r\n  collections:\r\n    - namespace.collection\r\n  connection: local\r\n  hosts: localhost\r\n  tasks:\r\n    - name: Debug\r\n      ansible.builtin.debug:\r\n        var: \"{{ ansible_var }}\"\r\n      loop:\r\n        - ansible_collection_name\r\n        - ansible_play_name\r\n      loop_control:\r\n        loop_var: ansible_var\r\n```\r\n\n\n### Expected Results\n\n```txt\r\n[WARNING]: running playbook inside collection ndgit.percona\r\n\r\nPLAY [Play namespace.collection.playbook] ***************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Debug] ***************************************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=ansible_collection_name) => \r\n  ansible_collection_name: namespace.collection\r\n  ansible_loop_var: ansible_var\r\n  ansible_var: ansible_collection_name\r\nok: [localhost] => (item=ansible_play_name) => \r\n  ansible_loop_var: ansible_var\r\n  ansible_play_name: Play namespace.collection.playbook\r\n  ansible_var: ansible_play_name\r\n\r\nPLAY RECAP *****************************************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n```\n\n### Actual Results\n\n```console\n[WARNING]: running playbook inside collection ndgit.percona\r\n\r\nPLAY [Play namespace.collection.playbook] ***************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Debug] ***************************************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=ansible_collection_name) => \r\n  ansible_collection_name: VARIABLE IS NOT DEFINED!\r\n  ansible_loop_var: ansible_var\r\n  ansible_var: ansible_collection_name\r\nok: [localhost] => (item=ansible_play_name) => \r\n  ansible_loop_var: ansible_var\r\n  ansible_play_name: Play namespace.collection.playbook\r\n  ansible_var: ansible_play_name\r\n\r\nPLAY RECAP *****************************************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-20T17:02:21Z",
        "user": "flybyray",
        "labels": [
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79752,
        "title": "omit in delegate_to doesnt works in blocks",
        "body": "### Summary\n\nWe have an include_task, that needs to be delegate to another host sometimes:\r\n\r\n`delegate_to: \"{{ host_to_delegate_to | default(omit) }}\"`\r\n\r\nAfter the update to Ansible 2.14.1 we got problems with that.\r\n\r\nI have written 3 easy tests to reproduce the Problem: \r\n- Test 1 uses delegate_to: omit and works fine.\r\n- Test 2 uses delegate_to: \"\" in a block and works fine.\r\n- Test 3 uses delegate_to: omit in a block an doesn't work.\r\n\r\nWhy does delegate_to: Omit not work in Blocks ?!\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nblock, delegate_to\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = /home/simon/Code/ansible/ansible.cfg\r\n  configured module search path = ['/home/simon/Code/ansible/plugins/library']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/simon/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.1 (main, Dec  7 2022, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nFedora 37\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Test\r\n  hosts: localhost\r\n  tasks:\r\n  - name: Test 1\r\n    ansible.builtin.ping:\r\n      data: \"Pong\"\r\n    delegate_to: \"{{ omit }}\"\r\n\r\n  - name: Test 2\r\n    delegate_to: \"\"\r\n    block:\r\n      - name: Ping\r\n        ansible.builtin.ping:\r\n          data: \"Pong\"\r\n\r\n  - name: Test 3\r\n    delegate_to: \"{{ omit }}\"\r\n    block:\r\n      - name: Ping\r\n        ansible.builtin.ping:\r\n          data: \"Pong\"\r\n\r\n```\r\n\n\n### Expected Results\n\nI expect that everything runs fine, without errors.\n\n### Actual Results\n\n```console\nPLAY [Test] *********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************\r\nDienstag 17 Januar 2023  11:24:21 +0100 (0:00:00.060)       0:00:00.060 ******* \r\nok: [localhost]\r\n\r\nTASK [Test 1] *******************************************************************************************************************************\r\nDienstag 17 Januar 2023  11:24:22 +0100 (0:00:00.829)       0:00:00.889 ******* \r\nok: [localhost]\r\n\r\nTASK [Ping] *********************************************************************************************************************************\r\nDienstag 17 Januar 2023  11:24:22 +0100 (0:00:00.229)       0:00:01.119 ******* \r\nok: [localhost]\r\n\r\nTASK [Ping] *********************************************************************************************************************************\r\nDienstag 17 Januar 2023  11:24:22 +0100 (0:00:00.164)       0:00:01.284 ******* \r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: KeyError: '{{ omit }}'\r\nfatal: [localhost -> {{ omit }}]: FAILED! => \r\n  msg: 'Unexpected failure during module execution: ''{{ omit }}'''\r\n  stdout: ''\r\n\r\nPLAY RECAP **********************************************************************************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-17T10:48:52Z",
        "user": "BachenbergS",
        "labels": [
            "bug",
            "traceback",
            "P3",
            "verified",
            "affects_2.14"
        ]
    },
    {
        "number": 79737,
        "title": "`control_path` default for `ssh` connection plugin does not respect `ANSIBLE_HOME`",
        "body": "### Summary\n\nWhen using the copy module, it creates `$HOME/.ansible/cp` not honouring the configured `$ANSIBLE_HOME`\r\n\r\n```\r\nexport ANSIBLE_HOME=$HOME/.cache/ansible\r\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncopy\n\n### Ansible Version\n\n```console\n$ export ANSIBLE_HOME=$HOME/.cache/ansible\r\n\r\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/simon/.cache/ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.11/site-packages/ansible\r\n  ansible collection location = /home/simon/.cache/ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.11.1 (main, Dec  7 2022, 00:00:00) [GCC 12.2.1 20221121 (Red Hat 12.2.1-4)] (/usr/bin/python3)\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ export ANSIBLE_HOME=$HOME/.cache/ansible\r\n\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_HOME(env: ANSIBLE_HOME) = /home/simon/.cache/ansible\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\nFedora release 37 (Thirty Seven)\r\n\n\n### Steps to Reproduce\n\n\u26a0\ufe0f \r\n\r\n```\r\nexport ANSIBLE_HOME=$HOME/.cache/ansible\r\n\r\nmv $HOME/.ansible $HOME/.ansible.bak\r\ntouch /tmp/foo\r\nansible server.example.com -m copy -a 'src=/tmp/foo dest=/tmp/foo' --check\r\n\r\nstat $HOME/.ansible\r\nfind $HOME/.ansible\n\n### Expected Results\n\n`$HOME/.ansible` does not exist\n\n### Actual Results\n\n```console\n> find $HOME/.ansible\r\n/home/simon/.ansible\r\n/home/simon/.ansible/cp\r\n/home/simon/.ansible/cp/912df56293\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-14T00:54:03Z",
        "user": "simon04",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79725,
        "title": "ansible.builtin.copy module - updates pre-existing files' ownership of dest directory if remote_src: true",
        "body": "### Summary\r\n\r\nWhen using the `copy` module with `remote_src: true`, I'm observing unexpected behavior where the pre-existing files' ownership in the destination folder gets modified by the playbook:\r\n\r\n**Before:**\r\n```\r\n[student@server-1 tmp]$ ll filedest/\r\ntotal 4\r\n-rw-rw-r--. 1 student student 15 Jan  6 15:04 leavemebe.txt\r\n```\r\n**After:**  (existing leavemebe.txt got it's owner/group changed)\r\n```\r\n[root@server-1 ~]# ll /tmp/filedest/\r\ntotal 8\r\n-rw-r--r--. 1 root root 10 Jan  6 15:27 copyme.txt\r\n-rw-rw-r--. 1 root root 15 Jan  6 15:04 leavemebe.txt\r\n```\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.copy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Jan 14 2022, 11:04:20) [GCC 8.5.0 20210514 (Red Hat 8.5.0-7)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRed Hat Enterprise Linux release 8.6 (Ootpa)\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create source and destination files and directories on the remote host client: \r\n```\r\n[student@server-1 ~]$ cd /tmp/\r\n[student@server-1 tmp]$ mkdir filesrc\r\n[student@server-1 tmp]$ mkdir filedest\r\n[student@server-1 tmp]$ vi filesrc/copyme.txt\r\n[student@server-1 tmp]$ vi filedest/leavemebe.txt\r\n[student@server-1 tmp]$ ll filesrc/\r\ntotal 4\r\n-rw-rw-r--. 1 student student 10 Jan  6 15:04 copyme.txt\r\n[student@server-1 tmp]$ ll filedest/\r\ntotal 4\r\n-rw-rw-r--. 1 student student 15 Jan  6 15:04 leavemebe.txt\r\n```\r\n2. Run the playbook on the Ansible host:\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  remote_user: student\r\n  gather_facts: false\r\n\r\n  tasks:\r\n    - name: copy file\r\n      ansible.builtin.copy:\r\n        remote_src: true\r\n        src: /tmp/filesrc/\r\n        dest: /tmp/filedest/\r\n        owner: root\r\n        group: root\r\n      become: true\r\n```\r\n3. After the playbook is run (on the client host):\r\n```\r\n[root@server-1 ~]# ll /tmp/filesrc\r\ntotal 4\r\n-rw-rw-r--. 1 student student 10 Jan  6 15:04 copyme.txt\r\n\r\n[root@server-1 ~]# ll /tmp/filedest/\r\ntotal 8\r\n-rw-r--r--. 1 root root 10 Jan  6 15:27 copyme.txt\r\n-rw-rw-r--. 1 root root 15 Jan  6 15:04 leavemebe.txt\r\n```\r\n\r\nThis behavior only happens with using remote_src: true. When running the copy module on the same Ansible host, this behavior does not occur.\r\n\r\n### Expected Results\r\n\r\nI expected the copy module to only modify the file ownership of the copied files (copyme.txt) and not the pre-existing files' ownerships in the destination directory (leavemebe.txt).\r\n\r\n### Actual Results\r\n\r\nWe can see that the playbook changed both the copied files (copyme.txt) and existing files (leavemebe.txt)'s ownership to root:root in the destination directory.\r\n\r\n```\r\n[root@server-1 ~]# ll /tmp/filedest/\r\ntotal 8\r\n-rw-r--r--. 1 root root 10 Jan  6 15:27 copyme.txt\r\n-rw-rw-r--. 1 root root 15 Jan  6 15:04 leavemebe.txt\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-12T17:38:38Z",
        "user": "angelavuong",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 79695,
        "title": "Allow to mark module parameters as undocumented / private",
        "body": "### Summary\n\nRight now modules that come with action plugins often have some 'private' module parameters that are used by the action plugin, and should not be shown to the user in the documentation. Unfortunately the sanity tests complain about this, and one has to add ignore.txt rules to shut them up. Even more unfortunately, these ignore.txt rules can easily hide *real* mistakes in the documentation.\r\n\r\nI propose to make it possible to explicitly mark options as undocumented or private, so that the sanity tests can enforce that these are undocumented, and no ignore.txt entries are needed.\r\n\r\nA more concrete proposal would be to add something to the argument spec, for example `some_option=dict(type='str', undocumented=True)`. (Adding it somewhere to `DOCUMENTATION` instead makes it show up in the ansible-doc output.)\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nmodule argument spec\n\n### Additional Information\n\nGrep for `validate-modules:undocumented-parameter` in test/sanity/ignore.txt in ansible/ansible:\r\n```\r\nlib/ansible/modules/command.py validate-modules:undocumented-parameter\r\nlib/ansible/modules/copy.py validate-modules:undocumented-parameter\r\nlib/ansible/modules/file.py validate-modules:undocumented-parameter\r\nlib/ansible/modules/stat.py validate-modules:undocumented-parameter\r\nlib/ansible/modules/yum_repository.py validate-modules:undocumented-parameter\r\n```\r\nThere are multiple other entries for the same reason.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-09T10:51:14Z",
        "user": "felixfontein",
        "labels": [
            "has_pr",
            "feature",
            "affects_2.17"
        ]
    },
    {
        "number": 79674,
        "title": "ansible 'NoneType' object is not callable",
        "body": "### Summary\r\n```\r\nansible [core 2.14.1]\r\n  config file = None\r\n  configured module search path = ['/Users/aa/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /Users/aa/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.9 (main, Dec 15 2022, 18:18:30) [Clang 14.0.0 (clang-1400.0.29.202)] (/usr/local/opt/python@3.10/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n ```\r\n\r\nTrying to run mysql5.7 installation:\r\n```\r\n  tasks:\r\n    - name: Install MySQL 5.7 repo\r\n      yum: name=http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm state=present validate_certs=no\r\n```\r\ngetting:\r\n```\r\n\"msg\": \"Failure downloading http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm, 'NoneType' object is not callable\"\r\n```\r\n\r\ndebug logs:\r\n```\r\nThe full traceback is:\r\nWARNING: The below traceback may *not* be related to the actual failure.\r\n  File \"/tmp/ansible_ansible.legacy.yum_payload_MFjqHW/ansible_ansible.legacy.yum_payload.zip/ansible/module_utils/urls.py\", line 2063, in fetch_file\r\n    data = rsp.read(bufsize)\r\nfatal: [10.10.169.16]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_downgrade\": false,\r\n            \"autoremove\": false,\r\n            \"bugfix\": false,\r\n            \"cacheonly\": false,\r\n            \"conf_file\": null,\r\n            \"disable_excludes\": null,\r\n            \"disable_gpg_check\": false,\r\n            \"disable_plugin\": [],\r\n            \"disablerepo\": [],\r\n            \"download_dir\": null,\r\n            \"download_only\": false,\r\n            \"enable_plugin\": [],\r\n            \"enablerepo\": [],\r\n            \"exclude\": [],\r\n            \"install_repoquery\": true,\r\n            \"install_weak_deps\": true,\r\n            \"installroot\": \"/\",\r\n            \"list\": null,\r\n            \"lock_timeout\": 30,\r\n            \"name\": [\r\n                \"http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm\"\r\n            ],\r\n            \"releasever\": null,\r\n            \"security\": false,\r\n            \"skip_broken\": false,\r\n            \"sslverify\": true,\r\n            \"state\": \"present\",\r\n            \"update_cache\": false,\r\n            \"update_only\": false,\r\n            \"use_backend\": \"auto\",\r\n            \"validate_certs\": false\r\n        }\r\n    },\r\n    \"msg\": \"Failure downloading http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm, 'NoneType' object is not callable\"\r\n}\r\n```\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nyum\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.14.1]\r\n  config file = None\r\n  configured module search path = ['/Users/aa/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /Users/aa/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.9 (main, Dec 15 2022, 18:18:30) [Clang 14.0.0 (clang-1400.0.29.202)] (/usr/local/opt/python@3.10/bin/python3.10)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRunning the script on my macos and the execution (mysql installation in this case) should run on a centos 7 vm.\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Install MySQL\r\n  hosts: all:!localhost\r\n  tasks:\r\n    - name: Install MySQL 5.7 repo\r\n      yum: name=http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm state=present validate_certs=no\r\n```\r\n\r\n\r\n** passing the vm ip as an cli -i\r\n\r\n### Expected Results\r\n\r\nmysql to get installed.\r\n\r\n### Actual Results\r\n\r\n```console\r\nFailure:\r\n\r\nThe full traceback is:\r\nWARNING: The below traceback may *not* be related to the actual failure.\r\n  File \"/tmp/ansible_ansible.legacy.yum_payload_MFjqHW/ansible_ansible.legacy.yum_payload.zip/ansible/module_utils/urls.py\", line 2063, in fetch_file\r\n    data = rsp.read(bufsize)\r\nfatal: [10.10.169.16]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_downgrade\": false,\r\n            \"autoremove\": false,\r\n            \"bugfix\": false,\r\n            \"cacheonly\": false,\r\n            \"conf_file\": null,\r\n            \"disable_excludes\": null,\r\n            \"disable_gpg_check\": false,\r\n            \"disable_plugin\": [],\r\n            \"disablerepo\": [],\r\n            \"download_dir\": null,\r\n            \"download_only\": false,\r\n            \"enable_plugin\": [],\r\n            \"enablerepo\": [],\r\n            \"exclude\": [],\r\n            \"install_repoquery\": true,\r\n            \"install_weak_deps\": true,\r\n            \"installroot\": \"/\",\r\n            \"list\": null,\r\n            \"lock_timeout\": 30,\r\n            \"name\": [\r\n                \"http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm\"\r\n            ],\r\n            \"releasever\": null,\r\n            \"security\": false,\r\n            \"skip_broken\": false,\r\n            \"sslverify\": true,\r\n            \"state\": \"present\",\r\n            \"update_cache\": false,\r\n            \"update_only\": false,\r\n            \"use_backend\": \"auto\",\r\n            \"validate_certs\": false\r\n        }\r\n    },\r\n    \"msg\": \"Failure downloading http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm, 'NoneType' object is not callable\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-05T13:00:49Z",
        "user": "aviiiiiiiii",
        "labels": [
            "bug",
            "traceback",
            "P3",
            "verified",
            "affects_2.14"
        ]
    },
    {
        "number": 79664,
        "title": "slow inventory build",
        "body": "### Summary\r\n\r\nin order to build my inventory file i have a directory of files, each file is a group and inside each file is a list of hostnames.  there are no variables or other associated things, just hostnames and groupnames.  there are 108 group files and 58k hostname entries (many duplicated) in all the group files, ~18k unique entries\r\n\r\nwhen i run a python script to pull in these group files and organize them into a json dictionary in the format expected by ansible-inventory it takes less then a second, (fs cache depending)\r\n```\r\n$ time ./inv.py --list | head\r\n{\r\n    \"_meta\": {\r\n        \"hostvars\": {}\r\n    },\r\n    \"all\": {\r\n        \"children\": [\r\n            \"ungrouped\",\r\n            \"nodeg1\",\r\n            \"nodeg2\",\r\n            \"nodeg3\",\r\n...snipped...\r\nreal\t0m0.146s\r\nuser\t0m0.126s\r\nsys\t0m0.021s\r\n```\r\nwhen i run this through ansible-inventory the time ballons to 30seconds\r\n```\r\n$ time ansible-inventory -i ./inv.py --list | head\r\n{\r\n    \"_meta\": {\r\n        \"hostvars\": {}\r\n    },\r\n    \"nodeg1\": {\r\n        \"hosts\": [\r\n            \"host1\",\r\n            \"host2\",\r\n            \"host3\",\r\n            \"host4\",\r\n...snipped...\r\nreal\t0m27.851s\r\nuser\t0m23.119s\r\nsys\t0m4.586s\r\n```\r\ni also ran the inventory command through python performance tool, but i don't know enough about the underpinnings to see if it says anything useful.  (output attached)\r\n\r\nthis previous bug report seems to indicate that there may have been a similar problem in the past that was fixed\r\n\r\nhttps://github.com/ansible/ansible/issues/30534\r\n\r\ni'm not sure if there's a performance issue or if i'm doing something wrong.  any suggestions would be helpful.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ninventory\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/u/mdidome1/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Oct 20 2022, 09:31:56) [GCC 8.5.0 20210514 (Red Hat 8.5.0-15)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n<no changes from the rhel dist config>\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n$ lsb_release -a\r\nLSB Version:\t:core-4.1-amd64:core-4.1-noarch\r\nDistributor ID:\tRedHatEnterprise\r\nDescription:\tRed Hat Enterprise Linux release 8.7 (Ootpa)\r\nRelease:\t8.7\r\nCodename:\tOotpa\r\n\r\n### Steps to Reproduce\r\n\r\nsee summary\r\n\r\n### Expected Results\r\n\r\nsee summary\r\n\r\n### Actual Results\r\n\r\n```console\r\nsee summary\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-04T16:06:57Z",
        "user": "mdidomenico4",
        "labels": [
            "inventory",
            "bug",
            "has_pr",
            "verified",
            "affects_2.14",
            "affects_2.15",
            "affects_2.16"
        ]
    },
    {
        "number": 79662,
        "title": "Regression: loop output now happens at the end of loop, not on each item",
        "body": "### Summary\n\nSee https://github.com/ansible/ansible/issues/14072; since ansible-core 2.14.0 the loop output is again not displayed for each item, but only at the end of the loop.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-core\n\n### Ansible Version\n\n```console\n$ ansible-core >2.14.0\n```\n\n\n### Configuration\n\n```console\nn/a (default settings)\n```\n\n\n### OS / Environment\n\nDebian/Ubuntu\n\n### Steps to Reproduce\n\nn/a\r\n\n\n### Expected Results\n\nI expect loops to show their progress for each item that is being progressed\n\n### Actual Results\n\n```console\nLoops now only show the steps once the task has finished as a whole\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2023-01-04T14:05:31Z",
        "user": "djpbessems",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.14"
        ]
    },
    {
        "number": 79639,
        "title": "`expect` module tries to chdir before checking `removes` condition",
        "body": "### Summary\n\n`ansible.builtin.expect` supports two parameters:\r\n* `chdir` - change to a directory before executing the command\r\n* `removes` - prevent the task from running if the file/directory does not exist\r\n\r\nTechnically nothing prevents me from setting both parameters to the same value. For example, I want to make a task that uninstalls a piece of software which requires admin password interactively when launched:\r\n```yaml\r\n- tasks:\r\n  name: Uninstall My Product\r\n  ansible.builtin.expect:\r\n    command: ./uninstall\r\n    chdir: /opt/my_product\r\n    removes: /opt/my_product\r\n    responses:\r\n      password: \"{{ admin_password }}\"\r\n```\r\n\r\nI would expect that if the product has already been uninstalled, the task won't even start. However, in fact it first tries to chdir, and only then checks for other conditions - which results in the task failure.\r\n\r\nFrom [the code](https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/expect.py#L177-L203) it seems pretty easy to fix: just reorder the checks and put `if chdir` after `if removes`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nexpect\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  executable location = /home/go/.local/bin/ansible\r\n  python version = 3.10.5 (main, Jul 25 2022, 15:52:08) [GCC 11.2.1 20220219] (/usr/bin/python3)\r\n  jinja version = 3.1.2\r\n  libyaml = False\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /home/ansible.cfg\r\nDEFAULT_GATHERING(/home/ansible.cfg) = explicit\r\nDEFAULT_REMOTE_USER(/home/ansible.cfg) = codemaster\r\nHOST_KEY_CHECKING(/home/ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nAlpine Linux 3.16 (in Docker)\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\nRun the following task, making sure `/opt/my_product` does **not** exist:\r\n```yaml (paste below)\r\n- tasks:\r\n  name: Uninstall My Product\r\n  ansible.builtin.expect:\r\n    command: ./uninstall\r\n    chdir: /opt/my_product\r\n    removes: /opt/my_product\r\n    responses:\r\n      password: \"{{ admin_password }}\"\r\n```\r\n\n\n### Expected Results\n\nThe task doesn't start.\n\n### Actual Results\n\n```console\nThe task fails with the following error:\r\n\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: FileNotFoundError: [Errno 2] No such file or directory: '/opt/my_product'\r\nfatal: [10.10.10.10]: FAILED! => {\"ansible_facts\": {\"discovered_interpreter_python\": \"/usr/bin/python3\"}, \"changed\": false, \"module_stderr\": \"Shared connection to 10.10.10.10 closed.\\r\\n\", \"module_stdout\": \"Traceback (most recent call last):\\r\\n  File \\\"/home/.ansible/tmp/ansible-tmp-1672400758.9359515-1033-89246968079234/AnsiballZ_expect.py\\\", line 107, in <module>\\r\\n    _ansiballz_main()\\r\\n  File \\\"/home/.ansible/tmp/ansible-tmp-1672400758.9359515-1033-89246968079234/AnsiballZ_expect.py\\\", line 99, in _ansiballz_main\\r\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\r\\n  File \\\"/home/.ansible/tmp/ansible-tmp-1672400758.9359515-1033-89246968079234/AnsiballZ_expect.py\\\", line 47, in invoke_module\\r\\n    runpy.run_module(mod_name='ansible.modules.expect', init_globals=dict(_module_fqn='ansible.modules.expect', _modlib_path=modlib_path),\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 224, in run_module\\r\\n    return _run_module_code(code, init_globals, run_name, mod_spec)\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 96, in _run_module_code\\r\\n    _run_code(code, mod_globals, init_globals,\\r\\n  File \\\"/usr/lib/python3.10/runpy.py\\\", line 86, in _run_code\\r\\n    exec(code, run_globals)\\r\\n  File \\\"/tmp/ansible_ansible.builtin.expect_payload_mgdqffya/ansible_ansible.builtin.expect_payload.zip/ansible/modules/expect.py\\\", line 258, in <module>\\r\\n  File \\\"/tmp/ansible_ansible.builtin.expect_payload_mgdqffya/ansible_ansible.builtin.expect_payload.zip/ansible/modules/expect.py\\\", line 179, in main\\r\\nFileNotFoundError: [Errno 2] No such file or directory: '/opt/my_product'\\r\\n\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-30T12:17:25Z",
        "user": "ostankin",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79636,
        "title": "list index out of range with strategy: free",
        "body": "### Summary\r\n\r\nGetting `ERROR! Unexpected Exception, this is probably a bug: list index out of range` while running a playbook with strategy: free with lots of hosts, around 2000 with -f 300\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/plugins/strategy/free\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible [core 2.14.1]\r\n  config file = /home/opc/oracle-infrastructure/ansible.cfg\r\n  configured module search path = ['/home/opc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/opc/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/opc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/opc/.local/bin/ansible\r\n  python version = 3.9.13 (main, Nov 16 2022, 15:11:16) [GCC 8.5.0 20210514 (Red Hat 8.5.0-15.0.1)] (/usr/bin/python3.9)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCACHE_PLUGIN(/home/opc/oracle-infrastructure/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/home/opc/oracle-infrastructure/ansible.cfg) = ./.cache/ansible-fact-cache\r\nCACHE_PLUGIN_TIMEOUT(/home/opc/oracle-infrastructure/ansible.cfg) = 15552000\r\nCALLBACKS_ENABLED(/home/opc/oracle-infrastructure/ansible.cfg) = ['profile_tasks']\r\nCONFIG_FILE() = /home/opc/oracle-infrastructure/ansible.cfg\r\nDEFAULT_FORKS(/home/opc/oracle-infrastructure/ansible.cfg) = 50\r\nDEFAULT_GATHERING(/home/opc/oracle-infrastructure/ansible.cfg) = smart\r\nDEFAULT_GATHER_SUBSET(/home/opc/oracle-infrastructure/ansible.cfg) = ['all']\r\nDEFAULT_HOST_LIST(/home/opc/oracle-infrastructure/ansible.cfg) = ['/home/opc/oracle-infrastructure/inventory.oci.yml']\r\nDEFAULT_LOG_PATH(/home/opc/oracle-infrastructure/ansible.cfg) = /home/opc/oracle-infrastructure/.logs/ansible.log\r\nDEFAULT_PRIVATE_KEY_FILE(/home/opc/oracle-infrastructure/ansible.cfg) = /home/opc/.ssh/cloud\r\nDEFAULT_REMOTE_USER(/home/opc/oracle-infrastructure/ansible.cfg) = ubuntu\r\nDEFAULT_TIMEOUT(/home/opc/oracle-infrastructure/ansible.cfg) = 60\r\nDEPRECATION_WARNINGS(/home/opc/oracle-infrastructure/ansible.cfg) = False\r\nDISPLAY_ARGS_TO_STDOUT(/home/opc/oracle-infrastructure/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/home/opc/oracle-infrastructure/ansible.cfg) = False\r\nINVENTORY_CACHE_ENABLED(/home/opc/oracle-infrastructure/ansible.cfg) = True\r\nINVENTORY_CACHE_PLUGIN(/home/opc/oracle-infrastructure/ansible.cfg) = jsonfile\r\nRETRY_FILES_ENABLED(/home/opc/oracle-infrastructure/ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/home/opc/oracle-infrastructure/ansible.cfg) = /home/opc/oracle-infrastructure/.logs/retries\r\nTRANSFORM_INVALID_GROUP_CHARS(/home/opc/oracle-infrastructure/ansible.cfg) = ignore\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_timeout(/home/opc/oracle-infrastructure/ansible.cfg) = 15552000\r\n_uri(/home/opc/oracle-infrastructure/ansible.cfg) = /home/opc/oracle-infrastructure/.cache/ansible-fact-cache\r\n\r\nCALLBACK:\r\n========\r\n\r\ndefault:\r\n_______\r\nshow_per_host_start(/home/opc/oracle-infrastructure/ansible.cfg) = True\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/opc/oracle-infrastructure/ansible.cfg) = False\r\nremote_user(/home/opc/oracle-infrastructure/ansible.cfg) = ubuntu\r\nssh_args(/home/opc/oracle-infrastructure/ansible.cfg) = -o ServerAliveInterval=30 -o ControlMaster=auto -o ControlPersist=10m\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/opc/oracle-infrastructure/ansible.cfg) = False\r\npipelining(/home/opc/oracle-infrastructure/ansible.cfg) = True\r\nprivate_key_file(/home/opc/oracle-infrastructure/ansible.cfg) = ~/.ssh/cloud\r\nreconnection_retries(/home/opc/oracle-infrastructure/ansible.cfg) = 2\r\nremote_user(/home/opc/oracle-infrastructure/ansible.cfg) = ubuntu\r\nssh_args(/home/opc/oracle-infrastructure/ansible.cfg) = -o ServerAliveInterval=30 -o ControlMaster=auto -o ControlPersist=10m\r\ntimeout(/home/opc/oracle-infrastructure/ansible.cfg) = 60\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nOracle Linux (based on CentOS 8)\r\n\r\n### Steps to Reproduce\r\n\r\nIts intermittent\r\n\r\n### Expected Results\r\n\r\nShould not break\r\n\r\n### Actual Results\r\n\r\n```console\r\nERROR! Unexpected Exception, this is probably a bug: list index out of range\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/opc/.local/lib/python3.9/site-packages/ansible/cli/__init__.py\", line 647, in cli_executor\r\n    exit_code = cli.run()\r\n  File \"/home/opc/.local/lib/python3.9/site-packages/ansible/cli/playbook.py\", line 143, in run\r\n    results = pbex.run()\r\n  File \"/home/opc/.local/lib/python3.9/site-packages/ansible/executor/playbook_executor.py\", line 190, in run\r\n    result = self._tqm.run(play=play)\r\n  File \"/home/opc/.local/lib/python3.9/site-packages/ansible/executor/task_queue_manager.py\", line 333, in run\r\n    play_return = strategy.run(iterator, play_context)\r\n  File \"/home/opc/.local/lib/python3.9/site-packages/ansible/plugins/strategy/free.py\", line 101, in run\r\n    host = hosts_left[last_host]\r\nIndexError: list index out of range\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-28T15:53:33Z",
        "user": "williamoliveira",
        "labels": [
            "bug",
            "traceback",
            "needs_verified",
            "affects_2.14"
        ]
    },
    {
        "number": 79631,
        "title": "Spurious warning when using a custom fact module",
        "body": "### Summary\n\nWhen using a custom fact module, a warning is printed about \"ignoring subset(None)\".\r\n\r\nThis warning has been [reported before](https://github.com/ansible/ansible/issues/68532#issuecomment-620868819) and a [commented upon](https://github.com/ansible/ansible/issues/68532#issuecomment-621410150) but it appears that the fix was left out.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngather_facts.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.14.1]\r\n  config file = None\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/.local/pipx/venvs/ansible/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/user/.local/bin/ansible\r\n  python version = 3.10.6 (main, Nov 14 2022, 16:10:14) [GCC 11.3.0] (/home/user/.local/pipx/venvs/ansible/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nCONFIG_FILE() = None\n```\n\n\n### OS / Environment\n\nLinux\n\n### Steps to Reproduce\n\nThe custom fact module looks like this:\r\n\r\n```\r\n#!/bin/sh\r\n\r\necho '{\"ansible_facts\": {\"myfact\": \"hello!\"}}'\r\n```\r\n\r\nWhen the custom fact module is picked up by ansible, a warning is printed about \"Ignoring subset(None)\":\r\n\r\n```\r\nANSIBLE_LIBRARY=./library ANSIBLE_FACTS_MODULES=myfacts,smart ansible -m gather_facts  localhost | grep myfact\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: Ignoring subset(None) for myfacts\r\n            \"ANSIBLE_FACTS_MODULES\": \"myfacts,smart\",\r\n        \"myfact\": \"hello!\"\r\n```\r\n\n\n### Expected Results\n\nCustom fact module to be used without warnings.\n\n### Actual Results\n\n```console\nSpurious warning is printed.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-27T05:21:15Z",
        "user": "andreby",
        "labels": [
            "module",
            "bug",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79624,
        "title": "Argument Spec Validation Failure with vault + no_log",
        "body": "### Summary\n\nThe argument validation process fails when passing a vault-encrypted value to a no_log role parameter\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nvalidate_argument_spec\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\nansible [core 2.14.1]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/bwertman/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/bwertman/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.8 (main, Nov  1 2022, 14:18:21) [GCC 12.2.0] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\n```\n\n\n### OS / Environment\n\nArch Linux (Rolling Release)\n\n### Steps to Reproduce\n\n```yaml\r\n# roles/validated_args/meta/argument_specs.yml\r\nargument_specs:\r\n  main:\r\n    options:\r\n      my_token:\r\n        no_log: True\r\n```\r\n\r\n```yaml\r\n# roles/validated_args/tasks/main.yml\r\n- debug:\r\n    var: my_token\r\n```\r\n\r\n```yaml\r\n# validate_args.yml\r\n- hosts: localhost\r\n  vars:\r\n    my_token: !vault |\r\n          $ANSIBLE_VAULT;1.1;AES256\r\n          32336162303235386136653837646531653032623266366434313839646630653434623161393433\r\n          3533363934643334313436663363616133663232613731330a323062376464653663666136646364\r\n          66653765646336393765366264343337386631373238613235356264643835653132336164373433\r\n          3862313933363130610a666432393561633735313031653039303434323561363565316630313137\r\n          62616364666366613033623062396438356338316665356462356631363263366265\r\n  roles:\r\n    - validated_args\r\n```\r\n\r\nTo reproduce:\r\n\r\n```sh\r\necho '1234' > pwdfile # Write dummy vault password file\r\nansible-playbook --vault-password-file=pwdfile validate_args.yml\r\n```\r\n\n\n### Expected Results\n\nI expected the playbook to run, and treat the decrypted value of the `my_token` parameter as a value to mask from the log output\n\n### Actual Results\n\n```console\nansible-playbook [core 2.14.1]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/bwertman/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/bwertman/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.10.8 (main, Nov  1 2022, 14:18:21) [GCC 12.2.0] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python3.10/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: validate_args.yml **********************************************************************************************************************************************\r\nPositional arguments: validate_args.yml\r\nverbosity: 4\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/etc/ansible/hosts',)\r\nvault_password_files: ('/home/bwertman/projects/ansible-test/pwdfile',)\r\nforks: 5\r\n1 plays in validate_args.yml\r\n\r\nPLAY [localhost] *********************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************\r\ntask path: /home/bwertman/projects/ansible-test/validate_args.yml:1\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: bwertman\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~bwertman && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/bwertman/.ansible/tmp `\"&& mkdir \"` echo /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376 `\" && echo ansible-tmp-1671741656.6071613-228472-9432455552376=\"` echo /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.10/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/bwertman/.ansible/tmp/ansible-local-2284639lbjh21p/tmpls6vbkid TO /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376/ /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/bwertman/.ansible/tmp/ansible-tmp-1671741656.6071613-228472-9432455552376/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [validated_args : Validating arguments against arg spec 'main'] *****************************************************************************************************\r\ntask path: /home/bwertman/projects/ansible-test/validate_args.yml:1\r\nTrying secret FileVaultSecret(filename='/home/bwertman/projects/ansible-test/pwdfile') for vault_id=default\r\nTrying secret FileVaultSecret(filename='/home/bwertman/projects/ansible-test/pwdfile') for vault_id=default\r\nfatal: [localhost]: FAILED! => {\r\n    \"argument_errors\": [\r\n        \"Failed to convert \\\"my_token\\\": Unknown parameter type: <class 'ansible.parsing.yaml.objects.AnsibleVaultEncryptedUnicode'>\"\r\n    ],\r\n    \"argument_spec_data\": {\r\n        \"my_token\": {\r\n            \"no_log\": true\r\n        }\r\n    },\r\n    \"changed\": false,\r\n    \"msg\": \"Validation of arguments failed:\\nFailed to convert \\\"my_token\\\": Unknown parameter type: <class 'ansible.parsing.yaml.objects.AnsibleVaultEncryptedUnicode'>\",\r\n    \"validate_args_context\": {\r\n        \"argument_spec_name\": \"main\",\r\n        \"name\": \"validated_args\",\r\n        \"path\": \"/home/bwertman/projects/ansible-test/roles/validated_args\",\r\n        \"type\": \"role\"\r\n    }\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-22T20:56:58Z",
        "user": "CasualSuperman",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79602,
        "title": "Better error message when ACLs can not be used with become_user and files",
        "body": "### Summary\r\n\r\nOn Ubuntu 22.04 **without** acl installed, installing files via e.g the built-in template module fails with an obscure, hard-to-debug error.\r\n\r\nWhich was pretty tough to figure out, until a kind soul in `#ansible` figured out it is probably because of the acl package missing.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ntemplate\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.14.0]\r\n  config file = /home/user/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.8 (main, Nov  1 2022, 14:18:21) [GCC 12.2.0] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOWS(env: ANSIBLE_NOCOWS) = True\r\nCONFIG_FILE() = /home/user/ansible/ansible.cfg\r\nDEFAULT_GATHERING(/home/user/ansible/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/user/ansible/ansible.cfg) = ['/home/user/ansible/inventories/hosts']\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/user/ansible/ansible.cfg) = /home/user/ansible/vault-password.sh\r\nDIFF_ALWAYS(/home/user/ansible/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/home/user/ansible/ansible.cfg) = True\r\nRETRY_FILES_ENABLED(/home/user/ansible/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nHost executing playbook: Arch Linux\r\nHost targeted by playbook (aka the relevant one) Ubuntu 22.04 without the acl package\r\n\r\n### Steps to Reproduce\r\n\r\n1. Have a Ubuntu 22.04 host without the acl package.\r\n2. Try to write any template with `become: yes` and `become_user` set to something other than root.\r\n3. Weird error.\r\n\r\n```yaml (paste below)\r\n- name: Install some configs\r\n  template:\r\n    src: config.conf.j2\r\n    dest: /home/whatever/server/conf/config.conf\r\n  become: yes\r\n  become_user: whatever\r\n```\r\n\r\n### Expected Results\r\n\r\nThere was a discussion in the IRC about this (with @jborean93 involved) and apparently this should fallback to chown when acls are not available? In any case, I would like a better error, like this:\r\n\r\n```\r\nsetfacl is not present, unable to securely stash file. Make sure the acl (or similar) package is installed.\r\n```\r\n\r\njborean93 also said there should be some output of why it is not falling back - <s>but there is none</s>.\r\n\r\n<details>\r\n<summary>Debug output</summary>\r\n\r\n```yaml\r\n<myhost> PUT /home/user/.ansible/tmp/ansible-local-28268349zq57koo/tmpt1k6jq3d/sql_connection.conf.j2 TO /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source\r\n<myhost> SSH: EXEC scp -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' /home/user/.ansible/tmp/ansible-local-28268349zq57koo/tmpt1k6jq3d/sql_connection.conf.j2 '[myhost]:/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source'\r\n<myhost> (0, b'', b'')\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'setfacl -m u:whatever:r-x /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source && sleep 0'\"'\"''\r\n<myhost> (127, b'', b'/bin/sh: 1: setfacl: not found\\n')\r\n<myhost> Failed to connect to the host via ssh: /bin/sh: 1: setfacl: not found\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'chmod u+x/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source && sleep 0'\"'\"''\r\n<myhost> (0, b'', b'')\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'chown whatever /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source && sleep 0'\"'\"''\r\n<myhost> (1, b'', b\"chown: changing ownership of '/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/': Operation not permitted\\nchown: changing ownership of '/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source': Operation not permitted\\n\")\r\n<myhost> Failed to connect to the host via ssh: chown: changing ownership of '/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/': Operation not permitted\r\nchown: changing ownership of '/var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source': Operation not permitted\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'chmod +a '\"'\"'\"'\"'\"'\"'\"'\"'whatever allow read,execute'\"'\"'\"'\"'\"'\"'\"'\"' /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source && sleep 0'\"'\"''\r\n<myhost> (1, b'', b\"chmod: invalid mode: \\xe2\\x80\\x98+a\\xe2\\x80\\x99\\nTry 'chmod --help' for more information.\\n\")\r\n<myhost> Failed to connect to the host via ssh: chmod: invalid mode: \u2018+a\u2019\r\nTry 'chmod --help' for more information.\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'chmod A+user:whatever:rx:allow /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/source && sleep 0'\"'\"''\r\n<myhost> (1, b'', b\"chmod: invalid mode: \\xe2\\x80\\x98A+user:whatever:rx:allow\\xe2\\x80\\x99\\nTry 'chmod --help' formore information.\\n\")\r\n<myhost> Failed to connect to the host via ssh: chmod: invalid mode: \u2018A+user:whatever:rx:allow\u2019\r\nTry 'chmod --help' for more information.\r\n<myhost> ESTABLISH SSH CONNECTION FOR USER: ansible\r\n<myhost> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ansible\"' -oConnectTimeout=10 -o 'ControlPath=\"/home/user/.ansible/cp/0b2c09e441\"' myhost '/bin/sh -c '\"'\"'rm -f -r /var/tmp/ansible-tmp-1671057208.3739493-2827495-271719294275461/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<myhost> (0, b'', b'')\r\nfatal: [myhost]: FAILED! => {\r\n    \"msg\": \"Failed to set permissions on the temporary files Ansible needs to create when becoming an unprivileged user(rc: 1, err: chmod: invalid mode: \u2018A+user:whatever:rx:allow\u2019\\nTry 'chmod --help' for more information.\\n}). For information on working around this, see https://docs.ansible.com/ansible-core/2.14/user_guide/become.html#risks-of-becoming-an-unprivileged-user\"\r\n}\r\n```\r\n</details>\r\n\r\nAs I said, the second I installed `acl` this has resolved. `become_user` has always worked so far on this host, until I tried to push this template.\r\n\r\n### Actual Results\r\n\r\n```console\r\n(1, b'', b\"chmod: invalid mode: \\xe2\\x80\\x98A+user:whatever:rx:allow\\xe2\\x80\\x99\\nTry 'chmod --help' formore information.\\n\")\r\nFailed to connect to the host via ssh: chmod: invalid mode: \u2018A+user:whatever:rx:allow\u2019\r\nTry 'chmod --help' for more information.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-14T23:10:30Z",
        "user": "NetSysFire",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79592,
        "title": "ansible.builtin.uri doesn't return `json` dict when python interpreter is python2.",
        "body": "### Summary\r\n\r\nWhen upgrading some roles from `ansible 2.11.1` to `ansible 2.13.7` I discovered a regression in the behavior of the `ansible.builtin.uri` module.\r\n\r\nRequirements for the regression to appear:\r\n- control host is running `ansible  2.13+` with `python3`\r\n- target host is running `python2` as the default python bin/interpreter\r\n- uri module / server returns a GET request with the response headers `Content-type: application/json` and the content is a valid `json` string, but the response code is not `200`\r\n\r\nThe expected return values in ansible should include the key in the dictionary `json` with the content loaded. When the above  requirements are met this does not happen.\r\n\r\nThe module [documentation](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/uri_module.html#parameter-return_content) states the following about `return_content` key.\r\n\r\n>Independently of this option, if the reported Content-type is \u201capplication/json\u201d, then the JSON is always loaded into a key called json in the dictionary results.\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.uri\r\n\r\n### Ansible Version\r\n\r\n```console\r\nIssue not present: ansible-core==2.11.1\r\nIssue not present: ansible-core==2.12.10\r\n\r\nIssue present: \r\n  - ansible-core==2.13.7\r\n  - ansible-core==2.14.1\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nsee molecule / example role.\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nCentos7 / Python2 interpreter\r\n\r\n### Steps to Reproduce\r\n\r\nRun the below and see that the bug does not exist in 2.11 when the target host has python2 running\r\n\r\n```shell\r\ngit clone https://github.com/stenh0use/ansible-uri-issue.git\r\npython3 -m venv .venv\r\n. .venv/bin/activate\r\npip install -r requirements_2.11.1.txt\r\n# see that the json dictionary is returned\r\nmolecule converge\r\n```\r\n\r\nRun the below and then see that the bug does exist once upgrading to 2.13+ and the target host has python2 running\r\n```shell\r\nrm -rf .venv\r\npython3 -m venv .venv\r\n. .venv/bin/activate\r\npip install -r requirements_2.13.7.txt\r\n# see that the json dictionary is not returned\r\nmolecule converge\r\n```\r\n\r\n\r\n\r\n### Expected Results\r\n\r\nI expect the json dict key to be populated even when the response code is not 200, but is in the expected list as per the documentation.\r\n\r\n### Actual Results\r\n\r\n```console\r\n\ud83d\ude2b $ molecule converge\r\nINFO     default scenario test matrix: dependency, create, prepare, converge\r\nINFO     Performing prerun with role_name_check=0...\r\nINFO     Set ANSIBLE_LIBRARY=/Users/jstenhouse/.cache/ansible-compat/70e5d7/modules:/Users/jstenhouse/.ansible/plugins/modules:/usr/share/ansible/plugins/modules\r\nINFO     Set ANSIBLE_COLLECTIONS_PATH=/Users/jstenhouse/.cache/ansible-compat/70e5d7/collections:/Users/jstenhouse/alpha/infra/ansible/collections\r\nINFO     Set ANSIBLE_ROLES_PATH=/Users/jstenhouse/.cache/ansible-compat/70e5d7/roles:/Users/jstenhouse/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/Users/jstenhouse/alpha/infra/ansible/roles:/Users/jstenhouse/alpha/infra/ansible-cloud/roles\r\nINFO     Running default > dependency\r\nWARNING  Skipping, missing the requirements file.\r\nWARNING  Skipping, missing the requirements file.\r\nINFO     Running default > create\r\nWARNING  Skipping, instances already created.\r\nINFO     Running default > prepare\r\nWARNING  Skipping, prepare playbook not configured.\r\nINFO     Running default > converge\r\nINFO     Sanity checks: 'docker'\r\n\r\nPLAY [Converge] ****************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [centos8]\r\nok: [centos7]\r\n\r\nTASK [uri : ansible.builtin.include_tasks] *************************************\r\nincluded: /Users/jstenhouse/dev/github/uri/tasks/uri_get.yml for centos7, centos8 => (item=200)\r\nincluded: /Users/jstenhouse/dev/github/uri/tasks/uri_get.yml for centos7, centos8 => (item=429)\r\nincluded: /Users/jstenhouse/dev/github/uri/tasks/uri_get.yml for centos7, centos8 => (item=501)\r\nincluded: /Users/jstenhouse/dev/github/uri/tasks/uri_get.yml for centos7, centos8 => (item=503)\r\n\r\nTASK [uri : get json response with code 200] ***********************************\r\nok: [centos7]\r\nok: [centos8]\r\n\r\nTASK [uri : ansible.builtin.debug] *********************************************\r\nok: [centos7] => {\r\n    \"response\": {\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"cookies\": {},\r\n        \"cookies_string\": \"\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:52 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"hello\": \"world\"\r\n        },\r\n        \"msg\": \"OK (20 bytes)\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 200,\r\n        \"url\": \"http://server:5000/200\"\r\n    }\r\n}\r\nok: [centos8] => {\r\n    \"response\": {\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"cookies\": {},\r\n        \"cookies_string\": \"\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:53 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"hello\": \"world\"\r\n        },\r\n        \"msg\": \"OK (20 bytes)\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 200,\r\n        \"url\": \"http://server:5000/200\"\r\n    }\r\n}\r\n\r\nTASK [uri : assert json dict exists] *******************************************\r\nok: [centos7] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\nok: [centos8] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [uri : ansible.builtin.set_fact] ******************************************\r\nskipping: [centos7]\r\nskipping: [centos8]\r\n\r\nTASK [uri : get json response with code 429] ***********************************\r\nok: [centos7]\r\nok: [centos8]\r\n\r\nTASK [uri : ansible.builtin.debug] *********************************************\r\nok: [centos7] => {\r\n    \"response\": {\r\n        \"body\": \"{ \\\"hello\\\": \\\"world\\\" }\",\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:55 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"msg\": \"HTTP Error 429: TOO MANY REQUESTS\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 429,\r\n        \"url\": \"http://server:5000/429\"\r\n    }\r\n}\r\nok: [centos8] => {\r\n    \"response\": {\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:55 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"hello\": \"world\"\r\n        },\r\n        \"msg\": \"HTTP Error 429: TOO MANY REQUESTS\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 429,\r\n        \"url\": \"http://server:5000/429\"\r\n    }\r\n}\r\n\r\nTASK [uri : assert json dict exists] *******************************************\r\nfatal: [centos7]: FAILED! => {\r\n    \"assertion\": \"response.json is defined\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\r\n...ignoring\r\nok: [centos8] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [uri : ansible.builtin.set_fact] ******************************************\r\nok: [centos7]\r\nskipping: [centos8]\r\n\r\nTASK [uri : get json response with code 501] ***********************************\r\nok: [centos7]\r\nok: [centos8]\r\n\r\nTASK [uri : ansible.builtin.debug] *********************************************\r\nok: [centos7] => {\r\n    \"response\": {\r\n        \"body\": \"{ \\\"hello\\\": \\\"world\\\" }\",\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:58 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"msg\": \"HTTP Error 501: NOT IMPLEMENTED\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 501,\r\n        \"url\": \"http://server:5000/501\"\r\n    }\r\n}\r\nok: [centos8] => {\r\n    \"response\": {\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:53:59 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"hello\": \"world\"\r\n        },\r\n        \"msg\": \"HTTP Error 501: NOT IMPLEMENTED\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 501,\r\n        \"url\": \"http://server:5000/501\"\r\n    }\r\n}\r\n\r\nTASK [uri : assert json dict exists] *******************************************\r\nfatal: [centos7]: FAILED! => {\r\n    \"assertion\": \"response.json is defined\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\r\n...ignoring\r\nok: [centos8] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [uri : ansible.builtin.set_fact] ******************************************\r\nskipping: [centos8]\r\nok: [centos7]\r\n\r\nTASK [uri : get json response with code 503] ***********************************\r\nok: [centos7]\r\nok: [centos8]\r\n\r\nTASK [uri : ansible.builtin.debug] *********************************************\r\nok: [centos7] => {\r\n    \"response\": {\r\n        \"body\": \"{ \\\"hello\\\": \\\"world\\\" }\",\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:54:01 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"msg\": \"HTTP Error 503: SERVICE UNAVAILABLE\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 503,\r\n        \"url\": \"http://server:5000/503\"\r\n    }\r\n}\r\nok: [centos8] => {\r\n    \"response\": {\r\n        \"changed\": false,\r\n        \"connection\": \"close\",\r\n        \"content_length\": \"20\",\r\n        \"content_type\": \"application/json\",\r\n        \"date\": \"Tue, 13 Dec 2022 19:54:02 GMT\",\r\n        \"elapsed\": 0,\r\n        \"failed\": false,\r\n        \"json\": {\r\n            \"hello\": \"world\"\r\n        },\r\n        \"msg\": \"HTTP Error 503: SERVICE UNAVAILABLE\",\r\n        \"redirected\": false,\r\n        \"server\": \"Werkzeug/2.2.2 Python/3.11.1\",\r\n        \"status\": 503,\r\n        \"url\": \"http://server:5000/503\"\r\n    }\r\n}\r\n\r\nTASK [uri : assert json dict exists] *******************************************\r\nfatal: [centos7]: FAILED! => {\r\n    \"assertion\": \"response.json is defined\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\r\n...ignoring\r\nok: [centos8] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [uri : ansible.builtin.set_fact] ******************************************\r\nskipping: [centos8]\r\nok: [centos7]\r\n\r\nTASK [uri : ansible.builtin.debug] *********************************************\r\nok: [centos7] => {\r\n    \"ansible_facts.python_version\": \"2.7.5\"\r\n}\r\nok: [centos8] => {\r\n    \"ansible_facts.python_version\": \"3.6.8\"\r\n}\r\n\r\nTASK [uri : ansible.builtin.assert] ********************************************\r\nfatal: [centos7]: FAILED! => {\r\n    \"assertion\": \"not (json_dict_missing | default(false) | bool)\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"one or more uri responses had a missing json_dict.\\nfailed status codes: \\\"[429, 501, 503]\\\"\\n\"\r\n}\r\nok: [centos8] => {\r\n    \"changed\": false,\r\n    \"msg\": \"all test cases passed\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\ncentos7                    : ok=21   changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=3   \r\ncentos8                    : ok=19   changed=0    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0\r\n\r\nWARNING  Retrying execution failure 2 of: ansible-playbook --inventory /Users/jstenhouse/.cache/molecule/uri/default/inventory --skip-tags molecule-notest,notest /Users/jstenhouse/dev/github/uri/molecule/default/converge.yml\r\nCRITICAL Ansible return code was 2, command was: ['ansible-playbook', '--inventory', '/Users/jstenhouse/.cache/molecule/uri/default/inventory', '--skip-tags', 'molecule-notest,notest', '/Users/jstenhouse/dev/github/uri/molecule/default/converge.yml']\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-13T19:54:41Z",
        "user": "stenh0use",
        "labels": [
            "module",
            "bug",
            "P3",
            "verified",
            "affects_2.11"
        ]
    },
    {
        "number": 79587,
        "title": "Remove file or directory with chattr in one task",
        "body": "### Summary\r\n\r\nI'm trying to delete a directory that has the attribute with chattr +a, but I can not do it even specifing -a. I believe it could done in two tasks.\r\n\r\n1 - Create directory with chattr +a\r\n2 - Delete directory with chattr -a\r\n\r\nToday is only possible in three tasks.\r\n\r\n1 - Create directory with chattr +a\r\n2 - Remove the attribute -a of the directory\r\n3 - Delete directory\r\n\r\nSince the module is able to create files or directories with attributes in one task, it should also be able to **undo** it.\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.file\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.11.12] \r\n  config file = /home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg\r\n  configured module search path = ['/home/marcos/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  ansible collection location = /opt/ansible/collections:/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.15 (default, Sep 23 2021, 15:41:43) [GCC]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nCALLBACKS_ENABLED(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = ['ansible.posix.timer', 'ansible.posix.profile_roles', 'ansible.posix.profile_tasks', 'ansible.builtin.oneline']\r\nCOLLECTIONS_PATHS(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = ['/opt/ansible/collections', '/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/collections']\r\nDEFAULT_FORKS(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = 10\r\nDEFAULT_HOST_LIST(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = ['/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/inventories/docker/hosts.ini']\r\nDEFAULT_PRIVATE_ROLE_VARS(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = True\r\nDEFAULT_ROLES_PATH(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = ['/opt/ansible/roles', '/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/roles']\r\nDEFAULT_TIMEOUT(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = 15\r\nDEPRECATION_WARNINGS(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/marcos/desenvolvimento/workspace_infra/InfraAsCode/ansible/linux/ansible.cfg) = auto\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nNAME=\"openSUSE Leap\"\r\nVERSION=\"15.3\"\r\nID=\"opensuse-leap\"\r\nID_LIKE=\"suse opensuse\"\r\nVERSION_ID=\"15.3\"\r\nPRETTY_NAME=\"openSUSE Leap 15.3\"\r\nANSI_COLOR=\"0;32\"\r\nCPE_NAME=\"cpe:/o:opensuse:leap:15.3\"\r\nBUG_REPORT_URL=\"https://bugs.opensuse.org\"\r\nHOME_URL=\"https://www.opensuse.org/\"\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n---\r\n- hosts: all\r\n  become: true\r\n  gather_facts: true\r\n\r\n  tasks:\r\n    - name: 'Create directory xpto.'\r\n      ansible.builtin.file:\r\n        path: /root/xpto\r\n        attributes: +a\r\n        state: directory\r\n        owner: \"root\"\r\n        group: \"root\"\r\n        mode: '755'\r\n\r\n    - name: 'Remove directory xpto.'\r\n      ansible.builtin.file:\r\n        path: /root/xpto\r\n        attributes: -a\r\n        state: absent\r\n```\r\n\r\n### Expected Results\r\n\r\n```console\r\nPLAY [docker_managed_nodes] ******************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************\r\nTuesday 13 December 2022  11:20:41 -0300 (0:00:00.028)       0:00:00.028 ****** \r\nTuesday 13 December 2022  11:20:41 -0300 (0:00:00.028)       0:00:00.028 ****** \r\nok: [ubuntu_22_nd_1]\r\n\r\nTASK [Create directory xpto.] ****************************************************************************************************\r\nTuesday 13 December 2022  11:20:42 -0300 (0:00:01.807)       0:00:01.836 ****** \r\nTuesday 13 December 2022  11:20:42 -0300 (0:00:01.807)       0:00:01.836 ****** \r\nchanged: [ubuntu_22_nd_1]\r\n\r\nTASK [Remove directory xpto.] ****************************************************************************************************\r\nTuesday 13 December 2022  11:20:44 -0300 (0:00:00.826)       0:00:03.602 ****** \r\nTuesday 13 December 2022  11:20:44 -0300 (0:00:00.826)       0:00:03.602 ****** \r\nchanged: [ubuntu_22_nd_1]\r\n\r\nPLAY RECAP ***********************************************************************************************************************\r\nubuntu_22_nd_1             : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 \r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nPLAY [docker_managed_nodes] ******************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************\r\nTuesday 13 December 2022  11:34:51 -0300 (0:00:00.024)       0:00:00.024 ****** \r\nTuesday 13 December 2022  11:34:51 -0300 (0:00:00.024)       0:00:00.024 ****** \r\nok: [ubuntu_22_nd_1]\r\n\r\nTASK [Create directory xpto.] ****************************************************************************************************\r\nTuesday 13 December 2022  11:34:52 -0300 (0:00:01.670)       0:00:01.695 ****** \r\nTuesday 13 December 2022  11:34:52 -0300 (0:00:01.670)       0:00:01.695 ****** \r\nchanged: [ubuntu_22_nd_1]\r\n\r\nTASK [Remove directory xpto.] ****************************************************************************************************\r\nTuesday 13 December 2022  11:34:53 -0300 (0:00:00.969)       0:00:02.665 ****** \r\nTuesday 13 December 2022  11:34:53 -0300 (0:00:00.969)       0:00:02.665 ****** \r\nfatal: [ubuntu_22_nd_1]: FAILED! => {\"changed\": false, \"msg\": \"rmtree failed: [Errno 1] Operation not permitted: '/root/xpto'\"}\r\n\r\nPLAY RECAP ***********************************************************************************************************************\r\nubuntu_22_nd_1             : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-13T14:44:08Z",
        "user": "felipenazario",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "has_pr",
            "verified",
            "affects_2.11"
        ]
    },
    {
        "number": 79554,
        "title": "ansible-galaxy, make api page size configurable",
        "body": "### Summary\r\n\r\nCurrently API page request sizes are hard coded (50 for roles, 100 for collections), but given the different possible galaxy servers, collections, versions, etc. This size should be configurable on the client side (the default should probably be the pagesize provided by the server after the initial query).\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansilbe-galaxy\r\n\r\n### Additional Information\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-12-07T16:42:06Z",
        "user": "bcoca",
        "labels": [
            "has_pr",
            "feature",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 79452,
        "title": "[Ansible 6/2.13] apt module segmentation fault on package removal",
        "body": "### Summary\r\n\r\nWhen moving from Ansible 5/2.12 to 6/2.13 we encountered the `apt` module running into a segmentation fault when package state \"absent\" was used to remove packages that are no longer installed. The issue occurred on target hosts running on Debian 8 (Jessie), 9 (Stretch) and 10 (Buster).\r\n\r\nWe managed to re-create the issue on Vagrant and after some testing came the conclusion that these conditions must be met to produce the error:\r\n- non-purged packages:\r\nThe package were _not_ purged but just removed using \"absent\".\r\n- no repository source anymore\r\nThe apt sources list file that defined the repo the package came from is no longer present on the system\r\n- the packages have a dependency\r\nThe packages involved have \"depends\" relationship between them\r\n\r\nThe sample playbook below re-creates the aforementioned conditions using packages from the publicly available Zabbix repository. Originally, the issue occurred using company internal packages, but once we figured out what might go wrong, we managed to re-produce it :-).\r\n\r\nSome other things we found while toying with this:\r\n- When the repository definition is kept in place all works fine.\r\n- When the packages are purged everything works\r\n\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.6]\r\n  config file = /home/charly/eclipseprojects/samsagent/test/ansible.cfg\r\n  configured module search path = ['/home/charly/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/ansible/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/charly/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.8 (main, Nov  4 2022, 09:21:25) [GCC 12.2.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/home/charly/eclipseprojects/samsagent/test/ansible.cfg) = ['profile_tasks']\r\nDEFAULT_LOG_PATH(env: ANSIBLE_LOG_PATH) = /tmp/ansible.log\r\nDEFAULT_ROLES_PATH(env: ANSIBLE_ROLES_PATH) = ['/home/charly/eclipseprojects/samsagent/test', '/home/charly/eclipseprojects']\r\nDEFAULT_STDOUT_CALLBACK(/home/charly/eclipseprojects/samsagent/test/ansible.cfg) = yaml\r\nHOST_KEY_CHECKING(/home/charly/eclipseprojects/samsagent/test/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(env: ANSIBLE_RETRY_FILES_ENABLED) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/charly/eclipseprojects/samsagent/test/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/charly/eclipseprojects/samsagent/test/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n Debian 8 (Jessie)\r\n Debian 9 (Stretch)\r\n Debian 10 (Buster)\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: all\r\n  become: true\r\n  gather_facts: true\r\n  tasks:\r\n\r\n    # Vagrant images tend to be outdated, an apt update may help to get going\r\n    - name: update apt package lists\r\n      raw: apt-get --quiet update\r\n      changed_when: false\r\n\r\n    # ================\r\n    # Boostrap Ansible\r\n    # ================\r\n    - name: bootstrap Ansible runtime environment\r\n      raw: >\r\n        apt-get --no-install-recommends --quiet --yes install\r\n        acl\r\n        aptitude\r\n        ca-certificates\r\n        dbus\r\n        lsb-release\r\n        sudo\r\n      register: amh_rv_apt\r\n      changed_when: \"amh_rv_apt.stdout.find('0 upgraded, 0 newly installed') < 0\"\r\n\r\n    - name: define packages to install pre-Bullseye\r\n      set_fact:\r\n        amh_packages: >\r\n          python\r\n          python-apt\r\n          python3\r\n          python3-apt\r\n      when: ansible_lsb.major_release is version('10', '<=')\r\n\r\n    - name: define packages to install on Bullseye\r\n      set_fact:\r\n        amh_packages: >\r\n          gpg-agent\r\n          gnupg\r\n          python3\r\n          python3-apt\r\n      when: ansible_lsb.major_release is version('11', '==')\r\n    \r\n    - name: install packages\r\n      raw: >\r\n        apt-get --no-install-recommends --quiet --yes install\r\n        {{ amh_packages }}\r\n      register: amh_rv_apt\r\n      changed_when: \"amh_rv_apt.stdout.find('0 upgraded, 0 newly installed') < 0\"\r\n\r\n    # ========================\r\n    # The fun part starts here\r\n    # ========================\r\n    - name: add zabbix repository key\r\n      apt_key:\r\n        url: http://repo.zabbix.com/zabbix-official-repo.key\r\n        id: A1848F5352D022B9471D83D0082AB56BA14FE591\r\n        state: present\r\n\r\n    - name: set zabbix facts\r\n      set_fact:\r\n        zabbix_package: zabbix-agent2\r\n        zabbix_version: 6.0\r\n\r\n    - name: add zabbix repository source\r\n      apt_repository:\r\n        repo: >\r\n          deb http://repo.zabbix.com/zabbix/{{ zabbix_version }}/debian\r\n          {{ ansible_lsb.codename }}\r\n          main contrib non-free\r\n        filename: zabbix\r\n\r\n    - name: install zabbix package\r\n      apt:\r\n        name: \"{{ zabbix_package }}\"\r\n\r\n    - name: show package deps\r\n      command: \"apt-cache depends {{ zabbix_package }}\"\r\n\r\n    - name: remove zabbix repository source\r\n      apt_repository:\r\n        repo: >\r\n          deb http://repo.zabbix.com/zabbix/{{ zabbix_version }}/debian\r\n          {{ ansible_lsb.codename }}\r\n          main contrib non-free\r\n        filename: zabbix\r\n        state: absent\r\n\r\n    - name: show state info before uninstall\r\n      command: \"apt show -a {{ zabbix_package }}\"\r\n\r\n    - name: uninstall zabbix package\r\n      apt:\r\n        name: \"{{ zabbix_package }}\"\r\n        state: absent\r\n\r\n    - name: show state info after uninstall\r\n      command: \"apt show -a {{ zabbix_package }}\"\r\n\r\n    - name: uninstall zabbix packages again\r\n      apt:\r\n        name: \"{{ zabbix_package }}\"\r\n        state: absent\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n`apt` task should yield an \"ok\" as the packages are gone already\r\n\r\n### Actual Results\r\n\r\n```console\r\nExample output from a Buster Vagrant box:\r\n\r\nTASK [uninstall zabbix packages again] *****************************************\r\ntask path: /home/charly/eclipseprojects/samsagent/test/test.yml:102\r\nMittwoch 23 November 2022  13:11:09 +0100 (0:00:00.232)       0:00:11.613 ***** \r\nfatal: [samsagentvagrant10]: FAILED! => changed=false \r\n  module_stderr: |-\r\n    Shared connection to 127.0.0.1 closed.\r\n  module_stdout: |2-\r\n  \r\n    Segmentation fault\r\n  msg: |-\r\n    MODULE FAILURE\r\n    See stdout/stderr for the exact error\r\n  rc: 139\r\n\r\n\r\nSyslog on the Vagrant host shows this:\r\n\r\nNov 23 12:11:09 buster ansible-ansible.legacy.command: Invoked with _raw_params=apt show -a zabbix-agent2 _uses_shell=False warn=False stdin_add_newline=True strip_empty_ends=True argv=None chdir=None executable=None creates=None removes=None stdin=None\r\nNov 23 12:11:10 buster ansible-apt: Invoked with name=zabbix-agent2 state=absent package=['zabbix-agent2'] update_cache_retries=5 update_cache_retry_max_delay=12 cache_valid_time=0 purge=False force=False upgrade=no dpkg_options=force-confdef,force-confold autoremove=False autoclean=False fail_on_autoremove=False only_upgrade=False force_apt_get=False clean=False allow_unauthenticated=False allow_downgrade=False allow_change_held_packages=False lock_timeout=60 update_cache=None deb=None default_release=None install_recommends=None policy_rc_d=None\r\nNov 23 12:11:10 buster kernel: [ 1317.879948] python3[6320]: segfault at 0 ip 00007f71df9ca434 sp 00007fff65262f58 error 4 in apt_pkg.cpython-37m-x86_64-linux-gnu.so[7f71df9bf000+1e000]\r\nNov 23 12:11:10 buster kernel: [ 1317.880007] Code: 15 48 8b 57 28 48 03 82 98 00 00 00 48 89 c7 74 05 e9 70 54 ff ff 48 8d 3d ee a5 01 00 e9 64 54 ff ff 0f 1f 40 00 48 8b 47 20 <8b> 00 85 c0 74 16 48 8b 57 28 48 03 82 98 00 00 00 48 89 c7 74 06\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-11-23T12:30:03Z",
        "user": "k-c-p",
        "labels": [
            "easyfix",
            "module",
            "bug",
            "P3",
            "verified",
            "affects_2.13"
        ]
    },
    {
        "number": 79450,
        "title": "Ansible seems to have issues resolving nested variables for `delegate_to`",
        "body": "### Summary\n\nUnder reproducible circumstances, Ansible seems to randomly have issues resolving variables. I provided a demo to show the behavior.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ndelegate_to\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.13.5]\r\n  config file = /Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg\r\n  configured module search path = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/library']\r\n  ansible python module location = /usr/local/Cellar/ansible/6.5.0/libexec/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /Users/mrichter/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.8 (main, Oct 13 2022, 10:17:43) [Clang 14.0.0 (clang-1400.0.29.102)]\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nDEFAULT_ACTION_PLUGIN_PATH(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/action_plugins']\r\nDEFAULT_FORKS(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = 20\r\nDEFAULT_HOST_LIST(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/inventory']\r\nDEFAULT_MODULE_PATH(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/library']\r\nDEFAULT_MODULE_UTILS_PATH(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/module_utils']\r\nDEFAULT_ROLES_PATH(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/roles']\r\nDEFAULT_VAULT_IDENTITY_LIST(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = ['ansible_default@clients/vault-pass-client.py']\r\nHOST_KEY_CHECKING(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = False\r\nINTERPRETER_PYTHON(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = auto_silent\r\nPLAYBOOK_DIR(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = /Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/playbooks\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/Users/mrichter/Nextcloud/Dokumente/Entwicklung/ansible/ansible.merged.cfg) = False\n```\n\n\n### OS / Environment\n\nManager node OSes: MacOS, Ubuntu\r\nNode OS (Destinations): Debian\n\n### Steps to Reproduce\n\nA complete Ansible setup to reproduce the issue, along with the outputs from an affected run in the README, can be found on this extra provided Repo: https://github.com/The-Judge/ansible-delegate-demo\n\n### Expected Results\n\nI expect that ansible is resolving all variables passed to it and does not come up with something half-resolved like:\r\n`Failed to connect to the host via ssh: ssh: Could not resolve hostname inventory_hostname: Name or service not known` where `inventory_hostname` is used as a hostname half way.\n\n### Actual Results\n\n```console\nfatal: [sbsdevcore01 -> sbsdevcore02]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: Could not resolve hostname inventory_hostname: nodename nor servname provided, or not known\", \"unreachable\": true}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-11-23T11:28:15Z",
        "user": "The-Judge",
        "labels": [
            "bug",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 79373,
        "title": "import_playbook in a collection change role search path for the rest of the playbook, breaking current collection search path",
        "body": "### Summary\r\n\r\nlet's have 2 collections; one depending on the other; Adding an import_playbook in a playbook of first collection to a the dependency collection; set definitely search path for roles to the dependency collection; thus breaking the current collections (It cannot find it's own roles anymore)\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nimport_playbook\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/julien/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/julien/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.8 (main, Nov  1 2022, 14:18:21) [GCC 12.2.0] (/usr/bin/python)\r\n  jinja version = 3.1.2\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCONFIG_FILE() = /etc/ansible/ansible.cfg\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nArchlinux\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\ngit clone https://github.com/Zempashi/ansible_bug\r\nansible-playbook ansible_bug/playbook.yml\r\n# edit `ansible_bug/collections/ansible_collections/namespace/foobar/playbooks/entrypoint.yml`\r\n# comment `import_playbook`\r\nansible-playbook ansible_bug/playbook.yml\r\n# It now works normally !\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nRun the included playbook normally, and could use roles from the collection\r\n\r\n### Actual Results\r\n\r\n```console\r\nERROR! the role 'do_stuff' was not found in namespace.common:ansible.legacy:/home/julien/perso/ansible_bug/collections/ansible_collections/namespace/foobar/playbooks/roles:/home/julien/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/home/julien/perso/ansible_bug/collections/ansible_collections/namespace/foobar/playbooks\r\n\r\n\r\nThe error appears to be in '/home/julien/perso/ansible_bug/collections/ansible_collections/namespace/foobar/playbooks/entrypoint.yml': line 15, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n    #- role: common_ping\r\n    - role: do_stuff\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-11-14T09:23:43Z",
        "user": "Zempashi",
        "labels": [
            "module",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 79296,
        "title": "ansible-core 2.12.10 (and later vers) don't accept comma in a name of yaml variable file",
        "body": "### Summary\r\n\r\nAnsible 5.7.1 (ansible-core 2.12.10) and later versions don't accept comma in a name of yaml variable file. This is not case with Ansible 4.10.0 (ansible-core 2.11.12). \r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\n`lib/ansible/plugins/lookup/first_found.py`\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n\r\nansible-5.7.1\r\nansible [core 2.12.10]\r\npython version = 3.10.4 (main, May 17 2022, 12:54:31) [GCC 4.4.7 20120313 (Red Hat 4.4.7-11)]\r\njinja version = 3.1.2\r\nlibyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n\r\nCOLOR_ERROR(/home/me/.ansible.cfg) = red\r\nCOLOR_VERBOSE(/home/me/.ansible.cfg) = white\r\nCOLOR_WARN(/home/me/.ansible.cfg) = bright purple\r\nDEFAULT_GATHERING(/home/me/.ansible.cfg) = smart\r\nDEFAULT_LOG_PATH(/home/me/.ansible.cfg) = /tmp/ansible.log\r\nDEFAULT_ROLES_PATH(/home/me/.ansible.cfg) = ['my-path/roles']\r\nDEFAULT_TIMEOUT(/home/me/.ansible.cfg) = 30\r\nDEPRECATION_WARNINGS(/home/me/.ansible.cfg) = False\r\nHOST_KEY_CHECKING(/home/me/.ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/me/.ansible.cfg) = auto_silent\r\nINVENTORY_ENABLED(/home/me/.ansible.cfg) = ['host_list', 'script', 'yaml', 'ini']\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL and its clones. \r\n\r\n### Steps to Reproduce\r\n\r\nThis is role's tasks/main.yml file: \r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```---\r\n- name: Load host or (group and rule) variables\r\n  include_vars: \"{{ item }}\"\r\n  with_first_found:\r\n    - files:\r\n        - \"vars/hostname={{ inventory_hostname }}.yml\"\r\n        - \"vars/group={{ group }},rule={{ rule }}.yml\"\r\n      skip: yes\r\n- name: Show example value\r\n  debug:\r\n    msg: \"Example value is: {{ example }}\"\r\n...\r\n```\r\nThis is vars/group=SF,rule=dev.yml file. \r\n```\r\n---\r\nexample: \"yes\"\r\n...\r\n```\r\nThis is tests/inventory file.\r\n```\r\n[all]\r\nmy-test-host ansible_ssh_user=<user> ansible_ssh_pass=<passwd> group=SF rule=dev\r\n\r\n```\r\nThis is tests/test.yml\r\n```\r\n---\r\n- hosts: Test mytest role\r\n  hosts: all\r\n  roles:\r\n    - role: ../../mytest\r\n...\r\n```\r\nUse five times v to see desired logs:\r\n```\r\n$ ansible-playbook -i inventory test.yml -vvvvv\r\n```\r\n\r\n### Expected Results\r\n\r\nWith ansible [core 2.11.12], logs read:\r\n```\r\nlooking for \"vars/group=SF,rule=dev.yml\"\r\n```\r\nWith ansible [core 2.12.10] logs read:\r\n```\r\nlooking for \"vars/group=SF\" \r\nlooking for \"rule=dev.yml\" \r\n```\r\nThe result is that a yml file is not found. \r\n\r\nConclusion: \r\nI can't use comma in file name. Is this expected or it's a bug? \r\nMy current workaround is replacing comma with plus sign, so file group=SF+rule=dev.yml can be found in all Ansible versions. \r\n\r\n\r\n### Actual Results\r\n\r\n```console\r\nTo repeat, the -vvvvv log reads: \r\n\r\nlooking for \"vars/group=SF\" \r\nlooking for \"rule=dev.yml\" \r\n\r\nHence, the result is that a yml file is not found.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-11-02T22:43:55Z",
        "user": "etc-fstab",
        "labels": [
            "bug",
            "P3",
            "verified",
            "affects_2.12",
            "affects_2.15"
        ]
    },
    {
        "number": 79293,
        "title": "combine(.. , list_merge='append') filter does not work correctly with two equivalent vars",
        "body": "### Summary\r\n\r\nWhen I try to use `data: \"{{ data | combine(new_data, recursive=True, list_merge='append') }}`, where both `data` and `new_data` are equivalent, the resulting var isn't a combination of the two vars, but rather equal to `data`. This is using ansible-core v2.11.12 but I noticed the code for the `combine` filter or the `merge_hash` function which it uses hasn't changed even on the `devel` branch.\r\n\r\nI did some investigating and looked into the `combine` filter code which imports `from ansible.utils.vars import merge_hash` and believe I found both the problem and have a potential solution...\r\n\r\nHere is the related section from the latest commit on the `devel` branch for `def merge_hash`:\r\nhttps://github.com/ansible/ansible/blob/e2450d4886c43528ee8a870cc23cac73afdc6144/lib/ansible/utils/vars.py#L107-L111\r\n\r\nThere's a shortcut here that doesn't play nice when `list_merge='append'` is used - append should be combining existing data even if its identical to the new data according to the [documentation](https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#combining-hashes-dictionaries)\r\n> If list_merge='append', arrays from the right hash will be appended to the ones in the left hash:\r\n\r\nI was able to workaround this issue with the following change:\r\n```\r\n    # to speed things up: if x is empty or equal to y, return y\r\n    # (this `if` can be remove without impact on the function\r\n    #  except performance)\r\n    if x == {} or ( x == y and list_merge != 'append' and list_merge != 'prepend' ):\r\n        return y.copy()\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\n/lib/ansible/utils/vars.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.6.8 (default, Nov 16 2020,\r\n16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]. This feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by\r\nsetting deprecation_warnings=False in ansible.cfg.\r\nansible [core 2.11.12]\r\n  config file = None\r\n  configured module search path = ['/home/awilk00/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  ansible collection location = /home/awilk00/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.8 (default, Nov 16 2020, 16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\r\n  jinja version = 2.10.1\r\n  libyaml = False\r\n$\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.6.8 (default, Nov 16 2020,\r\n16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]. This feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by\r\nsetting deprecation_warnings=False in ansible.cfg.\r\n$\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nawilk00@vdejump-ho-1p test$ uname -r\r\n3.10.0-1160.71.1.el7.x86_64\r\nawilk00@vdejump-ho-1p test$ cat /etc/redhat-release\r\nCentOS Linux release 7.9.2009 (Core)\r\nawilk00@vdejump-ho-1p test$\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- hosts: localhost\r\n  gather_facts: false\r\n  vars:\r\n    \"data\":\r\n      \"profile_list\":\r\n        - \"test\"\r\n        #- \"Profile1\"\r\n    \"new_data\":\r\n      \"profile_list\":\r\n        - \"test\"\r\n        #- \"Profile2\"\r\n  tasks:\r\n    - name: combine\r\n      set_fact:\r\n        data: \"{{ data | default({}, true) | combine(new_data, recursive=True, list_merge='append') }}\"\r\n    - name: print\r\n      debug:\r\n        var: data\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nExpected the `data` variable to be appended by the `new_data` variable - here is the output after I made the code change I mentioned above to `def merge_hash` in https://github.com/ansible/ansible/blob/e2450d4886c43528ee8a870cc23cac73afdc6144/lib/ansible/utils/vars.py#L107-L111\r\n```\r\n$ ansible-playbook test.yaml\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.6.8 (default, Nov 16 2020,\r\n16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]. This feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by\r\nsetting deprecation_warnings=False in ansible.cfg.\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [localhost] ********************************************************************************************************************************************\r\n\r\nTASK [combine] **********************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [print] ************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"data\": {\r\n        \"profile_list\": [\r\n            \"test\",\r\n            \"test\"\r\n        ]\r\n    }\r\n}\r\n\r\nPLAY RECAP **************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n$\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n$ ansible-playbook test.yaml\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.6.8 (default, Nov 16 2020,\r\n16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]. This feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by\r\nsetting deprecation_warnings=False in ansible.cfg.\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [localhost] ********************************************************************************************************************************************\r\n\r\nTASK [combine] **********************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [print] ************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"data\": {\r\n        \"profile_list\": [\r\n            \"test\"\r\n        ]\r\n    }\r\n}\r\n\r\nPLAY RECAP **************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n$\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-11-02T20:10:26Z",
        "user": "R37ribution",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 79206,
        "title": "apt module with cache_valid_time does not update when cache was never updated before",
        "body": "### Summary\r\n\r\nWhen `apt` has never updated its cache on a system (for example, when you run a minimal base image for the first time, which is common in cloud scenarios) and you only use `cache_valid_time` in your calls to the `apt` module, which makes sense to avoid multiple updates during your playbook run that would slow you down. According to the documentation, `cache_valid_time` implicitly sets `update_cache` true, so it seems unnecessary to explicitly set it.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.5]\r\n  config file = /home/tumble/myproject/provisioning/ansible.cfg\r\n  configured module search path = ['/home/tumble/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/tumble/myproject/venv/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/tumble/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/tumble/myproject/venv/bin/ansible\r\n  python version = 3.10.7 (main, Sep  6 2022, 21:22:27) [GCC 12.2.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(/home/tumble/myproject/ansible.cfg) = ['profile_tasks']\r\nCALLBACKS_ENABLED(/home/tumble/myproject/ansible.cfg) = ['profile_tasks']\r\nCALLBACKS_ENABLED(/home/tumble/myproject/ansible.cfg) = ['profile_tasks']\r\nDEFAULT_HOST_LIST(/home/tumble/myproject/ansible.cfg) = ['/home/tumble/myproject/inventory']\r\nHOST_KEY_CHECKING(/home/tumble/myproject/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/home/tumble/myproject/ansible.cfg) = False\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nhost_key_checking(/home/tumble/myproject/ansible.cfg) = False\r\n\r\nssh:\r\n___\r\nhost_key_checking(/home/tumble/myproject/ansible.cfg) = False\r\npipelining(/home/tumble/myproject/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n`5.15.74-3-MANJARO #1 SMP PREEMPT Sat Oct 15 13:39:11 UTC 2022`\r\n\r\n### Steps to Reproduce\r\n\r\nDelete the cache as you often see it done in `Dockerfiles`:\r\n``` bash\r\nrm -rf /var/lib/apt/lists/*\r\n```\r\nand then try to install some new package using the `apt` module.\r\n``` yaml\r\n- name: Install stuff\r\n  ansible.builtin.apt:\r\n    name:\r\n      - <packagename>\r\n    cache_valid_time: 3600\r\n```\r\n\r\n### Expected Results\r\n\r\nWhen I try to install a package using the `apt` module, it succeeds.\r\n\r\n### Actual Results\r\n\r\n```console\r\nFAILED! => {\"changed\": false, \"msg\": \"No package matching '<packagename>' is available\"}\r\n```\r\nA workaround is the following, executed early in your playbook:\r\n``` yaml\r\n- name: Check if apt cache has ever been updated before\r\n  ansible.builtin.stat:\r\n    path: /var/lib/apt/lists/partial\r\n  register: apt_dir_partial\r\n- name: Update apt cache for the first time\r\n  ansible.builtin.apt:\r\n    update_cache: yes\r\n  when: not apt_dir_partial.stat.exists\r\n```\r\nI don't know if that's a reliable way of determining the pristine state, but it works in my case.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-10-25T12:58:37Z",
        "user": "tumbl3w33d",
        "labels": [
            "module",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 79053,
        "title": "UnicodeEncodeError: 'utf-8' codec can't encode character in cache/yaml.py",
        "body": "### Summary\n\n`getent` passwd chokes on crappy (non-utf accented) entries with\r\n\r\nUnicodeEncodeError: 'utf-8' codec can't encode character '\\udce1' in position 12: surrogates not allowed\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncache/yaml\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.13.4]\r\n  config file = /home/ansible/ansible.cfg\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.7 (main, Oct  1 2022, 04:31:04) [GCC 12.2.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_PIPELINING(/home/ansible/ansible.cfg) = True\r\nCACHE_PLUGIN(/home/ansible/ansible.cfg) = community.general.yaml\r\nCACHE_PLUGIN_CONNECTION(/home/ansible/ansible.cfg) = cache.ansible\r\nCOLOR_VERBOSE(/home/ansible/ansible.cfg) = bright blue\r\nDEFAULT_ACTION_PLUGIN_PATH(/home/ansible/ansible.cfg) = ['/usr/lib/python3/dist-packages/ara/plugins/action']\r\nDEFAULT_CALLBACK_PLUGIN_PATH(env: ANSIBLE_CALLBACK_PLUGINS) = ['/usr/lib/python3/dist-packages/ara/plugins/callback']\r\nDEFAULT_FORKS(/home/ansible/ansible.cfg) = 20\r\nDEFAULT_HOST_LIST(/home/ansible/ansible.cfg) = ['/home/ansible/hosts.yml']\r\nDEFAULT_LOG_PATH(/home/ansible/ansible.cfg) = /home/ansible/log/ansible.log\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/home/ansible/ansible.cfg) = ['/usr/lib/python3/dist-packages/ara/plugins/lookup']\r\nDEFAULT_POLL_INTERVAL(/home/ansible/ansible.cfg) = 5\r\nDEFAULT_PRIVATE_KEY_FILE(/home/ansible/ansible.cfg) = /home/ansible/.ssh/id_ed25519\r\nDEFAULT_REMOTE_PORT(/home/ansible/ansible.cfg) = 29222\r\nDEFAULT_REMOTE_USER(/home/ansible/ansible.cfg) = root\r\nDEFAULT_STRATEGY(/home/ansible/ansible.cfg) = mitogen_linear\r\nDEPRECATION_WARNINGS(/home/ansible/ansible.cfg) = False\r\nINVENTORY_ENABLED(/home/ansible/ansible.cfg) = ['host_list', 'script', 'auto', 'yaml', 'ini', 'toml', 'community.general.proxmox']\r\n\r\nCACHE:\r\n=====\r\n\r\njsonfile:\r\n________\r\n_uri(/home/ansible/ansible.cfg) = /home/ansible/cache.ansible\r\n\r\nCALLBACK:\r\n========\r\n\r\nara_default:\r\n___________\r\napi_client(env: ARA_API_CLIENT) = http\r\napi_server(env: ARA_API_SERVER) = http://[::1]:8101\r\ncallback_threads(/home/ansible/ansible.cfg) = 4\r\n\r\nCONNECTION:\r\n==========\r\n\r\nlocal:\r\n_____\r\npipelining(/home/ansible/ansible.cfg) = True\r\n\r\nparamiko_ssh:\r\n____________\r\nremote_user(/home/ansible/ansible.cfg) = root\r\n\r\npsrp:\r\n____\r\npipelining(/home/ansible/ansible.cfg) = True\r\n\r\nssh:\r\n___\r\npipelining(/home/ansible/ansible.cfg) = True\r\nport(/home/ansible/ansible.cfg) = 29222\r\nprivate_key_file(/home/ansible/ansible.cfg) = $HOME/.ssh/id_ed25519\r\nremote_user(/home/ansible/ansible.cfg) = root\r\n\r\nwinrm:\r\n_____\r\npipelining(/home/ansible/ansible.cfg) = True\n```\n\n\n### OS / Environment\n\nDebian/testing (+some sid)\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n    - name: get users\r\n      getent:\r\n        database: passwd\r\n```\r\n\n\n### Expected Results\n\nI expected not crashing. (Okay, probably I should have expected invalid characters replaced by U+FFEF but it'd be not nice to change passwd data so maybe not.) But at least expected play to fail, and ansible going on.\r\n\n\n### Actual Results\n\n```console\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/ansible/cli/__init__.py\", line 601, in cli_executor\r\n    exit_code = cli.run()\r\n  File \"/usr/lib/python3/dist-packages/ansible/cli/playbook.py\", line 143, in run\r\n    results = pbex.run()\r\n  File \"/usr/lib/python3/dist-packages/ansible/executor/playbook_executor.py\", line 190, in run\r\n    result = self._tqm.run(play=play)\r\n  File \"/usr/lib/python3/dist-packages/ansible/executor/task_queue_manager.py\", line 321, in run\r\n    play_return = strategy.run(iterator, play_context)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/strategy/linear.py\", line 329, in run\r\n    results += self._wait_on_pending_results(iterator)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/strategy/__init__.py\", line 865, in _wait_on_pending_results\r\n    results = self._process_pending_results(iterator)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/strategy/__init__.py\", line 157, in inner\r\n    results = func(self, iterator, one_pass=one_pass, max_passes=max_passes, do_handlers=do_handlers)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/strategy/__init__.py\", line 754, in _process_pending_results\r\n    self._variable_manager.set_host_facts(target_host, result_item['ansible_facts'].copy())\r\n  File \"/usr/lib/python3/dist-packages/ansible/vars/manager.py\", line 677, in set_host_facts\r\n    self._fact_cache[host] = host_cache\r\n  File \"/usr/lib/python3/dist-packages/ansible/vars/fact_cache.py\", line 36, in __setitem__\r\n    self._plugin.set(key, value)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/cache/__init__.py\", line 169, in set\r\n    self._dump(value, tmpfile_path)\r\n  File \"/usr/lib/python3/dist-packages/ansible_collections/community/general/plugins/cache/yaml.py\", line 66, in _dump\r\n    yaml.dump(value, f, Dumper=AnsibleDumper, default_flow_style=False)\r\n  File \"/usr/lib/python3/dist-packages/yaml/__init__.py\", line 290, in dump\r\n    return dump_all([data], stream, Dumper=Dumper, **kwds)\r\n  File \"/usr/lib/python3/dist-packages/yaml/__init__.py\", line 278, in dump_all\r\n    dumper.represent(data)\r\n  File \"/usr/lib/python3/dist-packages/yaml/representer.py\", line 28, in represent\r\n    self.serialize(node)\r\n  File \"yaml/_yaml.pyx\", line 1348, in yaml._yaml.CEmitter.serialize\r\n  File \"yaml/_yaml.pyx\", line 1510, in yaml._yaml.CEmitter._serialize_node\r\n  File \"yaml/_yaml.pyx\", line 1510, in yaml._yaml.CEmitter._serialize_node\r\n  File \"yaml/_yaml.pyx\", line 1478, in yaml._yaml.CEmitter._serialize_node\r\n  File \"yaml/_yaml.pyx\", line 1428, in yaml._yaml.CEmitter._serialize_node\r\nUnicodeEncodeError: 'utf-8' codec can't encode character '\\udce1' in position 12: surrogates not allowed\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-10-05T20:31:02Z",
        "user": "grinapo",
        "labels": [
            "bug",
            "traceback",
            "affects_2.13",
            "affects_2.16"
        ]
    },
    {
        "number": 78941,
        "title": "ansible-test , \"File not found\" error when running windows integration tests with \"--inventory\"",
        "body": "### Summary\r\n\r\nrunning: windows integration tests with inventory options results in a file does not exists error.\r\n## Possible cause:\r\nwrong order of paramaters at https://github.com/ansible/ansible/blob/85acf4d1e55e95c266a35c49f74af3c0f251de08/test/lib/ansible_test/_internal/inventory.py#L55\r\nexpected: [`shutil.copyfile(src, dst, *, follow_symlinks=True)`](https://docs.python.org/3/library/shutil.html#shutil.copyfile)\r\nadding a print statement locally prints:\r\n```\r\nprint(first.config.path, path)\r\ninventory.winrm /root/ansible_collections/yorailevi/tutorial/tests/integration/inventory.winrm\r\n```\r\n\r\npossibly related also:  https://github.com/ansible/ansible/blob/85acf4d1e55e95c266a35c49f74af3c0f251de08/test/lib/ansible_test/_internal/inventory.py#L90\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nintegration\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /root/ansible_collections/env/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /root/ansible_collections/env/bin/ansible\r\n  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n$ ansible-test --version\r\nansible-test version 2.13.3\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nubuntu2004 on wsl2\r\n\r\n### Steps to Reproduce\r\n\r\ncreate an inventory file based on the `inventory.winrm.template` template\r\nplace it in tests/integration\r\ncall `ansible-test windows-integration --inventory inventory`\r\n\r\n### Expected Results\r\n\r\nintegration tests to run\r\n\r\n### Actual Results\r\n\r\n```console\r\nTraceback (most recent call last):\r\n  File \"/root/ansible_collections/env/bin/ansible-test\", line 45, in <module>\r\n    main()\r\n  File \"/root/ansible_collections/env/bin/ansible-test\", line 36, in main\r\n    cli_main(args)\r\n  File \"/root/ansible_collections/env/lib/python3.8/site-packages/ansible_test/_internal/__init__.py\", line 72, in main\r\n    args.func(config)\r\n  File \"/root/ansible_collections/env/lib/python3.8/site-packages/ansible_test/_internal/commands/integration/windows.py\", line 81, in command_windows_integration\r\n    command_integration_filtered(args, host_state, internal_targets, all_targets, inventory_path, pre_target=pre_target, post_target=post_target)\r\n  File \"/root/ansible_collections/env/lib/python3.8/site-packages/ansible_test/_internal/commands/integration/__init__.py\", line 472, in command_integration_filtered\r\n    create_inventory(args, host_state, inventory_path, target)\r\n  File \"/root/ansible_collections/env/lib/python3.8/site-packages/ansible_test/_internal/commands/integration/__init__.py\", line 391, in create_inventory\r\n    create_windows_inventory(args, inventory_path, target_profiles)\r\n  File \"/root/ansible_collections/env/lib/python3.8/site-packages/ansible_test/_internal/inventory.py\", line 57, in create_windows_inventory\r\n    shutil.copyfile(first.config.path, path)\r\n  File \"/usr/lib/python3.8/shutil.py\", line 264, in copyfile\r\n    with open(src, 'rb') as fsrc, open(dst, 'wb') as fdst:\r\nFileNotFoundError: [Errno 2] No such file or directory: 'inventory.winrm'\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-09-30T05:49:42Z",
        "user": "YoraiLevi",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "affects_2.17"
        ]
    },
    {
        "number": 78658,
        "title": "apt module with lock_timeout option not working as expected",
        "body": "### Summary\r\n\r\nI'm trying to make Ansible install some packages on some hosts in a playbook. The playbook installs packages in different tasks and the hosts have puppet installed which sometimes installs packages to the hosts as well. I'm getting a lock error as you can see in the results section. I expected that using lock_timeout will make the task wait for the lock to be released but I tested it on my laptop by running an `apt install` command and then running the playbook while the apt command is still running and the task fails immediately instead of waiting for the lock to be released.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n2.12.3\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOWS(env: ANSIBLE_NOCOWS) = True\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nANSIBLE_NOCOWS(env: ANSIBLE_NOCOWS) = True\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04\r\n\r\n### Steps to Reproduce\r\n\r\nTo run this playbook (replacing package_name with some package) while an `apt install` command is already running \r\n```yaml (paste below)\r\n- name: test\r\n  hosts: localhost\r\n  become: yes\r\n  gather_facts: no\r\n  tasks:\r\n  - name: Install package\r\n    apt:\r\n      name: package_name\r\n      lock_timeout: 3600\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nTo have Ansible apt task to wait for apt lock to be released and then to install the apt package(s)\r\n\r\n### Actual Results\r\n\r\n```console\r\nfatal: [localhost]: FAILED! => {\r\n    \"cache_update_time\": 1661775680,\r\n    \"cache_updated\": true,\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_downgrade\": false,\r\n            \"allow_unauthenticated\": false,\r\n            \"autoclean\": false,\r\n            \"autoremove\": false,\r\n            \"cache_valid_time\": 0,\r\n            \"deb\": null,\r\n            \"default_release\": null,\r\n            \"dpkg_options\": \"force-confdef,force-confold\",\r\n            \"fail_on_autoremove\": false,\r\n            \"force\": false,\r\n            \"force_apt_get\": false,\r\n            \"install_recommends\": null,\r\n            \"lock_timeout\": 3600,\r\n            \"name\": \"package_name\",\r\n            \"only_upgrade\": false,\r\n            \"package\": [\r\n                \"package_name\"\r\n            ],\r\n            \"policy_rc_d\": null,\r\n            \"purge\": false,\r\n            \"state\": \"present\",\r\n            \"update_cache\": true,\r\n            \"update_cache_retries\": 5,\r\n            \"update_cache_retry_max_delay\": 12,\r\n            \"upgrade\": null\r\n        }\r\n    },\r\n    \"msg\": \"'/usr/bin/apt-get -y -o \\\"Dpkg::Options::=--force-confdef\\\" -o \\\"Dpkg::Options::=--force-confold\\\"       install 'package_name'' failed: E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 226048 (apt)\\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\\n\",\r\n    \"rc\": 100,\r\n    \"stderr\": \"E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 226048 (apt)\\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\\n\",\r\n    \"stderr_lines\": [\r\n        \"E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 226048 (apt)\",\r\n        \"E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-08-29T12:23:55Z",
        "user": "m-adawi",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 78623,
        "title": "ansible.builtin.file: mode \"-x,+X\" is equal to \"+X\"",
        "body": "### Summary\n\nIn ansible.builtin.file, setting mode \"u-x,u+X\" on a directory (recurse: yes, state: directory, path: '/etc/update-motd.d', mode: 'u-x,u+X') behaves as if the initial \"u-x\" wasn't present. On a directory full of executable files, this behavior incorrectly retains their executability instead of removing it from all non-directories.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.file\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.12 (default, May 10 2022, 23:46:40) [GCC 8.5.0 20210514 (Red Hat 8.5.0-10)]\r\n  jinja version = 2.10.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\nAnsible server: Rocky Linux 8.4\r\n\r\nTarget: Ubuntu 22.04 LTS\r\n\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: 'Disable Ubuntu MOTD'\r\n  ansible.builtin.file:\r\n    mode: 'u-x,u+X'\r\n    path: '/etc/update-motd.d'\r\n    state: 'directory'\r\n    recurse: yes\r\n```\r\n\n\n### Expected Results\n\n/etc/update-motd.d should not contain executable files afterwards.\n\n### Actual Results\n\n```console\n/etc/update-motd.d does contain executable files afterwards.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-08-23T14:09:53Z",
        "user": "ToBeFree",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.12"
        ]
    },
    {
        "number": 78539,
        "title": "ansible-galaxy installs collections that are not compatible with the running Ansible version",
        "body": "### Summary\n\nToday, if you execute `ansible-galaxy collection install community.docker`, you get version 3.0.1 which is only declaring compatibility with Ansible 2.11+ (see https://github.com/ansible-collections/community.docker/blob/3.0.1/meta/runtime.yml#L6)\r\n\r\nHowever, you get that version also when you're using `ansible-galaxy` from 2.10.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-galaxy\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n2.10.17.post0\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\n```\n\n\n### OS / Environment\n\nFedora\n\n### Steps to Reproduce\n\n1. `ansible-galaxy collection install community.docker` on Ansible 2.10\n\n### Expected Results\n\nIt to install a version before 3.0 which dropped 2.10 support\n\n### Actual Results\n\n```console\nit installs 3.0.1\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-08-15T09:41:20Z",
        "user": "evgeni",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 78346,
        "title": "ansible-test sanity - please skip `files/` and `templates/` in collection roles and playbooks by default",
        "body": "### Summary\n\nWhen running sanity tests against a collection with roles, files in the `files/` and `templates/` directories are also scanned, which often is not the right behavior. For example, python files which are intended to be copied to target hosts, or even shell scripts get flagged with inappropriate failures (`shebang`, etc.).\r\n\r\nBecause sanity ignores are so strict, we need a separate ignores file for every ansible-core version, and a separate entry per file _and_ per violation.\r\n\r\nThese directories should be excluded by default, or at least glob patterns should be allowed for roles to give better control.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-test\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.13.1]\r\n  config file = None\r\n  configured module search path = ['/home/briantist/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/briantist/.a213/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/briantist/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/briantist/.a213/bin/ansible\r\n  python version = 3.8.0 (default, Feb 25 2021, 22:10:10) [GCC 8.4.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nCALLBACKS_ENABLED(env: ANSIBLE_CALLBACKS_ENABLED) = ['profile_tasks']\r\nDEFAULT_FORKS(env: ANSIBLE_FORKS) = 30\r\nINVENTORY_ENABLED(env: ANSIBLE_INVENTORY_ENABLED) = ['host_list', 'auto', 'ini', 'yaml', 'toml']\n```\n\n\n### OS / Environment\n\nUbuntu 18.04 (WSL2)\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n$ ansible-test sanity --docker default\r\n```\r\n(on a collection with roles)\n\n### Expected Results\n\nNo failures on `files/*` and `templates/*`\n\n### Actual Results\n\n```console\nFailures!\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-07-25T17:27:43Z",
        "user": "briantist",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "affects_2.16"
        ]
    },
    {
        "number": 78341,
        "title": "unsupported operand type(s) for |=: 'bool' and 'AnsibleUnsafeText'",
        "body": "### Summary\n\nI'm trying to use  'replace' and 'endswith' within `failed_when` - this works in python:\n\n```pycon\n>>> \"foobarbaz\".replace(\"baz\", \"bar\").endswith(\"bar\")\nTrue\n```\n\nBut in ansible this:\n\n```yaml\n  failed_when:\n    - not item.msg.replace(acceptable_error).endswith(valid_ending)\n```\n\nResults in a stack trace and a message saying it's 'probably a bug'.\n\n### Background/Usecase\n\nI'm attempting to parse the output of a previous task - it has warnings that are generated that are expressed inside the main body of the response, so they need to be stripped out before evaluating the result.\n\nThe task has a debug statement as a noop, then evaluates the response with failed_when - the task should be considered failed when the failed flag is true, AND there are additional errors beyond the one allowed.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nexecutor\n\n### Ansible Version\n\n```console\nansible [core 2.13.2]\n  config file = /builds/operations/network/ansible.cfg\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\n  executable location = /usr/local/bin/ansible\n  python version = 3.9.10 (main, Mar  2 2022, 04:23:34) [GCC 10.2.1 20210110]\n  jinja version = 3.1.2\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\nDEFAULT_FILTER_PLUGIN_PATH(/builds/operations/network/ansible.cfg) = ['/root/.ansible/plugins/filter', '/builds/operations/network/plugins/filter', '/usr/share/ansible/plugins/filter']\nDEFAULT_HOST_LIST(/builds/operations/network/ansible.cfg) = ['/builds/operations/network/inventory/hosts.yaml']\nDEFAULT_JINJA2_EXTENSIONS(/builds/operations/network/ansible.cfg) = jinja2.ext.do\nDEFAULT_JINJA2_NATIVE(/builds/operations/network/ansible.cfg) = True\nDEFAULT_ROLES_PATH(/builds/operations/network/ansible.cfg) = ['/builds/operations/network/roles']\nDUPLICATE_YAML_DICT_KEY(/builds/operations/network/ansible.cfg) = ignore\nINTERPRETER_PYTHON(/builds/operations/network/ansible.cfg) = python\nPERSISTENT_CONTROL_PATH_DIR(/builds/operations/network/ansible.cfg) = /root/.ansible/cp\n```\n\n\n### OS / Environment\n\npython:3.9.10-bullseye container\n\n### Steps to Reproduce\n\nThe task is: \n<!--- Paste example playbooks or commands between quotes below -->\n```yaml (paste below)\n- name: \"Evaluate results: Loading\"\n  ansible.builtin.debug:\n    msg: \"Checking configuration load RPC responses\"\n  failed_when:\n    - item.failed\n    - not item.msg.replace(acceptable_error).endswith(valid_ending) # replace(acceptable_error).\n  loop:\n    - \"{{ response.results[1] }}\"\n  when: compare or check\n  vars:\n    acceptable_error: ' Error: RpcError(severity: None, bad_element: None, message: warning: Delete all fabric member interfaces on node0/node1 will cause session state sync failure/traffic black hole\\nwarning: Delete all fabric member interfaces on node0/node1 will cause session state sync failure/traffic black hole)'\n    valid_ending: \"</configuration-text>\\\\n</load-configuration>\\\\n'.\"\n```\n\n'response.results[1]' looks like this:\n```\n{ \n    msg: \"giant block of text ending in </configuration-text>\\\\n</load-configuration>\\\\n'. Error: RpcError(severity: None, bad_element: None, message: warning: Delete all fabric member interfaces on node0/node1 will cause session state sync failure/traffic black hole\\nwarning: Delete all fabric member interfaces on node0/node1 will cause session state sync failure/traffic black hole)\",\n    failure: True\n    changed: False\n}\n```\n\n### Expected Results\n\nI don't feel like I'm doing anything weird, so I'm expecting the condition to evaluate the same way it does in plain python.\nAt the very least, ansible should return a useful error, rather than throwing a stack trace.\n\n### Actual Results\n\n```python-traceback\nERROR! Unexpected Exception, this is probably a bug: unsupported operand type(s) for |=: 'bool' and 'AnsibleUnsafeText'\nthe full traceback was:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/ansible/cli/__init__.py\", line 601, in cli_executor\n    exit_code = cli.run()\n  File \"/usr/local/lib/python3.9/site-packages/ansible/cli/playbook.py\", line 143, in run\n    results = pbex.run()\n  File \"/usr/local/lib/python3.9/site-packages/ansible/executor/playbook_executor.py\", line 190, in run\n    result = self._tqm.run(play=play)\n  File \"/usr/local/lib/python3.9/site-packages/ansible/executor/task_queue_manager.py\", line 321, in run\n    play_return = strategy.run(iterator, play_context)\n  File \"/usr/local/lib/python3.9/site-packages/ansible/plugins/strategy/linear.py\", line 329, in run\n    results += self._wait_on_pending_results(iterator)\n  File \"/usr/local/lib/python3.9/site-packages/ansible/plugins/strategy/__init__.py\", line 865, in _wait_on_pending_results\n    results = self._process_pending_results(iterator)\n  File \"/usr/local/lib/python3.9/site-packages/ansible/plugins/strategy/__init__.py\", line 157, in inner\n    results = func(self, iterator, one_pass=one_pass, max_passes=max_passes, do_handlers=do_handlers)\n  File \"/usr/local/lib/python3.9/site-packages/ansible/plugins/strategy/__init__.py\", line 586, in _process_pending_results\n    if task_result.is_failed():\n  File \"/usr/local/lib/python3.9/site-packages/ansible/executor/task_result.py\", line 68, in is_failed\n    return self._check_key('failed_when_result')\n  File \"/usr/local/lib/python3.9/site-packages/ansible/executor/task_result.py\", line 105, in _check_key\n    flag |= res.get(key, False)\nTypeError: unsupported operand type(s) for |=: 'bool' and 'AnsibleUnsafeText'\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-07-24T20:30:04Z",
        "user": "TheMysteriousX",
        "labels": [
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.13"
        ]
    },
    {
        "number": 78278,
        "title": "ansible-test --changed crashes when there are untracked symlinks to directories",
        "body": "### Summary\r\n\r\nRunning `ansible-test sanity --docker -v --changed --base-branch main` crashes for my community.docker checkout since I have untracked directories:\r\n```\r\ntests/integration/targets/docker_image/files\r\n```\r\n(This contains a few files created by a local run of the integration test which wasn't cleaned up.)\r\n\r\nResults in:\r\n```python-traceback\r\n$ ansible-test sanity --docker -v --test pylint --changed --base-branch main\r\nRun command: git symbolic-ref --short HEAD\r\nRun command: git for-each-ref refs/heads/ --format '%(refname:strip=2)'\r\nRun command: git merge-base --fork-point main\r\nRun command: git ls-files -z --cached\r\nRun command: git ls-files -z --others --exclude-standard\r\nRun command: git diff --name-only --no-renames -z 0e3d7d4802a132ad4d57ff5834cf0bece359cc81 HEAD\r\nRun command: git diff --name-only --no-renames -z --cached\r\nRun command: git diff --name-only --no-renames -z\r\nRun command: git -c core.quotePath= diff 0e3d7d4802a132ad4d57ff5834cf0bece359cc81\r\nDetected branch spdx-license forked from main at commit 0e3d7d4802a132ad4d57ff5834cf0bece359cc81\r\nWARNING: Ignored 12 untracked file(s). Use --untracked to include them.\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-test\", line 7, in <module>\r\n    exec(compile(f.read(), __file__, 'exec'))\r\n  File \"/path/to/ansible/bin/ansible-test\", line 45, in <module>\r\n    main()\r\n  File \"/path/to/ansible/bin/ansible-test\", line 36, in main\r\n    cli_main(args)\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/__init__.py\", line 72, in main\r\n    args.func(config)\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/commands/sanity/__init__.py\", line 143, in command_sanity\r\n    changes = get_changes_filter(args)\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/executor.py\", line 38, in get_changes_filter\r\n    paths = detect_changes(args)\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/executor.py\", line 63, in detect_changes\r\n    paths = get_ci_provider().detect_changes(args)\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/ci/local.py\", line 109, in detect_changes\r\n    if is_binary_file(path):\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/util.py\", line 711, in is_binary_file\r\n    with open_binary_file(path) as path_fd:\r\n  File \"/path/to/ansible/test/lib/ansible_test/_internal/io.py\", line 83, in open_binary_file\r\n    return io.open(to_bytes(path), mode)  # pylint: disable=consider-using-with\r\nIsADirectoryError: [Errno 21] Is a directory: b'tests/integration/targets/docker_image/files'\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-test\r\n\r\n### Ansible Version\r\n\r\n```console\r\ndevel\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n-\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n-\r\n\r\n### Steps to Reproduce\r\n\r\n-\r\n\r\n### Expected Results\r\n\r\n-\r\n\r\n### Actual Results\r\n\r\n```console\r\n-\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-07-15T20:29:52Z",
        "user": "felixfontein",
        "labels": [
            "support:core",
            "bug",
            "traceback",
            "affects_2.17"
        ]
    },
    {
        "number": 78222,
        "title": "ansible.builtin.user return SUCCESS when password_expire_min is still wrong",
        "body": "### Summary\r\n\r\nhttps://github.com/ansible/ansible/commit/30a923fb5c164d6cd18280c02422f75e611e8fb2 add the new bug. When Ansible cannot change /etc/shadow it returns SUCCESS, but should return FAILED\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nuser\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n30a923fb5c164d6cd18280c02422f75e611e8fb2\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nLinux 73404879c505 5.13.0-52-generic #59~20.04.1-Ubuntu SMP Thu Jun 16 21:21:28 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```bash\r\n(root user)# ansible -m user localhost -a 'user=user password_expire_min=20'\r\n(not-root user)$ ansible -m user localhost -a 'user=user password_expire_min=22'\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\n```\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied\r\nlocalhost | FAILED! => {\r\n    \"changed\": false,\r\n    \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"/home/user/.ansible/tmp/ansible-tmp-1657223540.180271-1098-137558723964598/AnsiballZ_user.py\\\", line 107, in <module>\\n    _ansiballz_main()\\n  File \\\"/home/user/.ansible/tmp/ansible-tmp-1657223540.180271-1098-137558723964598/AnsiballZ_user.py\\\", line 99, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\"/home/user/.ansible/tmp/ansible-tmp-1657223540.180271-1098-137558723964598/AnsiballZ_user.py\\\", line 47, in invoke_module\\n    runpy.run_module(mod_name='ansible.modules.user', init_globals=dict(_module_fqn='ansible.modules.user', _modlib_path=modlib_path),\\n  File \\\"/usr/lib64/python3.10/runpy.py\\\", line 209, in run_module\\n    return _run_module_code(code, init_globals, run_name, mod_spec)\\n  File \\\"/usr/lib64/python3.10/runpy.py\\\", line 96, in _run_module_code\\n    _run_code(code, mod_globals, init_globals,\\n  File \\\"/usr/lib64/python3.10/runpy.py\\\", line 86, in _run_code\\n    exec(code, run_globals)\\n  File \\\"/tmp/ansible_user_payload_0fnn_1va/ansible_user_payload.zip/ansible/modules/user.py\\\", line 3229, in <module>\\n  File \\\"/tmp/ansible_user_payload_0fnn_1va/ansible_user_payload.zip/ansible/modules/user.py\\\", line 3215, in main\\n  File \\\"/tmp/ansible_user_payload_0fnn_1va/ansible_user_payload.zip/ansible/modules/user.py\\\", line 1056, in set_password_expire\\nPermissionError: [Errno 13] Permission denied\\n\",\r\n    \"module_stdout\": \"\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 1\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nlocalhost | SUCCESS => {\r\n    \"append\": false,\r\n    \"changed\": false,\r\n    \"comment\": \"\",\r\n    \"group\": 1000,\r\n    \"home\": \"/home/user\",\r\n    \"move_home\": false,\r\n    \"name\": \"user\",\r\n    \"shell\": \"/bin/bash\",\r\n    \"state\": \"present\",\r\n    \"uid\": 1000\r\n}\r\n```\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-07-07T19:52:49Z",
        "user": "irqoff",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "verified",
            "affects_2.14"
        ]
    },
    {
        "number": 78123,
        "title": "apt module should mark the installed deb dependencies as auto-installed",
        "body": "### Summary\r\n\r\napt module should mark the installed deb dependencies as auto-installed.\r\n\r\nfor example, the [lms-2226.0.0-ubuntu-22.04.deb package](https://github.com/rgl/lms-binaries/releases/download/v0.0.20220623/lms-2226.0.0-ubuntu-22.04.deb) depends on `libxerces-c3.2` and `libace-7.0.6`.\r\n\r\nand when we install it as:\r\n\r\n```console\r\n# apt-get install lms\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nThe following additional packages will be installed:\r\n  libace-7.0.6 libxerces-c3.2\r\nThe following NEW packages will be installed:\r\n  libace-7.0.6 libxerces-c3.2 lms\r\n0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.\r\nNeed to get 0 B/4754 kB of archives.\r\nAfter this operation, 19,0 MB of additional disk space will be used.\r\nDo you want to continue? [Y/n] \r\n```\r\n\r\nIt marks the dependencies as `Auto-Installed: 1` as can be seem in the `/var/lib/apt/extended_states` file:\r\n\r\n```\r\nPackage: libxerces-c3.2\r\nArchitecture: amd64\r\nAuto-Installed: 1\r\n\r\nPackage: libace-7.0.6\r\nArchitecture: amd64\r\nAuto-Installed: 1\r\n```\r\n\r\nBecause of this, when we remove the `lms` package, the other dependencies can be automatically removed with `apt-get autoremove`:\r\n\r\n```console\r\n# apt-get remove --purge lms\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nThe following packages were automatically installed and are no longer required:\r\n  libace-7.0.6 libxerces-c3.2\r\nUse 'apt autoremove' to remove them.\r\nThe following packages will be REMOVED:\r\n  lms*\r\n0 upgraded, 0 newly installed, 1 to remove and 0 not upgraded.\r\nAfter this operation, 13,5 MB disk space will be freed.\r\nDo you want to continue? [Y/n] \r\n(Reading database ... 290776 files and directories currently installed.)\r\nRemoving lms (2226.0.0) ...\r\nProcessing triggers for dbus (1.12.20-2ubuntu4) ...\r\nProcessing triggers for rsyslog (8.2112.0-2ubuntu2.2) ...\r\n\r\n# apt-get autoremove\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nThe following packages will be REMOVED:\r\n  libace-7.0.6 libxerces-c3.2\r\n0 upgraded, 0 newly installed, 2 to remove and 0 not upgraded.\r\nAfter this operation, 5507 kB disk space will be freed.\r\nDo you want to continue? [Y/n] \r\n(Reading database ... 290754 files and directories currently installed.)\r\nRemoving libace-7.0.6 (7.0.6+dfsg-2) ...\r\nRemoving libxerces-c3.2:amd64 (3.2.3+debian-3build1) ...\r\nProcessing triggers for libc-bin (2.35-0ubuntu3) ...\r\n```\r\n\r\nSo, please make the apt module mark the dependencies as `Auto-Installed` :-)\r\n\r\nPackages can be marked as Auto-Installed with `apt-mark auto <package_name>`.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.1]\r\n  config file = /playbooks/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110]\r\n  jinja version = 3.1.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nDebian 11\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Install lms\r\n  apt:\r\n    deb: https://github.com/rgl/lms-binaries/releases/download/v0.0.20220623/lms-2226.0.0-ubuntu-22.04.deb\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expected the dependencies to be marked as `Auto-Installed: 1` in the `/var/lib/apt/extended_states` file:\r\n\r\n```\r\nPackage: libxerces-c3.2\r\nArchitecture: amd64\r\nAuto-Installed: 1\r\n\r\nPackage: libace-7.0.6\r\nArchitecture: amd64\r\nAuto-Installed: 1\r\n```\r\n\r\n\r\n### Actual Results\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-06-23T08:03:20Z",
        "user": "rgl",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 78092,
        "title": "ansible_processor_cores got from setup module not correct in RHEL 9.0 ARM virtual machine on ESXi Fling",
        "body": "### Summary\n\nDeployed a RHEL 9.0 virtual machine on ESXi on ARM Fling, CPU is configured with 2 CPUs, 2 cores per socket. Using `setup` module, processor info got is 1 cores per socket.\r\n```\r\n            \"ansible_processor\": [\r\n                \"0\",\r\n                \"1\"\r\n            ],\r\n            \"ansible_processor_cores\": 1,\r\n            \"ansible_processor_count\": 2,\r\n            \"ansible_processor_nproc\": 2,\r\n            \"ansible_processor_threads_per_core\": 1,\r\n            \"ansible_processor_vcpus\": 2,\r\n            \"ansible_product_name\": \"VBSA\",\r\n            \"ansible_product_serial\": \"6AED367303402E42\",\r\n            \"ansible_product_uuid\": \"03402e42-3673-6aed-12bb-b906c33471b4\",\r\n            \"ansible_product_version\": \"1\",\r\n```\r\n`/proc/cpuinfo` in VM is:\r\n```\r\n[root@localhost sys]# cat /proc/cpuinfo \r\nprocessor\t: 0\r\nBogoMIPS\t: 50.00\r\nFeatures\t: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm lrcpc dcpop asimddp ssbs\r\nCPU implementer\t: 0x41\r\nCPU architecture: 8\r\nCPU variant\t: 0x3\r\nCPU part\t: 0xd0c\r\nCPU revision\t: 1\r\n\r\nprocessor\t: 1\r\nBogoMIPS\t: 50.00\r\nFeatures\t: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm lrcpc dcpop asimddp ssbs\r\nCPU implementer\t: 0x41\r\nCPU architecture: 8\r\nCPU variant\t: 0x3\r\nCPU part\t: 0xd0c\r\nCPU revision\t: 1\r\n```\r\n`lscpu` in VM is:\r\n```\r\n[root@localhost sys]# lscpu\r\nArchitecture:           aarch64\r\n  CPU op-mode(s):       32-bit, 64-bit\r\n  Byte Order:           Little Endian\r\nCPU(s):                 2\r\n  On-line CPU(s) list:  0,1\r\nVendor ID:              ARM\r\n  BIOS Vendor ID:       Arm\r\n  Model name:           Neoverse-N1\r\n    BIOS Model name:    Arm Neoverse N1 r3p1\r\n    Model:              1\r\n    Thread(s) per core: 1\r\n    Core(s) per socket: 2\r\n    Socket(s):          1\r\n    Stepping:           r3p1\r\n    BogoMIPS:           50.00\r\n    Flags:              fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm lrcpc dcpop asimddp ssbs\r\nCaches (sum of all):    \r\n  L1d:                  128 KiB (2 instances)\r\n  L1i:                  128 KiB (2 instances)\r\n  L2:                   2 MiB (2 instances)\r\nNUMA:                   \r\n  NUMA node(s):         1\r\n  NUMA node0 CPU(s):    0,1\r\nVulnerabilities:        \r\n  Itlb multihit:        Not affected\r\n  L1tf:                 Not affected\r\n  Mds:                  Not affected\r\n  Meltdown:             Not affected\r\n  Spec store bypass:    Mitigation; Speculative Store Bypass disabled via prctl\r\n  Spectre v1:           Mitigation; __user pointer sanitization\r\n  Spectre v2:           Mitigation; CSV2, BHB\r\n  Srbds:                Not affected\r\n  Tsx async abort:      Not affected\r\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsetup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.13.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.8.12 (default, Dec 12 2021, 11:39:22) [GCC 7.3.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\nNone\n```\n\n\n### OS / Environment\n\nRHEL 9.0 ARM, rhel-baseos-9.0-aarch64-dvd.iso\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\nansible vm -m ansible.builtin.setup\r\n\r\n```\r\n\n\n### Expected Results\n\nprocessor cores is 2, processor count is 1.\n\n### Actual Results\n\n```console\n...\r\n\"ansible_processor\": [\r\n            \"0\",\r\n            \"1\"\r\n        ],\r\n        \"ansible_processor_cores\": 1,\r\n        \"ansible_processor_count\": 2,\r\n        \"ansible_processor_nproc\": 2,\r\n        \"ansible_processor_threads_per_core\": 1,\r\n        \"ansible_processor_vcpus\": 2,\r\n        \"ansible_product_name\": \"VBSA\",\r\n        \"ansible_product_serial\": \"1F771D118C362E42\",\r\n        \"ansible_product_uuid\": \"8c362e42-1d11-1f77-a60a-28d2abebfdb9\",\r\n        \"ansible_product_version\": \"1\",\r\n...\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-06-20T08:38:43Z",
        "user": "Tomorrow9",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 78067,
        "title": "galaxy: local collection installation fails with trace if version is int",
        "body": "### Summary\r\n\r\nWhen trying to install a local collection with version as int instead of a string, the trace is produced. I think we should provide an error message stating that - `requirements.yml` is invalid or `version` should be string, found `int` or something similar.\r\n\r\nPardon me if this is already been addressed somewhere. \r\n\r\n```python-traceback\r\nProcess install dependency map\r\nERROR! Unexpected Exception, this is probably a bug: 'int' object has no attribute 'startswith'\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Volumes/data/src/ansible/lib/ansible/cli/__init__.py\", line 623, in cli_executor\r\n    exit_code = cli.run()\r\n  File \"/Volumes/data/src/ansible/bin/ansible-galaxy\", line 646, in run\r\n    return context.CLIARGS['func']()\r\n  File \"/Volumes/data/src/ansible/bin/ansible-galaxy\", line 102, in method_wrapper\r\n    return wrapped_method(*args, **kwargs)\r\n  File \"/Volumes/data/src/ansible/bin/ansible-galaxy\", line 1300, in execute_install\r\n    self._execute_install_collection(\r\n  File \"/Volumes/data/src/ansible/bin/ansible-galaxy\", line 1328, in _execute_install_collection\r\n    install_collections(\r\ncollections:\r\n  File \"/Volumes/data/src/ansible/lib/ansible/galaxy/collection/__init__.py\", line 701, in install_collections\r\n    dependency_map = _resolve_depenency_map(\r\n  File \"/Volumes/data/src/ansible/lib/ansible/galaxy/collection/__init__.py\", line 1623, in _resolve_depenency_map\r\n    return collection_dep_resolver.resolve(\r\n  File \"/Volumes/data/venv/lib/python3.9/site-packages/resolvelib/resolvers.py\", line 453, in resolve\r\n    state = resolution.resolve(requirements, max_rounds=max_rounds)\r\n  File \"/Volumes/data/venv/lib/python3.9/site-packages/resolvelib/resolvers.py\", line 347, in resolve\r\n    failure_causes = self._attempt_to_pin_criterion(name, criterion)\r\n  File \"/Volumes/data/venv/lib/python3.9/site-packages/resolvelib/resolvers.py\", line 216, in _attempt_to_pin_criterion\r\n    satisfied = all(\r\n  File \"/Volumes/data/venv/lib/python3.9/site-packages/resolvelib/resolvers.py\", line 217, in <genexpr>\r\n    self._p.is_satisfied_by(r, candidate)\r\n  File \"/Volumes/data/src/ansible/lib/ansible/galaxy/dependency_resolution/providers.py\", line 435, in is_satisfied_by\r\n    requirement.ver.startswith('<') or\r\nAttributeError: 'int' object has no attribute 'startswith'\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-galaxy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.14.0.dev0] (devel d81a519f25) last updated 2022/06/16 19:08:45 (GMT +550)\r\n  config file = None\r\n  configured module search path = ['/Users/akasurde/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Volumes/data/src/ansible/lib/ansible\r\n  ansible collection location = /Volumes/data/src/collections\r\n  executable location = /Volumes/data/src/ansible/bin/ansible\r\n  python version = 3.9.12 (main, Mar 26 2022, 15:51:15) [Clang 13.1.6 (clang-1316.0.21.2)] (/Volumes/data/venv/bin/python)\r\n  jinja version = 3.1.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n# if using a version older than ansible-core 2.12 you should omit the '-t all'\r\n$ ansible-config dump --only-changed -t all\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nmacOS\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n# Ansible Galaxy dependencies\r\ncollections:\r\n    - name: community.general\r\n      source: /build/general\r\n      version: 4\r\n      type: dir\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nA valid error message instead of - \r\n\r\n```console\r\n[1/3] STEP 8/8: RUN ANSIBLE_GALAXY_DISABLE_GPG_VERIFY=1 ansible-galaxy collection install $ANSIBLE_GALAXY_CLI_COLLECTION_OPTS -r requirements.yml --collections-path \"/usr/share/ansible/collections\"\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nERROR! Unexpected Exception, this is probably a bug: 'int' object has no attribute 'startswith'\r\nto see the full traceback, use -vvv\r\nError: error building at STEP \"RUN ANSIBLE_GALAXY_DISABLE_GPG_VERIFY=1 ansible-galaxy collection install $ANSIBLE_GALAXY_CLI_COLLECTION_OPTS -r requirements.yml --collections-path \"/usr/share/ansible/collections\"\": error while running runtime: exit status 250\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nError message - \r\n\r\n\r\n[1/3] STEP 8/8: RUN ANSIBLE_GALAXY_DISABLE_GPG_VERIFY=1 ansible-galaxy collection install $ANSIBLE_GALAXY_CLI_COLLECTION_OPTS -r requirements.yml --collections-path \"/usr/share/ansible/collections\"\r\nStarting galaxy collection install process\r\nProcess install dependency map\r\nERROR! Unexpected Exception, this is probably a bug: 'int' object has no attribute 'startswith'\r\nto see the full traceback, use -vvv\r\nError: error building at STEP \"RUN ANSIBLE_GALAXY_DISABLE_GPG_VERIFY=1 ansible-galaxy collection install $ANSIBLE_GALAXY_CLI_COLLECTION_OPTS -r requirements.yml --collections-path \"/usr/share/ansible/collections\"\": error while running runtime: exit status 250\r\n```\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-06-16T14:12:21Z",
        "user": "Akasurde",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 77891,
        "title": "[bug] OpenBSD service flag setting doesn't handle quotes correctly",
        "body": "### Summary\n\nWhen setting the service flags for an OpenBSD service, quotes around any argument are removed by default.\r\n\r\nCase in point, openldap service `slapd` needs to have its listen ip arguments in an quoted string, such as `-h  'ldaps:// ldap:// ldapi:// ldapi://%2ftmp%2fslapd.sock ldapi://%2fvar%2fwww%2ftmp%2fslapd.sock'`, which needs to be set in ansible with the quotes escaped, i.e. `-h \\'ldaps:// ldap:// ldapi:// ldapi://%2ftmp%2fslapd.sock ldapi://%2fvar%2fwww%2ftmp%2fslapd.sock\\'`\r\n\r\nBecause of this, the service task always shows up as **changed**, even when nothing actually gets changed.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nservice\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg\r\n  configured module search path = ['/home/aisha/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/aisha/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/lib/python-exec/python3.9/ansible\r\n  python version = 3.9.11 (main, Mar 18 2022, 17:29:23) [GCC 11.2.1 20220115]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_PIPELINING(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\nDEFAULT_BECOME(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\nDEFAULT_BECOME_METHOD(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = doas\r\nDEFAULT_HOST_LIST(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = ['/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/inventory.ini']\r\nDEFAULT_STDOUT_CALLBACK(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = debug\r\nDEFAULT_TIMEOUT(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = 60\r\nRETRY_FILES_ENABLED(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = False\r\n\r\nBECOME:\r\n======\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nlocal:\r\n_____\r\npipelining(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\n\r\npsrp:\r\n____\r\npipelining(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\n\r\nssh:\r\n___\r\ntimeout(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = 60\r\n\r\nwinrm:\r\n_____\r\npipelining(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nsh:\r\n__\r\nworld_readable_temp(/home/aisha/GIT/OBSD-Homelab/OBSD-Homelab/ansible.cfg) = True\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\nController OS - Gentoo\r\nTarget OS - OpenBSD current\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: enable openldap service\r\n  service:\r\n    name: slapd\r\n    enabled: true\r\n    args: -u openldap -g openldap -F /etc/slapd.d -h \\'ldaps:// ldap:// ldapi://\\'\r\n```\r\n\n\n### Expected Results\n\nRepeated runs of this should not show as **changed**.\n\n### Actual Results\n\n```console\nTask shows up as changed every time it is run.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-05-24T11:45:07Z",
        "user": "epsilon-0",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 77889,
        "title": "ansible_local facts overriden when interface named local is present",
        "body": "### Summary\n\nI run a lot of custom fact collectors via /etc/ansible/facts.d/* on the hosts. They normally appear under ansible_local. When a host has an interface named _local_ those are overridden by the interface facts.\r\nI guess this is difficult to solve without breaking anything. The right path would probably be that ansible prefix the interfaces like: ansible_net_$interface or something. \r\nReliable renaming the interface is not doable as the fleet of systems rely on the name. \r\n\r\nHost with local interface\r\n```\r\n    },\r\n    \"ansible_local\": {\r\n        \"active\": true,\r\n        \"device\": \"local\",\r\n        \"features\": {\r\n            \"busy_poll\": \"off [fixed]\",\r\n            \"fcoe_mtu\": \"off [fixed]\",\r\n            \"generic_receive_offload\": \"on\",\r\n            \"generic_segmentation_offload\": \"on\",\r\n            \"highdma\": \"on\",\r\n            \"hw_tc_offload\": \"off [fixed]\",\r\n            \"l2_fwd_offload\": \"off [fixed]\",\r\n            \"large_receive_offload\": \"off [fixed]\",\r\n            \"loopback\": \"off [fixed]\",\r\n            \"netns_local\": \"on [fixed]\",\r\n            \"ntuple_filters\": \"off [fixed]\",\r\n```\r\n\r\nAfter i delete the interface:\r\n```\r\n    },\r\n    \"ansible_local\": {\r\n        \"dmidecode_smbios\": {\r\n            \"bios_info\": {\r\n                \"bios_revision\": \"2.94\",\r\n                \"firmware_revision\": \"2.80\",\r\n                \"release_date\": \"04/14/2022\",\r\n                \"vendor\": \"HP\",\r\n                \"version\": \"P89\"\r\n            },\r\n            \"memory_modules\": [\r\n                {\r\n                    \"form_factor\": \"DIMM\",\r\n                    \"locator\": \"PROC 1 DIMM 1\",\r\n\r\n```\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsetup, facts\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /home/xxx/git/unixadmin/ansible-base/ansible.cfg\r\n  configured module search path = ['/home/xxx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Nov  9 2021, 14:44:26) [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\nANSIBLE_PIPELINING(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=60s\r\nANSIBLE_SSH_CONTROL_PATH(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = %(directory)s/ansible-ssh-%%h-%%p-%%r\r\nANSIBLE_SSH_CONTROL_PATH_DIR(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ~/.ssh/shared\r\nCACHE_PLUGIN(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = facts.json\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ['/home/xxx/git/unixadmin/ansible-base/lib/callback_plugins']\r\nDEFAULT_CALLBACK_WHITELIST(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ['idoit']\r\nDEFAULT_FORKS(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = 10\r\nDEFAULT_GATHERING(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ['/home/xxx/git/unixadmin/ansible-base/hosts/inventory.py']\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ['/home/xxx/git/unixadmin/ansible-base/lib/lookup_plugins']\r\nDEFAULT_ROLES_PATH(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ['/home/xxx/git/unixadmin/ansible-base/roles']\r\nDEFAULT_TIMEOUT(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = 10\r\nHOST_KEY_CHECKING(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = False\r\nTRANSFORM_INVALID_GROUP_CHARS(/home/xxx/git/unixadmin/ansible-base/ansible.cfg) = ignore\n```\n\n\n### OS / Environment\n\nRHEL 8\n\n### Steps to Reproduce\n\n- have interface named local\r\n- have custom facts in /etc/ansible/facts.d/*\r\n- run ansible -m setup \r\n- notice that ansible_local only contains interface facts\n\n### Expected Results\n\nI expected to have the custom facts available\n\n### Actual Results\n\n```console\nInterface facts appeared under ansible_local\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-05-24T07:47:27Z",
        "user": "Akulatraxas",
        "labels": [
            "module",
            "support:community",
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 77840,
        "title": "interpreter_python set to auto_legacy not working as expected",
        "body": "### Summary\n\nAfter upgrading our Ansible server from Ubuntu 18.04 to 22.04 and reinstalling Ansible via PIP to the latest version we are now experiencing issues when running setup module (_gather_facts_) on a lot of hosts.\r\n\r\nAnsible always attempts to use the discovered _/usr/bin/python3_ interpreter even if it is too old but the alternative python2 installation on the remote host is sufficient.\r\n\r\nHere is an example error (from **gather_facts** stage):\r\n```\r\n\"discovered_interpreter_python\": \"/usr/bin/python3\"\r\n \"msg\": \"ansible-core requires a minimum of Python2 version 2.6 or Python3 version 3.5. Current version: 3.4.10 (default, Dec 13 \r\n\r\nThe following modules failed to execute: ansible.legacy.setup\r\n```\r\nThese are the installed interpreters on a sample remote host that produces the error:\r\n\r\n```\r\nsomeserver:~ # **which python && python --version**\r\n/usr/bin/python\r\nPython 2.7.13\r\n\r\nsomeserver~ # **which python3 && python3 --version**\r\n/usr/bin/python3\r\nPython 3.4.10\r\n```\r\n\r\nAs you can see, the default /usr/bin/python is sufficient (v2.7.13) whereas /usr/bin/python3 is too old (v3.4.10).\r\nI thought that **interpreter_python = auto_legacy** is supposed to try **/usr/bin/python** first?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsetup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\nansible [core 2.12.5]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/etc/ansible/library']\r\n  ansible python module location = /usr/local/lib/python3.10/dist-packages/ansible\r\n  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.4 (main, Apr  2 2022, 09:04:19) [GCC 11.2.0]\r\n  jinja version = 3.1.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed -t all\r\n\r\nANSIBLE_NOCOWS(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_FLAGS(/etc/ansible/ansible.cfg) = -H -S\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = ['/etc/ansible/inventory.py']\r\nDEFAULT_MODULE_PATH(/etc/ansible/ansible.cfg) = ['/etc/ansible/library']\r\nDEFAULT_REMOTE_USER(/etc/ansible/ansible.cfg) = ansible\r\nDEFAULT_ROLES_PATH(/etc/ansible/ansible.cfg) = ['/etc/ansible/playbooks/roles', '/etc/ansible/XXX_test/roles', '/etc/ansible/edi-playbooks/roles', '/etc/ansible/YYY_test/roles', '/etc/ansible/ZZZ_test/roles']\r\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = debug\r\nDEFAULT_VAULT_PASSWORD_FILE(/etc/ansible/ansible.cfg) = /etc/ansible/.vault_pass\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto_legacy\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n\r\nBECOME:\r\n======\r\n\r\nrunas:\r\n_____\r\nbecome_flags(/etc/ansible/ansible.cfg) = -H -S\r\n\r\nsu:\r\n__\r\nbecome_flags(/etc/ansible/ansible.cfg) = -H -S\r\n\r\nsudo:\r\n____\r\nbecome_flags(/etc/ansible/ansible.cfg) = -H -S\r\n\r\nCACHE:\r\n=====\r\n\r\nCALLBACK:\r\n========\r\n\r\nCLICONF:\r\n=======\r\n\r\nCONNECTION:\r\n==========\r\n\r\nparamiko_ssh:\r\n____________\r\nremote_user(/etc/ansible/ansible.cfg) = ansible\r\n\r\nssh:\r\n___\r\ncontrol_path(/etc/ansible/ansible.cfg) = %(directory)s/%%h-%%r\r\nremote_user(/etc/ansible/ansible.cfg) = ansible\r\n\r\nHTTPAPI:\r\n=======\r\n\r\nINVENTORY:\r\n=========\r\n\r\nLOOKUP:\r\n======\r\n\r\nNETCONF:\r\n=======\r\n\r\nSHELL:\r\n=====\r\n\r\nVARS:\r\n====\n```\n\n\n### OS / Environment\n\n**Target OS:**\r\nMany, but for the example above it's SLES 12.5.\n\n### Steps to Reproduce\n\n1. Implement the following playbook:\r\n\r\n```\r\n---\r\n- hosts: someserver.somedomain.net\r\n  # Above is a host that has python 2.7.13 and python 3.4.10 installed\r\n  gather_facts: yes\r\n  tasks:\r\n    - name: Dummy\r\n      debug:\r\n        msg: \"This is a dummy task that will not be executed since python3 version is too old and auto_legacy doesn't appear to work.\"\r\n```\r\n\r\n2. Then run `ANSIBLE_DEBUG=1 ansible-playbook test.yml -vvvvv` against a server that has python 2.7.13 (sufficient) and python 3.4.10 (too old) installed.\r\n3. An error occurs despite setting interpreter_python = auto_legacy in ansible.cfg\n\n### Expected Results\n\nReceive facts.\n\n### Actual Results\n\n```console\ndebug1: Reading configuration data /home/ansible/.ssh/config\r\ndebug1: /home/ansible/.ssh/config line 1: Applying options for *\r\ndebug3: kex names ok: [diffie-hellman-group1-sha1]\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\r\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts' -> '/home/ansible/.ssh/known_hosts'\r\ndebug3: expanded UserKnownHostsFile '~/.ssh/known_hosts2' -> '/home/ansible/.ssh/known_hosts2'\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 5094\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n  5090 1652881449.85828: handler run complete\r\n  5090 1652881449.85846: variable 'ansible_facts' from source: unknown\r\n  5090 1652881449.85938: variable 'ansible_facts' from source: unknown\r\n  5090 1652881449.85992: attempt loop complete, returning result\r\n  5090 1652881449.85999: _execute() done\r\n  5090 1652881449.86003: dumping result to json\r\n  5090 1652881449.86008: done dumping result, returning\r\n  5090 1652881449.86015: done running TaskExecutor() for someserver.somedomain.net/TASK: Gathering Facts [6b03a8d6-8e57-6ee7-962c-0000000001da]\r\n  5090 1652881449.86023: sending task result for task 6b03a8d6-8e57-6ee7-962c-0000000001da\r\n  5090 1652881449.86093: done sending task result for task 6b03a8d6-8e57-6ee7-962c-0000000001da\r\n  5090 1652881449.86136: WORKER PROCESS EXITING\r\n  5081 1652881449.86261: marking someserver.somedomain.net as failed\r\n  5081 1652881449.86277: marking host someserver.somedomain.net failed, current state: HOST STATE: block=0, task=0, rescue=0, always=0, run_state=ITERATING_SETUP, fail_state=FAILED_NONE, pending_setup=True, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n  5081 1652881449.86283: ^ failed state is now: HOST STATE: block=0, task=0, rescue=0, always=0, run_state=ITERATING_COMPLETE, fail_state=FAILED_SETUP, pending_setup=True, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n  5081 1652881449.86287: getting the next task for host someserver.somedomain.net\r\n  5081 1652881449.86289: host someserver.somedomain.net is done iterating, returning\r\nfatal: [someserver.somedomain.net]: FAILED! => {\r\n    \"ansible_facts\": {},\r\n    \"changed\": false,\r\n    \"failed_modules\": {\r\n        \"ansible.legacy.setup\": {\r\n            \"ansible_facts\": {\r\n                \"discovered_interpreter_python\": \"/usr/bin/python3\"\r\n            },\r\n            \"failed\": true,\r\n            \"msg\": \"ansible-core requires a minimum of Python2 version 2.6 or Python3 version 3.5. Current version: 3.4.10 (default, Dec 13 2019, 16:20:47) [GCC]\",\r\n            \"warnings\": [\r\n                \"Platform linux on host someserver.somedomain.net is using the discovered Python interpreter at /usr/bin/python3, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-core/2.12/reference_appendices/interpreter_discovery.html for more information.\"\r\n            ]\r\n        }\r\n    }\r\n}\r\n\r\nMSG:\r\n\r\nThe following modules failed to execute: ansible.legacy.setup\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-05-18T13:56:25Z",
        "user": "StoneCut",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 77757,
        "title": "ansible apt_key module does not update expired keys",
        "body": "### Summary\r\n\r\nRe-opening https://github.com/ansible/ansible/issues/25070 which was incorrectly closed as duplicate of another issue. #25070 concisely and beautifully describes the problem - recommend reading that issue instead of mine.\r\n\r\nSituation: I have a playbook which installs a package (gitlab-runner). The package requires a custom apt repository and apt key to be added.\r\nI added the apt repository and apt key using the appropriate ansible modules, then installed the package. This works fine.\r\nHowever, the apt key recently expired (it was gitlab.com btw) and subsequent runs of my playbook failed, because it could not run apt-get update since apt reported an error that the key is invalid (expired).\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\napt_key\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.11.7] \r\n  config file = /home/james/git/itops/ansible/ansible.cfg\r\n  configured module search path = ['/home/james/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/james/.local/lib/python3.7/site-packages/ansible\r\n  ansible collection location = /home/james/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/james/.local/bin/ansible\r\n  python version = 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]\r\n  jinja version = 2.10\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nDEFAULT_GATHERING(/home/james/git/itops/ansible/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/james/git/itops/ansible/ansible.cfg) = ['/home/james/git/itops/ansible/inventory']\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/home/james/git/itops/ansible/ansible.cfg) = False\r\nDEFAULT_ROLES_PATH(/home/james/git/itops/ansible/ansible.cfg) = ['/home/james/git/itops/ansible/roles']\r\nDEFAULT_STDOUT_CALLBACK(/home/james/git/itops/ansible/ansible.cfg) = yaml\r\nDISPLAY_ARGS_TO_STDOUT(/home/james/git/itops/ansible/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n```\r\n$ cat /etc/os-release \r\nPRETTY_NAME=\"Debian GNU/Linux 10 (buster)\"\r\nNAME=\"Debian GNU/Linux\"\r\nVERSION_ID=\"10\"\r\nVERSION=\"10 (buster)\"\r\nVERSION_CODENAME=buster\r\nID=debian\r\nHOME_URL=\"https://www.debian.org/\"\r\nSUPPORT_URL=\"https://www.debian.org/support\"\r\nBUG_REPORT_URL=\"https://bugs.debian.org/\"\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n1. Assuming key has already been installed previously and is now expired\r\n2. Run the playbook task.\r\n3. Expired key will not be updated with key existing at the URL even if URL key is newer.\r\n```yaml (paste below)\r\n# trust Gitlab's gpg key, needed for using the repos\r\n    - name: add Gitlab's gpg key\r\n      apt_key:\r\n        url: https://packages.gitlab.com/runner/gitlab-runner/gpgkey\r\n        state: present\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expected on subsequent runs of my playbook that it would apply valid keys - I was 'shocked' to find that even though the apt key was expired, ansible considered this a pass and did not check the URL for newer key and apply it.\r\n\r\n### Actual Results\r\n\r\n```console\r\n#W: An error occurred during the signature verification. The repository is not updated and the previous index files will be used. GPG error: https://packages.gitlab.com/runner/gitlab-runner/debian buster InRelease: The following signatures were invalid: EXPKEYSIG 3F01618A51312F3F GitLab B.V. (package repository signing key) <packages@gitlab.com>\r\n#W: Failed to fetch https://packages.gitlab.com/runner/gitlab-runner/debian/dists/buster/InRelease  The following signatures were invalid: EXPKEYSIG 3F01618A51312F3F GitLab B.V. (package repository signing key) <packages@gitlab.com>\r\n#W: Some index files failed to download. They have been ignored, or old ones used instead.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-05-09T05:30:01Z",
        "user": "gostega",
        "labels": [
            "module",
            "support:core",
            "bug",
            "needs_verified",
            "affects_2.17"
        ]
    },
    {
        "number": 77755,
        "title": "pip editable=true doesn't work with multiple requirement names",
        "body": "### Summary\r\n\r\nWhen I pass `editable: true` and a list of `name`s, I expect each package to be installed as editable. However, Ansible passes just one `-e` flag to `pip`, whereas the pip semantics appear to be \"the next package listed is editable\". This means that only the first package named is installed editable, whereas the Ansible structure (a single editable flag) suggests they all should be.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\npip\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/alex/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /mnt/tipasa/home/alex/program/vcs/squaresdb/src/squaresdb/ansible/venv/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/alex/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /mnt/tipasa/home/alex/program/vcs/squaresdb/src/squaresdb/ansible/venv/bin/ansible\r\n  python version = 3.8.10 (default, Mar 15 2022, 12:22:08) [GCC 9.4.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04\r\n\r\n### Steps to Reproduce\r\n\r\nSomething like this should reproduce:\r\n```yaml (paste below)\r\n- name: Install virtualenv\r\n  ansible.builtin.pip:\r\n      name:\r\n          - git+https://foo#egg=foo\r\n          - git+https://bar#egg=bar\r\n      editable: true\r\n      virtualenv: /home/quux/venv\r\n```\r\n\r\n### Expected Results\r\n\r\nI expect this to run a command like `pip3 install -e git+https://foo#egg=foo -e git+https://bar#egg=bar`\r\n\r\n### Actual Results\r\n\r\nInstead I get `pip3 install -e git+https://foo#egg=foo git+https://bar#egg=bar`.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-05-08T18:31:19Z",
        "user": "dehnert",
        "labels": [
            "easyfix",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 77691,
        "title": "git module: track_submodules fails on repos without master branch",
        "body": "### Summary\r\n\r\nOur repo does not have master anymore, we moved it to main. But git module wants to pull from `master` : https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/git.py#L963 and there is no workaround either since `branch` in .gitmodules is not respected\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ngit\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.13.0b1.post0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/runner/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.6 (default, Aug 11 2021, 06:39:25) [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL8 ee-supported\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n    - name: update project using git\r\n      git:\r\n        dest: \"./dest\"\r\n        repo: \"https://github.com/ansible/test-playbooks.git\"\r\n        version: \"pull/186/head\"\r\n        refspec: \"refs/pull/186/head:refs/remotes/origin/pull/186/head\"\r\n        track_submodules: yes\r\n      register: git_result\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\ngit submodule tracks default branch properly since my .gitmodules does not define a branch.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTries to pull from master, which does not exists in https://github.com/ansible/test-playbooks.git\r\n\r\n\r\nPLAY [localhost] *****************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nPLAY [Update source tree if necessary] *****************************************\r\n\r\nTASK [update project using git] ************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"Failed to init/update submodules: Submodule 'test-playbooks' (https://github.com/ansible/test-playbooks) registered for path 'test-playbooks'\\\\nCloning into '/var/lib/awx/projects/_319__pre_sleep_submodule_project_y/test-playbooks'...\\\\nfatal: Needed a single revision\\\\nUnable to find current origin/master revision in submodule path 'test-playbooks'\\\\n\"}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0 \r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-04-29T10:46:45Z",
        "user": "Zokormazo",
        "labels": [
            "easyfix",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.13"
        ]
    },
    {
        "number": 77506,
        "title": "Allow an `__init__.py` to contain a doc string",
        "body": "### Summary\n\nWe should allow, and probably encourage, an `__init__.py` have a docstring in it. \r\n\r\nFrom PEP257 - \"A package may be documented in the module docstring of the __init__.py file in the package directory.\"\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-test sanity (empty-init)\n\n### Ansible Version\n\n```console\n$ ansible --version\r\n\r\n2.9 - 2.14\n```\n\n\n### Configuration\n\n```console\nN/A\n```\n\n\n### OS / Environment\n\nAll\n\n### Steps to Reproduce\n\nAdd a docstring to an `__init__.py`\r\n\n\n### Expected Results\n\nAbility to add docstring to `__init__.py`\n\n### Actual Results\n\n```console\nRequired to add per file exclusions to \r\n\r\nignore-2.9.txt\r\nignore-2.10.txt\r\nignore-2.11.txt\r\nignore-2.12.txt\r\nignore-2.13.txt\r\nignore-2.14.txt\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-04-11T11:57:46Z",
        "user": "cidrblock",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.16"
        ]
    },
    {
        "number": 77450,
        "title": "Intermittent \"could not find job\" error when polling async task",
        "body": "### Summary\r\n\r\nSince upgrading from ansible-core 2.10.5 to 2.12.3\r\n\r\nWhen running an a long running async task the task will intermittently fail a poll with a \"could not find job\" error.\r\n\r\nThe task will poll successfully a number of times until it hits an unsuccessful poll which will throw a \"could not find job\" error.\r\n\r\nThe logs show _async_dir is incorrect when the poll fails.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nasync_status\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.12.3]\r\n  config file = /home/ec2-user/dev/automate_ebs_clone/ansible.cfg\r\n  configured module search path = ['/home/ec2-user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ec2-user/.local/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/ec2-user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/ec2-user/.local/bin/ansible\r\n  python version = 3.8.5 (default, Feb 18 2021, 01:24:20) [GCC 7.3.1 20180712 (Red Hat 7.3.1-12)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n[DEPRECATION WARNING]: [defaults]callback_whitelist option, normalizing names to new standard, use callbacks_enabled instead. This feature will be removed from ansible-core in version\r\n2.15. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\nCALLBACKS_ENABLED(/home/ec2-user/dev/testissue/ansible.cfg) = ['ansible.posix.profile_tasks']\r\nDEFAULT_TIMEOUT(/home/ec2-user/dev/testissue/ansible.cfg) = 60\r\nHOST_KEY_CHECKING(/home/ec2-user/dev/testissue/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nOracle Enterprise Linux 6 & 8\r\n\r\n### Steps to Reproduce\r\n\r\n#ANSIBLE_PIPELINING=0 ANSIBLE_KEEP_REMOTE_FILES=1 ANSIBLE_DEBUG=1 ansible-playbook -e \"ansible_ssh_private_key_file=~/.ssh/secretkey.pem\" asyncissue.yml -i ./inventory/servers.yml --limit dbserver1 -vvv\r\n\r\n- name: TestAsyncIssue\r\n  hosts: dbserver1\r\n  become: true\r\n\r\n  tasks:\r\n  - name: test\r\n    shell:\r\n      cmd: sleep 5h\r\n    become_user: \"myuser\"\r\n    async: 43200 #6hours\r\n    poll: 60\r\n\r\n\r\n### Expected Results\r\n\r\nI would expect the task to poll every 60 seconds successfully until that task completed.\r\n\r\nThe log in \"Actual Results\" shows two polls, the penultimate successful poll and the failing poll.\r\n\r\n**The \"could not find job\" error is caused by a failure to retrieve the correct _async_dir:**\r\nThe logs show the incorrect _async_dir is being retrieved in lib/ansible/plugins/action/async_status.py via ```async_dir = self._get_async_dir()``` which was introduced in:\r\n[https://github.com/ansible/ansible/commit/9c718ccc4288473d44ebf13599a409913d43e3cc](https://github.com/ansible/ansible/commit/9c718ccc4288473d44ebf13599a409913d43e3cc)\r\n\r\nThis _get_async_dir() function attempts to retrieve the homedir of myuser using _remote_expand_user() via a remote SSH call, but the SSH call fails with rc=-13 which corresponds to SIGPIPE.\r\nWhen the SSH call fails _remote_expand_user() defaults to PWD which explains the incorrect _async_dir and the reason the POLL fails with \"could not find job\".\r\n\r\n**The failure to retrieve the correct _async_dir is caused by  the SSH client dying by SIGPIPE:**\r\nI believe there is a race condition between the value of ControlPersist=60 and the task polling every 60 seconds.  Sporadically the SSH client will attempt to connect to the SSH master socket just before the ControlPersist timeout starts shutting down the SSH master resulting in the SSH client dying with a SIGPIPE error.\r\n\r\nThere is some code to detect AnsibleControlPersistBrokenPipeError but it appears the SSH client is not reporting this error in a manner Ansible understands and is instead dying silently from SIGPIPE.\r\n\r\nI believe older versions of Python's subprocess.popen blocked SIGPIPE so perhaps there is an issue with the SSH client's reporting of the broken ControlPersist pipe when SIGPIPE is NOT blocked.\r\n\r\nThe snippet below shows the SSH call to retrieve the homedir and the subsequent failure due to rc=-13 (SIGPIPE) as it is trying to connect to the existing SSH Master:\r\n\r\n```\r\nASYNC POLL on dbserver1: jid=492600038035.16975 started=1 finished=0\r\n  8068 1648869576.73104: _low_level_execute_command(): starting\r\n  8068 1648869576.73137: _low_level_execute_command(): executing: /bin/sh -c 'echo ~myuser && sleep 0'\r\n<dbserver1.sanitised.com> ESTABLISH SSH CONNECTION FOR USER: ec2-user\r\n<dbserver1.sanitised.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o 'IdentityFile=\"/home/ec2-user/.ssh/secretkey.pem\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"ec2-user\"' -o ConnectTimeout=60 -o 'ControlPath=\"/home/ec2-user/.ansible/cp/b2d5f6bd56\"' dbserver1.sanitised.com '/bin/sh -c '\"'\"'echo ~myuser && sleep 0'\"'\"''\r\n  8068 1648869576.74292: stderr chunk (state=2):\r\n>>>OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /home/ec2-user/.ssh/config\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\n<<<\r\n  8068 1648869576.74326: stderr chunk (state=3):\r\n>>>debug1: auto-mux: Trying existing master\r\n<<<\r\n  8068 1648869576.74365: stderr chunk (state=3):\r\n>>>debug2: fd 3 setting O_NONBLOCK\r\n<<<\r\n  8068 1648869576.74442: stderr chunk (state=3):\r\n>>><<<\r\n  8068 1648869576.74459: stdout chunk (state=3):\r\n>>><<<\r\n<dbserver1.sanitised.com> (-13, b'', b'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /home/ec2-user/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\n')\r\n  8068 1648869576.74523: _low_level_execute_command() done: rc=-13, stdout=, stderr=OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nhttps://gist.github.com/privodmills/e31940550a2eff1e39b761ad4be0ff38\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-04-02T14:58:56Z",
        "user": "privodmills",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 77337,
        "title": "systemd state=restarted only starts - not restarts - a stopped service, affecting dependent services",
        "body": "### Summary\n\nI use the `systemd` module and `state: restarted` to always restart a service and all its dependent services.\r\nThis works well when the service in question is running: A restart signal is sent to that service and propagated to all its dependent services.\r\nHowever, systemd translates a \"restart\" request for a stopped service to a \"start\" request:\r\n\r\nhttps://github.com/ansible/ansible/blob/14098d9b045f4048e540560d3bee808cbb87e2fa/lib/ansible/modules/systemd.py#L546-L549\r\n\r\nIf the service in question is currently stopped, Ansible will only ask it to start. If the dependent services are already running, they won't be affected at all. This is wrong as they should be restarted.\r\n\r\nIf I ran `systemctl restart MY_SERVICE` instead, my service and all dependent services would have been restarted, no matter if they were previously running or not.\r\n\r\nIMO, this check is just wrong and can be simply removed to fix my problem.\r\nThis is similar to #30076, but I get why you can't just use \"restart\" for the `service` module if you want to stay LSB-compatible. This should be no reason for the `systemd` module though. It always supports restarting.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsystemd\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /srv/ansible/repo/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]\r\n  jinja version = 2.10.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nUbuntu 20.04 LTS\n\n### Steps to Reproduce\n\nThe relevant line in my playbook is:\r\n```yaml (paste below)\r\n- name: \"Restart MY_SERVICE\"\r\n  service:\r\n    name: \"MY_SERVICE\"\r\n    state: \"restarted\"\r\n```\r\n\r\nThe target system has MY_SERVICE and MY_OTHER_SERVICE, with MY_OTHER_SERVICE being a dependency of MY_SERVICE via `/etc/systemd/system/MY_OTHER_SERVICE.service.d/restart_after_MY_SERVICE.conf`:\r\n\r\n```\r\n[Unit]\r\nPartOf=MY_SERVICE.service\r\nAfter=MY_SERVICE.service\r\n```\n\n### Expected Results\n\nI expected the same result as `systemctl restart MY_SERVICE`, namely that both MY_SERVICE and MY_OTHER_SERVICE are restarted, no matter their previous state.\n\n### Actual Results\n\n```console\nIf MY_SERVICE is running, things work as expected.\r\nIf MY_SERVICE is stopped and MY_OTHER_SERVICE is running, MY_SERVICE is started, but MY_OTHER_SERVICE is not affected at all.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-23T15:23:21Z",
        "user": "ColinFinck",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 77325,
        "title": "Traceback in random location near SSH timeout with many target hosts",
        "body": "### Summary\r\n\r\nTraceback is shown in a seemingly random place but seems to be often immediately or shortly after some hosts were `unreachable` due to SSH timeout. Can be duplicated consistently with about 20 managed machines with a `site.yml` that works totally reliably with a small amount of hosts.\r\n\r\nChecking available RAM in a 1 second resolution shows minimum of 600 MB available RAM. So unless `ansible-playbook` uses all that in less than 1 second there should be enough RAM. No log messages anywhere about oom-killer or other memory issues.  \r\nIn some runs the crash happens after just a few tasks: only fact gathering + simple checks with `fail` and `assert` + debug msg tasks were executed before the crash. That lead me to the test case below that is simplified version of the beginning of `site.yml`.\r\n\r\nThe below test case causes crash sometimes but not always. Minimum free RAM during this run is about 1 GB.\r\n\r\nIt seems important that some hosts get SSH unreachable (in test case 3 timeouts, 1 invalid host key).\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.11.9]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/x/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /y/lib64/python3.6/site-packages/ansible\r\n  ansible collection location = /x/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /y/bin/ansible\r\n  python version = 3.6.8 (default, Nov 16 2020, 16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\r\n  jinja version = 3.0.2\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nCACHE_PLUGIN(/etc/ansible/ansible.cfg) = community.general.yaml\r\nCACHE_PLUGIN_CONNECTION(/etc/ansible/ansible.cfg) = /tmp/.ansible-fact.$USER\r\nCACHE_PLUGIN_TIMEOUT(/etc/ansible/ansible.cfg) = 5184000\r\nCALLBACKS_ENABLED(/etc/ansible/ansible.cfg) = ['ansible.posix.timer']\r\nCONTROLLER_PYTHON_WARNING(/etc/ansible/ansible.cfg) = False\r\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 10\r\nDEFAULT_LOCAL_TMP(/etc/ansible/ansible.cfg) = /tmp/.ansible.x/ansible-local-6785jea8d1zb\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\r\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = community.general.yaml\r\nDEFAULT_STRATEGY(/etc/ansible/ansible.cfg) = ansible.builtin.free\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 50\r\nDEFAULT_VAULT_IDENTITY_LIST(env: ANSIBLE_VAULT_IDENTITY_LIST) = ['x@v1', 'y@v2']\r\nDEFAULT_VAULT_ID_MATCH(/etc/ansible/ansible.cfg) = True\r\nINJECT_FACTS_AS_VARS(/etc/ansible/ansible.cfg) = False\r\nRETRY_FILES_SAVE_PATH(/etc/ansible/ansible.cfg) = /tmp/.ansible-retry.x\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nEL7\r\n\r\nstrategy=free\r\n\r\nfact caching enabled\r\n\r\nnetbox inventory plugin\r\n\r\n### Steps to Reproduce\r\n\r\nInclude extra variable `xxx` with value > 100, `ansible-playbook -e 'xxx=900' [...]`\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- hosts: all\r\n  gather_facts: true\r\n  tags: always\r\n  vars:\r\n    ansible_hostlist:\r\n      - ansible.example.com\r\n  tasks:\r\n    - name: Confirm variable is defined\r\n      ansible.builtin.fail:\r\n        msg: Variable xxx is not defined while required\r\n      when: (xxx is not defined) and (required | default(true) | bool)\r\n    - name: Check variable xxx\r\n      ansible.builtin.fail:\r\n        msg: The xxx variable is not proper\r\n      when: xxx | int < 100\r\n\r\n    - name: Test other variables\r\n      ansible.builtin.assert:\r\n        that: ansible_facts.eth0 is defined\r\n\r\n    - name: Status report\r\n      ansible.builtin.debug:\r\n        msg: \"Running for {{ inventory_hostname }}/{{ ansible_host }}\"\r\n\r\n    - name: Ensure target is right host\r\n      ansible.builtin.assert:\r\n        that: inventory_hostname == ansible_facts.fqdn\r\n        fail_msg: hostname not match\r\n\r\n    - name: Setup for controller machines\r\n      ansible.builtin.setup:\r\n        gather_subset: interfaces\r\n      become: false\r\n      delegate_facts: true\r\n      delegate_to: \"{{ item }}\"\r\n      ignore_errors: true\r\n      ignore_unreachable: true\r\n      loop: \"{{ ansible_hostlist }}\"\r\n      throttle: 1\r\n      when: hostvars[item].ansible_facts.gather_subset | default([]) | intersect(['all', 'interfaces', 'network']) | length == 0\r\n\r\n    - name: Check controller machine addresses exist\r\n      ansible.builtin.assert:\r\n        that:\r\n          - (item | select('defined') | length) == (item | length)\r\n          - (item | length) == (ansible_hostlist | length)\r\n        fail_msg: Ansible hosts IP address facts not complete\r\n      loop:\r\n        - \"{{ ansible_hostlist | map('extract', hostvars, ['ansible_facts', 'eth0', 'ipv4', 'address']) }}\"\r\n        - \"{{ ansible_hostlist | map('extract', hostvars, ['ansible_facts', 'eth0', 'ipv6', 0, 'address']) }}\"\r\n```\r\n\r\n### Expected Results\r\n\r\nExpect the playbook run the same with 5 or 20 managed hosts and whether some of the hosts couldn't be reached due to SSH timeout.\r\n\r\n### Actual Results\r\n\r\n```console\r\nERROR! Unexpected Exception, this is probably a bug: list index out of range\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/x/bin/ansible-playbook\", line 135, in <module>\r\n    exit_code = cli.run()\r\n  File \"/x/lib64/python3.6/site-packages/ansible/cli/playbook.py\", line 137, in run\r\n    results = pbex.run()\r\n  File \"/x/lib64/python3.6/site-packages/ansible/executor/playbook_executor.py\", line 189, in run\r\n    result = self._tqm.run(play=play)\r\n  File \"/x/lib64/python3.6/site-packages/ansible/executor/task_queue_manager.py\", line 315, in run\r\n    play_return = strategy.run(iterator, play_context)\r\n  File \"/x/lib64/python3.6/site-packages/ansible/plugins/strategy/free.py\", line 114, in run\r\n    host = hosts_left[last_host]\r\nIndexError: list index out of range\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-21T09:58:57Z",
        "user": "bluikko",
        "labels": [
            "support:core",
            "bug",
            "traceback",
            "P3",
            "needs_verified",
            "affects_2.11"
        ]
    },
    {
        "number": 77304,
        "title": "Cannot run ansible-test sanity behind a proxy",
        "body": "### Summary\r\n\r\nWhen I try to run ansible-test it tries to download files from ansible-ci-files.s3.amazonaws.com/ansible-test.\r\nThe problem is that I'm behind a proxy\r\nEven by setting env http_proxy it's not working\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nbin/ansible-test\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.12.3]\r\n  config file = /home/adm-dfournout/.ansible.cfg\r\n  configured module search path = ['/home/adm-dfournout/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/adm-dfournout/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/adm-dfournout/dev/ansible/collections\r\n  executable location = /home/adm-dfournout/.local/bin/ansible\r\n  python version = 3.9.10 (main, Mar 16 2022, 17:21:43) [GCC 8.3.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nCOLLECTIONS_PATHS(/home/adm-dfournout/.ansible.cfg) = ['/home/adm-dfournout/dev/ansible/collections']\r\nDEFAULT_REMOTE_USER(/home/adm-dfournout/.ansible.cfg) = adm-dfournout@adm.corp\r\nDEFAULT_TIMEOUT(/home/adm-dfournout/.ansible.cfg) = 40\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/adm-dfournout/.ansible.cfg) = /home/adm-dfournout/.vault_password\r\nHOST_KEY_CHECKING(/home/adm-dfournout/.ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/adm-dfournout/.ansible.cfg) = auto\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\ndebian\r\n\r\n### Steps to Reproduce\r\n\r\n''''\r\n> ansible-test sanity \r\nRunning sanity test \"action-plugin-docs\"\r\nRunning sanity test \"ansible-doc\"\r\nDownloading pip 21.3.1 bootstrap script: https://ansible-ci-files.s3.amazonaws.com/ansible-test/get-pip-21.3.1.py\r\n.....\r\n''''\r\n\r\n### Expected Results\r\n\r\nI expect to be able to run ansible-test either by setting the proxy. \r\nI should also be able to run ansible-test without connection to internet (I use it likes that in version 2.10)\r\n\r\n### Actual Results\r\n\r\n```console\r\nRunning sanity test \"action-plugin-docs\"\r\nRunning sanity test \"ansible-doc\"\r\nDownloading pip 21.3.1 bootstrap script: https://ansible-ci-files.s3.amazonaws.com/ansible-test/get-pip-21.3.1.py\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 1346, in do_open\r\n    h.request(req.get_method(), req.selector, req.data, headers,\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 1285, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 1331, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 1280, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 1040, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 980, in send\r\n    self.connect()\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 1447, in connect\r\n    super().connect()\r\n  File \"/usr/local/lib/python3.9/http/client.py\", line 946, in connect\r\n    self.sock = self._create_connection(\r\n  File \"/usr/local/lib/python3.9/socket.py\", line 844, in create_connection\r\n    raise err\r\n  File \"/usr/local/lib/python3.9/socket.py\", line 832, in create_connection\r\n    sock.connect(sa)\r\nTimeoutError: [Errno 110] Connection timed out\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 322, in <module>\r\n  File \"<stdin>\", line 72, in main\r\n  File \"<stdin>\", line 94, in bootstrap\r\n  File \"<stdin>\", line 199, in download_file\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 214, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 517, in open\r\n    response = self._open(req, data)\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 534, in _open\r\n    result = self._call_chain(self.handle_open, protocol, protocol +\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 494, in _call_chain\r\n    result = func(*args)\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 1389, in https_open\r\n    return self.do_open(http.client.HTTPSConnection, req,\r\n  File \"/usr/local/lib/python3.9/urllib/request.py\", line 1349, in do_open\r\n    raise URLError(err)\r\nurllib.error.URLError: <urlopen error [Errno 110] Connection timed out>\r\nERROR: Python 3.9 at \"/home/adm-dfournout/.ansible/test/venv/sanity.ansible-doc/3.9/3a197293/bin/python\" does not have pip available.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-16T17:41:25Z",
        "user": "df-cgdm",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 77251,
        "title": "User module allows duplicate ids when local: true",
        "body": "### Summary\r\n\r\nThe defaults in the ansible.builtin.user module doesn't allow duplicate user ids (default non_unique: no). If you set local: true, the check for duplicate uid is not executed and a user with a duplicate id can be created.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nuser\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.11.7] \r\n  config file = None\r\n  configured module search path = ['/home/luc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/share/venv/ansible-4.10.0/lib64/python3.8/site-packages/ansible\r\n  ansible collection location = /home/luc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/share/venv/ansible-4.10.0/bin/ansible\r\n  python version = 3.8.8 (default, Aug 11 2021, 06:52:42) [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n(no output)\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 8.5\r\n\r\n### Steps to Reproduce\r\n\r\nCreate a standard local (/etc/passwd) user test with id 1337 on a system.\r\nRun a task to create a user with the same id and set local: true:\r\n```yaml (paste below)\r\n- name: create or remove user\r\n  ansible.builtin.user:\r\n    name: baduser\r\n    uid: 1337\r\n    non_unique: false\r\n    local: true\r\n```\r\n\r\n\r\n\r\n\r\n### Expected Results\r\n\r\nUser creation fails because the uid was already in use.\r\nSimilar to when you remove local: true from the task:\r\nFAILED! => {\"changed\": false, \"msg\": \"useradd: UID 1337 is not unique\\n\", \"name\": \"baduser\", \"rc\": 4}\r\n\r\n\r\n### Actual Results\r\n\r\n```console\r\nUser is created with already existing uid and the below warning:\r\n[WARNING]: 'local: true' specified and user 'baduser' was not found in\r\n/etc/passwd. The local user account may already exist if the local account\r\ndatabase exists somewhere other than /etc/passwd.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-10T10:09:03Z",
        "user": "stroobl",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 77219,
        "title": "Ansible not running interpreter discovery on host after run_once and gather_facts disabled",
        "body": "### Summary\n\nWhen I run a playbook with `run_once: True` and `gather_facts: False` ansible runs interpreter discovery on only the host that the task runs on. If a later play uses the same group with `gather_facts: True`, ansible will not re-run interpreter discovery for the other hosts in the group, which can cause failures if the other hosts have different interpreters.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.legacy.setup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ratschanc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ratschanc/venvs/ansible/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/ratschanc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nDEFAULT_MANAGED_STR(/etc/ansible/ansible.cfg) = WARNING: Managed by Ansible. Any changes will be overwritten\n```\n\n\n### OS / Environment\n\nHost: Ubuntu Focal\r\n\r\nTarget 1 (Trusty w/ Python2) Dockerfile:\r\n```dockerfile\r\nFROM ubuntu:trusty\r\n\r\nRUN apt-get update && apt-get install -y openssh-server python\r\n\r\nRUN mkdir -p /root/.ssh\r\nCOPY id_ed25519.pub /root/.ssh/authorized_keys\r\n\r\nRUN service ssh start\r\n\r\nEXPOSE 22\r\n\r\nCMD [\"/usr/sbin/sshd\", \"-D\"]\r\n```\r\n\r\nTarget 2 (Focal w/ Python3) Dockerfile:\r\n```dockerfile\r\nFROM ubuntu:focal\r\n\r\nRUN apt-get update && apt-get install -y openssh-server python3\r\n\r\nRUN mkdir -p /root/.ssh\r\nCOPY id_ed25519.pub /root/.ssh/authorized_keys\r\n\r\nRUN service ssh start\r\n\r\nEXPOSE 22\r\n\r\nCMD [\"/usr/sbin/sshd\", \"-D\"]\r\n```\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nInventory:\r\n```ini\r\n[servers]\r\n172.17.0.3 ansible_user=root # Trusty py2\r\n172.17.0.2 ansible_user=root # Focal py3\r\n```\r\n\r\nPlaybook:\r\n```yaml (paste below)\r\n---\r\n- name: Run a task on one\r\n  hosts: servers\r\n  run_once: true\r\n  gather_facts: false\r\n  tasks:\r\n    - name: Touch a file on one\r\n      file:\r\n        path: /root/file1\r\n        owner: root\r\n        group: root\r\n        mode: '0644'\r\n        state: touch\r\n\r\n- name: Run a task on both\r\n  hosts: servers\r\n  gather_facts: true\r\n  tasks:\r\n    - name: Touch a file on both\r\n      file:\r\n        path: /root/file2\r\n        owner: root\r\n        group: root\r\n        mode: '0644'\r\n        state: touch\r\n\r\n```\r\n\r\nCommand:\r\n```bash\r\nansible-playbook -i inventory playbook.yml\r\n```\n\n### Expected Results\n\nI expected ansible to run interpreter discovery on the second host when gathering facts, but instead it failed after trying to directly use `/usr/bin/python` on a host that did not have it.\n\n### Actual Results\n\n```console\nansible-playbook [core 2.12.3]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ratschanc/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ratschanc/venvs/ansible/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/ratschanc/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\nUsing /etc/ansible/ansible.cfg as config file\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: playbook.yml *********************************************************\r\n2 plays in playbook.yml\r\n\r\nPLAY [Run a task on one] *******************************************************\r\nMETA: ran handlers\r\n\r\nTASK [Touch a file on one] *****************************************************\r\ntask path: /home/ratschanc/projects/ansible-testing/playbook.yml:7\r\nchanged: [172.17.0.3] => {\"ansible_facts\": {\"discovered_interpreter_python\": \"/usr/bin/python\"}, \"changed\": true, \"dest\": \"/root/file1\", \"gid\": 0, \"group\": \"root\", \"mode\": \"0644\", \"owner\": \"root\", \"size\": 0, \"state\": \"file\", \"uid\": 0}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY [Run a task on both] ******************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /home/ratschanc/projects/ansible-testing/playbook.yml:15\r\nfatal: [172.17.0.2]: FAILED! => {\"ansible_facts\": {}, \"changed\": false, \"failed_modules\": {\"ansible.legacy.setup\": {\"failed\": true, \"module_stderr\": \"Shared connection to 172.17.0.2 closed.\\r\\n\", \"module_stdout\": \"/bin/sh: 1: /usr/bin/python: not found\\r\\n\", \"msg\": \"The module failed to execute correctly, you probably need to set the interpreter.\\nSee stdout/stderr for the exact error\", \"rc\": 127}}, \"msg\": \"The following modules failed to execute: ansible.legacy.setup\\n\"}\r\nok: [172.17.0.3]\r\nMETA: ran handlers\r\n\r\nTASK [Touch a file on both] ****************************************************\r\ntask path: /home/ratschanc/projects/ansible-testing/playbook.yml:19\r\nchanged: [172.17.0.3] => {\"changed\": true, \"dest\": \"/root/file2\", \"gid\": 0, \"group\": \"root\", \"mode\": \"0644\", \"owner\": \"root\", \"size\": 0, \"state\": \"file\", \"uid\": 0}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *********************************************************************\r\n172.17.0.2                 : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n172.17.0.3                 : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-06T22:46:50Z",
        "user": "ratschance",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.12"
        ]
    },
    {
        "number": 77217,
        "title": "AnsibleModule.preserved_copy() results in module fail: Error while setting attributes: /usr/bin/chattr: Inappropriate ioctl for device while reading flags on /tmp/id_rsa_test",
        "body": "### Summary\n\n(See also https://github.com/ansible-collections/community.crypto/issues/416.)\r\n\r\nWhen `AnsibleModule.preserved_copy()` is used to copy `/home/$USER/.ansible/tmp/ansible-moduletmp-1646554294.130125-ln2tz3k4/id_rsa_test` to `/tmp/id_rsa_test`, while the former is on a regular ext4 filesystem and the latter on tmpfs, the `Set the attributes` step of `preserved_copy()` fails with `Error while setting attributes: /usr/bin/chattr: Operation not supported while reading flags on /tmp/id_rsa_test\\n` while trying to execute `/usr/bin/chattr =e /tmp/id_rsa_test`.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nlib/ansible/module_utils/basic.py\n\n### Ansible Version\n\n```console\nlatest devel branch\n```\n\n\n### Configuration\n\n```console\nnothing changed\n```\n\n\n### OS / Environment\n\nArch Linux, apparently also happens on Fedora 34\n\n### Steps to Reproduce\n\nMake sure that `/tmp` is a tmpfs; if not, adjust the path to something that's on a `tmpfs`!\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  gather_facts: false\r\n  vars:\r\n    ssh_key_path: \"/tmp/id_rsa_test\"  # must be on a tmpfs!\r\n  tasks:\r\n    - file:\r\n        path: \"{{ item }}\"\r\n        state: absent\r\n      loop:\r\n        - \"{{ ssh_key_path }}\"\r\n        - \"{{ ssh_key_path }}.pub\"\r\n    - name: Generate temporary ssh keys\r\n      openssh_keypair:\r\n        path: \"{{ ssh_key_path }}\"\r\n```\r\n(Requires community.crypto.)\r\n\r\nI don't see how to reproduce this with ansible-core only, since `preserved_copy()` isn't used in any ansible-core module or plugin (except indirectly in `backup_local()`, but there the copy is inside the same directory, i.e. not across filesystems).\n\n### Expected Results\n\nRuns through.\n\n### Actual Results\n\n```console\nTASK [Generate temporary ssh keys] ***********************************************************************************************************************************************************\r\ntask path: /path/to/test-openssh-failure.yml:12\r\nredirecting (type: modules) ansible.builtin.openssh_keypair to community.crypto.openssh_keypair\r\nUsing module file /path/to/ansible_collections/community/crypto/plugins/modules/openssh_keypair.py\r\nPipelining is enabled.\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: me\r\n<localhost> EXEC /bin/sh -c '/usr/bin/python3.10 && sleep 0'\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/tmp/ansible_openssh_keypair_payload_pwkqx5x0/ansible_openssh_keypair_payload.zip/ansible/module_utils/basic.py\", line 1002, in set_attributes_if_different\r\n    raise Exception(\"Error while setting attributes: %s\" % (out + err))\r\nException: Error while setting attributes: /usr/bin/chattr: Operation not supported while reading flags on /tmp/id_rsa_test\r\n\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"details\": \"Error while setting attributes: /usr/bin/chattr: Operation not supported while reading flags on /tmp/id_rsa_test\\n\",\r\n    \"gid\": 1000,\r\n    \"group\": \"me\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backend\": \"auto\",\r\n            \"comment\": null,\r\n            \"force\": false,\r\n            \"group\": null,\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"passphrase\": null,\r\n            \"path\": \"/tmp/id_rsa_test\",\r\n            \"private_key_format\": \"auto\",\r\n            \"regenerate\": \"partial_idempotence\",\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"size\": null,\r\n            \"state\": \"present\",\r\n            \"type\": \"rsa\",\r\n            \"unsafe_writes\": false\r\n        }\r\n    },\r\n    \"mode\": \"0600\",\r\n    \"msg\": \"chattr failed\",\r\n    \"owner\": \"me\",\r\n    \"path\": \"/tmp/id_rsa_test\",\r\n    \"size\": 3357,\r\n    \"state\": \"file\",\r\n    \"uid\": 1000\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-03-06T08:25:02Z",
        "user": "felixfontein",
        "labels": [
            "support:core",
            "bug",
            "traceback",
            "P3",
            "affects_2.18"
        ]
    },
    {
        "number": 77150,
        "title": "apt module uses dpkg for local deb files and fails",
        "body": "### Summary\n\nWhen I try to install a deb file with the apt module it fails because it uses `dpkg` command rather than `apt`, and this particular deb file isn't correctly handled by the `dpkg` command, but is handled correctly by the `apt` command.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\napt\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /home/ossman/tmp/ansible/ansible.cfg\r\n  configured module search path = ['/home/ossman/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.10/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.10.2 (main, Jan 17 2022, 00:00:00) [GCC 11.2.1 20211203 (Red Hat 11.2.1-7)]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nDEFAULT_STDOUT_CALLBACK(/home/ossman/tmp/ansible/ansible.cfg) = yaml\n```\n\n\n### OS / Environment\n\nAnsible run on: Fedora 34\r\nTarget machine: Ubuntu 20.04\n\n### Steps to Reproduce\n\nThe ansible code is extremely simple, it's basically this:\r\n\r\n```yaml (paste below)\r\ntasks:\r\n  name: Install package\r\n  package:\r\n    name: new-package.deb\r\n```\r\n\r\nThe complexity is in the deb package. The problem is that `new-package.deb` replace `old-package-a.deb` and `old-package-b.deb`, and there are dependencies from b to a. The `apt` command is clever enough to sort this out, but `dpkg` is not.\n\n### Expected Results\n\nThe new package is installed, and the old packages are uninstalled as a result.\n\n### Actual Results\n\n```console\nTASK [testrole : Installing packages] **************************************************\r\nfatal: [lab-245.lkpg.cendio.se]: FAILED! => changed=false \r\n  msg: dpkg --force-confdef --force-confold -i /root/new-package.deb failed\r\n  stderr: |-\r\n    dpkg: considering removing old-package-a in favour of new-package ...\r\n    dpkg: no, cannot proceed with removal of old-package-a (--auto-deconfigure will help):\r\n     old-package-b depends on old-package-a\r\n      old-package-a is to be removed.\r\n  \r\n    dpkg: regarding new-package.deb containing new-package:\r\n     new-package conflicts with old-package-a (<< 4.15.0)\r\n      old-package-a (version 4.14.0-2408) is present and installed.\r\n  \r\n    dpkg: error processing archive new-package.deb (--install):\r\n     conflicting packages - not installing new-package\r\n    Errors were encountered while processing:\r\n     /root/new-package.deb\r\n  stderr_lines: <omitted>\r\n  stdout: ''\r\n  stdout_lines: <omitted>\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-02-28T09:20:56Z",
        "user": "CendioOssman",
        "labels": [
            "module",
            "support:core",
            "bug",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 77144,
        "title": "apt module has poor support for local packages",
        "body": "### Summary\n\nI am trying to deploy package files over a heterogeneous environment and trying to avoid having to duplicate things for each different distro. As such I want to use the `package` module, which in turn uses the `apt` module, but I'm seeing limitations. Basically I want the `apt` module to support file paths in the `name` argument.\r\n\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\napt\n\n### Additional Information\n\n\r\nIdeally I want to do this:\r\n\r\n```yaml\r\n- name: Install packages\r\n  package:\r\n    name:\r\n      - /path/package_a.deb\r\n      - /path/package_b.deb\r\n```\r\n\r\nBut the `apt` module doesn't support giving files to the `name` argument, unlike the command `apt`. (**missing feature 1**)\r\n\r\nI then change things to:\r\n\r\n```yaml\r\n- name: Install packages\r\n  package:\r\n    deb:\r\n      - /path/package_a.deb\r\n      - /path/package_b.deb\r\n```\r\n\r\nWhich doesn't work either since the `apt` module doesn't support specifying multiple files for the `deb` argument. (**missing feature 2**).\r\n\r\n(I can't do this in a loop as the packages have a dependency loop)\r\n\r\nSo now I have to resort to using the `command` module, which is a lot less flexible.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-02-25T15:25:54Z",
        "user": "CendioOssman",
        "labels": [
            "module",
            "support:core",
            "feature",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 76972,
        "title": "Using illumos/solaris controller fails with termios.error: (22, 'Invalid argument')",
        "body": "### Summary\r\n\r\nWhen I try to run any ansible module from my illumos (SunOS) control node using the network_cli connection method, I get the following error:\r\n```\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/export/home/olbohlen/.local/lib/python3.9/site-packages/ansible/executor/task_executor.py\", line 1155, in start_connection\r\n    termios.tcsetattr(master, termios.TCSANOW, new)\r\ntermios.error: (22, 'Invalid argument')\r\n```\r\nDuring handling of the above exception, another exception occurred:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/export/home/olbohlen/.local/lib/python3.9/site-packages/ansible/executor/task_executor.py\", line 158, in run\r\n    res = self._execute()\r\n  File \"/export/home/olbohlen/.local/lib/python3.9/site-packages/ansible/executor/task_executor.py\", line 532, in _execute\r\n    self._connection = self._get_connection(cvars, templar)\r\n  File \"/export/home/olbohlen/.local/lib/python3.9/site-packages/ansible/executor/task_executor.py\", line 965, in _get_connection\r\n    socket_path = start_connection(self._play_context, options, self._task._uuid)\r\n  File \"/export/home/olbohlen/.local/lib/python3.9/site-packages/ansible/executor/task_executor.py\", line 1161, in start_connection\r\n    termios.tcsetattr(master, termios.TCSANOW, old)\r\ntermios.error: (22, 'Invalid argument')\r\nbifroest.mgmt.home.eenfach.de | FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n```\r\n```\r\n(1481) x230:/export/home/olbohlen/git/ansible-playbooks/sin$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg\r\n  configured module search path = ['/export/home/olbohlen/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /export/home/olbohlen/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /export/home/olbohlen/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /export/home/olbohlen/.local/bin/ansible\r\n  python version = 3.9.10 (main, Jan 17 2022, 16:23:45) [GCC 7.5.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\nThe reason is described also in https://github.com/amoffat/sh/issues/143, you cannot call termios.tcsetattr() on the master side of the pty pair on Unix98 systems like illumos, Solaris, HP-UX, etc...\r\n\r\nUnfortunately my python knowledge is way too bad to fix the issue by myself.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nnetwork_cli\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n$ ansible --version\r\nansible [core 2.12.2]\r\n  config file = /export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg\r\n  configured module search path = ['/export/home/olbohlen/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /export/home/olbohlen/.local/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /export/home/olbohlen/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /export/home/olbohlen/.local/bin/ansible\r\n  python version = 3.9.10 (main, Jan 17 2022, 16:23:45) [GCC 7.5.0]\r\n  jinja version = 3.0.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n$ ansible-config dump --only-changed | cat                                        \r\nDEFAULT_HOST_LIST(/export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg) = ['/export/home/olbohlen/git/ansible-playbooks/sin/inventory']\r\nDEFAULT_REMOTE_USER(/export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg) = localadm\r\nDEFAULT_TIMEOUT(/export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg) = 30\r\nDEFAULT_TRANSPORT(/export/home/olbohlen/git/ansible-playbooks/sin/ansible.cfg) = ssh\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nOpenIndiana Hipster 2021.10,\r\nSunOS x230 5.11 illumos-3e8b6b84e5 i86pc i386 i86pc\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n$ ansible -m ping bifroest.mgmt.home.eenfach.de                                  \r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expected to get the typical \"ping\": \"pong\" reply back\r\n\r\n### Actual Results\r\n\r\n```console\r\n(1488) x230:/export/home/olbohlen/git/ansible-playbooks/sin$ ansible -m ping bifroest.mgmt.home.eenfach.de                                   \r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: termios.error: (22, 'Invalid argument')\r\nbifroest.mgmt.home.eenfach.de | FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-02-07T20:51:55Z",
        "user": "olbohlen",
        "labels": [
            "support:core",
            "bug",
            "traceback",
            "P3",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 76956,
        "title": "ControlPath calculated only using ansible_host, preventing different ssh args per inventory_hostname",
        "body": "### Summary\n\n## Observed behavior\r\n\r\nI have hosts file configured like this:\r\n```\r\n[linux-hosts]\r\nlinux-0 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.119'\"\r\nlinux-1 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.183'\"\r\nlinux-2 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.21'\"\r\nlinux-3 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.17.208'\"\r\nlinux-4 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.17.0'\"\r\nlinux-5 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.110'\"\r\nlinux-6 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.235'\"\r\nlinux-7 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.18.255'\"\r\nlinux-8 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.18.165'\"\r\nlinux-9 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.94'\"\r\n```\r\n\r\nWhen I run my playbook against any individual host using `--limit linux-X`, it is completely fine. \r\n\r\nHowever, when I run it agains all hosts, everything is done on a single host, although Ansible reports connecting to multiple hosts. I've found out the hard way, apt locks were not obtained for no obvious reson:\r\n```\r\nTASK [setup : Update and upgrade apt packages] **********************************************************************************************************************************************************************************************************************************\r\nfatal: [linux-0]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-2]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-3]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-4]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-6]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-8]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-5]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-7]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\nfatal: [linux-9]: FAILED! => {\"changed\": false, \"msg\": \"Failed to lock apt for exclusive operation\"}\r\n\r\nchanged: [linux-1]\r\n```\r\n\r\nBut then I've verified that all connections were made to a single machine, so only one obtained the lock and the rest failed.\r\n\r\n## Expected behavior:\r\n\r\nWhen I have multiple hosts configured with ProxyCommand, I expect each host to use its own configuration.\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nInventory\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.9.27\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.12 (default, Aug 31 2021, 01:23:42) [GCC]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\n# no changes\n```\n\n\n### OS / Environment\n\nOpenSUSE Tumbleweed\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nCreate this hosts file:\r\n```yaml (paste below)\r\n[linux-hosts]\r\nlinux-0 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.119'\"\r\nlinux-1 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.183'\"\r\nlinux-2 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.21'\"\r\nlinux-3 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.17.208'\"\r\nlinux-4 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.17.0'\"\r\nlinux-5 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.110'\"\r\nlinux-6 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.19.235'\"\r\nlinux-7 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.18.255'\"\r\nlinux-8 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.18.165'\"\r\nlinux-9 ansible_host=192.168.0.3 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_ed25519_test ansible_ssh_common_args=\"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ProxyCommand='ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i ~/.ssh/id_ed25519_test -W %h:%p ubuntu@10.0.16.94'\"\r\n```\r\n\r\nRun `ansible linux* -i inventory/hosts -m setup | grep macaddress`\r\n\n\n### Expected Results\n\nI expect the ansible to connect do distinct machines using the ProxyCommand. There should be different MAC addresses reported.\n\n### Actual Results\n\n```console\nansible linux* -i inventory/hosts -m setup | grep macaddress\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n```\r\n\r\nThe settings seem to be cached:\r\n```\r\nansible linux-3 -i inventory/hosts -m setup |grep macaddress\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n            \"macaddress\": \"fa:16:3e:46:e0:96\",\r\n```\r\n\r\nAfter a while (a minute or a few) it return correct output:\r\n```\r\nansible linux-3 -i inventory/hosts -m setup |grep macaddress\r\n            \"macaddress\": \"fa:16:3e:f7:5b:03\",\r\n            \"macaddress\": \"fa:16:3e:f7:5b:03\",\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-02-05T09:50:25Z",
        "user": "thorgrin",
        "labels": [
            "inventory",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 76788,
        "title": "Support adding ansible_group_priority to keyed_groups in BaseInventoryPlugin",
        "body": "### Summary\n\nWhen using a dynamic inventory plugin that automatically creates groups there is no way for us to specify `group_vars`.\r\nThe most important one is the `ansible_group_priority` which can only be setup in inventory and dictates the way in which vars files are merged for all sibling groups.\r\n\r\nTo workaround on this I've managed to inherit the aws_ec2 inventory plugin and override ansible `_add_host_to_keyed_groups` method.\r\naws_ec2.yml\r\n```\r\nplugin: \"my_aws_ec2\"\r\nregions:\r\n  - us-east-1\r\nleading_separator: no\r\nkeyed_groups:\r\n  # Group by stack name\r\n  - key: tags[\"StackName\"]\r\n    parent_group: \"stacks\"\r\n    group_vars:\r\n      ansible_group_priority: 2\r\n```\r\nmy_aws_ec2.py\r\n```\r\nfrom ansible.errors import AnsibleError, AnsibleParserError\r\nfrom ansible.module_utils._text import to_bytes, to_native\r\nfrom ansible.module_utils.common._collections_compat import Mapping\r\nfrom ansible.module_utils.six import string_types\r\nfrom ansible.utils.vars import combine_vars, load_extra_vars\r\n\r\n\r\nfrom ansible_collections.amazon.aws.plugins.inventory.aws_ec2 import (\r\n    DOCUMENTATION as Ec2DOCUMENTATION,\r\n    InventoryModule as Ec2InventoryModule\r\n)\r\n\r\nDOCUMENTATION = Ec2DOCUMENTATION \\\r\n    .replace(\"aws_ec2\", \"my_aws_ec2\") \\\r\n\r\nclass InventoryModule(Ec2InventoryModule):\r\n\r\n    NAME = 'my_aws_ec2'\r\n\r\n    '''\r\n    Override method to add group var loading. This is the only option\r\n    https://github.com/ansible/ansible/blob/v2.12.1/lib/ansible/plugins/inventory/__init__.py\r\n    '''\r\n\r\n    def _get_parent_group(self, keyed):\r\n        raw_parent_name = keyed.get('parent_group', None)\r\n        if raw_parent_name:\r\n            try:\r\n                raw_parent_name = self.templar.template(raw_parent_name)\r\n            except AnsibleError:\r\n                pass\r\n        return raw_parent_name\r\n\r\n    def _add_host_to_keyed_groups(self, keys, variables, host, strict=False, fetch_hostvars=True):\r\n        if not (keys and isinstance(keys, list)):\r\n            return\r\n\r\n        for keyed in keys:\r\n            # Store the initial list of groups\r\n            groups_before = set(self.inventory.groups)\r\n\r\n            # Call super only for this keyed item\r\n            super(InventoryModule, self)._add_host_to_keyed_groups(\r\n                [keyed], variables, host, strict, fetch_hostvars)\r\n            parent_name = self._get_parent_group(keyed)\r\n\r\n            # Get the new list of groups\r\n            groups_after = set(self.inventory.groups)\r\n\r\n            # Set properties for the created groups only\r\n            for new_group in groups_after - groups_before - set([parent_name]):\r\n                for varname, value in keyed.get('group_vars', {}).items():\r\n                    self.inventory.set_variable(new_group, varname, value)\r\n```\r\n\r\nThe solution to fix this is basically adding 2 lines here: https://github.com/ansible/ansible/blob/v2.12.1/lib/ansible/plugins/inventory/__init__.py#L447\r\n\r\nAdding either `group_vars` dict or directly `ansible_group_priority` would work.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ninventory plugin\n\n### Additional Information\n\nThis affects all dynamic plugins. Related issues:\r\n* https://github.com/ansible-collections/amazon.aws/issues/620\r\n* https://github.com/ansible/ansible/issues/66913\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-01-18T17:21:13Z",
        "user": "sebastianmacarescu",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 76774,
        "title": "module group cannot rename group",
        "body": "### Summary\n\nWe create groups from a variable definition like `[ {\"name\": \"admins\", \"gid\": 1234}  ]`. When I change the name of a group in there after the ansible code already ran, I'd expect the `group` module to find the existing group by gid and rename it. Instead, it fails with a message `GID '1234' already exists`. #29919 suggested using the `non_unique` option of the module/groupmod, but that will create a duplicate / a new group using the same GID, which apparently is not supported by most software -- not even the group*/user* tools themselves, because removing the _old_ group name afterwards fails when users exist that have the GID as primary group -- even though the gid would persist (on the other name).\r\n\r\nSo the request here is to properly support group renames, probably using the `-n, --new-name` option of `groupmod`.\r\nCurrently the only working method seems to shell out to it.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngroup\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.1]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/jbiegert/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /tmp/ansible/venv/lib64/python3.9/site-packages/ansible\r\n  ansible collection location = /home/jbiegert/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = venv/bin/ansible\r\n  python version = 3.9.9 (main, Nov 19 2021, 00:00:00) [GCC 11.2.1 20210728 (Red Hat 11.2.1-1)]\r\n  jinja version = 3.0.3\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\ncontrol host: Fedora 34 \r\ntarget host: RHEL 8.1\r\n\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\ntest playbook below.\r\n\r\nThe first tasks demonstrate that renaming fails, the following demonstrate the damage done by the non_unique option:\r\n```yaml\r\n- hosts: all\r\n  run_once: true\r\n  become: true\r\n  tasks:\r\n    - name: create group\r\n      group:\r\n        name: oldgroupname\r\n        gid: 9999\r\n\r\n    - name: create testuser\r\n      user:\r\n        name: testuser-groupname\r\n        group: oldgroupname\r\n\r\n    - name: /etc/group content\r\n      command: grep groupname /etc/group\r\n\r\n    - name: rename group\r\n      group:\r\n        name: newgroupname\r\n        gid: 9999\r\n      ignore_errors: true  # fails with \"GID already in use\"\r\n\r\n    - name: force rename group\r\n      group:\r\n        name: newgroupname\r\n        gid: 9999\r\n        non_unique: true\r\n\r\n    - name: /etc/group content\r\n      command: grep groupname /etc/group\r\n\r\n    # should not be necessary under idempotence\r\n    - name: remove old group\r\n      group:\r\n        name: oldgroupname\r\n        state: absent\r\n      ignore_errors: true  # fails due to user having its GID as primary\r\n\r\n    - name: manually remove old group\r\n      command: sed -i -e /oldgroupname/d  /etc/group\r\n\r\n    - name: /etc/group content\r\n      command: grep groupname /etc/group\r\n\r\n```\r\n\n\n### Expected Results\n\nThe task `rename group` to succeed and rename the group, identified by the GID.\n\n### Actual Results\n\n```console\n\u276f ANSIBLE_LOAD_CALLBACK_PLUGINS=1 ANSIBLE_STDOUT_CALLBACK=yaml LANG=C.UTF-8 venv/bin/ansible-playbook -i 192.168.122.150, rename-group.yml -v\r\n\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] **********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************\r\nok: [192.168.122.150]\r\n\r\nTASK [create group] *************************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  gid: 9999\r\n  name: oldgroupname\r\n  state: present\r\n  system: false\r\n\r\nTASK [create testuser] **********************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  comment: ''\r\n  create_home: true\r\n  group: 9999\r\n  home: /home/testuser-groupname\r\n  name: testuser-groupname\r\n  shell: /bin/bash\r\n  state: present\r\n  stderr: |-\r\n    useradd: warning: the home directory already exists.\r\n    Not copying any file from skel directory into it.\r\n    Creating mailbox file: File exists\r\n  stderr_lines: <omitted>\r\n  system: false\r\n  uid: 1001\r\n\r\nTASK [/etc/group content] *******************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  cmd:\r\n  - grep\r\n  - groupname\r\n  - /etc/group\r\n  delta: '0:00:00.002372'\r\n  end: '2022-01-17 11:54:18.544475'\r\n  msg: ''\r\n  rc: 0\r\n  start: '2022-01-17 11:54:18.542103'\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: 'oldgroupname:x:9999:'\r\n  stdout_lines: <omitted>\r\n\r\nTASK [rename group] *************************************************************************************************************************\r\nfatal: [192.168.122.150]: FAILED! => changed=false\r\n  msg: |-\r\n    groupadd: GID '9999' already exists\r\n  name: newgroupname\r\n...ignoring\r\n\r\nTASK [force rename group] *******************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  gid: 9999\r\n  name: newgroupname\r\n  state: present\r\n  system: false\r\n\r\nTASK [/etc/group content] *******************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  cmd:\r\n  - grep\r\n  - groupname\r\n  - /etc/group\r\n  delta: '0:00:00.002114'\r\n  end: '2022-01-17 11:54:19.864750'\r\n  msg: ''\r\n  rc: 0\r\n  start: '2022-01-17 11:54:19.862636'\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: |-\r\n    oldgroupname:x:9999:\r\n    newgroupname:x:9999:\r\n  stdout_lines: <omitted>\r\n\r\nTASK [remove old group] *********************************************************************************************************************\r\nfatal: [192.168.122.150]: FAILED! => changed=false\r\n  msg: |-\r\n    groupdel: cannot remove the primary group of user 'testuser-groupname'\r\n  name: oldgroupname\r\n...ignoring\r\n\r\nTASK [manually remove old group] ************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  cmd:\r\n  - sed\r\n  - -i\r\n  - -e\r\n  - /oldgroupname/d\r\n  - /etc/group\r\n  delta: '0:00:00.002683'\r\n  end: '2022-01-17 11:54:20.562540'\r\n  msg: ''\r\n  rc: 0\r\n  start: '2022-01-17 11:54:20.559857'\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: ''\r\n  stdout_lines: <omitted>\r\n\r\nTASK [/etc/group content] *******************************************************************************************************************\r\nchanged: [192.168.122.150] => changed=true\r\n  cmd:\r\n  - grep\r\n  - groupname\r\n  - /etc/group\r\n  delta: '0:00:00.002197'\r\n  end: '2022-01-17 11:54:20.919638'\r\n  msg: ''\r\n  rc: 0\r\n  start: '2022-01-17 11:54:20.917441'\r\n  stderr: ''\r\n  stderr_lines: <omitted>\r\n  stdout: 'newgroupname:x:9999:'\r\n  stdout_lines: <omitted>\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-01-17T11:06:54Z",
        "user": "azrdev",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 76666,
        "title": "URI multipart file size limitation",
        "body": "### Summary\n\nWhen uploading larger files using builtin.uri using form/multipart, the upload fails after 2 GB\r\n\r\nfound a similar issue here: https://groups.google.com/g/ansible-project/c/tnx6Po206VM\r\n\r\nHowever, looks like it has to to with the python httplib ?!\r\nhttps://github.com/psf/requests/issues/2717#issuecomment-724725392\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nbuiltin.uri\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.10.15\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.7 (default, Nov 24 2021, 21:15:59) [GCC 10.3.1 20211027]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nAlpine Linux v3.15\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Upload Upgrade File, this may take a while\r\n  uri:\r\n    method: POST\r\n    url: \"{{ ppdm_baseurl }}:{{ ppdm_port }}{{ ppdm_api_ver }}/upgrade-packages\"\r\n    body_format: form-multipart\r\n    body: \r\n      file:\r\n        filename: \"{{ upload_file }}\"\r\n      mime_type: application/octet-stream  \r\n    headers:\r\n      Content-Type: multipart/form-data\r\n      authorization: \"Bearer {{ access_token }}\"    \r\n    status_code: 200,202,403\r\n    validate_certs: false\r\n  register: result  \r\n  when: not ansible_check_mode \r\n- set_fact:\r\n    upload_result: \"{{ result.json }}\"\r\n- debug:\r\n    msg: \"{{ upload_result }}\"\r\n    verbosity: 0\r\n```\r\n\n\n### Expected Results\n\nI expect the octet/stream to upload the file as chunks\n\n### Actual Results\n\n```console\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/tmp/ansible_ansible.legacy.uri_payload__3xqgmdq/ansible_ansible.legacy.uri_payload.zip/ansible/module_utils/urls.py\", line 1611, in fetch_url\r\n    r = open_url(url, data=data, headers=headers, method=method,\r\n  File \"/tmp/ansible_ansible.legacy.uri_payload__3xqgmdq/ansible_ansible.legacy.uri_payload.zip/ansible/module_utils/urls.py\", line 1393, in open_url\r\n    return Request().open(method, url, data=data, headers=headers, use_proxy=use_proxy,\r\n  File \"/tmp/ansible_ansible.legacy.uri_payload__3xqgmdq/ansible_ansible.legacy.uri_payload.zip/ansible/module_utils/urls.py\", line 1304, in open\r\n    return urllib_request.urlopen(request, None, timeout)\r\n  File \"/usr/lib/python3.9/urllib/request.py\", line 214, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/usr/lib/python3.9/urllib/request.py\", line 517, in open\r\n    response = self._open(req, data)\r\n  File \"/usr/lib/python3.9/urllib/request.py\", line 534, in _open\r\n    result = self._call_chain(self.handle_open, protocol, protocol +\r\n  File \"/usr/lib/python3.9/urllib/request.py\", line 494, in _call_chain\r\n    result = func(*args)\r\n  File \"/tmp/ansible_ansible.legacy.uri_payload__3xqgmdq/ansible_ansible.legacy.uri_payload.zip/ansible/module_utils/urls.py\", line 483, in https_open\r\n    return self.do_open(self._build_https_connection, req)\r\n  File \"/usr/lib/python3.9/urllib/request.py\", line 1346, in do_open\r\n    h.request(req.get_method(), req.selector, req.data, headers,\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1279, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1325, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1274, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 1073, in _send_output\r\n    self.send(chunk)\r\n  File \"/usr/lib/python3.9/http/client.py\", line 995, in send\r\n    self.sock.sendall(data)\r\n  File \"/usr/lib/python3.9/ssl.py\", line 1204, in sendall\r\n    v = self.send(byte_view[count:])\r\n  File \"/usr/lib/python3.9/ssl.py\", line 1173, in send\r\n    return self._sslobj.write(data)\r\nOverflowError: string longer than 2147483647 bytes\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"elapsed\": 0,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"body\": {\r\n                \"file\": {\r\n                    \"filename\": \"/root/.ansible/tmp/ansible-tmp-1641464672.1413147-225-255711373493873/dellemc-ppdm-upgrade-sw-19.9.0-17.pkg\"\r\n                },\r\n                \"mime_type\": \"application/octet-stream\"\r\n            },\r\n            \"body_format\": \"form-multipart\",\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"creates\": null,\r\n            \"dest\": null,\r\n            \"follow_redirects\": \"safe\",\r\n            \"force\": false,\r\n            \"force_basic_auth\": false,\r\n            \"group\": null,\r\n            \"headers\": {\r\n                \"Content-Type\": \"multipart/form-data; boundary=\\\"===============9138599903283805365==\\\"\",\r\n                \"authorization\": \"redacted\"\r\n            },\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"method\": \"POST\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"remote_src\": false,\r\n            \"removes\": null,\r\n            \"return_content\": false,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"status_code\": [\r\n                \"200\",\r\n                \"202\",\r\n                \"403\"\r\n            ],\r\n            \"timeout\": 30,\r\n            \"unix_socket\": null,\r\n            \"unsafe_writes\": false,\r\n            \"url\": \"https://redacted:8443/api/v2/upgrade-packages\",\r\n            \"url_password\": null,\r\n            \"url_username\": null,\r\n            \"use_proxy\": true,\r\n            \"validate_certs\": false\r\n        }\r\n    },\r\n    \"msg\": \"Status code was -1 and not [200, 202, 403]: An unknown error occurred: string longer than 2147483647 bytes\",\r\n    \"redirected\": false,\r\n    \"status\": -1,\r\n    \"url\": \"redacted\"\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2022-01-06T10:49:42Z",
        "user": "bottkars",
        "labels": [
            "easyfix",
            "support:core",
            "bug",
            "traceback",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 76548,
        "title": "ansible.builtin.file: Symlink on NFS to outside NFS gives \"invalid selinux context: [Errno 95] Operation not supported\"",
        "body": "### Summary\n\nManaging a symlink (with state: symlink) tries to set the selinux context to invalid context (for some reason it's trying to change the correct nfs_t to incottrect fusefs_t within an NFS-mounted filesystem).  This causes the module to fail with an invalid secontext.\r\n\r\nI have tried maintaining the secontext by specifying the existing value with the `setype` (and the entire thing with `serole`, `seuser` and `selevel` as well) per the ansible.builtin.file docs (https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html) but this seems to have no effect at all on what the module it trying to set.\r\n\r\nI do see the secontext change proposed (as the only change) when run with `--check --diff`.\r\n\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nfile\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.5] \r\n  config file = /mnt/home/hurstl01/projects/HPC-JM/Ansible/ansible.cfg\r\n  configured module search path = ['/mnt/home/hurstl01/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /mnt/apps/sysapps/venvs/ansible/lib/python3.6/site-packages/ansible\r\n  ansible collection location = /mnt/home/hurstl01/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /mnt/apps/sysapps/venvs/ansible/bin/ansible\r\n  python version = 3.6.8 (default, Nov 16 2020, 16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nANSIBLE_PIPELINING(/mnt/home/hurstl01/projects/HPC-JM/Ansible/ansible.cfg) = True\r\nDEFAULT_FORKS(/mnt/home/hurstl01/projects/HPC-JM/Ansible/ansible.cfg) = 50\r\nDEFAULT_TIMEOUT(/mnt/home/hurstl01/projects/HPC-JM/Ansible/ansible.cfg) = 60\r\nDISPLAY_SKIPPED_HOSTS(/mnt/home/hurstl01/projects/HPC-JM/Ansible/ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nCentOS 7\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: Create symlink\r\n  become: true\r\n  ansible.builtin.file:\r\n    force: true\r\n    owner: \"{{ item }}\"\r\n    group: \"{{ item }}\"\r\n    path: /mnt/home/{{ item }}/ANALYSIS\r\n    src: /mnt/analysis/{{ users[item].fileshare_name or item }}\r\n    follow: false\r\n    state: link\r\n  loop:\r\n    - user1\r\n    - user2\r\n```\r\n\n\n### Expected Results\n\nSymlink (which already exists, points to correct place and has correct ownership) to be unchanged (this is the case in the example result below).\r\n\r\nSymlink which is incorrect to be updated to match configuration.\r\n\r\nMissing symlink to be created according to configuration.\n\n### Actual Results\n\n```console\nfailed: [HPC-VDI-test] (item=['hurstl01', 'archive']) => {\"ansible_loop_var\": \"item\", \"changed\": false, \"cur_context\": [\"system_u\", \"object_r\", \"nfs_t\", \"s0\"], \"gid\": 2019, \"group\": \"hurstl01\", \"input_was\": [\"system_u\", \"object_r\", \"nfs_t\", \"s0\"], \"item\": [\"hurstl01\", \"archive\"], \"mode\": \"0777\", \"msg\": \"invalid selinux context: [Errno 95] Operation not supported\", \"new_context\": [\"system_u\", \"object_r\", \"fusefs_t\", \"s0\"], \"owner\": \"hurstl01\", \"path\": \"/mnt/home/hurstl01/ARCHIVE\", \"secontext\": \"system_u:object_r:nfs_t:s0\", \"size\": 12, \"state\": \"link\", \"uid\": 2019}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-12-12T18:50:11Z",
        "user": "LHurst-JM",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.11"
        ]
    },
    {
        "number": 76521,
        "title": "[cron] An extra line should be added after the cronjob in the crontab",
        "body": "### Summary\n\nHello there \ud83d\udc4b\r\n\r\nI've had an issue with a cronjob installed on a guest server using the ansible cron module.\r\n\r\nMy cronjob never triggered and after [some research](https://serverfault.com/questions/230370/why-is-only-one-wget-command-working-in-my-crontab), I found out that adding an extra line bellow the task it in the crontab made it work again.\r\n\r\nCould the cron module ensure that the cron line is not the last line of the file to avoid any error of this type?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncron\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.12.0]\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/nicolas/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/nicolas/.local/lib/python3.10/site-packages/ansible\r\n  ansible collection location = /home/nicolas/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.10.0 (default, Oct  4 2021, 00:00:00) [GCC 11.2.1 20210728 (Red Hat 11.2.1-1)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nDesktop : Fedora 35 Workstation\r\nServer (target) : Debian 11 Bullseye in a QEMU/KVM\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: gitea | gitea-backup\r\n  cron:\r\n    name: gitea-backup\r\n    user: root\r\n    minute: \"5,20,35,50\"\r\n    job: /home/nicolas/scripts/gitea/gitea-backup.sh\r\n\r\n```\r\n\n\n### Expected Results\n\nI expected my cronjob to run every fifteen minutes. (I chose \"5,20,35,50\" because it needed to be run after another task that runs every \"*/15\").\n\n### Actual Results\n\n```console\nThere is no error as far as Ansible is concerned. It's at the cron level and it doesn't show any error.\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-12-09T17:33:31Z",
        "user": "ghost",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 76519,
        "title": "Ability to append a path to a setting's path list",
        "body": "### Summary\n\nSeveral settings are effectively a list of paths. I would like to be able to _add_ a path to the setting without overwriting any lower-layer setting.\r\n\r\nThe allowed way to apply Ansible settings are (from [docs](https://docs.ansible.com/ansible/latest/reference_appendices/config.html)) in order of lowest-to-highest precedence:\r\n\r\n1. config file at /etc/ansible/ansible.cfg\r\n2. config file at ansible.cfg (in the current directory)\r\n3. config file at ~/.ansible.cfg (in the home directory)\r\n4. config file at ANSIBLE_CONFIG (environment variable if set)\r\n5. environment variable for some specific setting\r\n\r\nThe case which is a common pain point for AWX and ansible-runner is that we wish to programmatically add a path to one particular setting, for which (5) is most appropriate, but settings in a config file in the cwd (2) get ignored when we do this.\r\n\r\nFor a solution, consider how we typically add to the `PATH` environment variable\r\n\r\n```bash\r\nexport PATH=$PATH:/tmp/foo/\r\n```\r\n\r\nIt would be ideal to do something similar for Ansible settings like\r\n\r\n```bash\r\nexport ANSIBLE_COLLECTIONS_PATH=$current:/runner/special_collections_folder\r\n```\r\n\r\nWhere `$current` reflects the value in the `ansible.cfg` file when applicable, or the default value if there is no config file value.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\nlib/ansible/config/base.yml\n\n### Additional Information\n\nThis is a technical debt item that I wish to document. Let me outline what this would specifically improve.\r\n\r\nIn ansible-runner, we can't respect the user's callback plugins if they enable them in `ansible.cfg`. Because of this, our workaround is to tell users to set it in the environment variable, because that's something we _can_ combine with.\r\n\r\nhttps://github.com/ansible/ansible-runner/blob/af811a8e3c72d5a119d0bff0db698cdbb30ce205/ansible_runner/config/_base.py#L265\r\n\r\nIn AWX, not respecting `ansible.cfg` was not acceptable for the roles paths or collection paths variable. We download `requirements.yml` before a job run if someone includes it in their project. Because of this, AWX had to [parse the user's config](https://github.com/ansible/awx/blob/19b4849345ecc7f9b2bd6b8df77e31116d494f62/awx/main/utils/ansible.py#L101), and then [combine with the additional path](https://github.com/ansible/awx/blob/19b4849345ecc7f9b2bd6b8df77e31116d494f62/awx/main/tasks.py#L1706-L1724). I suspect that this is not 100% correct, but the bigger problem is that we have other settings that we technically need to use this method for... but I would rather not do that if we can get some alternative in core.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-12-09T15:50:23Z",
        "user": "AlanCoding",
        "labels": [
            "support:core",
            "feature",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 76384,
        "title": "DNF module upgrades modules with `state: present` or `state: installed`",
        "body": "### Summary\r\n\r\nWhen running the DNF module with `state: present` or `state: installed`, certain packages will be upgraded even though they should be skipped with that parameter.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ndnf\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.10.15\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.8 (default, Aug 24 2020, 17:57:11) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nCentOS 8\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nredis package is already installed.\r\n\r\n```\r\n[root@c8 ~]# rpm -qa | grep redis\r\nredis-5.0.3-2.module_el8.2.0+318+3d7e67ea.x86_64\r\n```\r\n\r\nNext, run the following playbook.\r\n\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  tasks:\r\n    - dnf:\r\n        name: '@redis:5'\r\n        state: present\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nWith `state: present` or `installed`, it is expected that packages with available updates do not get updated.\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [dnf] *************************************************************************************************************************************************\r\ntask path: /root/playbook.yml:3\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993 `\" && echo ansible-tmp-1638195909.4688942-5425-281163792679993=\"` echo /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993 `\" ) && sleep 0'\r\nUsing module file /usr/local/lib/python3.6/site-packages/ansible/modules/dnf.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-53303e4t90od/tmpmpdxsfb2 TO /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993/AnsiballZ_dnf.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993/ /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993/AnsiballZ_dnf.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3.6 /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993/AnsiballZ_dnf.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1638195909.4688942-5425-281163792679993/ > /dev/null 2>&1 && sleep 0'\r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_downgrade\": false,\r\n            \"allowerasing\": false,\r\n            \"autoremove\": false,\r\n            \"bugfix\": false,\r\n            \"conf_file\": null,\r\n            \"disable_excludes\": null,\r\n            \"disable_gpg_check\": false,\r\n            \"disable_plugin\": [],\r\n            \"disablerepo\": [],\r\n            \"download_dir\": null,\r\n            \"download_only\": false,\r\n            \"enable_plugin\": [],\r\n            \"enablerepo\": [],\r\n            \"exclude\": [],\r\n            \"install_repoquery\": true,\r\n            \"install_weak_deps\": true,\r\n            \"installroot\": \"/\",\r\n            \"list\": null,\r\n            \"lock_timeout\": 30,\r\n            \"name\": [\r\n                \"@redis:5\"\r\n            ],\r\n            \"releasever\": null,\r\n            \"security\": false,\r\n            \"skip_broken\": false,\r\n            \"state\": \"present\",\r\n            \"update_cache\": false,\r\n            \"update_only\": false,\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"msg\": \"Check mode: No changes made, but would have if not in check mode\",\r\n    \"rc\": 0,\r\n    \"results\": [\r\n        \"Installed: redis-5.0.3-5.module_el8.4.0+955+7126e393.x86_64\",\r\n        \"Removed: redis-5.0.3-2.module_el8.2.0+318+3d7e67ea.x86_64\"\r\n    ]\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-11-29T14:23:58Z",
        "user": "1kaw",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 76376,
        "title": "The `l` in libuser's `luserdel`, `luseradd`, `lchage`, `lgroupmod` does not stand for \"local\", so \"local=yes\" or \"forcelocal=true\" ... aren't what they say they are",
        "body": "### Summary\n\nI discovered this because someone suggested the utility on the [centos mailing list](https://lists.centos.org/pipermail/centos/2021-November/354698.html) and pointed back to Ansible as an example.\r\n\r\nSee [ansible/modules/user.py](https://github.com/ansible/ansible/blame/0afc0b8506cc80897073606157c984c9176f545c/lib/ansible/modules/user.py#L640-L643), which points back to [ansible-modules-core issue 2193](https://github.com/ansible/ansible-modules-core/issues/2193). I'm not sure if that's where the misconception started, but... \"libuser\" is not \"local\" versions of these tools. It's versions of these tools that happen to use the library, as opposed to the traditional ones.\r\n\r\nSee https://pagure.io/libuser:\r\n\r\n> About\r\n> =====\r\n>\r\n> The libuser library implements a standardized interface for manipulating and\r\n> administering user and group accounts.  The library uses pluggable back-ends to\r\n> interface to its data sources.\r\n> \r\n> Sample applications modeled after those included with the shadow password suite\r\n> are included.\r\n\r\nThe plugable backends include _at least_ include an LDAP backend. Now, it probably _usually_ happens that the `lwhatever` commands are not actually properly configured to do remote operations (who edits `/etc/libuser.conf`, right?), so it probably _usually_ works. But it seems like this is a disaster waiting to happen.\r\n\r\nMaybe there is some other suite of l-prefixed user-manipulation commands, but I'm not aware of one and didn't find one on quick search. In any case, it's not safe to assume.\r\n\r\nIs this silly? Probably. Is it _especially_ silly that a bunch of distros install two sets of utilities that basically do the same thing in slightly different ways? Probably also yes! But here we are.\r\n\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncore\n\n### Ansible Version\n\n```console\nLooks like... everything for the past few years?\n```\n\n\n### Configuration\n\n```console\nn/a\n```\n\n\n### OS / Environment\n\nEverything in the RH distro universe at least.\n\n### Steps to Reproduce\n\nI guess...\r\n\r\n1. configure `/etc/libuser.conf` to use LDAP\r\n2. run an ansible user-manipulation command with \"local\"\n\n### Expected Results\n\n1. local user manipulation only\n\n### Actual Results\n\n```console\noh no! ldap happened!\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-11-27T03:13:41Z",
        "user": "mattdm",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 76237,
        "title": "Additional exceptions attached to stderr in script module",
        "body": "### Summary\n\nWith remote host windows, when using script module if the script write some content to stderr, then additional exceptions will be attached to the content in result.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nscript\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.10.6\r\n  config file = None\r\n  configured module search path = ['/Users/xxxxx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/xxxxx/Library/Python/3.7/lib/python/site-packages/ansible\r\n  executable location = /Users/xxxxx/Library/Python/3.7/bin/ansible\r\n  python version = 3.7.9 (v3.7.9:13c94747c7, Aug 15 2020, 01:31:08) [Clang 6.0 (clang-600.0.57)]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nempty\n```\n\n\n### OS / Environment\n\nControl node: MacOS 10.15.7\r\nManged node: Windows 2019\n\n### Steps to Reproduce\n\nPlaybook:\r\n```yaml (paste below)\r\n---\r\n- name: test script module\r\n  hosts: all\r\n  tasks:\r\n    - name: test local script\r\n      script: show_warning.py\r\n      args:\r\n        executable: 'path\\to\\python.exe'\r\n```\r\nshow_warning.py\r\n```\r\nimport sys\r\nprint(\"test content\", file=sys.stderr)\r\n```\n\n### Expected Results\n\n\"stderr\" should only contain \"test content\" in result.\n\n### Actual Results\n\n```console\nTASK [test local script] *********************************************************************************************************************************************\r\ntask path: /Users/xxxx/Temp/playbooks/HelloWorld.yaml:8\r\n<xx.xx.xx.xx> ESTABLISH WINRM CONNECTION FOR USER: xxxxxx on PORT 5986 TO 10.31.2.209\r\nEXEC (via pipeline wrapper)\r\n<xx.xx.xx.xx> PUT \"/Users/xxxx/Temp/playbooks/show_warning.py\" TO \"C:\\Users\\xxxxxx\\AppData\\Local\\Temp\\ansible-tmp-1636358586.975513-5380-121049279246891\\show_warning.py\"\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nchanged: [xx.xx.xx.xx] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"test contentAt line:1 char:1+ &  C:\\\\Users\\\\xxxxxx\\\\cilib\\\\Scripts\\\\python.exe C:\\\\Users\\\\Administr ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : NotSpecified: (test content:String) [], RemoteException    + FullyQualifiedErrorId : NativeCommandErrorScriptStackTrace:at <ScriptBlock>, <No file>: line 1\",\r\n    \"stderr_lines\": [\r\n        \"test contentAt line:1 char:1+ &  C:\\\\Users\\\\Administrator\\\\cilib\\\\Scripts\\\\python.exe C:\\\\Users\\\\Administr ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : NotSpecified: (test content:String) [], RemoteException    + FullyQualifiedErrorId : NativeCommandErrorScriptStackTrace:at <ScriptBlock>, <No file>: line 1\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-11-08T08:06:20Z",
        "user": "dozhang",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.10",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 76221,
        "title": "git module changes .git/config despite check_mode when combined with --diff",
        "body": "### Summary\n\nThe git module overrides the URL of the given remote in .git/config despite check_mode when it is check_mode is combined with `--diff`. But only when the current HEAD of the repository tracks a remote branch of the remote URL specified in the git task.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngit\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.6] \r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/burk/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/burk/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.7 (default, Oct 10 2021, 15:13:22) [GCC 11.1.0]\r\n  jinja version = 3.0.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nTarget OS: Ubuntu 18.04 and arch linux\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yml\r\n- hosts: all\r\n  connection: local\r\n  gather_facts: false\r\n  tasks:\r\n    - name: \"PREPARE: Clone git repository\"\r\n      git:\r\n        repo: https://github.com/jojoob/test.git\r\n        dest: /tmp/ansible-git-test\r\n      check_mode: no\r\n    - name: \"PREPARE: Add another remote and checkout branch\"\r\n      tags:\r\n        - remotecheckout\r\n      shell:\r\n        cmd: git remote add other https://github.com/jojoob/test2.git; git fetch other; git checkout other/main\r\n        chdir: /tmp/ansible-git-test\r\n      check_mode: no\r\n    - name: \"TEST CASE: Override remote url even with check_mode when using --diff\"\r\n      git:\r\n        repo: https://github.com/jojoob/test2.git\r\n        dest: /tmp/ansible-git-test\r\n      check_mode: yes\r\n      diff: yes\r\n```\r\n\n\n### Expected Results\n\nAfter running this play with `ansible-playbook` (crucial is the combination of `--check` and `--diff`, no matter if defined as CLI argument or in the task) I expect the .git/config file to be exactly the same as before the last git task in this play:\r\n\r\n```\r\n[core]\r\n\trepositoryformatversion = 0\r\n\tfilemode = true\r\n\tbare = false\r\n\tlogallrefupdates = true\r\n[remote \"origin\"]\r\n\turl = https://github.com/jojoob/test.git\r\n\tfetch = +refs/heads/*:refs/remotes/origin/*\r\n[branch \"main\"]\r\n\tremote = origin\r\n\tmerge = refs/heads/main\r\n[remote \"other\"]\r\n\turl = https://github.com/jojoob/test2.git\r\n\tfetch = +refs/heads/*:refs/remotes/other/*\r\n```\n\n### Actual Results\n\n```console\n# Actual Result\r\nInstead of .git/config being untouched the remote URL of remote 'origin' changed to `.../test2.git`:\r\n\r\n\r\n[core]\r\n\trepositoryformatversion = 0\r\n\tfilemode = true\r\n\tbare = false\r\n\tlogallrefupdates = true\r\n[remote \"origin\"]\r\n\turl = https://github.com/jojoob/test2.git\r\n\tfetch = +refs/heads/*:refs/remotes/origin/*\r\n[branch \"main\"]\r\n\tremote = origin\r\n\tmerge = refs/heads/main\r\n[remote \"other\"]\r\n\turl = https://github.com/jojoob/test2.git\r\n\tfetch = +refs/heads/*:refs/remotes/other/*\r\n```\r\n\r\nAnsible output:\r\n\r\n```\r\nTASK [TEST CASE: Override remote url even with check_mode when using --diff] *******************************************************************************\r\ndiff --git a/README.md b/README.md\r\nindex e055c2e..00bcb6e 100644\r\n--- a/README.md\r\n+++ b/README.md\r\n@@ -1 +1 @@\r\n-# test2\r\n\\ No newline at end of file\r\n+# test\r\n\\ No newline at end of file\r\nchanged: [localhost] => {\"after\": \"bf9243b80c73ee6201f234e04a821c0c5771daa8\", \"before\": \"6d2770a2458e971fe09443a038f84596296d753f\", \"changed\": true, \"remote_url_changed\": true}\r\n```\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-11-04T08:14:21Z",
        "user": "jojoob",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "affects_2.11",
            "affects_2.13"
        ]
    },
    {
        "number": 76210,
        "title": "apt module fails to do apt-upgrade with cache_valid_time set and update_cache=yes",
        "body": "### Summary\n\nRunning an apt upgrade fails because the apt cache is out of date:\r\n\r\n        - name: do an apt upgrade\r\n          apt:\r\n            name: \"*\"\r\n            state: latest\r\n            update_cache: yes\r\n            force_apt_get: True\r\n            cache_valid_time: 600\r\n          become: yes\r\n          register: apt_action\r\n          retries: 100\r\n\r\nWhen I do an `apt update` by hand and then re-run the playbook it works. I suppose it could be that the 10 minute valid time is at issue; I don't think it's the case that I've been so unlucky as to have had this problem multiple times over multiple days. But I suppose that's possible.\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\napt\n\n### Ansible Version\n\n```console\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]. This\r\n feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\nansible [core 2.11.6] \r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/dist-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]\r\n  jinja version = 3.0.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\ns[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]. This\r\n feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\n```\n\n\n### OS / Environment\n\nDebian GNU/Linux 10 \\n \\l\r\n\n\n### Steps to Reproduce\n\n```yaml (paste below)\r\n        - name: do an apt upgrade\r\n          apt:\r\n            name: \"*\"\r\n            state: latest\r\n            update_cache: yes\r\n            force_apt_get: True\r\n            cache_valid_time: 600\r\n          become: yes\r\n          register: apt_action\r\n          retries: 100\r\n          until: apt_action is success or ('Failed to lock apt for exclusive operation' not in apt_action.msg and '/var/lib/dpkg/lock' not in apt_action.msg)\r\n          when: ansible_distribution == 'Ubuntu' or ansible_distribution == 'Ubuntu'\r\n```\r\n\n\n### Expected Results\n\nI expected a successful apt upgrade\n\n### Actual Results\n\n```console\nfatal: [167.71.88.47]: FAILED! => {\"attempts\": 1, \"changed\": false, \"msg\": \"'/usr/bin/apt-get upgrade --with-new-pkgs ' failed: E: Failed to fetch http://mirrors.digitalocean.com/ubuntu/pool/universe/o/open-vm-tools/open-vm-tools_11.3.0-2ubuntu0~ubuntu20.04.1_amd64.deb  404  Not Found [IP: 104.21.29.13 80]\r\nE: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?\r\n\", \"rc\": 100, \"stdout\": \"Reading package lists...\r\nBuilding dependency tree...\r\nReading state information...\r\nCalculating upgrade...\r\nThe following packages will be upgraded:\r\n  open-vm-tools\r\n1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\r\nNeed to get 648 kB of archives.\r\nAfter this operation, 950 kB of additional disk space will be used.\r\nErr:1 http://mirrors.digitalocean.com/ubuntu focal-updates/universe amd64 open-vm-tools amd64 2:11.3.0-2ubuntu0~ubuntu20.04.1\r\n  404  Not Found [IP: 104.21.29.13 80]\r\n\", \"stdout_lines\": [\"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"Calculating upgrade...\", \"The following packages will be upgraded:\", \"  open-vm-tools\", \"1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\", \"Need to get 648 kB of archives.\", \"After this operation, 950 kB of additional disk space will be used.\", \"Err:1 http://mirrors.digitalocean.com/ubuntu focal-updates/universe amd64 open-vm-tools amd64 2:11.3.0-2ubuntu0~ubuntu20.04.1\", \"  404  Not Found [IP: 104.21.29.13 80]\"]}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-11-03T15:43:55Z",
        "user": "pfaffman",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.11",
            "affects_2.13"
        ]
    },
    {
        "number": 76105,
        "title": "Can't specify `none` as default for `vars` lookup.",
        "body": "### Summary\n\nUsing the lookup filter on `vars`, if it falls back to a default and the default value is `none` then it fails complaining it can't find the looked-up var. This isn't right - not being able to find the looked-up var is expected and why a default is provided. There are no docs that the default can't be `none` and that is useful functionality.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nfilter\n\n### Ansible Version\n\n```console\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current \r\nversion: 3.6.8 (default, Mar 19 2021, 05:13:41) [GCC 8.4.1 20200928 (Red Hat 8.4.1-1)]. This feature will be removed \r\nfrom ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in \r\nansible.cfg.\r\nansible [core 2.11.5] \r\n  config file = /home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg\r\n  configured module search path = ['/home/centos/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/centos/alarc-slurm-dev/venv/lib64/python3.6/site-packages/ansible\r\n  ansible collection location = /home/centos/alarc-slurm-dev/ansible/collections\r\n  executable location = /home/centos/alarc-slurm-dev/venv/bin/ansible\r\n  python version = 3.6.8 (default, Mar 19 2021, 05:13:41) [GCC 8.4.1 20200928 (Red Hat 8.4.1-1)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current \r\nversion: 3.6.8 (default, Mar 19 2021, 05:13:41) [GCC 8.4.1 20200928 (Red Hat 8.4.1-1)]. This feature will be removed \r\nfrom ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in \r\nansible.cfg.\r\nANY_ERRORS_FATAL(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = True\r\nCOLLECTIONS_PATHS(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = ['/home/centos/alarc-slurm-dev/a>\r\nDEFAULT_FORKS(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = 30\r\nDEFAULT_GATHERING(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = ['/home/centos/alarc-slurm-dev/e>\r\nDEFAULT_ROLES_PATH(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = ['/home/centos/alarc-slurm-dev/>\r\nDEFAULT_STDOUT_CALLBACK(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = debug\r\nDEFAULT_VAULT_PASSWORD_FILE(env: ANSIBLE_VAULT_PASSWORD_FILE) = /home/centos/vault-password.txt\r\nHOST_KEY_CHECKING(/home/centos/alarc-slurm-dev/environments/alaska-dev/ansible.cfg) = False\n```\n\n\n### OS / Environment\n\nCentOS 8.4\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- hosts: localhost\r\n  tasks:\r\n    - debug:\r\n        msg: \"{{ lookup('vars', 'no_such_var', default=none) }}\"\r\n\r\n```\r\n\n\n### Expected Results\n\nExpected:\r\n\r\n```yaml\r\nTASK [debug] **********************************************************************************************************\r\nok: [localhost] => {}\r\n```\n\n### Actual Results\n\n```console\nTASK [debug] **********************************************************************************************************\r\nfatal: [localhost]: FAILED! => {}\r\n\r\nMSG:\r\n\r\nThe task includes an option with an undefined variable. The error was: No variable found with this name: no_such_var\r\n\r\nThe error appears to be in '/home/centos/alarc-slurm-dev/debug.yml': line 5, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n        msg: \"{{ none }}\"\r\n    - debug:\r\n      ^ here\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-10-21T13:23:37Z",
        "user": "sjpb",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.11",
            "affects_2.13"
        ]
    },
    {
        "number": 75957,
        "title": "import_tasks not working correctly when used within import_tasks",
        "body": "### Summary\n\nWhen import_tasks is used within import_tasks it loads the wrong file from a different role. This happens if your running ansible from the \"different role\" which is what Molecule does.\r\n\r\nCreated a repository to demonstrate the potential bug: https://github.com/klj613/ansible-importvars-issue\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nimport_tasks\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.5] \r\n  config file = None\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/code/ansible-importvars-issue/venv/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/user/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/user/code/ansible-importvars-issue/venv/bin/ansible\r\n  python version = 3.9.7 (default, Aug 31 2021, 13:28:12) [GCC 11.1.0]\r\n  jinja version = 3.0.2\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nno output from this command\n```\n\n\n### OS / Environment\n\nArch Linux\r\nPython 3.9.7\n\n### Steps to Reproduce\n\nReproduction is also on https://github.com/klj613/ansible-importvars-issue for ease of use\r\n\r\nSetup:\r\n```yaml\r\n# playbook.yml\r\n---\r\n- hosts: all\r\n  connection: local \r\n  roles:\r\n    - 'role2'\r\n\r\n# roles/role1/tasks/main.yml\r\n---\r\n- import_tasks: 'imported_tasks.yml'\r\n\r\n# roles/role1/tasks/imported_tasks.yml\r\n---\r\n- name: 'role1 imported task'\r\n  pause:\r\n    minutes: 1\r\n\r\n# roles/role2/tasks/main.yml\r\n---\r\n- import_tasks: 'middle.yml'\r\n\r\n# roles/role2/tasks/middle.yml\r\n---\r\n- import_tasks: 'imported_tasks.yml'\r\n\r\n# roles/role2/tasks/imported_tasks.yml\r\n---\r\n- name: 'role2 imported task'\r\n  pause:\r\n    minutes: 1\r\n```\r\n\r\n```bash\r\ncd ./roles/role1\r\nansible-playbook -i 127.0.0.1, ../../playbook.yml\r\n```\r\n\n\n### Expected Results\n\nGet prompted by \"role2 imported task\" task as per roles/role2/tasks/imported_tasks.yml\n\n### Actual Results\n\n```console\nGot prompted by \"role1 imported task\" task. roles/role1/tasks/imported_tasks.yml is imported instead of roles/role2/tasks/imported_tasks.yml\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-10-07T22:26:35Z",
        "user": "klj613",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.11",
            "affects_2.14"
        ]
    },
    {
        "number": 75786,
        "title": "PluginLoader._find_fq_plugin incorrectly handles FQCRs with subdirs",
        "body": "### Summary\n\nAccording to comments and docs in AnsbileCollectionRef.from_fqcr, collection references can have form `ns.coll.subdir1.subdir2.resource`, which should translate to `ansible_collections.ns.coll.plugins.subdir1.subdir2.(plugintype).resource`.\r\n\r\nOn example of `netapp_eseries.santricity.netapp_e_alerts`, I've found out by debugging that when loading the declared `netapp_eseries.santricity.santricity.netapp.eseries` documentation fragment the `_find_fq_plugin` function verifies and loads the `ansible_collections.netapp_eseries.santricity.plugins.doc_fragments.santricity` package (which succeeds as there is a `santricity.py` in `doc_fragments`, but returns path to the `netapp.py` file.\r\n\r\nThis could be a bug in either `PluginLoader` or `AnsbileCollectionRef`, or a combination thereof.\r\n\r\nAt the same time the `netapp_eseries.santricity.santricity.netapp.eseries` is most likely wrong too (and should be `netapp_eseries.santricity.netapp.eseries`), but due to the bug described above it works.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nPluginLoader\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.2] \r\n  config file = /home/tomasz/.ansible.cfg\r\n  configured module search path = ['/home/tomasz/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/tomasz/.local/lib/python3.6/site-packages/ansible\r\n  ansible collection location = /home/tomasz/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/tomasz/.local/bin/ansible\r\n  python version = 3.6.9 (default, Jul 17 2020, 12:50:27) [GCC 8.4.0]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nUbuntu 18.04 under WSL\n\n### Steps to Reproduce\n\nRun/debug the following:\r\n```bash\r\nansible-doc netapp_eseries.santricity.netapp_e_alerts\r\n```\r\n\n\n### Expected Results\n\nAn output similar to the following:\r\n```\r\nERROR! module netapp_eseries.santricity.netapp_e_alerts missing documentation (or could not parse documentation): unknown doc_fragment(s) in file /home/tomasz/.local/lib/python3.6/site-packages/ansible_collections/netapp_eseries/santricity/plugins/modules/netapp_e_alerts.py: netapp_eseries.santricity.santricity.netapp.eseries\r\n```\n\n### Actual Results\n\n```console\n> NETAPP_ESERIES.SANTRICITY.NETAPP_E_ALERTS    (/home/tomasz/.local/lib/python3.6/site-packages/ansible_collections/netapp_eseries/santricity/plugins/modules/netapp_e_alerts.py)\r\n\r\n        Certain E-Series systems have the capability to send email\r\n        notifications on potentially critical events. This module will\r\n        allow the owner of the system to specify email recipients for\r\n        these messages.\r\n\r\nOPTIONS (= is mandatory):\r\n\r\n= api_password\r\n        The password to authenticate with the SANtricity Web Services\r\n        Proxy or Embedded Web Services API.\r\n\r\n        type: str\r\n\r\n= api_url\r\n        The url to the SANtricity Web Services Proxy or Embedded Web\r\n        Services API. Example https://prod-1.wahoo.acme.com/devmgr/v2\r\n\r\n        type: str\r\n\r\n= api_username\r\n        The username to authenticate with the SANtricity Web Services\r\n        Proxy or Embedded Web Services API.\r\n\r\n        type: str\r\n\r\n- contact\r\n        Allows the owner to specify some free-form contact information\r\n        to be included in the emails.\r\n        This is typically utilized to provide a contact phone number.\r\n        [Default: (null)]\r\n        type: str\r\n\r\n- log_path\r\n        Path to a file on the Ansible control node to be used for\r\n        debug logging\r\n        [Default: (null)]\r\n        type: str\r\n\r\n- recipients\r\n        The email addresses that will receive the email notifications.\r\n        Required when `state=enabled'.\r\n        [Default: (null)]\r\n        type: list\r\n\r\n- sender\r\n        This is the sender that the recipient will see. It doesn't\r\n        necessarily need to be a valid email account.\r\n        Required when `state=enabled'.\r\n        [Default: (null)]\r\n        type: str\r\n\r\n- server\r\n        A fully qualified domain name, IPv4 address, or IPv6 address\r\n        of a mail server.\r\n        To use a fully qualified domain name, you must configure a DNS\r\n        server on both controllers using [netapp_e_mgmt_interface]. -\r\n        Required when `state=enabled'.\r\n        [Default: (null)]\r\n        type: str\r\n\r\n- ssid\r\n        The ID of the array to manage. This value must be unique for\r\n        each array.\r\n        [Default: 1]\r\n        type: str\r\n\r\n- state\r\n        Enable/disable the sending of email-based alerts.\r\n        (Choices: enabled, disabled)[Default: enabled]\r\n        type: str\r\n\r\n- test\r\n        When a change is detected in the configuration, a test email\r\n        will be sent.\r\n        This may take a few minutes to process.\r\n        Only applicable if `state=enabled'.\r\n        [Default: False]\r\n        type: bool\r\n\r\n- validate_certs\r\n        Should https certificates be validated?\r\n        [Default: True]\r\n        type: bool\r\n\r\n\r\nNOTES:\r\n      * Check mode is supported.\r\n      * Alertable messages are a subset of messages shown by the\r\n        Major Event Log (MEL), of the storage-system. Examples\r\n        of alertable messages include drive failures, failed\r\n        controllers, loss of redundancy, and other\r\n        warning/critical events.\r\n      * This API is currently only supported with the Embedded\r\n        Web Services API v2.0 and higher.\r\n      * The E-Series Ansible modules require either an instance\r\n        of the Web Services Proxy (WSP), to be available to\r\n        manage the storage-system, or an E-Series storage-system\r\n        that supports the Embedded Web Services API.\r\n      * Embedded Web Services is currently available on the\r\n        E2800, E5700, EF570, and newer hardware models.\r\n      * [netapp_e_storage_system] may be utilized for\r\n        configuring the systems managed by a WSP instance.\r\n\r\n\r\nAUTHOR: Michael Price (@lmprice)\r\n\r\nMETADATA:\r\n  metadata_version: '1.1'\r\n  status:\r\n  - deprecated\r\n  supported_by: community\r\n\r\n\r\nVERSION_ADDED_COLLECTION: netapp_eseries.santricity\r\n\r\nEXAMPLES:\r\n\r\n- name: Enable email-based alerting\r\n      netapp_e_alerts:\r\n        state: enabled\r\n        sender: noreply@example.com\r\n        server: mail@example.com\r\n        contact: \"Phone: 1-555-555-5555\"\r\n        recipients:\r\n            - name1@example.com\r\n            - name2@example.com\r\n        api_url: \"10.1.1.1:8443\"\r\n        api_username: \"admin\"\r\n        api_password: \"myPass\"\r\n\r\n    - name: Disable alerting\r\n      netapp_e_alerts:\r\n        state: disabled\r\n        api_url: \"10.1.1.1:8443\"\r\n        api_username: \"admin\"\r\n        api_password: \"myPass\"\r\n\r\n\r\nRETURN VALUES:\r\n- msg\r\n        Success message\r\n\r\n        returned: on success\r\n        sample: The settings have been updated.\r\n        type: str\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-09-25T14:12:07Z",
        "user": "tomaciazek",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 75776,
        "title": "unable to connect to socket on 1-2% of target devices",
        "body": "### Summary\n\nIf we call a large playbook intended for readiness check for SW-Upgrades on cisco devices (using cisco.ios) we get some of \"unable to connect to socket\" error. You cant reproduce same behaviour for each call. The socket error appears on randomly on different tasks and randomly on different devices. For instance 1st call task1 on switch3, 2nd call on task14 on switch34, 3rd call on task5 on router3. \r\nWith other playbooks we never recognized to run into this socket error, but this playbook is the largest one with many tasks.\r\n\r\nwith debugging traceback:\r\n/usr/lib/python2.7/dist-packages/ansible/module_utils/connection.py\\\", line 150, ..., line 199, in send\\n    raise ConnectionError('unable to connect to socket', err=to_text(e, errors='surrogate_then_replace'), \r\n\r\nmonitoring resources:\r\nwatch -d -n 1 \"ss -l| grep ansible | wc -l\" never over 65, in time of 1st socket error 61\r\nCount is very far away from any resource limits. \r\n\r\ncleared also ~/.ansibe/pc, reboot machine, upgraded ansible - but nothing helped\r\n\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nconnection.py\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.9.26\r\n  config file = /cc/ansible/Cisco_IOS_Updates/ansible.cfg\r\n  configured module search path = [u'/home/neus_st/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Feb 27 2021, 15:10:58) [GCC 7.5.0]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nACTION_WARNINGS(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = False\r\nDEFAULT_FORKS(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = 20\r\nDEFAULT_GATHERING(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = explicit\r\nDEFAULT_HOST_LIST(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = [u'/cc/ansible/Ci\r\nDISPLAY_SKIPPED_HOSTS(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = False\r\nHOST_KEY_CHECKING(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = /usr/bin/python3\r\nRETRY_FILES_ENABLED(/cc/ansible/Cisco_IOS_Updates/ansible.cfg) = False\n```\n\n\n### OS / Environment\n\n$ cat /etc/os-release\r\nNAME=\"Ubuntu\"\r\nVERSION=\"18.04.5 LTS (Bionic Beaver)\"\r\nID=ubuntu\r\nID_LIKE=debian\r\nPRETTY_NAME=\"Ubuntu 18.04.5 LTS\"\r\nVERSION_ID=\"18.04\"\r\nHOME_URL=\"https://www.ubuntu.com/\"\r\nSUPPORT_URL=\"https://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\nVERSION_CODENAME=bionic\r\nUBUNTU_CODENAME=bionic\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n$/cc/ansible/Cisco_IOS_Updates$ ansible-playbook - i inventory/bunch1.txt chk4update.yml\r\n```\r\n\n\n### Expected Results\n\nI expect no times socket errors\n\n### Actual Results\n\n```console\n#beginning\r\n<10.0.0.1> control socket path is /home/neus_st/.ansible/pc/f4ac9063be\r\n<10.0.0.1> local domain socket listeners started successfully\r\n....\r\n#crashing\r\n<10.0.0.1> attempting to start connection\r\n<10.0.0.1> using connection plugin network_cli\r\nfatal: [switsch123]: FAILED! => {\r\n    \"msg\": \"Traceback (most recent call last):\\n  File \\\"/usr/bin/ansible-connection\\\", line 342, in <module>\\n    main()\\n  File \\\"/usr/bin/ansible-connection\\\", line 305, in main\\n    conn.set_options(var_options=variables)\\n  File \\\"/usr/lib/python2.7/dist-packages/ansible/module_utils/connection.py\\\", line 179, in __rpc__\\n    response = self._exec_jsonrpc(name, *args, **kwargs)\\n  File \\\"/usr/lib/python2.7/dist-packages/ansible/module_utils/connection.py\\\", line 150, in _exec_jsonrpc\\n    out = self.send(data)\\n  File \\\"/usr/lib/python2.7/dist-packages/ansible/module_utils/connection.py\\\", line 199, in send\\n    raise ConnectionError('unable to connect to socket', err=to_text(e, errors='surrogate_then_replace'), exception=traceback.format_exc())\\nansible.module_utils.connection.ConnectionError: unable to connect to socket\\n\"\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-09-24T14:39:06Z",
        "user": "sneuser3",
        "labels": [
            "networking",
            "needs_triage",
            "support:core",
            "bug",
            "traceback",
            "affects_2.9"
        ]
    },
    {
        "number": 75646,
        "title": "String encrypted with ansible-vault encrypt_string will be false if evaluated with `is string`",
        "body": "### Summary\n\nIf I encrypt a string with ansible-vault and tests if it's a string, it will return false. Even though printing it works just fine. It looks like it's not decrypted if it's being evaluated with `is string` or like.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible-vault\n\n### Ansible Version\n\n```console\nSeems to affect multiple versions\r\nMultiple versions tested and affected\r\n\r\nansible 2.10.5\r\nansible-playbook [core 2.11.3]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nTested on Ubuntu and CentOS\n\n### Steps to Reproduce\n\nNote: vault password is `vault`\r\n\r\n```\r\n- name: Test ansible-vault\r\n  hosts: localhost\r\n  connection: local\r\n  gather_facts: false\r\n  vars:\r\n    clear_password: SeCrEtInClEaRvIeW\r\n    encrypted_password: !vault |\r\n          $ANSIBLE_VAULT;1.1;AES256\r\n          38316339343730613936653332373065343765343139643430346231353137363338303465396630\r\n          6330396466376265373831303935623432636532346439330a636438393430313832636231353835\r\n          64333733363362353233643962313730363363393035373239323665336238313461373864363730\r\n          3135613738636132330a623561633730363262666534313638623830306265613437323630366431\r\n          3465\r\n\r\n  tasks:\r\n    - name: \"Print clear_password\"\r\n      debug:\r\n        msg: \"{{ clear_password }}\"\r\n\r\n    - name: \"Print encrypted_password\"\r\n      debug:\r\n        msg: \"{{ encrypted_password }}\"\r\n\r\n    - name: \"Check if clear_password is string\"\r\n      debug:\r\n        msg: \"{{ clear_password is string }}\"\r\n\r\n    - name: \"Check if encrypted_password is string\"\r\n      debug:\r\n        msg: \"{{ encrypted_password is string }}\"\r\n\r\n```\n\n### Expected Results\n\nI expect `Check if encrypted_password is string` to be `true` and not `false`.\n\n### Actual Results\n\n```console\nTASK [Print clear_password] ***************************************************************************************************************************************************************************************\r\ntask path: /tmp/ansible-test/playbook.yaml:16\r\nok: [localhost] => {\r\n    \"msg\": \"SeCrEtInClEaRvIeW\"\r\n}\r\n\r\nTASK [Print encrypted_password] ***********************************************************************************************************************************************************************************\r\ntask path: /tmp/ansible-test/playbook.yaml:20\r\nTrying secret <ansible.parsing.vault.PromptVaultSecret object at 0x7f94c4178890> for vault_id=default\r\nok: [localhost] => {\r\n    \"msg\": \"h1dd3N 53Cr37\"\r\n}\r\n\r\nTASK [Check if clear_password is string] **************************************************************************************************************************************************************************\r\ntask path: /tmp/ansible-test/playbook.yaml:24\r\nok: [localhost] => {\r\n    \"msg\": true\r\n}\r\n\r\nTASK [Check if encrypted_password is string] **********************************************************************************************************************************************************************\r\ntask path: /tmp/ansible-test/playbook.yaml:28\r\nok: [localhost] => {\r\n    \"msg\": false\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ********************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-09-07T10:18:36Z",
        "user": "KvistA-ELS",
        "labels": [
            "easyfix",
            "support:core",
            "bug",
            "P3",
            "affects_2.14",
            "data_tagging"
        ]
    },
    {
        "number": 75632,
        "title": "ansible-galaxy collections outdated argument",
        "body": "### Summary\r\n\r\nIt would be nice either given a requirements.yml file, the currently installed ansible-galaxy collections, or some sort of search argument to check where new versions of collections exist.\r\n\r\nThis could be achieved via different means such as:\r\n\r\n- `ansible-galaxy collections search netbox.netbox`\r\n- `ansible-galaxy collections list --outdated`\r\n- `ansible-galaxy collections -r requirements --outdated`\r\n- `ansible-galaxy collections search netbox.netbox` (user could compare or script out a comparison vs their requirmenets.yml or currently installed collections)\r\n- Some other means not listed\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible-galaxy\r\n\r\n### Additional Information\r\n\r\nI recognize if someone points to a git repo & branch/tag or a compressed file in their requirements.yml this could be tricky, but it could be good enough to skip that entry or just compare what is on ansible-galaxy.\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-09-02T17:34:01Z",
        "user": "ryanmerolle",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 75626,
        "title": "ansible_interface does not report the address for macvlan interfaces",
        "body": "### Summary\n\nAnsible fails to detect the ip address of an macvlan device on linux due to improper use of the ip address show command.\r\n\r\nLines of code related:\r\nhttps://github.com/ansible/ansible/blob/2cbfd1e350cbe1ca195d33306b5a9628667ddda8/lib/ansible/module_utils/facts/network/linux.py#L258-L259\r\n\r\nIt has to be \"ip address show dev home\", \"ip address show <name>\" does not work for all types of interfaces.\r\n\r\nThe attached playbook has to be run multiple times as the network fact are not updated between tasks.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nfacts/network\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.3] \r\n  config file = /srv/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /opt/ansible/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /srv/ansible/collections\r\n  executable location = /opt/ansible/bin/ansible\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nCOLLECTIONS_PATHS(/srv/ansible.cfg) = ['/srv/ansible/collections']\r\nDEFAULT_HOST_LIST(/srv/ansible.cfg) = ['/srv/ansible/hosts']\r\nDEFAULT_ROLES_PATH(/srv/ansible.cfg) = ['/srv/ansible/roles']\n```\n\n\n### OS / Environment\n\ndebian buster\n\n### Steps to Reproduce\n\n```yaml\r\n---\r\n- name: the bug\r\n  hosts:\r\n  - localhost\r\n  tasks:\r\n\r\n  - name: create home interface\r\n    command: \"ip link add link {{ ansible_default_ipv4.interface }} home address 56:61:4f:7c:77:db type macvlan\"\r\n    when: ansible_interfaces and \"home\" not in ansible_interfaces    \r\n\r\n  - name: up interface\r\n    command: \"ip link set up dev home\"\r\n    when: ansible_interfaces and \"home\" in ansible_interfaces and ansible_home.get(\"active\",False) != True\r\n\r\n  - name: debug interface link\r\n    debug:\r\n      var: ansible_home\r\n\r\n  - name: add address to home interface\r\n    command: \"ip address add 10.17.62.100/24 dev home\"\r\n    when: ansible_home and ansible_home.get(\"ipv4\",{}).get(\"address\",\"\") != \"10.17.62.100\"\r\n    ignore_errors: yes # ansible does not know macvlan device addresses\r\n\r\n  - name: interface address\r\n    debug:\r\n      var: ansible_home\r\n\r\n  - name: assert\r\n    assert:\r\n      that: \r\n        - ansible_home and ansible_home.get(\"ipv4\",{}).get(\"address\",\"\") == \"10.17.62.100\"\r\n\r\n  - name: delete home interface\r\n    command: \"ip link delete home\"\r\n    when: ansible_interfaces and \"home\" in ansible_interfaces\r\n```\r\n\r\n\n\n### Expected Results\n\nthe interface address is reported, no assert\n\n### Actual Results\n\n```console\nfatal: [localhost]: FAILED! => {\r\n    \"assertion\": \"ansible_home and ansible_home.get(\\\"ipv4\\\",{}).get(\\\"address\\\",\\\"\\\") == \\\"10.17.62.100\\\"\",\r\n    \"changed\": false,\r\n    \"evaluated_to\": false,\r\n    \"msg\": \"Assertion failed\"\r\n}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-09-02T05:44:18Z",
        "user": "commonism",
        "labels": [
            "support:core",
            "P3",
            "needs_verified",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 75609,
        "title": "git module verifies signatures after the repo has already been updated",
        "body": "### Summary\n\nI would expect that if some changes are not signed, ansible would leave my working copy unchanged to the last verified version.\r\n\r\nInstead, since `verify_commit_sign` is called at the end of all operations, even if it will fail, working copies will have been updated.\r\n\r\nThis may mean that a failed playbook might cause production code to get updated to an untrusted/unverified version. Depending on setups, that may have serious consequences.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ngit\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.10.8\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nANSIBLE_NOCOWS(/home/enrico/dev/transilience/ansible.cfg) = True\n```\n\n\n### OS / Environment\n\nDebian Bullseye\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n   - name: test git\r\n     git:\r\n        repo: https://github.com/spanezz/transilience.git\r\n        dest: /tmp/test\r\n        verify_commit: yes\r\n        version: main\r\n```\r\n\r\nIt will make a checkout. If a checkout is present to an earlier commit in main, it will update it to the last commit in main\n\n### Expected Results\n\nI would expect that if a signature fails to verify, nothing is changed in the filesystem\n\n### Actual Results\n\n```console\nPLAY [localhost] *************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *******************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [test git] **************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"Failed to verify GPG signature of commit/tag \\\"main\\\"\", \"rc\": 1, \"stderr\": \"gpg: Signature made Fri Jul  2 23:30:54 2021 CEST\\ngpg:                using RSA key 4AEE18F83AFDEB23\\ngpg: Can't check signature: No public key\\n\", \"stderr_lines\": [\"gpg: Signature made Fri Jul  2 23:30:54 2021 CEST\", \"gpg:                using RSA key 4AEE18F83AFDEB23\", \"gpg: Can't check signature: No public key\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nPLAY RECAP *******************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n\r\n\r\n\r\nThis error is as expected. The problem is the unexpected side effect on the destination\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-08-31T21:38:09Z",
        "user": "spanezz",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 75579,
        "title": "3 test suite failures discovered while packaging on GNU Guix",
        "body": "### Summary\r\n\r\nHello,\r\n\r\nI've been working toward updating Ansible package in GNU Guix, and encountered the following errors:\r\n\r\n```\r\n=================================== FAILURES ===================================\r\n_____________________________ test_simple_command ______________________________\r\n[gw21] linux -- Python 3.8.2 /gnu/store/f8s95qc6dfhl0r45m70hczw5zip0xjxq-python-wrapper-3.8.2/bin/python\r\ndef test_simple_command():\r\n        \"\"\" Test valid command and its run\"\"\"\r\n        adhoc_cli = AdHocCLI(['/bin/ansible', '-m', 'command', 'localhost', '-a', 'echo \"hi\"'])\r\n        adhoc_cli.parse()\r\n        ret = adhoc_cli.run()\r\n>       assert ret == 0\r\nE       assert 2 == 0\r\nE         +2\r\nE         -0\r\n\r\ntest/units/cli/test_adhoc.py:39: AssertionError\r\n----------------------------- Captured stdout call -----------------------------\r\nlocalhost | FAILED | rc=-1 >>\r\nfailed to find the executable specified /bin/sh. Please verify if the executable exists and re-try.\r\n_____________________________ test_get_text_width ______________________________\r\n[gw15] linux -- Python 3.8.2 /gnu/store/f8s95qc6dfhl0r45m70hczw5zip0xjxq-python-wrapper-3.8.2/bin/python\r\ndef test_get_text_width():\r\n        initialize_locale()\r\n>       assert get_text_width(u'\u30b3\u30f3\u30cb\u30c1\u30cf') == 10\r\n\r\ntest/units/utils/test_display.py:18: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\ntext = '\u30b3\u30f3\u30cb\u30c1\u30cf'\r\n\r\n    def get_text_width(text):\r\n        \"\"\"Function that utilizes ``wcswidth`` or ``wcwidth`` to determine the\r\n        number of columns used to display a text string.\r\n    \r\n        We try first with ``wcswidth``, and fallback to iterating each\r\n        character and using wcwidth individually, falling back to a value of 0\r\n        for non-printable wide characters\r\n    \r\n        On Py2, this depends on ``locale.setlocale(locale.LC_ALL, '')``,\r\n        that in the case of Ansible is done in ``bin/ansible``\r\n        \"\"\"\r\n        if not isinstance(text, text_type):\r\n            raise TypeError('get_text_width requires text, not %s' % type(text))\r\n    \r\n        if _LOCALE_INITIALIZATION_ERR:\r\n            Display().warning(\r\n                'An error occurred while calling ansible.utils.display.initialize_locale '\r\n                '(%s). This may result in incorrectly calculated text widths that can '\r\n                'cause Display to print incorrect line lengths' % _LOCALE_INITIALIZATION_ERR\r\n            )\r\n        elif not _LOCALE_INITIALIZED:\r\n            Display().warning(\r\n                'ansible.utils.display.initialize_locale has not been called, '\r\n                'this may result in incorrectly calculated text widths that can '\r\n                'cause Display to print incorrect line lengths'\r\n            )\r\n    \r\n        try:\r\n            width = _LIBC.wcswidth(text, _MAX_INT)\r\n        except ctypes.ArgumentError:\r\n            width = -1\r\n        if width != -1:\r\n            return width\r\n    \r\n        width = 0\r\n        counter = 0\r\n        for c in text:\r\n            counter += 1\r\n            if c in (u'\\x08', u'\\x7f', u'\\x94', u'\\x1b'):\r\n                # A few characters result in a subtraction of length:\r\n                # BS, DEL, CCH, ESC\r\n                # ESC is slightly different in that it's part of an escape sequence, and\r\n                # while ESC is non printable, it's part of an escape sequence, which results\r\n                # in a single non printable length\r\n                width -= 1\r\n                counter -= 1\r\n                continue\r\n    \r\n            try:\r\n                w = _LIBC.wcwidth(c)\r\n            except ctypes.ArgumentError:\r\n                w = -1\r\n            if w == -1:\r\n                # -1 signifies a non-printable character\r\n                # use 0 here as a best effort\r\n                w = 0\r\n            width += w\r\n    \r\n        if width == 0 and counter and not _LOCALE_INITIALIZED:\r\n>           raise EnvironmentError(\r\n                'ansible.utils.display.initialize_locale has not been called, '\r\n                'and get_text_width could not calculate text width of %r' % text\r\n            )\r\nE           OSError: ansible.utils.display.initialize_locale has not been called, and get_text_width could not calculate text width of '\u30b3\u30f3\u30cb\u30c1\u30cf'\r\n\r\n../ansible-test-e1nci_il/ansible/utils/display.py:138: OSError\r\n----------------------------- Captured stderr call -----------------------------\r\n[WARNING]: An error occurred while calling\r\nansible.utils.display.initialize_locale (unsupported locale setting). This may\r\nresult in incorrectly calculated text widths that can cause Display to print\r\nincorrect line lengths\r\n______________________ test_Display_banner_get_text_width ______________________\r\n[gw14] linux -- Python 3.8.2 /gnu/store/f8s95qc6dfhl0r45m70hczw5zip0xjxq-python-wrapper-3.8.2/bin/python\r\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7fffee72e190>\r\n\r\n    def test_Display_banner_get_text_width(monkeypatch):\r\n        initialize_locale()\r\n        display = Display()\r\n        display_mock = MagicMock()\r\n        monkeypatch.setattr(display, 'display', display_mock)\r\n    \r\n        display.banner(u'\ud83d\ude80\ud83d\udc2e', color=False, cows=False)\r\n        args, kwargs = display_mock.call_args\r\n        msg = args[0]\r\n        stars = u' %s' % (75 * u'*')\r\n>       assert msg.endswith(stars)\r\nE       AssertionError: assert False\r\nE        +  where False = <built-in method endswith of str object at 0x7fffee794c30>(' ***************************************************************************')\r\nE        +    where <built-in method endswith of str object at 0x7fffee794c30> = '\\n\ud83d\ude80\ud83d\udc2e *****************************************************************************'.endswith\r\n\r\ntest/units/utils/test_display.py:52: AssertionError\r\n- generated xml file: /tmp/guix-build-python-ansible-core-2.11.4.drv-0/ansible-core-2.11.4/test/results/junit/python3.8-units.xml -\r\n============================= slowest 25 durations =============================\r\n3.01s call     module_utils/facts/test_timeout.py::test_implicit_file_overridden_succeeds\r\n2.02s call     executor/test_task_executor.py::TestTaskExecutor::test_task_executor_run_loop\r\n2.01s call     module_utils/facts/test_timeout.py::test_explicit_succeeds\r\n2.00s call     module_utils/facts/test_timeout.py::test_implicit_file_overridden_timesout\r\n2.00s call     module_utils/facts/test_timeout.py::test_explicit_timeout\r\n1.93s call     utils/display/test_logger.py::test_logger\r\n1.60s call     utils/collection_loader/test_collection_loader.py::test_bogus_imports\r\n1.59s call     utils/collection_loader/test_collection_loader.py::test_import_from_collection\r\n1.56s call     utils/collection_loader/test_collection_loader.py::test_collection_get_data\r\n1.52s call     utils/collection_loader/test_collection_loader.py::test_collpkg_loader_load_module\r\n1.09s call     parsing/vault/test_vault.py::TestVaultLibPyCrypto::test_encrypt_decrypt_aes256_multiple_secrets_all_wrong\r\n1.01s call     module_utils/test_api.py::TestRetryWithDelaysAndCondition::test_retry_exception\r\n1.01s call     galaxy/test_api.py::test_wait_import_task_timeout[https://galaxy.server.com/api-v2-Token-token_ins0-1234-https://galaxy.server.com/api/v2/collection-imports/1234/]\r\n1.01s call     module_utils/facts/test_timeout.py::test_exception_not_caught_by_called_code\r\n1.01s call     galaxy/test_api.py::test_wait_import_task_timeout[https://galaxy.server.com/api/automation-hub-v3-Bearer-token_ins1-1234-https://galaxy.server.com/api/automation-hub/v3/imports/collections/1234/]\r\n1.01s call     module_utils/facts/test_timeout.py::test_implicit_file_default_timesout\r\n1.01s call     module_utils/facts/test_timeout.py::test_implicit_file_default_succeeds\r\n1.00s call     module_utils/facts/test_timeout.py::test_timeout_raises_timeout_integration_test[stdin0]\r\n1.00s call     module_utils/facts/test_timeout.py::test_timeout_raises_timeout\r\n1.00s call     module_utils/test_api.py::TestRateLimit::test_ratelimit\r\n0.76s call     parsing/vault/test_vault.py::TestVaultLibPyCrypto::test_encrypt_decrypt_aes256_multiple_secrets_one_valid\r\n0.75s call     parsing/vault/test_vault.py::TestVaultCipherAes256PyCrypto::test_create_key_known_pycrypto\r\n0.72s call     parsing/vault/test_vault.py::TestVaultCipherAes256PyCrypto::test_create_key_known_cryptography\r\n0.71s call     parsing/vault/test_vault.py::TestVaultCipherAes256::test_create_key_known_cryptography\r\n0.71s call     parsing/vault/test_vault.py::TestVaultLibPyCrypto::test_encrypt_decrypt_aes256_existing_vault\r\n=========================== short test summary info ============================\r\nSKIPPED [2] test/units/module_utils/basic/test_log.py:113: python systemd bindings not installed\r\nSKIPPED [5] test/units/module_utils/basic/test_log.py:130: python systemd bindings not installed\r\nSKIPPED [1] test/units/module_utils/basic/test_imports.py:84: literal_eval is available in every version of Python3\r\nSKIPPED [5] test/units/module_utils/basic/test_log.py:38: python systemd bindings not installed\r\nSKIPPED [1] test/units/module_utils/basic/test_log.py:139: python systemd bindings not installed\r\nSKIPPED [1] test/units/module_utils/facts/test_facts.py:46: This platform (DragonFly) does not have a fact_class.\r\nSKIPPED [1] test/units/module_utils/facts/test_facts.py:54: This platform (DragonFly) does not have a fact_class.\r\nSKIPPED [3] test/units/module_utils/facts/test_facts.py:64: This test class needs to be updated to specify collector_class\r\nSKIPPED [2] test/units/parsing/vault/test_vault.py:841: This test is not ready yet\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:174: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:68: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:482: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:120: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:42: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:423: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/plugins/strategy/test_strategy.py:217: Temporarily disabled due to fragile tests that need rewritten\r\nSKIPPED [1] test/units/vars/test_module_response_deepcopy.py:40: No current support for this situation\r\nSKIPPED [1] test/units/utils/test_display.py:37: Fallback only happens reliably on py2\r\nSKIPPED [1] test/units/utils/test_display.py:55: Fallback only happens reliably on py2\r\nFAILED test/units/cli/test_adhoc.py::test_simple_command\r\nFAILED test/units/utils/test_display.py::test_get_text_width\r\nFAILED test/units/utils/test_display.py::test_Display_banner_get_text_width\r\n================= 3 failed, 3480 passed, 31 skipped in 27.30s ==================\r\nERROR: Command \"pytest --boxed -r a -n auto --color no -p no:cacheprovider -c /gnu/store/zv47p8m96v6i1aaiszgfqkzmiy8i3s44-python-ansible-core-2.11.4/lib/python3.8/site-packages/ansible_test/_data/pytest.ini --junit-xml /tmp/guix-build-python-ansible-core-2.11.4.drv-0/ansible-core-2.11.4/test/results/junit/python3.8-units.xml --durations=25 --strict-markers -v test/units/ansible_test/ci/test_azp.py test/units/ansible_test/ci/test_shippable.py test/units/ansible_test/test_docker_util.py test/units/cli/arguments/test_optparse_helpers.py test/units/cli/galaxy/test_collection_extract_tar.py test/units/cli/galaxy/test_display_collection.py test/units/cli/galaxy/test_display_header.py test/units/cli/galaxy/test_display_role.py test/units/cli/galaxy/test_execute_list.py test/units/cli/galaxy/test_execute_list_collection.py test/units/cli/galaxy/test_get_collection_widths.py test/units/cli/test_adhoc.py test/units/cli/test_cli.py test/units/cli/test_console.py test/units/cli/test_doc.py test/units/cli/test_galaxy.py test/units/cli/test_playbook.py test/units/cli/test_vault.py test/units/config/manager/test_find_ini_config_file.py test/units/config/test_data.py test/units/config/test_manager.py test/units/errors/test_errors.py test/units/executor/module_common/test_modify_module.py test/units/executor/module_common/test_module_common.py test/units/executor/module_common/test_recursive_finder.py test/units/executor/test_interpreter_discovery.py test/units/executor/test_play_iterator.py test/units/executor/test_playbook_executor.py test/units/executor/test_task_executor.py test/units/executor/test_task_queue_manager_callbacks.py test/units/executor/test_task_result.py test/units/galaxy/test_api.py test/units/galaxy/test_collection.py test/units/galaxy/test_collection_install.py test/units/galaxy/test_role_requirements.py test/units/galaxy/test_token.py test/units/galaxy/test_user_agent.py test/units/inventory/test_group.py test/units/inventory/test_host.py test/units/module_utils/basic/test__log_invocation.py test/units/module_utils/basic/test__symbolic_mode_to_octal.py test/units/module_utils/basic/test_argument_spec.py test/units/module_utils/basic/test_atomic_move.py test/units/module_utils/basic/test_command_nonexisting.py test/units/module_utils/basic/test_deprecate_warn.py test/units/module_utils/basic/test_dict_converters.py test/units/module_utils/basic/test_exit_json.py test/units/module_utils/basic/test_filesystem.py test/units/module_utils/basic/test_get_file_attributes.py test/units/module_utils/basic/test_get_module_path.py test/units/module_utils/basic/test_heuristic_log_sanitize.py test/units/module_utils/basic/test_imports.py test/units/module_utils/basic/test_log.py test/units/module_utils/basic/test_no_log.py test/units/module_utils/basic/test_platform_distribution.py test/units/module_utils/basic/test_run_command.py test/units/module_utils/basic/test_safe_eval.py test/units/module_utils/basic/test_sanitize_keys.py test/units/module_utils/basic/test_selinux.py test/units/module_utils/basic/test_set_cwd.py test/units/module_utils/basic/test_set_mode_if_different.py test/units/module_utils/basic/test_tmpdir.py test/units/module_utils/common/arg_spec/test_aliases.py test/units/module_utils/common/arg_spec/test_module_validate.py test/units/module_utils/common/arg_spec/test_sub_spec.py test/units/module_utils/common/arg_spec/test_validate_invalid.py test/units/module_utils/common/arg_spec/test_validate_valid.py test/units/module_utils/common/parameters/test_check_arguments.py test/units/module_utils/common/parameters/test_handle_aliases.py test/units/module_utils/common/parameters/test_list_deprecations.py test/units/module_utils/common/parameters/test_list_no_log_values.py test/units/module_utils/common/process/test_get_bin_path.py test/units/module_utils/common/test_collections.py test/units/module_utils/common/test_dict_transformations.py test/units/module_utils/common/test_network.py test/units/module_utils/common/test_removed.py test/units/module_utils/common/test_sys_info.py test/units/module_utils/common/test_utils.py test/units/module_utils/common/text/converters/test_container_to_bytes.py test/units/module_utils/common/text/converters/test_container_to_text.py test/units/module_utils/common/text/converters/test_json_encode_fallback.py test/units/module_utils/common/text/converters/test_jsonify.py test/units/module_utils/common/text/converters/test_to_str.py test/units/module_utils/common/text/formatters/test_bytes_to_human.py test/units/module_utils/common/text/formatters/test_human_to_bytes.py test/units/module_utils/common/text/formatters/test_lenient_lowercase.py test/units/module_utils/common/validation/test_check_mutually_exclusive.py test/units/module_utils/common/validation/test_check_required_arguments.py test/units/module_utils/common/validation/test_check_required_together.py test/units/module_utils/common/validation/test_check_type_bits.py test/units/module_utils/common/validation/test_check_type_bool.py test/units/module_utils/common/validation/test_check_type_bytes.py test/units/module_utils/common/validation/test_check_type_dict.py test/units/module_utils/common/validation/test_check_type_float.py test/units/module_utils/common/validation/test_check_type_int.py test/units/module_utils/common/validation/test_check_type_jsonarg.py test/units/module_utils/common/validation/test_check_type_list.py test/units/module_utils/common/validation/test_check_type_path.py test/units/module_utils/common/validation/test_check_type_raw.py test/units/module_utils/common/validation/test_check_type_str.py test/units/module_utils/common/validation/test_count_terms.py test/units/module_utils/common/warnings/test_deprecate.py test/units/module_utils/common/warnings/test_warn.py test/units/module_utils/facts/hardware/test_linux.py test/units/module_utils/facts/hardware/test_linux_get_cpu_info.py test/units/module_utils/facts/hardware/test_sunos_get_uptime_facts.py test/units/module_utils/facts/network/test_fc_wwn.py test/units/module_utils/facts/network/test_generic_bsd.py test/units/module_utils/facts/network/test_iscsi_get_initiator.py test/units/module_utils/facts/other/test_facter.py test/units/module_utils/facts/other/test_ohai.py test/units/module_utils/facts/system/distribution/test_distribution_sles4sap.py test/units/module_utils/facts/system/distribution/test_distribution_version.py test/units/module_utils/facts/system/distribution/test_parse_distribution_file_ClearLinux.py test/units/module_utils/facts/system/distribution/test_parse_distribution_file_Slackware.py test/units/module_utils/facts/system/test_cmdline.py test/units/module_utils/facts/system/test_lsb.py test/units/module_utils/facts/system/test_user.py test/units/module_utils/facts/test_ansible_collector.py test/units/module_utils/facts/test_collector.py test/units/module_utils/facts/test_collectors.py test/units/module_utils/facts/test_date_time.py test/units/module_utils/facts/test_facts.py test/units/module_utils/facts/test_sysctl.py test/units/module_utils/facts/test_timeout.py test/units/module_utils/facts/test_utils.py test/units/module_utils/facts/virtual/test_linux.py test/units/module_utils/json_utils/test_filter_non_json_lines.py test/units/module_utils/parsing/test_convert_bool.py test/units/module_utils/test_api.py test/units/module_utils/test_distro.py test/units/module_utils/urls/test_RedirectHandlerFactory.py test/units/module_utils/urls/test_Request.py test/units/module_utils/urls/test_RequestWithMethod.py test/units/module_utils/urls/test_channel_binding.py test/units/module_utils/urls/test_fetch_url.py test/units/module_utils/urls/test_generic_urlparse.py test/units/module_utils/urls/test_prepare_multipart.py test/units/module_utils/urls/test_urls.py test/units/modules/test_apt.py test/units/modules/test_async_wrapper.py test/units/modules/test_copy.py test/units/modules/test_iptables.py test/units/modules/test_known_hosts.py test/units/modules/test_pip.py test/units/modules/test_service_facts.py test/units/modules/test_systemd.py test/units/modules/test_unarchive.py test/units/modules/test_yum.py test/units/parsing/test_ajson.py test/units/parsing/test_dataloader.py test/units/parsing/test_mod_args.py test/units/parsing/test_splitter.py test/units/parsing/test_unquote.py test/units/parsing/utils/test_addresses.py test/units/parsing/utils/test_jsonify.py test/units/parsing/utils/test_yaml.py test/units/parsing/vault/test_vault.py test/units/parsing/vault/test_vault_editor.py test/units/parsing/yaml/test_constructor.py test/units/parsing/yaml/test_dumper.py test/units/parsing/yaml/test_loader.py test/units/parsing/yaml/test_objects.py test/units/playbook/role/test_include_role.py test/units/playbook/role/test_role.py test/units/playbook/test_attribute.py test/units/playbook/test_base.py test/units/playbook/test_block.py test/units/playbook/test_collectionsearch.py test/units/playbook/test_conditional.py test/units/playbook/test_helpers.py test/units/playbook/test_included_file.py test/units/playbook/test_play.py test/units/playbook/test_play_context.py test/units/playbook/test_playbook.py test/units/playbook/test_taggable.py test/units/playbook/test_task.py test/units/plugins/action/test_action.py test/units/plugins/action/test_gather_facts.py test/units/plugins/action/test_pause.py test/units/plugins/action/test_raw.py test/units/plugins/become/test_su.py test/units/plugins/become/test_sudo.py test/units/plugins/cache/test_cache.py test/units/plugins/callback/test_callback.py test/units/plugins/connection/test_connection.py test/units/plugins/connection/test_local.py test/units/plugins/connection/test_paramiko.py test/units/plugins/connection/test_psrp.py test/units/plugins/connection/test_ssh.py test/units/plugins/connection/test_winrm.py test/units/plugins/filter/test_core.py test/units/plugins/filter/test_mathstuff.py test/units/plugins/inventory/test_constructed.py test/units/plugins/inventory/test_inventory.py test/units/plugins/inventory/test_script.py test/units/plugins/lookup/test_env.py test/units/plugins/lookup/test_ini.py test/units/plugins/lookup/test_password.py test/units/plugins/lookup/test_url.py test/units/plugins/shell/test_cmd.py test/units/plugins/shell/test_powershell.py test/units/plugins/strategy/test_linear.py test/units/plugins/strategy/test_strategy.py test/units/plugins/test_plugins.py test/units/regex/test_invalid_var_names.py test/units/template/test_native_concat.py test/units/template/test_safe_eval.py test/units/template/test_templar.py test/units/template/test_template_utilities.py test/units/template/test_vars.py test/units/test_constants.py test/units/test_context.py test/units/utils/collection_loader/test_collection_loader.py test/units/utils/display/test_display.py test/units/utils/display/test_logger.py test/units/utils/display/test_warning.py test/units/utils/test_cleanup_tmp_file.py test/units/utils/test_context_objects.py test/units/utils/test_display.py test/units/utils/test_encrypt.py test/units/utils/test_helpers.py test/units/utils/test_isidentifier.py test/units/utils/test_plugin_docs.py test/units/utils/test_shlex.py test/units/utils/test_unsafe_proxy.py test/units/utils/test_vars.py test/units/utils/test_version.py test/units/vars/test_module_response_deepcopy.py test/units/vars/test_variable_manager.py\" returned exit status 1.\r\ncommand \"ansible-test\" \"units\" \"-v\" failed with status 1\r\n```\r\n I suspect these failures are related to the non-FHS file layout of Guix, for example the absence of /bin/sh (commands must be found from PATH).\r\n\r\nAttached is the full build log.\r\n[python-ansible-core-2.11.4.drv.txt](https://github.com/ansible/ansible/files/7062496/python-ansible-core-2.11.4.drv.txt)\r\n\r\nThe direct dependencies used for the above results are:\r\n\r\n```\r\n$ ./pre-inst-env guix show python-ansible-core\r\nname: python-ansible-core\r\nversion: 2.11.4\r\noutputs: out\r\nsystems: x86_64-linux i686-linux\r\ndependencies: libselinux@3.0 openssh@8.6p1 openssl@1.1.1j python-botocore@1.19.22\r\n+ python-cryptography@3.3.1 python-jinja2@2.11.2 python-mock@3.0.5 python-ncclient@0.6.12\r\n+ python-ntlm-auth@1.4.0 python-packaging@20.0 python-passlib@1.7.4 python-pexpect@4.8.0\r\n+ python-pycrypto@2.6.1 python-pygments@2.7.3 python-pyspnego@0.1.6 python-pytest-forked@1.3.0\r\n+ python-pytest-mock@3.6.1 python-pytest-xdist@2.3.0 python-pytest@6.2.4 python-pytz@2021.1\r\n+ python-pywinrm@0.4.1 python-pyyaml@5.4.1 python-requests_ntlm@1.1.0 python-resolvelib@0.5.4\r\nlocation: gnu/packages/admin.scm:2469:2\r\n[...]\r\n```\r\n\r\nAnd the full transitive dependencies are:\r\n```\r\n$ ./pre-inst-env guix refresh --list-transitive python-ansible-core\r\npython-ansible-core@2.11.4 depends on the following 211 packages: libedit@20191231-3.1 linux-pam@1.5.1 python-unidecode@1.1.1 python-pyaml@18.11.0 python-cliapp@1.20180812.1 python-markdown@3.3.4 python-coverage-test-runner@1.15 python-pep8@1.7.0 python-ttystatus@0.38 cmdtest@0.32-14-gcdfe14e libice@1.0.10 libsm@1.2.3 libxt@1.2.0 libxmu@1.1.3 xauth@1.1 openssh@8.6p1 python-pycrypto@2.6.1 python-execnet@1.9.0 python-pytest-bootstrap@6.2.4 python-toml@0.10.2 python-iniconfig@1.1.1 python-py@1.10.0 python-pytest@6.2.4 python-pytest-forked@1.3.0 python-pytest-xdist@2.3.0 tcsh@6.22.02 icu4c@66.1 boost@1.72.0 bash-minimal@5.0.16 libgc@8.0.4 gmp@6.2.0 guile@3.0.2 swig@4.0.1 libsepol@3.0 pcre@8.44 libselinux@3.0 python-pytest-cov@2.8.1 python-dateutil@2.8.1 python-jmespath@0.9.4 python-botocore@1.19.22 python-markupsafe@1.1.1 python-jinja2@2.11.2 python-bcrypt@3.2.0 python-pyasn1@0.4.8 libsodium@1.0.18 python-pynacl@1.4.0 python-paramiko@2.7.2 python-ncclient@0.6.12 python-py-bcrypt@0.4 python-passlib@1.7.4 psutils@17 gs-fonts@8.11 autoconf@2.69 libltdl@2.4.6 libtool@2.4.6 jbig2dec@0.18 autoconf-wrapper@2.69 automake@1.16.2 libpaper@1.1.24 cmake-bootstrap@3.16.5 texinfo@6.7 nasm@2.14.02 libjpeg-turbo@2.0.5 libtiff@4.1.0 ghostscript@9.52 groff@1.22.4 groff-minimal@1.22.4 less@590 libpipeline@1.5.3 man-db@2.9.4 python-ptyprocess@0.5.2 python-pexpect@4.8.0 python-pygments@2.7.3 python-async-generator@1.10 python-pytest-asyncio@0.10.0 python-pytest-mock@3.6.1 python-parameterized@0.7.4 which@2.21 python-k5test@0.9.2 python-decorator@4.3.0 python-gssapi@1.6.12 python-ruamel.yaml@0.15.83 python-pyspnego@0.1.6 libyaml@0.2.5 python-pyyaml@5.4.1 python-coverage@5.2.1 python-xmltodict@0.12.0 help2man@1.47.13 bison@3.5.3 flex@2.6.4 m4@1.4.18 bison@3.5.3 mit-krb5@1.18 python-kerberos@1.3.0 python-pywinrm@0.4.1 python-ntlm-auth@1.4.0 python-pytest-runner@5.2 python-chardet@3.0.4 python-certifi@2020.12.5 libfaketime@0.9.8 python-flaky@3.5.3 python-cryptography-vectors@3.3.1 python-pytz@2021.1 python-asn1crypto@1.4.0 python-pycparser@2.20 python-cffi@1.14.4 python-idna@2.10 python-iso8601@0.1.13 python-cryptography@3.3.1 python-pyopenssl@20.0.0 python-pysocks@1.7.1 python-urllib3@1.26.2 python-requests@2.25.0 python-requests_ntlm@1.1.0 python-lark-parser@0.9.0 python-commentjson@0.9.0 python-pretend@1.0.9 python-pyparsing@2.4.6 python-packaging@20.0 python-appdirs@1.4.3 python-distlib@0.3.0 python-filelock@3.0.12 python-sortedcontainers@2.1.0 python-hypothesis@5.4.1 python-nose@1.3.7 python-six@1.14.0 python-mock@3.0.5 python-pytest-bootstrap@5.3.5 python-lxml@4.4.2 python-elementpath@1.4.0 python-xmlschema@1.1.2 python-atomicwrites@1.3.0 python-attrs-bootstrap@19.3.0 python-more-itertools@8.2.0 python-packaging-bootstrap@20.0 python-pluggy@0.13.1 python-setuptools-scm@3.4.3 python-py@1.8.1 python-six-bootstrap@1.14.0 gdbm@1.18.1 sqlite@3.31.1 libxrender@0.9.10 libxft@2.3.3 gperf@3.1 gzip@1.10 bzip2@1.0.8 unzip@6.0 font-dejavu@2.37 libpng@1.6.37 freetype@2.10.4 tar@1.32 net-base@5.3 util-linux@2.35.1 fontconfig@2.13.1 tcl@8.6.10 xtrans@1.4.0 xcb-proto@1.14 libunistring@0.9.10 gettext-minimal@0.20.1 libgpg-error@1.37 libgcrypt@1.8.5 libxml2@2.9.10 readline@8.0.4 ncurses@6.2 bash@5.0.16 tzdata@2019c expat@2.2.9 libffi@3.3 perl@5.30.2 openssl@1.1.1j python-minimal@3.8.2 python-minimal-wrapper@3.8.2 zlib@1.2.11 xz@5.2.4 libxslt@1.1.34 libpthread-stubs@0.4 libxau@1.0.9 libbsd@0.10.0 libxdmcp@1.1.3 libxcb@1.14 libx11@1.6.10 pkg-config@0.29.2 util-macros@1.19.2 xorgproto@2019.2 libxext@1.3.4 tk@8.6.10 python@3.8.2 python-wrapper@3.8.2 python-wcwidth@0.1.8 python-pytest@5.3.5 python-resolvelib@0.5.4 tar@1.32 gzip@1.10 bzip2@1.0.8 xz@5.2.4 file@5.38 diffutils@3.7 patch@2.7.6 findutils@4.7.0 gawk@5.0.1 sed@4.8 grep@3.4 coreutils@8.32 make@4.3 guile@3.0.2 bash-minimal@5.0.16 ld-wrapper@0 binutils@2.34 gcc@7.5.0 glibc@2.31 glibc-utf8-locales@2.31\r\n```\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ntests\r\n\r\n### Ansible Version\r\n\r\n```console\r\n2.11.4 (unbuilt)\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nN/A\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nGNU Guix\r\n\r\n### Steps to Reproduce\r\n\r\nI'm not sure (outside of running in the same reproducible environment, which Guix makes easy).  I'm not very good at reading the results from the Azure Pipelines CI, so perhaps it's already failing the same?\r\n\r\n\r\n### Expected Results\r\n\r\nAll the test should pass.\r\n\r\n### Actual Results\r\n\r\n```console\r\nResults already provided and discuss above.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-08-26T20:24:47Z",
        "user": "Apteryks",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.11"
        ]
    },
    {
        "number": 75456,
        "title": "role argspec validation doesn't run unless `tasks_from` entrypoint matches exactly",
        "body": "### Summary\r\n\r\nA role with an argspec that defines an entrypoint like `my_entrypoint` has `tasks/my_entrypoint.yml`.\r\n\r\nThe role can successfully be called with any of the following:\r\n\r\n```yaml\r\ntasks_from: my_entrypoint\r\ntasks_from: my_entrypoint.yml\r\ntasks_from: /home/user/ansible/collections/ansible_collections/ns/cn/roles/my_role/tasks/my_entrypoint.yml\r\n```\r\n\r\nBut only the first one will trigger argspec validation; the others will execute without validation.\r\n\r\n---\r\n\r\nAn example that helped me find this, is a role with OS/Platform-based entrypoints, using `with_first_found`:\r\n\r\n```yaml\r\n- name: \"Peform OS-specific setup\"\r\n  include_role:\r\n    name: '{{ ansible_role_name }}'\r\n    tasks_from: '{{ item }}'\r\n  with_first_found:\r\n    - '{{ ansible_distribution }}.yml'\r\n    - '{{ ansible_os_family }}.yml'\r\n    - 'Linux.yml'\r\n```\r\n\r\nAs a workaround (which may be worth documenting):\r\n\r\n```yaml\r\n- name: \"Peform OS-specific setup\"\r\n  include_role:\r\n    name: '{{ ansible_role_name }}'\r\n    tasks_from: '{{ item | basename | splitext | first }}'\r\n  with_first_found:\r\n    - '{{ ansible_distribution }}.yml'\r\n    - '{{ ansible_os_family }}.yml'\r\n    - 'Linux.yml'\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlib/ansible/playbook/role/__init__.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.11.3]\r\n  config file = None\r\n  configured module search path = ['/home/briantist/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/briantist/.a211/lib/python3.6/site-packages/ansible\r\n  ansible collection location = /home/briantist/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/briantist/.a211/bin/ansible\r\n  python version = 3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nDEFAULT_FORKS(env: ANSIBLE_FORKS) = 30\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 18.04 (WSL2)\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nsee description\r\n\r\n### Expected Results\r\n\r\nValidation runs based on the _tasks file_ being executed, rather than the text passed into `tasks_from`.\r\n\r\n### Actual Results\r\n\r\n```console\r\nargsspec validation doesn't run\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-08-10T17:24:39Z",
        "user": "briantist",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 75408,
        "title": "Ansible hangs indefinitely due to critical design flaw when 3rd party library in 3rd party plugin uses threads",
        "body": "### Summary\r\n\r\nAnsible hangs indefinitely due to known critical design flaw greatly described and analysed in https://github.com/ansible/ansible/issues/59642. Unfortunately, as many other bugs, it was closed without ability to comment and left unresolved hitting other people later.\r\n\r\nIn my case the issue manifests with a Python `crypt` module loaded by the `when` clause:\r\n\r\n```\r\n#93 Frame 0x560ee4d1b888, for file /usr/lib/python3.6/site-packages/ansible/plugins/loader.py, line 525, in _load_module_source (self=<Jinja2Loader(class_name='FilterModule', base_class=None, package='ansible.plugins.filter', subdir='filter_plugins', aliases={}, config=['/opt/app-root/src/.ansible/plugins/filter', '/usr/share/ansible/plugins/filter'], _extra_dirs=['/usr/share/my-playbooks/ansible/filter_plugins'], _module_cache={'/usr/share/my-playbooks/ansible/filter_plugins/address.py': <module at remote 0x7fa725ba64a8>}, _paths=['/usr/share/my-playbooks/ansible/filter_plugins', '/opt/app-root/src/.ansible/plugins/filter', '/usr/share/ansible/plugins/filter', '/usr/lib/python3.6/site-packages/ansible/plugins/filter', '/usr/lib/python3.6/site-packages/ansible/plugins/filter/__pycache__'], _plugin_path_cache={}, _searched_paths=set(), package_path='/usr/lib/python3.6/site-packages/ansible/plugins/filter') at remote 0x7fa72a6a6198>, name='8763610137784027770_core', path='/usr/lib/python3.6/site-packages/ansible/plugi...(truncated)\r\n#97 Frame 0x560ee48b0ac8, for file /usr/lib/python3.6/site-packages/ansible/plugins/loader.py, line 670, in all (self=<Jinja2Loader(class_name='FilterModule', base_class=None, package='ansible.plugins.filter', subdir='filter_plugins', aliases={}, config=['/opt/app-root/src/.ansible/plugins/filter', '/usr/share/ansible/plugins/filter'], _extra_dirs=['/usr/share/my-playbooks/ansible/filter_plugins'], _module_cache={'/usr/share/my-playbooks/ansible/filter_plugins/address.py': <module at remote 0x7fa725ba64a8>}, _paths=['/usr/share/my-playbooks/ansible/filter_plugins', '/opt/app-root/src/.ansible/plugins/filter', '/usr/share/ansible/plugins/filter', '/usr/lib/python3.6/site-packages/ansible/plugins/filter', '/usr/lib/python3.6/site-packages/ansible/plugins/filter/__pycache__'], _plugin_path_cache={}, _searched_paths=set(), package_path='/usr/lib/python3.6/site-packages/ansible/plugins/filter') at remote 0x7fa72a6a6198>, args=(), kwargs={}, dedupe=False, path_only=False, class_only=False, all_matches=['/usr/share/softi-a...(truncated)\r\n#100 Frame 0x7fa725b9be48, for file /usr/lib/python3.6/site-packages/ansible/plugins/loader.py, line 754, in <listcomp> (.0=<generator at remote 0x7fa725ba7048>, p=<FilterModule(_original_path='/usr/share/my-playbooks/ansible/filter_plugins/address.py', _load_name='address') at remote 0x7fa725c049b0>)\r\n```\r\n\r\nThe issue seems to be fixed by a foolish pre-loading of the `crypt` module in `MT` (`/usr/lib/python3.6/site-packages/ansible/plugins/strategy/_init_.py` file). This \"patch\", like the original https://github.com/ansible/ansible/pull/72412/files looks like shooting blind to me and does not really address the original problem baked deep into the way Ansible runs playbooks.\r\n\r\nDetailed analyses:\r\n1. Main Thread `MT` starts Result Thread `RT` at the end of a playbook.\r\n2. `RT` unlinks any of the shared libraries and allocates a mutex to update an array of linked libs. This normally happens during thread cleanup process and the control may be returned to the `MT`.\r\n3. When the mutex is allocated, `MT` forks a process `FP` to execute next playbook. Mutex's information is copied to the new process from `MT`, including information about lock being held by `RT`.\r\n4. Mutex is released by `RT` cleanup handler and the thread is removed.\r\n5. `FP` loads a new file (in our case it is `crypt` Python module required by Ansible's `when` clause, nut may be any in many other places of the Ansible code or plugins)\r\n6. `FP` tries to update the array of linked libs, but cannot do this as it discovers the mutex is being held by `RT`. The mutex is not released in `FP`, as it was copied from `MT` locked, just before it was released. As the information in the new process `FP` is a mere copy, it is never updated and the process hangs forever.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ncore\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.9.14\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/opt/app-root/src/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Dec  5 2019, 15:45:45) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nAny\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAny (RHEL8 in my case)\r\n\r\n### Steps to Reproduce\r\n\r\nRun many Ansible playbooks under heavy load. In our case it is tricky and is difficult to reproduce, but as analysed in the bug description, it can happen always.\r\n\r\n### Expected Results\r\n\r\nNo hang :)\r\n\r\n### Actual Results\r\n\r\n```console\r\nPlaybook hangs indefinitely on a mutex.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [ ] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-08-05T06:44:21Z",
        "user": "gsikorski",
        "labels": [
            "support:core",
            "bug",
            "affects_2.16",
            "affects_2.17"
        ]
    },
    {
        "number": 75377,
        "title": "list type for output key=backup_file with ansible.builtin.copy",
        "body": "### Summary\n\nWhen `src` is a _directory_ and `backup` is _true_, `backup_files` could return a list of files that were changed/backed up.\r\nCurrently `backup_files` is only present when `src` is a _file_ and is of type _string_.\n\n### Issue Type\n\nFeature Idea\n\n### Component Name\n\ncopy\n\n### Additional Information\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-08-01T18:40:02Z",
        "user": "dgcampea",
        "labels": [
            "module",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 75325,
        "title": "module user doesn't respect \"local\" constraint when updating groups",
        "body": "### Summary\r\n\r\nWhen using the `user` module, local constraint is not respected for the groups of an exisiting user.\r\n\r\nIf the user already exists, the module will try to add it to non local groups, eventhough local is set to true.\r\n\r\nThe problem seems to be that the function `modify_user_usermod`, which uses `grp.getgrall()`, returns all the groups wether they are local or not.\r\n\r\nThe problem is similar to the one in issue https://github.com/ansible/ansible/issues/49694\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nuser\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.11.3] \r\n  config file = /home/user/documents/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/documents/venv/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/user/documents/ansible/collections\r\n  executable location = /home/user/documents/venv/bin/ansible\r\n  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nCOLLECTIONS_PATHS(/home/user/documents/ansible/ansible.cfg) = ['/home/user/documents/ansible/collections']\r\nDEFAULT_HOST_LIST(/home/user/documents/ansible/ansible.cfg) = ['/home/user/documents/ansible/inventories/gitlab/hosts.yml', '/home/user/documents/ansible/inventories/streaming/hosts.yml', '/home/user/documents/terraforge/compiled/priva1/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/priva2/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/privb1/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/privs1/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/prods1/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/prod1/ansible/ansible_inventory.yaml', '/home/user/documents/terraforge/compiled/prod2/ansible/ansible_inventory.yaml']\r\nDEFAULT_MANAGED_STR(/home/user/documents/ansible/ansible.cfg) = Ansible-managed. Any manual change will be lost.\r\nDEFAULT_ROLES_PATH(/home/user/documents/ansible/ansible.cfg) = ['/home/user/documents/ansible/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(/home/user/documents/ansible/ansible.cfg) = /home/user/.config/struktur/ansible_credentials\r\nHOST_KEY_CHECKING(/home/user/documents/ansible/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/user/documents/ansible/ansible.cfg) = auto_silent\r\nRETRY_FILES_ENABLED(/home/user/documents/ansible/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\ndebian 5.10\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- user:\r\n    name: \"username\"\r\n    group: \"username\"\r\n    groups:\r\n      - localgroup\r\n    local: true\r\n- user:\r\n    name: \"username\"\r\n    group: \"username\"\r\n    groups:\r\n      - localgroup\r\n    local: true\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nmodule successes without trying to add non local groups\r\n\r\n### Actual Results\r\n\r\n```console\r\n\"msg\": \"Group ldapgroup does not exist.\\n\"\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-07-26T15:12:25Z",
        "user": "aguilbau",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 75310,
        "title": "check_mode_markers not working when check_mode set via variable",
        "body": "### Summary\r\n\r\nI love the [`check_mode_markers` support](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/default_callback.html#parameter-check_mode_markers) of the `default` output callback plugin, which I only recently discovered.\r\n\r\nHowever, I find that it does not work correctly when setting `check_mode` at task level via a variable (e.g. `check_mode: \"{{ check_mode_var }}\"`). In that case, the task is ALWAYS marked as `[CHECK MODE]`, even when `check_mode_var` evaluates to `no`.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.default\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.10.11\r\n  config file = /home/ansible/ansible.cfg\r\n  configured module search path = ['/home/ansible/library']\r\n  ansible python module location = /usr/local/share/venv_projects/lib64/python3.6/site-packages/ansible\r\n  executable location = /usr/local/share/venv_projects/bin/ansible\r\n  python version = 3.6.8 (default, Nov 16 2020, 16:55:22) [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\nRETRY_FILES_ENABLED(/home/ansible/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAnsible is running on CentOS 7\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n\r\n- hosts: localhost\r\n  vars:\r\n    check_mode_var_yes: yes\r\n    check_mode_var_no: no\r\n\r\n  tasks:\r\n    - name: Check mode yes\r\n      debug:\r\n        msg: \"Check mode yes\"\r\n      check_mode: yes\r\n\r\n    - name: Check mode no\r\n      debug:\r\n        msg: \"Check mode no\"\r\n      check_mode: no\r\n\r\n    - name: Check mode yes (through check_mode_var)\r\n      debug:\r\n        msg: \"Check mode yes (through check_mode_var)\"\r\n      check_mode: \"{{ check_mode_var_yes }}\"\r\n\r\n    - name: Check mode no (through check_mode_var)\r\n      debug:\r\n        msg: \"Check mode no (through check_mode_var)\"\r\n      check_mode: \"{{ check_mode_var_no }}\"\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nI expect to see that the task `Check mode no (through check_mode_var)` would NOT be marked `[CHECK MODE]`, as it is not being run in check mode:\r\n\r\n```\r\nTASK [Check mode yes] [CHECK MODE] ***********************************************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:01.094)       0:00:01.456 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode yes\"\r\n}\r\n\r\nTASK [Check mode no] *************************************************************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.092)       0:00:01.548 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode no\"\r\n}\r\n\r\nTASK [Check mode yes (through check_mode_var)] [CHECK MODE] **********************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.095)       0:00:01.644 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode yes (through check_mode_var)\"\r\n}\r\n\r\nTASK [Check mode no (through check_mode_var)] ***********************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.089)       0:00:01.733 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode no (through check_mode_var)\"\r\n}\r\n```\r\n\r\n### Actual Results\r\n\r\nInstead I see that it is marked (although it is running in normal mode). The fact that it is not running in check mode I have verified independently with another playbook with tasks that make actual changes.\r\n\r\n```\r\nTASK [Check mode yes] [CHECK MODE] ***********************************************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:01.094)       0:00:01.456 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode yes\"\r\n}\r\n\r\nTASK [Check mode no] *************************************************************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.092)       0:00:01.548 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode no\"\r\n}\r\n\r\nTASK [Check mode yes (through check_mode_var)] [CHECK MODE] **********************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.095)       0:00:01.644 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode yes (through check_mode_var)\"\r\n}\r\n\r\nTASK [Check mode no (through check_mode_var)] [CHECK MODE] ***********************************************\r\nMonday 09 August 2021  18:57:52 +0300 (0:00:00.089)       0:00:01.733 ********* \r\nok: [localhost] => {\r\n    \"msg\": \"Check mode no (through check_mode_var)\"\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-07-23T10:10:00Z",
        "user": "johnbui423",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.10"
        ]
    },
    {
        "number": 75240,
        "title": "`include_role` fails, when evaluating inventory variables with template as value also fails",
        "body": "### Summary\r\n\r\n`include_role` fails, when evaluating inventory variables with template as value also fails, before even executing any task in the role. This is due to `include_role` being considered an `action` and all host vars being eagerly evaluated, even if not required. My expectation, is `include_role` will be considered as a `local_action` rather than an `action` running on remote . This would remove any potential problems in lookup plugins used in Ansible magic variables, like `ansible_password` or `ansible_user`.\r\n\r\nFrom my investigation the issue is in this block:\r\nhttps://github.com/ansible/ansible/blob/f8bb182589b9ba04bad4d32ee29d5cdcd2d84548/lib/ansible/executor/task_executor.py#L433-L459\r\nspecifically line\r\nhttps://github.com/ansible/ansible/blob/f8bb182589b9ba04bad4d32ee29d5cdcd2d84548/lib/ansible/executor/task_executor.py#L445\r\n\r\nThe issue can be fixed by changing above line into:\r\n```\r\n            if not self._task.action in (C._ACTION_ALL_INCLUDE_TASKS + C._ACTION_INCLUDE_ROLE):\r\n                self._play_context.post_validate(templar=templar)\r\n```\r\nbut given the comments in code, above might be just a _hack_.\r\n\r\nIn certain way, this might be related to #30700, but the fix included in #31463 doesn't seem to cover the above problem\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\ninclude_role\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible [core 2.12.0.dev0] (devel f8bb182589) last updated 2021/07/13 11:41:14 (GMT +200)\r\n  config file = None\r\n  configured module search path = ['/Users/egor/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/egor/Projects/Development/Github.Public/ansible/lib/ansible\r\n  ansible collection location = /Users/egor/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/egor/Projects/Development/Github.Public/ansible/bin/ansible\r\n  python version = 3.8.2 (default, Jun  8 2021, 11:59:35) [Clang 12.0.5 (clang-1205.0.22.11)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nmacOS Big Sur 11.4\r\n\r\n### Steps to Reproduce\r\n\r\n\r\nRun https://github.com/egmar/include_role_example/blob/main/validate.yml playbook\r\n  ```\r\n  ansible-playbook -i inventories/inventory.yaml -l server1 validate.yml\r\n  ```\r\n\r\n### Expected Results\r\n\r\n```\r\n/Users/egor/Projects/Development/Github.Public/ansible/bin/ansible-playbook -i inventories/inventory.yaml -l server1 validate.yml\r\n[WARNING]: You are running the development version of Ansible. You should only\r\nrun Ansible from \"devel\" if you are modifying the Ansible engine, or trying out\r\nfeatures under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\n\r\nPLAY [test] ********************************************************************\r\n\r\nTASK [test] ********************************************************************\r\nfatal: [server1]: FAILED! => {\"msg\": \"An unhandled exception occurred while running the lookup plugin 'url'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden. Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\"}\r\n\r\nTASK [1.1. Error handler] ******************************************************\r\n\r\nTASK [sample_role : 1.1. Error handler] ****************************************\r\nok: [server1 -> localhost] => {\r\n    \"msg\": [\r\n        \"Task: test\",\r\n        \"Ansible Action: setup\",\r\n        \"Error Message: An unhandled exception occurred while running the lookup plugin 'url'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden. Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\"\r\n    ]\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nserver1                    : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=1    ignored=0   \r\n\r\n\r\nProcess finished with exit code 0\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\n/Users/egor/Projects/Development/Github.Public/ansible/venv/bin/python /Users/egor/Projects/Development/Github.Public/ansible/bin/ansible-playbook -i inventories/inventory.yaml -l server1 validate.yml -vvv\r\n[WARNING]: You are running the development version of Ansible. You should only\r\nrun Ansible from \"devel\" if you are modifying the Ansible engine, or trying out\r\nfeatures under development. This is a rapidly changing source of code and can\r\nbecome unstable at any point.\r\nansible-playbook [core 2.12.0.dev0] (devel f8bb182589) last updated 2021/07/13 11:41:14 (GMT +200)\r\n  config file = None\r\n  configured module search path = ['/Users/egor/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/egor/Projects/Development/Github.Public/ansible/lib/ansible\r\n  ansible collection location = /Users/egor/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /Users/egor/Projects/Development/Github.Public/ansible/bin/ansible-playbook\r\n  python version = 3.8.2 (default, Jun  8 2021, 11:59:35) [Clang 12.0.5 (clang-1205.0.22.11)]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\nNo config file found; using defaults\r\nhost_list declined parsing /Users/egor/Projects/Development/Github.Public/egmar/include_role_example/inventories/inventory.yaml as it did not pass its verify_file() method\r\nscript declined parsing /Users/egor/Projects/Development/Github.Public/egmar/include_role_example/inventories/inventory.yaml as it did not pass its verify_file() method\r\nParsed /Users/egor/Projects/Development/Github.Public/egmar/include_role_example/inventories/inventory.yaml inventory source with yaml plugin\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: validate.yml *********************************************************\r\n1 plays in validate.yml\r\n\r\nPLAY [test] ********************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [test] ********************************************************************\r\ntask path: /Users/egor/Projects/Development/Github.Public/egmar/include_role_example/validate.yml:10\r\nexception during Jinja2 execution: Traceback (most recent call last):\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/plugins/lookup/url.py\", line 196, in run\r\n    response = open_url(term, validate_certs=self.get_option('validate_certs'),\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/module_utils/urls.py\", line 1535, in open_url\r\n    return Request().open(method, url, data=data, headers=headers, use_proxy=use_proxy,\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/module_utils/urls.py\", line 1446, in open\r\n    return urllib_request.urlopen(request, None, timeout)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 222, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 531, in open\r\n    response = meth(req, response)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 640, in http_response\r\n    response = self.parent.error(\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 569, in error\r\n    return self._call_chain(*args)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 502, in _call_chain\r\n    result = func(*args)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 649, in http_error_default\r\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\nurllib.error.HTTPError: HTTP Error 403: Forbidden\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/template/__init__.py\", line 1006, in _lookup\r\n    ran = instance.run(loop_terms, variables=self._available_variables, **kwargs)\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/plugins/lookup/url.py\", line 211, in run\r\n    raise AnsibleError(\"Received HTTP error for %s : %s\" % (term, to_native(e)))\r\nansible.errors.AnsibleError: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\r\nfatal: [server1]: FAILED! => {\r\n    \"msg\": \"An unhandled exception occurred while running the lookup plugin 'url'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden. Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\"\r\n}\r\n\r\nTASK [1.1. Error handler] ******************************************************\r\ntask path: /Users/egor/Projects/Development/Github.Public/egmar/include_role_example/validate.yml:14\r\nexception during Jinja2 execution: Traceback (most recent call last):\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/plugins/lookup/url.py\", line 196, in run\r\n    response = open_url(term, validate_certs=self.get_option('validate_certs'),\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/module_utils/urls.py\", line 1535, in open_url\r\n    return Request().open(method, url, data=data, headers=headers, use_proxy=use_proxy,\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/module_utils/urls.py\", line 1446, in open\r\n    return urllib_request.urlopen(request, None, timeout)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 222, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 531, in open\r\n    response = meth(req, response)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 640, in http_response\r\n    response = self.parent.error(\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 569, in error\r\n    return self._call_chain(*args)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 502, in _call_chain\r\n    result = func(*args)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/urllib/request.py\", line 649, in http_error_default\r\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\nurllib.error.HTTPError: HTTP Error 403: Forbidden\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/template/__init__.py\", line 1006, in _lookup\r\n    ran = instance.run(loop_terms, variables=self._available_variables, **kwargs)\r\n  File \"/Users/egor/Projects/Development/Github.Public/ansible/lib/ansible/plugins/lookup/url.py\", line 211, in run\r\n    raise AnsibleError(\"Received HTTP error for %s : %s\" % (term, to_native(e)))\r\nansible.errors.AnsibleError: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\r\nfatal: [server1]: FAILED! => {\r\n    \"msg\": \"An unhandled exception occurred while running the lookup plugin 'url'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden. Received HTTP error for https://ip-ranges.amazonaws.com/ip-ranges.json2 : HTTP Error 403: Forbidden\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nserver1                    : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=1    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-07-13T10:10:41Z",
        "user": "egmar",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "needs_verified",
            "affects_2.12"
        ]
    },
    {
        "number": 75195,
        "title": "Add feature similar to the usermod --inactive option to the ansible user module",
        "body": "### Summary\r\n\r\nThis feature request was opened by another user in the thread #40664\r\n\r\nIncorrectly marked as implemented because of the `expires`\r\nfeature that was added to the `ansible.builtin.user` module\r\n\r\nThat means that `ansible.builtin.user`module\r\ncan not implement the adjustment similar to the one below:\r\n`usermod --inactive 20 demouser1`\r\n\r\n```\r\nusermod\r\n-f, --inactive INACTIVE\r\n    The number of days after a password expires until the account is permanently disabled. \r\n```\r\nexpires field does not cover this functionality.\r\n\r\n### Issue Type\r\n\r\nFeature Idea\r\n\r\n### Component Name\r\n\r\nansible.builtin.user\r\n\r\n### Additional Information\r\n\r\nThe feature request is related to the\r\nansible.builtin.user\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-07-07T09:17:06Z",
        "user": "alexkonkin",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "has_pr",
            "feature",
            "P3"
        ]
    },
    {
        "number": 75147,
        "title": "Collecting facts for mount points in AIX VPAR not working",
        "body": "### Summary\r\n\r\nI run the setup module with the ansible_mounts filter\r\nI get the output\r\n```\r\n\"msg\": [\r\n        {\r\n            \"device\": \"Global:/\",\r\n            \"fstype\": \"Jun\",\r\n            \"mount\": \"jfs2\",\r\n            \"options\": \"\",\r\n            \"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n        },\r\n        {\r\n            \"device\": \"Global:/admin\",\r\n            \"fstype\": \"Jun\",\r\n            \"mount\": \"jfs2\",\r\n            \"options\": \"\",\r\n            \"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n        },\r\n```\r\n\r\nI looked at the fact code of `ansible/module_utils/facts/hardware/aix.py` and found a likely error on the line\r\n 190 with code `if re.match('^/', fields[0]):` as it skips Global in the mount command output\r\n\r\nSample mount output\r\n```\r\n/usr/sbin/mount\r\n  node       mounted        mounted over    vfs       date        options     \r\n-------- ---------------  ---------------  ------ ------------ ---------------\r\n         Global           /                jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /admin           jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /audit           jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /home            jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /opt             jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /proc            namefs Jun 01 07:52 rw             \r\n         Global           /tmp             jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /usr             jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /var             jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /var/adm/ras/livedump jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /xoracle         jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /xoradata        jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n         Global           /xredolog        jfs2   Jun 01 07:52 rw,log=/dev/wpar311_lg\r\n```\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible/module_utils/facts/hardware/aix.py\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible-playbook 2.9.21\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/mvp_dev/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug 13 2020, 02:51:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nAIX\r\n\r\n### Steps to Reproduce\r\n```\r\n- setup:\r\n       filter: \"ansible_mounts\"\r\n```\r\n### Expected Results\r\n```\r\n {\r\n            \"block_available\": 234497,\r\n            \"block_size\": 4096,\r\n            \"block_total\": 2621440,\r\n            \"block_used\": 2386943,\r\n            \"device\": \"/dev/hd2\",\r\n            \"fstype\": \"jfs2\",\r\n            \"inode_available\": 215775,\r\n            \"inode_total\": 328409,\r\n            \"inode_used\": 112634,\r\n            \"mount\": \"/usr\",\r\n            \"options\": \"rw,log=/dev/hd8\",\r\n            \"size_available\": 960499712,\r\n            \"size_total\": 10737418240,\r\n            \"time\": \"Mar 29 13:52\"\r\n        },\r\n\r\n        {\r\n            \"block_available\": 1608044,\r\n            \"block_size\": 4096,\r\n            \"block_total\": 2097152,\r\n            \"block_used\": 489108,\r\n            \"device\": \"/dev/hd9var\",\r\n            \"fstype\": \"jfs2\",\r\n            \"inode_available\": 1431707,\r\n            \"inode_total\": 1442396,\r\n            \"inode_used\": 10689,\r\n            \"mount\": \"/var\",\r\n            \"options\": \"rw,log=/dev/hd8\",\r\n            \"size_available\": 6586548224,\r\n            \"size_total\": 8589934592,\r\n            \"time\": \"Mar 29 13:52\"\r\n        },\r\n```\r\n### Actual Results\r\n\r\n```console\r\nTASK [{{ deployment_action }} | Collect only fact filesystem] ****************************************************************************************************************************\r\n[WARNING]: Platform aix on host HOST is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python interpreter\r\ncould change this. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information.\r\nok: [HOST]\r\n\u00a0\r\nTASK [debug] *****************************************************************************************************************************************************************************\r\nok: [HOST] => {\r\n\u00a0\u00a0\u00a0 \"msg\": [\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/admin\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/audit\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/home\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/opt\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/proc\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"namefs\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/tmp\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/usr\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/var\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"device\": \"Global:/var/adm/ras/livedump\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/xoracle\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/xoradata\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 },\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \"device\": \"Global:/xredolog\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"fstype\": \"Jun\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"mount\": \"jfs2\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"options\": \"\",\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"time\": \"01 07:52 rw,log=/dev/wpar311_lg\"\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\r\n\u00a0\u00a0\u00a0 ]\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-30T13:38:47Z",
        "user": "corthylio",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 75109,
        "title": "sub plugins are not being pulled into documentation or ansible-doc etc",
        "body": "### Summary\n\nSome collections, such as ansible.utils, have an entity called sub_plugins that include DOCUMENTATION blocks that are not visible in docs.ansible.com or probably not in `ansible-doc`.  These sub_plugins are important to end users and their information should be displayed.\r\n\r\nExamples of sub_plugins:\r\n\r\nhttps://github.com/ansible-collections/ansible.utils/tree/main/plugins/sub_plugins\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\ndocs/docsite/rst/\n\n### Ansible Version\n\n```console\n2.9, 2.11\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\n```\n\n\n### OS / Environment\n\nFedora 33\n\n### Additional Information\n\nThis added information will improve the user experience.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-24T20:16:25Z",
        "user": "samccann",
        "labels": [
            "windows",
            "support:core",
            "docs",
            "docsite",
            "affects_2.15"
        ]
    },
    {
        "number": 75023,
        "title": "Return better error when role name contains invalid characters for collections",
        "body": "### Summary\n\nI have a playbook that looks like this:\r\n\r\n```\r\n---\r\n- hosts: host1, host2\r\n  roles:\r\n    - role: namespace.my_collection.common\r\n      tags: common\r\n\r\n    - role: namespace.my_collection.autoupdate-apt\r\n      tags: common\r\n```\r\nIf I try to use it It reports that the role couldn't be found. If I change name of the autoupdate-apt role to autoupdate_apt in the collection and the playbook it is found and executed\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\ncollections\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible [core 2.11.1] \r\n  config file = /home/leah/example/ansible.cfg\r\n  configured module search path = ['/home/leah/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /home/leah/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.5 (default, May 24 2021, 12:50:35) [GCC 11.1.0]\r\n  jinja version = 3.0.1\r\n  libyaml = True\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\nDEFAULT_MANAGED_STR(/home/leah/example/ansible.cfg) = This file is managed by ansible - please do not edit it as changes will be reverted.\n```\n\n\n### OS / Environment\n\nCurrent Arch Linux\n\n### Steps to Reproduce\n\nCreate a collection with a role containing a - in it's name\r\nTry to use this role according to the playbook snippet above.\n\n### Expected Results\n\nThe role with - in it's name is found and executed \n\n### Actual Results\n\n```console\nERROR! the role 'namespace.my_collection.autoupdate-apt' was not found in /home/leah/example/roles:/home/leah/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/home/leah/example/\r\n\r\nThe error appears to be in '/home/leah/example/site.yml': line 7, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n    - role: namespace.my_collection.autoupdate-apt\r\n      ^ here\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-16T13:56:48Z",
        "user": "leahoswald",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 75019,
        "title": "ansible CLI tools error out if `$HOME` isn't writable",
        "body": "### Summary\r\n\r\nWhen ${HOME} can't be written to ansible-galaxy doesn't even allow you to run \"--help\" to try and find a possible flag to change the cache directories.\r\n\r\nIn my case this happened because I logged into a machine with centralized auth where my home directory didn't exist\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-galaxy\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 2.7.5 (default, Aug 13 2020, 02:51:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]. \r\nThis feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\n/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/parsing/vault/__init__.py:44: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in the next release.\r\n  from cryptography.exceptions import InvalidSignature\r\nansible [core 2.11.1] \r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/tmp/mchapel-tmp/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /tmp/mchappel-tmp/lib/python2.7/site-packages/ansible\r\n  ansible collection location = /tmp/mchapel-tmp/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /tmp/mchappel-tmp/bin/ansible\r\n  python version = 2.7.5 (default, Aug 13 2020, 02:51:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n  jinja version = 2.11.3\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n[DEPRECATION WARNING]: Ansible will require Python 3.8 or newer on the controller starting with Ansible 2.12. Current version: 2.7.5 (default, Aug 13 2020, 02:51:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]. \r\nThis feature will be removed from ansible-core in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\n/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/parsing/vault/__init__.py:44: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in the next release.\r\n  from cryptography.exceptions import InvalidSignature\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 60\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nRHEL 7\r\n\r\n### Steps to Reproduce\r\n\r\nAs a non-root user, where /does_not_exist doesn't exist:\r\n\r\n```\r\n$ virtualenv /tmp/mchappel-tmp\r\n$ source /tmp/mchappel-tmp/bin/activate\r\n$ pip install ansible\r\n$ export HOME=/does_not_exist\r\n$ ansible-galaxy --help\r\n```\r\n\r\n### Expected Results\r\n\r\n```\r\nusage: ansible-galaxy [-h] [--version] [-v] TYPE ...\r\n\r\nPerform various Role and Collection related operations.\r\n\r\npositional arguments:\r\n  TYPE\r\n    collection   Manage an Ansible Galaxy collection.\r\n    role         Manage an Ansible Galaxy role.\r\n\r\noptional arguments:\r\n  --version      show program's version number, config file location,\r\n                 configured module search path, module location, executable\r\n                 location and exit\r\n  -h, --help     show this help message and exit\r\n  -v, --verbose  verbose mode (-vvv for more, -vvvv to enable connection\r\n                 debugging)\r\n\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nUnhandled error:\r\n Traceback (most recent call last):\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/config/manager.py\", line 605, in update_config_data\r\n    value, origin = self.get_config_value_and_origin(config, configfile)\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/config/manager.py\", line 543, in get_config_value_and_origin\r\n    value = ensure_type(value, defs[config].get('type'), origin=origin)\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/config/manager.py\", line 122, in ensure_type\r\n    makedirs_safe(value, 0o700)\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/utils/path.py\", line 90, in makedirs_safe\r\n    raise AnsibleError(\"Unable to create local directories(%s): %s\" % (to_native(rpath), to_native(e)))\r\nAnsibleError: Unable to create local directories(/does_not_exist/.ansible/tmp): [Errno 13] Permission denied: '/does_not_exist'\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"/tmp/mchappel-tmp/bin/ansible-galaxy\", line 63, in <module>\r\n    import ansible.constants as C\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/constants.py\", line 181, in <module>\r\n    config = ConfigManager()\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/config/manager.py\", line 310, in __init__\r\n    self.update_config_data()\r\n  File \"/tmp/mchappel-tmp/lib/python2.7/site-packages/ansible/config/manager.py\", line 617, in update_config_data\r\n    raise AnsibleError(\"Invalid settings supplied for %s: %s\\n\" % (config, to_native(e)), orig_exc=e)\r\nansible.errors.AnsibleError: Invalid settings supplied for DEFAULT_LOCAL_TMP: Unable to create local directories(/does_not_exist/.ansible/tmp): [Errno 13] Permission denied: '/does_not_exist'\r\n. Unable to create local directories(/does_not_exist/.ansible/tmp): [Errno 13] Permission denied: '/does_not_exist'\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-16T11:17:26Z",
        "user": "tremble",
        "labels": [
            "support:core",
            "bug",
            "traceback",
            "P3",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 74991,
        "title": "`lineinfile:` ignores `insertbefore:` except on first-run",
        "body": "### Summary\r\n\r\n`lineinfile:`'s `insertbefore:` does not produce consistent results. If the line specified by `line:` and/or `regexp:` already exists in the file, `insertbefore:` is ignored. If I add a `insertbefore:` constraint then it should be move the line up to match, but it doesn't. This means `lineinfile:` isn't idempotent.\r\n\r\nPresumably the opposite problem exists for `insertafter:`\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nlineinfile\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.10.8\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/kousu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/kousu/.local/lib/python3.6/site-packages/ansible\r\n  executable location = /home/kousu/.local/bin/ansible\r\n  python version = 3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n$\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\n```\r\n$ cat /etc/os-release \r\nNAME=\"GalliumOS\"\r\nVERSION=\"3.1 (Bismuth)\"\r\nID=galliumos\r\nID_LIKE=\"ubuntu debian\"\r\nPRETTY_NAME=\"GalliumOS 3.1\"\r\nVERSION_ID=\"3.1\"\r\nHOME_URL=\"https://galliumos.org/\"\r\nSUPPORT_URL=\"https://galliumos.org/\"\r\nBUG_REPORT_URL=\"https://https://github.com/GalliumOS/galliumos-distro/issues\"\r\nVERSION_CODENAME=bismuth\r\nUBUNTU_CODENAME=bionic\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nWith\r\n\r\n```yaml\r\n# home.yml\r\n- hosts: all\r\n  tasks:\r\n  - name: Create home folder upon login\r\n    lineinfile:\r\n      path: /etc/pam.d/common-session\r\n      line: 'session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022'\r\n      regexp: 'pam_mkhomedir.so'\r\n      insertbefore: 'pam_mount.so'\r\n```\r\n\r\nPut the given line at the **end** of the target file:\r\n\r\n```\r\nroot@joplin:~# cat /etc/pam.d/common-session\r\n#\r\n# /etc/pam.d/common-session - session-related modules common to all services\r\n#\r\n# This file is included from other service-specific PAM config files,\r\n# and should contain a list of modules that define tasks to be performed\r\n# at the start and end of sessions of *any* kind (both interactive and\r\n# non-interactive).\r\n#\r\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\r\n# To take advantage of this, it is recommended that you configure any\r\n# local modules either before or after the default block, and use\r\n# pam-auth-update to manage selection of other modules.  See\r\n# pam-auth-update(8) for details.\r\n\r\n# here are the per-package modules (the \"Primary\" block)\r\nsession\t[default=1]\t\t\tpam_permit.so\r\n# here's the fallback if no module succeeds\r\nsession\trequisite\t\t\tpam_deny.so\r\n# prime the stack with a positive return value if there isn't one already;\r\n# this avoids us returning an error just because nothing sets a success code\r\n# since the modules above will each just jump around\r\nsession\trequired\t\t\tpam_permit.so\r\n# The pam_umask module will set the umask according to the system default in\r\n# /etc/login.defs and user settings, solving the problem of different\r\n# umask settings with different shells, display managers, remote sessions etc.\r\n# See \"man pam_umask\".\r\nsession optional\t\t\tpam_umask.so\r\n# and here are more per-package modules (the \"Additional\" block)\r\nsession\trequired\tpam_unix.so \r\nsession\toptional\t\t\tpam_sss.so \r\nsession\toptional\tpam_mount.so \r\nsession\toptional\tpam_systemd.so \r\n# end of pam-auth-update config\r\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\n```\r\n\r\nand then run the playbook:\r\n\r\n```\r\nansible-playbook -vvvv -u root -i joplin.neuro.polymtl.ca, --diff home.yml\r\n```\r\n\r\n### Expected Results\r\n\r\n\r\n```\r\nansible-playbook -u root -i joplin.neuro.polymtl.ca, --diff home.yml \r\n```\r\n\r\nshould produce\r\n\r\n```\r\n# /etc/pam.d/common-session - session-related modules common to all services\r\n#\r\n# This file is included from other service-specific PAM config files,\r\n# and should contain a list of modules that define tasks to be performed\r\n# at the start and end of sessions of *any* kind (both interactive and\r\n# non-interactive).\r\n#\r\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\r\n# To take advantage of this, it is recommended that you configure any\r\n# local modules either before or after the default block, and use\r\n# pam-auth-update to manage selection of other modules.  See\r\n# pam-auth-update(8) for details.\r\n\r\n# here are the per-package modules (the \"Primary\" block)\r\nsession\t[default=1]\t\t\tpam_permit.so\r\n# here's the fallback if no module succeeds\r\nsession\trequisite\t\t\tpam_deny.so\r\n# prime the stack with a positive return value if there isn't one already;\r\n# this avoids us returning an error just because nothing sets a success code\r\n# since the modules above will each just jump around\r\nsession\trequired\t\t\tpam_permit.so\r\n# The pam_umask module will set the umask according to the system default in\r\n# /etc/login.defs and user settings, solving the problem of different\r\n# umask settings with different shells, display managers, remote sessions etc.\r\n# See \"man pam_umask\".\r\nsession optional\t\t\tpam_umask.so\r\n# and here are more per-package modules (the \"Additional\" block)\r\nsession\trequired\tpam_unix.so \r\nsession\toptional\t\t\tpam_sss.so \r\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\nsession\toptional\tpam_mount.so \r\nsession\toptional\tpam_systemd.so \r\n# end of pam-auth-update config\r\n```\r\n\r\nBut instead, if the line already exists, it leaves it where it is, instead of moving it before pam_mount.so.\r\n\r\n### Actual Results\r\n\r\nActual results depend on the pre-existing state.\r\n\r\nIf no line exists yet, it behaves correctly:\r\n\r\n```console\r\n$ ssh root@joplin.neuro.polymtl.ca cat /etc/pam.d/common-session\r\n#\r\n# /etc/pam.d/common-session - session-related modules common to all services\r\n#\r\n# This file is included from other service-specific PAM config files,\r\n# and should contain a list of modules that define tasks to be performed\r\n# at the start and end of sessions of *any* kind (both interactive and\r\n# non-interactive).\r\n#\r\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\r\n# To take advantage of this, it is recommended that you configure any\r\n# local modules either before or after the default block, and use\r\n# pam-auth-update to manage selection of other modules.  See\r\n# pam-auth-update(8) for details.\r\n\r\n# here are the per-package modules (the \"Primary\" block)\r\nsession\t[default=1]\t\t\tpam_permit.so\r\n# here's the fallback if no module succeeds\r\nsession\trequisite\t\t\tpam_deny.so\r\n# prime the stack with a positive return value if there isn't one already;\r\n# this avoids us returning an error just because nothing sets a success code\r\n# since the modules above will each just jump around\r\nsession\trequired\t\t\tpam_permit.so\r\n# The pam_umask module will set the umask according to the system default in\r\n# /etc/login.defs and user settings, solving the problem of different\r\n# umask settings with different shells, display managers, remote sessions etc.\r\n# See \"man pam_umask\".\r\nsession optional\t\t\tpam_umask.so\r\n# and here are more per-package modules (the \"Additional\" block)\r\nsession\trequired\tpam_unix.so \r\nsession\toptional\t\t\tpam_sss.so \r\nsession\toptional\tpam_mount.so \r\nsession\toptional\tpam_systemd.so \r\n# end of pam-auth-update config\r\n```\r\n\r\n```\r\n$ ansible-playbook -vvvv -u root -i joplin.neuro.polymtl.ca, --diff home.yml\r\nansible-playbook 2.10.8\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/kousu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/kousu/.local/lib/python3.6/site-packages/ansible\r\n  executable location = /home/kousu/.local/bin/ansible-playbook\r\n  python version = 3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed joplin.neuro.polymtl.ca, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/kousu/.local/lib/python3.6/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: home.yml ***********************************************************************************************************************************\r\nPositional arguments: home.yml\r\nverbosity: 4\r\nremote_user: root\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\ntags: ('all',)\r\ndiff: True\r\ninventory: ('joplin.neuro.polymtl.ca,',)\r\nforks: 5\r\n1 plays in home.yml\r\n\r\nPLAY [all] *******************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *******************************************************************************************************************************\r\ntask path: /home/kousu/src/neuropoly/computers/home.yml:2\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\nEnter passphrase for key '/home/kousu/.ssh/id_ed25519.neuropoly': \r\n<joplin.neuro.polymtl.ca> (0, b'/root\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/home/kousu/.ansible/cp/715ff11c12\" does not exist\\r\\ndebug2: resolving \"joplin.neuro.polymtl.ca\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to joplin.neuro.polymtl.ca [132.207.65.211] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9952 ms remain after connect\\r\\ndebug1: identity file /home/kousu/.ssh/id_ed25519.neuropoly type 3\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /home/kousu/.ssh/id_ed25519.neuropoly-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_8.2p1 Ubuntu-4ubuntu0.2\\r\\ndebug1: match: OpenSSH_8.2p1 Ubuntu-4ubuntu0.2 pat OpenSSH* compat 0x04000000\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to joplin.neuro.polymtl.ca:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/home/kousu/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /home/kousu/.ssh/known_hosts:44\\r\\ndebug3: load_hostkeys: loaded 1 keys from joplin.neuro.polymtl.ca\\r\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256\\r\\ndebug2: host key algorithms: rsa-sha2-512,rsa-sha2-256,ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: curve25519-sha256\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:56hmw5QTBPxAsRoLIU6qA0kxAbXLJhO60S1zzMFhR+0\\r\\ndebug3: hostkeys_foreach: reading file \"/home/kousu/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /home/kousu/.ssh/known_hosts:44\\r\\ndebug3: load_hostkeys: loaded 1 keys from joplin.neuro.polymtl.ca\\r\\ndebug3: hostkeys_foreach: reading file \"/home/kousu/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /home/kousu/.ssh/known_hosts:45\\r\\ndebug3: load_hostkeys: loaded 1 keys from 132.207.65.211\\r\\ndebug1: Host \\'joplin.neuro.polymtl.ca\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /home/kousu/.ssh/known_hosts:44\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: pubkey_prepare: ssh_get_authentication_socket: No such file or directory\\r\\ndebug2: key: /home/kousu/.ssh/id_ed25519.neuropoly (0x55cdd210c480), explicit\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,password\\r\\ndebug3: start over, passed a different list publickey,password\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: ED25519 SHA256:EBfMaqmOuoXeNU7BGuDm2S07tgZgdkuEBMAQlmV3fAI /home/kousu/.ssh/id_ed25519.neuropoly\\r\\ndebug3: send_pubkey_test\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: pkalg ssh-ed25519 blen 51\\r\\ndebug2: input_userauth_pk_ok: fp SHA256:EBfMaqmOuoXeNU7BGuDm2S07tgZgdkuEBMAQlmV3fAI\\r\\ndebug3: sign_and_send_pubkey: ED25519 SHA256:EBfMaqmOuoXeNU7BGuDm2S07tgZgdkuEBMAQlmV3fAI\\r\\ndebug3: no authentication agent, not adding key\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to joplin.neuro.polymtl.ca ([132.207.65.211]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /home/kousu/.ansible/cp/715ff11c12.17K7IiY1P1alixfN\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/home/kousu/.ansible/cp/715ff11c12]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 4\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 18784\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: process_mux_master_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: process_mux_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 104\\r\\ndebug2: process_mux_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo ~root && sleep 0\\'\", env 1\\r\\ndebug3: process_mux_new_session: got fds stdin 6, stdout 7, stderr 8\\r\\ndebug2: fd 7 setting O_NONBLOCK\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: process_mux_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:4: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 4\\r\\ndebug1: Remote: /root/.ssh/authorized_keys:4: key options: agent-forwarding port-forwarding pty user-rc x11-forwarding\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = en_CA.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo ~root && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: channel 2: close_read\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: close_write\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: close_read\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o1/16 fd 5/5 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 fd -1/-1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: close_write\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o3/0 fd 5/5 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141 `\" && echo ansible-tmp-1623640140.599724-18782-50775521164141=\"` echo /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141 `\" ) && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'ansible-tmp-1623640140.599724-18782-50775521164141=/root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> Attempting python interpreter discovery\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python\\n/usr/bin/python2.7\\n/usr/bin/python3\\n/usr/bin/python\\nENDFOUND\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'{\"platform_dist_result\": [], \"osrelease_content\": \"NAME=\\\\\"Ubuntu\\\\\"\\\\nVERSION=\\\\\"20.04.2 LTS (Focal Fossa)\\\\\"\\\\nID=ubuntu\\\\nID_LIKE=debian\\\\nPRETTY_NAME=\\\\\"Ubuntu 20.04.2 LTS\\\\\"\\\\nVERSION_ID=\\\\\"20.04\\\\\"\\\\nHOME_URL=\\\\\"https://www.ubuntu.com/\\\\\"\\\\nSUPPORT_URL=\\\\\"https://help.ubuntu.com/\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.launchpad.net/ubuntu/\\\\\"\\\\nPRIVACY_POLICY_URL=\\\\\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\\\\\"\\\\nVERSION_CODENAME=focal\\\\nUBUNTU_CODENAME=focal\\\\n\"}\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /home/kousu/.local/lib/python3.6/site-packages/ansible/modules/setup.py\r\n<joplin.neuro.polymtl.ca> PUT /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmp8h66hzu9 TO /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/AnsiballZ_setup.py\r\n<joplin.neuro.polymtl.ca> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 '[joplin.neuro.polymtl.ca]'\r\n<joplin.neuro.polymtl.ca> (0, b'sftp> put /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmp8h66hzu9 /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/AnsiballZ_setup.py\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Unrecognised server extension \"lsetstat@openssh.com\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmp8h66hzu9\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/AnsiballZ_setup.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:163840 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:10 O:196608 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:11 O:229376 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:12 O:262144 S:5983\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 131072\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 32768 bytes at 163840\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 10 32768 bytes at 196608\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 11 32768 bytes at 229376\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 12 5983 bytes at 262144\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/ /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 -tt joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'\\r\\n{\"ansible_facts\": {\"ansible_is_chroot\": false, \"ansible_user_id\": \"root\", \"ansible_user_uid\": 0, \"ansible_user_gid\": 0, \"ansible_user_gecos\": \"root\", \"ansible_user_dir\": \"/root\", \"ansible_user_shell\": \"/bin/bash\", \"ansible_real_user_id\": 0, \"ansible_effective_user_id\": 0, \"ansible_real_group_id\": 0, \"ansible_effective_group_id\": 0, \"ansible_distribution\": \"Ubuntu\", \"ansible_distribution_release\": \"focal\", \"ansible_distribution_version\": \"20.04\", \"ansible_distribution_major_version\": \"20\", \"ansible_distribution_file_path\": \"/etc/os-release\", \"ansible_distribution_file_variety\": \"Debian\", \"ansible_distribution_file_parsed\": true, \"ansible_os_family\": \"Debian\", \"ansible_system_capabilities_enforced\": \"False\", \"ansible_system_capabilities\": [], \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_selinux_python_present\": false, \"ansible_virtualization_type\": \"kvm\", \"ansible_virtualization_role\": \"host\", \"ansible_lsb\": {\"id\": \"Ubuntu\", \"description\": \"Ubuntu 20.04.2 LTS\", \"release\": \"20.04\", \"codename\": \"focal\", \"major_release\": \"20\"}, \"ansible_system\": \"Linux\", \"ansible_kernel\": \"5.4.0-74-generic\", \"ansible_kernel_version\": \"#83-Ubuntu SMP Sat May 8 02:35:39 UTC 2021\", \"ansible_machine\": \"x86_64\", \"ansible_python_version\": \"3.8.5\", \"ansible_fqdn\": \"joplin.neuro.polymtl.ca\", \"ansible_hostname\": \"joplin\", \"ansible_nodename\": \"joplin.neuro.polymtl.ca\", \"ansible_domain\": \"neuro.polymtl.ca\", \"ansible_userspace_bits\": \"64\", \"ansible_architecture\": \"x86_64\", \"ansible_userspace_architecture\": \"x86_64\", \"ansible_machine_id\": \"d5fa3cd8909746060f19a34b5afedd55\", \"ansible_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinuz-5.4.0-74-generic\", \"root\": \"UUID=896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"ro\": true}, \"ansible_proc_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinuz-5.4.0-74-generic\", \"root\": \"UUID=896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"ro\": true}, \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAPS+Rgj0Rx+Cl8k0sR/JsNuT+iuPKIbqusSWkT/vIWjtCA3w7KNZ6Xfq4QhMjcmlCkFE2kZZLtU8r+fguG9n0rbOLWPcwI8S1q/nHx5IdX5OxFDK4KOC8tglm69D7VY5k6mirsdHjTSN2bfZ51GCd3qnUrq7f7YhErguvu2orMCRAAAAFQD3j2SCxRgUMLj2FX9yp1PS0KXnjQAAAIEAntbcLy3u6+nxv3FZKw5AlJ7+8WWDRzFiZ1CwMIMU/sUSEIPsdmaG0EltQ/3Ki0X7fIb4BO9gAvfVkaoAL3abmWHs48XmJjH7RVrnEF8kjFH7lAexIzTjT2oipWHR5vl+mUM/iNQEBB8z8g9y8ZEcmPoXmtCWvDAkg/fwhTzf4QYAAACATcNpg1tAQ+LSBgAofJpgochYVIpyopDIhCm36c/93u0820HdaySMARIvWvVFuUdKjnatVp9axf16dp2oNz+KTj4XZEDilNtAbimXK/fGYLrDuxynTD9rhAf9VTLRNWfNGR5YYz6qR+G2m/P4J9KZDGhLnkivzOR4Y8jIzTG01Ww=\", \"ansible_ssh_host_key_dsa_public_keytype\": \"ssh-dss\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDFlxn8FpTI78+5AMgsDk9lpWn0HEQrZUnsiJbIIJuKomzAU6CoJlQYZQw/Rwjo8dBjTZz4rhLokiD/dogtSpBbhhl2nu1J3xGX5gT+Un1e1xgo1Gk4yJUo2hCEhWOsx6Xw5s7TmNvKMuXQ25o/ifk/XdZ3WUFrmKo+rnjaCaIGAfJ5ZQ065Qsv/+TNahNOYbeC9pia6YyQRXNXrhtpbnUyuHMwhrmrGVD7nUgD1Nob4VReWktEtccI/ukKv/DMQu/DxDdDZsvceeIgY2OyOA9OahPrAZcj/XIwO1U39Nuv72LNqdrMhZH4T81vcnjQqHincGzJ9WynKT/mIk1A2BvB\", \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLBFsDtdaFdeeA01YCN3pytojGjewWfYSQrTF4rfM024l+UOIb6u7fxyS0sf4mdS6k5fqmJvXKzGrzsMVXN978U=\", \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAINcjFQVMhSYBctMSjfyfRel+n3nvkWNKFdWCYs94ncwr\", \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_date_time\": {\"year\": \"2021\", \"month\": \"06\", \"weekday\": \"Sunday\", \"weekday_number\": \"0\", \"weeknumber\": \"23\", \"day\": \"13\", \"hour\": \"23\", \"minute\": \"09\", \"second\": \"02\", \"epoch\": \"1623640142\", \"date\": \"2021-06-13\", \"time\": \"23:09:02\", \"iso8601_micro\": \"2021-06-14T03:09:02.601807Z\", \"iso8601\": \"2021-06-14T03:09:02Z\", \"iso8601_basic\": \"20210613T230902601807\", \"iso8601_basic_short\": \"20210613T230902\", \"tz\": \"EDT\", \"tz_offset\": \"-0400\"}, \"ansible_fibre_channel_wwn\": [], \"ansible_dns\": {\"nameservers\": [\"127.0.0.53\"], \"search\": [\"grames.polymtl.ca\"]}, \"ansible_python\": {\"version\": {\"major\": 3, \"minor\": 8, \"micro\": 5, \"releaselevel\": \"final\", \"serial\": 0}, \"version_info\": [3, 8, 5, \"final\", 0], \"executable\": \"/usr/bin/python\", \"has_sslcontext\": true, \"type\": \"cpython\"}, \"ansible_processor\": [\"0\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"1\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"2\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"3\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"4\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"5\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"6\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"7\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"8\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"9\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"10\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"11\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"12\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"13\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"14\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"15\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"16\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"17\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"18\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"19\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"20\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"21\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"22\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"23\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"24\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"25\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"26\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"27\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"28\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"29\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"30\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"31\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"32\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"33\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"34\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"35\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"36\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"37\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"38\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"39\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"40\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"41\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"42\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"43\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"44\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"45\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"46\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"47\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"48\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"49\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"50\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"51\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"52\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"53\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"54\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"55\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"56\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"57\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"58\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"59\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"60\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"61\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"62\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"63\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"64\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"65\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"66\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"67\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"68\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"69\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"70\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"71\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"72\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"73\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"74\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"75\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"76\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"77\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"78\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"79\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"80\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"81\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"82\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"83\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"84\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"85\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"86\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"87\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"88\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"89\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"90\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"91\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"92\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"93\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"94\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"95\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"96\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"97\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"98\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"99\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"100\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"101\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"102\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"103\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"104\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"105\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"106\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"107\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"108\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"109\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"110\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"111\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"112\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"113\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"114\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"115\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"116\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"117\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"118\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"119\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"120\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"121\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"122\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"123\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"124\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"125\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"126\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"127\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\"], \"ansible_processor_count\": 4, \"ansible_processor_cores\": 16, \"ansible_processor_threads_per_core\": 2, \"ansible_processor_vcpus\": 128, \"ansible_processor_nproc\": 128, \"ansible_memtotal_mb\": 257609, \"ansible_memfree_mb\": 146798, \"ansible_swaptotal_mb\": 975, \"ansible_swapfree_mb\": 963, \"ansible_memory_mb\": {\"real\": {\"total\": 257609, \"used\": 110811, \"free\": 146798}, \"nocache\": {\"free\": 251091, \"used\": 6518}, \"swap\": {\"total\": 975, \"free\": 963, \"used\": 12, \"cached\": 0}}, \"ansible_bios_date\": \"07/20/2018\", \"ansible_bios_vendor\": \"American Megatrends Inc.\", \"ansible_bios_version\": \"3.1\", \"ansible_board_asset_tag\": \"Default string\", \"ansible_board_name\": \"X10QBL-4\", \"ansible_board_serial\": \"OM176S013580\", \"ansible_board_vendor\": \"Supermicro\", \"ansible_board_version\": \"1.01\", \"ansible_chassis_asset_tag\": \"Default string\", \"ansible_chassis_serial\": \"0123456789\", \"ansible_chassis_vendor\": \"Supermicro\", \"ansible_chassis_version\": \"0123456789\", \"ansible_form_factor\": \"Main Server Chassis\", \"ansible_product_name\": \"Super Server\", \"ansible_product_serial\": \"0123456789\", \"ansible_product_uuid\": \"00000000-0000-0000-0000-0cc47af9c086\", \"ansible_product_version\": \"0123456789\", \"ansible_system_vendor\": \"Supermicro\", \"ansible_devices\": {\"loop1\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"nvme0n1\": {\"virtual\": 1, \"links\": {\"ids\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663\", \"nvme-eui.cfe00003330eb300\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": \"MTFDHAX800MCE-1AN1ZABYY\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"partitions\": {\"nvme0n1p1\": {\"links\": {\"ids\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663-part1\", \"nvme-eui.cfe00003330eb300-part1\"], \"uuids\": [\"94b080ed-6a17-4855-bd88-8c54d6889274\"], \"labels\": [\"datapartition\"], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"1562820608\", \"sectorsize\": 512, \"size\": \"745.21 GB\", \"uuid\": \"94b080ed-6a17-4855-bd88-8c54d6889274\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"none\", \"sectors\": \"1562824368\", \"sectorsize\": \"512\", \"size\": \"745.21 GB\", \"host\": \"Non-Volatile memory controller: Micron Technology Inc 9100 PRO NVMe SSD (rev 05)\", \"holders\": []}, \"sdb\": {\"virtual\": 1, \"links\": {\"ids\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M\", \"wwn-0x5002538f3124ba27\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": \"ATA\", \"model\": \"Samsung SSD 870\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"wwn\": \"0x5002538f3124ba27\", \"partitions\": {\"sdb1\": {\"links\": {\"ids\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M-part1\", \"wwn-0x5002538f3124ba27-part1\"], \"uuids\": [\"56343601-6cad-43e4-9731-4a3cb497b138\"], \"labels\": [], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"3907027120\", \"sectorsize\": 512, \"size\": \"1.82 TB\", \"uuid\": \"56343601-6cad-43e4-9731-4a3cb497b138\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"3907029168\", \"sectorsize\": \"512\", \"size\": \"1.82 TB\", \"host\": \"SATA controller: Intel Corporation C600/X79 series chipset 6-Port SATA AHCI Controller (rev 06)\", \"holders\": []}, \"loop6\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop4\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop2\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop0\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop7\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"sda\": {\"virtual\": 1, \"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405\", \"wwn-0x5002538c40704306\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": \"ATA\", \"model\": \"SAMSUNG MZ7KM480\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"wwn\": \"0x5002538c40704306\", \"partitions\": {\"sda2\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part2\", \"wwn-0x5002538c40704306-part2\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"start\": \"935702526\", \"sectors\": \"2\", \"sectorsize\": 512, \"size\": \"1.00 KB\", \"uuid\": null, \"holders\": []}, \"sda5\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part5\", \"wwn-0x5002538c40704306-part5\"], \"uuids\": [\"cca89e47-8d21-4513-b999-cdfe14b50261\"], \"labels\": [], \"masters\": []}, \"start\": \"935702528\", \"sectors\": \"1998848\", \"sectorsize\": 512, \"size\": \"976.00 MB\", \"uuid\": \"cca89e47-8d21-4513-b999-cdfe14b50261\", \"holders\": []}, \"sda1\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part1\", \"wwn-0x5002538c40704306-part1\"], \"uuids\": [\"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"], \"labels\": [], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"935698432\", \"sectorsize\": 512, \"size\": \"446.18 GB\", \"uuid\": \"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"937703088\", \"sectorsize\": \"512\", \"size\": \"447.13 GB\", \"host\": \"SATA controller: Intel Corporation C600/X79 series chipset 6-Port SATA AHCI Controller (rev 06)\", \"holders\": []}, \"loop5\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop3\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}}, \"ansible_device_links\": {\"ids\": {\"sdb1\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M-part1\", \"wwn-0x5002538f3124ba27-part1\"], \"sda1\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part1\", \"wwn-0x5002538c40704306-part1\"], \"sda5\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part5\", \"wwn-0x5002538c40704306-part5\"], \"sda2\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part2\", \"wwn-0x5002538c40704306-part2\"], \"sdb\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M\", \"wwn-0x5002538f3124ba27\"], \"sda\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405\", \"wwn-0x5002538c40704306\"], \"nvme0n1p1\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663-part1\", \"nvme-eui.cfe00003330eb300-part1\"], \"nvme0n1\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663\", \"nvme-eui.cfe00003330eb300\"]}, \"uuids\": {\"sdb1\": [\"56343601-6cad-43e4-9731-4a3cb497b138\"], \"sda1\": [\"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"], \"sda5\": [\"cca89e47-8d21-4513-b999-cdfe14b50261\"], \"nvme0n1p1\": [\"94b080ed-6a17-4855-bd88-8c54d6889274\"]}, \"labels\": {\"nvme0n1p1\": [\"datapartition\"]}, \"masters\": {}}, \"ansible_uptime_seconds\": 535079, \"ansible_lvm\": {\"lvs\": {}, \"vgs\": {}, \"pvs\": {}}, \"ansible_mounts\": [{\"mount\": \"/\", \"device\": \"/dev/sda1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime,errors=remount-ro\", \"size_total\": 471425163264, \"size_available\": 89854881792, \"block_size\": 4096, \"block_total\": 115094034, \"block_available\": 21937227, \"block_used\": 93156807, \"inode_total\": 29245440, \"inode_available\": 26441007, \"inode_used\": 2804433, \"uuid\": \"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"}, {\"mount\": \"/mnt/nvme\", \"device\": \"/dev/nvme0n1p1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime\", \"size_total\": 787474333696, \"size_available\": 180264976384, \"block_size\": 4096, \"block_total\": 192254476, \"block_available\": 44010004, \"block_used\": 148244472, \"inode_total\": 48840704, \"inode_available\": 48578425, \"inode_used\": 262279, \"uuid\": \"94b080ed-6a17-4855-bd88-8c54d6889274\"}, {\"mount\": \"/mnt/extrassd1\", \"device\": \"/dev/sdb1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime\", \"size_total\": 1967925780480, \"size_available\": 1803045367808, \"block_size\": 4096, \"block_total\": 480450630, \"block_available\": 440196623, \"block_used\": 40254007, \"inode_total\": 122101760, \"inode_available\": 122076003, \"inode_used\": 25757, \"uuid\": \"56343601-6cad-43e4-9731-4a3cb497b138\"}], \"ansible_env\": {\"LANGUAGE\": \"en_CA:en\", \"USER\": \"root\", \"SSH_CLIENT\": \"10.10.2.191 47600 22\", \"XDG_SESSION_TYPE\": \"tty\", \"SHLVL\": \"0\", \"MOTD_SHOWN\": \"pam\", \"HOME\": \"/root\", \"SSH_TTY\": \"/dev/pts/2\", \"DBUS_SESSION_BUS_ADDRESS\": \"unix:path=/run/user/0/bus\", \"LOGNAME\": \"root\", \"_\": \"/bin/sh\", \"XDG_SESSION_CLASS\": \"user\", \"TERM\": \"xterm-256color\", \"XDG_SESSION_ID\": \"1264\", \"PATH\": \"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/opt/minc/1.9.16/bin:/opt/minc/1.9.16/bin:/snap/bin\", \"XDG_RUNTIME_DIR\": \"/run/user/0\", \"LANG\": \"C\", \"SHELL\": \"/bin/bash\", \"PWD\": \"/root\", \"SSH_CONNECTION\": \"10.10.2.191 47600 132.207.65.211 22\", \"LC_ALL\": \"C\", \"LC_NUMERIC\": \"C\"}, \"ansible_local\": {}, \"ansible_iscsi_iqn\": \"iqn.1993-08.org.debian:01:77b474a5e64\", \"ansible_fips\": false, \"ansible_hostnqn\": \"\", \"ansible_apparmor\": {\"status\": \"enabled\"}, \"ansible_interfaces\": [\"lo\", \"docker0\", \"br-f7c61d2b8779\", \"eno1\", \"eno2\"], \"ansible_eno1\": {\"device\": \"eno1\", \"macaddress\": \"0c:c4:7a:f9:c0:86\", \"mtu\": 1500, \"active\": true, \"module\": \"igb\", \"type\": \"ether\", \"pciid\": \"0000:02:00.0\", \"speed\": 1000, \"promisc\": false, \"ipv4\": {\"address\": \"132.207.65.211\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\"}, \"ipv6\": [{\"address\": \"fe80::ec4:7aff:fef9:c086\", \"prefix\": \"64\", \"scope\": \"link\"}], \"ipv4_secondaries\": [{\"address\": \"132.207.65.216\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\"}], \"features\": {\"rx_checksumming\": \"on\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"off [fixed]\", \"tx_tcp_mangleid_segmentation\": \"off\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"on\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off\", \"receive_hashing\": \"on\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"on [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"off [fixed]\", \"netns_local\": \"off [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"off [fixed]\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"on\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_hardware\", \"tx_software\", \"rx_hardware\", \"rx_software\", \"software\", \"raw_hardware\"], \"hw_timestamp_filters\": [\"none\", \"all\"], \"phc_index\": 0}, \"ansible_docker0\": {\"device\": \"docker0\", \"macaddress\": \"02:42:72:c2:29:5a\", \"mtu\": 1500, \"active\": false, \"type\": \"bridge\", \"interfaces\": [], \"id\": \"8000.024272c2295a\", \"stp\": false, \"promisc\": false, \"ipv4\": {\"address\": \"172.17.0.1\", \"broadcast\": \"172.17.255.255\", \"netmask\": \"255.255.0.0\", \"network\": \"172.17.0.0\"}, \"ipv6\": [{\"address\": \"fe80::42:72ff:fec2:295a\", \"prefix\": \"64\", \"scope\": \"link\"}], \"features\": {\"rx_checksumming\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"off [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"on\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"on\", \"tx_fcoe_segmentation\": \"on\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"on\", \"tx_udp_segmentation\": \"on\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"on\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_br_f7c61d2b8779\": {\"device\": \"br-f7c61d2b8779\", \"macaddress\": \"02:42:0c:0c:33:2a\", \"mtu\": 1500, \"active\": false, \"type\": \"bridge\", \"interfaces\": [], \"id\": \"8000.02420c0c332a\", \"stp\": false, \"promisc\": false, \"ipv4\": {\"address\": \"172.20.0.1\", \"broadcast\": \"172.20.255.255\", \"netmask\": \"255.255.0.0\", \"network\": \"172.20.0.0\"}, \"features\": {\"rx_checksumming\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"off [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"on\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"on\", \"tx_fcoe_segmentation\": \"on\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"on\", \"tx_udp_segmentation\": \"on\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"on\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_eno2\": {\"device\": \"eno2\", \"macaddress\": \"0c:c4:7a:f9:c0:87\", \"mtu\": 1500, \"active\": false, \"module\": \"igb\", \"type\": \"ether\", \"pciid\": \"0000:02:00.1\", \"promisc\": false, \"features\": {\"rx_checksumming\": \"on\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"off [fixed]\", \"tx_tcp_mangleid_segmentation\": \"off\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"on\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off\", \"receive_hashing\": \"on\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"on [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"off [fixed]\", \"netns_local\": \"off [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"off [fixed]\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"on\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_hardware\", \"tx_software\", \"rx_hardware\", \"rx_software\", \"software\", \"raw_hardware\"], \"hw_timestamp_filters\": [\"none\", \"all\"], \"phc_index\": 1}, \"ansible_lo\": {\"device\": \"lo\", \"mtu\": 65536, \"active\": true, \"type\": \"loopback\", \"promisc\": false, \"ipv4\": {\"address\": \"127.0.0.1\", \"broadcast\": \"\", \"netmask\": \"255.0.0.0\", \"network\": \"127.0.0.0\"}, \"ipv6\": [{\"address\": \"::1\", \"prefix\": \"128\", \"scope\": \"host\"}], \"features\": {\"rx_checksumming\": \"on [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on [fixed]\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on [fixed]\", \"tx_scatter_gather_fraglist\": \"on [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"off [fixed]\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"on [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"off [fixed]\", \"tx_gre_csum_segmentation\": \"off [fixed]\", \"tx_ipxip4_segmentation\": \"off [fixed]\", \"tx_ipxip6_segmentation\": \"off [fixed]\", \"tx_udp_tnl_segmentation\": \"off [fixed]\", \"tx_udp_tnl_csum_segmentation\": \"off [fixed]\", \"tx_gso_partial\": \"off [fixed]\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off [fixed]\", \"loopback\": \"on [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_software\", \"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_default_ipv4\": {\"gateway\": \"132.207.65.1\", \"interface\": \"eno1\", \"address\": \"132.207.65.211\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\", \"macaddress\": \"0c:c4:7a:f9:c0:86\", \"mtu\": 1500, \"type\": \"ether\", \"alias\": \"eno1\"}, \"ansible_default_ipv6\": {}, \"ansible_all_ipv4_addresses\": [\"132.207.65.211\", \"132.207.65.216\", \"172.17.0.1\", \"172.20.0.1\"], \"ansible_all_ipv6_addresses\": [\"fe80::ec4:7aff:fef9:c086\", \"fe80::42:72ff:fec2:295a\"], \"ansible_pkg_mgr\": \"apt\", \"ansible_service_mgr\": \"systemd\", \"gather_subset\": [\"all\"], \"module_setup\": true}, \"invocation\": {\"module_args\": {\"gather_subset\": [\"all\"], \"gather_timeout\": 10, \"filter\": \"*\", \"fact_path\": \"/etc/ansible/facts.d\"}}}\\r\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to joplin.neuro.polymtl.ca closed.\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1623640140.599724-18782-50775521164141/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n[DEPRECATION WARNING]: Distribution ubuntu 20.04 on host joplin.neuro.polymtl.ca should use /usr/bin/python3, but is using /usr/bin/python for \r\nbackward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See \r\nhttps://docs.ansible.com/ansible/2.10/reference_appendices/interpreter_discovery.html for more information. This feature will be removed in version \r\n2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\nok: [joplin.neuro.polymtl.ca]\r\nMETA: ran handlers\r\n\r\nTASK [Create home folder upon login] *****************************************************************************************************************\r\ntask path: /home/kousu/src/neuropoly/computers/home.yml:4\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'/root\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676 `\" && echo ansible-tmp-1623640143.9771152-18797-70227815678676=\"` echo /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676 `\" ) && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'ansible-tmp-1623640143.9771152-18797-70227815678676=/root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /home/kousu/.local/lib/python3.6/site-packages/ansible/modules/lineinfile.py\r\n<joplin.neuro.polymtl.ca> PUT /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmpzmp5dtak TO /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/AnsiballZ_lineinfile.py\r\n<joplin.neuro.polymtl.ca> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 '[joplin.neuro.polymtl.ca]'\r\n<joplin.neuro.polymtl.ca> (0, b'sftp> put /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmpzmp5dtak /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/AnsiballZ_lineinfile.py\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Unrecognised server extension \"lsetstat@openssh.com\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/kousu/.ansible/tmp/ansible-local-18776hqvmb7oy/tmpzmp5dtak\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/AnsiballZ_lineinfile.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:23246\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 23246 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/ /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/AnsiballZ_lineinfile.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 -tt joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/AnsiballZ_lineinfile.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'\\r\\n{\"changed\": true, \"msg\": \"line added\", \"backup\": \"\", \"diff\": [{\"before\": \"#\\\\n# /etc/pam.d/common-session - session-related modules common to all services\\\\n#\\\\n# This file is included from other service-specific PAM config files,\\\\n# and should contain a list of modules that define tasks to be performed\\\\n# at the start and end of sessions of *any* kind (both interactive and\\\\n# non-interactive).\\\\n#\\\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\\\n# To take advantage of this, it is recommended that you configure any\\\\n# local modules either before or after the default block, and use\\\\n# pam-auth-update to manage selection of other modules.  See\\\\n# pam-auth-update(8) for details.\\\\n\\\\n# here are the per-package modules (the \\\\\"Primary\\\\\" block)\\\\nsession\\\\t[default=1]\\\\t\\\\t\\\\tpam_permit.so\\\\n# here\\'s the fallback if no module succeeds\\\\nsession\\\\trequisite\\\\t\\\\t\\\\tpam_deny.so\\\\n# prime the stack with a positive return value if there isn\\'t one already;\\\\n# this avoids us returning an error just because nothing sets a success code\\\\n# since the modules above will each just jump around\\\\nsession\\\\trequired\\\\t\\\\t\\\\tpam_permit.so\\\\n# The pam_umask module will set the umask according to the system default in\\\\n# /etc/login.defs and user settings, solving the problem of different\\\\n# umask settings with different shells, display managers, remote sessions etc.\\\\n# See \\\\\"man pam_umask\\\\\".\\\\nsession optional\\\\t\\\\t\\\\tpam_umask.so\\\\n# and here are more per-package modules (the \\\\\"Additional\\\\\" block)\\\\nsession\\\\trequired\\\\tpam_unix.so \\\\nsession\\\\toptional\\\\t\\\\t\\\\tpam_sss.so \\\\nsession\\\\toptional\\\\tpam_mount.so \\\\nsession\\\\toptional\\\\tpam_systemd.so \\\\n# end of pam-auth-update config\\\\n\", \"after\": \"#\\\\n# /etc/pam.d/common-session - session-related modules common to all services\\\\n#\\\\n# This file is included from other service-specific PAM config files,\\\\n# and should contain a list of modules that define tasks to be performed\\\\n# at the start and end of sessions of *any* kind (both interactive and\\\\n# non-interactive).\\\\n#\\\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\\\n# To take advantage of this, it is recommended that you configure any\\\\n# local modules either before or after the default block, and use\\\\n# pam-auth-update to manage selection of other modules.  See\\\\n# pam-auth-update(8) for details.\\\\n\\\\n# here are the per-package modules (the \\\\\"Primary\\\\\" block)\\\\nsession\\\\t[default=1]\\\\t\\\\t\\\\tpam_permit.so\\\\n# here\\'s the fallback if no module succeeds\\\\nsession\\\\trequisite\\\\t\\\\t\\\\tpam_deny.so\\\\n# prime the stack with a positive return value if there isn\\'t one already;\\\\n# this avoids us returning an error just because nothing sets a success code\\\\n# since the modules above will each just jump around\\\\nsession\\\\trequired\\\\t\\\\t\\\\tpam_permit.so\\\\n# The pam_umask module will set the umask according to the system default in\\\\n# /etc/login.defs and user settings, solving the problem of different\\\\n# umask settings with different shells, display managers, remote sessions etc.\\\\n# See \\\\\"man pam_umask\\\\\".\\\\nsession optional\\\\t\\\\t\\\\tpam_umask.so\\\\n# and here are more per-package modules (the \\\\\"Additional\\\\\" block)\\\\nsession\\\\trequired\\\\tpam_unix.so \\\\nsession\\\\toptional\\\\t\\\\t\\\\tpam_sss.so \\\\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\\\nsession\\\\toptional\\\\tpam_mount.so \\\\nsession\\\\toptional\\\\tpam_systemd.so \\\\n# end of pam-auth-update config\\\\n\", \"before_header\": \"/etc/pam.d/common-session (content)\", \"after_header\": \"/etc/pam.d/common-session (content)\"}, {\"before_header\": \"/etc/pam.d/common-session (file attributes)\", \"after_header\": \"/etc/pam.d/common-session (file attributes)\"}], \"invocation\": {\"module_args\": {\"path\": \"/etc/pam.d/common-session\", \"line\": \"session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\", \"regexp\": \"pam_mkhomedir.so\", \"insertbefore\": \"pam_mount.so\", \"state\": \"present\", \"backrefs\": false, \"create\": false, \"backup\": false, \"firstmatch\": false, \"unsafe_writes\": false, \"insertafter\": null, \"validate\": null, \"mode\": null, \"owner\": null, \"group\": null, \"seuser\": null, \"serole\": null, \"selevel\": null, \"setype\": null, \"attributes\": null}}}\\r\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to joplin.neuro.polymtl.ca closed.\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1623640143.9771152-18797-70227815678676/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n--- before: /etc/pam.d/common-session (content)\r\n+++ after: /etc/pam.d/common-session (content)\r\n@@ -28,6 +28,7 @@\r\n # and here are more per-package modules (the \"Additional\" block)\r\n session\trequired\tpam_unix.so \r\n session\toptional\t\t\tpam_sss.so \r\n+session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\n session\toptional\tpam_mount.so \r\n session\toptional\tpam_systemd.so \r\n # end of pam-auth-update config\r\n\r\nchanged: [joplin.neuro.polymtl.ca] => {\r\n    \"backup\": \"\",\r\n    \"changed\": true,\r\n    \"diff\": [\r\n        {\r\n            \"after\": \"#\\n# /etc/pam.d/common-session - session-related modules common to all services\\n#\\n# This file is included from other service-specific PAM config files,\\n# and should contain a list of modules that define tasks to be performed\\n# at the start and end of sessions of *any* kind (both interactive and\\n# non-interactive).\\n#\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\n# To take advantage of this, it is recommended that you configure any\\n# local modules either before or after the default block, and use\\n# pam-auth-update to manage selection of other modules.  See\\n# pam-auth-update(8) for details.\\n\\n# here are the per-package modules (the \\\"Primary\\\" block)\\nsession\\t[default=1]\\t\\t\\tpam_permit.so\\n# here's the fallback if no module succeeds\\nsession\\trequisite\\t\\t\\tpam_deny.so\\n# prime the stack with a positive return value if there isn't one already;\\n# this avoids us returning an error just because nothing sets a success code\\n# since the modules above will each just jump around\\nsession\\trequired\\t\\t\\tpam_permit.so\\n# The pam_umask module will set the umask according to the system default in\\n# /etc/login.defs and user settings, solving the problem of different\\n# umask settings with different shells, display managers, remote sessions etc.\\n# See \\\"man pam_umask\\\".\\nsession optional\\t\\t\\tpam_umask.so\\n# and here are more per-package modules (the \\\"Additional\\\" block)\\nsession\\trequired\\tpam_unix.so \\nsession\\toptional\\t\\t\\tpam_sss.so \\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\nsession\\toptional\\tpam_mount.so \\nsession\\toptional\\tpam_systemd.so \\n# end of pam-auth-update config\\n\",\r\n            \"after_header\": \"/etc/pam.d/common-session (content)\",\r\n            \"before\": \"#\\n# /etc/pam.d/common-session - session-related modules common to all services\\n#\\n# This file is included from other service-specific PAM config files,\\n# and should contain a list of modules that define tasks to be performed\\n# at the start and end of sessions of *any* kind (both interactive and\\n# non-interactive).\\n#\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\n# To take advantage of this, it is recommended that you configure any\\n# local modules either before or after the default block, and use\\n# pam-auth-update to manage selection of other modules.  See\\n# pam-auth-update(8) for details.\\n\\n# here are the per-package modules (the \\\"Primary\\\" block)\\nsession\\t[default=1]\\t\\t\\tpam_permit.so\\n# here's the fallback if no module succeeds\\nsession\\trequisite\\t\\t\\tpam_deny.so\\n# prime the stack with a positive return value if there isn't one already;\\n# this avoids us returning an error just because nothing sets a success code\\n# since the modules above will each just jump around\\nsession\\trequired\\t\\t\\tpam_permit.so\\n# The pam_umask module will set the umask according to the system default in\\n# /etc/login.defs and user settings, solving the problem of different\\n# umask settings with different shells, display managers, remote sessions etc.\\n# See \\\"man pam_umask\\\".\\nsession optional\\t\\t\\tpam_umask.so\\n# and here are more per-package modules (the \\\"Additional\\\" block)\\nsession\\trequired\\tpam_unix.so \\nsession\\toptional\\t\\t\\tpam_sss.so \\nsession\\toptional\\tpam_mount.so \\nsession\\toptional\\tpam_systemd.so \\n# end of pam-auth-update config\\n\",\r\n            \"before_header\": \"/etc/pam.d/common-session (content)\"\r\n        },\r\n        {\r\n            \"after_header\": \"/etc/pam.d/common-session (file attributes)\",\r\n            \"before_header\": \"/etc/pam.d/common-session (file attributes)\"\r\n        }\r\n    ],\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backrefs\": false,\r\n            \"backup\": false,\r\n            \"create\": false,\r\n            \"firstmatch\": false,\r\n            \"group\": null,\r\n            \"insertafter\": null,\r\n            \"insertbefore\": \"pam_mount.so\",\r\n            \"line\": \"session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"path\": \"/etc/pam.d/common-session\",\r\n            \"regexp\": \"pam_mkhomedir.so\",\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"state\": \"present\",\r\n            \"unsafe_writes\": false,\r\n            \"validate\": null\r\n        }\r\n    },\r\n    \"msg\": \"line added\"\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *******************************************************************************************************************************************\r\njoplin.neuro.polymtl.ca    : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\nIt succeeds, and a second run is idempotent, and produces correct results.\r\n\r\nHowever if I move the line to the bottom of the file, it should get pulled back up to before `pam_mount.so`, because that's what `insertbefore:` means. But it doesn't:\r\n\r\n```\r\n$ ssh root@joplin.neuro.polymtl.ca cat /etc/pam.d/common-session\r\n#\r\n# /etc/pam.d/common-session - session-related modules common to all services\r\n#\r\n# This file is included from other service-specific PAM config files,\r\n# and should contain a list of modules that define tasks to be performed\r\n# at the start and end of sessions of *any* kind (both interactive and\r\n# non-interactive).\r\n#\r\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\r\n# To take advantage of this, it is recommended that you configure any\r\n# local modules either before or after the default block, and use\r\n# pam-auth-update to manage selection of other modules.  See\r\n# pam-auth-update(8) for details.\r\n\r\n# here are the per-package modules (the \"Primary\" block)\r\nsession\t[default=1]\t\t\tpam_permit.so\r\n# here's the fallback if no module succeeds\r\nsession\trequisite\t\t\tpam_deny.so\r\n# prime the stack with a positive return value if there isn't one already;\r\n# this avoids us returning an error just because nothing sets a success code\r\n# since the modules above will each just jump around\r\nsession\trequired\t\t\tpam_permit.so\r\n# The pam_umask module will set the umask according to the system default in\r\n# /etc/login.defs and user settings, solving the problem of different\r\n# umask settings with different shells, display managers, remote sessions etc.\r\n# See \"man pam_umask\".\r\nsession optional\t\t\tpam_umask.so\r\n# and here are more per-package modules (the \"Additional\" block)\r\nsession\trequired\tpam_unix.so \r\nsession\toptional\t\t\tpam_sss.so \r\nsession\toptional\tpam_mount.so \r\nsession\toptional\tpam_systemd.so \r\n# end of pam-auth-update config\r\n#session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\n```\r\n\r\n```\r\n$ ansible-playbook -vvvv -u root -i joplin.neuro.polymtl.ca, --diff home.yml\r\nansible-playbook 2.10.8\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/kousu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/kousu/.local/lib/python3.6/site-packages/ansible\r\n  executable location = /home/kousu/.local/bin/ansible-playbook\r\n  python version = 3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed joplin.neuro.polymtl.ca, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/kousu/.local/lib/python3.6/site-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: home.yml ***********************************************************************************************************************************\r\nPositional arguments: home.yml\r\nverbosity: 4\r\nremote_user: root\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\ntags: ('all',)\r\ndiff: True\r\ninventory: ('joplin.neuro.polymtl.ca,',)\r\nforks: 5\r\n1 plays in home.yml\r\n\r\nPLAY [all] *******************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *******************************************************************************************************************************\r\ntask path: /home/kousu/src/neuropoly/computers/home.yml:2\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'/root\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206 `\" && echo ansible-tmp-1623640208.5303862-18847-78645902729206=\"` echo /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206 `\" ) && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'ansible-tmp-1623640208.5303862-18847-78645902729206=/root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> Attempting python interpreter discovery\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python\\n/usr/bin/python2.7\\n/usr/bin/python3\\n/usr/bin/python\\nENDFOUND\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'{\"platform_dist_result\": [], \"osrelease_content\": \"NAME=\\\\\"Ubuntu\\\\\"\\\\nVERSION=\\\\\"20.04.2 LTS (Focal Fossa)\\\\\"\\\\nID=ubuntu\\\\nID_LIKE=debian\\\\nPRETTY_NAME=\\\\\"Ubuntu 20.04.2 LTS\\\\\"\\\\nVERSION_ID=\\\\\"20.04\\\\\"\\\\nHOME_URL=\\\\\"https://www.ubuntu.com/\\\\\"\\\\nSUPPORT_URL=\\\\\"https://help.ubuntu.com/\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.launchpad.net/ubuntu/\\\\\"\\\\nPRIVACY_POLICY_URL=\\\\\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\\\\\"\\\\nVERSION_CODENAME=focal\\\\nUBUNTU_CODENAME=focal\\\\n\"}\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /home/kousu/.local/lib/python3.6/site-packages/ansible/modules/setup.py\r\n<joplin.neuro.polymtl.ca> PUT /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmpn07g0qpb TO /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/AnsiballZ_setup.py\r\n<joplin.neuro.polymtl.ca> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 '[joplin.neuro.polymtl.ca]'\r\n<joplin.neuro.polymtl.ca> (0, b'sftp> put /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmpn07g0qpb /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/AnsiballZ_setup.py\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Unrecognised server extension \"lsetstat@openssh.com\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmpn07g0qpb\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/AnsiballZ_setup.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:163840 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:10 O:196608 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:11 O:229376 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:12 O:262144 S:5986\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 131072\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 32768 bytes at 163840\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 10 32768 bytes at 196608\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 11 32768 bytes at 229376\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 12 5986 bytes at 262144\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/ /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 -tt joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'\\r\\n{\"ansible_facts\": {\"ansible_system\": \"Linux\", \"ansible_kernel\": \"5.4.0-74-generic\", \"ansible_kernel_version\": \"#83-Ubuntu SMP Sat May 8 02:35:39 UTC 2021\", \"ansible_machine\": \"x86_64\", \"ansible_python_version\": \"3.8.5\", \"ansible_fqdn\": \"joplin.neuro.polymtl.ca\", \"ansible_hostname\": \"joplin\", \"ansible_nodename\": \"joplin.neuro.polymtl.ca\", \"ansible_domain\": \"neuro.polymtl.ca\", \"ansible_userspace_bits\": \"64\", \"ansible_architecture\": \"x86_64\", \"ansible_userspace_architecture\": \"x86_64\", \"ansible_machine_id\": \"d5fa3cd8909746060f19a34b5afedd55\", \"ansible_lsb\": {\"id\": \"Ubuntu\", \"description\": \"Ubuntu 20.04.2 LTS\", \"release\": \"20.04\", \"codename\": \"focal\", \"major_release\": \"20\"}, \"ansible_user_id\": \"root\", \"ansible_user_uid\": 0, \"ansible_user_gid\": 0, \"ansible_user_gecos\": \"root\", \"ansible_user_dir\": \"/root\", \"ansible_user_shell\": \"/bin/bash\", \"ansible_real_user_id\": 0, \"ansible_effective_user_id\": 0, \"ansible_real_group_id\": 0, \"ansible_effective_group_id\": 0, \"ansible_is_chroot\": false, \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAPS+Rgj0Rx+Cl8k0sR/JsNuT+iuPKIbqusSWkT/vIWjtCA3w7KNZ6Xfq4QhMjcmlCkFE2kZZLtU8r+fguG9n0rbOLWPcwI8S1q/nHx5IdX5OxFDK4KOC8tglm69D7VY5k6mirsdHjTSN2bfZ51GCd3qnUrq7f7YhErguvu2orMCRAAAAFQD3j2SCxRgUMLj2FX9yp1PS0KXnjQAAAIEAntbcLy3u6+nxv3FZKw5AlJ7+8WWDRzFiZ1CwMIMU/sUSEIPsdmaG0EltQ/3Ki0X7fIb4BO9gAvfVkaoAL3abmWHs48XmJjH7RVrnEF8kjFH7lAexIzTjT2oipWHR5vl+mUM/iNQEBB8z8g9y8ZEcmPoXmtCWvDAkg/fwhTzf4QYAAACATcNpg1tAQ+LSBgAofJpgochYVIpyopDIhCm36c/93u0820HdaySMARIvWvVFuUdKjnatVp9axf16dp2oNz+KTj4XZEDilNtAbimXK/fGYLrDuxynTD9rhAf9VTLRNWfNGR5YYz6qR+G2m/P4J9KZDGhLnkivzOR4Y8jIzTG01Ww=\", \"ansible_ssh_host_key_dsa_public_keytype\": \"ssh-dss\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDFlxn8FpTI78+5AMgsDk9lpWn0HEQrZUnsiJbIIJuKomzAU6CoJlQYZQw/Rwjo8dBjTZz4rhLokiD/dogtSpBbhhl2nu1J3xGX5gT+Un1e1xgo1Gk4yJUo2hCEhWOsx6Xw5s7TmNvKMuXQ25o/ifk/XdZ3WUFrmKo+rnjaCaIGAfJ5ZQ065Qsv/+TNahNOYbeC9pia6YyQRXNXrhtpbnUyuHMwhrmrGVD7nUgD1Nob4VReWktEtccI/ukKv/DMQu/DxDdDZsvceeIgY2OyOA9OahPrAZcj/XIwO1U39Nuv72LNqdrMhZH4T81vcnjQqHincGzJ9WynKT/mIk1A2BvB\", \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLBFsDtdaFdeeA01YCN3pytojGjewWfYSQrTF4rfM024l+UOIb6u7fxyS0sf4mdS6k5fqmJvXKzGrzsMVXN978U=\", \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAINcjFQVMhSYBctMSjfyfRel+n3nvkWNKFdWCYs94ncwr\", \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_system_capabilities_enforced\": \"False\", \"ansible_system_capabilities\": [], \"ansible_fips\": false, \"ansible_virtualization_type\": \"kvm\", \"ansible_virtualization_role\": \"host\", \"ansible_distribution\": \"Ubuntu\", \"ansible_distribution_release\": \"focal\", \"ansible_distribution_version\": \"20.04\", \"ansible_distribution_major_version\": \"20\", \"ansible_distribution_file_path\": \"/etc/os-release\", \"ansible_distribution_file_variety\": \"Debian\", \"ansible_distribution_file_parsed\": true, \"ansible_os_family\": \"Debian\", \"ansible_python\": {\"version\": {\"major\": 3, \"minor\": 8, \"micro\": 5, \"releaselevel\": \"final\", \"serial\": 0}, \"version_info\": [3, 8, 5, \"final\", 0], \"executable\": \"/usr/bin/python\", \"has_sslcontext\": true, \"type\": \"cpython\"}, \"ansible_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinuz-5.4.0-74-generic\", \"root\": \"UUID=896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"ro\": true}, \"ansible_proc_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinuz-5.4.0-74-generic\", \"root\": \"UUID=896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"ro\": true}, \"ansible_fibre_channel_wwn\": [], \"ansible_env\": {\"LANGUAGE\": \"en_CA:en\", \"USER\": \"root\", \"SSH_CLIENT\": \"10.10.2.191 47600 22\", \"XDG_SESSION_TYPE\": \"tty\", \"SHLVL\": \"0\", \"MOTD_SHOWN\": \"pam\", \"HOME\": \"/root\", \"SSH_TTY\": \"/dev/pts/2\", \"DBUS_SESSION_BUS_ADDRESS\": \"unix:path=/run/user/0/bus\", \"LOGNAME\": \"root\", \"_\": \"/bin/sh\", \"XDG_SESSION_CLASS\": \"user\", \"TERM\": \"xterm-256color\", \"XDG_SESSION_ID\": \"1264\", \"PATH\": \"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/opt/minc/1.9.16/bin:/opt/minc/1.9.16/bin:/snap/bin\", \"XDG_RUNTIME_DIR\": \"/run/user/0\", \"LANG\": \"en_CA.UTF-8\", \"SHELL\": \"/bin/bash\", \"PWD\": \"/root\", \"SSH_CONNECTION\": \"10.10.2.191 47600 132.207.65.211 22\"}, \"ansible_iscsi_iqn\": \"iqn.1993-08.org.debian:01:77b474a5e64\", \"ansible_hostnqn\": \"\", \"ansible_date_time\": {\"year\": \"2021\", \"month\": \"06\", \"weekday\": \"Sunday\", \"weekday_number\": \"0\", \"weeknumber\": \"23\", \"day\": \"13\", \"hour\": \"23\", \"minute\": \"10\", \"second\": \"11\", \"epoch\": \"1623640211\", \"date\": \"2021-06-13\", \"time\": \"23:10:11\", \"iso8601_micro\": \"2021-06-14T03:10:11.943789Z\", \"iso8601\": \"2021-06-14T03:10:11Z\", \"iso8601_basic\": \"20210613T231011943789\", \"iso8601_basic_short\": \"20210613T231011\", \"tz\": \"EDT\", \"tz_offset\": \"-0400\"}, \"ansible_dns\": {\"nameservers\": [\"127.0.0.53\"], \"search\": [\"grames.polymtl.ca\"]}, \"ansible_local\": {}, \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_selinux_python_present\": false, \"ansible_apparmor\": {\"status\": \"enabled\"}, \"ansible_interfaces\": [\"eno2\", \"br-f7c61d2b8779\", \"docker0\", \"lo\", \"eno1\"], \"ansible_eno1\": {\"device\": \"eno1\", \"macaddress\": \"0c:c4:7a:f9:c0:86\", \"mtu\": 1500, \"active\": true, \"module\": \"igb\", \"type\": \"ether\", \"pciid\": \"0000:02:00.0\", \"speed\": 1000, \"promisc\": false, \"ipv4\": {\"address\": \"132.207.65.211\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\"}, \"ipv6\": [{\"address\": \"fe80::ec4:7aff:fef9:c086\", \"prefix\": \"64\", \"scope\": \"link\"}], \"ipv4_secondaries\": [{\"address\": \"132.207.65.216\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\"}], \"features\": {\"rx_checksumming\": \"on\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"off [fixed]\", \"tx_tcp_mangleid_segmentation\": \"off\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"on\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off\", \"receive_hashing\": \"on\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"on [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"off [fixed]\", \"netns_local\": \"off [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"off [fixed]\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"on\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_hardware\", \"tx_software\", \"rx_hardware\", \"rx_software\", \"software\", \"raw_hardware\"], \"hw_timestamp_filters\": [\"none\", \"all\"], \"phc_index\": 0}, \"ansible_docker0\": {\"device\": \"docker0\", \"macaddress\": \"02:42:72:c2:29:5a\", \"mtu\": 1500, \"active\": false, \"type\": \"bridge\", \"interfaces\": [], \"id\": \"8000.024272c2295a\", \"stp\": false, \"promisc\": false, \"ipv4\": {\"address\": \"172.17.0.1\", \"broadcast\": \"172.17.255.255\", \"netmask\": \"255.255.0.0\", \"network\": \"172.17.0.0\"}, \"ipv6\": [{\"address\": \"fe80::42:72ff:fec2:295a\", \"prefix\": \"64\", \"scope\": \"link\"}], \"features\": {\"rx_checksumming\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"off [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"on\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"on\", \"tx_fcoe_segmentation\": \"on\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"on\", \"tx_udp_segmentation\": \"on\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"on\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_br_f7c61d2b8779\": {\"device\": \"br-f7c61d2b8779\", \"macaddress\": \"02:42:0c:0c:33:2a\", \"mtu\": 1500, \"active\": false, \"type\": \"bridge\", \"interfaces\": [], \"id\": \"8000.02420c0c332a\", \"stp\": false, \"promisc\": false, \"ipv4\": {\"address\": \"172.20.0.1\", \"broadcast\": \"172.20.255.255\", \"netmask\": \"255.255.0.0\", \"network\": \"172.20.0.0\"}, \"features\": {\"rx_checksumming\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"off [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"on\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"on\", \"tx_fcoe_segmentation\": \"on\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"on\", \"tx_udp_segmentation\": \"on\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"on\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_eno2\": {\"device\": \"eno2\", \"macaddress\": \"0c:c4:7a:f9:c0:87\", \"mtu\": 1500, \"active\": false, \"module\": \"igb\", \"type\": \"ether\", \"pciid\": \"0000:02:00.1\", \"promisc\": false, \"features\": {\"rx_checksumming\": \"on\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on\", \"tx_scatter_gather_fraglist\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"off [fixed]\", \"tx_tcp_mangleid_segmentation\": \"off\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"on\", \"tx_vlan_offload\": \"on\", \"ntuple_filters\": \"off\", \"receive_hashing\": \"on\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"on [fixed]\", \"vlan_challenged\": \"off [fixed]\", \"tx_lockless\": \"off [fixed]\", \"netns_local\": \"off [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"on\", \"tx_gre_csum_segmentation\": \"on\", \"tx_ipxip4_segmentation\": \"on\", \"tx_ipxip6_segmentation\": \"on\", \"tx_udp_tnl_segmentation\": \"on\", \"tx_udp_tnl_csum_segmentation\": \"on\", \"tx_gso_partial\": \"on\", \"tx_sctp_segmentation\": \"off [fixed]\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"loopback\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"on\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_hardware\", \"tx_software\", \"rx_hardware\", \"rx_software\", \"software\", \"raw_hardware\"], \"hw_timestamp_filters\": [\"none\", \"all\"], \"phc_index\": 1}, \"ansible_lo\": {\"device\": \"lo\", \"mtu\": 65536, \"active\": true, \"type\": \"loopback\", \"promisc\": false, \"ipv4\": {\"address\": \"127.0.0.1\", \"broadcast\": \"\", \"netmask\": \"255.0.0.0\", \"network\": \"127.0.0.0\"}, \"ipv6\": [{\"address\": \"::1\", \"prefix\": \"128\", \"scope\": \"host\"}], \"features\": {\"rx_checksumming\": \"on [fixed]\", \"tx_checksumming\": \"on\", \"tx_checksum_ipv4\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on [fixed]\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"tx_checksum_sctp\": \"on [fixed]\", \"scatter_gather\": \"on\", \"tx_scatter_gather\": \"on [fixed]\", \"tx_scatter_gather_fraglist\": \"on [fixed]\", \"tcp_segmentation_offload\": \"on\", \"tx_tcp_segmentation\": \"on\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp_mangleid_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"generic_segmentation_offload\": \"on\", \"generic_receive_offload\": \"on\", \"large_receive_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"tx_vlan_offload\": \"off [fixed]\", \"ntuple_filters\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"highdma\": \"on [fixed]\", \"rx_vlan_filter\": \"off [fixed]\", \"vlan_challenged\": \"on [fixed]\", \"tx_lockless\": \"on [fixed]\", \"netns_local\": \"on [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"tx_gre_segmentation\": \"off [fixed]\", \"tx_gre_csum_segmentation\": \"off [fixed]\", \"tx_ipxip4_segmentation\": \"off [fixed]\", \"tx_ipxip6_segmentation\": \"off [fixed]\", \"tx_udp_tnl_segmentation\": \"off [fixed]\", \"tx_udp_tnl_csum_segmentation\": \"off [fixed]\", \"tx_gso_partial\": \"off [fixed]\", \"tx_sctp_segmentation\": \"on\", \"tx_esp_segmentation\": \"off [fixed]\", \"tx_udp_segmentation\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_nocache_copy\": \"off [fixed]\", \"loopback\": \"on [fixed]\", \"rx_fcs\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"l2_fwd_offload\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"esp_hw_offload\": \"off [fixed]\", \"esp_tx_csum_hw_offload\": \"off [fixed]\", \"rx_udp_tunnel_port_offload\": \"off [fixed]\", \"tls_hw_tx_offload\": \"off [fixed]\", \"tls_hw_rx_offload\": \"off [fixed]\", \"rx_gro_hw\": \"off [fixed]\", \"tls_hw_record\": \"off [fixed]\"}, \"timestamping\": [\"tx_software\", \"rx_software\", \"software\"], \"hw_timestamp_filters\": []}, \"ansible_default_ipv4\": {\"gateway\": \"132.207.65.1\", \"interface\": \"eno1\", \"address\": \"132.207.65.211\", \"broadcast\": \"132.207.65.255\", \"netmask\": \"255.255.255.0\", \"network\": \"132.207.65.0\", \"macaddress\": \"0c:c4:7a:f9:c0:86\", \"mtu\": 1500, \"type\": \"ether\", \"alias\": \"eno1\"}, \"ansible_default_ipv6\": {}, \"ansible_all_ipv4_addresses\": [\"132.207.65.211\", \"132.207.65.216\", \"172.17.0.1\", \"172.20.0.1\"], \"ansible_all_ipv6_addresses\": [\"fe80::ec4:7aff:fef9:c086\", \"fe80::42:72ff:fec2:295a\"], \"ansible_processor\": [\"0\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"1\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"2\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"3\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"4\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"5\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"6\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"7\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"8\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"9\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"10\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"11\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"12\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"13\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"14\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"15\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"16\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"17\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"18\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"19\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"20\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"21\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"22\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"23\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"24\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"25\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"26\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"27\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"28\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"29\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"30\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"31\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"32\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"33\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"34\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"35\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"36\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"37\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"38\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"39\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"40\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"41\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"42\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"43\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"44\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"45\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"46\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"47\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"48\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"49\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"50\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"51\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"52\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"53\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"54\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"55\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"56\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"57\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"58\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"59\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"60\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"61\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"62\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"63\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"64\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"65\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"66\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"67\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"68\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"69\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"70\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"71\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"72\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"73\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"74\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"75\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"76\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"77\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"78\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"79\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"80\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"81\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"82\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"83\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"84\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"85\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"86\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"87\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"88\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"89\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"90\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"91\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"92\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"93\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"94\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"95\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"96\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"97\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"98\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"99\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"100\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"101\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"102\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"103\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"104\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"105\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"106\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"107\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"108\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"109\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"110\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"111\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"112\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"113\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"114\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"115\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"116\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"117\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"118\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"119\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"120\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"121\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"122\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"123\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"124\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"125\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"126\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\", \"127\", \"GenuineIntel\", \"Intel(R) Xeon(R) CPU E7-4850 v4 @ 2.10GHz\"], \"ansible_processor_count\": 4, \"ansible_processor_cores\": 16, \"ansible_processor_threads_per_core\": 2, \"ansible_processor_vcpus\": 128, \"ansible_processor_nproc\": 128, \"ansible_memtotal_mb\": 257609, \"ansible_memfree_mb\": 146776, \"ansible_swaptotal_mb\": 975, \"ansible_swapfree_mb\": 963, \"ansible_memory_mb\": {\"real\": {\"total\": 257609, \"used\": 110833, \"free\": 146776}, \"nocache\": {\"free\": 251069, \"used\": 6540}, \"swap\": {\"total\": 975, \"free\": 963, \"used\": 12, \"cached\": 0}}, \"ansible_bios_date\": \"07/20/2018\", \"ansible_bios_vendor\": \"American Megatrends Inc.\", \"ansible_bios_version\": \"3.1\", \"ansible_board_asset_tag\": \"Default string\", \"ansible_board_name\": \"X10QBL-4\", \"ansible_board_serial\": \"OM176S013580\", \"ansible_board_vendor\": \"Supermicro\", \"ansible_board_version\": \"1.01\", \"ansible_chassis_asset_tag\": \"Default string\", \"ansible_chassis_serial\": \"0123456789\", \"ansible_chassis_vendor\": \"Supermicro\", \"ansible_chassis_version\": \"0123456789\", \"ansible_form_factor\": \"Main Server Chassis\", \"ansible_product_name\": \"Super Server\", \"ansible_product_serial\": \"0123456789\", \"ansible_product_uuid\": \"00000000-0000-0000-0000-0cc47af9c086\", \"ansible_product_version\": \"0123456789\", \"ansible_system_vendor\": \"Supermicro\", \"ansible_devices\": {\"loop1\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"nvme0n1\": {\"virtual\": 1, \"links\": {\"ids\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663\", \"nvme-eui.cfe00003330eb300\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": \"MTFDHAX800MCE-1AN1ZABYY\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"partitions\": {\"nvme0n1p1\": {\"links\": {\"ids\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663-part1\", \"nvme-eui.cfe00003330eb300-part1\"], \"uuids\": [\"94b080ed-6a17-4855-bd88-8c54d6889274\"], \"labels\": [\"datapartition\"], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"1562820608\", \"sectorsize\": 512, \"size\": \"745.21 GB\", \"uuid\": \"94b080ed-6a17-4855-bd88-8c54d6889274\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"none\", \"sectors\": \"1562824368\", \"sectorsize\": \"512\", \"size\": \"745.21 GB\", \"host\": \"Non-Volatile memory controller: Micron Technology Inc 9100 PRO NVMe SSD (rev 05)\", \"holders\": []}, \"sdb\": {\"virtual\": 1, \"links\": {\"ids\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M\", \"wwn-0x5002538f3124ba27\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": \"ATA\", \"model\": \"Samsung SSD 870\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"wwn\": \"0x5002538f3124ba27\", \"partitions\": {\"sdb1\": {\"links\": {\"ids\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M-part1\", \"wwn-0x5002538f3124ba27-part1\"], \"uuids\": [\"56343601-6cad-43e4-9731-4a3cb497b138\"], \"labels\": [], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"3907027120\", \"sectorsize\": 512, \"size\": \"1.82 TB\", \"uuid\": \"56343601-6cad-43e4-9731-4a3cb497b138\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"3907029168\", \"sectorsize\": \"512\", \"size\": \"1.82 TB\", \"host\": \"SATA controller: Intel Corporation C600/X79 series chipset 6-Port SATA AHCI Controller (rev 06)\", \"holders\": []}, \"loop6\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop4\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop2\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop0\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"4096\", \"partitions\": {}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop7\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"sda\": {\"virtual\": 1, \"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405\", \"wwn-0x5002538c40704306\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": \"ATA\", \"model\": \"SAMSUNG MZ7KM480\", \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"512\", \"wwn\": \"0x5002538c40704306\", \"partitions\": {\"sda2\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part2\", \"wwn-0x5002538c40704306-part2\"], \"uuids\": [], \"labels\": [], \"masters\": []}, \"start\": \"935702526\", \"sectors\": \"2\", \"sectorsize\": 512, \"size\": \"1.00 KB\", \"uuid\": null, \"holders\": []}, \"sda5\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part5\", \"wwn-0x5002538c40704306-part5\"], \"uuids\": [\"cca89e47-8d21-4513-b999-cdfe14b50261\"], \"labels\": [], \"masters\": []}, \"start\": \"935702528\", \"sectors\": \"1998848\", \"sectorsize\": 512, \"size\": \"976.00 MB\", \"uuid\": \"cca89e47-8d21-4513-b999-cdfe14b50261\", \"holders\": []}, \"sda1\": {\"links\": {\"ids\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part1\", \"wwn-0x5002538c40704306-part1\"], \"uuids\": [\"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"], \"labels\": [], \"masters\": []}, \"start\": \"2048\", \"sectors\": \"935698432\", \"sectorsize\": 512, \"size\": \"446.18 GB\", \"uuid\": \"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\", \"holders\": []}}, \"rotational\": \"0\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"937703088\", \"sectorsize\": \"512\", \"size\": \"447.13 GB\", \"host\": \"SATA controller: Intel Corporation C600/X79 series chipset 6-Port SATA AHCI Controller (rev 06)\", \"holders\": []}, \"loop5\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}, \"loop3\": {\"virtual\": 1, \"links\": {\"ids\": [], \"uuids\": [], \"labels\": [], \"masters\": []}, \"vendor\": null, \"model\": null, \"sas_address\": null, \"sas_device_handle\": null, \"removable\": \"0\", \"support_discard\": \"0\", \"partitions\": {}, \"rotational\": \"1\", \"scheduler_mode\": \"mq-deadline\", \"sectors\": \"0\", \"sectorsize\": \"512\", \"size\": \"0.00 Bytes\", \"host\": \"\", \"holders\": []}}, \"ansible_device_links\": {\"ids\": {\"sdb1\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M-part1\", \"wwn-0x5002538f3124ba27-part1\"], \"sda1\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part1\", \"wwn-0x5002538c40704306-part1\"], \"sda5\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part5\", \"wwn-0x5002538c40704306-part5\"], \"sda2\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405-part2\", \"wwn-0x5002538c40704306-part2\"], \"sdb\": [\"ata-Samsung_SSD_870_QVO_2TB_S5VWNJ0R215939M\", \"wwn-0x5002538f3124ba27\"], \"sda\": [\"ata-SAMSUNG_MZ7KM480HAHP-00005_S2HSNX0J700405\", \"wwn-0x5002538c40704306\"], \"nvme0n1p1\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663-part1\", \"nvme-eui.cfe00003330eb300-part1\"], \"nvme0n1\": [\"nvme-MTFDHAX800MCE-1AN1ZABYY_P61024020663\", \"nvme-eui.cfe00003330eb300\"]}, \"uuids\": {\"sdb1\": [\"56343601-6cad-43e4-9731-4a3cb497b138\"], \"sda1\": [\"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"], \"sda5\": [\"cca89e47-8d21-4513-b999-cdfe14b50261\"], \"nvme0n1p1\": [\"94b080ed-6a17-4855-bd88-8c54d6889274\"]}, \"labels\": {\"nvme0n1p1\": [\"datapartition\"]}, \"masters\": {}}, \"ansible_uptime_seconds\": 535148, \"ansible_lvm\": {\"lvs\": {}, \"vgs\": {}, \"pvs\": {}}, \"ansible_mounts\": [{\"mount\": \"/\", \"device\": \"/dev/sda1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime,errors=remount-ro\", \"size_total\": 471425163264, \"size_available\": 89854861312, \"block_size\": 4096, \"block_total\": 115094034, \"block_available\": 21937222, \"block_used\": 93156812, \"inode_total\": 29245440, \"inode_available\": 26441010, \"inode_used\": 2804430, \"uuid\": \"896bfa22-81c6-4e67-bcf2-e4845f7ffbcf\"}, {\"mount\": \"/mnt/nvme\", \"device\": \"/dev/nvme0n1p1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime\", \"size_total\": 787474333696, \"size_available\": 180264976384, \"block_size\": 4096, \"block_total\": 192254476, \"block_available\": 44010004, \"block_used\": 148244472, \"inode_total\": 48840704, \"inode_available\": 48578425, \"inode_used\": 262279, \"uuid\": \"94b080ed-6a17-4855-bd88-8c54d6889274\"}, {\"mount\": \"/mnt/extrassd1\", \"device\": \"/dev/sdb1\", \"fstype\": \"ext4\", \"options\": \"rw,relatime\", \"size_total\": 1967925780480, \"size_available\": 1803045367808, \"block_size\": 4096, \"block_total\": 480450630, \"block_available\": 440196623, \"block_used\": 40254007, \"inode_total\": 122101760, \"inode_available\": 122076003, \"inode_used\": 25757, \"uuid\": \"56343601-6cad-43e4-9731-4a3cb497b138\"}], \"ansible_service_mgr\": \"systemd\", \"ansible_pkg_mgr\": \"apt\", \"gather_subset\": [\"all\"], \"module_setup\": true}, \"invocation\": {\"module_args\": {\"gather_subset\": [\"all\"], \"gather_timeout\": 10, \"filter\": \"*\", \"fact_path\": \"/etc/ansible/facts.d\"}}}\\r\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to joplin.neuro.polymtl.ca closed.\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1623640208.5303862-18847-78645902729206/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n[DEPRECATION WARNING]: Distribution ubuntu 20.04 on host joplin.neuro.polymtl.ca should use /usr/bin/python3, but is using /usr/bin/python for \r\nbackward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See \r\nhttps://docs.ansible.com/ansible/2.10/reference_appendices/interpreter_discovery.html for more information. This feature will be removed in version \r\n2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.\r\nok: [joplin.neuro.polymtl.ca]\r\nMETA: ran handlers\r\n\r\nTASK [Create home folder upon login] *****************************************************************************************************************\r\ntask path: /home/kousu/src/neuropoly/computers/home.yml:4\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'/root\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710 `\" && echo ansible-tmp-1623640213.2737303-18858-218620143984710=\"` echo /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710 `\" ) && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'ansible-tmp-1623640213.2737303-18858-218620143984710=/root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /home/kousu/.local/lib/python3.6/site-packages/ansible/modules/lineinfile.py\r\n<joplin.neuro.polymtl.ca> PUT /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmp7avhjku4 TO /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/AnsiballZ_lineinfile.py\r\n<joplin.neuro.polymtl.ca> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 '[joplin.neuro.polymtl.ca]'\r\n<joplin.neuro.polymtl.ca> (0, b'sftp> put /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmp7avhjku4 /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/AnsiballZ_lineinfile.py\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug2: Unrecognised server extension \"lsetstat@openssh.com\"\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/kousu/.ansible/tmp/ansible-local-1884143urqdh_/tmp7avhjku4\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/AnsiballZ_lineinfile.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:23249\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 23249 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/ /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/AnsiballZ_lineinfile.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 -tt joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/AnsiballZ_lineinfile.py && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'\\r\\n{\"changed\": true, \"msg\": \"line replaced\", \"backup\": \"\", \"diff\": [{\"before\": \"#\\\\n# /etc/pam.d/common-session - session-related modules common to all services\\\\n#\\\\n# This file is included from other service-specific PAM config files,\\\\n# and should contain a list of modules that define tasks to be performed\\\\n# at the start and end of sessions of *any* kind (both interactive and\\\\n# non-interactive).\\\\n#\\\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\\\n# To take advantage of this, it is recommended that you configure any\\\\n# local modules either before or after the default block, and use\\\\n# pam-auth-update to manage selection of other modules.  See\\\\n# pam-auth-update(8) for details.\\\\n\\\\n# here are the per-package modules (the \\\\\"Primary\\\\\" block)\\\\nsession\\\\t[default=1]\\\\t\\\\t\\\\tpam_permit.so\\\\n# here\\'s the fallback if no module succeeds\\\\nsession\\\\trequisite\\\\t\\\\t\\\\tpam_deny.so\\\\n# prime the stack with a positive return value if there isn\\'t one already;\\\\n# this avoids us returning an error just because nothing sets a success code\\\\n# since the modules above will each just jump around\\\\nsession\\\\trequired\\\\t\\\\t\\\\tpam_permit.so\\\\n# The pam_umask module will set the umask according to the system default in\\\\n# /etc/login.defs and user settings, solving the problem of different\\\\n# umask settings with different shells, display managers, remote sessions etc.\\\\n# See \\\\\"man pam_umask\\\\\".\\\\nsession optional\\\\t\\\\t\\\\tpam_umask.so\\\\n# and here are more per-package modules (the \\\\\"Additional\\\\\" block)\\\\nsession\\\\trequired\\\\tpam_unix.so \\\\nsession\\\\toptional\\\\t\\\\t\\\\tpam_sss.so \\\\nsession\\\\toptional\\\\tpam_mount.so \\\\nsession\\\\toptional\\\\tpam_systemd.so \\\\n# end of pam-auth-update config\\\\n#session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\\\n\", \"after\": \"#\\\\n# /etc/pam.d/common-session - session-related modules common to all services\\\\n#\\\\n# This file is included from other service-specific PAM config files,\\\\n# and should contain a list of modules that define tasks to be performed\\\\n# at the start and end of sessions of *any* kind (both interactive and\\\\n# non-interactive).\\\\n#\\\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\\\n# To take advantage of this, it is recommended that you configure any\\\\n# local modules either before or after the default block, and use\\\\n# pam-auth-update to manage selection of other modules.  See\\\\n# pam-auth-update(8) for details.\\\\n\\\\n# here are the per-package modules (the \\\\\"Primary\\\\\" block)\\\\nsession\\\\t[default=1]\\\\t\\\\t\\\\tpam_permit.so\\\\n# here\\'s the fallback if no module succeeds\\\\nsession\\\\trequisite\\\\t\\\\t\\\\tpam_deny.so\\\\n# prime the stack with a positive return value if there isn\\'t one already;\\\\n# this avoids us returning an error just because nothing sets a success code\\\\n# since the modules above will each just jump around\\\\nsession\\\\trequired\\\\t\\\\t\\\\tpam_permit.so\\\\n# The pam_umask module will set the umask according to the system default in\\\\n# /etc/login.defs and user settings, solving the problem of different\\\\n# umask settings with different shells, display managers, remote sessions etc.\\\\n# See \\\\\"man pam_umask\\\\\".\\\\nsession optional\\\\t\\\\t\\\\tpam_umask.so\\\\n# and here are more per-package modules (the \\\\\"Additional\\\\\" block)\\\\nsession\\\\trequired\\\\tpam_unix.so \\\\nsession\\\\toptional\\\\t\\\\t\\\\tpam_sss.so \\\\nsession\\\\toptional\\\\tpam_mount.so \\\\nsession\\\\toptional\\\\tpam_systemd.so \\\\n# end of pam-auth-update config\\\\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\\\n\", \"before_header\": \"/etc/pam.d/common-session (content)\", \"after_header\": \"/etc/pam.d/common-session (content)\"}, {\"before_header\": \"/etc/pam.d/common-session (file attributes)\", \"after_header\": \"/etc/pam.d/common-session (file attributes)\"}], \"invocation\": {\"module_args\": {\"path\": \"/etc/pam.d/common-session\", \"line\": \"session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\", \"regexp\": \"pam_mkhomedir.so\", \"insertbefore\": \"pam_mount.so\", \"state\": \"present\", \"backrefs\": false, \"create\": false, \"backup\": false, \"firstmatch\": false, \"unsafe_writes\": false, \"insertafter\": null, \"validate\": null, \"mode\": null, \"owner\": null, \"group\": null, \"seuser\": null, \"serole\": null, \"selevel\": null, \"setype\": null, \"attributes\": null}}}\\r\\n', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to joplin.neuro.polymtl.ca closed.\\r\\n')\r\n<joplin.neuro.polymtl.ca> ESTABLISH SSH CONNECTION FOR USER: root\r\n<joplin.neuro.polymtl.ca> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/kousu/.ansible/cp/715ff11c12 joplin.neuro.polymtl.ca '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1623640213.2737303-18858-218620143984710/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<joplin.neuro.polymtl.ca> (0, b'', b'OpenSSH_7.6p1 Ubuntu-4ubuntu0.3, OpenSSL 1.0.2n  7 Dec 2017\\r\\ndebug1: Reading configuration data /home/kousu/.ssh/config\\r\\ndebug2: checking match for \\'Host romane,rosenberg,bireli\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 9: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host joplin,abbey,tristano,ferguson\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 13: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'Host data\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 17: not matched \\'Host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match not found\\r\\ndebug2: checking match for \\'host *.neuro.polymtl.ca\\' host joplin.neuro.polymtl.ca originally joplin.neuro.polymtl.ca\\r\\ndebug3: /home/kousu/.ssh/config line 23: matched \\'host \"joplin.neuro.polymtl.ca\"\\' \\r\\ndebug2: match found\\r\\ndebug1: /home/kousu/.ssh/config line 27: Applying options for *\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 18786\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n--- before: /etc/pam.d/common-session (content)\r\n+++ after: /etc/pam.d/common-session (content)\r\n@@ -31,4 +31,4 @@\r\n session\toptional\tpam_mount.so \r\n session\toptional\tpam_systemd.so \r\n # end of pam-auth-update config\r\n-#session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\n+session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\r\n\r\nchanged: [joplin.neuro.polymtl.ca] => {\r\n    \"backup\": \"\",\r\n    \"changed\": true,\r\n    \"diff\": [\r\n        {\r\n            \"after\": \"#\\n# /etc/pam.d/common-session - session-related modules common to all services\\n#\\n# This file is included from other service-specific PAM config files,\\n# and should contain a list of modules that define tasks to be performed\\n# at the start and end of sessions of *any* kind (both interactive and\\n# non-interactive).\\n#\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\n# To take advantage of this, it is recommended that you configure any\\n# local modules either before or after the default block, and use\\n# pam-auth-update to manage selection of other modules.  See\\n# pam-auth-update(8) for details.\\n\\n# here are the per-package modules (the \\\"Primary\\\" block)\\nsession\\t[default=1]\\t\\t\\tpam_permit.so\\n# here's the fallback if no module succeeds\\nsession\\trequisite\\t\\t\\tpam_deny.so\\n# prime the stack with a positive return value if there isn't one already;\\n# this avoids us returning an error just because nothing sets a success code\\n# since the modules above will each just jump around\\nsession\\trequired\\t\\t\\tpam_permit.so\\n# The pam_umask module will set the umask according to the system default in\\n# /etc/login.defs and user settings, solving the problem of different\\n# umask settings with different shells, display managers, remote sessions etc.\\n# See \\\"man pam_umask\\\".\\nsession optional\\t\\t\\tpam_umask.so\\n# and here are more per-package modules (the \\\"Additional\\\" block)\\nsession\\trequired\\tpam_unix.so \\nsession\\toptional\\t\\t\\tpam_sss.so \\nsession\\toptional\\tpam_mount.so \\nsession\\toptional\\tpam_systemd.so \\n# end of pam-auth-update config\\nsession required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\n\",\r\n            \"after_header\": \"/etc/pam.d/common-session (content)\",\r\n            \"before\": \"#\\n# /etc/pam.d/common-session - session-related modules common to all services\\n#\\n# This file is included from other service-specific PAM config files,\\n# and should contain a list of modules that define tasks to be performed\\n# at the start and end of sessions of *any* kind (both interactive and\\n# non-interactive).\\n#\\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\\n# To take advantage of this, it is recommended that you configure any\\n# local modules either before or after the default block, and use\\n# pam-auth-update to manage selection of other modules.  See\\n# pam-auth-update(8) for details.\\n\\n# here are the per-package modules (the \\\"Primary\\\" block)\\nsession\\t[default=1]\\t\\t\\tpam_permit.so\\n# here's the fallback if no module succeeds\\nsession\\trequisite\\t\\t\\tpam_deny.so\\n# prime the stack with a positive return value if there isn't one already;\\n# this avoids us returning an error just because nothing sets a success code\\n# since the modules above will each just jump around\\nsession\\trequired\\t\\t\\tpam_permit.so\\n# The pam_umask module will set the umask according to the system default in\\n# /etc/login.defs and user settings, solving the problem of different\\n# umask settings with different shells, display managers, remote sessions etc.\\n# See \\\"man pam_umask\\\".\\nsession optional\\t\\t\\tpam_umask.so\\n# and here are more per-package modules (the \\\"Additional\\\" block)\\nsession\\trequired\\tpam_unix.so \\nsession\\toptional\\t\\t\\tpam_sss.so \\nsession\\toptional\\tpam_mount.so \\nsession\\toptional\\tpam_systemd.so \\n# end of pam-auth-update config\\n#session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\\n\",\r\n            \"before_header\": \"/etc/pam.d/common-session (content)\"\r\n        },\r\n        {\r\n            \"after_header\": \"/etc/pam.d/common-session (file attributes)\",\r\n            \"before_header\": \"/etc/pam.d/common-session (file attributes)\"\r\n        }\r\n    ],\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backrefs\": false,\r\n            \"backup\": false,\r\n            \"create\": false,\r\n            \"firstmatch\": false,\r\n            \"group\": null,\r\n            \"insertafter\": null,\r\n            \"insertbefore\": \"pam_mount.so\",\r\n            \"line\": \"session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"path\": \"/etc/pam.d/common-session\",\r\n            \"regexp\": \"pam_mkhomedir.so\",\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"state\": \"present\",\r\n            \"unsafe_writes\": false,\r\n            \"validate\": null\r\n        }\r\n    },\r\n    \"msg\": \"line replaced\"\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *******************************************************************************************************************************************\r\njoplin.neuro.polymtl.ca    : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-14T03:21:45Z",
        "user": "kousu",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 74918,
        "title": "Ansible fails to recursively change attributes when directory contains symlinks",
        "body": "### Summary\r\n\r\nWhen i try to use `file` module to unset the immutable attribute on all files in directory, Ansible gives an error if there symlinks in the directory\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nfile\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible [core 2.11.1] \r\n  config file = /home/sashok724/Documents/Projects/Ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.9/site-packages/ansible\r\n  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.9.5 (default, May 24 2021, 12:50:35) [GCC 11.1.0]\r\n  jinja version = 3.0.1\r\n  libyaml = True\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANY_ERRORS_FATAL(/home/sashok724/Documents/Projects/Ansible/ansible.cfg) = True\r\nDEFAULT_FORKS(/home/sashok724/Documents/Projects/Ansible/ansible.cfg) = 10\r\nDEFAULT_TIMEOUT(/home/sashok724/Documents/Projects/Ansible/ansible.cfg) = 15\r\nINTERPRETER_PYTHON(/home/sashok724/Documents/Projects/Ansible/ansible.cfg) = auto_silent\r\nINVENTORY_UNPARSED_IS_FAILED(/home/sashok724/Documents/Projects/Ansible/ansible.cfg) = True\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nArch Linux x86_64\r\n\r\n### Steps to Reproduce\r\n\r\n```yaml\r\n- file: path=/root/testdir/ state=directory\r\n- file: path=/root/testdir/innerdir/ state=directory\r\n- file: dest=/root/testdir/innerdirsymlink src=innerdir state=link\r\n- copy: dest=/root/testdir/immutablefile content='' attr=i\r\n- file: path=/root/testdir/ state=directory attr=-i recurse=true follow=false # <--- fails here\r\n```\r\n\r\n### Expected Results\r\n\r\nPlaybook completes without errors, after playbook completion immutable attribute is not set on any files in the directory\r\n\r\n### Actual Results\r\n\r\n```console\r\nTASK [testrole : file] *******************************************************************************************************************************************************************************************************************************************************************************************************\r\ntask path: /home/sashok724/Documents/Projects/Ansible/roles/testrole/tasks/main.yml:5\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<localhost> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484 `\" && echo ansible-tmp-1622975254.2169983-549979-245538434772484=\"` echo /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.9/site-packages/ansible/modules/file.py\r\n<localhost> PUT /root/.ansible/tmp/ansible-local-549632xlhb73xa/tmp69oty30n TO /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484/AnsiballZ_file.py\r\n<localhost> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484/ /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484/AnsiballZ_file.py && sleep 0'\r\n<localhost> EXEC /bin/sh -c '/usr/bin/python /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484/AnsiballZ_file.py && sleep 0'\r\n<localhost> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1622975254.2169983-549979-245538434772484/ > /dev/null 2>&1 && sleep 0'\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/tmp/ansible_file_payload_y93w2yx_/ansible_file_payload.zip/ansible/module_utils/basic.py\", line 998, in set_attributes_if_different\r\n    raise Exception(\"Error while setting attributes: %s\" % (out + err))\r\nException: Error while setting attributes: /usr/bin/chattr: Operation not supported while reading flags on /root/testdir/innerdirsymlink\r\n\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"details\": \"Error while setting attributes: /usr/bin/chattr: Operation not supported while reading flags on /root/testdir/innerdirsymlink\\n\",\r\n    \"gid\": 0,\r\n    \"group\": \"root\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_diff_peek\": null,\r\n            \"_original_basename\": null,\r\n            \"access_time\": null,\r\n            \"access_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"attr\": \"-i\",\r\n            \"attributes\": \"-i\",\r\n            \"follow\": false,\r\n            \"force\": false,\r\n            \"group\": null,\r\n            \"mode\": null,\r\n            \"modification_time\": null,\r\n            \"modification_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"owner\": null,\r\n            \"path\": \"/root/testdir/\",\r\n            \"recurse\": true,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"state\": \"directory\",\r\n            \"unsafe_writes\": false\r\n        }\r\n    },\r\n    \"mode\": \"0777\",\r\n    \"msg\": \"chattr failed\",\r\n    \"owner\": \"root\",\r\n    \"path\": \"/root/testdir/innerdirsymlink\",\r\n    \"size\": 8,\r\n    \"state\": \"link\",\r\n    \"uid\": 0\r\n}\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-06T10:34:51Z",
        "user": "new-sashok724",
        "labels": [
            "module",
            "support:core",
            "bug",
            "traceback",
            "P3",
            "needs_verified",
            "affects_2.11",
            "affects_2.12"
        ]
    },
    {
        "number": 74871,
        "title": "builtin user module unable to add user to group on AIX",
        "body": "### Summary\n\nUsing the builtin user module I'm unable to add an user to an additional existing group on an AIX system. Probably related to usermod on AIX not supporting the -a switch?\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nuser\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.10.8\r\n  config file = None\r\n  configured module search path = ['/home/reichle/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\n$\n```\n\n\n### OS / Environment\n\nTestsystem is AIX 7.2, TL4 SP2, aka 7200-04-02-2016 using python3 from aixtools.\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n---\r\n- hosts: all\r\n\r\n  tasks:\r\n  - name: Ensure user is in the group for service 1\r\n    user:\r\n      name: \"reichle\"\r\n      groups: bckp_adm\r\n      append: yes\r\n\r\n  - name: Ensure user is in the group for service 2\r\n    user:\r\n      name: \"reichle\"\r\n      groups: unix_adm\r\n      append: yes\r\n```\r\n\n\n### Expected Results\n\nAfter the playbook is executed on the host, I would expect that user tolimar is member of both groups bckp_adm and unix_adm.\n\n### Actual Results\n\n```console\nUser should be part of both groups.\r\n\r\nFull debugg output follows:\r\nreichle@mqde01jump01:~/ansible$ ssh mqde01slestest01 id\r\nuid=1001(reichle) gid=1004(reichle)\r\nreichle@mqde01jump01:~/ansible$ ssh mqde01aixtest01 id\r\nuid=226(reichle) gid=213(reichle)\r\nreichle@mqde01jump01:~/ansible$ cat playbooks/group-test.yml\r\n---\r\n- hosts: mqde01aixtest01 mqde01slestest01\r\n\r\n  tasks:\r\n  - name: Ensure users are in the group for service 1\r\n    user:\r\n      name: \"reichle\"\r\n      groups: bckp_adm\r\n      append: yes\r\n\r\n  - name: Ensure users are in the group for service 2\r\n    user:\r\n      name: \"reichle\"\r\n      groups: unix_adm\r\n      append: yes\r\n\r\n\r\n\r\nreichle@mqde01jump01:~/ansible$ ansible-playbook -vvvv -u root playbooks/group-test.yml -i inventory/y_mqsn_server_provisioning_unix -l mqde01aixtest01,mqde01slestest01\r\nansible-playbook 2.10.8\r\n  config file = None\r\n  configured module search path = ['/home/reichle/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.7.3 (default, Jan 22 2021, 20:04:44) [GCC 8.3.0]\r\nNo config file found; using defaults\r\nsetting up inventory plugins\r\nhost_list declined parsing /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix as it did not pass its verify_file() method\r\nscript declined parsing /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix as it did not pass its verify_file() method\r\nauto declined parsing /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix as it did not pass its verify_file() method\r\ntoml declined parsing /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix as it did not pass its verify_file() method\r\n[WARNING]:  * Failed to parse /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix with yaml plugin: We were unable to read either as JSON nor YAML,\r\nthese are the errors we got from each: JSON: Expecting value: line 1 column 2 (char 1)  Syntax Error while loading YAML.   found unexpected ':'  The error appears\r\nto be in '/home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix': line 1, column 31, but may be elsewhere in the file depending on the exact syntax\r\nproblem.  The offending line appears to be:   [mqsn_server_provisioning_unix:children]                               ^ here\r\n  File \"/usr/lib/python3/dist-packages/ansible/inventory/manager.py\", line 289, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/inventory/yaml.py\", line 105, in parse\r\n    raise AnsibleParserError(e)\r\n[WARNING]:  * Failed to parse /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix with ini plugin:\r\n/home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix:13: Section [server_provisioning_unix_lnx:children] includes undefined group: lpars_lnx\r\n  File \"/usr/lib/python3/dist-packages/ansible/inventory/manager.py\", line 289, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3/dist-packages/ansible/plugins/inventory/ini.py\", line 138, in parse\r\n    raise AnsibleParserError(e)\r\n[WARNING]: Unable to parse /home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix as an inventory source\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python3/dist-packages/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: group-test.yml ******************************************************************************************************************************************\r\nPositional arguments: playbooks/group-test.yml\r\nverbosity: 4\r\nremote_user: root\r\nconnection: smart\r\ntimeout: 10\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/home/reichle/ansible/inventory/y_mqsn_server_provisioning_unix',)\r\nsubset: mqde01aixtest01,mqde01slestest01\r\nforks: 5\r\n1 plays in playbooks/group-test.yml\r\n\r\nPLAY [mqde01aixtest01 mqde01slestest01] ***************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************************\r\ntask path: /home/reichle/ansible/playbooks/group-test.yml:2\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/home/reichle/.ansible/cp/e8b693817a\" does not exist\\r\\ndebug2: resolving \"mqde01aixtest01\" port 22\\r\\ndebug2: ssh_connect_direct\\r\\ndebug1: Connecting to mqde01aixtest01 [10.10.1.86] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9986 ms remain after connect\\r\\ndebug1: identity file /home/reichle/.ssh/id_rsa type 0\\r\\ndebug1: identity file /home/reichle/.ssh/id_rsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_dsa type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_dsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ecdsa type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ed25519 type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ed25519-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_xmss type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_xmss-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.5\\r\\ndebug1: match: OpenSSH_7.5 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to mqde01aixtest01:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1720\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1721\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1728\\r\\ndebug3: load_hostkeys: loaded 3 keys from mqde01aixtest01\\r\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1\\r\\ndebug2: host key algorithms: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: curve25519-sha256\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:B+IXze63d0MbAFQ6dDbb806rm215gIRlLMVmkhxG3YI\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1720\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1721\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1728\\r\\ndebug3: load_hostkeys: loaded 3 keys from mqde01aixtest01\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1720\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1721\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1728\\r\\ndebug3: load_hostkeys: loaded 3 keys from 10.10.1.86\\r\\ndebug1: Host \\'mqde01aixtest01\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /etc/ssh/ssh_known_hosts:1721\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: Will attempt key: ed25519-key-20201016 ED25519 SHA256:f70acrIqp/DrsIhlkZw+GXd31OEcOwv+K8JEBUqkkhc agent\\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_dsa \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_ecdsa \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_ed25519 \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_xmss \\r\\ndebug2: pubkey_prepare: done\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,null>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\\r\\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: ed25519-key-20201016 ED25519 SHA256:f70acrIqp/DrsIhlkZw+GXd31OEcOwv+K8JEBUqkkhc agent\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\\r\\ndebug1: Offering public key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: sign_and_send_pubkey: RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: sign_and_send_pubkey: signing using rsa-sha2-512\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to mqde01aixtest01 ([10.10.1.86]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /home/reichle/.ansible/cp/e8b693817a.KrLYpfyarpcCHo1v\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/home/reichle/.ansible/cp/e8b693817a]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 5\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 15201\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 6 setting O_NONBLOCK\\r\\ndebug3: fd 6 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 6\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: mux_master_process_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: mux_master_process_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 100\\r\\ndebug2: mux_master_process_new_session: channel 1: request tty 0, X 1, agent 1, subsys 0, term \"screen-bce\", cmd \"/bin/sh -c \\'echo ~root && sleep 0\\'\", env 1\\r\\ndebug3: mux_master_process_new_session: got fds stdin 7, stdout 8, stderr 9\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug2: fd 9 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug2: x11_get_proto: /usr/bin/xauth  list unix:15.0 2>/dev/null\\r\\ndebug1: Requesting X11 forwarding with authentication spoofing.\\r\\ndebug2: channel 2: request x11-req confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Requesting authentication agent forwarding.\\r\\ndebug2: channel 2: request auth-agent-req@openssh.com confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = en_US.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo ~root && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: X11 forwarding request accepted on channel 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: channel 2: chan_shutdown_read (i0 o0 sock -1 wfd 7 efd 9 [write])\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: chan_shutdown_write (i3 o1 sock -1 wfd 8 efd 9 [write])\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: chan_shutdown_read (i0 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o1/0 e[closed]/0 fd 6/6/-1 sock 6 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 e[write]/0 fd -1/-1/9 sock -1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: chan_shutdown_write (i3 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o3/0 e[closed]/0 fd 6/6/-1 sock 6 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274 `\" && echo ansible-tmp-1622557598.9211342-15194-246725403533274=\"` echo /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274 `\" ) && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'ansible-tmp-1622557598.9211342-15194-246725403533274=/root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/setup.py\r\n<mqde01aixtest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp053_0hv5 TO /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/AnsiballZ_setup.py\r\n<mqde01aixtest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a '[mqde01aixtest01]'\r\n<mqde01aixtest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp053_0hv5 /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/AnsiballZ_setup.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp053_0hv5\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/AnsiballZ_setup.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:163840 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:10 O:196608 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:11 O:229376 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:12 O:262144 S:5989\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 131072\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 32768 bytes at 163840\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 10 32768 bytes at 196608\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 11 32768 bytes at 229376\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 12 5989 bytes at 262144\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/ /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a -tt mqde01aixtest01 '/bin/sh -c '\"'\"'/opt/bin/python3 /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/home/reichle/.ansible/cp/2ae36d0856\" does not exist\\r\\ndebug2: resolving \"mqde01slestest01\" port 22\\r\\ndebug2: ssh_connect_direct\\r\\ndebug1: Connecting to mqde01slestest01 [10.10.1.144] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9994 ms remain after connect\\r\\ndebug1: identity file /home/reichle/.ssh/id_rsa type 0\\r\\ndebug1: identity file /home/reichle/.ssh/id_rsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_dsa type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_dsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ecdsa type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ed25519 type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_ed25519-cert type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_xmss type -1\\r\\ndebug1: identity file /home/reichle/.ssh/id_xmss-cert type -1\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.2\\r\\ndebug1: match: OpenSSH_7.2 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to mqde01slestest01:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1663\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1664\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1665\\r\\ndebug3: load_hostkeys: loaded 3 keys from mqde01slestest01\\r\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1\\r\\ndebug2: host key algorithms: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ssh-dss,ecdsa-sha2-nistp256,ssh-ed25519\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: curve25519-sha256@libssh.org\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\r\\ndebug3: send packet: type 30\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:HovWp/YmWg9BMgO9sIzate89yY4Dcz8DHfvUyNflaGY\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1663\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1664\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1665\\r\\ndebug3: load_hostkeys: loaded 3 keys from mqde01slestest01\\r\\ndebug3: hostkeys_foreach: reading file \"/home/reichle/.ssh/known_hosts\"\\r\\ndebug3: hostkeys_foreach: reading file \"/etc/ssh/ssh_known_hosts\"\\r\\ndebug3: record_hostkey: found key type RSA in file /etc/ssh/ssh_known_hosts:1663\\r\\ndebug3: record_hostkey: found key type ECDSA in file /etc/ssh/ssh_known_hosts:1664\\r\\ndebug3: record_hostkey: found key type ED25519 in file /etc/ssh/ssh_known_hosts:1665\\r\\ndebug3: load_hostkeys: loaded 3 keys from 10.10.1.144\\r\\ndebug1: Host \\'mqde01slestest01\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /etc/ssh/ssh_known_hosts:1664\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey after 134217728 blocks\\r\\ndebug1: Will attempt key: ed25519-key-20201016 ED25519 SHA256:f70acrIqp/DrsIhlkZw+GXd31OEcOwv+K8JEBUqkkhc agent\\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_dsa \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_ecdsa \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_ed25519 \\r\\ndebug1: Will attempt key: /home/reichle/.ssh/id_xmss \\r\\ndebug2: pubkey_prepare: done\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 7\\r\\ndebug1: SSH2_MSG_EXT_INFO received\\r\\ndebug1: kex_input_ext_info: server-sig-algs=<rsa-sha2-256,rsa-sha2-512>\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,keyboard-interactive\\r\\ndebug3: start over, passed a different list publickey,keyboard-interactive\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering public key: ed25519-key-20201016 ED25519 SHA256:f70acrIqp/DrsIhlkZw+GXd31OEcOwv+K8JEBUqkkhc agent\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,keyboard-interactive\\r\\ndebug1: Offering public key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: /home/reichle/.ssh/id_rsa RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: sign_and_send_pubkey: RSA SHA256:qyfHkIY/tJOUzhpyOJThRGhMqZMWtcRFQRkDqsvBBp8\\r\\ndebug3: sign_and_send_pubkey: signing using rsa-sha2-512\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to mqde01slestest01 ([10.10.1.144]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /home/reichle/.ansible/cp/2ae36d0856.uccPIduwVDghTJmi\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/home/reichle/.ansible/cp/2ae36d0856]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 5\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 15198\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 6 setting O_NONBLOCK\\r\\ndebug3: fd 6 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 6\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: mux_master_process_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: mux_master_process_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 100\\r\\ndebug2: mux_master_process_new_session: channel 1: request tty 0, X 1, agent 1, subsys 0, term \"screen-bce\", cmd \"/bin/sh -c \\'echo ~root && sleep 0\\'\", env 1\\r\\ndebug3: mux_master_process_new_session: got fds stdin 7, stdout 8, stderr 9\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug2: fd 9 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 80\\r\\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback start\\r\\ndebug2: x11_get_proto: /usr/bin/xauth  list unix:15.0 2>/dev/null\\r\\ndebug1: Requesting X11 forwarding with authentication spoofing.\\r\\ndebug2: channel 2: request x11-req confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Requesting authentication agent forwarding.\\r\\ndebug2: channel 2: request auth-agent-req@openssh.com confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = en_US.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo ~root && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: channel_input_open_confirmation: channel 2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: X11 forwarding request accepted on channel 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: channel 2: chan_shutdown_read (i0 o0 sock -1 wfd 7 efd 9 [write])\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: chan_shutdown_write (i3 o1 sock -1 wfd 8 efd 9 [write])\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: chan_shutdown_read (i0 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o1/16 e[closed]/0 fd 6/6/-1 sock 6 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 e[write]/0 fd -1/-1/9 sock -1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: chan_shutdown_write (i3 o1 sock 6 wfd 6 efd -1 [closed])\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 nr0 i3/0 o3/0 e[closed]/0 fd 6/6/-1 sock 6 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151 `\" && echo ansible-tmp-1622557600.0660198-15195-120187924505151=\"` echo /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151 `\" ) && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'ansible-tmp-1622557600.0660198-15195-120187924505151=/root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> Attempting python interpreter discovery\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.9'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.8'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python\\n/usr/bin/python2.7\\n/usr/bin/python\\nENDFOUND\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'{\"osrelease_content\": \"NAME=\\\\\"SLES_SAP\\\\\"\\\\nVERSION=\\\\\"12-SP2\\\\\"\\\\nVERSION_ID=\\\\\"12.2\\\\\"\\\\nPRETTY_NAME=\\\\\"SUSE Linux Enterprise Server for SAP Applications 12 SP2\\\\\"\\\\nID=\\\\\"sles_sap\\\\\"\\\\nANSI_COLOR=\\\\\"0;32\\\\\"\\\\nCPE_NAME=\\\\\"cpe:/o:suse:sles_sap:12:sp2\\\\\"\\\\n\", \"platform_dist_result\": [\"SuSE\", \"12\", \"ppc64le\"]}\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> Python interpreter discovery fallback (unsupported Linux distribution: SuSE)\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/setup.py\r\n<mqde01slestest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpa_xy2jn8 TO /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/AnsiballZ_setup.py\r\n<mqde01slestest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 '[mqde01slestest01]'\r\n<mqde01slestest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpa_xy2jn8 /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/AnsiballZ_setup.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpa_xy2jn8\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/AnsiballZ_setup.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:9 O:163840 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:10 O:196608 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:11 O:229376 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:12 O:262144 S:5988\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 32768 bytes at 131072\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 9 32768 bytes at 163840\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 10 32768 bytes at 196608\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 11 32768 bytes at 229376\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 12 5988 bytes at 262144\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/ /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 -tt mqde01slestest01 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/AnsiballZ_setup.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'\\r\\n{\"invocation\": {\"module_args\": {\"filter\": \"*\", \"gather_subset\": [\"all\"], \"fact_path\": \"/etc/ansible/facts.d\", \"gather_timeout\": 10}}, \"ansible_facts\": {\"ansible_fibre_channel_wwn\": [], \"module_setup\": true, \"ansible_distribution_version\": \"12.2\", \"ansible_board_name\": \"NA\", \"ansible_distribution_file_variety\": \"SUSE\", \"ansible_env\": {\"LC_NUMERIC\": \"C\", \"CPU\": \"ppc64le\", \"JAVA_ROOT\": \"/usr/lib64/jvm/jre\", \"LIBGL_DEBUG\": \"quiet\", \"NO_PROXY\": \"localhost, 127.0.0.1\", \"http_proxy\": \"http://osde01proxy02.marquardt.de:8080\", \"CSHEDIT\": \"emacs\", \"HOSTTYPE\": \"ppc64le\", \"LESSOPEN\": \"lessopen.sh %s\", \"QT_SYSTEM_DIR\": \"/usr/share/desktop-data\", \"SSH_CLIENT\": \"10.10.1.24 40828 22\", \"LOGNAME\": \"root\", \"USER\": \"root\", \"INPUTRC\": \"/etc/inputrc\", \"HOME\": \"/root\", \"SOCKS_PROXY\": \"\", \"XKEYSYMDB\": \"/usr/X11R6/lib/X11/XKeysymDB\", \"SSH_CONNECTION\": \"10.10.1.24 40828 10.10.1.144 22\", \"LANG\": \"C\", \"TERM\": \"screen-bce\", \"SHELL\": \"/bin/bash\", \"SDL_AUDIODRIVER\": \"pulse\", \"SHLVL\": \"2\", \"XDG_SESSION_ID\": \"158814\", \"LESS\": \"-M -I -R\", \"G_BROKEN_FILENAMES\": \"1\", \"ALSA_CONFIG_PATH\": \"/etc/alsa-pulse.conf\", \"HISTSIZE\": \"1000\", \"https_proxy\": \"http://osde01proxy02.marquardt.de:8080\", \"LESS_ADVANCED_PREPROCESSOR\": \"no\", \"gopher_proxy\": \"\", \"MANPATH\": \"/usr/share/man:/usr/local/man\", \"OSTYPE\": \"linux\", \"JAVA_HOME\": \"/usr/lib64/jvm/jre\", \"PROFILEREAD\": \"true\", \"LC_ALL\": \"C\", \"SSH_AUTH_SOCK\": \"/tmp/ssh-wf13p9O2a3/agent.20520\", \"JAVA_BINDIR\": \"/usr/lib64/jvm/jre/bin\", \"XDG_RUNTIME_DIR\": \"/run/user/0\", \"NNTPSERVER\": \"news\", \"ftp_proxy\": \"http://osde01proxy02.marquardt.de:8080\", \"PATH\": \"/sbin:/usr/sbin:/usr/local/sbin:/root/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/games\", \"QEMU_AUDIO_DRV\": \"pa\", \"HOST\": \"mqde01slestest01\", \"JRE_HOME\": \"/usr/lib64/jvm/jre\", \"LESSKEY\": \"/etc/lesskey.bin\", \"socks_proxy\": \"\", \"GPG_TTY\": \"/dev/pts/0\", \"XNLSPATH\": \"/usr/share/X11/nls\", \"_\": \"/usr/bin/python\", \"SOCKS5_SERVER\": \"\", \"G_FILENAME_ENCODING\": \"@locale,UTF-8,ISO-8859-15,CP1252\", \"FROM_HEADER\": \"\", \"LESSCLOSE\": \"lessclose.sh %s %s\", \"XDG_CONFIG_DIRS\": \"/etc/xdg\", \"AUDIODRIVER\": \"pulseaudio\", \"PYTHONSTARTUP\": \"/etc/pythonstart\", \"SSH_TTY\": \"/dev/pts/0\", \"HOSTNAME\": \"mqde01slestest01\", \"WINDOWMANAGER\": \"/usr/bin/icewm-session\", \"SSH_SENDS_LOCALE\": \"yes\", \"no_proxy\": \"localhost, 127.0.0.1\", \"PWD\": \"/root\", \"MINICOM\": \"-c on\", \"COLORTERM\": \"1\", \"DISPLAY\": \"localhost:10.0\", \"MAIL\": \"/var/mail/root\", \"MACHTYPE\": \"ppc64le-suse-linux\", \"PAGER\": \"less\", \"XDG_DATA_DIRS\": \"/usr/share\", \"XAUTHLOCALHOSTNAME\": \"mqde01slestest01\", \"MORE\": \"-sl\"}, \"ansible_userspace_bits\": \"64\", \"ansible_architecture\": \"ppc64le\", \"ansible_default_ipv4\": {\"macaddress\": \"5a:eb:61:f1:f6:02\", \"network\": \"10.10.0.0\", \"mtu\": 1500, \"broadcast\": \"10.10.255.255\", \"alias\": \"eth0\", \"netmask\": \"255.255.0.0\", \"address\": \"10.10.1.144\", \"interface\": \"eth0\", \"type\": \"ether\", \"gateway\": \"10.10.0.1\"}, \"ansible_swapfree_mb\": 4031, \"ansible_default_ipv6\": {}, \"ansible_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinux-4.4.121-92.98-default\", \"transparent_hugepage\": \"never\", \"showopts\": true, \"elevator\": \"deadline\", \"quiet\": true, \"splash\": \"silent\", \"biosdevname\": \"0\", \"crashkernel\": \"524M-:262M\", \"root\": \"/dev/mapper/rootvg-lv_root\"}, \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_machine_id\": \"bcd30dfadb8d4978b973749970e9ed58\", \"ansible_product_uuid\": \"NA\", \"ansible_pkg_mgr\": \"zypper\", \"ansible_distribution\": \"SLES_SAP\", \"ansible_iscsi_iqn\": \"iqn.1996-04.de.suse:01:f9ffe7c5769d\", \"ansible_all_ipv6_addresses\": [\"fe80::58eb:61ff:fef1:f602\"], \"ansible_uptime_seconds\": 7187765, \"ansible_kernel\": \"4.4.121-92.98-default\", \"ansible_python\": {\"executable\": \"/usr/bin/python\", \"version\": {\"micro\": 13, \"major\": 2, \"releaselevel\": \"final\", \"serial\": 0, \"minor\": 7}, \"type\": \"CPython\", \"has_sslcontext\": true, \"version_info\": [2, 7, 13, \"final\", 0]}, \"ansible_is_chroot\": false, \"gather_subset\": [\"all\"], \"ansible_board_asset_tag\": \"NA\", \"ansible_user_shell\": \"/bin/bash\", \"ansible_product_serial\": \"NA\", \"ansible_form_factor\": \"NA\", \"ansible_distribution_file_parsed\": true, \"ansible_fips\": false, \"ansible_user_id\": \"root\", \"ansible_selinux_python_present\": false, \"ansible_board_serial\": \"NA\", \"ansible_kernel_version\": \"#1 SMP Fri Oct 19 07:52:13 UTC 2018 (e4d85ce)\", \"ansible_local\": {}, \"ansible_processor_vcpus\": 8, \"ansible_processor\": [\"0\", \"POWER8 (architected), altivec supported\", \"1\", \"POWER8 (architected), altivec supported\", \"2\", \"POWER8 (architected), altivec supported\", \"3\", \"POWER8 (architected), altivec supported\", \"4\", \"POWER8 (architected), altivec supported\", \"5\", \"POWER8 (architected), altivec supported\", \"6\", \"POWER8 (architected), altivec supported\", \"7\", \"POWER8 (architected), altivec supported\"], \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIgFo7lmNTHlgVGALoWM1t4pGRxF0EBeMi7ULAR6Evi21+CqSuIlRkgbdwhbkXv1vXU6xnk7EDHBQZsFq3jGDJw=\", \"ansible_user_gid\": 0, \"ansible_system_vendor\": \"NA\", \"ansible_swaptotal_mb\": 4031, \"ansible_distribution_major_version\": \"12\", \"ansible_real_group_id\": 0, \"ansible_lsb\": {}, \"ansible_machine\": \"ppc64le\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDUHn8SVOfmcjDBRo+zHQptjaerPyyOYP6M3CqhoGysYnVKYseD8SSciuLxB3MllxKRmZDtO8AZ3QEoGDZ9tseYblICQSPUVbtVVSLiTHBxSiBvqN5dYbrFp863DXQ7rVdo3nGi4iTvNIpdeQoNZ9otfIwF2zdiX/jcx+O/dg3L3j3IHpkg67045JKMPLXQUJE3mg8737AAJZIQDrWaOIs2aRlQVbu/t+HqDiBAj8QyuEKOBxQpnpja9+y0v3BJeqCcRWP8bYkCWkPnT40rm8NX4iMBA6bIef1lbuKJDoDK8BFsf1DUk7O0TgX9JIRGvUmlALpjQGzPgnwB5ONHjBKZ\", \"ansible_user_gecos\": \"root\", \"ansible_processor_threads_per_core\": 1, \"ansible_eth0\": {\"macaddress\": \"5a:eb:61:f1:f6:02\", \"features\": {\"tx_checksum_ipv4\": \"on\", \"generic_receive_offload\": \"on\", \"tx_checksum_ipv6\": \"on\", \"tx_scatter_gather_fraglist\": \"off [fixed]\", \"rx_all\": \"off [fixed]\", \"highdma\": \"off [fixed]\", \"rx_fcs\": \"off [fixed]\", \"tx_lockless\": \"off [fixed]\", \"tx_tcp_ecn_segmentation\": \"off [fixed]\", \"tx_tcp6_segmentation\": \"off [fixed]\", \"tx_gso_robust\": \"off [fixed]\", \"tx_ipip_segmentation\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"vlan_challenged\": \"off [fixed]\", \"loopback\": \"off [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_checksum_sctp\": \"off [fixed]\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"large_receive_offload\": \"off [fixed]\", \"tx_scatter_gather\": \"on\", \"rx_checksumming\": \"on\", \"tx_tcp_segmentation\": \"on\", \"netns_local\": \"off [fixed]\", \"busy_poll\": \"off [fixed]\", \"generic_segmentation_offload\": \"on\", \"tx_udp_tnl_segmentation\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"l2_fwd_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"ntuple_filters\": \"off [fixed]\", \"tx_vlan_offload\": \"off [fixed]\", \"tx_nocache_copy\": \"off\", \"udp_fragmentation_offload\": \"off [fixed]\", \"scatter_gather\": \"on\", \"tx_sit_segmentation\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"off [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"rx_vlan_filter\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"tx_gre_segmentation\": \"off [fixed]\"}, \"type\": \"ether\", \"pciid\": \"30000002\", \"module\": \"ibmveth\", \"mtu\": 1500, \"device\": \"eth0\", \"promisc\": false, \"timestamping\": [\"rx_software\", \"software\"], \"ipv4\": {\"broadcast\": \"10.10.255.255\", \"netmask\": \"255.255.0.0\", \"network\": \"10.10.0.0\", \"address\": \"10.10.1.144\"}, \"ipv6\": [{\"scope\": \"link\", \"prefix\": \"64\", \"address\": \"fe80::58eb:61ff:fef1:f602\"}], \"active\": true, \"speed\": 1000, \"hw_timestamp_filters\": []}, \"ansible_product_name\": \"NA\", \"ansible_processor_nproc\": 8, \"ansible_bios_vendor\": \"NA\", \"ansible_all_ipv4_addresses\": [\"10.10.1.144\"], \"ansible_python_version\": \"2.7.13\", \"ansible_product_version\": \"NA\", \"ansible_service_mgr\": \"systemd\", \"ansible_memory_mb\": {\"real\": {\"total\": 7874, \"used\": 2525, \"free\": 5349}, \"swap\": {\"cached\": 0, \"total\": 4031, \"free\": 4031, \"used\": 0}, \"nocache\": {\"used\": 836, \"free\": 7038}}, \"ansible_user_dir\": \"/root\", \"ansible_hostnqn\": \"\", \"ansible_real_user_id\": 0, \"ansible_virtualization_role\": \"NA\", \"ansible_dns\": {\"nameservers\": [\"10.10.1.37\", \"10.10.1.41\", \"10.96.7.10\"], \"search\": [\"marquardt.de\"], \"domain\": \"marquardt.de\", \"options\": {\"attempts\": \"2\"}}, \"ansible_effective_group_id\": 0, \"ansible_lo\": {\"features\": {\"tx_checksum_ipv4\": \"off [fixed]\", \"generic_receive_offload\": \"on\", \"tx_checksum_ipv6\": \"off [fixed]\", \"tx_scatter_gather_fraglist\": \"on [fixed]\", \"rx_all\": \"off [fixed]\", \"highdma\": \"on [fixed]\", \"rx_fcs\": \"off [fixed]\", \"tx_lockless\": \"on [fixed]\", \"tx_tcp_ecn_segmentation\": \"on\", \"tx_tcp6_segmentation\": \"on\", \"tx_gso_robust\": \"off [fixed]\", \"tx_ipip_segmentation\": \"off [fixed]\", \"tx_checksumming\": \"on\", \"vlan_challenged\": \"on [fixed]\", \"loopback\": \"on [fixed]\", \"fcoe_mtu\": \"off [fixed]\", \"tx_checksum_sctp\": \"on [fixed]\", \"tx_vlan_stag_hw_insert\": \"off [fixed]\", \"rx_vlan_stag_hw_parse\": \"off [fixed]\", \"rx_vlan_stag_filter\": \"off [fixed]\", \"large_receive_offload\": \"off [fixed]\", \"tx_scatter_gather\": \"on [fixed]\", \"rx_checksumming\": \"on [fixed]\", \"tx_tcp_segmentation\": \"on\", \"netns_local\": \"on [fixed]\", \"busy_poll\": \"off [fixed]\", \"generic_segmentation_offload\": \"on\", \"tx_udp_tnl_segmentation\": \"off [fixed]\", \"tcp_segmentation_offload\": \"on\", \"l2_fwd_offload\": \"off [fixed]\", \"rx_vlan_offload\": \"off [fixed]\", \"ntuple_filters\": \"off [fixed]\", \"tx_vlan_offload\": \"off [fixed]\", \"tx_nocache_copy\": \"off [fixed]\", \"udp_fragmentation_offload\": \"on\", \"scatter_gather\": \"on\", \"tx_sit_segmentation\": \"off [fixed]\", \"tx_checksum_fcoe_crc\": \"off [fixed]\", \"hw_tc_offload\": \"off [fixed]\", \"tx_checksum_ip_generic\": \"on [fixed]\", \"tx_fcoe_segmentation\": \"off [fixed]\", \"rx_vlan_filter\": \"off [fixed]\", \"receive_hashing\": \"off [fixed]\", \"tx_gre_segmentation\": \"off [fixed]\"}, \"hw_timestamp_filters\": [], \"mtu\": 65536, \"device\": \"lo\", \"promisc\": false, \"timestamping\": [\"rx_software\", \"software\"], \"ipv4\": {\"broadcast\": \"127.255.255.255\", \"netmask\": \"255.0.0.0\", \"network\": \"127.0.0.0\", \"address\": \"127.0.0.1\"}, \"ipv6\": [{\"scope\": \"host\", \"prefix\": \"128\", \"address\": \"::1\"}], \"active\": true, \"type\": \"loopback\"}, \"ansible_memtotal_mb\": 7874, \"ansible_device_links\": {\"masters\": {\"dm-0\": [\"dm-1\", \"dm-2\"], \"dm-2\": [\"dm-10\", \"dm-3\", \"dm-4\", \"dm-5\", \"dm-6\", \"dm-7\", \"dm-8\", \"dm-9\"], \"sda\": [\"dm-0\"], \"sdb\": [\"dm-0\"]}, \"labels\": {}, \"ids\": {\"dm-10\": [\"dm-name-rootvg-lv_var\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV60dKr63fBRHnFlxG3Nms8OiFrnf2aXvro\", \"raid-rootvg-lv_var\"], \"dm-8\": [\"dm-name-rootvg-lv_swap\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6jHXG7Ng8EE05Wi3bOOtrw37A2f4ZLb6s\", \"raid-rootvg-lv_swap\"], \"dm-9\": [\"dm-name-rootvg-lv_tmp\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6jE0rdfc7Tb0cZPo5xN9azfbiGpJwy1FV\", \"raid-rootvg-lv_tmp\"], \"dm-6\": [\"dm-name-rootvg-lv_homeroot\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6uhVYTIJXA06kHybLONV73HcHgFeWlmhS\", \"raid-rootvg-lv_homeroot\"], \"dm-7\": [\"dm-name-rootvg-lv_opt\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV64bUG89eGRdiZQbqPlCNadLu05I1oe6Gu\", \"raid-rootvg-lv_opt\"], \"dm-4\": [\"dm-name-rootvg-lv_usr\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6cGfxujOCvsLwwjiMNwKCtdxWD50gNuSs\", \"raid-rootvg-lv_usr\"], \"dm-5\": [\"dm-name-rootvg-lv_home\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV63iGpt4w1Oz9dT31hYrVd1GAqNAJEqYey\", \"raid-rootvg-lv_home\"], \"dm-2\": [\"dm-name-mpatha-part2\", \"dm-uuid-part2-mpath-360050768018087bef800000000000109\", \"lvm-pv-uuid-jCEP8c-r2DY-go6x-gnzt-ZHDT-DWUZ-lnzJAF\", \"scsi-360050768018087bef800000000000109-part2\", \"scsi-mpatha-part2\", \"wwn-0x60050768018087bef800000000000109-part2\"], \"dm-3\": [\"dm-name-rootvg-lv_root\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6ah3l6ErvO4SPNLpzrKlT1JvC378ikhz7\", \"raid-rootvg-lv_root\"], \"dm-0\": [\"dm-name-mpatha\", \"dm-uuid-mpath-360050768018087bef800000000000109\", \"scsi-360050768018087bef800000000000109\", \"scsi-mpatha\", \"wwn-0x60050768018087bef800000000000109\"], \"dm-1\": [\"dm-name-mpatha-part1\", \"dm-uuid-part1-mpath-360050768018087bef800000000000109\", \"scsi-360050768018087bef800000000000109-part1\", \"scsi-mpatha-part1\", \"wwn-0x60050768018087bef800000000000109-part1\"]}, \"uuids\": {\"dm-10\": [\"bddfd746-8626-4794-93a3-e80a3daaee22\"], \"dm-8\": [\"abce8fea-2220-48f2-b3e2-356bffe2b241\"], \"dm-9\": [\"730098f2-0eb4-42c3-95ea-75cc8c04f59f\"], \"dm-6\": [\"2d45c7b5-7ec8-4d84-9846-5a0a296765bc\"], \"dm-7\": [\"c2ce3e8c-b1a8-4531-a2a1-f10980eb54af\"], \"dm-4\": [\"2be8088f-8101-4e22-9d64-3a96db12f224\"], \"dm-5\": [\"1c0ef8f8-a7d3-43ea-a5b1-e93577cf52ec\"], \"dm-3\": [\"ff6c4ea7-b4ef-4065-9534-5eb8ae6834ac\"]}}, \"ansible_ssh_host_key_dsa_public_keytype\": \"ssh-dss\", \"ansible_apparmor\": {\"status\": \"enabled\"}, \"ansible_board_vendor\": \"NA\", \"ansible_bios_date\": \"NA\", \"ansible_memfree_mb\": 5349, \"ansible_board_version\": \"NA\", \"ansible_chassis_vendor\": \"NA\", \"ansible_processor_count\": 8, \"ansible_hostname\": \"mqde01slestest01\", \"ansible_interfaces\": [\"lo\", \"eth0\"], \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_fqdn\": \"mqde01slestest01\", \"ansible_mounts\": [{\"block_used\": 37844, \"uuid\": \"730098f2-0eb4-42c3-95ea-75cc8c04f59f\", \"size_total\": 2046640128, \"block_total\": 499668, \"mount\": \"/tmp\", \"block_available\": 461824, \"size_available\": 1891631104, \"fstype\": \"ext4\", \"inode_total\": 131072, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_tmp\", \"inode_used\": 164, \"block_size\": 4096, \"inode_available\": 130908}, {\"block_used\": 324358, \"uuid\": \"bddfd746-8626-4794-93a3-e80a3daaee22\", \"size_total\": 2046640128, \"block_total\": 499668, \"mount\": \"/var\", \"block_available\": 175310, \"size_available\": 718069760, \"fstype\": \"ext4\", \"inode_total\": 131072, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_var\", \"inode_used\": 2739, \"block_size\": 4096, \"inode_available\": 128333}, {\"block_used\": 17702, \"uuid\": \"1c0ef8f8-a7d3-43ea-a5b1-e93577cf52ec\", \"size_total\": 1023303680, \"block_total\": 249830, \"mount\": \"/home\", \"block_available\": 232128, \"size_available\": 950796288, \"fstype\": \"ext4\", \"inode_total\": 65536, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_home\", \"inode_used\": 189, \"block_size\": 4096, \"inode_available\": 65347}, {\"block_used\": 699971, \"uuid\": \"2be8088f-8101-4e22-9d64-3a96db12f224\", \"size_total\": 6207111168, \"block_total\": 1515408, \"mount\": \"/usr\", \"block_available\": 815437, \"size_available\": 3340029952, \"fstype\": \"ext4\", \"inode_total\": 393216, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_usr\", \"inode_used\": 85527, \"block_size\": 4096, \"inode_available\": 307689}, {\"block_used\": 172689, \"uuid\": \"ff6c4ea7-b4ef-4065-9534-5eb8ae6834ac\", \"size_total\": 2046640128, \"block_total\": 499668, \"mount\": \"/\", \"block_available\": 326979, \"size_available\": 1339305984, \"fstype\": \"ext4\", \"inode_total\": 131072, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_root\", \"inode_used\": 7168, \"block_size\": 4096, \"inode_available\": 123904}, {\"block_used\": 175371, \"uuid\": \"c2ce3e8c-b1a8-4531-a2a1-f10980eb54af\", \"size_total\": 1023303680, \"block_total\": 249830, \"mount\": \"/opt\", \"block_available\": 74459, \"size_available\": 304984064, \"fstype\": \"ext4\", \"inode_total\": 65536, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_opt\", \"inode_used\": 2644, \"block_size\": 4096, \"inode_available\": 62892}, {\"block_used\": 313174, \"uuid\": \"2d45c7b5-7ec8-4d84-9846-5a0a296765bc\", \"size_total\": 21003628544, \"block_total\": 5127839, \"mount\": \"/root\", \"block_available\": 4814665, \"size_available\": 19720867840, \"fstype\": \"ext4\", \"inode_total\": 1310720, \"options\": \"rw,relatime,data=ordered\", \"device\": \"/dev/mapper/rootvg-lv_homeroot\", \"inode_used\": 1268, \"block_size\": 4096, \"inode_available\": 1309452}], \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_nodename\": \"mqde01slestest01\", \"ansible_lvm\": {\"pvs\": {\"/dev/mapper/mpatha-part2\": {\"free_g\": \"12.03\", \"size_g\": \"49.97\", \"vg\": \"rootvg\"}}, \"lvs\": {\"lv_tmp\": {\"size_g\": \"2.00\", \"vg\": \"rootvg\"}, \"lv_var\": {\"size_g\": \"2.00\", \"vg\": \"rootvg\"}, \"lv_root\": {\"size_g\": \"2.00\", \"vg\": \"rootvg\"}, \"lv_homeroot\": {\"size_g\": \"20.00\", \"vg\": \"rootvg\"}, \"lv_home\": {\"size_g\": \"1.00\", \"vg\": \"rootvg\"}, \"lv_swap\": {\"size_g\": \"3.94\", \"vg\": \"rootvg\"}, \"lv_opt\": {\"size_g\": \"1.00\", \"vg\": \"rootvg\"}, \"lv_usr\": {\"size_g\": \"6.00\", \"vg\": \"rootvg\"}}, \"vgs\": {\"rootvg\": {\"free_g\": \"12.03\", \"size_g\": \"49.97\", \"num_lvs\": \"8\", \"num_pvs\": \"1\"}}}, \"ansible_domain\": \"\", \"ansible_distribution_file_path\": \"/etc/os-release\", \"ansible_virtualization_type\": \"NA\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAIACSupWOub221RMzZyPcqLyIUkvF0RH/IBWs/busWhdt\", \"ansible_processor_cores\": 1, \"ansible_chassis_serial\": \"NA\", \"ansible_bios_version\": \"NA\", \"ansible_date_time\": {\"weekday_number\": \"2\", \"iso8601_basic_short\": \"20210601T162640\", \"tz\": \"CEST\", \"weeknumber\": \"22\", \"hour\": \"16\", \"year\": \"2021\", \"minute\": \"26\", \"tz_offset\": \"+0200\", \"month\": \"06\", \"epoch\": \"1622557600\", \"iso8601_micro\": \"2021-06-01T14:26:40.845104Z\", \"weekday\": \"Tuesday\", \"time\": \"16:26:40\", \"date\": \"2021-06-01\", \"iso8601\": \"2021-06-01T14:26:40Z\", \"day\": \"01\", \"iso8601_basic\": \"20210601T162640845104\", \"second\": \"40\"}, \"ansible_distribution_release\": \"2\", \"ansible_os_family\": \"Suse\", \"ansible_effective_user_id\": 0, \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_system\": \"Linux\", \"ansible_devices\": {\"dm-10\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"4194304\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_var\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV60dKr63fBRHnFlxG3Nms8OiFrnf2aXvro\", \"raid-rootvg-lv_var\"], \"uuids\": [\"bddfd746-8626-4794-93a3-e80a3daaee22\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"2.00 GB\"}, \"dm-8\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"8257536\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_swap\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6jHXG7Ng8EE05Wi3bOOtrw37A2f4ZLb6s\", \"raid-rootvg-lv_swap\"], \"uuids\": [\"abce8fea-2220-48f2-b3e2-356bffe2b241\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"3.94 GB\"}, \"sda\": {\"scheduler_mode\": \"deadline\", \"rotational\": \"1\", \"vendor\": \"AIX\", \"sectors\": \"125829120\", \"links\": {\"masters\": [\"dm-0\"], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [\"mpatha\"], \"partitions\": {\"sda2\": {\"sectorsize\": 512, \"uuid\": null, \"links\": {\"masters\": [], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sectors\": \"104824832\", \"start\": \"32768\", \"holders\": [], \"size\": \"49.98 GB\"}, \"sda1\": {\"sectorsize\": 512, \"uuid\": null, \"links\": {\"masters\": [], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sectors\": \"13953\", \"start\": \"2048\", \"holders\": [], \"size\": \"6.81 MB\"}}, \"model\": \"VDASD\", \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"60.00 GB\"}, \"sdb\": {\"scheduler_mode\": \"deadline\", \"rotational\": \"1\", \"vendor\": \"AIX\", \"sectors\": \"125829120\", \"links\": {\"masters\": [\"dm-0\"], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [\"mpatha\"], \"partitions\": {\"sdb2\": {\"sectorsize\": 512, \"uuid\": null, \"links\": {\"masters\": [], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sectors\": \"104824832\", \"start\": \"32768\", \"holders\": [], \"size\": \"49.98 GB\"}, \"sdb1\": {\"sectorsize\": 512, \"uuid\": null, \"links\": {\"masters\": [], \"labels\": [], \"ids\": [], \"uuids\": []}, \"sectors\": \"13953\", \"start\": \"2048\", \"holders\": [], \"size\": \"6.81 MB\"}}, \"model\": \"VDASD\", \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"60.00 GB\"}, \"dm-9\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"4194304\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_tmp\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6jE0rdfc7Tb0cZPo5xN9azfbiGpJwy1FV\", \"raid-rootvg-lv_tmp\"], \"uuids\": [\"730098f2-0eb4-42c3-95ea-75cc8c04f59f\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"2.00 GB\"}, \"dm-6\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"41943040\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_homeroot\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6uhVYTIJXA06kHybLONV73HcHgFeWlmhS\", \"raid-rootvg-lv_homeroot\"], \"uuids\": [\"2d45c7b5-7ec8-4d84-9846-5a0a296765bc\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"model\": null, \"partitions\": {}, \"holders\": [], \"size\": \"20.00 GB\"}, \"dm-7\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"2097152\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_opt\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV64bUG89eGRdiZQbqPlCNadLu05I1oe6Gu\", \"raid-rootvg-lv_opt\"], \"uuids\": [\"c2ce3e8c-b1a8-4531-a2a1-f10980eb54af\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"1.00 GB\"}, \"dm-4\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"12582912\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_usr\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6cGfxujOCvsLwwjiMNwKCtdxWD50gNuSs\", \"raid-rootvg-lv_usr\"], \"uuids\": [\"2be8088f-8101-4e22-9d64-3a96db12f224\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"6.00 GB\"}, \"dm-5\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"2097152\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_home\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV63iGpt4w1Oz9dT31hYrVd1GAqNAJEqYey\", \"raid-rootvg-lv_home\"], \"uuids\": [\"1c0ef8f8-a7d3-43ea-a5b1-e93577cf52ec\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"1.00 GB\"}, \"dm-2\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"104824832\", \"links\": {\"masters\": [\"dm-10\", \"dm-3\", \"dm-4\", \"dm-5\", \"dm-6\", \"dm-7\", \"dm-8\", \"dm-9\"], \"labels\": [], \"ids\": [\"dm-name-mpatha-part2\", \"dm-uuid-part2-mpath-360050768018087bef800000000000109\", \"lvm-pv-uuid-jCEP8c-r2DY-go6x-gnzt-ZHDT-DWUZ-lnzJAF\", \"scsi-360050768018087bef800000000000109-part2\", \"scsi-mpatha-part2\", \"wwn-0x60050768018087bef800000000000109-part2\"], \"uuids\": []}, \"partitions\": {}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [\"rootvg-lv_root\", \"rootvg-lv_usr\", \"rootvg-lv_home\", \"rootvg-lv_homeroot\", \"rootvg-lv_opt\", \"rootvg-lv_swap\", \"rootvg-lv_tmp\", \"rootvg-lv_var\"], \"wwn\": \"0x60050768018087bef800000000000109-part2\", \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"49.98 GB\"}, \"dm-3\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"4194304\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-rootvg-lv_root\", \"dm-uuid-LVM-kdeOnry29fg4fbyBsFBVN3tdQfUzYMV6ah3l6ErvO4SPNLpzrKlT1JvC378ikhz7\", \"raid-rootvg-lv_root\"], \"uuids\": [\"ff6c4ea7-b4ef-4065-9534-5eb8ae6834ac\"]}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"partitions\": {}, \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"2.00 GB\"}, \"dm-0\": {\"scheduler_mode\": \"deadline\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"125829120\", \"links\": {\"masters\": [\"dm-1\", \"dm-2\"], \"labels\": [], \"ids\": [\"dm-name-mpatha\", \"dm-uuid-mpath-360050768018087bef800000000000109\", \"scsi-360050768018087bef800000000000109\", \"scsi-mpatha\", \"wwn-0x60050768018087bef800000000000109\"], \"uuids\": []}, \"partitions\": {}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [\"mpatha-part1\", \"mpatha-part2\"], \"wwn\": \"0x60050768018087bef800000000000109\", \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"60.00 GB\"}, \"dm-1\": {\"scheduler_mode\": \"\", \"rotational\": \"1\", \"vendor\": null, \"sectors\": \"13953\", \"links\": {\"masters\": [], \"labels\": [], \"ids\": [\"dm-name-mpatha-part1\", \"dm-uuid-part1-mpath-360050768018087bef800000000000109\", \"scsi-360050768018087bef800000000000109-part1\", \"scsi-mpatha-part1\", \"wwn-0x60050768018087bef800000000000109-part1\"], \"uuids\": []}, \"partitions\": {}, \"sas_device_handle\": null, \"sas_address\": null, \"virtual\": 1, \"host\": \"\", \"sectorsize\": \"512\", \"removable\": \"0\", \"support_discard\": \"0\", \"holders\": [], \"wwn\": \"0x60050768018087bef800000000000109-part1\", \"model\": null, \"serial\": \"3321360050768018087BEF80000000000010904214503IBMfcp\", \"size\": \"6.81 MB\"}}, \"ansible_user_uid\": 0, \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAKhowN/JsmigVrJSRV20Y3NpydvMRcEvs0hZ4KptWuNeRF6fEDLLxgB4/LiRltQKmJ7Vi0g8Nle0q2xDWJA2vFP+aFn7st3cRTwyG69AhMul00PgZCSNONpyQzLhaCl/u4qskDwI4Fc8jW4laU/WAOv370r1U4EpAB3fhauyqYNnAAAAFQDeiXAaF7WSVD+R04rIXKUJGy7nLQAAAIAF9PRFrrLYG8timjrRmXkIV8l1SR6FW8+JI3tFxS8/usTqFmt0yoNiZmme/gPA1dOzmuynSxzs4rqJf7LJqCFoJzp9eJEmPEYW+34k4VEfSXDSx1Y5QGeO0VSeBQyFF4GTn8a7Cbaf6o2nEhmFR5jjxXsPwCViTi+Lvyx0exGNuwAAAIAnGOX49vqn7o/Pr2SbKk25skOPDzf10WUAWLI/+Sqops8tb08NGn6q4JVG328yh6X1YYJMQhaepn1cFGCLEBwVbdEHGt+d66/B+JpZxMgwO+d8eX5xleuPz9u03peNyGjot+4RvJrX3BKI8ihhDjVZ8Tk1CSe3f0uQY0OX1NCcyQ==\", \"ansible_proc_cmdline\": {\"BOOT_IMAGE\": \"/boot/vmlinux-4.4.121-92.98-default\", \"transparent_hugepage\": \"never\", \"showopts\": true, \"elevator\": \"deadline\", \"quiet\": true, \"splash\": \"silent\", \"biosdevname\": \"0\", \"crashkernel\": \"524M-:262M\", \"root\": \"/dev/mapper/rootvg-lv_root\"}, \"ansible_chassis_version\": \"NA\", \"ansible_chassis_asset_tag\": \"NA\"}}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01slestest01 closed.\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557600.0660198-15195-120187924505151/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n[WARNING]: Platform linux on host mqde01slestest01 is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python\r\ninterpreter could change the meaning of that path. See https://docs.ansible.com/ansible/2.10/reference_appendices/interpreter_discovery.html for more information.\r\nok: [mqde01slestest01]\r\n<mqde01aixtest01> (0, b'\\r\\n{\"ansible_facts\": {\"ansible_distribution\": \"AIX\", \"ansible_distribution_release\": \"2\", \"ansible_distribution_version\": \"7.2\", \"ansible_distribution_major_version\": \"7\", \"ansible_os_family\": \"AIX\", \"ansible_is_chroot\": false, \"ansible_env\": {\"_\": \"/opt/bin/python3\", \"LANG\": \"en_US\", \"LOGIN\": \"root\", \"SSH_TTY\": \"/dev/pts/0\", \"CLCMD_PASSTHRU\": \"1\", \"PATH\": \"/usr/bin:/etc:/usr/sbin:/usr/ucb:/usr/bin/X11:/sbin:/usr/java7_64/jre/bin:/usr/java7_64/bin\", \"LC__FASTMSG\": \"true\", \"SSH_AUTH_SOCK\": \"/tmp/ssh-zilhAnrZ1J/agent.9437474\", \"LOGNAME\": \"root\", \"MAIL\": \"/var/spool/mail/root\", \"LOCPATH\": \"/usr/lib/nls/loc\", \"USER\": \"root\", \"AUTHSTATE\": \"compat\", \"DISPLAY\": \"localhost:10.0\", \"SHELL\": \"/usr/bin/ksh\", \"ODMDIR\": \"/etc/objrepos\", \"HOME\": \"/root\", \"SSH_CLIENT\": \"10.10.1.24 50594 22\", \"SSH_CONNECTION\": \"10.10.1.24 50594 10.10.1.86 22\", \"TERM\": \"screen-bce\", \"PWD\": \"/root\", \"TZ\": \"Europe/Berlin\", \"NLSPATH\": \"/usr/lib/nls/msg/%L/%N:/usr/lib/nls/msg/%L/%N.cat:/usr/lib/nls/msg/%l.%c/%N:/usr/lib/nls/msg/%l.%c/%N.cat\"}, \"ansible_python\": {\"version\": {\"major\": 3, \"minor\": 7, \"micro\": 4, \"releaselevel\": \"final\", \"serial\": 0}, \"version_info\": [3, 7, 4, \"final\", 0], \"executable\": \"/opt/bin/python3\", \"has_sslcontext\": true, \"type\": \"cpython\"}, \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_selinux_python_present\": false, \"ansible_hostnqn\": \"\", \"ansible_user_id\": \"root\", \"ansible_user_uid\": 0, \"ansible_user_gid\": 0, \"ansible_user_gecos\": \"\", \"ansible_user_dir\": \"/root\", \"ansible_user_shell\": \"/usr/bin/ksh\", \"ansible_real_user_id\": 0, \"ansible_effective_user_id\": 0, \"ansible_real_group_id\": 0, \"ansible_effective_group_id\": 0, \"ansible_fibre_channel_wwn\": [], \"ansible_virtualization_type\": \"\", \"ansible_virtualization_role\": \"\", \"ansible_interfaces\": [\"en0\", \"lo0\"], \"ansible_en0\": {\"device\": \"en0\", \"ipv4\": [{\"address\": \"10.10.1.86\", \"netmask\": \"255.255.0.0\", \"network\": \"10.10.0.0\", \"broadcast\": \"10.10.255.255\"}], \"ipv6\": [], \"type\": \"ether\", \"flags\": [\"UP\", \"BROADCAST\", \"NOTRAILERS\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"CHECKSUM_OFFLOAD(ACTIVE)\", \"LARGESEND\", \"CHAIN\"], \"macaddress\": \"7a:9c:40:85:14:02\", \"mtu\": \"1500\"}, \"ansible_lo0\": {\"device\": \"lo0\", \"ipv4\": [{\"address\": \"127.0.0.1\", \"netmask\": \"255.0.0.0\", \"network\": \"127.0.0.0\", \"broadcast\": \"127.255.255.255\"}], \"ipv6\": [{\"address\": \"::1%1\", \"prefix\": \"64\"}], \"type\": \"unknown\", \"flags\": [\"UP\", \"BROADCAST\", \"LOOPBACK\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"LARGESEND\", \"CHAIN\"], \"macaddress\": \"unknown\", \"mtu\": \"16896\"}, \"ansible_default_ipv4\": {\"gateway\": \"10.10.0.1\", \"interface\": \"en0\", \"device\": \"en0\", \"type\": \"ether\", \"flags\": [\"UP\", \"BROADCAST\", \"NOTRAILERS\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"CHECKSUM_OFFLOAD(ACTIVE)\", \"LARGESEND\", \"CHAIN\"], \"macaddress\": \"7a:9c:40:85:14:02\", \"mtu\": \"1500\", \"address\": \"10.10.1.86\", \"netmask\": \"255.255.0.0\", \"network\": \"10.10.0.0\", \"broadcast\": \"10.10.255.255\"}, \"ansible_default_ipv6\": {}, \"ansible_all_ipv4_addresses\": [\"10.10.1.86\"], \"ansible_all_ipv6_addresses\": [\"::1%1\"], \"ansible_system\": \"AIX\", \"ansible_kernel\": \"2\", \"ansible_kernel_version\": \"7\", \"ansible_machine\": \"00FAAFA94C00\", \"ansible_python_version\": \"3.7.4\", \"ansible_fqdn\": \"mqde01aixtest01\", \"ansible_hostname\": \"mqde01aixtest01\", \"ansible_nodename\": \"mqde01aixtest01\", \"ansible_domain\": \"\", \"ansible_userspace_bits\": \"32\", \"ansible_architecture\": \"chrp\", \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAP71cQd8OqDxPOVdf4zBlJ3/UbAd7zO+0x2lDbfHePBR0FBozg0pF/Ryq7bwo1gbuoJxr0uStwEyyPTBdtEpxl6lkKL6gvdBoqFg3Lpf403K9vFM22jIgB0D+es2BoQRfpub2tcO/IJW4QPymHoZjx2ecB9cIZsXnQmZSJtyKrc7AAAAFQCmbqLS77ycsaMI3gIdCMssp49ioQAAAIEA2Y9OsvgOyNYH2yZIy2JPjLwEmkD9j0Bw3ShRzDxOk7VjVw8fIchLHXoaI6kF3fIgtp+k0LwkDGKwYiKkrDjC6LMOEJUHGvK+RBvc4iaoHDZWISsHa231pSAgpOmlTiUY/F/SzjiZiq5xI8dhO445iWq5Lyy8rZWN6hH9Sv0VMI8AAACBAKCr2onW+9jmqBcPRD1qlp2SYKNHP2BHAGZlX9l45YXjQIBWw2meDv1PMlbBUeZR/uAqSW+zES+KgwePC8XEeDkqQRBdZ5QVmvPsXMOXNpwk0XpCapzDjgA4TFdCJn+L6n6C7Ls8Oj6D7PPgBtomWTxeFEZEp/gamkEi6RdixBx1\", \"ansible_ssh_host_key_dsa_public_keytype\": \"ssh-dss\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDOZk9UI7yp83KIiH+Tv0FPm8Hl/wxQVzcsVB+nnl0j+73E+rDJbSZ6UYLWwxkycSyvJJSky5LO2Y0zZMjqu5Td8e5dweQ8K2mZjbWKaYxYBqijklhO2W3hSJCAnFdtpWgq/0WzYuXWfEv8lY87cfKP8oP7tTMIorIIyoOYtTSlt0wZXlafL893xs0L+R/3J3aqaEjMqiaGCd89p/JMKPMFMBeAzTB3RPaFs8R4c+73i28q96OyG62a9NzfjHf4cELgWoimeXVpW588tCt+fXGErebn4Xfr8ctAjhxicxp5NNRkZ6u2tYVOzpdbnFLlVmRV+Q4ye2/kTSVcR2h/5RkL\", \"ansible_ssh_host_key_rsa_public_keytype\": \"ssh-rsa\", \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOJpndC3KlQZcnnw13aA7+BLYhpyimtJ9Yck8sv1qa8w+3e3TbrZAu5oDGnaU6/B9JUbfbAdWYS9QVjAa3rsi14=\", \"ansible_ssh_host_key_ecdsa_public_keytype\": \"ecdsa-sha2-nistp256\", \"ansible_ssh_host_key_ed25519_public\": \"AAAAC3NzaC1lZDI1NTE5AAAAIMhP8nVBb5UZer6YarJhn8RgZsUAPbgQ4ddAvbLUIJnd\", \"ansible_ssh_host_key_ed25519_public_keytype\": \"ssh-ed25519\", \"ansible_date_time\": {\"year\": \"2021\", \"month\": \"06\", \"weekday\": \"Tuesday\", \"weekday_number\": \"2\", \"weeknumber\": \"22\", \"day\": \"01\", \"hour\": \"16\", \"minute\": \"26\", \"second\": \"40\", \"epoch\": \"1622557600\", \"date\": \"2021-06-01\", \"time\": \"16:26:40\", \"iso8601_micro\": \"2021-06-01T14:26:40.285397Z\", \"iso8601\": \"2021-06-01T14:26:40Z\", \"iso8601_basic\": \"20210601T162640285397\", \"iso8601_basic_short\": \"20210601T162640\", \"tz\": \"CEST\", \"tz_offset\": \"CEST\"}, \"ansible_processor\": \"PowerPC_POWER8\", \"ansible_processor_count\": 1, \"ansible_processor_cores\": 8, \"ansible_memtotal_mb\": 4096, \"ansible_memfree_mb\": 213, \"ansible_swaptotal_mb\": 2048, \"ansible_swapfree_mb\": 2027, \"ansible_firmware_version\": \"FW860.70\", \"ansible_product_name\": \"IBM,8284-22A\", \"ansible_product_serial\": \"21AFA9W\", \"ansible_lpar_info\": \"4 mqde01aixtest01\", \"ansible_vgs\": {\"rootvg\": [{\"pv_name\": \"hdisk0\", \"pv_state\": \"active\", \"total_pps\": \"799\", \"free_pps\": \"244\", \"pp_size\": \"64 megabyte(s)\"}]}, \"ansible_mounts\": [{\"mount\": \"/\", \"device\": \"/dev/hd4\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 536870912, \"size_available\": 326586368, \"block_size\": 4096, \"block_total\": 131072, \"block_available\": 79733, \"block_used\": 51339, \"inode_total\": 86777, \"inode_available\": 72692, \"inode_used\": 14085}, {\"mount\": \"/usr\", \"device\": \"/dev/hd2\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 3489660928, \"size_available\": 507191296, \"block_size\": 4096, \"block_total\": 851968, \"block_available\": 123826, \"block_used\": 728142, \"inode_total\": 177139, \"inode_available\": 129469, \"inode_used\": 47670}, {\"mount\": \"/var\", \"device\": \"/dev/hd9var\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 3221225472, \"size_available\": 2511626240, \"block_size\": 4096, \"block_total\": 786432, \"block_available\": 613190, \"block_used\": 173242, \"inode_total\": 566913, \"inode_available\": 563985, \"inode_used\": 2928}, {\"mount\": \"/tmp\", \"device\": \"/dev/hd3\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 10737418240, \"size_available\": 10693754880, \"block_size\": 4096, \"block_total\": 2621440, \"block_available\": 2610780, \"block_used\": 10660, \"inode_total\": 2321301, \"inode_available\": 2321006, \"inode_used\": 295}, {\"mount\": \"/home\", \"device\": \"/dev/hd1\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 1073741824, \"size_available\": 1072914432, \"block_size\": 4096, \"block_total\": 262144, \"block_available\": 261942, \"block_used\": 202, \"inode_total\": 233125, \"inode_available\": 233053, \"inode_used\": 72}, {\"mount\": \"/admin\", \"device\": \"/dev/hd11admin\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 268435456, \"size_available\": 268042240, \"block_size\": 4096, \"block_total\": 65536, \"block_available\": 65440, \"block_used\": 96, \"inode_total\": 58232, \"inode_available\": 58227, \"inode_used\": 5}, {\"mount\": \"/proc\", \"device\": \"/proc\", \"fstype\": \"procfs\", \"options\": \"rw\", \"time\": \"Oct 14 15:59\", \"size_total\": 4398046510080, \"size_available\": 0, \"block_size\": 1024, \"block_total\": 4294967295, \"block_available\": 0, \"block_used\": 4294967295, \"inode_total\": 0, \"inode_available\": 0, \"inode_used\": 0}, {\"mount\": \"/opt\", \"device\": \"/dev/hd10opt\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 1610612736, \"size_available\": 578379776, \"block_size\": 4096, \"block_total\": 393216, \"block_available\": 141206, \"block_used\": 252010, \"inode_total\": 166732, \"inode_available\": 142585, \"inode_used\": 24147}, {\"mount\": \"/var/adm/ras/livedump\", \"device\": \"/dev/livedump\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 268435456, \"size_available\": 268058624, \"block_size\": 4096, \"block_total\": 65536, \"block_available\": 65444, \"block_used\": 92, \"inode_total\": 58204, \"inode_available\": 58200, \"inode_used\": 4}, {\"mount\": \"/tmp/core\", \"device\": \"/dev/core_lv\", \"fstype\": \"jfs2\", \"options\": \"rw,log=INLINE\", \"time\": \"Oct 14 15:59\", \"size_total\": 1073741824, \"size_available\": 1064853504, \"block_size\": 4096, \"block_total\": 262144, \"block_available\": 259974, \"block_used\": 2170, \"inode_total\": 231120, \"inode_available\": 231116, \"inode_used\": 4}, {\"mount\": \"/root\", \"device\": \"/dev/root_lv\", \"fstype\": \"jfs2\", \"options\": \"rw,log=INLINE\", \"time\": \"Oct 14 15:59\", \"size_total\": 1073741824, \"size_available\": 950521856, \"block_size\": 4096, \"block_total\": 262144, \"block_available\": 232061, \"block_used\": 30083, \"inode_total\": 206564, \"inode_available\": 206453, \"inode_used\": 111}, {\"mount\": \"/opt/fum\", \"device\": \"/dev/fum_lv\", \"fstype\": \"jfs2\", \"options\": \"rw,log=INLINE\", \"time\": \"Oct 14 15:59\", \"size_total\": 1073741824, \"size_available\": 1050447872, \"block_size\": 4096, \"block_total\": 262144, \"block_available\": 256457, \"block_used\": 5687, \"inode_total\": 228281, \"inode_available\": 228068, \"inode_used\": 213}, {\"mount\": \"/tmp/create_mksysb\", \"device\": \"/dev/fslv00\", \"fstype\": \"jfs2\", \"options\": \"rw,log=/dev/hd8\", \"time\": \"Oct 14 15:59\", \"size_total\": 5502926848, \"size_available\": 5501718528, \"block_size\": 4096, \"block_total\": 1343488, \"block_available\": 1343193, \"block_used\": 295, \"inode_total\": 1194045, \"inode_available\": 1194038, \"inode_used\": 7}, {\"mount\": \"/software\", \"device\": \"/etc/auto_direct\", \"fstype\": \"autofs\", \"options\": \"ignore\", \"time\": \"Oct 14 16:00\", \"size_total\": 0, \"size_available\": 0, \"block_size\": 1024, \"block_total\": 0, \"block_available\": 0, \"block_used\": 0, \"inode_total\": 0, \"inode_available\": 0, \"inode_used\": 0}], \"ansible_devices\": {\"L2cache0\": {\"state\": \"Available\", \"type\": \"L2 Cache\", \"attributes\": {\"size\": \"0\"}}, \"cache0\": {\"state\": \"Defined\", \"type\": \"SSD Cache virtual device\", \"attributes\": {\"auto_grab_ssd\": \"no\", \"cache_enable\": \"1\", \"cache_engine\": \"cengine0\", \"cfg_persist\": \"1\"}}, \"cengine0\": {\"state\": \"Defined\", \"type\": \"SSD Cache engine\", \"attributes\": {\"cache_per_tgt\": \"1\", \"cepath\": \"/usr/ccs/lib/libcehandler.a\", \"max_partition\": \"1\", \"max_pool\": \"1\", \"tgt_per_cache\": \"unlimited\"}}, \"cluster0\": {\"state\": \"Available\", \"type\": \"Cluster Node\", \"attributes\": {\"clrpvid\": \"00000000000000000000000000000000\", \"clvdisk\": \"00000000-0000-0000-0000-000000000000\", \"configure\": \"yes\", \"node_uuid\": \"a2114e2e-b1ff-11ea-8004-7a9c40851402\"}}, \"core_lv\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"/tmp/core\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.13\", \"relocatable\": \"y\", \"size\": \"16\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"en0\": {\"state\": \"Available\", \"type\": \"Standard Ethernet Network Interface\", \"attributes\": {\"alias4\": \"IPv4\", \"alias6\": \"IPv6\", \"arp\": \"on\", \"authority\": \"Authorized\", \"broadcast\": \"Broadcast\", \"monitor\": \"off\", \"mtu\": \"1500\", \"mtu_bypass\": \"on\", \"netaddr\": \"10.10.1.86\", \"netaddr6\": \"IPv6\", \"netmask\": \"255.255.0.0\", \"prefixlen\": \"Prefix\", \"remmtu\": \"576\", \"rfc1323\": \"Enable/Disable\", \"security\": \"none\", \"state\": \"up\", \"tcp_mssdflt\": \"Set\", \"tcp_nodelay\": \"Enable/Disable\", \"tcp_recvspace\": \"Set\", \"tcp_sendspace\": \"Set\", \"thread\": \"off\"}}, \"ent0\": {\"state\": \"Available\", \"type\": \"Virtual I/O Ethernet Adapter (l-lan)\", \"attributes\": {\"alt_addr\": \"0x000000000000\", \"buf_mode\": \"max_min\", \"chksum_offload\": \"yes\", \"copy_buffs\": \"32\", \"copy_bytes\": \"65536\", \"desired_mapmem\": \"0\", \"ipv6_offload\": \"no\", \"max_buf_control\": \"64\", \"max_buf_huge\": \"64\", \"max_buf_large\": \"64\", \"max_buf_medium\": \"256\", \"max_buf_small\": \"2048\", \"max_buf_tiny\": \"2048\", \"min_buf_control\": \"24\", \"min_buf_huge\": \"24\", \"min_buf_large\": \"24\", \"min_buf_medium\": \"128\", \"min_buf_small\": \"512\", \"min_buf_tiny\": \"512\", \"platform_lso\": \"yes\", \"poll_uplink\": \"no\", \"poll_uplink_int\": \"1000\", \"trace_debug\": \"no\", \"use_alt_addr\": \"no\"}}, \"et0\": {\"state\": \"Defined\", \"type\": \"IEEE 802.3 Ethernet Network Interface\", \"attributes\": {\"alias4\": \"IPv4\", \"alias6\": \"IPv6\", \"arp\": \"on\", \"authority\": \"Authorized\", \"broadcast\": \"Broadcast\", \"mtu\": \"1492\", \"netaddr\": \"Internet\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"prefixlen\": \"Prefix\", \"remmtu\": \"576\", \"rfc1323\": \"Enable/Disable\", \"security\": \"none\", \"state\": \"down\", \"tcp_mssdflt\": \"Set\", \"tcp_nodelay\": \"Enable/Disable\", \"tcp_recvspace\": \"Set\", \"tcp_sendspace\": \"Set\"}}, \"fslv00\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"/tmp/create_mksysb\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.16\", \"relocatable\": \"y\", \"size\": \"82\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"fum_lv\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"/opt/fum\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.15\", \"relocatable\": \"y\", \"size\": \"16\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd1\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/home\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.8\", \"relocatable\": \"y\", \"size\": \"16\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd2\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/usr\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.5\", \"relocatable\": \"y\", \"size\": \"52\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd3\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/tmp\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.7\", \"relocatable\": \"y\", \"size\": \"160\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd4\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.4\", \"relocatable\": \"y\", \"size\": \"8\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd5\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"e\", \"label\": \"primary_bootlv\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.1\", \"relocatable\": \"n\", \"size\": \"1\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"boot\", \"upperbound\": \"32\"}}, \"hd6\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"None\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.2\", \"relocatable\": \"y\", \"size\": \"32\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"paging\", \"upperbound\": \"32\"}}, \"hd8\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"None\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.3\", \"relocatable\": \"y\", \"size\": \"1\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2log\", \"upperbound\": \"32\"}}, \"hd10opt\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/opt\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.9\", \"relocatable\": \"y\", \"size\": \"24\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd11admin\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/admin\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.10\", \"relocatable\": \"y\", \"size\": \"4\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hd9var\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"c\", \"label\": \"/var\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.6\", \"relocatable\": \"y\", \"size\": \"48\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"hdisk0\": {\"state\": \"Available\", \"type\": \"Virtual SCSI Disk Drive\", \"attributes\": {\"PCM\": \"PCM/friend/vscsi\", \"algorithm\": \"fail_over\", \"hcheck_cmd\": \"test_unit_rdy\", \"hcheck_interval\": \"0\", \"hcheck_mode\": \"nonactive\", \"max_transfer\": \"0x40000\", \"pvid\": \"00f6b1101e6f67ad0000000000000000\", \"queue_depth\": \"3\", \"reserve_policy\": \"no_reserve\"}}, \"hdisk1\": {\"state\": \"Available\", \"type\": \"Virtual SCSI Disk Drive\", \"attributes\": {\"PCM\": \"PCM/friend/vscsi\", \"algorithm\": \"fail_over\", \"hcheck_cmd\": \"test_unit_rdy\", \"hcheck_interval\": \"0\", \"hcheck_mode\": \"nonactive\", \"max_transfer\": \"0x40000\", \"pvid\": \"00faafa9ed98427b0000000000000000\", \"queue_depth\": \"3\", \"reserve_policy\": \"no_reserve\"}}, \"hdisk2\": {\"state\": \"Available\", \"type\": \"Virtual SCSI Disk Drive\", \"attributes\": {\"PCM\": \"PCM/friend/vscsi\", \"algorithm\": \"fail_over\", \"hcheck_cmd\": \"test_unit_rdy\", \"hcheck_interval\": \"0\", \"hcheck_mode\": \"nonactive\", \"max_transfer\": \"0x40000\", \"pvid\": \"00faafa995a1ccdf0000000000000000\", \"queue_depth\": \"3\", \"reserve_policy\": \"no_reserve\"}}, \"inet0\": {\"state\": \"Available\", \"type\": \"Internet Network Extension\", \"attributes\": {\"authm\": \"65536\", \"bootup_option\": \"no\", \"gateway\": \"Gateway\", \"hostname\": \"mqde01aixtest01\", \"rout6\": \"IPv6\", \"route\": \"net,-hopcount,0,,0,10.10.0.1\"}}, \"iocp0\": {\"state\": \"Defined\", \"type\": \"I/O Completion Ports\", \"attributes\": {\"autoconfig\": \"defined\"}}, \"iscsi0\": {\"state\": \"Available\", \"type\": \"iSCSI Protocol Device\", \"attributes\": {\"disc_filename\": \"/etc/iscsi/targets\", \"disc_policy\": \"file\", \"immediate_data\": \"no\", \"initial_r2t\": \"yes\", \"initiator_name\": \"iqn.localhost.hostid.7f000001\", \"isns_srvnames\": \"auto\", \"isns_srvports\": \"iSNS\", \"isw_err_recov\": \"delayed_fail\", \"max_targets\": \"16\", \"max_xfer_size\": \"0x80000\", \"num_cmd_elems\": \"200\"}}, \"lg_dumplv\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"None\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.11\", \"relocatable\": \"y\", \"size\": \"75\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"sysdump\", \"upperbound\": \"32\"}}, \"livedump\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"/var/adm/ras/livedump\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.12\", \"relocatable\": \"y\", \"size\": \"4\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"lo0\": {\"state\": \"Available\", \"type\": \"Loopback Network Interface\", \"attributes\": {\"mtu\": \"16896\", \"netaddr\": \"127.0.0.1\", \"netaddr6\": \"::1\", \"netmask\": \"Subnet\", \"prefixlen\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"state\": \"up\", \"tcp_mssdflt\": \"Set\", \"tcp_nodelay\": \"Enable/Disable\", \"tcp_recvspace\": \"Set\", \"tcp_sendspace\": \"Set\"}}, \"lvdd\": {\"state\": \"Available\", \"type\": \"LVM Device Driver\", \"attributes\": {}}, \"mem0\": {\"state\": \"Available\", \"type\": \"Memory\", \"attributes\": {\"ent_mem_cap\": \"I/O\", \"goodsize\": \"4096\", \"mem_exp_factor\": \"Memory\", \"size\": \"4096\", \"var_mem_weight\": \"Variable\"}}, \"pkcs11\": {\"state\": \"Available\", \"type\": \"ACF/PKCS#11 Device\", \"attributes\": {\"comp_trace\": \"no\", \"io_threads\": \"8\", \"proc_heap_sz\": \"8\", \"trc_adm\": \"no\", \"trc_clic\": \"no\", \"trc_context\": \"no\", \"trc_dd\": \"no\", \"trc_hw\": \"no\", \"trc_io\": \"no\", \"trc_k_klib\": \"no\", \"trc_k_ulib\": \"no\", \"trc_malloc\": \"no\", \"trc_meta\": \"no\", \"trc_mmap\": \"no\", \"trc_obj\": \"no\", \"trc_req\": \"no\", \"trc_sess\": \"no\", \"trc_slot\": \"no\", \"trc_token\": \"no\", \"trc_u_lib\": \"no\", \"trc_util\": \"no\", \"y4_max_req\": \"16\"}}, \"proc0\": {\"state\": \"Available\", \"type\": \"00-00 Processor\", \"attributes\": {\"frequency\": \"3425000000\", \"smt_enabled\": \"true\", \"smt_threads\": \"8\", \"state\": \"enable\", \"type\": \"PowerPC_POWER8\"}}, \"pty0\": {\"state\": \"Available\", \"type\": \"Asynchronous Pseudo-Terminal\", \"attributes\": {\"ATTnum\": \"256\", \"BSDnum\": \"16\", \"autoconfig\": \"available\", \"csmap\": \"sbcs\"}}, \"rcm0\": {\"state\": \"Defined\", \"type\": \"Rendering Context Manager Subsystem\", \"attributes\": {}}, \"root_lv\": {\"state\": \"Defined\", \"type\": \"Logical volume\", \"attributes\": {\"copies\": \"1\", \"inter\": \"m\", \"intra\": \"m\", \"label\": \"/root\", \"lvserial_id\": \"00faafa700004c0000000172cb7ea7ea.14\", \"relocatable\": \"y\", \"size\": \"16\", \"strictness\": \"y\", \"stripe_size\": \"Stripe\", \"stripe_width\": \"Striping\", \"type\": \"jfs2\", \"upperbound\": \"32\"}}, \"rootvg\": {\"state\": \"Defined\", \"type\": \"Volume group\", \"attributes\": {\"auto_on\": \"y\", \"cache_pbuf_cnt\": \"0\", \"conc_auto_on\": \"n\", \"conc_capable\": \"n\", \"gbl_pbufs_ppv\": \"0\", \"gbl_pbufs_pvg\": \"0\", \"timestamp\": \"5f87045d2c8447f7\", \"vg_pbufs_ppv\": \"0\", \"vgserial_id\": \"00faafa700004c0000000172cb7ea7ea\", \"workQ_size\": \"256\"}}, \"sfw0\": {\"state\": \"Available\", \"type\": \"Storage Framework Module\", \"attributes\": {\"enable_sas\": \"no\", \"vltag\": \"3358\"}}, \"sys0\": {\"state\": \"Available\", \"type\": \"System Object\", \"attributes\": {\"SW_dist_intr\": \"false\", \"autorestart\": \"true\", \"boottype\": \"disk\", \"capacity_inc\": \"0.01\", \"capped\": \"false\", \"chown_restrict\": \"true\", \"clouddev\": \"0\", \"conslogin\": \"enable\", \"cpuguard\": \"enable\", \"dedicated\": \"false\", \"enhanced_RBAC\": \"true\", \"ent_capacity\": \"0.20\", \"ex_intr_virt\": \"true\", \"frequency\": \"1600000000\", \"fullcore\": \"false\", \"fwversion\": \"IBM,FW860.70\", \"ghostdev\": \"0\", \"id_to_partition\": \"0X800010B2BC400004\", \"id_to_system\": \"0X800010B2BC400000\", \"iostat\": \"true\", \"keylock\": \"normal\", \"log_pg_dealloc\": \"true\", \"max_capacity\": \"1.00\", \"max_logname\": \"255\", \"maxbuf\": \"20\", \"maxmbuf\": \"0\", \"maxpout\": \"8193\", \"maxuproc\": \"16384\", \"min_capacity\": \"0.10\", \"minpout\": \"4096\", \"modelname\": \"IBM,8284-22A\", \"ncargs\": \"256\", \"nfs4_acl_compat\": \"secure\", \"ngroups_allowed\": \"128\", \"os_uuid\": \"068c0ca0-488d-43d0-906e-b61a607e89d3\", \"partition_uuid\": \"1454fe06-8529-44a0-84ec-3380fb13ef28\", \"pmuaccess\": \"all\", \"pre430core\": \"false\", \"pre520tune\": \"disable\", \"realmem\": \"4194304\", \"rtasversion\": \"1\", \"secure_boot\": \"Policy_0(Disabled)\", \"sed_config\": \"select\", \"signpolicy\": \"none\", \"systemid\": \"IBM,0221AFA9W\", \"variable_weight\": \"128\"}}, \"sysplanar0\": {\"state\": \"Available\", \"type\": \"System Planar\", \"attributes\": {}}, \"vio0\": {\"state\": \"Available\", \"type\": \"Virtual I/O Bus\", \"attributes\": {\"bus_id\": \"0x90000340\"}}, \"vsa0\": {\"state\": \"Available\", \"type\": \"LPAR Virtual Serial Adapter\", \"attributes\": {\"desired_mapmem\": \"I/O\"}}, \"vscsi0\": {\"state\": \"Available\", \"type\": \"Virtual SCSI Client Adapter\", \"attributes\": {\"rw_timeout\": \"45\", \"vscsi_err_recov\": \"delayed_fail\", \"vscsi_path_to\": \"0\"}}, \"vscsi1\": {\"state\": \"Available\", \"type\": \"Virtual SCSI Client Adapter\", \"attributes\": {\"rw_timeout\": \"45\", \"vscsi_err_recov\": \"delayed_fail\", \"vscsi_path_to\": \"0\"}}, \"vty0\": {\"state\": \"Available\", \"type\": \"Asynchronous Terminal\", \"attributes\": {\"autoconfig\": \"available\", \"bpc\": \"8\", \"csmap\": \"sbcs\", \"discard\": \"^o\", \"dsusp\": \"^y\", \"eof\": \"^d\", \"eol\": \"^@\", \"eol2\": \"^?\", \"erase\": \"^h\", \"flow_disp\": \"xon\", \"imap\": \"none\", \"intr\": \"^c\", \"kill\": \"^u\", \"lnext\": \"^v\", \"logger\": \"LOGGER\", \"login\": \"disable\", \"logmodes\": \"hupcl,cread,echoe,cs8\", \"modules\": \"ldterm\", \"omap\": \"none\", \"open_disp\": \"dtropen\", \"parity\": \"none\", \"quit\": \"^\\\\\\\\\", \"reprint\": \"^r\", \"runmodes\": \"hupcl,cread,brkint,icrnl,opost,tab3,onlcr,isig,icanon,echo,echoe,echok,echoctl,echoke,imaxbel,iexten\", \"speed\": \"19200\", \"start\": \"^q\", \"stop\": \"^s\", \"stops\": \"1\", \"susp\": \"^z\", \"term\": \"vt220\", \"timeout\": \"0\", \"werase\": \"^w\"}}}, \"ansible_local\": {}, \"ansible_lsb\": {}, \"ansible_fips\": false, \"ansible_iscsi_iqn\": \"iqn.localhost.hostid.7f000001\", \"ansible_apparmor\": {\"status\": \"disabled\"}, \"ansible_dns\": {\"search\": [\"marquardt.de\"], \"domain\": \"marquardt.de\", \"nameservers\": [\"10.10.1.37\", \"10.10.1.41\", \"10.96.7.10\"], \"options\": {\"attempts\": \"2\"}}, \"ansible_pkg_mgr\": \"yum\", \"ansible_service_mgr\": \"src\", \"gather_subset\": [\"all\"], \"module_setup\": true}, \"invocation\": {\"module_args\": {\"gather_subset\": [\"all\"], \"gather_timeout\": 10, \"filter\": \"*\", \"fact_path\": \"/etc/ansible/facts.d\"}}}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01aixtest01 closed.\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557598.9211342-15194-246725403533274/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nok: [mqde01aixtest01]\r\nMETA: ran handlers\r\n\r\nTASK [Ensure users are in the group for service 1] ****************************************************************************************************************\r\ntask path: /home/reichle/ansible/playbooks/group-test.yml:5\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278 `\" && echo ansible-tmp-1622557604.4428437-15252-167067093398278=\"` echo /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278 `\" ) && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558 `\" && echo ansible-tmp-1622557604.466496-15253-95692629237558=\"` echo /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558 `\" ) && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'ansible-tmp-1622557604.4428437-15252-167067093398278=/root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> (0, b'ansible-tmp-1622557604.466496-15253-95692629237558=/root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/user.py\r\n<mqde01slestest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpilmv69nr TO /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/AnsiballZ_user.py\r\n<mqde01slestest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 '[mqde01slestest01]'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/user.py\r\n<mqde01aixtest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpez42o0xn TO /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/AnsiballZ_user.py\r\n<mqde01aixtest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a '[mqde01aixtest01]'\r\n<mqde01aixtest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpez42o0xn /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/AnsiballZ_user.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpez42o0xn\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/AnsiballZ_user.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:8888\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 8888 bytes at 131072\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/ /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpilmv69nr /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/AnsiballZ_user.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpilmv69nr\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/AnsiballZ_user.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:8885\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 8885 bytes at 131072\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/ /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a -tt mqde01aixtest01 '/bin/sh -c '\"'\"'/opt/bin/python3 /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 -tt mqde01slestest01 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'\\r\\n{\"comment\": \"Alexander Reichle-Schmehl\", \"shell\": \"/bin/bash\", \"group\": 1004, \"name\": \"reichle\", \"changed\": true, \"state\": \"present\", \"groups\": \"bckp_adm\", \"invocation\": {\"module_args\": {\"comment\": null, \"ssh_key_bits\": 0, \"update_password\": \"always\", \"non_unique\": false, \"force\": false, \"ssh_key_type\": \"rsa\", \"create_home\": true, \"password_lock\": null, \"ssh_key_passphrase\": null, \"uid\": null, \"home\": null, \"append\": true, \"skeleton\": null, \"ssh_key_comment\": \"ansible-generated on mqde01slestest01\", \"group\": null, \"system\": false, \"state\": \"present\", \"role\": null, \"hidden\": null, \"local\": null, \"authorization\": null, \"profile\": null, \"shell\": null, \"expires\": null, \"ssh_key_file\": null, \"groups\": [\"bckp_adm\"], \"move_home\": false, \"password\": null, \"name\": \"reichle\", \"seuser\": null, \"remove\": false, \"login_class\": null, \"generate_ssh_key\": null}}, \"home\": \"/home/reichle\", \"move_home\": false, \"append\": true, \"uid\": 1001}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01slestest01 closed.\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557604.466496-15253-95692629237558/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nchanged: [mqde01slestest01] => {\r\n    \"append\": true,\r\n    \"changed\": true,\r\n    \"comment\": \"Alexander Reichle-Schmehl\",\r\n    \"group\": 1004,\r\n    \"groups\": \"bckp_adm\",\r\n    \"home\": \"/home/reichle\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": true,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"bckp_adm\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"reichle\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on mqde01slestest01\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"move_home\": false,\r\n    \"name\": \"reichle\",\r\n    \"shell\": \"/bin/bash\",\r\n    \"state\": \"present\",\r\n    \"uid\": 1001\r\n}\r\n<mqde01aixtest01> (0, b'\\r\\n{\"name\": \"reichle\", \"state\": \"present\", \"append\": true, \"move_home\": false, \"changed\": true, \"uid\": 226, \"group\": 213, \"comment\": \"Alexander Reichle-Schmehl\", \"home\": \"/home/reichle\", \"shell\": \"/bin/ksh\", \"groups\": \"bckp_adm\", \"invocation\": {\"module_args\": {\"name\": \"reichle\", \"groups\": [\"bckp_adm\"], \"append\": true, \"state\": \"present\", \"non_unique\": false, \"force\": false, \"remove\": false, \"create_home\": true, \"system\": false, \"move_home\": false, \"ssh_key_bits\": 0, \"ssh_key_type\": \"rsa\", \"ssh_key_comment\": \"ansible-generated on mqde01aixtest01\", \"update_password\": \"always\", \"uid\": null, \"group\": null, \"comment\": null, \"home\": null, \"shell\": null, \"password\": null, \"login_class\": null, \"hidden\": null, \"seuser\": null, \"skeleton\": null, \"generate_ssh_key\": null, \"ssh_key_file\": null, \"ssh_key_passphrase\": null, \"expires\": null, \"password_lock\": null, \"local\": null, \"profile\": null, \"authorization\": null, \"role\": null}}}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01aixtest01 closed.\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557604.4428437-15252-167067093398278/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nchanged: [mqde01aixtest01] => {\r\n    \"append\": true,\r\n    \"changed\": true,\r\n    \"comment\": \"Alexander Reichle-Schmehl\",\r\n    \"group\": 213,\r\n    \"groups\": \"bckp_adm\",\r\n    \"home\": \"/home/reichle\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": true,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"bckp_adm\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"reichle\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on mqde01aixtest01\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"move_home\": false,\r\n    \"name\": \"reichle\",\r\n    \"shell\": \"/bin/ksh\",\r\n    \"state\": \"present\",\r\n    \"uid\": 226\r\n}\r\n\r\nTASK [Ensure users are in the group for service 2] ****************************************************************************************************************\r\ntask path: /home/reichle/ansible/playbooks/group-test.yml:11\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027 `\" && echo ansible-tmp-1622557605.3873544-15290-125900644804027=\"` echo /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027 `\" ) && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'/root\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir \"` echo /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102 `\" && echo ansible-tmp-1622557605.4100387-15291-222151784966102=\"` echo /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102 `\" ) && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'ansible-tmp-1622557605.3873544-15290-125900644804027=/root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/user.py\r\n<mqde01aixtest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpyt0l6piq TO /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/AnsiballZ_user.py\r\n<mqde01aixtest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a '[mqde01aixtest01]'\r\n<mqde01slestest01> (0, b'ansible-tmp-1622557605.4100387-15291-222151784966102=/root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/user.py\r\n<mqde01slestest01> PUT /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp3p4bu1pq TO /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/AnsiballZ_user.py\r\n<mqde01slestest01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 '[mqde01slestest01]'\r\n<mqde01aixtest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpyt0l6piq /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/AnsiballZ_user.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmpyt0l6piq\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/AnsiballZ_user.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:8888\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 8888 bytes at 131072\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/ /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a -tt mqde01aixtest01 '/bin/sh -c '\"'\"'/opt/bin/python3 /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'sftp> put /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp3p4bu1pq /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/AnsiballZ_user.py\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /root size 0\\r\\ndebug3: Looking up /home/reichle/.ansible/tmp/ansible-local-15188ra1opd8u/tmp3p4bu1pq\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/AnsiballZ_user.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:8 O:131072 S:8887\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 32768 bytes at 98304\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 8 8887 bytes at 131072\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/ /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 -tt mqde01slestest01 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/AnsiballZ_user.py && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'\\r\\n{\"comment\": \"Alexander Reichle-Schmehl\", \"shell\": \"/bin/bash\", \"group\": 1004, \"name\": \"reichle\", \"changed\": true, \"state\": \"present\", \"groups\": \"unix_adm\", \"invocation\": {\"module_args\": {\"comment\": null, \"ssh_key_bits\": 0, \"update_password\": \"always\", \"non_unique\": false, \"force\": false, \"ssh_key_type\": \"rsa\", \"create_home\": true, \"password_lock\": null, \"ssh_key_passphrase\": null, \"uid\": null, \"home\": null, \"append\": true, \"skeleton\": null, \"ssh_key_comment\": \"ansible-generated on mqde01slestest01\", \"group\": null, \"system\": false, \"state\": \"present\", \"role\": null, \"hidden\": null, \"local\": null, \"authorization\": null, \"profile\": null, \"shell\": null, \"expires\": null, \"ssh_key_file\": null, \"groups\": [\"unix_adm\"], \"move_home\": false, \"password\": null, \"name\": \"reichle\", \"seuser\": null, \"remove\": false, \"login_class\": null, \"generate_ssh_key\": null}}, \"home\": \"/home/reichle\", \"move_home\": false, \"append\": true, \"uid\": 1001}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01slestest01 closed.\\r\\n')\r\n<mqde01slestest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01slestest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/2ae36d0856 mqde01slestest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557605.4100387-15291-222151784966102/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01slestest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15200\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nchanged: [mqde01slestest01] => {\r\n    \"append\": true,\r\n    \"changed\": true,\r\n    \"comment\": \"Alexander Reichle-Schmehl\",\r\n    \"group\": 1004,\r\n    \"groups\": \"unix_adm\",\r\n    \"home\": \"/home/reichle\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": true,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"unix_adm\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"reichle\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on mqde01slestest01\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"move_home\": false,\r\n    \"name\": \"reichle\",\r\n    \"shell\": \"/bin/bash\",\r\n    \"state\": \"present\",\r\n    \"uid\": 1001\r\n}\r\n<mqde01aixtest01> (0, b'\\r\\n{\"name\": \"reichle\", \"state\": \"present\", \"append\": true, \"move_home\": false, \"changed\": true, \"uid\": 226, \"group\": 213, \"comment\": \"Alexander Reichle-Schmehl\", \"home\": \"/home/reichle\", \"shell\": \"/bin/ksh\", \"groups\": \"unix_adm\", \"invocation\": {\"module_args\": {\"name\": \"reichle\", \"groups\": [\"unix_adm\"], \"append\": true, \"state\": \"present\", \"non_unique\": false, \"force\": false, \"remove\": false, \"create_home\": true, \"system\": false, \"move_home\": false, \"ssh_key_bits\": 0, \"ssh_key_type\": \"rsa\", \"ssh_key_comment\": \"ansible-generated on mqde01aixtest01\", \"update_password\": \"always\", \"uid\": null, \"group\": null, \"comment\": null, \"home\": null, \"shell\": null, \"password\": null, \"login_class\": null, \"hidden\": null, \"seuser\": null, \"skeleton\": null, \"generate_ssh_key\": null, \"ssh_key_file\": null, \"ssh_key_passphrase\": null, \"expires\": null, \"password_lock\": null, \"local\": null, \"profile\": null, \"authorization\": null, \"role\": null}}}\\r\\n', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to mqde01aixtest01 closed.\\r\\n')\r\n<mqde01aixtest01> ESTABLISH SSH CONNECTION FOR USER: root\r\n<mqde01aixtest01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"root\"' -o ConnectTimeout=10 -o ControlPath=/home/reichle/.ansible/cp/e8b693817a mqde01aixtest01 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1622557605.3873544-15290-125900644804027/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<mqde01aixtest01> (0, b'', b'OpenSSH_7.9p1 Debian-10+deb10u2, OpenSSL 1.1.1d  10 Sep 2019\\r\\ndebug1: Reading configuration data /home/reichle/.ssh/config\\r\\ndebug1: /home/reichle/.ssh/config line 22: Applying options for mq*\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 15203\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nchanged: [mqde01aixtest01] => {\r\n    \"append\": true,\r\n    \"changed\": true,\r\n    \"comment\": \"Alexander Reichle-Schmehl\",\r\n    \"group\": 213,\r\n    \"groups\": \"unix_adm\",\r\n    \"home\": \"/home/reichle\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"append\": true,\r\n            \"authorization\": null,\r\n            \"comment\": null,\r\n            \"create_home\": true,\r\n            \"expires\": null,\r\n            \"force\": false,\r\n            \"generate_ssh_key\": null,\r\n            \"group\": null,\r\n            \"groups\": [\r\n                \"unix_adm\"\r\n            ],\r\n            \"hidden\": null,\r\n            \"home\": null,\r\n            \"local\": null,\r\n            \"login_class\": null,\r\n            \"move_home\": false,\r\n            \"name\": \"reichle\",\r\n            \"non_unique\": false,\r\n            \"password\": null,\r\n            \"password_lock\": null,\r\n            \"profile\": null,\r\n            \"remove\": false,\r\n            \"role\": null,\r\n            \"seuser\": null,\r\n            \"shell\": null,\r\n            \"skeleton\": null,\r\n            \"ssh_key_bits\": 0,\r\n            \"ssh_key_comment\": \"ansible-generated on mqde01aixtest01\",\r\n            \"ssh_key_file\": null,\r\n            \"ssh_key_passphrase\": null,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"state\": \"present\",\r\n            \"system\": false,\r\n            \"uid\": null,\r\n            \"update_password\": \"always\"\r\n        }\r\n    },\r\n    \"move_home\": false,\r\n    \"name\": \"reichle\",\r\n    \"shell\": \"/bin/ksh\",\r\n    \"state\": \"present\",\r\n    \"uid\": 226\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ********************************************************************************************************************************************************\r\nmqde01aixtest01            : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\nmqde01slestest01           : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\nreichle@mqde01jump01:~/ansible$ ssh mqde01slestest01 id\r\nuid=1001(reichle) gid=1004(reichle) groups=1000(unix_adm),1001(bckp_adm)\r\nreichle@mqde01jump01:~/ansible$ ssh mqde01aixtest01 id\r\nuid=226(reichle) gid=213(reichle) groups=208(unix_adm)\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-06-01T14:33:35Z",
        "user": "tolimar",
        "labels": [
            "module",
            "support:core",
            "bug",
            "traceback",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 74760,
        "title": "sudo error message does not make it to module stdout/stderr when user has some sudo rights, just not what is needed",
        "body": "### Summary\n\nWhen running a `command:` with `become: true`, if the `remote_user` is listed in sudoers, but doesn't have permission to run the command being attempted, the error that comes back does not contain the explanatory text that sudo provides:\r\n\r\n`Sorry, user testuser is not allowed to execute '/bin/ls /tmp' as root on testhost`\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nsudo\n\n### Ansible Version\n\n```console\n$ ansible --version\r\nansible 2.9.17\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ec2-user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Aug 18 2020, 08:33:21) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\n```\n\n\n### Configuration\n\n```console\n$ ansible-config dump --only-changed\r\n$\n```\n\n\n### OS / Environment\n\nRHEL 8\n\n### Steps to Reproduce\n\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- hosts: localhost\r\n  remote_user: testuser\r\n  tasks:\r\n    - name: Run sudo command we don't have permission for\r\n      command: ls /root\r\n      become: true\r\n```\r\n\n\n### Expected Results\n\nI expected the output of the module to contain the following text from sudo:\r\n\r\n`Sorry, user testuser is not allowed to execute '/bin/ls /tmp' as root on testhost`\n\n### Actual Results\n\n```console\nfatal: [localhost]: FAILED! => {\"changed\": false, \"module_stderr\": \"Shared connection to localhost closed.\\r\\n\", \"module_stdout\": \"\\r\\n\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}\n```\n\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-05-19T01:30:37Z",
        "user": "lotaris-xx",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 74688,
        "title": "Linking to versioned docs from command-line output of ansible-doc",
        "body": "### Summary\n\nAnsible generates links to docs.ansible.com as part of the output of `ansible-doc` and possibly in other situations at the CLI (test failures, error messages). Ideally, we'd like to generate links to the version of the documentation that match the version of Ansible or ansible-core that the user has installed, rather than always linking to `latest`. Since we now provide separate documentation (and different version numbers) for Ansible (the PyPI package) and for `ansible-core`, this is less straightforward than it used to be, pre-collections.\r\n\r\nThere are at least three scenarios:\r\n- command line output for users with Ansible 4 installed with pip should return links to docs.ansible.com/ansible/4 \r\n- command line output for users with ansible-core 2.11 installed should return links to docs.ansible.com/ansible-core/2.11\r\n- published module documentation should generate good links - this is currently broken - see, for example, the link in the `cacheable` parameter documentation in the [set_fact module documentation](https://docs.ansible.com/ansible/devel/collections/ansible/builtin/set_fact_module.html) in devel\r\n\r\nThis may be different for module docs and other docs. Module docs appear on Automation Hub (latest collection version only) and in the /ansible/ documentation. Other documentation pages from docs/docsite/rst/ appear in both the /ansible/ and /ansible-core/ documentation in a variety of versions. For RHAAP customers, do we link to Automation Hub for module docs?\r\n\r\nThe solution must also work within exec environments, with ansible-navigator, and elsewhere in the ecosystem.\r\n\r\nWe recently merged #74245 as an attempt to handle this, but that fix may not be correct, consistent, or complete.\r\n\r\nRelated to #73995 and #74207, possibly other issues and/or PRs.\r\n\n\n### Issue Type\n\nDocumentation Report\n\n### Component Name\n\ndocs/docsite/rst/collections\n\n### Ansible Version\n\n```console\nall versions\n```\n\n\n### Configuration\n\n```console\nN/A\n```\n\n\n### OS / Environment\n\nN/A\n\n### Additional Information\n\nNo additional information yet . . . stay tuned.\n\n### Code of Conduct\n\n- [X] I agree to follow the Ansible Code of Conduct",
        "created_at": "2021-05-13T20:27:31Z",
        "user": "acozine",
        "labels": [
            "support:core",
            "docs",
            "affects_2.17"
        ]
    },
    {
        "number": 74402,
        "title": "Replace test coverage from incidental tests",
        "body": "### Summary\r\n\r\nThe following incidental tests exist. Check them off as they are removed. If you are working on a PR to replace some or all of the coverage from one of these tests, please edit this issue and add a link to your PR under the appropriate items.\r\n\r\n - [x] incidental_cloud_init_data_facts - https://github.com/ansible/ansible/pull/75885\r\n - [x] incidental_cs_common - https://github.com/ansible/ansible/pull/76065\r\n - [x] incidental_deploy_helper - https://github.com/ansible/ansible/pull/76077\r\n - [x] incidental_inventory_aws_ec2 - https://github.com/ansible/ansible/pull/77743\r\n - [x] incidental_inventory_docker_swarm - https://github.com/ansible/ansible/pull/77924\r\n - [x] incidental_inventory_foreman\r\n - [ ] incidental_ios_file\r\n - [x] incidental_mongodb_parameter - https://github.com/ansible/ansible/pull/75627\r\n - [x] incidental_setup_docker - https://github.com/ansible/ansible/pull/77924\r\n - [x] incidental_setup_mongodb - https://github.com/ansible/ansible/pull/75627\r\n - [x] incidental_setup_rabbitmq - https://github.com/ansible/ansible/pull/74713\r\n - [x] incidental_setup_tls - https://github.com/ansible/ansible/pull/76066\r\n - [ ] incidental_vyos_config\r\n - [ ] incidental_vyos_lldp_interfaces\r\n - [ ] incidental_vyos_prepare_tests\r\n - [x] incidental_win_copy - https://github.com/ansible/ansible/pull/76068\r\n - [x] incidental_win_data_deduplication\r\n - [x] incidental_win_dsc - https://github.com/ansible/ansible/pull/76035\r\n - [x] incidental_win_lineinfile - https://github.com/ansible/ansible/pull/76952\r\n - [x] incidental_win_ping - https://github.com/ansible/ansible/pull/76031\r\n - [x] incidental_win_prepare_tests - https://github.com/ansible/ansible/pull/76952\r\n - [ ] incidental_win_reboot\r\n - [x] incidental_win_security_policy - https://github.com/ansible/ansible/pull/75654\r\n",
        "created_at": "2021-04-23T16:28:26Z",
        "user": "mattclay",
        "labels": [
            "needs_info",
            "needs_template",
            "support:core",
            "has_pr",
            "feature",
            "affects_2.16"
        ]
    },
    {
        "number": 74287,
        "title": "ansible-test network-integration <target> does not copy host_vars/group_vars to temp directory created when the command is executed",
        "body": "### Summary\r\n\r\nWhen the ansible-test network-integration <target> command is executed, a temporary directory with the dependent roles are copied to a temporary folder inside which tests are executed.\r\n\r\nI have host_vars and group_vars folders present in my collection/tests/integration/ folder where even my inventory.networking file resides.\r\n\r\nI need to have host_vars and group_vars as I have a large number of common and host-specific variables that need to be declared while running tests.\r\n\r\nThis perfectly works well when --no-temp-workdir command is used, but it is mentioned to be removed without notice.\r\n\r\nIn addition to this, to manage variables, I tried building inventory with YAML formatting but seems when a temp directory is created, it renames the inventory file as \"inventory.networking\" which is only parable by ini plugin and all other plugin fail to pass verify_file() method.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-test\r\n\r\n### Ansible Version\r\n\r\n```console\r\n$ ansible --version\r\nansible 2.10.7\r\n  config file = None\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.0 (default, Nov 11 2020, 02:30:01) [GCC 8.2.1 20180905 (Red Hat 8.2.1-3)]\r\n```\r\n\r\n### OS / Environment\r\n\r\nRHEL 8, Ubuntu 20.04, SLES 15\r\n\r\n### Steps to Reproduce\r\n\r\n1. Have host_vars and group_vars folders in your collection/tests/integration folder.\r\n2. define inventory.networking and mention some variables in related host_vars and group_vars files.\r\n3. run ansible-test network-integration <target>\r\n\r\n### Expected Results\r\n\r\nShould work exactly how it works when ansible-test network-integration <target> --no-temp-workdir is executed.\r\n\r\n### Actual Results\r\n\r\n```console\r\nhost_vars and group_vars inside the integration folder are not copied to the temp folder that gets created.\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\nI agree to follow the Ansible Code of Conduct",
        "created_at": "2021-04-15T07:11:38Z",
        "user": "deepakjoshishri",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "needs_verified",
            "affects_2.10",
            "affects_2.14",
            "affects_2.16"
        ]
    },
    {
        "number": 74237,
        "title": "wait_for_connection ignores short timeouts",
        "body": "### Summary\r\n\r\nwait_for_connection ignores small values for timeout.\r\n\r\n\r\n\r\n\r\nIt shows that `wat_for_connection` waited for 34 seconds intead of 3.\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nwait_for_connection\r\n\r\n### Ansible Version\r\n\r\n```console\r\nansible 2.10.7\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/amarao/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/amarao/venvs/ansible210/lib/python3.8/site-packages/ansible\r\n  executable location = /home/amarao/venvs/ansible210/bin/ansible\r\n  python version = 3.8.6 (default, Jan 27 2021, 15:42:20) [GCC 10.2.0]\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\nANSIBLE_NOCOWS(/etc/ansible/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/etc/ansible/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=10s\r\nANSIBLE_SSH_CONTROL_PATH(/etc/ansible/ansible.cfg) = /tmp/%%h-%%r\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 15\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.10\r\n\r\n### Steps to Reproduce\r\n\r\nProvided that 10.99.99.99 is not reachable (if it is, use other IP):\r\n\r\n`time ansible -i 10.99.99.99, -m wait_for_connection -a '{{ {\"timeout\": 3, \"connect_timeout\": 1} }}' all`\r\n\r\n\r\n\r\n### Expected Results\r\n```\r\nreal\t0m3s\r\n```\r\n\r\n### Actual Results\r\n\r\n```console\r\nreal\t0m34.042s\r\nuser\t0m6.251s\r\nsys\t0m0.535s\r\n```\r\n\r\n\r\n### Code of Conduct\r\n\r\nI agree to follow the Ansible Code of Conduct",
        "created_at": "2021-04-12T10:31:26Z",
        "user": "amarao",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.10"
        ]
    },
    {
        "number": 73936,
        "title": "ansible.builtin.service erronously states that service is not started, when it actually is",
        "body": "### Summary\n\nWhen I try to start a service, the task is reported as \"changed\" even if the service was started before. This happens if an openrc service doesn't report \"started\" in the status output, as is the case for Postfix on Gentoo.\n\n### Issue Type\n\nBug Report\n\n### Component Name\n\nansible.builtin.service\n\n### Ansible Version\n\n```console (paste below)\r\n$ ansible --version\r\nansible 2.10.3\r\n  config file = /home/thomas/git/ansible/ansible.cfg\r\n  configured module search path = ['/home/thomas/git/ansible/library']\r\n  ansible python module location = /home/thomas/.python-venvs/_home_thomas_git_ansible/lib/python3.6/site-packages/ansible\r\n  executable location = /home/thomas/.python-venvs/_home_thomas_git_ansible/bin/ansible\r\n  python version = 3.6.9 (default, Jan 26 2021, 15:33:00) [GCC 8.4.0]\r\n\r\n```\r\n\n\n### Configuration\n\n```console (paste below)\r\n$ ansible-config dump --only-changed\r\n[-- nothing relevant --]\r\n```\r\n\n\n### OS / Environment\n\nTarget system is Gentoo with the current mail-mta/postfix-3.5.8-r1 installed\n\n### Steps to Reproduce\n\nInstall postfix on gentoo, then run the following task:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n- name: enable postfix service\r\n  ansible.builtin.service:\r\n    name: postfix\r\n    state: started\r\n    enabled: true\r\n```\r\n\r\nand re-run it.\n\n### Expected Results\n\nIn first run, task-state should be \"changed\". In any subsequent run, task-state should be \"OK\".\n\n### Actual Results\n\nTask-state is always \"changed\".\r\n",
        "created_at": "2021-03-17T16:02:53Z",
        "user": "TWitzenrath",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 73875,
        "title": "ansible-vault strips passwords",
        "body": "### Summary\r\n\r\nAnsible vault seems to strip whitespace from passwords, so `         foo           `  is the same as `foo`. I don't think this is quite dangerous thing to do for security.\r\n\r\nNoticed this as I'm generating ansible-vaults from python code, such as:\r\n```\r\nfrom ansible.parsing.vault import VaultLib, VaultSecret\r\n\r\ndef generate_ansible_vault(vault_key: bytes, content: dict) -> bytes:\r\n    vault_secret = VaultSecret(vault_key)\r\n    vault = VaultLib()\r\n    content_json = json.dumps(content)\r\n    return vault.encrypt(content_json, vault_secret)\r\n```\r\n\r\nwhich are then consumed using standard `ansible-vault` cli. `vault_key` is generated from random bytes, which might result in whitespace characters too. While I do realize the python api isn't supported, I think it's a bit nasty thing to do still, as even I used `ansible-vault` to generate the vaults, it would actually be encrypted with different secret I thought it would be.\r\n\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible-vault\r\n\r\n### Ansible Version\r\n\r\n```\r\n2.9.9\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console\r\n$ ansible-config dump --only-changed\r\n(no changes)\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nany\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\necho \"    foo    \" > vault-secret\r\nansible-vault create --vault-password-file ./vault-secret ./vault\r\n\r\n\r\necho \"foo\" > vault-secret2\r\nansible-vault view --vault-password-file ./vault-secret2 ./vault\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nShould not be possible to decrypt the vault with password that's not the same that was used to encrypt it.\r\n\r\n### Actual Results\r\n\r\nVault decrypts with both files",
        "created_at": "2021-03-12T12:06:07Z",
        "user": "lassizci",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 73807,
        "title": "spwd.getspnam() doesn't work on sssd user",
        "body": "### Summary\r\n\r\nTrying to add a user to a group.\r\nThe user is managed by sssd.\r\nspwd.getspnam() is not supported in this scenario.\r\nsee https://bugzilla.redhat.com/show_bug.cgi?id=751291\r\n\r\n### Issue Type\r\n\r\nBug Report\r\n\r\n### Component Name\r\n\r\nansible.builtin.user\r\n\r\n### Ansible Version\r\n\r\n```console (paste below)\r\n2.10.6\r\n```\r\n\r\n\r\n### Configuration\r\n\r\n```console (paste below)\r\n$ ansible-config dump --only-changed\r\n\r\n```\r\n\r\n\r\n### OS / Environment\r\n\r\nUbuntu 20.04LTS\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml (paste below)\r\n\r\n```\r\n\r\n\r\n### Expected Results\r\n\r\nThe user shall be added to a local group.\r\n\r\n### Actual Results\r\n\r\n```console (paste below)\r\nFile \\\"/tmp/ansible_user_payload_al4gejj6/ansible_user_payload.zip/ansible/modules/user.py\\\", line 996, in user_password\\r\\nOSError: [Errno 22] Invalid argument\\r\\n\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1\r\n```\r\n",
        "created_at": "2021-03-05T19:05:52Z",
        "user": "shadamik",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 73654,
        "title": "Ansible tasks slow down as host facts grow",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nAs the size of host facts is increased, there is a serious slow down in the number of tasks that can be processed per second.  This can be viewed at smaller scale, but is dramatic at ~150 nodes.  This can happen because of network facts (with many interfaces 100+), service facts, or package facts. This can also be easily reproduced with loading a large static fact structure (>100KB) and filtering to ansible_local.\r\n\r\nI was able to pin point one of the issues coming from the get_vars in the host task processing:\r\nhttps://github.com/ansible/ansible/blob/stable-2.9/lib/ansible/plugins/strategy/linear.py#L282-L283\r\n\r\nThis was seen to take <10ms with no facts and ~200ms with facts.  Since host task processing is performed serially, the result is that <= 5 tasks can be processed per second at this scale.\r\n\r\nThere is another issue with the amount of memory and the workers being spawned, but the task execution slowdown seems to be more consistent.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/vars/manager.py\r\nlib/ansible/plugins/strategy/linear.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\nansible-2.9.17-1.el8ae.noarch\r\n```paste below\r\n$ ansible --version\r\nansible 2.9.17\r\n  config file = /home/stack/scale-ssh-ansible/ansible.cfg\r\n  configured module search path = ['/home/stack/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Oct 11 2019, 15:04:54) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/home/stack/scale-ssh-ansible/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/home/stack/scale-ssh-ansible/ansible.cfg) = -o UserKnownHostsFile=/dev/null -o StrictHostKey>\r\nANSIBLE_SSH_CONTROL_PATH_DIR(/home/stack/scale-ssh-ansible/ansible.cfg) = /tmp/scale-ansible-ssh\r\nANSIBLE_SSH_RETRIES(/home/stack/scale-ssh-ansible/ansible.cfg) = 8\r\nDEFAULT_CALLBACK_WHITELIST(/home/stack/scale-ssh-ansible/ansible.cfg) = ['profile_tasks']\r\nDEFAULT_FORKS(/home/stack/scale-ssh-ansible/ansible.cfg) = 32\r\nDEFAULT_INTERNAL_POLL_INTERVAL(/home/stack/scale-ssh-ansible/ansible.cfg) = 0.005\r\nDEFAULT_TIMEOUT(/home/stack/scale-ssh-ansible/ansible.cfg) = 30\r\nINTERPRETER_PYTHON(/home/stack/scale-ssh-ansible/ansible.cfg) = auto\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nRHEL8.2\r\n\r\nThis has been seen on OpenStack compute nodes with an average of 200 network interfaces. This same effect can be reproduced without network facts and using service facts or package facts.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# baseline.yml\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - meta: clear_facts\r\n    - name: Gather facts\r\n      setup:\r\n        gather_subset:\r\n          - '!all'\r\n          - min\r\n    - name: Sleep 1\r\n      shell: sleep 1\r\n```\r\n```yaml\r\n# package-facts.yml\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - meta: clear_facts\r\n    - name: Gather facts\r\n      setup:\r\n        gather_subset:\r\n          - '!all'\r\n          - min\r\n    - name: Gather package facts\r\n      package_facts:\r\n        manager: auto\r\n    - name: Sleep 1\r\n      shell: sleep 1\r\n```\r\n```yaml\r\n# service-facts.yml\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - meta: clear_facts\r\n    - name: Gather facts\r\n      setup:\r\n        gather_subset:\r\n          - '!all'\r\n          - min\r\n    - name: Gather service facts\r\n      service_facts: # sup\r\n    - name: Sleep 1\r\n      shell: sleep 1\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nTask execution should not slow down when the number of Ansible host facts increase.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\nExecution against 179 hosts\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n$ ansible-playbook -i inventory.ini baseline.yml\r\n...SNIP...\r\nThursday 18 February 2021  15:32:19 +0000 (0:00:04.784)       0:00:08.455 ***** \r\n=============================================================================== \r\nSleep 1 ----------------------------------------------------------------- 4.78s\r\nGather facts ------------------------------------------------------------ 3.58s\r\n```\r\n```\r\n$ ansible-playbook -i inventory.ini package-facts.yml\r\n...SNIP...\r\nThursday 18 February 2021  15:34:26 +0000 (0:00:26.821)       0:00:52.222 ***** \r\n=============================================================================== \r\nSleep 1 ---------------------------------------------------------------- 26.82s\r\nGather package facts --------------------------------------------------- 21.53s\r\nGather facts ------------------------------------------------------------ 3.78s\r\n```\r\n```\r\n$ ansible-playbook -i inventory.ini service-facts.yml\r\n...SNIP...\r\nThursday 18 February 2021  15:36:00 +0000 (0:00:08.965)       0:00:26.258 ***** \r\n=============================================================================== \r\nGather service facts --------------------------------------------------- 12.44s\r\nSleep 1 ----------------------------------------------------------------- 8.97s\r\nGather facts ------------------------------------------------------------ 3.94s\r\n```",
        "created_at": "2021-02-18T17:04:35Z",
        "user": "mwhahaha",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "on_hold",
            "affects_2.15",
            "affects_2.16"
        ]
    },
    {
        "number": 73505,
        "title": "Bugs in the user module revealed by the macOS 11.1 CI job (race condition?)",
        "body": "##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWe've faced a flaky CI failure in one of the test runs for #73474 that is unrelated to changes in that PR.\r\nThe job is `macOS 11.1 - 1` and the failure seems to have happened in the preparation stage of running tests (AFAIU \u2014 when it attempted to create a test user on the system).\r\n\r\nFirst, when it tried to create a user, it failed with `\"err\": \"<dscl_cmd> DS Error: -14988 (eNotYetImplemented)\\n\", \"msg\": \"Unable to get the next available uid\", \"out\": \"list: DS error: eNotYetImplemented\\n\", \"rc\": 140` which by itself is probably not our bug but macOS's.\r\n\r\nThen, `ansible-test` attempted to restart the playbook with maximum verbosity bug this time the module didn't return the same error. Instead, it crashed with a traceback because of an uncaught exception:\r\n```python-traceback\r\nTraceback (most recent call last):\r\n  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 125, in <module>\r\n    _ansiballz_main()\r\n  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 117, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 66, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.user', init_globals=None, run_name='__main__', alter_sys=True)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 210, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 3104, in <module>\r\n  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 3061, in main\r\n  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 987, in user_info\r\n  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 982, in get_pwd_info\r\nKeyError: \"getpwnam(): name not found: 'ansibletest1'\"\r\n```\r\nThis is weird in particular because `get_pwd_info()` has a guar expression that verify that the user exists, and only if it is it calls `pwd.getpwnam()` which raises a `KeyError` meaning that it doesn't: https://github.com/ansible/ansible/blob/d3f3784/lib/ansible/modules/user.py#L982.\r\n\r\nI believe there's some disconnect between what `get_pwd_info()` and `user_exists()` do.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/modules/user.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\ndevel\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\ntests\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCI\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nUnclear\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nGreen tests, consistent returned error value, no traceback.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n```console\r\n04:35 Running become integration test role\r\n04:35 Run command: ansible-playbook become-yiavxtv5.yml -i inventory -v\r\n04:35 Using /private/var/root/ansible/test/results/.tmp/integration/become-igieu5n4-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/test/integration/integration.cfg as config file\r\n04:35 \r\n04:35 PLAY [testhost] ****************************************************************\r\n04:35 \r\n04:35 TASK [Gathering Facts] *********************************************************\r\n04:36 ok: [testhost]\r\n04:36 \r\n04:36 TASK [become : include_vars] ***************************************************\r\n04:36 ok: [testhost] => {\"ansible_facts\": {\"become_test_user\": \"ansibletest1\"}, \"ansible_included_var_files\": [\"/private/var/root/ansible/test/results/.tmp/integration/become-igieu5n4-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/test/integration/targets/become/vars/default.yml\"], \"changed\": false}\r\n04:36 \r\n04:36 TASK [become : Create test user (become_method=default)] ***********************\r\n04:37 fatal: [testhost]: FAILED! => {\"changed\": false, \"err\": \"<dscl_cmd> DS Error: -14988 (eNotYetImplemented)\\n\", \"msg\": \"Unable to get the next available uid\", \"out\": \"list: DS error: eNotYetImplemented\\n\", \"rc\": 140}\r\n04:37 \r\n04:37 PLAY RECAP *********************************************************************\r\n04:37 testhost                   : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n```\r\n_(https://dev.azure.com/ansible/ansible/_build/results?buildId=5935&view=logs&j=e7e26b6b-0449-5b74-b86f-2326428ba672&t=be008fd9-bba1-5ad4-bf4a-cb8d1937a1f3&l=3304)_\r\n\r\n```console\r\n2021-02-05T15:19:40.3242746Z 04:37 \u001b[35mWARNING: Retrying test target \"become\" with maximum verbosity.\u001b[0m\r\n2021-02-05T15:19:40.3243866Z 04:37 Running become integration test role\r\n2021-02-05T15:19:40.3245196Z 04:37 \u001b[34mPreparing temporary directory: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6\u001b[0m\r\n2021-02-05T15:19:40.3246986Z 04:37 \u001b[34mCopying test/integration/targets/become/ to /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/\u001b[0m\r\n2021-02-05T15:19:40.3249005Z 04:37 \u001b[34mCopying /private/var/root/ansible/test/lib/ansible_test/_data/ansible.cfg to /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/integration.cfg\u001b[0m\r\n2021-02-05T15:19:40.3250452Z 04:37 \u001b[34mCopying /private/var/root/ansible/test/lib/ansible_test/_data/inventory to /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory\u001b[0m\r\n2021-02-05T15:19:40.3251259Z 04:37 \u001b[36m>>> Playbook: become-p8n6c3wo.yml\r\n2021-02-05T15:19:40.3251658Z 04:37 [\r\n2021-02-05T15:19:40.3251850Z 04:37     {\r\n2021-02-05T15:19:40.3252066Z 04:37         \"gather_facts\": true,\r\n2021-02-05T15:19:40.3252331Z 04:37         \"hosts\": \"testhost\",\r\n2021-02-05T15:19:40.3252562Z 04:37         \"roles\": [\r\n2021-02-05T15:19:40.3252779Z 04:37             \"become\"\r\n2021-02-05T15:19:40.3252994Z 04:37         ],\r\n2021-02-05T15:19:40.3253195Z 04:37         \"vars\": {\r\n2021-02-05T15:19:40.3253510Z 04:37             \"output_dir\": \"/private/var/root/ansible/test/results/.tmp/output_dir\"\r\n2021-02-05T15:19:40.3253792Z 04:37         },\r\n2021-02-05T15:19:40.3254022Z 04:37         \"vars_files\": []\r\n2021-02-05T15:19:40.3254531Z 04:37     }\r\n2021-02-05T15:19:40.3254853Z 04:37 ]\u001b[0m\r\n2021-02-05T15:19:40.3255299Z 04:37 \u001b[32mRun command: ansible-playbook become-p8n6c3wo.yml -i inventory -vvvvvv\u001b[0m\r\n2021-02-05T15:19:40.3255935Z 04:37 \u001b[34mWorking directory: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration\u001b[0m\r\n2021-02-05T15:19:40.3256686Z 04:37 \u001b[34mProgram found: /private/var/root/ansible/test/lib/ansible_test/_data/injector/ansible-playbook\u001b[0m\r\n2021-02-05T15:19:40.3257290Z 04:37 \u001b[34mANSIBLE_CACHE_PLUGINS=/private/var/root/ansible/test/support/integration/plugins/cache\u001b[0m\r\n2021-02-05T15:19:40.3257757Z 04:37 \u001b[34mANSIBLE_CALLBACKS_ENABLED=junit\u001b[0m\r\n2021-02-05T15:19:40.3258354Z 04:37 \u001b[34mANSIBLE_CONFIG=/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/integration.cfg\u001b[0m\r\n2021-02-05T15:19:40.3259029Z 04:37 \u001b[34mANSIBLE_CONNECTION_PATH=/private/var/root/ansible/test/lib/ansible_test/_data/injector/ansible-connection\u001b[0m\r\n2021-02-05T15:19:40.3259549Z 04:37 \u001b[34mANSIBLE_CONTROLLER_PYTHON_WARNING=false\u001b[0m\r\n2021-02-05T15:19:40.3259988Z 04:37 \u001b[34mANSIBLE_DEPRECATION_WARNINGS=false\u001b[0m\r\n2021-02-05T15:19:40.3260389Z 04:37 \u001b[34mANSIBLE_DEVEL_WARNING=false\u001b[0m\r\n2021-02-05T15:19:40.3260911Z 04:37 \u001b[34mANSIBLE_FILTER_PLUGINS=/private/var/root/ansible/test/support/integration/plugins/filter\u001b[0m\r\n2021-02-05T15:19:40.3261379Z 04:37 \u001b[34mANSIBLE_FORCE_COLOR=true\u001b[0m\r\n2021-02-05T15:19:40.3261787Z 04:37 \u001b[34mANSIBLE_FORCE_HANDLERS=true\u001b[0m\r\n2021-02-05T15:19:40.3262188Z 04:37 \u001b[34mANSIBLE_HOST_KEY_CHECKING=false\u001b[0m\r\n2021-02-05T15:19:40.3262613Z 04:37 \u001b[34mANSIBLE_HOST_PATTERN_MISMATCH=error\u001b[0m\r\n2021-02-05T15:19:40.3263015Z 04:37 \u001b[34mANSIBLE_INVENTORY=/dev/null\u001b[0m\r\n2021-02-05T15:19:40.3263655Z 04:37 \u001b[34mANSIBLE_INVENTORY_PLUGINS=/private/var/root/ansible/test/support/integration/plugins/inventory\u001b[0m\r\n2021-02-05T15:19:40.3264227Z 04:37 \u001b[34mANSIBLE_LIBRARY=/private/var/root/ansible/test/support/integration/plugins/modules\u001b[0m\r\n2021-02-05T15:19:40.3264818Z 04:37 \u001b[34mANSIBLE_LOOKUP_PLUGINS=/private/var/root/ansible/test/support/integration/plugins/lookup\u001b[0m\r\n2021-02-05T15:19:40.3265618Z 04:37 \u001b[34mANSIBLE_MODULE_UTILS=/private/var/root/ansible/test/support/integration/plugins/module_utils\u001b[0m\r\n2021-02-05T15:19:40.3266292Z 04:37 \u001b[34mANSIBLE_PLAYBOOK_DIR=/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration\u001b[0m\r\n2021-02-05T15:19:40.3266877Z 04:37 \u001b[34mANSIBLE_PYTHON_INTERPRETER=/set/ansible_python_interpreter/in/inventory\u001b[0m\r\n2021-02-05T15:19:40.3267367Z 04:37 \u001b[34mANSIBLE_PYTHON_MODULE_RLIMIT_NOFILE=1024\u001b[0m\r\n2021-02-05T15:19:40.3267788Z 04:37 \u001b[34mANSIBLE_RETRY_FILES_ENABLED=false\u001b[0m\r\n2021-02-05T15:19:40.3268398Z 04:37 \u001b[34mANSIBLE_ROLES_PATH=/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets\u001b[0m\r\n2021-02-05T15:19:40.3268889Z 04:37 \u001b[34mANSIBLE_TEST_CI=azp\u001b[0m\r\n2021-02-05T15:19:40.3269289Z 04:37 \u001b[34mANSIBLE_TEST_COVERAGE=check\u001b[0m\r\n2021-02-05T15:19:40.3269736Z 04:37 \u001b[34mANSIBLE_TEST_PYTHON_INTERPRETER=/usr/local/bin/python3.9\u001b[0m\r\n2021-02-05T15:19:40.3270180Z 04:37 \u001b[34mANSIBLE_TEST_PYTHON_VERSION=3.9\u001b[0m\r\n2021-02-05T15:19:40.3270616Z 04:37 \u001b[34mANSIBLE_WORKER_SHUTDOWN_POLL_COUNT=100\u001b[0m\r\n2021-02-05T15:19:40.3271046Z 04:37 \u001b[34mANSIBLE_WORKER_SHUTDOWN_POLL_DELAY=0.1\u001b[0m\r\n2021-02-05T15:19:40.3271519Z 04:37 \u001b[34mCOVERAGE_CONF=/tmp/ansible-test-7kPRaebl/coveragerc\u001b[0m\r\n2021-02-05T15:19:40.3271927Z 04:37 \u001b[34mCOVERAGE_FILE=\u001b[0m\r\n2021-02-05T15:19:40.3272302Z 04:37 \u001b[34mHOME=/var/root\u001b[0m\r\n2021-02-05T15:19:40.3272649Z 04:37 \u001b[34mHTTPTESTER=1\u001b[0m\r\n2021-02-05T15:19:40.3273225Z 04:37 \u001b[34mINVENTORY_PATH=/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory\u001b[0m\r\n2021-02-05T15:19:40.3273792Z 04:37 \u001b[34mJUNIT_OUTPUT_DIR=/private/var/root/ansible/test/results/junit\u001b[0m\r\n2021-02-05T15:19:40.3274257Z 04:37 \u001b[34mKRB5_PASSWORD=P1X5-M8u9-J3L8-u1G1\u001b[0m\r\n2021-02-05T15:19:40.3274638Z 04:37 \u001b[34mLC_ALL=en_US.UTF-8\u001b[0m\r\n2021-02-05T15:19:40.3275106Z 04:37 \u001b[34mOUTPUT_DIR=/private/var/root/ansible/test/results/.tmp/output_dir\u001b[0m\r\n2021-02-05T15:19:40.3275598Z 04:37 \u001b[34mPAGER=/bin/cat\u001b[0m\r\n2021-02-05T15:19:40.3276353Z 04:37 \u001b[34mPATH=/tmp/python-19svfwm9-ansible:/private/var/root/ansible/test/lib/ansible_test/_data/injector:/private/var/root/ansible/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\u001b[0m\r\n2021-02-05T15:19:40.3277040Z 04:37 \u001b[34mPYTHONPATH=/private/var/root/ansible/lib\u001b[0m\r\n2021-02-05T15:19:40.3277531Z 04:37 \u001b[34m_ANSIBLE_COVERAGE_CONFIG=/tmp/ansible-test-7kPRaebl/coveragerc\u001b[0m\r\n2021-02-05T15:19:40.3277963Z 04:37 \u001b[34m_ANSIBLE_COVERAGE_OUTPUT=\u001b[0m\r\n2021-02-05T15:19:40.7220252Z 04:37 \u001b[0;34mansible-playbook 2.11.0.dev0\u001b[0m\r\n2021-02-05T15:19:40.7227638Z 04:37 \u001b[0;34m  config file = /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/integration.cfg\u001b[0m\r\n2021-02-05T15:19:40.7228361Z 04:37 \u001b[0;34m  configured module search path = ['/private/var/root/ansible/test/support/integration/plugins/modules']\u001b[0m\r\n2021-02-05T15:19:40.7229005Z 04:37 \u001b[0;34m  ansible python module location = /private/var/root/ansible/lib/ansible\u001b[0m\r\n2021-02-05T15:19:40.7229608Z 04:37 \u001b[0;34m  ansible collection location = /var/root/.ansible/collections:/usr/share/ansible/collections\u001b[0m\r\n2021-02-05T15:19:40.7230176Z 04:37 \u001b[0;34m  executable location = /private/var/root/ansible/bin/ansible-playbook\u001b[0m\r\n2021-02-05T15:19:40.7230829Z 04:37 \u001b[0;34m  python version = 3.9.1 (v3.9.1:1e5d33e9b9, Dec  7 2020, 12:10:52) [Clang 6.0 (clang-600.0.57)]\u001b[0m\r\n2021-02-05T15:19:40.7231340Z 04:37 \u001b[0;34m  jinja version = 2.11.2\u001b[0m\r\n2021-02-05T15:19:40.7231719Z 04:37 \u001b[0;34m  libyaml = True\u001b[0m\r\n2021-02-05T15:19:40.7232336Z 04:37 \u001b[0;34mUsing /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/integration.cfg as config file\u001b[0m\r\n2021-02-05T15:19:40.7232864Z 04:37 \u001b[0;34msetting up inventory plugins\u001b[0m\r\n2021-02-05T15:19:40.7279657Z 04:37 \u001b[0;34mhost_list declined parsing /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory as it did not pass its verify_file() method\u001b[0m\r\n2021-02-05T15:19:40.7280699Z 04:37 \u001b[0;34mscript declined parsing /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory as it did not pass its verify_file() method\u001b[0m\r\n2021-02-05T15:19:40.7281590Z 04:37 \u001b[0;34mauto declined parsing /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory as it did not pass its verify_file() method\u001b[0m\r\n2021-02-05T15:19:40.7306681Z 04:37 \u001b[0;34mParsed /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory inventory source with ini plugin\u001b[0m\r\n2021-02-05T15:19:40.8513634Z 04:38 \u001b[0;34mstatically imported: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/tasks/default.yml\u001b[0m\r\n2021-02-05T15:19:40.8609814Z 04:38 \u001b[0;34mstatically imported: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/tasks/sudo.yml\u001b[0m\r\n2021-02-05T15:19:40.8676257Z 04:38 \u001b[0;34mstatically imported: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/tasks/su.yml\u001b[0m\r\n2021-02-05T15:19:40.8740382Z 04:38 \u001b[0;34mLoading callback plugin default of type stdout, v2.0 from /private/var/root/ansible/lib/ansible/plugins/callback/default.py\u001b[0m\r\n2021-02-05T15:19:40.8803883Z 04:38 \u001b[0;34mAttempting to use 'default' callback.\u001b[0m\r\n2021-02-05T15:19:40.8804997Z 04:38 \u001b[0;34mSkipping callback 'default', as we already have a stdout callback.\u001b[0m\r\n2021-02-05T15:19:40.8805947Z 04:38 \u001b[0;34mAttempting to use 'junit' callback.\u001b[0m\r\n2021-02-05T15:19:40.8806968Z 04:38 \u001b[0;34mLoading callback plugin junit of type aggregate, v2.0 from /private/var/root/ansible/lib/ansible/plugins/callback/junit.py\u001b[0m\r\n2021-02-05T15:19:40.8807977Z 04:38 \u001b[0;34mAttempting to use 'minimal' callback.\u001b[0m\r\n2021-02-05T15:19:40.8808884Z 04:38 \u001b[0;34mSkipping callback 'minimal', as we already have a stdout callback.\u001b[0m\r\n2021-02-05T15:19:40.8810359Z 04:38 \u001b[0;34mAttempting to use 'oneline' callback.\u001b[0m\r\n2021-02-05T15:19:40.8811198Z 04:38 \u001b[0;34mSkipping callback 'oneline', as we already have a stdout callback.\u001b[0m\r\n2021-02-05T15:19:40.8812197Z 04:38 \u001b[0;34mAttempting to use 'tree' callback.\u001b[0m\r\n2021-02-05T15:19:40.8813927Z 04:38 \r\n2021-02-05T15:19:40.8814535Z 04:38 PLAYBOOK: become-p8n6c3wo.yml **************************************************\r\n2021-02-05T15:19:40.8815043Z 04:38 \u001b[0;34mPositional arguments: become-p8n6c3wo.yml\u001b[0m\r\n2021-02-05T15:19:40.8815465Z 04:38 \u001b[0;34mverbosity: 6\u001b[0m\r\n2021-02-05T15:19:40.8815868Z 04:38 \u001b[0;34mconnection: smart\u001b[0m\r\n2021-02-05T15:19:40.8816247Z 04:38 \u001b[0;34mtimeout: 10\u001b[0m\r\n2021-02-05T15:19:40.8816651Z 04:38 \u001b[0;34mforce_handlers: True\u001b[0m\r\n2021-02-05T15:19:40.8817047Z 04:38 \u001b[0;34mbecome_method: sudo\u001b[0m\r\n2021-02-05T15:19:40.8817449Z 04:38 \u001b[0;34mtags: ('all',)\u001b[0m\r\n2021-02-05T15:19:40.8818037Z 04:38 \u001b[0;34minventory: ('/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/inventory',)\u001b[0m\r\n2021-02-05T15:19:40.8818559Z 04:38 \u001b[0;34mforks: 5\u001b[0m\r\n2021-02-05T15:19:40.8818952Z 04:38 \u001b[0;34m1 plays in become-p8n6c3wo.yml\u001b[0m\r\n2021-02-05T15:19:40.8823643Z 04:38 \r\n2021-02-05T15:19:40.8824333Z 04:38 PLAY [testhost] ****************************************************************\r\n2021-02-05T15:19:40.9006207Z 04:38 \r\n2021-02-05T15:19:40.9006710Z 04:38 TASK [Gathering Facts] *********************************************************\r\n2021-02-05T15:19:40.9112270Z 04:38 \u001b[0;34m<testhost> ESTABLISH LOCAL CONNECTION FOR USER: root\u001b[0m\r\n2021-02-05T15:19:40.9112869Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c 'echo ~root && sleep 0'\u001b[0m\r\n2021-02-05T15:19:40.9240203Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/root/.ansible/tmp `\"&& mkdir \"` echo /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580 `\" && echo ansible-tmp-1612538380.911604-2024-120085188159580=\"` echo /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580 `\" ) && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.2003086Z 04:38 \u001b[0;34mIncluding module_utils file ansible/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2003872Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2032505Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/basic.py\u001b[0m\r\n2021-02-05T15:19:41.2037735Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/_text.py\u001b[0m\r\n2021-02-05T15:19:41.2038444Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_collections_compat.py\u001b[0m\r\n2021-02-05T15:19:41.2042843Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2045999Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_json_compat.py\u001b[0m\r\n2021-02-05T15:19:41.2047803Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_utils.py\u001b[0m\r\n2021-02-05T15:19:41.2050616Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/file.py\u001b[0m\r\n2021-02-05T15:19:41.2056587Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/parameters.py\u001b[0m\r\n2021-02-05T15:19:41.2060968Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/collections.py\u001b[0m\r\n2021-02-05T15:19:41.2064329Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/process.py\u001b[0m\r\n2021-02-05T15:19:41.2068179Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/sys_info.py\u001b[0m\r\n2021-02-05T15:19:41.2074887Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/converters.py\u001b[0m\r\n2021-02-05T15:19:41.2077153Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2079893Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/formatters.py\u001b[0m\r\n2021-02-05T15:19:41.2085005Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/validation.py\u001b[0m\r\n2021-02-05T15:19:41.2093347Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/warnings.py\u001b[0m\r\n2021-02-05T15:19:41.2094808Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/selectors.py\u001b[0m\r\n2021-02-05T15:19:41.2095466Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2102111Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/_selectors2.py\u001b[0m\r\n2021-02-05T15:19:41.2104910Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/distro/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2120012Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/distro/_distro.py\u001b[0m\r\n2021-02-05T15:19:41.2124135Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/ansible_collector.py\u001b[0m\r\n2021-02-05T15:19:41.2128102Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2132560Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/collector.py\u001b[0m\r\n2021-02-05T15:19:41.2137922Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/compat.py\u001b[0m\r\n2021-02-05T15:19:41.2142832Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/default_collectors.py\u001b[0m\r\n2021-02-05T15:19:41.2146753Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/aix.py\u001b[0m\r\n2021-02-05T15:19:41.2150693Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2153682Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/base.py\u001b[0m\r\n2021-02-05T15:19:41.2157538Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/darwin.py\u001b[0m\r\n2021-02-05T15:19:41.2160470Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/dragonfly.py\u001b[0m\r\n2021-02-05T15:19:41.2165530Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/freebsd.py\u001b[0m\r\n2021-02-05T15:19:41.2169489Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/hpux.py\u001b[0m\r\n2021-02-05T15:19:41.2173306Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/hurd.py\u001b[0m\r\n2021-02-05T15:19:41.2182762Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/linux.py\u001b[0m\r\n2021-02-05T15:19:41.2186495Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/netbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2191849Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/openbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2196151Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/hardware/sunos.py\u001b[0m\r\n2021-02-05T15:19:41.2198990Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/namespace.py\u001b[0m\r\n2021-02-05T15:19:41.2208355Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/aix.py\u001b[0m\r\n2021-02-05T15:19:41.2209908Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2212603Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/base.py\u001b[0m\r\n2021-02-05T15:19:41.2215608Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/darwin.py\u001b[0m\r\n2021-02-05T15:19:41.2219082Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/dragonfly.py\u001b[0m\r\n2021-02-05T15:19:41.2234845Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/fc_wwn.py\u001b[0m\r\n2021-02-05T15:19:41.2236156Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/freebsd.py\u001b[0m\r\n2021-02-05T15:19:41.2238775Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/generic_bsd.py\u001b[0m\r\n2021-02-05T15:19:41.2239696Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/hpux.py\u001b[0m\r\n2021-02-05T15:19:41.2242032Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/hurd.py\u001b[0m\r\n2021-02-05T15:19:41.2242804Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/iscsi.py\u001b[0m\r\n2021-02-05T15:19:41.2251738Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/linux.py\u001b[0m\r\n2021-02-05T15:19:41.2258328Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/netbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2266319Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/nvme.py\u001b[0m\r\n2021-02-05T15:19:41.2267382Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/openbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2268028Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/network/sunos.py\u001b[0m\r\n2021-02-05T15:19:41.2271453Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/other/facter.py\u001b[0m\r\n2021-02-05T15:19:41.2274041Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/other/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2277070Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/other/ohai.py\u001b[0m\r\n2021-02-05T15:19:41.2278966Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/sysctl.py\u001b[0m\r\n2021-02-05T15:19:41.2282118Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/apparmor.py\u001b[0m\r\n2021-02-05T15:19:41.2284145Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2293944Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/caps.py\u001b[0m\r\n2021-02-05T15:19:41.2295896Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/chroot.py\u001b[0m\r\n2021-02-05T15:19:41.2296482Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/cmdline.py\u001b[0m\r\n2021-02-05T15:19:41.2297070Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/date_time.py\u001b[0m\r\n2021-02-05T15:19:41.2304133Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/distribution.py\u001b[0m\r\n2021-02-05T15:19:41.2307443Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/dns.py\u001b[0m\r\n2021-02-05T15:19:41.2313572Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/env.py\u001b[0m\r\n2021-02-05T15:19:41.2314805Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/fips.py\u001b[0m\r\n2021-02-05T15:19:41.2321121Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/local.py\u001b[0m\r\n2021-02-05T15:19:41.2322163Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/lsb.py\u001b[0m\r\n2021-02-05T15:19:41.2326962Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/pkg_mgr.py\u001b[0m\r\n2021-02-05T15:19:41.2328652Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/platform.py\u001b[0m\r\n2021-02-05T15:19:41.2332744Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/python.py\u001b[0m\r\n2021-02-05T15:19:41.2333969Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/selinux.py\u001b[0m\r\n2021-02-05T15:19:41.2339218Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/service_mgr.py\u001b[0m\r\n2021-02-05T15:19:41.2343351Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/ssh_pub_keys.py\u001b[0m\r\n2021-02-05T15:19:41.2344926Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/system/user.py\u001b[0m\r\n2021-02-05T15:19:41.2348360Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/timeout.py\u001b[0m\r\n2021-02-05T15:19:41.2351657Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/utils.py\u001b[0m\r\n2021-02-05T15:19:41.2355804Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/base.py\u001b[0m\r\n2021-02-05T15:19:41.2358331Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2359617Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/dragonfly.py\u001b[0m\r\n2021-02-05T15:19:41.2365477Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/freebsd.py\u001b[0m\r\n2021-02-05T15:19:41.2366895Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/hpux.py\u001b[0m\r\n2021-02-05T15:19:41.2372642Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/linux.py\u001b[0m\r\n2021-02-05T15:19:41.2378496Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/netbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2380034Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/openbsd.py\u001b[0m\r\n2021-02-05T15:19:41.2384260Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/sunos.py\u001b[0m\r\n2021-02-05T15:19:41.2388079Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/facts/virtual/sysctl.py\u001b[0m\r\n2021-02-05T15:19:41.2391683Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/parsing/convert_bool.py\u001b[0m\r\n2021-02-05T15:19:41.2394719Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/parsing/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2396570Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/pycompat24.py\u001b[0m\r\n2021-02-05T15:19:41.2404187Z 04:38 \u001b[0;34mIncluding module_utils file ansible/module_utils/six/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.2450127Z 04:38 \u001b[0;34mUsing module file /private/var/root/ansible/lib/ansible/modules/setup.py\u001b[0m\r\n2021-02-05T15:19:41.2461020Z 04:38 \u001b[0;34m<testhost> PUT /private/var/root/.ansible/tmp/ansible-local-202167vd6y2o/tmp2lher5nl TO /private/var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580/AnsiballZ_setup.py\u001b[0m\r\n2021-02-05T15:19:41.2471676Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c 'chmod u+x /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580/ /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580/AnsiballZ_setup.py && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.2597636Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c '/usr/local/bin/python3.9 /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580/AnsiballZ_setup.py && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.5927128Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c 'rm -f -r /var/root/.ansible/tmp/ansible-tmp-1612538380.911604-2024-120085188159580/ > /dev/null 2>&1 && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.6107914Z 04:38 \u001b[0;32mok: [testhost]\u001b[0m\r\n2021-02-05T15:19:41.6187731Z 04:38 \u001b[0;34mMETA: ran handlers\u001b[0m\r\n2021-02-05T15:19:41.6250625Z 04:38 \r\n2021-02-05T15:19:41.6251013Z 04:38 TASK [become : include_vars] ***************************************************\r\n2021-02-05T15:19:41.6252173Z 04:38 \u001b[1;30mtask path: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/tasks/main.yml:1\u001b[0m\r\n2021-02-05T15:19:41.6394553Z 04:38 \u001b[0;34mlooking for \"default.yml\" at \"/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/vars/default.yml\"\u001b[0m\r\n2021-02-05T15:19:41.6445249Z 04:38 \u001b[0;32mok: [testhost] => {\u001b[0m\r\n2021-02-05T15:19:41.6446036Z 04:38 \u001b[0;32m    \"ansible_facts\": {\u001b[0m\r\n2021-02-05T15:19:41.6446558Z 04:38 \u001b[0;32m        \"become_test_user\": \"ansibletest1\"\u001b[0m\r\n2021-02-05T15:19:41.6446962Z 04:38 \u001b[0;32m    },\u001b[0m\r\n2021-02-05T15:19:41.6447425Z 04:38 \u001b[0;32m    \"ansible_included_var_files\": [\u001b[0m\r\n2021-02-05T15:19:41.6448074Z 04:38 \u001b[0;32m        \"/private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/vars/default.yml\"\u001b[0m\r\n2021-02-05T15:19:41.6448584Z 04:38 \u001b[0;32m    ],\u001b[0m\r\n2021-02-05T15:19:41.6448955Z 04:38 \u001b[0;32m    \"changed\": false\u001b[0m\r\n2021-02-05T15:19:41.6449333Z 04:38 \u001b[0;32m}\u001b[0m\r\n2021-02-05T15:19:41.6492930Z 04:38 \r\n2021-02-05T15:19:41.6493372Z 04:38 TASK [become : Create test user (become_method=default)] ***********************\r\n2021-02-05T15:19:41.6494460Z 04:38 \u001b[1;30mtask path: /private/var/root/ansible/test/results/.tmp/integration/become-o4y90u70-\u00c3\u2026\u00c3\u2018\u00c5\u0161\u00c3\u0152\u00ce\u00b2\u00c5\u0081\u00c3\u02c6/test/integration/targets/become/tasks/default.yml:1\u001b[0m\r\n2021-02-05T15:19:41.6649002Z 04:38 \u001b[0;34m<testhost> ESTABLISH LOCAL CONNECTION FOR USER: root\u001b[0m\r\n2021-02-05T15:19:41.6649662Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c 'echo ~root && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.6780606Z 04:38 \u001b[0;34m<testhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/root/.ansible/tmp `\"&& mkdir \"` echo /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312 `\" && echo ansible-tmp-1612538381.666223-2057-187660718325312=\"` echo /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312 `\" ) && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.8181181Z 04:39 \u001b[0;34mIncluding module_utils file ansible/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8183124Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8183797Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/_text.py\u001b[0m\r\n2021-02-05T15:19:41.8211342Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/basic.py\u001b[0m\r\n2021-02-05T15:19:41.8221301Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_collections_compat.py\u001b[0m\r\n2021-02-05T15:19:41.8224306Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8225724Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_json_compat.py\u001b[0m\r\n2021-02-05T15:19:41.8229471Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/_utils.py\u001b[0m\r\n2021-02-05T15:19:41.8230742Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/file.py\u001b[0m\r\n2021-02-05T15:19:41.8234320Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/parameters.py\u001b[0m\r\n2021-02-05T15:19:41.8240987Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/collections.py\u001b[0m\r\n2021-02-05T15:19:41.8242406Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/process.py\u001b[0m\r\n2021-02-05T15:19:41.8251141Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/sys_info.py\u001b[0m\r\n2021-02-05T15:19:41.8253812Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/converters.py\u001b[0m\r\n2021-02-05T15:19:41.8254609Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8255182Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/text/formatters.py\u001b[0m\r\n2021-02-05T15:19:41.8259472Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/validation.py\u001b[0m\r\n2021-02-05T15:19:41.8264442Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/common/warnings.py\u001b[0m\r\n2021-02-05T15:19:41.8268730Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/selectors.py\u001b[0m\r\n2021-02-05T15:19:41.8269431Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8275180Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/compat/_selectors2.py\u001b[0m\r\n2021-02-05T15:19:41.8280674Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/distro/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8292792Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/distro/_distro.py\u001b[0m\r\n2021-02-05T15:19:41.8298926Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/parsing/convert_bool.py\u001b[0m\r\n2021-02-05T15:19:41.8300483Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/parsing/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8302411Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/pycompat24.py\u001b[0m\r\n2021-02-05T15:19:41.8312886Z 04:39 \u001b[0;34mIncluding module_utils file ansible/module_utils/six/__init__.py\u001b[0m\r\n2021-02-05T15:19:41.8363286Z 04:39 \u001b[0;34mUsing module file /private/var/root/ansible/lib/ansible/modules/user.py\u001b[0m\r\n2021-02-05T15:19:41.8370225Z 04:39 \u001b[0;34m<testhost> PUT /private/var/root/.ansible/tmp/ansible-local-202167vd6y2o/tmpgw28wjyw TO /private/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\u001b[0m\r\n2021-02-05T15:19:41.8381920Z 04:39 \u001b[0;34m<testhost> EXEC /bin/sh -c 'chmod u+x /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/ /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py && sleep 0'\u001b[0m\r\n2021-02-05T15:19:41.8513417Z 04:39 \u001b[0;34m<testhost> EXEC /bin/sh -c '/usr/local/bin/python3.9 /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py && sleep 0'\u001b[0m\r\n2021-02-05T15:19:42.2205243Z 04:39 \u001b[0;34m<testhost> EXEC /bin/sh -c 'rm -f -r /var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/ > /dev/null 2>&1 && sleep 0'\u001b[0m\r\n2021-02-05T15:19:42.2350139Z 04:39 \u001b[0;31mThe full traceback is:\u001b[0m\r\n2021-02-05T15:19:42.2351364Z 04:39 \u001b[0;31mTraceback (most recent call last):\u001b[0m\r\n2021-02-05T15:19:42.2352207Z 04:39 \u001b[0;31m  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 125, in <module>\u001b[0m\r\n2021-02-05T15:19:42.2352883Z 04:39 \u001b[0;31m    _ansiballz_main()\u001b[0m\r\n2021-02-05T15:19:42.2353667Z 04:39 \u001b[0;31m  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 117, in _ansiballz_main\u001b[0m\r\n2021-02-05T15:19:42.2354446Z 04:39 \u001b[0;31m    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\u001b[0m\r\n2021-02-05T15:19:42.2355274Z 04:39 \u001b[0;31m  File \"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\", line 66, in invoke_module\u001b[0m\r\n2021-02-05T15:19:42.2356205Z 04:39 \u001b[0;31m    runpy.run_module(mod_name='ansible.modules.user', init_globals=None, run_name='__main__', alter_sys=True)\u001b[0m\r\n2021-02-05T15:19:42.2357225Z 04:39 \u001b[0;31m  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 210, in run_module\u001b[0m\r\n2021-02-05T15:19:42.2357975Z 04:39 \u001b[0;31m    return _run_module_code(code, init_globals, run_name, mod_spec)\u001b[0m\r\n2021-02-05T15:19:42.2358785Z 04:39 \u001b[0;31m  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 97, in _run_module_code\u001b[0m\r\n2021-02-05T15:19:42.2359485Z 04:39 \u001b[0;31m    _run_code(code, mod_globals, init_globals,\u001b[0m\r\n2021-02-05T15:19:42.2360241Z 04:39 \u001b[0;31m  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\u001b[0m\r\n2021-02-05T15:19:42.2360945Z 04:39 \u001b[0;31m    exec(code, run_globals)\u001b[0m\r\n2021-02-05T15:19:42.2361751Z 04:39 \u001b[0;31m  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 3104, in <module>\u001b[0m\r\n2021-02-05T15:19:42.2362678Z 04:39 \u001b[0;31m  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 3061, in main\u001b[0m\r\n2021-02-05T15:19:42.2363564Z 04:39 \u001b[0;31m  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 987, in user_info\u001b[0m\r\n2021-02-05T15:19:42.2364457Z 04:39 \u001b[0;31m  File \"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\", line 982, in get_pwd_info\u001b[0m\r\n2021-02-05T15:19:42.2365234Z 04:39 \u001b[0;31mKeyError: \"getpwnam(): name not found: 'ansibletest1'\"\u001b[0m\r\n2021-02-05T15:19:42.2365849Z 04:39 \u001b[0;31mfatal: [testhost]: FAILED! => {\u001b[0m\r\n2021-02-05T15:19:42.2366392Z 04:39 \u001b[0;31m    \"changed\": false,\u001b[0m\r\n2021-02-05T15:19:42.2371033Z 04:39 \u001b[0;31m    \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\\\", line 125, in <module>\\n    _ansiballz_main()\\n  File \\\"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\\\", line 117, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\"/var/root/.ansible/tmp/ansible-tmp-1612538381.666223-2057-187660718325312/AnsiballZ_user.py\\\", line 66, in invoke_module\\n    runpy.run_module(mod_name='ansible.modules.user', init_globals=None, run_name='__main__', alter_sys=True)\\n  File \\\"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\\\", line 210, in run_module\\n    return _run_module_code(code, init_globals, run_name, mod_spec)\\n  File \\\"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\\\", line 97, in _run_module_code\\n    _run_code(code, mod_globals, init_globals,\\n  File \\\"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\\\", line 87, in _run_code\\n    exec(code, run_globals)\\n  File \\\"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\\\", line 3104, in <module>\\n  File \\\"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\\\", line 3061, in main\\n  File \\\"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\\\", line 987, in user_info\\n  File \\\"/tmp/ansible_user_payload_01m1wm14/ansible_user_payload.zip/ansible/modules/user.py\\\", line 982, in get_pwd_info\\nKeyError: \\\"getpwnam(): name not found: 'ansibletest1'\\\"\\n\",\u001b[0m\r\n2021-02-05T15:19:42.2374425Z 04:39 \u001b[0;31m    \"module_stdout\": \"\",\u001b[0m\r\n2021-02-05T15:19:42.2375081Z 04:39 \u001b[0;31m    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\u001b[0m\r\n2021-02-05T15:19:42.2375674Z 04:39 \u001b[0;31m    \"rc\": 1\u001b[0m\r\n2021-02-05T15:19:42.2376121Z 04:39 \u001b[0;31m}\u001b[0m\r\n2021-02-05T15:19:42.3445249Z 04:39 \r\n2021-02-05T15:19:42.3446230Z 04:39 PLAY RECAP *********************************************************************\r\n2021-02-05T15:19:42.3448413Z 04:39 \u001b[0;31mtesthost\u001b[0m                   : \u001b[0;32mok=2   \u001b[0m changed=0    unreachable=0    \u001b[0;31mfailed=1   \u001b[0m skipped=0    rescued=0    ignored=0   \r\n2021-02-05T15:19:42.3448953Z 04:39 \r\n2021-02-05T15:19:42.4024393Z 04:39 \u001b[33mCommand exited with status 2 after 2.07369327545166 seconds.\u001b[0m\r\n```\r\n_(https://dev.azure.com/ansible/ansible/_build/results?buildId=5935&view=logs&j=e7e26b6b-0449-5b74-b86f-2326428ba672&t=be008fd9-bba1-5ad4-bf4a-cb8d1937a1f3&l=3593)_\r\n\r\nFull job log: [705-macos-11.1-user-module-crash-full.log](https://github.com/ansible/ansible/files/5933734/705-macos-11.1-user-module-crash-full.log)",
        "created_at": "2021-02-05T16:21:57Z",
        "user": "webknjaz",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 73457,
        "title": "DNF fails to install module stream if state is latest not present",
        "body": "##### SUMMARY\r\nTrying to install a nginx (or any other)   module stream\r\n\r\n##### ISSUE TYPE\r\nWhen setting state to latest stream wont install\r\n\r\n##### COMPONENT NAME\r\ndnf\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\n[zalent@zalent ansible]$ ansible --version\r\nansible 2.10.5\r\n  config file = /home/zalent/source_code/xstreamone-deployment/ansible/ansible.cfg\r\n  configured module search path = ['/home/zalent/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/zalent/.local/lib/python3.8/site-packages/ansible\r\n  executable location = /home/zalent/.local/bin/ansible\r\n  python version = 3.8.3 (default, Aug 18 2020, 08:56:04) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n\r\n[zalent@zalent ansible]$ /usr/bin/ansible --version\r\nansible 2.9.17\r\n  config file = /home/zalent/source_code/xstreamone-deployment/ansible/ansible.cfg\r\n  configured module search path = ['/home/zalent/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Aug 18 2020, 08:33:21) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\n```\r\n[zalent@zalent ansible]$ ansible-config dump --only-changed\r\nANSIBLE_PIPELINING(/*******/ansible.cfg) = True\r\nCACHE_PLUGIN(/home//*******/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/*******/ansible.cfg) = ./fact_cache.d\r\nDEFAULT_CALLBACK_WHITELIST(/*******/ansible.cfg) = ['profile_tasks']\r\nDEFAULT_HASH_BEHAVIOUR(/*******/ansible.cfg) = merge\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nRHEL 8.3\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```bash\r\n[zalent@zalent ansible]$ ansible -b -i inventories/zalent/hosts 10.100.52.44 -m package -a 'name=@nodejs:14 state=latest'\r\n10.100.52.44 | SUCCESS => {\r\n    \"changed\": false,\r\n    \"msg\": \"Nothing to do\",\r\n    \"rc\": 0,\r\n    \"results\": []\r\n}\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nsame command afterwards ran with state present\r\n``` bash\r\n[zalent@zalent ansible]$ ansible -b -i inventories/zalent/hosts 10.100.52.44 -m package -a 'name=@nodejs:14 state=present'\r\n10.100.52.44 | CHANGED => {\r\n    \"changed\": true,\r\n    \"msg\": \"\",\r\n    \"rc\": 0,\r\n    \"results\": [\r\n        \"Module nodejs:14 installed.\",\r\n        \"Installed: npm-1:6.14.8-1.14.15.0.1.module+el8.3.0+8610+0cf59502.x86_64\",\r\n        \"Installed: nodejs-docs-1:14.15.0-1.module+el8.3.0+8610+0cf59502.noarch\",\r\n        \"Installed: nodejs-full-i18n-1:14.15.0-1.module+el8.3.0+8610+0cf59502.x86_64\",\r\n        \"Installed: nodejs-1:14.15.0-1.module+el8.3.0+8610+0cf59502.x86_64\"\r\n    ]\r\n}\r\n````\r\n\r\n\r\n##### ACTUAL RESULTS\r\nWith state=latest module is not installed\r\n",
        "created_at": "2021-02-03T06:00:51Z",
        "user": "tomaxsas",
        "labels": [
            "python3",
            "module",
            "support:core",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 73344,
        "title": "File touch inside LXD container fails with \"Permission denied\" error despite correct permissions",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\n\r\nUsing \"touch\" state of the File module fails with \"Error, could not touch target: [Errno 13] Permission denied\" message.  \r\n\r\nPerforming the touch command manually, or using the ansible script directly succeed without issue.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\nFile\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.6\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/crash/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.5 (default, Jul 28 2020, 12:59:40) [GCC 9.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_KEEP_REMOTE_FILES(env: ANSIBLE_KEEP_REMOTE_FILES) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\nubuntu 20.04 LXD container\r\n\r\nansible_connection: lxd\r\nansible_user: root\r\n\r\nThe target directory is a host directory mounted inside the LXD container.  The directory has group write permissions and the container root user has been added to the group.  This is all verified by running the touch command either manually or via the debug script.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: touch test\r\n  file:\r\n    path: \"/var/opt/ubuntu_uid_test\"\r\n    owner: \"ubuntu\"\r\n    group: \"ubuntu\"\r\n    state: touch\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nfile is created as requested\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\ntask fails with permission error\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n<media> ESTABLISH LXD CONNECTION FOR USER: root\r\n<media> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<media> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674 `\" && echo ansible-tmp-1611445446.4263992-48841875885674=\"` echo /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3/dist-packages/ansible/modules/files/file.py\r\n<media> PUT /home/ubuntu/.ansible/tmp/ansible-local-191707bwa3ns5d/tmpg35kcsy1 TO /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674/AnsiballZ_file.py\r\n<media> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674/ /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674/AnsiballZ_file.py && sleep 0'\r\n<media> EXEC /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674/AnsiballZ_file.py && sleep 0'\r\nfatal: [media]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_diff_peek\": null,\r\n            \"_original_basename\": null,\r\n            \"access_time\": null,\r\n            \"access_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"attributes\": null,\r\n            \"backup\": null,\r\n            \"content\": null,\r\n            \"delimiter\": null,\r\n            \"directory_mode\": null,\r\n            \"follow\": true,\r\n            \"force\": false,\r\n            \"group\": \"ubuntu\",\r\n            \"mode\": null,\r\n            \"modification_time\": null,\r\n            \"modification_time_format\": \"%Y%m%d%H%M.%S\",\r\n            \"owner\": \"ubuntu\",\r\n            \"path\": \"/var/opt/ubuntu_uid_test\",\r\n            \"recurse\": false,\r\n            \"regexp\": null,\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"state\": \"touch\",\r\n            \"unsafe_writes\": null\r\n        }\r\n    },\r\n    \"msg\": \"Error, could not touch target: [Errno 13] Permission denied: b'/var/opt/ubuntu_uid_test'\",\r\n    \"path\": \"/var/opt/ubuntu_uid_test\"\r\n}\r\n```\r\nUsing the same script manually succeeds.\r\n\r\n```\r\nroot@media:~# /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1611445446.4263992-48841875885674/AnsiballZ_file.py && sleep 0'\r\n\r\n{\r\n  \"dest\": \"/var/opt/ubuntu_uid_test\",\r\n  \"changed\": true,\r\n  \"diff\": {\r\n    \"before\": {\r\n      \"path\": \"/var/opt/ubuntu_uid_test\",\r\n      \"state\": \"absent\",\r\n      \"owner\": 0,\r\n      \"group\": 0,\r\n      \"mtime\": 1611446014.1755574,\r\n      \"atime\": 1611446014.1755574\r\n    },\r\n    \"after\": {\r\n      \"path\": \"/var/opt/ubuntu_uid_test\",\r\n      \"state\": \"touch\",\r\n      \"owner\": 997,\r\n      \"group\": 997,\r\n      \"mtime\": 1611446014.180431,\r\n      \"atime\": 1611446014.180431\r\n    }\r\n  },\r\n  \"uid\": 997,\r\n  \"gid\": 997,\r\n  \"owner\": \"ubuntu\",\r\n  \"group\": \"ubuntu\",\r\n  \"mode\": \"0644\",\r\n  \"state\": \"file\",\r\n  \"size\": 0,\r\n  \"invocation\": {\r\n    \"module_args\": {\r\n      \"path\": \"/var/opt/ubuntu_uid_test\",\r\n      \"owner\": \"ubuntu\",\r\n      \"group\": \"ubuntu\",\r\n      \"state\": \"touch\",\r\n      \"recurse\": false,\r\n      \"force\": false,\r\n      \"follow\": true,\r\n      \"modification_time_format\": \"%Y%m%d%H%M.%S\",\r\n      \"access_time_format\": \"%Y%m%d%H%M.%S\",\r\n      \"_original_basename\": null,\r\n      \"_diff_peek\": null,\r\n      \"src\": null,\r\n      \"modification_time\": null,\r\n      \"access_time\": null,\r\n      \"mode\": null,\r\n      \"seuser\": null,\r\n      \"serole\": null,\r\n      \"selevel\": null,\r\n      \"setype\": null,\r\n      \"attributes\": null,\r\n      \"content\": null,\r\n      \"backup\": null,\r\n      \"remote_src\": null,\r\n      \"regexp\": null,\r\n      \"delimiter\": null,\r\n      \"directory_mode\": null,\r\n      \"unsafe_writes\": null\r\n    }\r\n  }\r\n}\r\n```",
        "created_at": "2021-01-24T00:29:37Z",
        "user": "dpantel",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 73338,
        "title": "RFE: Ansible syntax check fails to identify requires module arguments",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhile ansible syntax check is able to detect missing modules it is not able to detect missing required arguments, and it should.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nsyntax-check\r\n\r\n##### ADDITIONAL INFORMATION\r\nTake a look at example below:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- hosts: localhost\r\n  tasks:\r\n    - name: foo\r\n      copy:  # this should raise syntax error due to missing required dest argument\r\n        src: bar\r\n```\r\n`dest` is required based on https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html and this is part of the module signature.\r\n\r\n\r\n",
        "created_at": "2021-01-23T12:31:56Z",
        "user": "ssbarnea",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.15"
        ]
    },
    {
        "number": 73268,
        "title": "Task variables not evaluated when used as vars arguments for a lookup plugin",
        "body": "##### SUMMARY\r\nConsider the test playbook:\r\n```\r\n- hosts: localhost\r\n  tasks:\r\n  - debug:\r\n      msg: \"{{ lookup('url', 'https://ansible.com') }}\"\r\n    vars:\r\n      ansible_lookup_url_timeout: \"{{ 1 + 1 }}\"\r\n```\r\nThe `url` lookup's `timeout` parameter (https://docs.ansible.com/ansible/devel/collections/ansible/builtin/url_lookup.html#parameter-timeout) can be set with the variable `ansible_lookup_url_timeout`. I would expect that in the above example, the `url` lookup would run with a timeout of 2 seconds.\r\n\r\nInstead, the playbook fails:\r\n```\r\nfatal: [localhost]: FAILED! => {\"msg\": \"An unhandled exception occurred while running the lookup plugin 'url'. Error was a <class 'ansible.errors.AnsibleOptionsError'>, original message: Invalid type for configuration option plugin_type: lookup plugin: url setting: timeout : could not convert string to float: '{{ 1 + 1 }}'\"}\r\n```\r\n(I've noticed this with a less trivial expression in an own lookup; this is the smallest reproducer I could find using only core components.)\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nconfig manager\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\ndevel\r\n```\r\n",
        "created_at": "2021-01-17T21:09:07Z",
        "user": "felixfontein",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.17",
            "affects_2.18"
        ]
    },
    {
        "number": 73127,
        "title": "`ansible-galaxy collection list` fails",
        "body": "##### SUMMARY\r\nWhen running `ansible-galaxy collection list` on an Ansible 2.10.4 install, I get an error:\r\n```\r\nERROR! - None of the provided paths were usable. Please specify a valid path with --collections-path\r\n```\r\n1. When trying to specify `--collections-path` (`ansible-galaxy collection list --collections-path .`) it errors out with `ansible-galaxy: error: unrecognized arguments: --collections-path`.\r\n2. Shouldn't it just work and show the collections installed (in this case: no collections installed manually, only some in /usr/local/lib/python3.7/dist-packages/ansible_collections/ - so without #72940 it should be an empty list)?\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nansible-galaxy\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible-base 2.10.4\r\n```\r\n",
        "created_at": "2021-01-06T07:06:38Z",
        "user": "felixfontein",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.10"
        ]
    },
    {
        "number": 73074,
        "title": "Allow passing of variables with \"import_playbook\" to bypass playbook \"vars_prompt\"",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhen a variable is set in a parent playbook, and a child playbook is being imported, even if the variable exists for that server, Ansible prompts for the new variable. There should exist a way that Ansible recognizes that the variable already exists and skip the prompt.\r\n\r\nAdditionally, when the var is prompted for in the second playbook, whatever it is set to does not override the value that it was set to in the parent play.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nCore\r\n\r\n##### ADDITIONAL INFORMATION\r\ndemo1.yml\r\n```\r\n---\r\n- hosts: localhost\r\n  connection: local\r\n  tasks:\r\n    - set_fact:\r\n        fact1_prompt: 'fact'\r\n\r\n- import_playbook: demo2.yml\r\n  fact1: \"{{ fact1_prompt }}\"\r\n\r\n- hosts: localhost\r\n  connection: local\r\n  tasks:\r\n    - debug:\r\n        var: fact1\r\n```\r\n\r\ndemo2.yml\r\n```\r\n---\r\n- hosts: localhost\r\n  connection: local\r\n  vars_prompt:\r\n    - name: fact1\r\n      prompt: \"Do not prompt for me if I'm already set\"\r\n      private: no\r\n  tasks:\r\n    - debug:\r\n        var: fact1\r\n```\r\n\r\n$ ansible-playbook -i localhost, playbooks/demo1.yml\r\n```\r\nUsing /home/smacz/Documents/play-compositional/ansible.cfg as config file\r\n\r\nPLAY [localhost] ******************************************************************************************************\r\n\r\nTASK [Gathering Facts] ************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [set_fact] *******************************************************************************************************\r\nok: [localhost] => {\r\n    \"ansible_facts\": {\r\n        \"fact1\": \"fact\"\r\n    },\r\n    \"changed\": false\r\n}\r\nDo not prompt for me if I'm already set: not_fact\r\n\r\nPLAY [localhost] ******************************************************************************************************\r\n\r\nTASK [debug] **********************************************************************************************************\r\nok: [localhost] => {\r\n    \"fact1\": \"fact\"\r\n}\r\n\r\nPLAY [localhost] ******************************************************************************************************\r\n\r\nTASK [debug] **********************************************************************************************************\r\nok: [localhost] => {\r\n    \"fact1\": \"fact\"\r\n}\r\n\r\nPLAY RECAP ************************************************************************************************************\r\n```\r\n",
        "created_at": "2020-12-29T14:05:06Z",
        "user": "rafal-prasal",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 73054,
        "title": "urlencode filter doesn't accept encrypted variable",
        "body": "##### SUMMARY\r\n\r\nWhen trying to pass a encrypted variable to the `urlencode` filter ansible 2.10 returns an error.\r\n\r\nThis does not affect ansible 2.9.16. \r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nfilter\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.11.0.dev0\r\n  config file = None\r\n  configured module search path = ['/home/username/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/username/gits/ansible-debug/.venv/ansible-devel/lib/python3.8/site-packages/ansible\r\n  ansible collection location = /home/username/.ansible/collections:/usr/share/ansible/collections\r\n  executable location = /home/username/gits/ansible-debug/.venv/ansible-devel/bin/ansible\r\n  python version = 3.8.5 (default, Jul 28 2020, 12:59:40) [GCC 9.3.0]\r\n  jinja version = 2.11.2\r\n  libyaml = False\r\n```\r\n\r\n```\r\nansible 2.10.4\r\n  config file = None\r\n  configured module search path = ['/home/username/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/username/gits/ansible-debug/.venv/ansible-2.10/lib/python3.8/site-packages/ansible\r\n  executable location = /home/username/gits/ansible-debug/.venv/ansible-2.10/bin/ansible\r\n  python version = 3.8.5 (default, Jul 28 2020, 12:59:40) [GCC 9.3.0]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nDefault Configuration\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nUbuntu 20.04.1 LTS\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\nUse the sample playbook below, the vault password is `test`.\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  vars:\r\n    vaulted_var: !vault |\r\n        $ANSIBLE_VAULT;1.1;AES256\r\n        30353233336165306463306539316563386232666633346430626465393435663139396134303638\r\n        6539303730373265346461386561333333383139316131650a303833363362643564373030383637\r\n        37303732373564636666313431316664363262363836346231373334333838343464343634356165\r\n        3039316538316234380a396534623733343633623831393736333533333438393034353835633764\r\n        63393061633561306230633964343531333537393439363035356335666238363432\r\n\r\n  tasks:\r\n  - name: vaulted_var | urlencode\r\n    debug:\r\n      msg: \"{{ vaulted_var | urlencode }}\"\r\n    ignore_errors: true\r\n  - name: 'workaround: \"{}\".format(vaulted_var) | urlencode'\r\n    debug:\r\n      msg: '{{ \"{}\".format(vaulted_var) | urlencode }}'\r\n\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe `vaulted_var` should be passed to `urlencode` and return the value of `vaulted_var` with url encoding.\r\n\r\nvaulted_var: `this is a test!@#$%^&*()[]{}~/.`\r\n\r\nexpected result: `this%20is%20a%20test%21%40%23%24%25%5E%26%2A%28%29%5B%5D%7B%7D~/.`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nTASK [vaulted_var | urlencode] ***********************************************************************************************************************************************************\r\ntask path: /home/username/gits/ansible-debug/sample.play:12\r\nFound a vault_id (default) in the vaulttext\r\nWe have a secret associated with vault id (default), will try to use to decrypt None                                                                                                      \r\nTrying to use vault secret=(FileVaultSecret(filename='/home/username/gits/ansible-debug/.vault_pass')) id=default to decrypt None\r\nTrying secret FileVaultSecret(filename='/home/username/gits/ansible-debug/.vault_pass') for vault_id=default\r\nDecrypt successful with secret=FileVaultSecret(filename='/home/username/gits/ansible-debug/.vault_pass') and vault_id=default\r\nfatal: [localhost]: FAILED! => {                                                             \r\n    \"msg\": \"the field 'args' has an invalid value ({'msg': '{{ vaulted_var | urlencode }}'}), and could not be converted to an dict.The error was: not enough values to unpack (expected 2\r\n, got 1)\\n\\nThe error appears to be in '/home/username/gits/ansible-debug/sample.play': line 12, column 5, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe o\r\nffending line appears to be:\\n\\n  tasks:\\n  - name: vaulted_var | urlencode\\n    ^ here\\n\"\r\n}\r\n...ignoring\r\n```\r\n",
        "created_at": "2020-12-23T11:00:07Z",
        "user": "markwell-ch",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "files",
            "affects_2.11"
        ]
    },
    {
        "number": 73051,
        "title": "marked deprecations from lookup (possibly other) plugins are not displayed",
        "body": "##### SUMMARY\r\nUsing a `deprecated:` attribute within the `DOCUMENTATION:` string of a lookup plugin does not result in a deprecated message the way it does with (some) other plugin types (callback for example).\r\n\r\nHere's an example of such a definition, taken from the `default` callback plugin doc fragment:\r\nhttps://github.com/ansible/ansible/blob/3e9943bc5e7a9cd393757aa8100d7fed80bd316e/lib/ansible/plugins/doc_fragments/default_callback.py#L19-L23\r\n\r\nConfig manager processes the option correctly and adds the deprecation information to `C.config.DEPRECATIONS`:\r\nhttps://github.com/ansible/ansible/blob/3e9943bc5e7a9cd393757aa8100d7fed80bd316e/lib/ansible/config/manager.py#L402-L403\r\n\r\nbut that list is only processed within the `cli/__init__.py`'s `run` method:\r\nhttps://github.com/ansible/ansible/blob/3e9943bc5e7a9cd393757aa8100d7fed80bd316e/lib/ansible/cli/__init__.py#L90-L102\r\n\r\nwhich is sublcassed by each CLI command, and gets called via `super` right at the beginning, so only plugins that get invoked early have an opportunity to add to the deprecations list before it's parsed for display. `ansible-playbook` shown here but other cli commands I looked at all did the same (which makes sense, you need to show some deprecations at the beginning):\r\nhttps://github.com/ansible/ansible/blob/3e9943bc5e7a9cd393757aa8100d7fed80bd316e/lib/ansible/cli/playbook.py#L68-L70\r\n\r\n---\r\n\r\n**Special thanks to @bcoca , @sivel , and @jborean93 for helping me out and doing most of the work in tracking this down!** \ud83d\ude05\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n`lib/ansible/plugins/__init__.py`\r\n\r\n(it's difficult for me to say where exactly this should be fixed; I mentioned this file as backs all plugin types and so has opportunity to display timely deprecation warnings at the point of execution, but I'm sure Core team will know best)\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.11.0.dev0 (devel aa56a2ff6a) last updated 2020/12/21 20:13:46 (GMT -400)\r\n  config file = None\r\n  configured module search path = [u'/home/briantist/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/briantist/code/ansible/ansible.core/lib/ansible\r\n  ansible collection location = /home/briantist/code/ansible\r\n  executable location = /home/briantist/code/ansible/ansible.core/bin/ansible\r\n  python version = 2.7.17 (default, Jul 20 2020, 15:37:01) [GCC 7.5.0]\r\n  jinja version = 2.11.2\r\n  libyaml = False\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nDEFAULT_FORKS(env: ANSIBLE_FORKS) = 30\r\n```\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nubuntu 18.04\r\n\r\n##### STEPS TO REPRODUCE\r\nI put up a throwaway PR to demonstrate. See the `mcve` lookup plugin: https://github.com/briantist/community.hashi_vault/pull/1\r\n\r\n(it also contains a plugin `mcve_workaround` showing the way I will probably work around this)\r\n\r\nCI was modified in that PR to show it executed. Here's a specific run: https://github.com/briantist/community.hashi_vault/runs/1598025361?check_suite_focus=true\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n[The `Show with workaround` step](https://github.com/briantist/community.hashi_vault/runs/1598025361?check_suite_focus=true) shows the output using the workaround in `mcve_workaround`, which is also the expected result without needing the workaround.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n[The `Repro no deprecation message` step](https://github.com/briantist/community.hashi_vault/runs/1598025361?check_suite_focus=true) shows no deprecation on execution of `mcve` plugin.\r\n\r\n",
        "created_at": "2020-12-23T01:34:12Z",
        "user": "briantist",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "needs_verified",
            "affects_2.17"
        ]
    },
    {
        "number": 73005,
        "title": "builtin.shell: \"cmd\" not available for interactive use",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWhen using the `shell` module interactively (not in a playbook) only the free-form is usable, not the parameter-oriented invocation using \"cmd\", specifying cmd apparently silently fails (see example below)\r\n\r\nIf this is intended, it should at least be documented.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nshell\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.15\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/jbiegert/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.6 (default, Sep 25 2020, 00:00:00) [GCC 10.2.1 20200723 (Red Hat 10.2.1-1)]\r\n```\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```sh\r\n$ ansible localhost -m shell -a 'cmd=date' -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\nlocalhost | CHANGED | rc=0 >>\r\n\r\n$ ansible localhost -m shell -a 'date' -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\nlocalhost | CHANGED | rc=0 >>\r\nDo 17. Dez 11:01:33 CET 2020\r\n```",
        "created_at": "2020-12-17T10:11:26Z",
        "user": "azrdev",
        "labels": [
            "easyfix",
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 72916,
        "title": "[Feature request] Ability to securely use $YUM[0-9]/$DNF[0-9] env vars in yum/dnf config files.",
        "body": "##### SUMMARY\r\nUsing ansible.builtin.yum_repository or ansible.builtin.yum is missing something when using authenticated repositories. \r\n\r\nSo we have authenticated yum repositories on nexus. We use the yum_repository module to write them to our /etc/yum.repos.d directory. But as we don't like to have the password defined in the repofile or in the /etc/yum/vars files we wanted to use the YUM1-9 variables to keep the password out of the config files on the target server. We then used the \"environment:\" feature around the yum task in ansible to set YUM1 and YUM2 environment variables at deploy time. This way the credentials are stored in the ansible-vault and injected when needed. It also allows easy password rotation since they are stored centrally.\r\n\r\nBut while testing we noticed the environment variables given to ansible tasks are given in the \"ssh -C\" command line used to execute the command on the target server. So easily spotted in the process list (ps auwxf) of the ansible server. \r\n\r\nThe idea is that environment variables should not show up in the process table, but maybe we shouldn't pass passwords this way, and we're missing a feature in yum which makes this is a none-issue.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nyum_repository\r\nyum\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe repository definition:\r\n(The nexus repo's are disabled by default to not interfere with other yum commands executed on the server)\r\n```yaml\r\n---\r\n- name: Add nexus repository\r\n  yum_repository:\r\n    name: \"nexus-{{ item }}\"\r\n    enabled: no\r\n    file: \"nexus-{{ item }}\"\r\n    description: \"Nexus repo configuration for {{ item }}\"\r\n    baseurl: \"https://$YUM1:$YUM2@<nexus>/nexus/content/repositories/{{ item }}/\"\r\n    mode: 0644\r\n  loop: \"{{ nexus_repositories }}\"\r\n```\r\nThe deploy definition:\r\n```yaml\r\n---\r\n- name: deploy.yml | Install dependency modules\r\n  yum:\r\n    enablerepo: \"nexus*\"\r\n    name: \"<package>\"\r\n    state: latest\r\n  environment:\r\n    YUM1: \"{{ USER }}\"\r\n    YUM2: \"{{ USER_PASSWORD }}\"\r\n```\r\n",
        "created_at": "2020-12-09T11:12:21Z",
        "user": "stevenwbe",
        "labels": [
            "module",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 72776,
        "title": "connection variables are not recursively templating under delegation",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nBeginning in ansible 2.9.10, tasks which use ansible_connection that is dynamically evaluated (i.e., from a jinja2 expression) fail.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nansible_connection\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible --version\r\nansible 2.10.3\r\n  config file = /home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg\r\n  configured module search path = ['/home/rowagn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /sso/sfw/virtualenv/ansible2915/lib/python3.8/site-packages/ansible_base-2.10.3-py3.8.egg/ansible\r\n  executable location = /sso/sfw/virtualenv/ansible2915/bin/ansible\r\n  python version = 3.8.6 (default, Dec  1 2020, 10:43:59) [GCC 5.4.0 20160609]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nansible-config dump --only-changed\r\n[DEPRECATION WARNING]: ALLOW_WORLD_READABLE_TMPFILES option, moved to a per plugin approach that is more flexible. , use mostly the same config will work, but now controlled from\r\n the plugin itself and not using the general constant. instead. This feature will be removed in version 2.14. Deprecation warnings can be disabled by setting \r\ndeprecation_warnings=False in ansible.cfg.\r\nALLOW_WORLD_READABLE_TMPFILES(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = -C -o ControlMaster=no -o StrictHostKeyChecking=no -o GSSAPIAuthentication=no\r\nDEFAULT_EXECUTABLE(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = /etc/ansible-wrapper\r\nDEFAULT_ROLES_PATH(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = ['/usr/share/ansible/roles']\r\nDEFAULT_TIMEOUT(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = 20\r\nRETRY_FILES_ENABLED(/home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg) = False\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nUbuntu 16.04\r\nuname -a\r\nLinux localhost.localdomain.na.sas.com 4.4.0-193-generic #224-Ubuntu SMP Tue Oct 6 17:15:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nCreate a hosts file containing a host that is NOT localhost\r\n```\r\ncat ~/r\r\nrowagn-tower-test01.vsp.sas.com\r\n```\r\nThen run the following playbook:\r\n```\r\nansible-playbook test.yml -i ~/r\r\n```\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: no\r\n\r\n  tasks:\r\n  - name: determine control machine user\r\n    shell: whoami\r\n    register: whoami_control_machine_output\r\n    delegate_to: localhost\r\n    become: no\r\n\r\n  - debug: var=whoami_control_machine_output\r\n  - debug: msg=\"{{ (whoami_control_machine_output.stdout == 'awx') | ternary('ssh','local') }}\"\r\n\r\n  - name: create directory localhost\r\n    file:\r\n      path: /tmp/bogus\r\n      state: directory\r\n      mode: u=rwX,g=,o=\r\n    delegate_to: localhost\r\n    vars:\r\n      ansible_connection: \"{{ (whoami_control_machine_output.stdout == 'awx') | ternary('ssh','local') }}\"\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nOn ansible 2.9.9, the playbook runs without errors:\r\n```\r\n$ ansible-playbook test.yml -i ~/r \r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [determine control machine user] ******************************************\r\nchanged: [rowagn-tower-test01.vsp.sas.com -> localhost]\r\n\r\nTASK [debug] *******************************************************************\r\nok: [rowagn-tower-test01.vsp.sas.com] => {\r\n    \"whoami_control_machine_output\": {\r\n        \"changed\": true, \r\n        \"cmd\": \"whoami\", \r\n        \"delta\": \"0:00:00.004553\", \r\n        \"end\": \"2020-12-01 13:42:11.349327\", \r\n        \"failed\": false, \r\n        \"rc\": 0, \r\n        \"start\": \"2020-12-01 13:42:11.344774\", \r\n        \"stderr\": \"\", \r\n        \"stderr_lines\": [], \r\n        \"stdout\": \"rowagn\", \r\n        \"stdout_lines\": [\r\n            \"rowagn\"\r\n        ]\r\n    }\r\n}\r\n\r\nTASK [debug] *******************************************************************\r\nok: [rowagn-tower-test01.vsp.sas.com] => {\r\n    \"msg\": \"local\"\r\n}\r\n\r\nTASK [create directory localhost] **********************************************\r\nok: [rowagn-tower-test01.vsp.sas.com -> localhost]\r\n\r\nPLAY RECAP *********************************************************************\r\nrowagn-tower-test01.vsp.sas.com : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nOn Ansible > 2.9.9, it fails.  Here is the output from 2.10.3:\r\n```\r\n$ ansible-playbook test.yml -i ~/r -vvvv\r\nansible-playbook 2.10.3\r\n  config file = /home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg\r\n  configured module search path = ['/home/rowagn/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /sso/sfw/virtualenv/ansible2915/lib/python3.8/site-packages/ansible_base-2.10.3-py3.8.egg/ansible\r\n  executable location = /sso/sfw/virtualenv/ansible2915/bin/ansible-playbook\r\n  python version = 3.8.6 (default, Dec  1 2020, 10:43:59) [GCC 5.4.0 20160609]\r\nUsing /home/rowagn/git/oracle-core/automation/ansible/db/ansible.cfg as config file\r\n[DEPRECATION WARNING]: ALLOW_WORLD_READABLE_TMPFILES option, moved to a per \r\nplugin approach that is more flexible. , use mostly the same config will work, \r\nbut now controlled from the plugin itself and not using the general constant. \r\ninstead. This feature will be removed in version 2.14. Deprecation warnings can\r\n be disabled by setting deprecation_warnings=False in ansible.cfg.\r\nsetting up inventory plugins\r\nhost_list declined parsing /home/rowagn/r as it did not pass its verify_file() method\r\nscript declined parsing /home/rowagn/r as it did not pass its verify_file() method\r\nauto declined parsing /home/rowagn/r as it did not pass its verify_file() method\r\nParsed /home/rowagn/r inventory source with ini plugin\r\nLoading callback plugin default of type stdout, v2.0 from /sso/sfw/virtualenv/ansible2915/lib/python3.8/site-packages/ansible_base-2.10.3-py3.8.egg/ansible/plugins/callback/default.py\r\nSkipping callback 'default', as we already have a stdout callback.\r\nSkipping callback 'minimal', as we already have a stdout callback.\r\nSkipping callback 'oneline', as we already have a stdout callback.\r\n\r\nPLAYBOOK: test.yml *************************************************************\r\nPositional arguments: test.yml\r\nverbosity: 4\r\nconnection: smart\r\ntimeout: 20\r\nbecome_method: sudo\r\ntags: ('all',)\r\ninventory: ('/home/rowagn/r',)\r\nforks: 5\r\n1 plays in test.yml\r\n\r\nPLAY [all] *********************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [determine control machine user] ******************************************\r\ntask path: /home/rowagn/git/oracle-core/automation/ansible/db/test.yml:6\r\nUsing module file /sso/sfw/virtualenv/ansible2915/lib/python3.8/site-packages/ansible_base-2.10.3-py3.8.egg/ansible/modules/command.py\r\nPipelining is enabled.\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: rowagn\r\n<localhost> EXEC /etc/ansible-wrapper -c '/sso/sfw/virtualenv/ansible2915/bin/python && sleep 0'\r\nchanged: [rowagn-tower-test01.vsp.sas.com] => {\r\n    \"changed\": true,\r\n    \"cmd\": \"whoami\",\r\n    \"delta\": \"0:00:00.005582\",\r\n    \"end\": \"2020-12-01 13:43:49.748619\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"whoami\",\r\n            \"_uses_shell\": true,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": null,\r\n            \"executable\": null,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true,\r\n            \"warn\": true\r\n        }\r\n    },\r\n    \"rc\": 0,\r\n    \"start\": \"2020-12-01 13:43:49.743037\",\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"rowagn\",\r\n    \"stdout_lines\": [\r\n        \"rowagn\"\r\n    ]\r\n}\r\n\r\nTASK [debug] *******************************************************************\r\ntask path: /home/rowagn/git/oracle-core/automation/ansible/db/test.yml:12\r\nok: [rowagn-tower-test01.vsp.sas.com] => {\r\n    \"whoami_control_machine_output\": {\r\n        \"changed\": true,\r\n        \"cmd\": \"whoami\",\r\n        \"delta\": \"0:00:00.005582\",\r\n        \"end\": \"2020-12-01 13:43:49.748619\",\r\n        \"failed\": false,\r\n        \"rc\": 0,\r\n        \"start\": \"2020-12-01 13:43:49.743037\",\r\n        \"stderr\": \"\",\r\n        \"stderr_lines\": [],\r\n        \"stdout\": \"rowagn\",\r\n        \"stdout_lines\": [\r\n            \"rowagn\"\r\n        ]\r\n    }\r\n}\r\n\r\nTASK [debug] *******************************************************************\r\ntask path: /home/rowagn/git/oracle-core/automation/ansible/db/test.yml:13\r\nok: [rowagn-tower-test01.vsp.sas.com] => {\r\n    \"msg\": \"local\"\r\n}\r\n\r\nTASK [create directory localhost] **********************************************\r\ntask path: /home/rowagn/git/oracle-core/automation/ansible/db/test.yml:15\r\nfatal: [rowagn-tower-test01.vsp.sas.com]: FAILED! => {\r\n    \"msg\": \"'whoami_control_machine_output' is undefined\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\nrowagn-tower-test01.vsp.sas.com : ok=3    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\nNote that 2.9.10 and 2.9.11 fail with a different error:\r\n```\r\nTASK [create directory localhost] **********************************************\r\nfatal: [rowagn-tower-test01.vsp.sas.com]: FAILED! => {\"msg\": \"the connection plugin '{{ (whoami_control_machine_output.stdout == 'awx') | ternary('ssh','local') }}' was not found\"}\r\n```\r\n",
        "created_at": "2020-12-01T18:48:07Z",
        "user": "rwagnergit",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.10"
        ]
    },
    {
        "number": 72741,
        "title": "apt_key fails if keyring option is used. \"msg\": \"key does not seem to have been added\"",
        "body": "##### SUMMARY\r\n`apt_key` module fails to add key if `keyring` option is specified.\r\n\r\nSame configuration work fine without `keyring` option, using default common keyring file `/etc/apt/trusted.gpg`.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\napt_key\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.15\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Sep 30 2020, 13:38:04) [GCC 7.5.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_NOCOWS(/home/user/ansible/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/home/user/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_CONTROL_PATH(/home/user/ansible/ansible.cfg) = /tmp/ansible-ssh-%%h-%%p-%%r\r\nANSIBLE_SSH_RETRIES(/home/user/ansible/ansible.cfg) = 1\r\nCACHE_PLUGIN(/home/user/ansible/ansible.cfg) = memory\r\nDEFAULT_FORKS(/home/user/ansible/ansible.cfg) = 20\r\nDEFAULT_HOST_LIST(/home/user/ansible/ansible.cfg) = [u'/home/user/ansible/inventory']\r\nDEFAULT_JINJA2_EXTENSIONS(/home/user/ansible/ansible.cfg) = jinja2.ext.do,jinja2.ext.loopcontrols\r\nDEFAULT_MANAGED_STR(/home/user/ansible/ansible.cfg) = Ansible managed: {file} modified by {uid} on {host}\r\nDEFAULT_MODULE_NAME(/home/user/ansible/ansible.cfg) = shell\r\nDEFAULT_TRANSPORT(/home/user/ansible/ansible.cfg) = smart\r\nDEFAULT_VARS_PLUGIN_PATH(/home/user/ansible/ansible.cfg) = [u'/usr/lib/python2.7/dist-packages/ansible/plugins/vars']\r\nRETRY_FILES_ENABLED(/home/user/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTagret host OS: Ubuntu 16.04.7 LTS with latest updates\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: add certbot repository key\r\n  apt_key:\r\n    data: \"{{ lookup('file', 'apt-key-certbot.asc') }}\"\r\n    keyring: certbot_ubuntu_certbot.gpg\r\n    id: 75BCA694\r\n    state: present\r\n```\r\n\r\n`apt-key-certbot.asc`: https://gist.github.com/selivan/90d37fd76b56f5d1622c2196ebbb183c\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nKey should be added successfully to `/etc/apt/trusted.gpg.d/certbot_ubuntu_certbot.gpg`\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n\r\n`\"msg\": \"key does not seem to have been added\"`\r\n\r\n```paste below\r\nTASK [letsencrypt : add certbot repository key] *********************************************************************************************************\r\ntask path: /home/user/ansible/roles/letsencrypt/tasks/main.yml:17\r\nUsing module file /usr/lib/python2.7/dist-packages/ansible/modules/packaging/os/apt_key.py\r\nPipelining is enabled.\r\n<N.N.N.N> ESTABLISH SSH CONNECTION FOR USER: pavel.selivanov\r\n<N.N.N.N> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o 'User=\"pavel.selivanov\"' -o ConnectTimeout=10 -o 'ProxyCommand= ssh pavel.selivanov@172.20.113.11 -o Port=22 -W %h:%p' -o ControlPath=/tmp/ansible-ssh-%h-%p-%r N.N.N.N '/bin/sh -c '\"'\"'sudo -H -S -n  -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-yewbnlqukjbrcqvbrdmozotqsiirllum ; /usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<N.N.N.N> (1, '\\n{\"msg\": \"key does not seem to have been added\", \"failed\": true, \"id\": \"75BCA694\", \"invocation\": {\"module_args\": {\"file\": null, \"keyserver\": null, \"url\": null, \"validate_certs\": true, \"keyring\": \"certbot_ubuntu_certbot\", \"state\": \"present\", \"key\": null, \"data\": \"-----BEGIN PGP PUBLIC KEY BLOCK-----\\\\r\\\\n\\\\r\\\\nmQINBFgZ3rMBEAC++XgX78AfLYt0i/1HyW3GxuVRb/yvWA5EmXOLhM0yVPczkRDe\\\\r\\\\nqM96iTtWDx0UzX1/AL9D6jFcZ+N4DL8oWVgK2V/ZYC/zrIXGEBWOHA5BnRisn5Xr\\\\r\\\\ndZVv1Lb1iZaoAkk6CgHTh53zYUqqAs6h2AgBfXQL7aUp6FIw2Oe0tUWORL18/iRG\\\\r\\\\nLZgcd0ChuMI0C83NRtAu7ksSZJdf/9f7aQuv1mevvaUswdxW4122WEJ4ZHD7qOhh\\\\r\\\\n5at+oQ52+Je0ugLp2jLRkCGWzxZBd1koJadprS+iBR0czegb9jYv+c5HvjztsEAp\\\\r\\\\n1k5aKjcNAD44yXksRINQw07bMrBto402qLx97bxo/oNzLnDNjckQaf74H2gCt4xJ\\\\r\\\\nnaTnufRGqy+NZeJ49Vi4ks3J1SG2kIQwH2D0uOye1NcWJcMWSFbn/PJQQUQa9sib\\\\r\\\\nXC07Q9we3QbxbYFmo0HmyY2BJi3D3Z6Kn8zY4CqZkVNTO75lBUDH3+DPNZToS5Fn\\\\r\\\\nX1q789IqodZnob9rUkd0/l4INAa5YCCFr1eUDO6Xv7xhG5Kymu33q5ROptrukAcB\\\\r\\\\nTEmWFmTxb4DsR0Pl40s7FVNTF8/KOgTxM4CX/Gi1MFvzhFuxOUXqR50rwvJvCYwJ\\\\r\\\\nOuar5b+0f1WiVRtXgPFFbhTpGu0fchJpxPyngIERBtw2tnumD3jA50SgCwARAQAB\\\\r\\\\ntBlMYXVuY2hwYWQgUFBBIGZvciBjZXJ0Ym90iQI4BBMBAgAiBQJYGd6zAhsDBgsJ\\\\r\\\\nCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRCMR76OdbymlNjLD/9VW6pIKKtFtrh/\\\\r\\\\n7xJoQYKTHp6UN3pjLZb6hbiPe+tPEjknyLwOmMVumbe5Vtfgv23VIWiby6+EyjXk\\\\r\\\\nsgTI1DZej2nTwg+X463r/WH8RVQ/oNnb09HdU86q955/jXDuFFmLQmYlac7FTT2f\\\\r\\\\nRrSBLq+6Ocf7Ww4wGAeFejKrnMdti9A+xcs4bjVGOWWyOV0rE1YRvsh7W0vty/CL\\\\r\\\\nShp2qBvQHighEK/K4nue6Ib/W+taRhYetHRrp2hgJdaIZXiaaO51F5IVkpAUDP9Q\\\\r\\\\nNuZGrcQlG/9Wcpg6aOmJv2MT7KMXNNpNtb/hcy7bOcBBJkABxjZlwQQ1id6E32OA\\\\r\\\\ndoMEuw+OeKA8CgWitVME+cuj5Sz7zEre/4kRgP6EIgQ8uWboDGHTTD7bPg1RMGCx\\\\r\\\\nHO33+RCDP2HwpQamErwoRXHHNu4eqh4QdGPIl1Eb1HfiI5vMSzayZXjw73OB124h\\\\r\\\\nZngTECncvJSoAWM9Vnu45xOgdEb6O3c0QSHuYiexOjKcN5OfNPyiMDRdyZ54BT0L\\\\r\\\\n+22eBjF/KYgW7t4NHuuqUuZPecG5/GKwcIBFs63n/AG7fbk0GhEFczQq3adKREpl\\\\r\\\\n7mKMeA0x7d3+ADEffZXQ15ByDQQDu28TBMRMM9b4/CN0kfWUP4skkG0oYUKR6CBT\\\\r\\\\nMH02CcBF3c+pR6ZREHnyoN2wqY8Qkw==\\\\r\\\\n=bXUY\\\\r\\\\n-----END PGP PUBLIC KEY BLOCK-----\", \"id\": \"75BCA694\"}}}\\n', '')\r\n<N.N.N.N> Failed to connect to the host via ssh: \r\nfatal: [rep1-ire1]: FAILED! => {\r\n    \"changed\": false, \r\n    \"id\": \"75BCA694\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"data\": \"-----BEGIN PGP PUBLIC KEY BLOCK-----\\r\\n\\r\\nmQINBFgZ3rMBEAC++XgX78AfLYt0i/1HyW3GxuVRb/yvWA5EmXOLhM0yVPczkRDe\\r\\nqM96iTtWDx0UzX1/AL9D6jFcZ+N4DL8oWVgK2V/ZYC/zrIXGEBWOHA5BnRisn5Xr\\r\\ndZVv1Lb1iZaoAkk6CgHTh53zYUqqAs6h2AgBfXQL7aUp6FIw2Oe0tUWORL18/iRG\\r\\nLZgcd0ChuMI0C83NRtAu7ksSZJdf/9f7aQuv1mevvaUswdxW4122WEJ4ZHD7qOhh\\r\\n5at+oQ52+Je0ugLp2jLRkCGWzxZBd1koJadprS+iBR0czegb9jYv+c5HvjztsEAp\\r\\n1k5aKjcNAD44yXksRINQw07bMrBto402qLx97bxo/oNzLnDNjckQaf74H2gCt4xJ\\r\\nnaTnufRGqy+NZeJ49Vi4ks3J1SG2kIQwH2D0uOye1NcWJcMWSFbn/PJQQUQa9sib\\r\\nXC07Q9we3QbxbYFmo0HmyY2BJi3D3Z6Kn8zY4CqZkVNTO75lBUDH3+DPNZToS5Fn\\r\\nX1q789IqodZnob9rUkd0/l4INAa5YCCFr1eUDO6Xv7xhG5Kymu33q5ROptrukAcB\\r\\nTEmWFmTxb4DsR0Pl40s7FVNTF8/KOgTxM4CX/Gi1MFvzhFuxOUXqR50rwvJvCYwJ\\r\\nOuar5b+0f1WiVRtXgPFFbhTpGu0fchJpxPyngIERBtw2tnumD3jA50SgCwARAQAB\\r\\ntBlMYXVuY2hwYWQgUFBBIGZvciBjZXJ0Ym90iQI4BBMBAgAiBQJYGd6zAhsDBgsJ\\r\\nCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRCMR76OdbymlNjLD/9VW6pIKKtFtrh/\\r\\n7xJoQYKTHp6UN3pjLZb6hbiPe+tPEjknyLwOmMVumbe5Vtfgv23VIWiby6+EyjXk\\r\\nsgTI1DZej2nTwg+X463r/WH8RVQ/oNnb09HdU86q955/jXDuFFmLQmYlac7FTT2f\\r\\nRrSBLq+6Ocf7Ww4wGAeFejKrnMdti9A+xcs4bjVGOWWyOV0rE1YRvsh7W0vty/CL\\r\\nShp2qBvQHighEK/K4nue6Ib/W+taRhYetHRrp2hgJdaIZXiaaO51F5IVkpAUDP9Q\\r\\nNuZGrcQlG/9Wcpg6aOmJv2MT7KMXNNpNtb/hcy7bOcBBJkABxjZlwQQ1id6E32OA\\r\\ndoMEuw+OeKA8CgWitVME+cuj5Sz7zEre/4kRgP6EIgQ8uWboDGHTTD7bPg1RMGCx\\r\\nHO33+RCDP2HwpQamErwoRXHHNu4eqh4QdGPIl1Eb1HfiI5vMSzayZXjw73OB124h\\r\\nZngTECncvJSoAWM9Vnu45xOgdEb6O3c0QSHuYiexOjKcN5OfNPyiMDRdyZ54BT0L\\r\\n+22eBjF/KYgW7t4NHuuqUuZPecG5/GKwcIBFs63n/AG7fbk0GhEFczQq3adKREpl\\r\\n7mKMeA0x7d3+ADEffZXQ15ByDQQDu28TBMRMM9b4/CN0kfWUP4skkG0oYUKR6CBT\\r\\nMH02CcBF3c+pR6ZREHnyoN2wqY8Qkw==\\r\\n=bXUY\\r\\n-----END PGP PUBLIC KEY BLOCK-----\", \r\n            \"file\": null, \r\n            \"id\": \"75BCA694\", \r\n            \"key\": null, \r\n            \"keyring\": \"certbot_ubuntu_certbot\", \r\n            \"keyserver\": null, \r\n            \"state\": \"present\", \r\n            \"url\": null, \r\n            \"validate_certs\": true\r\n        }\r\n    }, \r\n    \"msg\": \"key does not seem to have been added\"\r\n}\r\n```\r\n",
        "created_at": "2020-11-27T16:51:05Z",
        "user": "selivan",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "packaging",
            "affects_2.9"
        ]
    },
    {
        "number": 72716,
        "title": "With pipelining enabled, WARNING appears during wait_for_connection",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWith pipelining enabled, WARNING appears during wait_for_connection whereas with pipelining disabled it doesn't appear.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nwait_for_connection\r\npython_discovery\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n2.9.11\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/root/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTarget: Box being PXE booted\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nEnable pipelining and try to connect to a box that isn't up yet or with ssh disabled to replicate lack of SSH from it being PXE booted.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n  - wait_for_connection:\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nIt doesn't show a WARNING like what happens with pipelining disabled.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nansible-playbook -i 'test,' test.yml -vvvv\r\nansible-playbook 2.9.9\r\n  config file = /root/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\nUsing /root/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed test, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: test.yml ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nPositional arguments: test.yml\r\nbecome_method: sudo\r\ninventory: (u'test,',)\r\nforks: 5\r\ntags: (u'all',)\r\nverbosity: 4\r\nconnection: smart\r\ntimeout: 10\r\n1 plays in test.yml\r\n\r\nPLAY [all] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [wait_for_connection] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\ntask path: /root/test.yml:7\r\nwait_for_connection: attempting ping module test\r\n<test> Attempting python interpreter discovery\r\n<test> ESTABLISH SSH CONNECTION FOR USER: None\r\n<test> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/6c666675de test '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<test> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/root/.ansible/cp/6c666675de\" does not exist\\r\\ndebug2: resolving \"test\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to test [test] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: connect to address test port 22: Connection refused\\r\\nssh: connect to host test port 22: Connection refused\\r\\n')\r\n[WARNING]: Unhandled error in Python interpreter discovery for host test: Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017  debug1: Reading configuration data /etc/ssh/ssh_config  debug1: /etc/ssh/ssh_config line 58: Applying options for *  debug1: auto-mux: Trying existing master  debug1: Control socket \"/root/.ansible/cp/6c666675de\" does not exist  debug2: resolving \"test\" port 22  debug2: ssh_connect_direct: needpriv\r\n0  debug1: Connecting to test [test] port 22.  debug2: fd 3 setting O_NONBLOCK  debug1: connect to address test port 22: Connection refused  ssh: connect to host test port 22: Connection refused\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/ping.py\r\nPipelining is enabled.\r\n\r\n```\r\nWithout pipelining:\r\n```\r\nansible-playbook 2.9.9\r\n  config file = /root/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\nUsing /root/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed test, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: test.yml ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nPositional arguments: test.yml\r\nbecome_method: sudo\r\ninventory: (u'test,',)\r\nforks: 5\r\ntags: (u'all',)\r\nverbosity: 4\r\nconnection: smart\r\ntimeout: 10\r\n1 plays in test.yml\r\n\r\nPLAY [all] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [wait_for_connection] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\r\ntask path: /root/test.yml:7\r\nwait_for_connection: attempting ping module test\r\n<test> ESTABLISH SSH CONNECTION FOR USER: None\r\n<test> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/6c666675de test '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<test> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/root/.ansible/cp/6c666675de\" does not exist\\r\\ndebug2: resolving \"test\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to test [test] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: connect to address test port 22: Connection refused\\r\\nssh: connect to host test port 22: Connection refused\\r\\n')\r\n```\r\n\r\n",
        "created_at": "2020-11-23T16:21:09Z",
        "user": "davidtluong",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "utilities",
            "affects_2.9"
        ]
    },
    {
        "number": 72703,
        "title": "Unintuitive dangerous behaviour in VaultLib.Encrypt",
        "body": "---\r\nname: \ud83d\udc1b Bug report\r\nabout: Create a report to help us improve\r\n---\r\n\r\n##### SUMMARY\r\nhttps://github.com/ansible/ansible/blob/35022e13a839d5f59a1c4a254aca12afb124373a/lib/ansible/parsing/vault/__init__.py#L621\r\nMy expectation as a developer would be that the vault_id that I pass in to this method would be used by the matcher to filter which is the best secret to use, however that is not the case.  I think this is a very dangerous behaviour as if the ansible.cfg has a config like dev/devpassword.txt,prod/prodpassword.txt, and I call encrypt('value', vault_id=prod), the value will be encrypted with the dev password, but the output object will still label it as part of the prod vault.  \r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nVaultLib\r\n\r\n##### ANSIBLE VERSION\r\nNote this affects other versions\r\n```\r\nansible 2.10.3\r\n  config file = /Users/adam/repos/config-management/ansible/ansible.cfg\r\n  configured module search path = ['/Users/adam/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.9.0 (default, Oct 27 2020, 14:15:17) [Clang 12.0.0 (clang-1200.0.32.21)]\r\n```\r\n\r\n##### CONFIGURATION\r\nRedacted to the relevant portion\r\n```paste below\r\nDEFAULT_VAULT_IDENTITY_LIST(/somepath/ansible.cfg) = ['dev@vault/get-pass-dev.sh', 'stage@vault/get-pass-stage.sh', 'prod@vault/get-pass-prod.sh']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nAll\r\n\r\n##### STEPS TO REPRODUCE\r\nRun code based on the below. Have not attempted to reproduce using ansible-vault cli.\r\n```python\r\n    loader = DataLoader()\r\n    vault_secret = CLI.setup_vault_secrets(\r\n        loader=loader,\r\n        vault_ids=C.DEFAULT_VAULT_IDENTITY_LIST\r\n    )\r\n    vault = VaultLib(vault_secret)\r\n    vault.encrypt(value, vault_id='prod')\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n'value' is encrypted with prod password.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n'value' is encrypted with dev password.\r\n",
        "created_at": "2020-11-20T23:40:43Z",
        "user": "hs-amartin",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.10",
            "affects_2.11"
        ]
    },
    {
        "number": 72674,
        "title": "systemd module is useless for user mode unless usage documented",
        "body": "##### SUMMARY\r\n\r\nSystemd module allows to set scope \"user\" for tasks. Then it says one needs Dbus session for it. Unless that doesn't work. But no guidance how to get it done using Ansible. So, for user like me, the feature doesn't have value as I'd need a sample.\r\n\r\nThis is either matter of documentation, but rather an option to module so that it creates Dbus session which is required for the feature to work.\r\n\r\n##### ISSUE TYPE\r\n- ~Documentation Report~\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nsystemd\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.9.15\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ikke/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Aug 18 2020, 08:33:21) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nRHEL 8.3\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n[Here is an example](https://gist.github.com/ikke-t/b6ea0da1059371dd771a6eb88b13706c) how I don't get the podman pods going with user session, due having problems setting user sessions with systemd module.\r\n\r\nAnd answer is not: login to target first as user and start linger. That should be instructed using Ansible.\r\n\r\nThe [role is here](https://github.com/ikke-t/podman-container-systemd/blob/rootless/tasks/main.yml), where I try to get it working in rootless branch: \r\n",
        "created_at": "2020-11-19T08:43:21Z",
        "user": "ikke-t",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 72634,
        "title": "Make ansible-test automatically install collection dependencies",
        "body": "##### SUMMARY\r\n\r\nThis week, as I was trying to get some sanity tests passing for a collection, I had some issues initially getting a dependent collection to be installed in the proper `COLLECTIONS_PATH` location, and it would be really nice\u2014since my collection's `galaxy.yml` already contains the dependency metadata\u2014if `ansible-test` would just install the collection dependencies in the proper location so I don't have to figure out how to do that manually.\r\n\r\nIt would also help with other applications like Automation Hub / Galaxy's importer, as they don't have the intelligence currently to install dependent collections when running `ansible-test sanity` either\u2014see https://issues.redhat.com/browse/AAH-154\r\n\r\nOtherwise, anyone who ever uses `ansible-test` and requires a dependent collection will have to figure out on their own that they have to install dependent collections manually, inside the same collection directory, so `ansible-test` will pick them up.\r\n\r\nOther Ansible-based test systems like Molecule have some form of automated dependency install (that can be turned on or off), and it would be nice and make it more pleasant for someone new to ansible-test if it would do it automatically as well.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\nansible-test\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRelated:\r\n\r\n  - https://issues.redhat.com/browse/AAH-154\r\n  - https://github.com/ansible-collections/community.okd/issues/57",
        "created_at": "2020-11-16T15:43:55Z",
        "user": "geerlingguy",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 72453,
        "title": "files module, rmtree failed: [Errno 2] No such file or directory: <path-of-dir>, when directory is deleted by external process",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\ndeleting of directory with many nested subfolders get [Errno 2] No such file or directory: <path-of-dir>\r\n- name: nested directory delete\r\n  file:\r\n    path: <path-of-dir>\r\n    state: absent\r\n    recurse: yes\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n  \"msg\": \"rmtree failed: [Errno 2] No such file or directory: <path-of-dir>\r\n\r\n##### COMPONENT NAME\r\nfiles module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.4.2.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/docker/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Feb 26 2020, 04:21:27) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\ntested on Linux versions\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\ncreate directory with hundreds of nested directories\r\nexecute rm -rf  on parent directory\r\nin parallel delete same directory ansible also \r\n```\r\n- name: nested directory delete\r\n  file:\r\n    path: <path-of-dir>\r\n    state: absent\r\n    recurse: yes\r\n```\r\n```\r\n  \"msg\": \"rmtree failed: [Errno 2] No such file or directory: <path-of-dir>\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nIf the file is already deleted we should not through Error, may be we give warning but not error the object of the task to delete\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2020-11-03T09:11:21Z",
        "user": "yoursmanish",
        "labels": [
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "verified",
            "system",
            "files",
            "collection"
        ]
    },
    {
        "number": 72377,
        "title": "apply_defaults for inventory (and other non-module) plugins",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhen developing modules, one can set [`apply_defaults`](https://docs.ansible.com/ansible/latest/dev_guide/developing_program_flow_modules.html#apply-defaults) in the argspec to have a `dict` argument populated with defaults, if the user didn't set it.\r\n\r\nIt would be nice if the same would be possible for inventory plugins (and other plugins that don't use an argspec).\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/plugins/inventory/__init__.py\r\n\r\n##### ADDITIONAL INFORMATION\r\nI'd like to be able to write my inventory plugin documentation like this:\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n  DOCUMENTATION = '''\r\n      name: myplugin\r\n      plugin_type: inventory\r\n      options:\r\n        report:\r\n          description: report API specific configuration\r\n          type: dict\r\n          apply_defaults: True\r\n          ...\r\n\r\n```\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2020-10-28T11:02:14Z",
        "user": "evgeni",
        "labels": [
            "inventory",
            "support:core",
            "has_pr",
            "feature",
            "affects_2.18"
        ]
    },
    {
        "number": 72224,
        "title": "Why is 'apt-get' used and doesn't respect `dpkg_options: \"force-confdef,force-confold,force-hold\"`",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nAccording to documentation Ansible uses `aptitude` for package management on Debian systems. Why does the error message say that `apt-get` is used.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.10.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/rztab/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.5 (default, Sep  5 2020, 10:50:12) [GCC 10.2.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nManjaro\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: update packages which require a server restart\r\n  apt:\r\n    name: \"{{ restart_updates }}\"\r\n    dpkg_options: \"force-confdef,force-confold,force-hold\"\r\n    state: latest\r\n    only_upgrade: yes\r\n    autoclean: yes\r\n    autoremove: yes\r\n  notify:\r\n    - schedule restart server\r\n    - refresh spong updates\r\n  tags:\r\n    - updates\r\n```\r\n\r\n\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nRespect the `Dpkg::Options::=--force-hold`\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\nfatal: [foobar]: FAILED! => {\"cache_update_time\": 1602740365, \"cache_updated\": false, \"changed\": false, \"msg\": \"'/usr/bin/apt-get -y -o \\\"Dpkg::Options::=--force-confdef\\\" -o \\\"Dpkg::Options::=--force-confold\\\" -o \\\"Dpkg::Options::=--force-hold\\\" --only-upgrade   --auto-remove  install 'linux-generic' 'linux-headers-generic' 'linux-image-generic' 'linux-libc-dev'' failed: E: Held packages were changed and -y was used without --allow-change-held-packages.\\n\", \"rc\": 100, \"stderr\": \"E: Held packages were changed and -y was used without --allow-change-held-packages.\\n\", \"stderr_lines\": [\"E: Held packages were changed and -y was used without --allow-change-held-packages.\"], \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nThe following additional packages will be installed:\\n  linux-headers-4.4.0-193 linux-headers-4.4.0-193-generic\\n  linux-image-4.4.0-193-generic linux-modules-4.4.0-193-generic\\n  linux-modules-extra-4.4.0-193-generic\\nSuggested packages:\\n  fdutils linux-doc-4.4.0 | linux-source-4.4.0 linux-tools\\nRecommended packages:\\n  thermald\\nThe following NEW packages will be installed:\\n  linux-headers-4.4.0-193 linux-headers-4.4.0-193-generic\\n  linux-image-4.4.0-193-generic linux-modules-4.4.0-193-generic\\n  linux-modules-extra-4.4.0-193-generic\\nThe following held packages will be changed:\\n  linux-generic linux-headers-generic linux-image-generic linux-libc-dev\\nThe following packages will be upgraded:\\n  linux-generic linux-headers-generic linux-image-generic linux-libc-dev\\n4 upgraded, 5 newly installed, 0 to remove and 10 not upgraded.\\n\", \"stdout_lines\": [\"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"The following additional packages will be installed:\", \"  linux-headers-4.4.0-193 linux-headers-4.4.0-193-generic\", \"  linux-image-4.4.0-193-generic linux-modules-4.4.0-193-generic\", \"  linux-modules-extra-4.4.0-193-generic\", \"Suggested packages:\", \"  fdutils linux-doc-4.4.0 | linux-source-4.4.0 linux-tools\", \"Recommended packages:\", \"  thermald\", \"The following NEW packages will be installed:\", \"  linux-headers-4.4.0-193 linux-headers-4.4.0-193-generic\", \"  linux-image-4.4.0-193-generic linux-modules-4.4.0-193-generic\", \"  linux-modules-extra-4.4.0-193-generic\", \"The following held packages will be changed:\", \"  linux-generic linux-headers-generic linux-image-generic linux-libc-dev\", \"The following packages will be upgraded:\", \"  linux-generic linux-headers-generic linux-image-generic linux-libc-dev\", \"4 upgraded, 5 newly installed, 0 to remove and 10 not upgraded.\"]}\r\n```\r\n",
        "created_at": "2020-10-15T15:35:09Z",
        "user": "aboettger-tuhh",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "packaging",
            "affects_2.14"
        ]
    },
    {
        "number": 72135,
        "title": "Dictionary host variable does not get resolved as template with 'groups' key",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nIf host variable is dictionary and contain item with 'groups' key, value for 'groups' key not resolved as template when accessing from hostvars, but resolved correctly when accessing directly (without hostvars).\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n!component\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```ansible 2.9.13\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/ildar/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Jul 20 2020, 15:37:01) [GCC 7.5.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nUbuntu 18.04.5 LTS on WSL2\r\n```\r\nuname -a\r\nLinux ws-10713 4.19.128-microsoft-standard #1 SMP Tue Jun 23 12:58:10 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nFollowing hosts file (hosts):\r\n```\r\n[TEST]\r\ntest_host\r\n```\r\nFollowing host vars file (host_vars/test_host.yaml):\r\n```\r\nvar1: \"test\"\r\nvar2: \"{{ var1 }}\"\r\nobj1:\r\n  item: \"{{ var2 }}\"\r\nobj2:\r\n  groups: \"{{ var2 }}\"\r\n```\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```bash\r\nansible -i hosts test_host -m debug -a 'msg='\"'\"'[\"hostvars.test_host.var1: {{ hostvars.test_host.var1 }}\", \"hostvars.test_host.var2: {{ hostvars.test_host.var2 }}\", \"hostvars.test_host.obj1: {{ hostvars.test_host.obj1 }}\", \"hostvars.test_host.obj2: {{ hostvars.test_host.obj2 }}\", \"obj2: {{ obj2 }}\"]'\"'\"''\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\ntest_host | SUCCESS => {\r\n    \"msg\": [\r\n        \"hostvars.test_host.var1: test\", \r\n        \"hostvars.test_host.var2: test\", \r\n        \"hostvars.test_host.obj1: {u'item': u'test'}\", \r\n        \"hostvars.test_host.obj2: {u'groups': u'test'}\", \r\n        \"obj2: {u'groups': u'test'}\"\r\n    ]\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\ntest_host | SUCCESS => {\r\n    \"msg\": [\r\n        \"hostvars.test_host.var1: test\", \r\n        \"hostvars.test_host.var2: test\", \r\n        \"hostvars.test_host.obj1: {u'item': u'test'}\", \r\n        \"hostvars.test_host.obj2: {u'groups': u'{{ var2 }}'}\", \r\n        \"obj2: {u'groups': u'test'}\"\r\n    ]\r\n}\r\n```\r\n",
        "created_at": "2020-10-07T11:32:21Z",
        "user": "IldarMinaev",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 72110,
        "title": "module mutually exclusive check not mathematically based",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nTo trigger a mutual exclusive check, two things would need to be true. The validation check does not work that way.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n!component +lib/ansible/module_utils/common/validation.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.10.1\r\n  config file = None\r\n  configured module search path = ['/Users/richardmendes/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/richardmendes/.pyenv/versions/3.8.5/lib/python3.8/site-packages/ansible\r\n  executable location = /Users/richardmendes/.pyenv/versions/3.8.5/bin/ansible\r\n  python version = 3.8.5 (default, Sep 14 2020, 14:01:57) [Clang 11.0.3 (clang-1103.0.32.62)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\n# Empty List\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nmacOS Catalina, CentOS 7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n\r\nI use the git module to illustrate the problem. In the example below, bare is false and separate_git_dir is set to a value. Those are not mutually exclusive in the mathematical sense. If I define bare true and separate_git_dir as the empty string, it fails with the same error. The only way around this is to not define one of the two parameters.\r\n\r\nIf you check validation.py, you will see that check_mutually_exclusive is simply counting keys. It would need to look at values if it were doing a mathematical check.\r\n\r\n```yaml\r\n---\r\n\r\n- hosts: all\r\n\r\n  tasks:\r\n    - name: \"use git\"\r\n      git:\r\n        repo: https://github.com/zeek/zeek-docker.git\r\n        dest: /tmp/zeek-docker\r\n        bare: false\r\n        separate_git_dir: /tmp/zeek-docker-workspace\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nI expect to have the repo cloned to /tmp/zeek-docker-workspace. \r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/setup.py\r\n<127.0.0.1> PUT /home/vagrant/.ansible/tmp/ansible-local-4630C2uwi3/tmpVlMXi_ TO /home/vagrant/.ansible/tmp/ansible-tmp-1601930816.66-4639-63982609730351/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/vagrant/.ansible/tmp/ansible-tmp-1601930816.66-4639-63982609730351/ /home/vagrant/.ansible/tmp/ansible-tmp-1601930816.66-4639-63982609730351/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /home/vagrant/.ansible/tmp/ansible-tmp-1601930816.66-4639-63982609730351/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/vagrant/.ansible/tmp/ansible-tmp-1601930816.66-4639-63982609730351/ > /dev/null 2>&1 && sleep 0'\r\nok: [127.0.0.1]\r\nMETA: ran handlers\r\n\r\nTASK [use git] **************************************************************************************************************************************************************************\r\ntask path: /vagrant/playbooks/test_mutually_exclusive.yml:6\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: vagrant\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~vagrant && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/vagrant/.ansible/tmp `\"&& mkdir \"` echo /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058 `\" && echo ansible-tmp-1601930817.33-4701-164150654675058=\"` echo /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/git.py\r\n<127.0.0.1> PUT /home/vagrant/.ansible/tmp/ansible-local-4630C2uwi3/tmpWbwC9b TO /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058/AnsiballZ_git.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058/ /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058/AnsiballZ_git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058/AnsiballZ_git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/vagrant/.ansible/tmp/ansible-tmp-1601930817.33-4701-164150654675058/ > /dev/null 2>&1 && sleep 0'\r\nThe full traceback is:\r\nWARNING: The below traceback may *not* be related to the actual failure.\r\n  File \"/tmp/ansible_git_payload_QfHK85/ansible_git_payload.zip/ansible/module_utils/basic.py\", line 1591, in _check_mutually_exclusive\r\n    check_mutually_exclusive(spec, param)\r\n  File \"/tmp/ansible_git_payload_QfHK85/ansible_git_payload.zip/ansible/module_utils/common/validation.py\", line 66, in check_mutually_exclusive\r\n    raise TypeError(to_native(msg))\r\nfatal: [127.0.0.1]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"bare\": false,\r\n            \"dest\": \"/tmp/zeek-docker\",\r\n            \"repo\": \"https://github.com/zeek/zeek-docker.git\",\r\n            \"separate_git_dir\": \"/tmp/zeek-docker-workspace\"\r\n        }\r\n    },\r\n    \"msg\": \"parameters are mutually exclusive: separate_git_dir|bare\"\r\n}\r\n\r\n```\r\n",
        "created_at": "2020-10-05T20:53:32Z",
        "user": "ghost",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "verified",
            "affects_2.10"
        ]
    },
    {
        "number": 71956,
        "title": "Using action for execute a module fails",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nUsing \"action\" for running a module from a variable that contains the module name fails if it uses \"raw_parameters\".\r\nIf I specify the command instead the var it works, but defeats the purpose of using a single task for 2 platforms.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\naction\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.8.8\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nDEFAULT_BECOME(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_ASK_PASS(/etc/ansible/ansible.cfg) = False\r\nDEFAULT_BECOME_METHOD(/etc/ansible/ansible.cfg) = sudo\r\nDEFAULT_BECOME_USER(/etc/ansible/ansible.cfg) = root\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\r\nDEFAULT_ROLES_PATH(/etc/ansible/ansible.cfg) = [u'/etc/ansible/roles', u'/usr/share/ansible/roles']\r\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = debug\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nRed Hat Enterprise Linux Server release 7.8 (Maipo)\r\nLinux xxxxxxxxx 3.10.0-1127.13.1.el7.x86_64 #1 SMP Fri Jun 12 14:34:17 EDT 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- name: test mod\r\n  hosts: yourhostname\r\n  tasks:\r\n\r\n  - name: set fact\r\n    set_fact:\r\n      mod_to_exec: \"{% if ansible_os_family == 'Windows' %}win_shell{% else %}shell{% endif %}\"\r\n      cmd_to_exec: \"{% if ansible_os_family == 'Windows' %}net user{% else %}/usr/bin/id{% endif %}\"\r\n\r\n  - name: check username\r\n    action: \"{{ mod_to_exec }} {{ cmd_to_exec }} my_username\"\r\n    register: verify\r\n\r\n  - debug:\r\n      var: verify\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\nThe action task will execute win_shell or shell depending on the host platform\r\n\r\n```\r\nTASK [check username _raw_params={{ cmd_to_exec }} my_username] ******************************************************************************************************************************************************************************\r\nFriday 25 September 2020  18:37:38 -0300 (0:00:00.067)       0:00:02.539 ****** \r\nfatal: [yourhostname]: FAILED! => {\r\n    \"changed\": true, \r\n    \"cmd\": \"/usr/bin/id my_username\", \r\n    \"delta\": \"0:00:00.008629\", \r\n    \"end\": \"2020-09-25 18:37:39.524751\", \r\n    \"rc\": 1, \r\n    \"start\": \"2020-09-25 18:37:39.516122\"\r\n}\r\n\r\nSTDERR:\r\n\r\n/usr/bin/id: my_username: no such user\r\n\r\n\r\nMSG:\r\n\r\nnon-zero return code\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nThe play fails with error \"no command given\"\r\n\r\n```\r\nPLAY [test mod] ******************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts gather_subset=['all'], gather_timeout=10] ******************************************************************************************************************************************************************************\r\nFriday 25 September 2020  18:29:40 -0300 (0:00:00.129)       0:00:00.129 ****** \r\nok: [yourhostname]\r\n\r\nTASK [set fact cmd_to_exec={% if ansible_os_family == 'Windows' %}net user{% else %}/usr/bin/id{% endif %}, mod_to_exec={% if ansible_os_family == 'Windows' %}win_shell{% else %}shell{% endif %}] ******************************************\r\nFriday 25 September 2020  18:29:43 -0300 (0:00:02.424)       0:00:02.553 ****** \r\nok: [yourhostname]\r\n\r\nTASK [check username _variable_params={{ cmd_to_exec }} my_username] *************************************************************************************************************************************************************************\r\nFriday 25 September 2020  18:29:43 -0300 (0:00:00.069)       0:00:02.623 ****** \r\nfatal: [yourhostname]: FAILED! => {\r\n    \"changed\": false, \r\n    \"rc\": 256\r\n}\r\n\r\nMSG:\r\n\r\nno command given\r\n\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************************************************************\r\nyourhostname    : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0  \r\n```\r\n",
        "created_at": "2020-09-25T21:39:38Z",
        "user": "FedeHAL",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 71828,
        "title": "lineinfile module: non existing file is not created when using \"backrefs\"",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nlininfile module returns a fatal when trying to work on non existing file with **backrefs: yes**\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\nlineinfile.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.9.6\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/wojtosz/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.2 (default, Jul 16 2020, 14:00:26) [GCC 9.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nDEFAULT_FORKS(/home/wojtosz/ansible/ansible.cfg) = 10\r\nDEFAULT_HOST_LIST(/home/wojtosz/ansible/ansible.cfg) = ['/home/wojtosz/ansible/hosts']\r\nINTERPRETER_PYTHON(/home/wojtosz/ansible/ansible.cfg) = auto_silent\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nOS: Ubuntu 20.04.1 LTS\r\nKernel: 5.4.0-47-generic\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\nExecute task:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- name: NRPE check MySQL/MariaDB\r\n  lineinfile:\r\n    path: /etc/nagios/nrpe.d/check_mysql.cfg\r\n    line: command[check_mysql]=/usr/lib/nagios/plugins/check_mysql -u nrpe -p RANDOM_PASS\r\n    state: present\r\n    regexp: '^command(.*)u nrpe(.*)RANDOM_PASS$'\r\n    backrefs: yes\r\n    owner: root\r\n    group: root\r\n    mode: '0644'\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nIf \"path\" file **does not** exists, should be created with declared in \"line\" content.\r\nIf \"path\" file **does exists**, and \"RANDOM_PASS\" string is replaced by secret, the \"path\" file should not be changed.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\nFile is not created, fatal error:\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nfatal: [devnode]: FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backrefs\": true,\r\n            \"backup\": false,\r\n            \"content\": null,\r\n            \"create\": false,\r\n            \"delimiter\": null,\r\n            \"directory_mode\": null,\r\n            \"firstmatch\": false,\r\n            \"follow\": false,\r\n            \"force\": null,\r\n            \"group\": \"root\",\r\n            \"insertafter\": null,\r\n            \"insertbefore\": null,\r\n            \"line\": \"command[check_mysql]=/usr/lib/nagios/plugins/check_mysql -u nrpe -p RANDOM_PASS\",\r\n            \"mode\": \"0644\",\r\n            \"owner\": \"root\",\r\n            \"path\": \"/etc/nagios/nrpe.d/check_mysql.cfg\",\r\n            \"regexp\": \"^command(.*)u nrpe(.*)RANDOM_PASS$\",\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"state\": \"present\",\r\n            \"unsafe_writes\": null,\r\n            \"validate\": null\r\n        }\r\n    },\r\n    \"msg\": \"Destination /etc/nagios/nrpe.d/check_mysql.cfg does not exist !\",\r\n    \"rc\": 257\r\n}\r\n\r\n```\r\n",
        "created_at": "2020-09-20T14:10:54Z",
        "user": "wifibox",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "files",
            "affects_2.9"
        ]
    },
    {
        "number": 71745,
        "title": "Loop variable can be undefined when using delegate after upgrade to 2.9.10",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhen using the loop variable (typically 'item') to get a hostvar value in order to set a var for a delegated task, the error 'FAILED! => {\"msg\": \"'item' is undefined\"}' is produced.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ndelegation, hostvars\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.10\r\n  config file = None\r\n  configured module search path = ['/Users/jrosser/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/jrosser/cloud/handler-test/venv/lib/python3.8/site-packages/ansible\r\n  executable location = /Users/jrosser/cloud/handler-test/venv/bin/ansible\r\n  python version = 3.8.5 (default, Jul 21 2020, 10:42:08) [Clang 11.0.0 (clang-1100.0.33.17)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n(venv) RD016047:handler-test jrosser$ ansible-config dump --only-changed\r\n(venv) RD016047:handler-test jrosser$\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentos/Focal/Bionic/Buster/OSX (every target tested)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nInventory and test playbook are included in the link below. The example is contrived but derived from a real case where handlers need to run against a specific host then all hosts in order to bootstrap a database cluster. \r\n\r\nThere are similarities to https://github.com/ansible/ansible/issues/71092 \r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nhttp://paste.openstack.org/show/797821/\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nDelegated task would be able to use 'item' to find entries in hostvars and set task level variables accordingly.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nError message is produced.\r\n\r\nWorks on 2.9.9\r\n2.9.10 produces 'FAILED! => {\"msg\": \"'hostvars' is undefined\"}'\r\n2.9.13 produces 'FAILED! => {\"msg\": \"'item' is undefined\"}'\r\n\r\nSeems to be an issue that the behaviour has changed across a minor release.\r\n\r\nIf I swap the templated access to hostvars for 'ansible_host: query('hostvars[item]', ansible_host)' then no error is produced and the behaviour is as expected on > 2.9.9.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nSee pasted link above\r\n```\r\n",
        "created_at": "2020-09-14T12:28:50Z",
        "user": "jrosser",
        "labels": [
            "python3",
            "test",
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 71645,
        "title": "systemd enabled behave different from `systemctl enable`",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nwhen a service foo.service is belongs to a target for example: multi-user.target. Then we change the foo.service to wanted by 2 targets: test.target and multi-user.target, without disable it first. `systemctl enable foo` create a folder `/etc/systemd/system/test.target.wants` and create symlink to `foo.service` in it. The ansible fail to do so, it think the foo is already enabled. Workaround is to disable first then enable again.\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nsystemd\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\n2.9.6\r\n\r\n```\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nFedora 31\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nrun the task, then `ls /etc/systemd/system/test.target.wants` We can see there is no file in it or dir does not exist. Then try `systemctl enable foo`. We can then see the dir and symlink.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: create foo.service\r\n  copy:\r\n  path: '/etc/systemd/system/foo.service'\r\n  content: |\r\n    [Unit]\r\n    Description=foo\r\n    PartOf=test.target\r\n\r\n    [Service]\r\n    Type=simple\r\n    ExecStart=/bin/sh -c 'while true; do echo date >> /tmp/foo1.log; sleep 5; done'\r\n    [Install]\r\n    WantedBy=multi-user.target\r\n- name: create test.target\r\n  copy:\r\n  path: '/etc/systemd/system/foo.service'\r\n  content: |\r\n    [Unit]\r\n    Description=test target\r\n- name: Activate gameon systemd configuration (general/cloud)\r\n  systemd:\r\n  name: foo.service\r\n  daemon_reload: yes\r\n  enabled: yes\r\n- name: create foo.service\r\n  copy:\r\n  path: '/etc/systemd/system/foo.service'\r\n  content: |\r\n    [Unit]\r\n    Description=foo\r\n    PartOf=test.target\r\n\r\n    [Service]\r\n    Type=simple\r\n    ExecStart=/bin/sh -c 'while true; do echo date >> /tmp/foo1.log; sleep 5; done'\r\n    [Install]\r\n    WantedBy=test.target multi-user.target\r\n- name: Activate gameon systemd configuration (general/cloud)\r\n  systemd:\r\n  name: foo.service\r\n  daemon_reload: yes\r\n  enabled: yes\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2020-09-04T19:19:13Z",
        "user": "braindevices",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 71637,
        "title": "Systemd & service module doesn't reload and start service",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nI'm using the `systemd` module to enable and start an oracledb.service that I have created via ansible template. But it return always `changed` status and when I do a smoke test just after ansible service_facts report that my service is stopped.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nsystemd\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /bin/ansible\r\n  python version = 2.7.5 (default, Apr  2 2020, 13:16:51) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n+ ansible-config dump --only-changed\r\nANSIBLE_FORCE_COLOR(env: ANSIBLE_FORCE_COLOR) = True\r\nCACHE_PLUGIN(/etc/ansible/ansible.cfg) = memory\r\nDEFAULT_CALLBACK_WHITELIST(/etc/ansible/ansible.cfg) = [u'profile_tasks']\r\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 5\r\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = implicit\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = [u'/etc/ansible/hosts']\r\nDEFAULT_POLL_INTERVAL(/etc/ansible/ansible.cfg) = 15\r\nDEFAULT_ROLES_PATH(/etc/ansible/ansible.cfg) = [u'/var/lib/jenkins/jobs/custom-roles']\r\nDEFAULT_TIMEOUT(/etc/ansible/ansible.cfg) = 10\r\nDEFAULT_TRANSPORT(/etc/ansible/ansible.cfg) = smart\r\nDEFAULT_VAULT_PASSWORD_FILE(/etc/ansible/ansible.cfg) = /home/user/vps.txt\r\nDISPLAY_SKIPPED_HOSTS(/etc/ansible/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nRHEL7.8\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nFirst I have the following template \r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n[Unit]\r\nDescription=Oracle databases service\r\nAfter=network.target\r\n\r\n[Service]\r\nType=forking\r\nEnvironmentFile=/etc/sysconfig/env.oracledb\r\nExecStart={{ oracle_home }}/bin/dbstart {{ oracle_home }}\r\nExecStop={{ oracle_home }}/bin/dbshut {{ oracle_home }}\r\nUser=oracle\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n```\r\n\r\nAnd here is the env.oracle file : \r\n```yaml\r\nORACLE_BASE={{ oracle_base }}\r\nORACLE_HOME={{ oracle_home }}\r\nORACLE_SID={{ oracle_sid }}\r\n```\r\n\r\nI copy the template like this : \r\n```yaml\r\n- name: Create oracledb env file\r\n  template:\r\n    src: env.oracledb.j2\r\n    dest: /etc/sysconfig/env.oracledb\r\n    owner: root\r\n  become: yes\r\n\r\n# Add oracledb service\r\n- name: Create oracledb service\r\n  template:\r\n    src: oracledb.service.j2\r\n    dest: /etc/systemd/system/oracledb.service\r\n    owner: root\r\n  become: yes\r\n\r\n- name: Force systemd to reread configs, Enable oracledb.service & Start oracledb.service\r\n  systemd:\r\n    daemon_reload: yes\r\n    enabled: yes\r\n    name: oracledb\r\n    state: started\r\n\r\n- name: Populate service facts\r\n  service_facts:\r\n\r\n- name: Smoke test for oracledb.service\r\n  debug:\r\n    msg: \"oracledb.service is : {{ ansible_facts.services['oracledb.service'].state }}\"\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nThe oracledb.service must be started.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [oracle_server : Create oracledb service] *************************\r\ntask path: /var/lib/jenkins/jobs/custom-roles/oracle_server/tasks/oracle/oracle_systemd_service.yml:11\r\nFriday 04 September 2020  16:19:43 +0200 (0:00:00.895)       0:09:19.280 ****** \r\nchanged: [myserver] => {\"changed\": true, \"checksum\": \"d8e2f7cdd359859ad76194bee0e2eb30309634da\", \"dest\": \"/etc/systemd/system/oracledb.service\", \"gid\": 0, \"group\": \"root\", \"md5sum\": \"0af33e2ad487deb3fb27b77aeb13bc5e\", \"mode\": \"0644\", \"owner\": \"root\", \"size\": 344, \"src\": \"/root/.ansible/tmp/ansible-tmp-1599229183.32-5373-213783367455379/source\", \"state\": \"file\", \"uid\": 0}\r\n\r\nTASK [oracle_server : Force systemd to reread configs, Enable oracledb.service & Start oracledb.service] ***\r\ntask path: /var/lib/jenkins/jobs/custom-roles/oracle_server/tasks/oracle/oracle_systemd_service.yml:18\r\nFriday 04 September 2020  16:19:44 +0200 (0:00:00.890)       0:09:20.171 ****** \r\nchanged: [myserver] => {\"changed\": true, \"enabled\": true, \"name\": \"oracledb\", \"state\": \"started\", \"status\": {\"ActiveEnterTimestampMonotonic\": \"0\", \"ActiveExitTimestampMonotonic\": \"0\", \"ActiveState\": \"inactive\", \"After\": \"systemd-journald.socket basic.target system.slice network.target\", \"AllowIsolate\": \"no\", \"AmbientCapabilities\": \"0\", \"AssertResult\": \"no\", \"AssertTimestampMonotonic\": \"0\", \"Before\": \"shutdown.target\", \"BlockIOAccounting\": \"no\", \"BlockIOWeight\": \"18446744073709551615\", \"CPUAccounting\": \"no\", \"CPUQuotaPerSecUSec\": \"infinity\", \"CPUSchedulingPolicy\": \"0\", \"CPUSchedulingPriority\": \"0\", \"CPUSchedulingResetOnFork\": \"no\", \"CPUShares\": \"18446744073709551615\", \"CanIsolate\": \"no\", \"CanReload\": \"no\", \"CanStart\": \"yes\", \"CanStop\": \"yes\", \"CapabilityBoundingSet\": \"18446744073709551615\", \"ConditionResult\": \"no\", \"ConditionTimestampMonotonic\": \"0\", \"Conflicts\": \"shutdown.target\", \"ControlPID\": \"0\", \"DefaultDependencies\": \"yes\", \"Delegate\": \"no\", \"Description\": \"Oracle databases service\", \"DevicePolicy\": \"auto\", \"EnvironmentFile\": \"/etc/sysconfig/env.oracledb (ignore_errors=no)\", \"ExecMainCode\": \"0\", \"ExecMainExitTimestampMonotonic\": \"0\", \"ExecMainPID\": \"0\", \"ExecMainStartTimestampMonotonic\": \"0\", \"ExecMainStatus\": \"0\", \"ExecStart\": \"{ path=/opt/oracle/app/db/19.3.0.0.0/bin/dbstart ; argv[]=/opt/oracle/app/db/19.3.0.0.0/bin/dbstart /opt/oracle/app/db/19.3.0.0.0 ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecStop\": \"{ path=/opt/oracle/app/db/19.3.0.0.0/bin/dbshut ; argv[]=/opt/oracle/app/db/19.3.0.0.0/bin/dbshut /opt/oracle/app/db/19.3.0.0.0 ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"FailureAction\": \"none\", \"FileDescriptorStoreMax\": \"0\", \"FragmentPath\": \"/etc/systemd/system/oracledb.service\", \"GuessMainPID\": \"yes\", \"IOScheduling\": \"0\", \"Id\": \"oracledb.service\", \"IgnoreOnIsolate\": \"no\", \"IgnoreOnSnapshot\": \"no\", \"IgnoreSIGPIPE\": \"yes\", \"InactiveEnterTimestampMonotonic\": \"0\", \"InactiveExitTimestampMonotonic\": \"0\", \"JobTimeoutAction\": \"none\", \"JobTimeoutUSec\": \"0\", \"KillMode\": \"control-group\", \"KillSignal\": \"15\", \"LimitAS\": \"18446744073709551615\", \"LimitCORE\": \"18446744073709551615\", \"LimitCPU\": \"18446744073709551615\", \"LimitDATA\": \"18446744073709551615\", \"LimitFSIZE\": \"18446744073709551615\", \"LimitLOCKS\": \"18446744073709551615\", \"LimitMEMLOCK\": \"65536\", \"LimitMSGQUEUE\": \"819200\", \"LimitNICE\": \"0\", \"LimitNOFILE\": \"4096\", \"LimitNPROC\": \"63457\", \"LimitRSS\": \"18446744073709551615\", \"LimitRTPRIO\": \"0\", \"LimitRTTIME\": \"18446744073709551615\", \"LimitSIGPENDING\": \"63457\", \"LimitSTACK\": \"18446744073709551615\", \"LoadState\": \"loaded\", \"MainPID\": \"0\", \"MemoryAccounting\": \"no\", \"MemoryCurrent\": \"18446744073709551615\", \"MemoryLimit\": \"18446744073709551615\", \"MountFlags\": \"0\", \"Names\": \"oracledb.service\", \"NeedDaemonReload\": \"no\", \"Nice\": \"0\", \"NoNewPrivileges\": \"no\", \"NonBlocking\": \"no\", \"NotifyAccess\": \"none\", \"OOMScoreAdjust\": \"0\", \"OnFailureJobMode\": \"replace\", \"PermissionsStartOnly\": \"no\", \"PrivateDevices\": \"no\", \"PrivateNetwork\": \"no\", \"PrivateTmp\": \"no\", \"ProtectHome\": \"no\", \"ProtectSystem\": \"no\", \"RefuseManualStart\": \"no\", \"RefuseManualStop\": \"no\", \"RemainAfterExit\": \"no\", \"Requires\": \"basic.target system.slice\", \"Restart\": \"no\", \"RestartUSec\": \"100ms\", \"Result\": \"success\", \"RootDirectoryStartOnly\": \"no\", \"RuntimeDirectoryMode\": \"0755\", \"SameProcessGroup\": \"no\", \"SecureBits\": \"0\", \"SendSIGHUP\": \"no\", \"SendSIGKILL\": \"yes\", \"Slice\": \"system.slice\", \"StandardError\": \"inherit\", \"StandardInput\": \"null\", \"StandardOutput\": \"journal\", \"StartLimitAction\": \"none\", \"StartLimitBurst\": \"5\", \"StartLimitInterval\": \"10000000\", \"StartupBlockIOWeight\": \"18446744073709551615\", \"StartupCPUShares\": \"18446744073709551615\", \"StatusErrno\": \"0\", \"StopWhenUnneeded\": \"no\", \"SubState\": \"dead\", \"SyslogLevelPrefix\": \"yes\", \"SyslogPriority\": \"30\", \"SystemCallErrorNumber\": \"0\", \"TTYReset\": \"no\", \"TTYVHangup\": \"no\", \"TTYVTDisallocate\": \"no\", \"TasksAccounting\": \"no\", \"TasksCurrent\": \"18446744073709551615\", \"TasksMax\": \"18446744073709551615\", \"TimeoutStartUSec\": \"1min 30s\", \"TimeoutStopUSec\": \"1min 30s\", \"TimerSlackNSec\": \"50000\", \"Transient\": \"no\", \"Type\": \"forking\", \"UMask\": \"0022\", \"UnitFilePreset\": \"disabled\", \"UnitFileState\": \"disabled\", \"User\": \"oracle\", \"WatchdogTimestampMonotonic\": \"0\", \"WatchdogUSec\": \"0\"}}\r\n\r\n\r\nTASK [oracle_server : Smoke test for oracledb.service] *****************\r\ntask path: /var/lib/jenkins/jobs/custom-roles/oracle_server/tasks/oracle/oracle_systemd_service.yml:28\r\nFriday 04 September 2020  16:19:47 +0200 (0:00:01.913)       0:09:23.050 ****** \r\nok: [myserver] => {\r\n    \"msg\": \"oracledb.service is : stopped\"\r\n}\r\n```\r\n\r\nIf I had other tasks after and add a new systemd module to start again oracledb.service it will always return changed status and appear as running ...\r\n\r\nWhat is going on here ...\r\n\r\nWhy the service is shown as stopped the first time ?\r\n\r\nThank you very much for your help.\r\n\r\nBest regards,",
        "created_at": "2020-09-04T14:46:39Z",
        "user": "craph",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 71619,
        "title": "Have only one --name option for ansible-vault encrypt_string (--stdin-name vs --name)",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nProvide only a single option to provide naming for encrypt_string\r\n\r\nCustomer Request: I would think just having --name is sufficient, and if the string to encrypt isn't provided as a command line argument, then get it from stdin. If a user pipes in the string AND provides it on the command line, generate an error.\r\n\r\nI'm not sure how many users would actually type the string on the command line to begin with. Since they are encrypting it, it must be sensitive (#71618). Putting it on the command line necessitates the additional step of having to clean your history.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nansible-vault\r\n",
        "created_at": "2020-09-03T13:37:30Z",
        "user": "msilmser",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.12"
        ]
    },
    {
        "number": 71461,
        "title": "Ansible should not wrap lines when tty is absent",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nAnsible should not wrap lines when tty is absent\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nansible/lib/ansible/utils/display.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n2.10\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```bash\r\nansible-playbook foo.yml 2>&1\r\n# alternative that would wrap stderr to 79 chars when redirecting stdout\r\nansible-playbook foo.yml >>/dev/null\r\n```\r\nThe command above will wrap warning messages at 79 lines, something that would make close to impossible to process the stderr lines. Same happens if output is redirected to a normal file.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIn absence of a tty, the wrapping should be disabled. Easier to implement is by setting it to `sys.maxsize`.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n![](https://sbarnea.com/ss/Screen-Shot-2020-08-26-10-35-26.56.png)\r\n\r\nAs you can see, even redirecting the stdout to a file produces wrapped stderrors, something that cannot be considered as desired in any case. Yes, redirecting stdout makes stderr wrapped... \ud83e\udd10",
        "created_at": "2020-08-26T10:05:52Z",
        "user": "ssbarnea",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.17"
        ]
    },
    {
        "number": 71442,
        "title": "Ansible vault is incompatible with Jenkins credential files - wrong absolute path parsing",
        "body": "##### SUMMARY\r\nPassing an absolute path with an @ to ansible leads to it interpreting it as a relative path starting from after the @. \r\n```\r\n$ ansible-playbook --tags inet --limit oem-desktop site.yml --vault-id \"/home/user/workspace@tmp/vault_password\" \r\nERROR! The vault password file /home/user/tmp/vault_password was not found\r\n```\r\nThis breaks using ansible with \r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nCore ansible\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.8.2\r\n  config file = /home/fhackenberger/tmp/car2ad/car2ad.git/ansible/ansible.cfg\r\n  configured module search path = [u'/home/fhackenberger/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/fhackenberger/.local/lib/python2.7/site-packages/ansible\r\n  executable location = /home/fhackenberger/.local/bin/ansible\r\n  python version = 2.7.18rc1 (default, Apr  7 2020, 12:05:55) [GCC 9.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_PIPELINING(/home/fhackenberger/tmp/car2ad/car2ad.git/ansible/ansible.cfg) = True\r\nDEFAULT_HOST_LIST(/home/fhackenberger/tmp/car2ad/car2ad.git/ansible/ansible.cfg) = [u'/home/fhackenberger/tmp/car2ad/car2ad.git/ansible/hosts']\r\nINVENTORY_ENABLED(/home/fhackenberger/tmp/car2ad/car2ad.git/ansible/ansible.cfg) = [u'host_list', u'ini']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nUbuntu 20.04\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nmkdir ~/workspace\\@tmp\r\ntouch ~/workspace\\@tmp/vault_password\r\ncd ~\r\ntouch site.yml\r\n$ ansible-playbook site.yml --vault-id ~/workspace\\@tmp/vault_password\" \r\nERROR! The vault password file /home/user/tmp/vault_password was not found\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nansible-playbook should continue with reading the vault_password file\r\n\r\n\r\n##### ACTUAL RESULTS\r\nAnsible interprets the path \"/home/user/workspace@tmp/vault_password\" as a relative path \"tmp/vault_password\" starting from the working directory.\r\n",
        "created_at": "2020-08-25T11:09:34Z",
        "user": "fhackenberger",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 71286,
        "title": "post reboot with Ansible \"whoami && sleep 0\" ",
        "body": "Hi Team,\r\nbelow given the summary of the issue \r\n##### SUMMARY\r\nwhile using the Reboot Module the server is able to connect pre-reboot and post-reboot \r\nafter post-reboot seeing hung at\r\n\r\n```\r\n<vmaxp720-1-v05.vxindia.veritas.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 -tt vmaxp720-1-v05.vxindia.veritas.com '/bin/sh -c '\"'\"'whoami && sleep 0'\"'\"''\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nreboot\r\n\r\n##### ANSIBLE VERSION\r\n```\r\n# ansible --version \r\nansible 2.9.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nserver :- \r\n```\r\nLinux xxxx.com 3.10.0-1127.el7.x86_64 #1 SMP Tue Feb 18 16:39:12 EST 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\nclient :- \r\n```\r\n# oslevel -s \r\n7100-04-01-1543\r\n```\r\n##### OS / ENVIRONMENT\r\nserver :- \r\n```\r\nLinux xxxx.com 3.10.0-1127.el7.x86_64 #1 SMP Tue Feb 18 16:39:12 EST 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\nclient :- \r\n```\r\n# oslevel -s \r\n7100-04-01-1543\r\n```\r\n##### STEPS TO REPRODUCE\r\nyml file \r\n```yaml\r\n- name: Check the uptime prior reboot\r\n  shell: uptime\r\n  register: UPTIME_PRE_REBOOT\r\n- debug: msg={{UPTIME_PRE_REBOOT.stdout}}\r\n- name: Reboot a slow machine :(\r\n  reboot:\r\n    reboot_timeout: 300\r\n- name: Check the uptime post reboot\r\n  shell: uptime\r\n  register: UPTIME_POST_REBOOT\r\n- debug: msg={{UPTIME_POST_REBOOT.stdout}}\r\n```\r\n\r\nstatus o/p of the \r\n``` \r\nansible-playbook 2.9.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nhost_list declined parsing /teja/ansible/hosts.yml as it did not pass its verify_file() method\r\nscript declined parsing /teja/ansible/hosts.yml as it did not pass its verify_file() method\r\nSkipping empty key (hosts) in group (all)\r\nNot replacing invalid character(s) \"set([u'.'])\" in group name (basevxvm_aix7.1_nightly)\r\n[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details\r\nParsed /teja/ansible/hosts.yml inventory source with yaml plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: site.yml ****************************************************************************************************\r\nPositional arguments: ./site.yml\r\nbecome_method: sudo\r\ninventory: (u'/teja/ansible/hosts.yml',)\r\nforks: 5\r\ntags: (u'all',)\r\nextra_vars: (u'hosts_config=basevxvm_aix7.1_nightly Build=07_24',)\r\nverbosity: 4\r\nconnection: smart\r\ntimeout: 10\r\n1 plays in ./site.yml\r\n\r\nPLAY [basevxvm_aix7.1_nightly] ****************************************************************************************\r\n\r\nTASK [Gathering Facts] ************************************************************************************************\r\ntask path: /teja/ansible/site.yml:2\r\n<xxxxx.com> Attempting python interpreter discovery\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 xxxxx.com '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<xxxxx.com> (0, 'PLATFORM\\nAIX\\nFOUND\\n/usr/bin/python\\n/usr/bin/python2.7\\n/usr/bin/python\\nENDFOUND\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/root/.ansible/cp/028de6e6a2\" does not exist\\r\\ndebug2: resolving \"xxxxx.com\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to xxxxx.com [10.209.113.68] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 10000 ms remain after connect\\r\\ndebug1: permanently_set_uid: 0/0\\r\\ndebug1: identity file /root/.ssh/id_rsa type 1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_dsa type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ecdsa type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ed25519 type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\\r\\ndebug1: Enabling compatibility mode for protocol 2.0\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.0\\r\\ndebug1: match: OpenSSH_6.0 pat OpenSSH* compat 0x04000000\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to xxxxx.com:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from xxxxx.com\\r\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\\r\\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\\r\\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\\r\\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\\r\\ndebug2: MACs ctos: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-256-96,hmac-sha2-512,hmac-sha2-512-96,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\\r\\ndebug2: MACs stoc: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-256-96,hmac-sha2-512,hmac-sha2-512-96,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: ecdh-sha2-nistp256\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64@openssh.com compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64@openssh.com compression: zlib@openssh.com\\r\\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\\r\\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\\r\\ndebug3: send packet: type 30\\r\\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:Wu5jXJpDBu4EOz5gJGuj4Fbrlv22wZdI2viwuJgHjtU\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from xxxxx.com\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from 10.209.113.68\\r\\ndebug1: Host \\'xxxxx.com\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /root/.ssh/known_hosts:367\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey after 4294967296 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey after 4294967296 blocks\\r\\ndebug2: key: /root/.ssh/id_rsa (0x56386d980a00)\\r\\ndebug2: key: /root/.ssh/id_dsa ((nil))\\r\\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\\r\\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\\r\\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering RSA public key: /root/.ssh/id_rsa\\r\\ndebug3: send_pubkey_test\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: pkalg ssh-rsa blen 279\\r\\ndebug2: input_userauth_pk_ok: fp SHA256:v3a7NFXS1CZL2SE68wJf6p5YE20hM9wg2ajWzlyj/Og\\r\\ndebug3: sign_and_send_pubkey: RSA SHA256:v3a7NFXS1CZL2SE68wJf6p5YE20hM9wg2ajWzlyj/Og\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to xxxxx.com ([10.209.113.68]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /root/.ansible/cp/028de6e6a2.8Gxl61HdhABDoE13\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/root/.ansible/cp/028de6e6a2]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 4\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 4495\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: process_mux_master_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: process_mux_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 476\\r\\ndebug2: process_mux_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo PLATFORM; uname; echo FOUND; command -v \\'\"\\'\"\\'/usr/bin/python\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.7\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.6\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.5\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python2.7\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python2.6\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'/usr/libexec/platform-python\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'/usr/bin/python3\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python\\'\"\\'\"\\'; echo ENDFOUND && sleep 0\\'\", env 2\\r\\ndebug3: process_mux_new_session: got fds stdin 6, stdout 7, stderr 8\\r\\ndebug2: fd 7 setting O_NONBLOCK\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: process_mux_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: callback start\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = en_US.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending env LC_CTYPE = UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'echo PLATFORM; uname; echo FOUND; command -v \\'\"\\'\"\\'/usr/bin/python\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.7\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.6\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python3.5\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python2.7\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python2.6\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'/usr/libexec/platform-python\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'/usr/bin/python3\\'\"\\'\"\\'; command -v \\'\"\\'\"\\'python\\'\"\\'\"\\'; echo ENDFOUND && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: channel 2: close_read\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: close_write\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: close_read\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 r-1 i3/0 o1/0 fd 5/5 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 fd -1/-1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: close_write\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 r-1 i3/0 o3/0 fd 5/5 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<xxxxx.com> Python interpreter discovery fallback (unsupported platform for extended discovery: aix)\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/setup.py\r\nPipelining is enabled.\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 xxxxx.com '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '\\n{\"invocation\": {\"module_args\": {\"filter\": \"*\", \"gather_subset\": [\"all\"], \"fact_path\": \"/etc/ansible/facts.d\", \"gather_timeout\": 10}}, \"ansible_facts\": {\"ansible_product_serial\": \"06E779P\", \"ansible_fips\": false, \"ansible_service_mgr\": \"src\", \"ansible_user_id\": \"root\", \"ansible_selinux_python_present\": false, \"ansible_userspace_bits\": \"32\", \"gather_subset\": [\"all\"], \"ansible_architecture\": \"chrp\", \"ansible_vgs\": {\"rootvg\": [{\"pv_state\": \"active\", \"free_pps\": \"493\", \"pp_size\": \"64 megabyte(s)\", \"pv_name\": \"hdisk0\", \"total_pps\": \"639\"}]}, \"ansible_kernel_version\": \"7\", \"ansible_distribution_version\": \"7.1\", \"ansible_domain\": \"vxindia.veritas.com\", \"ansible_virtualization_type\": \"\", \"ansible_firmware_version\": \"AL730_049\", \"ansible_processor_cores\": 4, \"ansible_virtualization_role\": \"\", \"ansible_dns\": {\"nameservers\": [\"172.16.8.32\", \"172.16.8.33\"], \"domain\": \"vxindia.veritas.com\", \"search\": [\"vxindia.veritas.com\"]}, \"ansible_effective_group_id\": 0, \"ansible_processor\": \"PowerPC_POWER7\", \"ansible_date_time\": {\"weekday_number\": \"5\", \"iso8601_basic_short\": \"20200814T152155\", \"tz\": \"CDT\", \"weeknumber\": \"32\", \"hour\": \"15\", \"year\": \"2020\", \"minute\": \"21\", \"tz_offset\": \"CDT\", \"month\": \"08\", \"epoch\": \"1597436515\", \"iso8601_micro\": \"2020-08-14T20:21:55.333522Z\", \"weekday\": \"Friday\", \"time\": \"15:21:55\", \"date\": \"2020-08-14\", \"iso8601\": \"2020-08-14T20:21:55Z\", \"day\": \"14\", \"iso8601_basic\": \"20200814T152155333229\", \"second\": \"55\"}, \"ansible_memtotal_mb\": 2048, \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJG/ONNo++k8l2224hP2AE48W6GN0gX+S86/SX6ZnDdvfLjI3NczOX30GsYnsuv4gMSqB/bECvLbvq3UiCOe4g8=\", \"ansible_real_user_id\": 0, \"ansible_default_ipv4\": {\"macaddress\": \"c2:21:27:f3:2a:0b\", \"network\": \"10.209.112.0\", \"mtu\": \"1500\", \"broadcast\": \"10.209.115.255\", \"interface\": \"en0\", \"netmask\": \"255.255.252.0\", \"flags\": [\"UP\", \"BROADCAST\", \"NOTRAILERS\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"CHECKSUM_OFFLOAD(ACTIVE)\", \"CHAIN\"], \"address\": \"10.209.113.68\", \"device\": \"en0\", \"type\": \"ether\", \"gateway\": \"10.209.112.1\"}, \"ansible_swapfree_mb\": 506, \"ansible_default_ipv6\": {}, \"ansible_user_gid\": 0, \"ansible_processor_count\": 4, \"ansible_apparmor\": {\"status\": \"disabled\"}, \"ansible_effective_user_id\": 0, \"ansible_distribution_release\": \"1\", \"ansible_mounts\": [{\"block_used\": 112923, \"size_total\": 536870912, \"block_total\": 131072, \"mount\": \"/\", \"block_available\": 18149, \"size_available\": 74338304, \"fstype\": \"jfs2\", \"inode_total\": 39364, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd4\", \"inode_used\": 18315, \"block_size\": 4096, \"inode_available\": 21049}, {\"block_used\": 602142, \"size_total\": 2684354560, \"block_total\": 655360, \"mount\": \"/usr\", \"block_available\": 53218, \"size_available\": 217980928, \"fstype\": \"jfs2\", \"inode_total\": 101960, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd2\", \"inode_used\": 47762, \"block_size\": 4096, \"inode_available\": 54198}, {\"block_used\": 80357, \"size_total\": 603979776, \"block_total\": 147456, \"mount\": \"/var\", \"block_available\": 67099, \"size_available\": 274837504, \"fstype\": \"jfs2\", \"inode_total\": 68539, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd9var\", \"inode_used\": 6569, \"block_size\": 4096, \"inode_available\": 61970}, {\"block_used\": 1338, \"size_total\": 201326592, \"block_total\": 49152, \"mount\": \"/tmp\", \"block_available\": 47814, \"size_available\": 195846144, \"fstype\": \"jfs2\", \"inode_total\": 46277, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd3\", \"inode_used\": 42, \"block_size\": 4096, \"inode_available\": 46235}, {\"block_used\": 94, \"size_total\": 67108864, \"block_total\": 16384, \"mount\": \"/home\", \"block_available\": 16290, \"size_available\": 66723840, \"fstype\": \"jfs2\", \"inode_total\": 14576, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd1\", \"inode_used\": 7, \"block_size\": 4096, \"inode_available\": 14569}, {\"block_used\": 95, \"size_total\": 134217728, \"block_total\": 32768, \"mount\": \"/admin\", \"block_available\": 32673, \"size_available\": 133828608, \"fstype\": \"jfs2\", \"inode_total\": 29138, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd11admin\", \"inode_used\": 7, \"block_size\": 4096, \"inode_available\": 29131}, {\"block_used\": 4294967295, \"size_total\": 4398046510080, \"block_total\": 4294967295, \"mount\": \"/proc\", \"block_available\": 0, \"size_available\": 0, \"fstype\": \"procfs\", \"inode_total\": 0, \"options\": \"rw\", \"time\": \"Aug 14 15:19\", \"device\": \"/proc\", \"inode_used\": 0, \"block_size\": 1024, \"inode_available\": 0}, {\"block_used\": 81886, \"size_total\": 3556769792, \"block_total\": 868352, \"mount\": \"/opt\", \"block_available\": 786466, \"size_available\": 3221364736, \"fstype\": \"jfs2\", \"inode_total\": 712200, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/hd10opt\", \"inode_used\": 12787, \"block_size\": 4096, \"inode_available\": 699413}, {\"block_used\": 92, \"size_total\": 268435456, \"block_total\": 65536, \"mount\": \"/var/adm/ras/livedump\", \"block_available\": 65444, \"size_available\": 268058624, \"fstype\": \"jfs2\", \"inode_total\": 58204, \"options\": \"rw,log=/dev/hd8\", \"time\": \"Aug 14 15:19\", \"device\": \"/dev/livedump\", \"inode_used\": 4, \"block_size\": 4096, \"inode_available\": 58200}], \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_os_family\": \"AIX\", \"ansible_lpar_info\": \"8 vmaxp720-1-v05\", \"ansible_swaptotal_mb\": 512, \"ansible_fqdn\": \"xxxxx.com\", \"ansible_system\": \"AIX\", \"ansible_pkg_mgr\": \"unknown\", \"ansible_memfree_mb\": 604, \"ansible_devices\": {\"hdisk3\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x1e000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hd10opt\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/opt\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.9\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"53\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"hdisk1\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x1c000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk0\": {\"attributes\": {\"algorithm\": \"fail_over\", \"reserve_policy\": \"no_reserve\", \"hcheck_interval\": \"0\", \"pvid\": \"00f6e7797e4e196d0000000000000000\", \"max_transfer\": \"0x40000\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/vscsi\", \"hcheck_cmd\": \"test_unit_rdy\", \"queue_depth\": \"3\"}, \"state\": \"Available\", \"type\": \"Virtual SCSI Disk Drive\"}, \"hdisk7\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x22000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk6\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x21000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk5\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x20000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk2\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x1d000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk9\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x24000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk8\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x23000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"proc8\": {\"attributes\": {\"smt_enabled\": \"true\", \"state\": \"enable\", \"frequency\": \"3000000000\", \"type\": \"PowerPC_POWER7\", \"smt_threads\": \"4\"}, \"state\": \"Available\", \"type\": \"00-08 Processor\"}, \"pkcs11\": {\"attributes\": {\"trc_malloc\": \"no\", \"trc_slot\": \"no\", \"trc_req\": \"no\", \"trc_context\": \"no\", \"io_threads\": \"8\", \"trc_clic\": \"no\", \"trc_util\": \"no\", \"trc_u_lib\": \"no\", \"comp_trace\": \"no\", \"trc_k_ulib\": \"no\", \"trc_adm\": \"no\", \"trc_io\": \"no\", \"trc_obj\": \"no\", \"trc_k_klib\": \"no\", \"y4_max_req\": \"16\", \"proc_heap_sz\": \"8\", \"trc_token\": \"no\", \"trc_sess\": \"no\", \"trc_mmap\": \"no\", \"trc_dd\": \"no\", \"trc_meta\": \"no\", \"trc_hw\": \"no\"}, \"state\": \"Available\", \"type\": \"ACF/PKCS#11 Device\"}, \"sysplanar0\": {\"attributes\": {}, \"state\": \"Available\", \"type\": \"System Planar\"}, \"ent2\": {\"attributes\": {\"ipv6_offload\": \"no\", \"min_buf_large\": \"24\", \"min_buf_tiny\": \"512\", \"chksum_offload\": \"yes\", \"max_buf_tiny\": \"2048\", \"trace_debug\": \"no\", \"copy_bytes\": \"65536\", \"min_buf_huge\": \"24\", \"use_alt_addr\": \"no\", \"desired_mapmem\": \"0\", \"min_buf_small\": \"512\", \"max_buf_medium\": \"256\", \"min_buf_medium\": \"128\", \"alt_addr\": \"0x000000000000\", \"max_buf_small\": \"2048\", \"max_buf_large\": \"64\", \"max_buf_huge\": \"64\", \"copy_buffs\": \"32\", \"poll_uplink\": \"no\", \"min_buf_control\": \"24\", \"poll_uplink_int\": \"1000\", \"buf_mode\": \"min\", \"max_buf_control\": \"64\"}, \"state\": \"Available\", \"type\": \"Virtual I/O Ethernet Adapter (l-lan)\"}, \"mem0\": {\"attributes\": {\"ent_mem_cap\": \"I/O\", \"goodsize\": \"2048\", \"mem_exp_factor\": \"Memory\", \"var_mem_weight\": \"Variable\", \"size\": \"2048\"}, \"state\": \"Available\", \"type\": \"Memory\"}, \"vscsi0\": {\"attributes\": {\"rw_timeout\": \"0\", \"vscsi_path_to\": \"0\", \"vscsi_err_recov\": \"delayed_fail\"}, \"state\": \"Available\", \"type\": \"Virtual SCSI Client Adapter\"}, \"proc4\": {\"attributes\": {\"smt_enabled\": \"true\", \"state\": \"enable\", \"frequency\": \"3000000000\", \"type\": \"PowerPC_POWER7\", \"smt_threads\": \"4\"}, \"state\": \"Available\", \"type\": \"00-04 Processor\"}, \"inet0\": {\"attributes\": {\"route\": \"net,,0,10.209.112.1\", \"hostname\": \"xxxxx.com\", \"bootup_option\": \"no\", \"authm\": \"65536\", \"rout6\": \"IPv6\", \"gateway\": \"Gateway\"}, \"state\": \"Available\", \"type\": \"Internet Network Extension\"}, \"proc0\": {\"attributes\": {\"smt_enabled\": \"true\", \"state\": \"enable\", \"frequency\": \"3000000000\", \"type\": \"PowerPC_POWER7\", \"smt_threads\": \"4\"}, \"state\": \"Available\", \"type\": \"00-00 Processor\"}, \"vio0\": {\"attributes\": {\"bus_id\": \"0x90000340\"}, \"state\": \"Available\", \"type\": \"Virtual I/O Bus\"}, \"et2\": {\"attributes\": {\"arp\": \"on\", \"tcp_mssdflt\": \"Set\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"Internet\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1492\", \"broadcast\": \"Broadcast\", \"state\": \"down\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"prefixlen\": \"Prefix\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Defined\", \"type\": \"IEEE 802.3 Ethernet Network Interface\"}, \"hd6\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"None\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.2\", \"inter\": \"m\", \"type\": \"paging\", \"intra\": \"m\", \"size\": \"8\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"et0\": {\"attributes\": {\"arp\": \"on\", \"tcp_mssdflt\": \"Set\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"Internet\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1492\", \"broadcast\": \"Broadcast\", \"state\": \"down\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"prefixlen\": \"Prefix\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Defined\", \"type\": \"IEEE 802.3 Ethernet Network Interface\"}, \"et1\": {\"attributes\": {\"arp\": \"on\", \"tcp_mssdflt\": \"Set\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"Internet\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1492\", \"broadcast\": \"Broadcast\", \"state\": \"down\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"prefixlen\": \"Prefix\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Defined\", \"type\": \"IEEE 802.3 Ethernet Network Interface\"}, \"hd3\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/tmp\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.7\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"3\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"hd2\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/usr\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.5\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"40\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"hd1\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/home\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.8\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"1\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"L2cache0\": {\"attributes\": {\"size\": \"0\"}, \"state\": \"Available\", \"type\": \"L2 Cache\"}, \"hdisk4\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x1f000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"iocp0\": {\"attributes\": {\"autoconfig\": \"defined\"}, \"state\": \"Defined\", \"type\": \"I/O Completion Ports\"}, \"hd8\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"None\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.3\", \"inter\": \"m\", \"type\": \"jfs2log\", \"intra\": \"c\", \"size\": \"1\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"lg_dumplv\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"None\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.11\", \"inter\": \"m\", \"type\": \"sysdump\", \"intra\": \"m\", \"size\": \"16\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"en0\": {\"attributes\": {\"arp\": \"on\", \"prefixlen\": \"Prefix\", \"monitor\": \"off\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"10.209.113.68\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1500\", \"broadcast\": \"Broadcast\", \"thread\": \"off\", \"state\": \"up\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"tcp_mssdflt\": \"Set\", \"mtu_bypass\": \"off\", \"netaddr6\": \"IPv6\", \"netmask\": \"255.255.252.0\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Available\", \"type\": \"Standard Ethernet Network Interface\"}, \"lvdd\": {\"attributes\": {}, \"state\": \"Available\", \"type\": \"LVM Device Driver\"}, \"hdisk13\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x28000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk12\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x27000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hd11admin\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/admin\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.10\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"2\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"hdisk10\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x25000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk16\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x2b000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"hdisk15\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x2a000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"proc12\": {\"attributes\": {\"smt_enabled\": \"true\", \"state\": \"enable\", \"frequency\": \"3000000000\", \"type\": \"PowerPC_POWER7\", \"smt_threads\": \"4\"}, \"state\": \"Available\", \"type\": \"00-12 Processor\"}, \"vty0\": {\"attributes\": {\"parity\": \"none\", \"lnext\": \"^v\", \"flow_disp\": \"xon\", \"susp\": \"^z\", \"erase\": \"^h\", \"kill\": \"^u\", \"intr\": \"^c\", \"speed\": \"19200\", \"quit\": \"^\\\\\\\\\", \"csmap\": \"sbcs\", \"stops\": \"1\", \"start\": \"^q\", \"bpc\": \"8\", \"logger\": \"LOGGER\", \"autoconfig\": \"available\", \"dsusp\": \"^y\", \"stop\": \"^s\", \"term\": \"vt220\", \"runmodes\": \"hupcl,cread,brkint,icrnl,opost,tab3,onlcr,isig,icanon,echo,echoe,echok,echoctl,echoke,imaxbel,iexten\", \"reprint\": \"^r\", \"imap\": \"none\", \"werase\": \"^w\", \"logmodes\": \"hupcl,cread,echoe,cs8\", \"eof\": \"^d\", \"modules\": \"ldterm\", \"eol\": \"^@\", \"eol2\": \"^?\", \"timeout\": \"0\", \"omap\": \"none\", \"discard\": \"^o\", \"login\": \"disable\", \"open_disp\": \"dtropen\"}, \"state\": \"Available\", \"type\": \"Asynchronous Terminal\"}, \"fscsi0\": {\"attributes\": {\"dyntrk\": \"yes\", \"attach\": \"switch\", \"fc_err_recov\": \"fast_fail\", \"sw_fc_class\": \"3\", \"scsi_id\": \"0x1f2c85\"}, \"state\": \"Available\", \"type\": \"04-T1-01 FC SCSI I/O Controller Protocol Device\"}, \"fscsi1\": {\"attributes\": {\"dyntrk\": \"yes\", \"attach\": \"switch\", \"fc_err_recov\": \"fast_fail\", \"sw_fc_class\": \"3\", \"scsi_id\": \"0x1f2d85\"}, \"state\": \"Available\", \"type\": \"04-T1-01 FC SCSI I/O Controller Protocol Device\"}, \"iscsi0\": {\"attributes\": {\"num_cmd_elems\": \"200\", \"isns_srvports\": \"iSNS\", \"initiator_name\": \"iqn.com.veritas.vxindia.vmaxp720-1-v05.hostid.0ad17144\", \"disc_policy\": \"file\", \"isns_srvnames\": \"auto\", \"disc_filename\": \"/etc/iscsi/targets\", \"max_targets\": \"16\"}, \"state\": \"Available\", \"type\": \"iSCSI Protocol Device\"}, \"pty0\": {\"attributes\": {\"BSDnum\": \"16\", \"autoconfig\": \"available\", \"csmap\": \"sbcs\", \"ATTnum\": \"256\"}, \"state\": \"Available\", \"type\": \"Asynchronous Pseudo-Terminal\"}, \"hd5\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"primary_bootlv\", \"relocatable\": \"n\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.1\", \"inter\": \"m\", \"type\": \"boot\", \"intra\": \"e\", \"size\": \"1\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"sys0\": {\"attributes\": {\"dedicated\": \"false\", \"modelname\": \"IBM,8202-E4B\", \"chown_restrict\": \"true\", \"id_to_system\": \"0X800016BEE8D00000\", \"ncargs\": \"256\", \"keylock\": \"normal\", \"clouddev\": \"0\", \"fullcore\": \"false\", \"frequency\": \"6400000000\", \"systemid\": \"IBM,0206E779P\", \"capped\": \"false\", \"cpuguard\": \"enable\", \"variable_weight\": \"128\", \"autorestart\": \"true\", \"id_to_partition\": \"0X800016BEE8D00008\", \"min_capacity\": \"0.40\", \"rtasversion\": \"1\", \"enhanced_RBAC\": \"true\", \"realmem\": \"2097152\", \"capacity_inc\": \"0.01\", \"log_pg_dealloc\": \"true\", \"iostat\": \"false\", \"ent_capacity\": \"0.40\", \"pre430core\": \"false\", \"ngroups_allowed\": \"128\", \"SW_dist_intr\": \"false\", \"fwversion\": \"IBM,AL730_049\", \"boottype\": \"disk\", \"pre520tune\": \"disable\", \"maxuproc\": \"128\", \"conslogin\": \"enable\", \"maxbuf\": \"20\", \"os_uuid\": \"393ce69d-d67c-4471-b088-bdece4b3e250\", \"maxmbuf\": \"0\", \"maxpout\": \"8193\", \"max_capacity\": \"0.40\", \"ghostdev\": \"0\", \"max_logname\": \"9\", \"nfs4_acl_compat\": \"secure\", \"minpout\": \"4096\", \"sed_config\": \"select\"}, \"state\": \"Available\", \"type\": \"System Object\"}, \"ent1\": {\"attributes\": {\"ipv6_offload\": \"no\", \"min_buf_large\": \"24\", \"min_buf_tiny\": \"512\", \"chksum_offload\": \"yes\", \"max_buf_tiny\": \"2048\", \"trace_debug\": \"no\", \"copy_bytes\": \"65536\", \"min_buf_huge\": \"24\", \"use_alt_addr\": \"no\", \"desired_mapmem\": \"0\", \"min_buf_small\": \"512\", \"max_buf_medium\": \"256\", \"min_buf_medium\": \"128\", \"alt_addr\": \"0x000000000000\", \"max_buf_small\": \"2048\", \"max_buf_large\": \"64\", \"max_buf_huge\": \"64\", \"copy_buffs\": \"32\", \"poll_uplink\": \"no\", \"min_buf_control\": \"24\", \"poll_uplink_int\": \"1000\", \"buf_mode\": \"min\", \"max_buf_control\": \"64\"}, \"state\": \"Available\", \"type\": \"Virtual I/O Ethernet Adapter (l-lan)\"}, \"ent0\": {\"attributes\": {\"ipv6_offload\": \"no\", \"min_buf_large\": \"24\", \"min_buf_tiny\": \"512\", \"chksum_offload\": \"yes\", \"max_buf_tiny\": \"2048\", \"trace_debug\": \"no\", \"copy_bytes\": \"65536\", \"min_buf_huge\": \"24\", \"use_alt_addr\": \"no\", \"desired_mapmem\": \"0\", \"min_buf_small\": \"512\", \"max_buf_medium\": \"256\", \"min_buf_medium\": \"128\", \"alt_addr\": \"0x000000000000\", \"max_buf_small\": \"2048\", \"max_buf_large\": \"64\", \"max_buf_huge\": \"64\", \"copy_buffs\": \"32\", \"poll_uplink\": \"no\", \"min_buf_control\": \"24\", \"poll_uplink_int\": \"1000\", \"buf_mode\": \"min\", \"max_buf_control\": \"64\"}, \"state\": \"Available\", \"type\": \"Virtual I/O Ethernet Adapter (l-lan)\"}, \"hd4\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.4\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"8\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"hdisk11\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x26000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"vsa0\": {\"attributes\": {\"desired_mapmem\": \"I/O\"}, \"state\": \"Available\", \"type\": \"LPAR Virtual Serial Adapter\"}, \"rootvg\": {\"attributes\": {\"vgserial_id\": \"00f6e77900004c0000000173eded97a9\", \"timestamp\": \"5f36f1ed0e860618\", \"conc_auto_on\": \"n\", \"vg_pbufs_ppv\": \"0\", \"gbl_pbufs_ppv\": \"0\", \"conc_capable\": \"n\", \"cache_pbuf_cnt\": \"0\", \"gbl_pbufs_pvg\": \"0\", \"workQ_size\": \"256\", \"auto_on\": \"y\"}, \"state\": \"Defined\", \"type\": \"Volume group\"}, \"sfw0\": {\"attributes\": {\"enable_sas\": \"no\", \"vltag\": \"3358\"}, \"state\": \"Available\", \"type\": \"Storage Framework Module\"}, \"hd9var\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/var\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.6\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"c\", \"size\": \"9\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"en2\": {\"attributes\": {\"arp\": \"on\", \"prefixlen\": \"Prefix\", \"monitor\": \"off\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"Internet\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1500\", \"broadcast\": \"Broadcast\", \"thread\": \"off\", \"state\": \"down\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"tcp_mssdflt\": \"Set\", \"mtu_bypass\": \"off\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Defined\", \"type\": \"Standard Ethernet Network Interface\"}, \"livedump\": {\"attributes\": {\"stripe_size\": \"Stripe\", \"strictness\": \"y\", \"stripe_width\": \"Striping\", \"copies\": \"1\", \"upperbound\": \"32\", \"label\": \"/var/adm/ras/livedump\", \"relocatable\": \"y\", \"lvserial_id\": \"00f6e77900004c0000000173eded97a9.12\", \"inter\": \"m\", \"type\": \"jfs2\", \"intra\": \"m\", \"size\": \"4\"}, \"state\": \"Defined\", \"type\": \"Logical volume\"}, \"en1\": {\"attributes\": {\"arp\": \"on\", \"prefixlen\": \"Prefix\", \"monitor\": \"off\", \"remmtu\": \"576\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"Internet\", \"alias6\": \"IPv6\", \"rfc1323\": \"Enable/Disable\", \"authority\": \"Authorized\", \"mtu\": \"1500\", \"broadcast\": \"Broadcast\", \"thread\": \"off\", \"state\": \"down\", \"alias4\": \"IPv4\", \"tcp_sendspace\": \"Set\", \"tcp_mssdflt\": \"Set\", \"mtu_bypass\": \"off\", \"netaddr6\": \"IPv6\", \"netmask\": \"Subnet\", \"security\": \"none\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Defined\", \"type\": \"Standard Ethernet Network Interface\"}, \"lo0\": {\"attributes\": {\"tcp_mssdflt\": \"Set\", \"tcp_nodelay\": \"Enable/Disable\", \"netaddr\": \"127.0.0.1\", \"rfc1323\": \"Enable/Disable\", \"mtu\": \"16896\", \"state\": \"up\", \"tcp_sendspace\": \"Set\", \"prefixlen\": \"IPv6\", \"netaddr6\": \"::1\", \"netmask\": \"Subnet\", \"tcp_recvspace\": \"Set\"}, \"state\": \"Available\", \"type\": \"Loopback Network Interface\"}, \"rcm0\": {\"attributes\": {}, \"state\": \"Defined\", \"type\": \"Rendering Context Manager Subsystem\"}, \"fcs0\": {\"attributes\": {\"lg_term_dma\": \"0x800000\", \"num_cmd_elems\": \"200\", \"max_xfer_size\": \"0x100000\", \"sw_fc_class\": \"2\", \"intr_priority\": \"3\"}, \"state\": \"Available\", \"type\": \"04-T1 Virtual Fibre Channel Client Adapter\"}, \"fcs1\": {\"attributes\": {\"lg_term_dma\": \"0x800000\", \"num_cmd_elems\": \"200\", \"max_xfer_size\": \"0x100000\", \"sw_fc_class\": \"2\", \"intr_priority\": \"3\"}, \"state\": \"Available\", \"type\": \"04-T1 Virtual Fibre Channel Client Adapter\"}, \"cluster0\": {\"attributes\": {\"clvdisk\": \"00000000-0000-0000-0000-000000000000\", \"node_uuid\": \"00000000-0000-0000-0000-000000000000\"}, \"state\": \"Available\", \"type\": \"Cluster Node\"}, \"hdisk14\": {\"attributes\": {\"dist_err_pcnt\": \"0\", \"reserve_policy\": \"single_path\", \"clr_q\": \"no\", \"lun_id\": \"0x29000000000000\", \"timeout_policy\": \"fail_path\", \"hcheck_mode\": \"nonactive\", \"PCM\": \"PCM/friend/fcpother\", \"node_name\": \"0x50060e8006d43c40\", \"q_err\": \"yes\", \"max_retry_delay\": \"60\", \"scsi_id\": \"0x42600\", \"location\": \"Location\", \"queue_depth\": \"2\", \"dist_tw_width\": \"50\", \"ww_name\": \"0x50060e8006d43c40\", \"PR_key_value\": \"none\", \"rw_timeout\": \"30\", \"start_timeout\": \"60\", \"max_transfer\": \"0x80000\", \"hcheck_interval\": \"60\", \"q_type\": \"simple\", \"max_coalesce\": \"0x40000\", \"algorithm\": \"fail_over\", \"lun_reset_spt\": \"yes\", \"reassign_to\": \"120\", \"pvid\": \"none\", \"hcheck_cmd\": \"test_unit_rdy\", \"unique_id\": \"240C50\"}, \"state\": \"Available\", \"type\": \"04-T1-01 MPIO Other FC SCSI Disk Drive\"}, \"sfwcomm0\": {\"attributes\": {}, \"state\": \"Available\", \"type\": \"04-T1-01-FF Fibre Channel Storage Framework Comm\"}, \"sfwcomm1\": {\"attributes\": {}, \"state\": \"Available\", \"type\": \"04-T1-01-FF Fibre Channel Storage Framework Comm\"}}, \"ansible_user_uid\": 0, \"ansible_fibre_channel_wwn\": [\"C05076046D250048\", \"C05076046D25005A\"], \"ansible_distribution\": \"AIX\", \"ansible_user_dir\": \"/\", \"ansible_env\": {\"LANG\": \"en_US\", \"SSH_CONNECTION\": \"10.209.118.65 51848 10.209.113.68 22\", \"SHELL\": \"/usr/bin/ksh\", \"TZ\": \"CST6CDT\", \"LC__FASTMSG\": \"true\", \"CLCMD_PASSTHRU\": \"1\", \"PWD\": \"/\", \"AUTHSTATE\": \"compat\", \"SSH_CLIENT\": \"10.209.118.65 51848 22\", \"LOGNAME\": \"root\", \"USER\": \"root\", \"MAIL\": \"/var/spool/mail/root\", \"LOCPATH\": \"/usr/lib/nls/loc\", \"PATH\": \"/usr/bin:/etc:/usr/sbin:/usr/ucb:/usr/bin/X11:/sbin:/usr/java5/jre/bin:/usr/java5/bin\", \"LOGIN\": \"root\", \"NLSPATH\": \"/usr/lib/nls/msg/%L/%N:/usr/lib/nls/msg/%L/%N.cat:/usr/lib/nls/msg/%l.%c/%N:/usr/lib/nls/msg/%l.%c/%N.cat\", \"HOME\": \"/\", \"_\": \"/usr/bin/python\", \"ODMDIR\": \"/etc/objrepos\"}, \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAPOx3ECqlvFOTSfEuNVsdsIs5RvH3EerDEyO5rhbFGswk13mOXHQt2IWglXudJUSWZccsHK/trzF/UUASAYlDTJ7NrK2xtvkcR2Es+u9po5XpU17B7mBfq5zPfPBtnLHrOZnmMEeMUuM0mUpIJ38aXhDrpPx1XeZ52GxOKec3JUHAAAAFQD+y8l1Kq9kNVNrDy/oHbQuqyu2EwAAAIBM4k581SCWDzEZfU47px1cHs2+y1eDyUqO3R9OzxTkFJPu/zw6WnqQejB0nr5hx4nMZOTKvutx+KKI8zw2h/xEu1bZQLJF0XQWIiuiWJ79lZHRpUIFUUGUY/PVDiVU5AyxAbzywNMmuJ+yS2ESsYhbv8g7xWNf5Jlm7dLsOPB5hAAAAIEA6l3UKTqnesjzq9RgDLoxUcovqYvpZzjicSjism3ut5HErPXYoTx+GWNfVbLI8itX2ozsjjumAyVZcBbjfvRAj5lhbP/f/0VkoEObOEZp1WpzEJrlLlWrO7ehi0PKjolU5fsjA8NtJR9slmVL/w6NqPf3FKvvgrpmFBNl3fnyHtE=\", \"module_setup\": true, \"ansible_iscsi_iqn\": \"iqn.com.veritas.vxindia.vmaxp720-1-v05.hostid.0ad17144\", \"ansible_hostname\": \"VMAXP720-1-v05\", \"ansible_lo0\": {\"macaddress\": \"unknown\", \"mtu\": \"16896\", \"flags\": [\"UP\", \"BROADCAST\", \"LOOPBACK\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"LARGESEND\", \"CHAIN\"], \"ipv4\": [{\"broadcast\": \"127.255.255.255\", \"netmask\": \"255.0.0.0\", \"network\": \"127.0.0.0\", \"address\": \"127.0.0.1\"}], \"ipv6\": [{\"prefix\": \"0\", \"address\": \"::1%1\"}], \"device\": \"lo0\", \"type\": \"unknown\"}, \"ansible_real_group_id\": 0, \"ansible_lsb\": {}, \"ansible_interfaces\": [\"en0\", \"lo0\"], \"ansible_all_ipv6_addresses\": [\"::1%1\"], \"ansible_en0\": {\"macaddress\": \"c2:21:27:f3:2a:0b\", \"mtu\": \"1500\", \"flags\": [\"UP\", \"BROADCAST\", \"NOTRAILERS\", \"RUNNING\", \"SIMPLEX\", \"MULTICAST\", \"GROUPRT\", \"64BIT\", \"CHECKSUM_OFFLOAD(ACTIVE)\", \"CHAIN\"], \"ipv4\": [{\"broadcast\": \"10.209.115.255\", \"netmask\": \"255.255.252.0\", \"network\": \"10.209.112.0\", \"address\": \"10.209.113.68\"}], \"ipv6\": [], \"device\": \"en0\", \"type\": \"ether\"}, \"ansible_local\": {}, \"ansible_machine\": \"00F6E7794C00\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDbVMZw3/c8zHiMAU36lF1U9SjmbQ68Q+avcjsv+ZvIZi9keUfrtIZIXyKMDcWgjxjdGpkTrqsBEGzTVUIdb3NxGfaFYbbSpNhs179UJVvwUeirDHBvKeD0S6H6UQsuMjazum/Bd5WFyrYzx49sIkKyFZmMSlQn2bkud4aQpLlBJXp1YDxZFGQr6XrW0OyqVH12uVwSd/m4axkLX+z5wcouQCsb/iKIDnBv9tyKvjTQiK6+f4QUHv6l+2ypJH03cHC4MeUn4PovZC10Y242Yyq0ERoyIKvABSc8kCISkSQ8Qc9tkaePqjBKMTsg94zlcEhIvocrl63Xyv+5YwdHf2PT\", \"ansible_user_gecos\": \"\", \"ansible_python\": {\"executable\": \"/usr/bin/python\", \"version\": {\"micro\": 10, \"major\": 2, \"releaselevel\": \"final\", \"serial\": 0, \"minor\": 7}, \"type\": \"CPython\", \"has_sslcontext\": true, \"version_info\": [2, 7, 10, \"final\", 0]}, \"ansible_kernel\": \"1\", \"ansible_is_chroot\": false, \"ansible_hostnqn\": \"\", \"ansible_python_version\": \"2.7.10\", \"ansible_product_name\": \"IBM,8202-E4B\", \"ansible_user_shell\": \"/usr/bin/ksh\", \"ansible_distribution_major_version\": \"7\", \"ansible_all_ipv4_addresses\": [\"10.209.113.68\"], \"ansible_nodename\": \"VMAXP720-1-v05\"}}\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n[WARNING]: Platform aix on host xxxxx.com is using the discovered Python interpreter at\r\n/usr/bin/python, but future installation of another Python interpreter could change this. See\r\nhttps://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information.\r\nok: [xxxxx.com]\r\nMETA: ran handlers\r\n\r\nTASK [include_vars] ***************************************************************************************************\r\ntask path: /teja/ansible/site.yml:4\r\nok: [xxxxx.com] => {\r\n  ...    \"ansible_included_var_files\": [\r\n        \"/teja/ansible/var/varible\"\r\n    ], \r\n    \"changed\": false\r\n}\r\n\r\nTASK [include_role : product_install_redhat] **************************************************************************\r\ntask path: /teja/ansible/site.yml:7\r\nskipping: [xxxxx.com] => {\r\n    \"changed\": false, \r\n    \"skip_reason\": \"Conditional result was False\"\r\n}\r\n\r\nTASK [include_role : product_install_suse] ****************************************************************************\r\ntask path: /teja/ansible/site.yml:10\r\nskipping: [xxxxx.com] => {\r\n    \"changed\": false, \r\n    \"skip_reason\": \"Conditional result was False\"\r\n}\r\n\r\nTASK [include_role : product_install_solaris] *************************************************************************\r\ntask path: /teja/ansible/site.yml:13\r\nskipping: [xxxxx.com] => {\r\n    \"changed\": false, \r\n    \"skip_reason\": \"Conditional result was False\"\r\n}\r\n\r\nTASK [include_role : product_install_aix] *****************************************************************************\r\ntask path: /teja/ansible/site.yml:16\r\nstatically imported: /teja/ansible/roles/product_install_aix/tasks/reboot.yml\r\n\r\nTASK [product_install_aix : Check the uptime prior reboot] ************************************************************\r\ntask path: /teja/ansible/roles/product_install_aix/tasks/reboot.yml:1\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\nPipelining is enabled.\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 xxxxx.com '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '\\n{\"changed\": true, \"end\": \"2020-08-14 15:21:57.237162\", \"stdout\": \"  03:21PM   up 2 mins,  1 user,  load average: 0.80, 0.37, 0.14\", \"cmd\": \"uptime\", \"rc\": 0, \"start\": \"2020-08-14 15:21:57.197180\", \"stderr\": \"\", \"delta\": \"0:00:00.039982\", \"invocation\": {\"module_args\": {\"creates\": null, \"executable\": null, \"_uses_shell\": true, \"strip_empty_ends\": true, \"_raw_params\": \"uptime\", \"removes\": null, \"argv\": null, \"warn\": true, \"chdir\": null, \"stdin_add_newline\": true, \"stdin\": null}}}\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nchanged: [xxxxx.com] => {\r\n    \"changed\": true, \r\n    \"cmd\": \"uptime\", \r\n    \"delta\": \"0:00:00.039982\", \r\n    \"end\": \"2020-08-14 15:21:57.237162\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"uptime\", \r\n            \"_uses_shell\": true, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"stdin_add_newline\": true, \r\n            \"strip_empty_ends\": true, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2020-08-14 15:21:57.197180\", \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"  03:21PM   up 2 mins,  1 user,  load average: 0.80, 0.37, 0.14\", \r\n    \"stdout_lines\": [\r\n        \"  03:21PM   up 2 mins,  1 user,  load average: 0.80, 0.37, 0.14\"\r\n    ]\r\n}\r\n\r\nTASK [product_install_aix : debug] ************************************************************************************\r\ntask path: /teja/ansible/roles/product_install_aix/tasks/reboot.yml:4\r\nok: [xxxxx.com] => {\r\n    \"msg\": \"  03:21PM   up 2 mins,  1 user,  load average: 0.80, 0.37, 0.14\"\r\n}\r\n\r\nTASK [product_install_aix : Reboot a slow machine :(] *****************************************************************\r\ntask path: /teja/ansible/roles/product_install_aix/tasks/reboot.yml:7\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/setup.py\r\nPipelining is enabled.\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 xxxxx.com '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '\\n{\"invocation\": {\"module_args\": {\"filter\": \"*\", \"gather_subset\": [\"min\"], \"fact_path\": \"/etc/ansible/facts.d\", \"gather_timeout\": 10}}, \"ansible_facts\": {\"ansible_fips\": false, \"ansible_service_mgr\": \"src\", \"ansible_user_id\": \"root\", \"module_setup\": true, \"gather_subset\": [\"min\"], \"ansible_ssh_host_key_ecdsa_public\": \"AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJG/ONNo++k8l2224hP2AE48W6GN0gX+S86/SX6ZnDdvfLjI3NczOX30GsYnsuv4gMSqB/bECvLbvq3UiCOe4g8=\", \"ansible_kernel_version\": \"7\", \"ansible_distribution_version\": \"7.1\", \"ansible_domain\": \"vxindia.veritas.com\", \"ansible_date_time\": {\"weekday_number\": \"5\", \"iso8601_basic_short\": \"20200814T152158\", \"tz\": \"CDT\", \"weeknumber\": \"32\", \"hour\": \"15\", \"year\": \"2020\", \"minute\": \"21\", \"tz_offset\": \"CDT\", \"month\": \"08\", \"epoch\": \"1597436518\", \"iso8601_micro\": \"2020-08-14T20:21:58.244865Z\", \"weekday\": \"Friday\", \"time\": \"15:21:58\", \"date\": \"2020-08-14\", \"iso8601\": \"2020-08-14T20:21:58Z\", \"day\": \"14\", \"iso8601_basic\": \"20200814T152158244650\", \"second\": \"58\"}, \"ansible_real_user_id\": 0, \"ansible_dns\": {\"nameservers\": [\"172.16.8.32\", \"172.16.8.33\"], \"domain\": \"vxindia.veritas.com\", \"search\": [\"vxindia.veritas.com\"]}, \"ansible_effective_group_id\": 0, \"ansible_userspace_bits\": \"32\", \"ansible_architecture\": \"chrp\", \"ansible_distribution_release\": \"1\", \"ansible_os_family\": \"AIX\", \"ansible_effective_user_id\": 0, \"ansible_selinux\": {\"status\": \"Missing selinux Python library\"}, \"ansible_apparmor\": {\"status\": \"disabled\"}, \"ansible_pkg_mgr\": \"unknown\", \"ansible_user_uid\": 0, \"ansible_distribution\": \"AIX\", \"ansible_user_dir\": \"/\", \"ansible_env\": {\"LANG\": \"en_US\", \"SSH_CONNECTION\": \"10.209.118.65 51848 10.209.113.68 22\", \"SHELL\": \"/usr/bin/ksh\", \"TZ\": \"CST6CDT\", \"LC__FASTMSG\": \"true\", \"CLCMD_PASSTHRU\": \"1\", \"PWD\": \"/\", \"AUTHSTATE\": \"compat\", \"SSH_CLIENT\": \"10.209.118.65 51848 22\", \"LOGNAME\": \"root\", \"USER\": \"root\", \"MAIL\": \"/var/spool/mail/root\", \"LOCPATH\": \"/usr/lib/nls/loc\", \"PATH\": \"/usr/bin:/etc:/usr/sbin:/usr/ucb:/usr/bin/X11:/sbin:/usr/java5/jre/bin:/usr/java5/bin\", \"LOGIN\": \"root\", \"NLSPATH\": \"/usr/lib/nls/msg/%L/%N:/usr/lib/nls/msg/%L/%N.cat:/usr/lib/nls/msg/%l.%c/%N:/usr/lib/nls/msg/%l.%c/%N.cat\", \"HOME\": \"/\", \"_\": \"/usr/bin/python\", \"ODMDIR\": \"/etc/objrepos\"}, \"ansible_distribution_major_version\": \"7\", \"ansible_selinux_python_present\": false, \"ansible_hostname\": \"VMAXP720-1-v05\", \"ansible_real_group_id\": 0, \"ansible_lsb\": {}, \"ansible_local\": {}, \"ansible_machine\": \"00F6E7794C00\", \"ansible_ssh_host_key_rsa_public\": \"AAAAB3NzaC1yc2EAAAADAQABAAABAQDbVMZw3/c8zHiMAU36lF1U9SjmbQ68Q+avcjsv+ZvIZi9keUfrtIZIXyKMDcWgjxjdGpkTrqsBEGzTVUIdb3NxGfaFYbbSpNhs179UJVvwUeirDHBvKeD0S6H6UQsuMjazum/Bd5WFyrYzx49sIkKyFZmMSlQn2bkud4aQpLlBJXp1YDxZFGQr6XrW0OyqVH12uVwSd/m4axkLX+z5wcouQCsb/iKIDnBv9tyKvjTQiK6+f4QUHv6l+2ypJH03cHC4MeUn4PovZC10Y242Yyq0ERoyIKvABSc8kCISkSQ8Qc9tkaePqjBKMTsg94zlcEhIvocrl63Xyv+5YwdHf2PT\", \"ansible_user_gecos\": \"\", \"ansible_python\": {\"executable\": \"/usr/bin/python\", \"version\": {\"micro\": 10, \"major\": 2, \"releaselevel\": \"final\", \"serial\": 0, \"minor\": 7}, \"type\": \"CPython\", \"has_sslcontext\": true, \"version_info\": [2, 7, 10, \"final\", 0]}, \"ansible_fqdn\": \"xxxxx.com\", \"ansible_user_gid\": 0, \"ansible_python_version\": \"2.7.10\", \"ansible_system\": \"AIX\", \"ansible_user_shell\": \"/usr/bin/ksh\", \"ansible_ssh_host_key_dsa_public\": \"AAAAB3NzaC1kc3MAAACBAPOx3ECqlvFOTSfEuNVsdsIs5RvH3EerDEyO5rhbFGswk13mOXHQt2IWglXudJUSWZccsHK/trzF/UUASAYlDTJ7NrK2xtvkcR2Es+u9po5XpU17B7mBfq5zPfPBtnLHrOZnmMEeMUuM0mUpIJ38aXhDrpPx1XeZ52GxOKec3JUHAAAAFQD+y8l1Kq9kNVNrDy/oHbQuqyu2EwAAAIBM4k581SCWDzEZfU47px1cHs2+y1eDyUqO3R9OzxTkFJPu/zw6WnqQejB0nr5hx4nMZOTKvutx+KKI8zw2h/xEu1bZQLJF0XQWIiuiWJ79lZHRpUIFUUGUY/PVDiVU5AyxAbzywNMmuJ+yS2ESsYhbv8g7xWNf5Jlm7dLsOPB5hAAAAIEA6l3UKTqnesjzq9RgDLoxUcovqYvpZzjicSjism3ut5HErPXYoTx+GWNfVbLI8itX2ozsjjumAyVZcBbjfvRAj5lhbP/f/0VkoEObOEZp1WpzEJrlLlWrO7ehi0PKjolU5fsjA8NtJR9slmVL/w6NqPf3FKvvgrpmFBNl3fnyHtE=\", \"ansible_kernel\": \"1\", \"ansible_nodename\": \"VMAXP720-1-v05\"}}\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 -tt xxxxx.com '/bin/sh -c '\"'\"'who -b && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '   .        system boot Aug 14 15:19                     \\r\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to xxxxx.com closed.\\r\\n')\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/files/find.py\r\nPipelining is enabled.\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 xxxxx.com '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '\\n{\"files\": [{\"uid\": 0, \"woth\": false, \"mtime\": 1406559120.0, \"inode\": 675, \"isgid\": false, \"size\": 44890, \"roth\": false, \"isuid\": false, \"isreg\": true, \"pw_name\": \"root\", \"gid\": 21, \"ischr\": false, \"wusr\": false, \"xoth\": false, \"rusr\": true, \"nlink\": 1, \"issock\": false, \"rgrp\": true, \"gr_name\": \"shutdown\", \"path\": \"/usr/sbin/shutdown\", \"xusr\": true, \"atime\": 1597433574.0, \"isdir\": false, \"ctime\": 1597425974.0, \"isblk\": false, \"xgrp\": true, \"dev\": 655365, \"wgrp\": false, \"isfifo\": false, \"mode\": \"0550\", \"islnk\": false}], \"changed\": false, \"msg\": \"/usr/local/sbin was skipped as it does not seem to be a valid directory or it cannot be accessed\\\\n\", \"examined\": 1001, \"invocation\": {\"module_args\": {\"excludes\": null, \"paths\": [\"/sbin\", \"/usr/sbin\", \"/usr/local/sbin\"], \"file_type\": \"any\", \"age\": null, \"contains\": null, \"recurse\": false, \"age_stamp\": \"mtime\", \"patterns\": [\"shutdown\"], \"depth\": null, \"get_checksum\": false, \"use_regex\": false, \"follow\": false, \"hidden\": false, \"size\": null}}, \"matched\": 1}\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nreboot: rebooting server...\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 -tt xxxxx.com '/bin/sh -c '\"'\"'/usr/sbin/shutdown -Fr && sleep 0'\"'\"''\r\n<xxxxx.com> (255, \"\\r\\nSHUTDOWN PROGRAM\\r\\nFri Aug 14 15:22:01 CDT 2020\\r\\n0513-044 The sshd Subsystem was requested to stop.\\r\\n\\r\\nWait for 'Rebooting...' before stopping. \\r\\nError reporting has stopped.\\r\\nAdvanced Accounting has stopped...\\r\\nProcess accounting has stopped.\\r\\nnfs_clean: Stopping NFS/NIS Daemons\\r\\n0513-004 The Subsystem or Group, nfsd, is currently inoperative.\\r\\n0513-044 The biod Subsystem was requested to stop.\\r\\n0513-044 The rpc.lockd Subsystem was requested to stop.\\r\\n0513-044 The rpc.statd Subsystem was requested to stop.\\r\\n0513-004 The Subsystem or Group, gssd, is currently inoperative.\\r\\n0513-004 The Subsystem or Group, nfsrgyd, is currently inoperative.\\r\\n0513-004 The Subsystem or Group, rpc.mountd, is currently inoperative.\\r\\n0513-004 The Subsystem or Group, ypbind, is currently inoperative.\\r\\n0513-044 The snmpmibd Subsystem was requested to stop.\\r\\n0513-044 The hostmibd Subsystem was requested to stop.\\r\\n0513-044 The aixmibd Subsystem was requested to stop.\\r\\n0513-044 The nimsh Subsystem was requested to stop.\\r\\n0513-044 The platform_agent Subsystem was requested to stop.\\r\\n0513-044 The hrd Subsystem was requested to stop.\\r\\n0513-044 The cimsys Subsystem was requested to stop.\\r\\n0513-044 The qdaemon Subsystem was requested to stop.\\r\\n0513-044 The writesrv Subsystem was requested to stop.\\r\\n0513-044 The clcomd Subsystem was requested to stop.\\r\\n0513-044 The pconsole Subsystem was requested to stop.\\r\\n0513-044 The cas_agent Subsystem was requested to stop.\\r\\n0513-044 The ctrmc Subsystem was requested to stop.\\r\\n0513-044 The pmperfrec Subsystem was requested to stop.\\r\\n0513-044 The IBM.HostRM Subsystem was requested to stop.\\r\\n0513-044 The IBM.ConfigRM Subsystem was requested to stop.\\r\\n0513-044 The IBM.DRM Subsystem was requested to stop.\\r\\n0513-044 The IBM.MgmtDomainRM Subsystem was requested to stop.\\r\\n0513-044 The IBM.ServiceRM Subsystem was requested to stop.\\r\\nAll processes currently running will now be killed...\\r\\nUnmounting the file systems...\\r\\numount: 0506-349 Cannot unmount /dev/hd10opt: The requested resource is busy.\\r\\n\", 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4497\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Control master terminated unexpectedly\\r\\nShared connection to xxxxx.com closed.\\r\\n')\r\nreboot: validating reboot\r\nreboot: attempting to get system boot time\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 -tt xxxxx.com '/bin/sh -c '\"'\"'who -b && sleep 0'\"'\"''\r\n<xxxxx.com> (0, '   .        system boot Aug 14 15:24                     \\r\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /root/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \"/root/.ansible/cp/028de6e6a2\" does not exist\\r\\ndebug2: resolving \"xxxxx.com\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to xxxxx.com [10.209.113.68] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 10000 ms remain after connect\\r\\ndebug1: permanently_set_uid: 0/0\\r\\ndebug1: identity file /root/.ssh/id_rsa type 1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_dsa type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ecdsa type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ed25519 type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\\r\\ndebug1: Enabling compatibility mode for protocol 2.0\\r\\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\\r\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.0\\r\\ndebug1: match: OpenSSH_6.0 pat OpenSSH* compat 0x04000000\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: Authenticating to xxxxx.com:22 as \\'root\\'\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from xxxxx.com\\r\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\\r\\ndebug3: send packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT sent\\r\\ndebug3: receive packet: type 20\\r\\ndebug1: SSH2_MSG_KEXINIT received\\r\\ndebug2: local client KEXINIT proposal\\r\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\\r\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\\r\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\r\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\r\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\r\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\r\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug2: peer server KEXINIT proposal\\r\\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\\r\\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\\r\\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\\r\\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\\r\\ndebug2: MACs ctos: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-256-96,hmac-sha2-512,hmac-sha2-512-96,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\\r\\ndebug2: MACs stoc: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-256-96,hmac-sha2-512,hmac-sha2-512-96,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\\r\\ndebug2: compression ctos: none,zlib@openssh.com\\r\\ndebug2: compression stoc: none,zlib@openssh.com\\r\\ndebug2: languages ctos: \\r\\ndebug2: languages stoc: \\r\\ndebug2: first_kex_follows 0 \\r\\ndebug2: reserved 0 \\r\\ndebug1: kex: algorithm: ecdh-sha2-nistp256\\r\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\r\\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64@openssh.com compression: zlib@openssh.com\\r\\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64@openssh.com compression: zlib@openssh.com\\r\\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\\r\\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\\r\\ndebug3: send packet: type 30\\r\\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\\r\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\r\\ndebug3: receive packet: type 31\\r\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:Wu5jXJpDBu4EOz5gJGuj4Fbrlv22wZdI2viwuJgHjtU\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from xxxxx.com\\r\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\r\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:367\\r\\ndebug3: load_hostkeys: loaded 1 keys from 10.209.113.68\\r\\ndebug1: Host \\'xxxxx.com\\' is known and matches the ECDSA host key.\\r\\ndebug1: Found key in /root/.ssh/known_hosts:367\\r\\ndebug3: send packet: type 21\\r\\ndebug2: set_newkeys: mode 1\\r\\ndebug1: rekey after 4294967296 blocks\\r\\ndebug1: SSH2_MSG_NEWKEYS sent\\r\\ndebug1: expecting SSH2_MSG_NEWKEYS\\r\\ndebug3: receive packet: type 21\\r\\ndebug1: SSH2_MSG_NEWKEYS received\\r\\ndebug2: set_newkeys: mode 0\\r\\ndebug1: rekey after 4294967296 blocks\\r\\ndebug2: key: /root/.ssh/id_rsa (0x55d9c88f0770)\\r\\ndebug2: key: /root/.ssh/id_dsa ((nil))\\r\\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\\r\\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\\r\\ndebug3: send packet: type 5\\r\\ndebug3: receive packet: type 6\\r\\ndebug2: service_accept: ssh-userauth\\r\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 51\\r\\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\\r\\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\\r\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_lookup publickey\\r\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\r\\ndebug3: authmethod_is_enabled publickey\\r\\ndebug1: Next authentication method: publickey\\r\\ndebug1: Offering RSA public key: /root/.ssh/id_rsa\\r\\ndebug3: send_pubkey_test\\r\\ndebug3: send packet: type 50\\r\\ndebug2: we sent a publickey packet, wait for reply\\r\\ndebug3: receive packet: type 60\\r\\ndebug1: Server accepts key: pkalg ssh-rsa blen 279\\r\\ndebug2: input_userauth_pk_ok: fp SHA256:v3a7NFXS1CZL2SE68wJf6p5YE20hM9wg2ajWzlyj/Og\\r\\ndebug3: sign_and_send_pubkey: RSA SHA256:v3a7NFXS1CZL2SE68wJf6p5YE20hM9wg2ajWzlyj/Og\\r\\ndebug3: send packet: type 50\\r\\ndebug3: receive packet: type 52\\r\\ndebug1: Enabling compression at level 6.\\r\\ndebug1: Authentication succeeded (publickey).\\r\\nAuthenticated to xxxxx.com ([10.209.113.68]:22).\\r\\ndebug1: setting up multiplex master socket\\r\\ndebug3: muxserver_listen: temporary control path /root/.ansible/cp/028de6e6a2.Qaq0KABynczuchMm\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug3: fd 4 is O_NONBLOCK\\r\\ndebug1: channel 0: new [/root/.ansible/cp/028de6e6a2]\\r\\ndebug3: muxserver_listen: mux listener channel 0 fd 4\\r\\ndebug2: fd 3 setting TCP_NODELAY\\r\\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\\r\\ndebug1: control_persist_detach: backgrounding master process\\r\\ndebug2: control_persist_detach: background process is 6576\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug1: forking to background\\r\\ndebug1: Entering interactive session.\\r\\ndebug1: pledge: id\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug1: multiplexing control connection\\r\\ndebug2: fd 5 setting O_NONBLOCK\\r\\ndebug3: fd 5 is O_NONBLOCK\\r\\ndebug1: channel 1: new [mux-control]\\r\\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\\r\\ndebug3: mux_master_read_cb: channel 1: hello sent\\r\\ndebug2: set_control_persist_exit_time: cancel scheduled exit\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\\r\\ndebug2: process_mux_master_hello: channel 1 slave version 4\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\\r\\ndebug2: process_mux_alive_check: channel 1: alive check\\r\\ndebug3: mux_client_request_alive: done pid = 6578\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 118\\r\\ndebug2: process_mux_new_session: channel 1: request tty 1, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'who -b && sleep 0\\'\", env 2\\r\\ndebug3: process_mux_new_session: got fds stdin 6, stdout 7, stderr 8\\r\\ndebug2: fd 7 setting O_NONBLOCK\\r\\ndebug2: fd 8 setting O_NONBLOCK\\r\\ndebug1: channel 2: new [client-session]\\r\\ndebug2: process_mux_new_session: channel_new: 2 linked to control channel 1\\r\\ndebug2: channel 2: send open\\r\\ndebug3: send packet: type 90\\r\\ndebug3: receive packet: type 91\\r\\ndebug2: callback start\\r\\ndebug2: client_session2_setup: id 2\\r\\ndebug2: channel 2: request pty-req confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending environment.\\r\\ndebug1: Sending env LANG = en_US.UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending env LC_CTYPE = UTF-8\\r\\ndebug2: channel 2: request env confirm 0\\r\\ndebug3: send packet: type 98\\r\\ndebug1: Sending command: /bin/sh -c \\'who -b && sleep 0\\'\\r\\ndebug2: channel 2: request exec confirm 1\\r\\ndebug3: send packet: type 98\\r\\ndebug3: mux_session_confirm: sending success reply\\r\\ndebug2: callback done\\r\\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: PTY allocation request accepted on channel 2\\r\\ndebug2: channel 2: rcvd adjust 2097152\\r\\ndebug3: receive packet: type 99\\r\\ndebug2: channel_input_status_confirm: type 99 id 2\\r\\ndebug2: exec request accepted on channel 2\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\\r\\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\\r\\ndebug3: receive packet: type 98\\r\\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\\r\\ndebug2: channel 2: rcvd eow\\r\\ndebug2: channel 2: close_read\\r\\ndebug2: channel 2: input open -> closed\\r\\ndebug3: receive packet: type 96\\r\\ndebug2: channel 2: rcvd eof\\r\\ndebug2: channel 2: output open -> drain\\r\\ndebug3: receive packet: type 97\\r\\ndebug2: channel 2: rcvd close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug3: channel 2: will not send data after close\\r\\ndebug2: channel 2: obuf empty\\r\\ndebug2: channel 2: close_write\\r\\ndebug2: channel 2: output drain -> closed\\r\\ndebug2: channel 2: send close\\r\\ndebug3: send packet: type 97\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: gc: notify user\\r\\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\\r\\ndebug2: channel 1: rcvd close\\r\\ndebug2: channel 1: output open -> drain\\r\\ndebug2: channel 1: close_read\\r\\ndebug2: channel 1: input open -> closed\\r\\ndebug2: channel 2: gc: user detached\\r\\ndebug2: channel 2: is dead\\r\\ndebug2: channel 2: garbage collecting\\r\\ndebug1: channel 2: free: client-session, nchannels 3\\r\\ndebug3: channel 2: status: The following connections are open:\\r\\n  #1 mux-control (t16 r-1 i3/0 o1/0 fd 5/5 cc -1)\\r\\n  #2 client-session (t4 r0 i3/0 o3/0 fd -1/-1 cc -1)\\r\\n\\r\\ndebug2: channel 1: obuf empty\\r\\ndebug2: channel 1: close_write\\r\\ndebug2: channel 1: output drain -> closed\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: gc: notify user\\r\\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\\r\\ndebug2: channel 1: gc: user detached\\r\\ndebug2: channel 1: is dead (local)\\r\\ndebug2: channel 1: garbage collecting\\r\\ndebug1: channel 1: free: mux-control, nchannels 2\\r\\ndebug3: channel 1: status: The following connections are open:\\r\\n  #1 mux-control (t16 r-1 i3/0 o3/0 fd 5/5 cc -1)\\r\\n\\r\\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to xxxxx.com closed.\\r\\n')\r\nreboot: attempting post-reboot test command\r\n<xxxxx.com> ESTABLISH SSH CONNECTION FOR USER: None\r\n<xxxxx.com> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/028de6e6a2 -tt xxxxx.com '/bin/sh -c '\"'\"'whoami && sleep 0'\"'\"''\r\n\r\n```\r\n\r\nthere it is hung \r\n\r\nkindly check and let me know the  inputs for the same \r\nsame is working with AIX 7.2 Tl4 \r\n\r\nRegards,\r\nTeja",
        "created_at": "2020-08-14T20:37:56Z",
        "user": "teja9415",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 71247,
        "title": "group module failed to add a administrator group on AIX system.",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nGroup module failed on adding an administrator group on AIX system.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ngroup\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/Users/satoshi/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/Cellar/ansible/2.9.0/libexec/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.5 (default, Nov  1 2019, 02:16:23) [Clang 11.0.0 (clang-1100.0.33.8)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n7200-03-04-1938\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n  - name: add group \"test\"\r\n    group:\r\n      name: \"test\"\r\n      gid: 2020\r\n      state: present\r\n      system: true\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nExpected successfully created the administrator group \"test\".\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nPLAY [setting aix host] ********************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************************************************************************************************************************************************************************\r\nok: [aix72]\r\n\r\nTASK [group : add group \"test\"] ***********************************************************************************************************************************************************************************************************\r\nfatal: [aix72]: FAILED! => {\"changed\": false, \"msg\": \"\uff82\u4f7f\uff82\u7528\uff82\u965b\uff7b\uff82\u6cd5: mkgroup [-R load_module] [-a] [-A] \u00a5\"attr=value\u00a5\" ... newgroup\u00a5n\", \"name\": \"test\"}\r\n\r\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************\r\naix72                      : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0  \r\n```\r\n\r\n##### My Solution : Replace the code \"cmd.append('-a')\" with \"cmd.insert(1,'-a')\".\r\n```yaml\r\n    def group_add(self, **kwargs):\r\n        cmd = [self.module.get_bin_path('mkgroup', True)]\r\n        for key in kwargs:\r\n            if key == 'gid' and kwargs[key] is not None:\r\n                cmd.append('id=' + str(kwargs[key]))\r\n            elif key == 'system' and kwargs[key] is True:\r\n                **cmd.insert(1,'-a')**\r\n        cmd.append(self.name)\r\n        return self.execute_command(cmd)\r\n```\r\n",
        "created_at": "2020-08-13T06:28:50Z",
        "user": "sato84",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 71209,
        "title": "Using passwd command to change a user password instead of usermod",
        "body": "##### SUMMARY\r\nIn the user module, change password function reveals the hash on command line, like so:\r\n\r\n```\r\nroot     10701  0.0  0.0 113284  1176 pts/2    Ss+  17:01   0:00      \\_ /bin/sh -c /usr/bin/python /root/.ansible/tmp/ansible-tmp-1597078905.92349-75892-180896354627111/AnsiballZ_user.py && sleep 0\r\n\r\nroot     10710 13.0  0.7 218804 14468 pts/2    S+   17:01   0:00  \\_ /usr/bin/python /root/.ansible/tmp/ansible-tmp-1597078905.92349-75892-180896354627111/AnsiballZ_user.py\r\n\r\nroot     10716  0.0  0.1 140524  3332 pts/2    D+   17:01   0:00      \\_ /usr/sbin/usermod -p $6$albLepiw3KOb.M0I$oW.QwqWPaCaJvX6hH7La5KJ0nXFMVisPUIzMFx3gRc5JdN8jn6.RfvdVfe8VzeloSLfJTIAg8Se.KqLKVUJYZ/ root \r\n\r\n```\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nuser module, password update.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nfrom man usermod:\r\n```\r\n       -p, --password PASSWORD\r\n           The encrypted password, as returned by crypt(3).\r\n\r\n           Note: This option is not recommended because the password (or encrypted password) will be visible by users listing the processes.\r\n\r\n```\r\n\r\nlinux `passwd` command accepts passwords from stdin, might be worth considering it as an alternative using environment variables like so:\r\n\r\n`echo $MY_SECRET_PASS| passwd--stdin someuser` \r\n\r\nOr some similar approach that doesn't reveal the password or the hash on the command line.",
        "created_at": "2020-08-11T15:23:40Z",
        "user": "anazmy",
        "labels": [
            "module",
            "support:core",
            "feature",
            "P3",
            "system",
            "affects_2.11",
            "security"
        ]
    },
    {
        "number": 71201,
        "title": "Add support for the gss_auth option to the paramiko_ssh connection plugin",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\nAdd support for the gss_auth option in the paramiko library to the paramiko_ssh connection plugin to enable GSS-API authentication required for Kerberos authenticated hosts.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nparamiko_ssh\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\nThe paramiko ssh client library has supported GSS-API for a number of years, but  the paramiko_ssh connection plugin does not provide a method for enabling this support (passing gss_auth=True to the client connect() function). This is required to support authentication in environments where centralised identity management uses kerberos (e.g. FreeIPA).\r\n\r\nThe default openssh client does support GSS-API however the new network_cli connection plugin for network devices forces the use of paramiko_ssh as the ssh transport rather than allowing the use of openssh.\r\n\r\nA first attempt at a PR for this is #71190 \r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nWithout gss_auth enabled for paramiko_ssh against a kerberos authenticated host:\r\n\r\n```\r\n(venv) kim.covil@dragon:~/src/ansible$ ansible -m ping -c paramiko -i $HOSTNAME, $HOSTNAME\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can become unstable at any point.\r\ndragon.office.transficc.net | UNREACHABLE! => {\r\n    \"changed\": false,\r\n    \"msg\": \"Failed to authenticate: Authentication failed.\",\r\n    \"unreachable\": true\r\n}\r\n```\r\n\r\nWith gss_auth enabled for paramiko_ssh against a kerberos authenticated host:\r\n\r\n```\r\n(venv) kim.covil@dragon:~/src/ansible-arnoxit$ cat ansible.cfg\r\n[paramiko_connection]\r\ngss_auth = True\r\n(venv) kim.covil@dragon:~/src/ansible-arnoxit$ ansible -m ping -c paramiko -i $HOSTNAME, $HOSTNAME\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under development. This is a rapidly changing source of code and can become unstable at any point.\r\n[WARNING]: Platform linux on host dragon.office.transficc.net is using the discovered Python interpreter at /usr/bin/python, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible/devel/reference_appendices/interpreter_discovery.html for\r\nmore information.\r\ndragon.office.transficc.net | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/bin/python\"\r\n    },\r\n    \"changed\": false,\r\n    \"ping\": \"pong\"\r\n}\r\n```\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2020-08-11T10:42:12Z",
        "user": "arnoxit",
        "labels": [
            "needs_info",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 70910,
        "title": "allow usage of documentation fragments in EXAMPLES and RETURN",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nCurrently, one can only use documentation fragments in the main `DOCUMENTATION` block. It would be nice if one could use them (or a similar concept) in `EXAMPLES` and `RETURN` sections.\r\n\r\nThis can be especially useful for collections that have many modules that interact with the same API and thus have common return values.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/parsing/plugin_docs.py",
        "created_at": "2020-07-27T07:39:38Z",
        "user": "evgeni",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.14"
        ]
    },
    {
        "number": 70888,
        "title": "Using sshpass, ssh with proxycommand and a password for sudo fails",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n\r\nI'm using password for both ssh and sudo. I also have a subset of machines behind a bastion so I'm using sshpass in a proxycommand in order to reach those nodes.\r\n\r\nI refer to this as: sshpass -> ssh -> proxy -> sudo\r\n\r\nWhere proxy is defined as: sshpass -> ssh\r\n\r\nJust as a sanity check, I also disabled the use of sshpass and used ssh keys with an agent instead. The behavior works as expected: ssh -> proxy -> sudo.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\nplugins/connection/ssh.py\r\nplugins/become/sudo.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n2.9.10\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_NOCOWS(/home/user/code/playbooks/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/home/user/code/playbooks/ansible.cfg) = False\r\nANSIBLE_SSH_RETRIES(/home/user/code/playbooks/ansible.cfg) = 3\r\nCACHE_PLUGIN(/home/user/code/playbooks/ansible.cfg) = mongodb\r\nCACHE_PLUGIN_CONNECTION(/home/user/code/playbooks/ansible.cfg) = mongodb://mongo01.example.com/ansible\r\nDEFAULT_ACTION_PLUGIN_PATH(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/library/actions']\r\nDEFAULT_CALLBACK_WHITELIST(/home/user/code/playbooks/ansible.cfg) = ['logstash']\r\nDEFAULT_FILTER_PLUGIN_PATH(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/library/filters']\r\nDEFAULT_FORKS(/home/user/code/playbooks/ansible.cfg) = 32\r\nDEFAULT_GATHERING(/home/user/code/playbooks/ansible.cfg) = smart\r\nDEFAULT_GATHER_TIMEOUT(/home/user/code/playbooks/ansible.cfg) = 60\r\nDEFAULT_HOST_LIST(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/inventory/hosts.ini']\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/library/lookups']\r\nDEFAULT_MODULE_PATH(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/library/modules']\r\nDEFAULT_ROLES_PATH(/home/user/code/playbooks/ansible.cfg) = ['/home/user/code/playbooks/roles']\r\nDEFAULT_TIMEOUT(/home/user/code/playbooks/ansible.cfg) = 60\r\nHOST_KEY_CHECKING(/home/user/code/playbooks/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/home/user/code/playbooks/ansible.cfg) = auto\r\nINVENTORY_CACHE_ENABLED(/home/user/code/playbooks/ansible.cfg) = True\r\nINVENTORY_CACHE_PLUGIN(/home/user/code/playbooks/ansible.cfg) = mongodb\r\nINVENTORY_ENABLED(/home/user/code/playbooks/ansible.cfg) = ['script', 'auto', 'yaml', 'ini']\r\nPERSISTENT_COMMAND_TIMEOUT(/home/user/code/playbooks/ansible.cfg) = 90\r\nPERSISTENT_CONNECT_RETRY_TIMEOUT(/home/user/code/playbooks/ansible.cfg) = 75\r\nRETRY_FILES_ENABLED(/home/user/code/playbooks/ansible.cfg) = False\r\nTRANSFORM_INVALID_GROUP_CHARS(/home/user/code/playbooks/ansible.cfg) = always\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\nThe control machine is running in Docker. The base image is debian:bullseye-backports. It uses apt to install python and other system deps. Then uses pip to install ansible and the rest of the python requirements.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nExample 1 (works)\r\n\r\n```yaml\r\nansible_ssh_extra_args: >-\r\n  -o ProxyCommand=\"sshpass -f'{{ duo_pass_file.dest }}' ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p {{ duo_user }}@{{ duo_jump }}\" \r\n```\r\n\r\nExample 2 (works)\r\n\r\n```yaml\r\nansible_sftp_extra_args: >-\r\n  -o ProxyCommand=\"sshpass -f'{{ duo_pass_file.dest }}' ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p {{ duo_user }}@{{ duo_jump }}\" \r\n```\r\n\r\nExample 3 (broken)\r\n\r\n```yaml\r\nansible_ssh_extra_args: >-\r\n  -o ProxyCommand=\"sshpass -f'{{ duo_pass_file.dest }}' ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p {{ duo_user }}@{{ duo_jump }}\"\r\n\r\nansible_sftp_extra_args: >-\r\n  -o ProxyCommand=\"sshpass -f'{{ duo_pass_file.dest }}' ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p {{ duo_user }}@{{ duo_jump }}\" \r\n```\r\n\r\nFrom there just run any playbook on a host using ssh and sudo.\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nI would expect to be able to sshpass -> ssh -> proxy -> sudo. This actually does work but only when sftp isn't using the proxy. Even though the same files seem to exist.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n<!--- Paste verbatim command output between quotes -->\r\n\r\nHere is Example 1 executing the Python command successfully under sshpass -> ssh -> proxy -> sudo\r\n\r\n```paste below\r\n SSH: EXEC sshpass -d11 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o 'User=\"user\"' -o ConnectTimeout=60 -o 'ProxyCommand=sshpass -f'\"'\"'/workspace/playbooks/pci/sshpass.txt'\"'\"' ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p svc_middlebot@jump01.example.com' -o ControlPath=/root/.ansible/cp/d23189ee70 -tt node01.example.com '/bin/sh -c '\"'\"'sudo -H -S  -p \"[sudo via ansible, key=gxsqsacibjmesqtwqvupkywzykbdhblw] password:\" -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-gxsqsacibjmesqtwqvupkywzykbdhblw ; /bin/python /home/dgilmor/.ansible/tmp/ansible-tmp-1595625477.7720368-79-42130400300163/AnsiballZ_command.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n```\r\n\r\nHere is Example 3 executing the Python command and failing under sshpass -> ssh -> proxy -> sudo\r\n\r\n```\r\nSSH: EXEC sshpass -d11 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o 'User=\"user\"' -o ConnectTimeout=60 -o 'ProxyCommand=sshpass -f'\"'\"'/workspace/playbooks/pci/sshpass.txt'\"'\"' ssh -vvv -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -W %h:%p svc_middlebot@jump01.example.com' -o ControlPath=/root/.ansible/cp/d23189ee70 -tt node01.example.com '/bin/sh -c '\"'\"'sudo -H -S  -p \"[sudo via ansible, key=ehenmgofsxkqyfbwvfykukkwsichtuvt] password:\" -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-ehenmgofsxkqyfbwvfykukkwsichtuvt ; /bin/python /home/dgilmor/.ansible/tmp/ansible-tmp-1595620606.4456282-78-12418190787852/AnsiballZ_command.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded \r\n```\r\n\r\nThe 2 SSH: EXEC lines above are basically 100% the same. One works and one doesn't. The only difference was sftp was set to use the ssh proxy on Example 3, but Example 1 used sftp by connecting to the node directly. The confusing bit is I'm not sure why/where/how sftp config is being used in these lines. I inspected the AnsiballZ_command.py, but it looks like it's filled up with zip contents.\r\n\r\nThis is the error:\r\n\r\n```\r\n    \"module_stdout\": \"[sudo via ansible, key=ehenmgofsxkqyfbwvfykukkwsichtuvt] password:\\r\\nsudo: timed out reading password\\r\\n\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 1                                                                                                                                                                                                      }  \r\n```\r\n\r\nEDIT:\r\n\r\nI just tried putting the sshpass back in for the proxy command, but leaving out the outer sshpass that Ansible uses if `ansible_pass` is set. This seems to work while sftp/ssh args are set to use the proxy.\r\n",
        "created_at": "2020-07-24T22:38:19Z",
        "user": "iridian-ks",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 70834,
        "title": "ansible incorrectly displays the size of lastlog",
        "body": "##### SUMMARY\r\nansible incorrectly displays the size of lastlog\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nfind\r\nstat\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.10\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\n---\r\n- name: Find files bigger than 200mb in size\r\n  hosts: all\r\n  tasks:\r\n   - name : Find files bigger than 200mb in size\r\n     become: true\r\n     find:\r\n       paths: /var/log\r\n       file_type: file\r\n       size: 200m\r\n       recurse: yes\r\n     register: output\r\n\r\n   - debug:\r\n       msg:\r\n       - \"Path: '{{ output.files[0].path }}' \"\r\n       - \"Size: '{{ output.files[0].size|filesizeformat }}' \"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\ndu\r\n```\r\ndu --apparent-size /var/log/lastlog\r\n517870837\t/var/log/lastlog\r\n```\r\n```\r\ndu -sh /var/log/lastlog\r\n328K\t/var/log/lastlog\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nOutput\r\n```\r\n    \"msg\": [\r\n        \"Path: '/var/log/lastlog' \", \r\n        \"Size: '530.3 GB' \"\r\n    ]\r\n}\r\n```",
        "created_at": "2020-07-23T09:53:12Z",
        "user": "patsevanton",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "files",
            "affects_2.9",
            "affects_2.15"
        ]
    },
    {
        "number": 70360,
        "title": "Ansible setup fails to detect domain of server",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\n`ansible_facts.domain` is empty and `ansible_facts.fqdn` contains only the hostname even though `hostname -f` on the server works correctly.\r\n\r\nThere are two ways to make `hostname -f` work. Either have DNS set up and include the domain in `search` in `/etc/resolv.conf`, or have a record for the qualified and unqualified hostname in `/etc/hosts`. I am using the former approach as it is easier for automatic imaging.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nhostname\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.10.0b1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.3 (default, Dec 20 2019, 18:57:59) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = smart\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = auto\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\nTarget OS Version: Ubuntu 18.04.4 LTS (Bionic Beaver)\r\n\r\nTarget Python: Python 3.6.9 (default, Apr 18 2020, 01:56:04)\r\n\r\nContent of `/etc/hosts`:\r\n\r\n```\r\n127.0.0.1       localhost\r\n\r\n# The following lines are desirable for IPv6 capable hosts\r\n::1     localhost ip6-localhost ip6-loopback\r\nff02::1 ip6-allnodes\r\nff02::2 ip6-allrouters\r\n```\r\n\r\n`/etc/resolv.conf` (link to `/run/resolvconf/resolv.conf`) contains:\r\n\r\n```\r\nsearch example.com\r\n```\r\n\r\n`hostname -f` returns the fully qualified hostname (`server.example.com`), `hostname -i` returns the default IP address of the server.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\nansible -m setup server.example.com | grep 'fqdn\\|domain'\r\n```\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\n```\r\n       \"ansible_domain\": \"\",\r\n       \"ansible_fqdn\": \"server\",\r\n```\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n       \"ansible_domain\": \"example.com\",\r\n       \"ansible_fqdn\": \"server.example.com\",\r\n```\r\n\r\nI did try with `-vvvv`, but the only additional output is the raw JSON sent by the setup module from the target that is subsequently pretty-printed, but nothing about where it was looking for the domain.\r\n\r\nGiving it a bit more thought this might be a bug in python. The `socket.getfqdn()` function calls `socket.gethostbyaddr(socket.gethostname())`, which does read `/etc/hosts`, but does not qualify the name with value of `search` under which it was found if that had to be done. The `hostname` utility calls `getaddrinfo`, which finds the right value if called like `socket.getaddrinfo(socket.gethostname(), None, flags=socket.AI_CANONNAME)`. Alternatively the `socket.gethostbyname_ex` does resolve the canonical hostname too and should be easier to use.",
        "created_at": "2020-06-29T13:45:36Z",
        "user": "jan-hudec",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "system",
            "affects_2.10"
        ]
    },
    {
        "number": 70279,
        "title": "\"Unhandled exception occurred while templating\" when upgrading from Ansible 2.9.9 to 2.9.10",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n\r\nWe have a small playbook that we use to quickly set downtime quickly in Nagios. This playbook runs without any discernible problem with Ansible 2.9.9. We upgraded to 2.9.10 and now the playbook no longer works.\r\n\r\nThis is from the start of the error message:\r\n\r\n```\r\nAn unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}\r\n```\r\n\r\nand this from the tail end:\r\n\r\n```\r\noriginal message: recursive loop detected in template string: {{ ansible_user | default(omit, true) }}\"\r\n```\r\n\r\nThe full error is at the bottom of this issue report.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\n`TASK [Nagios | ADD downtime for services]`\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.10\r\n  config file = /home/ansible/projects/ansible-playbooks-team/ansible.cfg\r\n  configured module search path = [u'/home/ansible/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Apr 15 2020, 17:20:14) [GCC 7.5.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = True\r\nANSIBLE_SSH_RETRIES(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = 5\r\nCACHE_PLUGIN(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = /tmp/facts_cache\r\nCACHE_PLUGIN_TIMEOUT(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = 3600\r\nDEFAULT_CALLBACK_WHITELIST(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = [u'profile_tasks', u'profile_roles', u'timer']\r\nDEFAULT_FORCE_HANDLERS(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = True\r\nDEFAULT_FORKS(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = 50\r\nDEFAULT_GATHERING(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = smart\r\nDEFAULT_GATHER_TIMEOUT(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = 30\r\nDEFAULT_HOST_LIST(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = [u'/home/ansible/projects/ansible-playbooks-team/inventories/production']\r\nDEFAULT_LOG_PATH(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = /home/ansible/ansible.log\r\nDEFAULT_ROLES_PATH(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = [u'/home/ansible/projects/ansible-playbooks-team/roles']\r\nDISPLAY_SKIPPED_HOSTS(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/home/ansible/projects/ansible-playbooks-team/ansible.cfg) = /tmp\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n- Controller system: Ubuntu 18.04 LTS VM\r\n- Target system: Ubuntu 18.04 LTS VM\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Mass-manage Nagios maintenance status\r\n  hosts: all\r\n  gather_facts: no\r\n\r\n  vars:\r\n\r\n    # Fallback value if playbook user opts to use a custom host list\r\n    # where this value is not already configured.\r\n    our_nagios_server: \"nag.example.com\"\r\n\r\n    # Attempt to use existing inventory variable, fallback to hard-coded\r\n    # value if not found.\r\n    nagios_box: \"{{ nagios_server | default(our_nagios_server) }}\"\r\n\r\n    # Map external options for playbook to specific Nagios module actions\r\n    nagios_actions:\r\n      add: \"downtime\"\r\n      remove: \"delete_downtime\"\r\n\r\n    # This should be overridden by command-line\r\n    state: \"undefined\"\r\n\r\n    # module default is 30 minutes, here we set 60 minutes unless overridden\r\n    # at command-line\r\n    downtime_duration: \"60\"\r\n\r\n  tasks:\r\n\r\n  - name: Ensure that valid options are passed\r\n    assert:\r\n      that:\r\n        - \"'state' is defined\"\r\n        - \"('{{ state | lower }}' == 'add' ) or ('{{ state | lower }}' == 'remove')\"\r\n      fail_msg: \"ERROR: Desired Nagios maintenance state not specified. Please specify either add or remove syntax and try again.\"\r\n      success_msg: \"OK: Desired state indicated as '{{ state | lower }}' , proceeding... \"\r\n\r\n\r\n  - name: \"Nagios | {{ state | upper }} downtime for services\"\r\n    delegate_to: \"{{ nagios_box }}\"\r\n    become: yes\r\n    remote_user: \"{{ ansible_user | default(omit, true) }}\"\r\n    nagios:\r\n      action: \"{{ nagios_actions[state] }}\"\r\n      host: \"{{ inventory_hostname }}\"\r\n      minutes: \"{{ downtime_duration }}\"\r\n      service: all\r\n\r\n\r\n  - name: \"Nagios | {{ state | upper }} downtime for hosts\"\r\n    delegate_to: \"{{ nagios_box }}\"\r\n    become: yes\r\n    remote_user: \"{{ ansible_user | default(omit, true) }}\"\r\n    nagios:\r\n      action: \"{{ nagios_actions[state] }}\"\r\n      host: \"{{ inventory_hostname }}\"\r\n      minutes: \"{{ downtime_duration }}\"\r\n      service: host\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nDowntime applied using v2.9.10 as it was with Ansible v2.9.9.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\nPlaybook run failed with `An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'`\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nfatal: [primary.example.com]: FAILED! => {\"msg\": \"An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ ansible_user | default(omit, true) }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: recursive loop detected in template string: {{ ansible_user | default(omit, true) }}\"}\r\n```\r\n",
        "created_at": "2020-06-24T22:47:08Z",
        "user": "atc0005",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.9",
            "data_tagging",
            "affects_2.19"
        ]
    },
    {
        "number": 70200,
        "title": "Incorrect command line parsing for ansible-vault encrypt_string --prompt",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\n`ansible-vault encrypt_string --prompt` doesn't work: ERROR! The --prompt option is not supported if also reading input from stdin.\r\nAs I understand, if a string to encrypt is not provided in command line it assumes that it would be read from stdin:\r\nhttps://github.com/ansible/ansible/blob/eaf6086eeab3ffc0389694a037c776cd3d6ac0b5/lib/ansible/cli/vault.py#L132\r\nIt works if I add some extra string to encrypt:\r\n```\r\nansible-vault encrypt_string --prompt \"test_string\"\r\n```\r\nBut the result will be two encrypted strings.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/cli/vault\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.10\r\n  config file = /home/stas/ansible/ansible.cfg\r\n  configured module search path = [u'/home/stas/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Apr 15 2020, 17:20:14) [GCC 7.5.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/home/stas/ansible/ansible.cfg) = True\r\nDEFAULT_FORCE_HANDLERS(/home/stas/ansible/ansible.cfg) = True\r\nDEFAULT_HOST_LIST(/home/stas/ansible/ansible.cfg) = [u'/home/stas/ansible/production']\r\nDEFAULT_JINJA2_EXTENSIONS(/home/stas/ansible/ansible.cfg) = jinja2.ext.do\r\nDEFAULT_REMOTE_USER(/home/stas/ansible/ansible.cfg) = root\r\nDEFAULT_VAULT_IDENTITY_LIST(/home/stas/ansible/ansible.cfg) = [u'@~/.ansible_vault_identity_file']\r\nINJECT_FACTS_AS_VARS(/home/stas/ansible/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/home/stas/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nUbuntu 18.04.4 LTS\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nRun\r\n```\r\nansible-vault encrypt_string --prompt\r\n```\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nansible-vault should prompt for the string and variable name to encrypt.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nERROR! The --prompt option is not supported if also reading input from stdin\r\n```\r\n",
        "created_at": "2020-06-22T14:35:54Z",
        "user": "stasjok",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 70092,
        "title": "connection/local.py become problem exposed by `script` module",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nThere are 2 problems here if the script called quickly produces output:\r\n1) to stdout -> this is not copied to output of the script\r\n2) to stderr -> ansible fails with `privilege output closed while waiting for password prompt`\r\n\r\nReproducibility is at the mercy of the scheduler.\r\n\r\nWill propose a fix a later time.\r\n\r\n##### ROOT CAUSE\r\n```\r\nLogic responsible for parsing output is wrong.\r\nChunk read from stdout is overriden by chunk read from stderr.\r\nIn my test this always happened, the events list had stdout before stderr, yet the other way arround might happen.\r\nThis lost piece of information never goes through `self.become.check_success` or `self.become.check_password_prompt`\r\n\r\nconnection/local.py\r\n                    for key, event in events:\r\n                        if key.fileobj == p.stdout:\r\n                            chunk = p.stdout.read()\r\n                        elif key.fileobj == p.stderr:\r\n                            chunk = p.stderr.read()\r\n\r\nThe other issue is that chunk = p.stdout.read() might read from the called script. This info is lost, not forwarded further as part of actual stdout of the script\r\n\r\n```\r\n\r\n##### HOW TO REPRODUCE 100% of the time\r\n\r\n```\r\nIn file lib/ansible/plugins/action/__init__.py (line about ~1120 in devel branch) identify line:\r\n'rc, stdout, stderr = self._connection.exec_command(cmd, in_data=in_data, sudoable=sudoable)'\r\n\r\nBefore that line insert a breakpoint similar to this:\r\nif \"BECOME\" in cmd:\r\n  INSERT_BREAKPOINT_HERE\r\n\r\nstep once into exec_command\r\nthen next until the hot spot shown in `ROOT CAUSE` section above\r\n\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/plugins/connection/local.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n\r\n[original seen]\r\nansible 2.7.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/sysadmin/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, May 26 2020, 18:42:46) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n\r\n[devel reproduced]\r\nansible 2.10.0.dev0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/dan/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/dan/test/ansible/lib/ansible\r\n  executable location = /home/dan/test/ansible/bin/ansible\r\n  python version = 3.6.9 (default, Apr 18 2020, 01:56:04) [GCC 8.4.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n[original seen]\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /home/sysadmin/ansible.log\r\nDEFAULT_STDOUT_CALLBACK(/etc/ansible/ansible.cfg) = skippy\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n\r\n[devel reproduced]\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n[devel reproduced]\r\nLinux N1 5.3.0-53-generic #47~18.04.1-Ubuntu SMP Thu May 7 13:10:50 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n#cat play1.yml\r\n- hosts: localhost\r\n  gather_facts: no\r\n  become: yes\r\n  vars:\r\n    ansible_become_pass: 'EDITED'\r\n\r\n  tasks:\r\n    - name: TEST\r\n      script: b.sh\r\n\r\n# Each of these were originally `b.sh`, but named them differently here to show different results\r\n#cat b1.sh\r\necho CCCCC\r\n\r\n#cat b2.sh\r\necho AAAAA >&2\r\n\r\n\r\n```\r\n\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\n$ ansible-playbook /home/sysadmin/play1.yml -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n\r\nPLAY [all] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [TEST B2] ***********************************************************************************************************************************************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"rc\": 0, \"stderr\": \"AAAAA\\n\", \"stderr_lines\": [\"AAAAA\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0  \r\n\r\n\r\n$ ansible-playbook /home/sysadmin/play1.yml -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n\r\nPLAY [all] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [TEST B1] ***********************************************************************************************************************************************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"rc\": 0, \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"CCCCC\\n\", \"stdout_lines\": [\"CCCCC\"]}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0  \r\n\r\n\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n$ ansible-playbook /home/sysadmin/play1.yml -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n\r\nPLAY [all] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [TEST B2] ***********************************************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"msg\": \"privilege output closed while waiting for password prompt:\\nAAAAA\\n\"}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1   \r\n\r\n\r\n\r\n$ ansible-playbook /home/sysadmin/play1.yml -v\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n\r\nPLAY [all] *************************************************************************************************************************************************************************************************\r\n\r\nTASK [TEST B1] ***********************************************************************************************************************************************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"rc\": 0, \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0\r\n\r\n```\r\n\r\n\r\n##### DETAILED LOG\r\n```\r\nb1.sh variant\r\n2301709 1591355427.39285: _low_level_execute_command(): starting\r\n2301709 1591355427.39305: _low_level_execute_command(): using become for this command\r\n2301709 1591355427.39340: _low_level_execute_command(): executing: /bin/sh -c 'sudo -H -S  -p \"[sudo via ansible, key=anjdklaygpvdhoontbjzibppaebaauab] password: \" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-anjdklaygpvdhoontbjzibppaebaauab;  /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355427.36-49499807404831/b.sh'\"'\"' && sleep 0'\r\n2301709 1591355427.39358: in local.exec_command()\r\n<localhost> EXEC /bin/sh -c 'sudo -H -S  -p \"[sudo via ansible, key=anjdklaygpvdhoontbjzibppaebaauab] password: \" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-anjdklaygpvdhoontbjzibppaebaauab;  /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355427.36-49499807404831/b.sh'\"'\"' && sleep 0'\r\n2301709 1591355427.39383: opening command with Popen()\r\n2301709 1591355427.40111: done running command with Popen()\r\n2301709 1591355427.45459: HOOKED events [(SelectorKey(fileobj=<open file '<fdopen>', mode 'rb' at 0x7f27c5bc48a0>, fd=13, events=1, data=None), 1)]\r\n2301709 1591355427.45485: HOOKED stdout BECOME-SUCCESS-anjdklaygpvdhoontbjzibppaebaauab\r\nCCCCC\r\n\r\n2301709 1591355427.45510: getting output with communicate()\r\n2301709 1591355427.46917: done communicating\r\n2301709 1591355427.46937: done with local.exec_command()\r\n2301709 1591355427.46961: _low_level_execute_command() done: rc=0, stdout=, stderr=\r\n2301709 1591355427.46988: _low_level_execute_command(): starting\r\n2301709 1591355427.47010: _low_level_execute_command(): executing: /bin/sh -c 'rm -f -r /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355427.36-49499807404831/ > /dev/null 2>&1 && sleep 0'\r\n2301709 1591355427.47029: in local.exec_command()\r\n<localhost> EXEC /bin/sh -c 'rm -f -r /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355427.36-49499807404831/ > /dev/null 2>&1 && sleep 0'\r\n2301709 1591355427.47050: opening command with Popen()\r\n2301709 1591355427.47708: done running command with Popen()\r\n2301709 1591355427.47759: getting output with communicate()\r\n2301709 1591355427.48615: done communicating\r\n2301709 1591355427.48640: done with local.exec_command()\r\n2301709 1591355427.48664: _low_level_execute_command() done: rc=0, stdout=, stderr=\r\n2301709 1591355427.48687: handler run complete\r\n2301709 1591355427.48714: attempt loop complete, returning result\r\n2301709 1591355427.48741: _execute() done\r\n2301709 1591355427.48758: dumping result to json\r\n2301709 1591355427.48775: done dumping result, returning\r\n2301709 1591355427.48806: done running TaskExecutor() for localhost/TASK: TESTB [0800271f-bb24-03f1-f9f4-000000000008]\r\n2301709 1591355427.48995: sending task result for task 0800271f-bb24-03f1-f9f4-000000000008\r\n2301709 1591355427.49061: done sending task result for task 0800271f-bb24-03f1-f9f4-000000000008\r\n2301709 1591355427.49080: WORKER PROCESS EXITING\r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n\r\n\r\n\r\nb2.sh variant\r\n2303801 1591355545.23609: _low_level_execute_command(): starting\r\n2303801 1591355545.23624: _low_level_execute_command(): using become for this command\r\n2303801 1591355545.23657: _low_level_execute_command(): executing: /bin/sh -c 'sudo -H -S  -p \"[sudo via ansible, key=jlimavkraemyaujfnezjzmowtrvinkmj] password: \" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-jlimavkraemyaujfnezjzmowtrvinkmj;  /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355545.2-39631499714735/b.sh'\"'\"' && sleep 0'\r\n2303801 1591355545.23675: in local.exec_command()\r\n<localhost> EXEC /bin/sh -c 'sudo -H -S  -p \"[sudo via ansible, key=jlimavkraemyaujfnezjzmowtrvinkmj] password: \" -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-jlimavkraemyaujfnezjzmowtrvinkmj;  /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355545.2-39631499714735/b.sh'\"'\"' && sleep 0'\r\n2303801 1591355545.23694: opening command with Popen()\r\n2303801 1591355545.24351: done running command with Popen()\r\n2303801 1591355545.30363: HOOKED events [(SelectorKey(fileobj=<open file '<fdopen>', mode 'rb' at 0x7f169c77b8a0>, fd=13, events=1, data=None), 1), (SelectorKey(fileobj=<open file '<fdopen>', mode 'rb' at 0x7f169c77be40>, fd=15, events=1, data=None), 1)]\r\n2303801 1591355545.30394: HOOKED stdout BECOME-SUCCESS-jlimavkraemyaujfnezjzmowtrvinkmj\r\n\r\n2303801 1591355545.30411: HOOKED stderr AAAAA\r\n\r\n2303801 1591355545.31598: HOOKED events [(SelectorKey(fileobj=<open file '<fdopen>', mode 'rb' at 0x7f169c77b8a0>, fd=13, events=1, data=None), 1), (SelectorKey(fileobj=<open file '<fdopen>', mode 'rb' at 0x7f169c77be40>, fd=15, events=1, data=None), 1)]\r\n2303801 1591355545.31615: HOOKED stdout\r\n2303801 1591355545.31630: HOOKED stderr\r\n2303801 1591355545.31669: _low_level_execute_command(): starting\r\n2303801 1591355545.31687: _low_level_execute_command(): executing: /bin/sh -c 'rm -f -r /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355545.2-39631499714735/ > /dev/null 2>&1 && sleep 0'\r\n2303801 1591355545.31707: in local.exec_command()\r\n<localhost> EXEC /bin/sh -c 'rm -f -r /tmp/.ansible-sysadmin/tmp/ansible-tmp-1591355545.2-39631499714735/ > /dev/null 2>&1 && sleep 0'\r\n2303801 1591355545.31727: opening command with Popen()\r\n2303801 1591355545.32264: done running command with Popen()\r\n2303801 1591355545.32312: getting output with communicate()\r\n2303801 1591355545.32771: done communicating\r\n2303801 1591355545.32794: done with local.exec_command()\r\n2303801 1591355545.32820: _low_level_execute_command() done: rc=0, stdout=, stderr=\r\n2303801 1591355545.32947: done running TaskExecutor() for localhost/TASK: TESTB [0800271f-bb24-51a8-0fb8-000000000008]\r\n2303801 1591355545.32983: sending task result for task 0800271f-bb24-51a8-0fb8-000000000008\r\n2303801 1591355545.33047: done sending task result for task 0800271f-bb24-51a8-0fb8-000000000008\r\n2303801 1591355545.33064: WORKER PROCESS EXITING\r\n2303789 1591355545.33494: marking localhost as failed\r\n2303789 1591355545.33530: marking host localhost failed, current state: HOST STATE: block=2, task=1, rescue=0, always=0, run_state=ITERATING_TASKS, fail_state=FAILED_NONE, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n2303789 1591355545.33554: ^ failed state is now: HOST STATE: block=2, task=1, rescue=0, always=0, run_state=ITERATING_COMPLETE, fail_state=FAILED_TASKS, pending_setup=False, tasks child state? (None), rescue child state? (None), always child state? (None), did rescue? False, did start at task? False\r\n2303789 1591355545.33575: getting the next task for host localhost\r\n2303789 1591355545.33590: host localhost is done iterating, returning\r\nfatal: [localhost]: FAILED! => {\r\n    \"msg\": \"privilege output closed while waiting for password prompt:\\nAAAAA\\n\"\r\n}\r\n```",
        "created_at": "2020-06-16T10:21:48Z",
        "user": "dan5252",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 70003,
        "title": "dnf module: undocumented return values diverging from other modules",
        "body": "##### SUMMARY\r\nCurrent implementation of `dnf` module diverges from the one of other similar packaging modules by failing to rely solely on the `msg` return value.\r\n\r\nModule also returns critical information inside [undocumented `failures: []` value](https://docs.ansible.com/ansible/latest/modules/dnf_module.html), something for which we were unable to identify any other module. \r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ndnf\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n2.10 - anu=y\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- dnf:\r\n    name: not-existing-package\r\n  register: result\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\nWe do expect to include all needed information inside standardizes keys, like `msg`, `stderr` and `stdout`.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```json\r\n{\r\n\"msg\": \"Failed to install some of the specified packages\",\r\n\"failures\": [\r\n    \"No package python-docker-py available.\"\r\n]\r\n}\r\n```\r\n\r\nEspecially because the the `failures` was always undocumented, changing the module to assure it includes the full list of errors inside `msg` should not be seen as a problem.\r\n\r\nExample below displays the diverging behavior between apt and dnf modules, which create weird results when used by `package`:\r\n\r\n```\r\nfatal: [ubuntu]: FAILED! => changed=false\r\n  msg: No package matching 'not-existing-foo' is available\r\n...ignoring\r\nfatal: [centos]: FAILED! => changed=false\r\n  failures:\r\n  - No package not-existing-foo available.\r\n  - No package not-existing-bar available.\r\n  msg: Failed to install some of the specified packages\r\n  rc: 1\r\n  results: []\r\n```\r\n\r\nIf `failures` is there by greater design, it should be documented and also mentioned in documentation for module developers, so others can make use of it.",
        "created_at": "2020-06-11T11:21:15Z",
        "user": "ssbarnea",
        "labels": [
            "module",
            "support:core",
            "bug",
            "docs",
            "P3",
            "packaging",
            "affects_2.11"
        ]
    },
    {
        "number": 69981,
        "title": "`ansible-test` gives precedence to roles/ over tests/integration/targets/",
        "body": "##### SUMMARY\r\nWhen running `ansible-test integration` inside collection where roles and integration roles names match, `ansible-test` will try to run role from `roles/*` directory and fail integration tests.\r\n\r\nWe are hitting this in zabbix community collection as there is name match with module `zabbix_proxy` and role `zabbix_proxy` (we had to rename roles from zabbix-XY to zabbix_XY). \r\n\r\nThis can be of course worked around by renaming integration roles.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nansible-test\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\ndevel\r\n```\r\n\r\n##### CONFIGURATION\r\n```paste below\r\ndefault\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate simple ansible project:\r\n```bash\r\ndev:~/ansible_collections/community/test $ ls\r\nroles  tests\r\n\r\ndev:~/ansible_collections/community/test $ cat roles/proxy/tasks/main.yml\r\n- name: task from roles/proxy/tasks/main.yml\r\n  debug:\r\n    msg: 'I am in role'\r\n\r\ndev:~/ansible_collections/community/test $ cat tests/integration/targets/proxy/tasks/main.yml\r\n- name: task from tests/integration/targets/proxy/tasks/main.yml\r\n  debug:\r\n    msg: 'I am in tests'\r\n```\r\nRun `ansible-test` test:\r\n```bash\r\nansible-test integration --color --diff\r\n```\r\n##### EXPECTED RESULTS\r\n```\r\nPLAY [testhost] ***************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************\r\nok: [testhost]\r\n\r\nTASK [community.test.proxy : task from tests/integration/targets/proxy/tasks/main.yml] ************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"I am in tests\"\r\n}\r\n\r\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************\r\ntesthost                   : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nRunning proxy integration test role\r\nPLAY [testhost] ***************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************\r\nok: [testhost]\r\n\r\nTASK [community.test.proxy : task from roles/proxy/tasks/main.yml] ************************************************************************************************************************************************************************************\r\nok: [testhost] => {\r\n    \"msg\": \"I am in role\"\r\n}\r\n\r\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************\r\ntesthost                   : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n\r\nSorry in advance if this is considered feature rather than bug. Just a side note, setting `ANSIBLE_ROLES_PATH` doesn't help with this.",
        "created_at": "2020-06-10T10:42:55Z",
        "user": "D3DeFi",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 69903,
        "title": "Using a variable list for tags parameter results in an unhashable type: 'list' exception",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nProviding a variable list to the tags parameter when executing role results in the following error message:\r\n```\r\nthe field 'tags' should be a list of ((<type 'basestring'>,), <type 'int'>), but the item '[u'camunda', u'spec']' is a <type 'list'>\r\n\r\n```\r\nI also have the error when using tags inside a role.\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nTags parameter\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible-playbook 2.8.12\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /bin/ansible-playbook\r\n  python version = 2.7.5 (default, Jun 11 2019, 14:33:56) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nNothing changed from defaults.\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nRed Hat Enterprise Linux Server release 7.5 (Maipo)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nCase 1:\r\n```yaml\r\n- hosts: localhost\r\n  vars:\r\n    foo: ['test1','test2']\r\n  pre_tasks:\r\n  - debug:\r\n      msg: \"It works!\" \r\n    tags: \"{{ foo }}\"\r\n  roles:\r\n   - { role: /path/to/role, tags: \"{{ foo }}\" } <-- It doesn't work!\r\n```\r\nCase 2:\r\n```yaml\r\n# playbook.yml\r\n- hosts: localhost\r\n  vars:\r\n    foo: ['test1','test2']\r\n  roles:\r\n   - custom_role \r\n```\r\n```\r\n# custom_role.yml\r\n\r\n- debug:\r\n    msg: \"It works!\"\r\n  tags: \"{{ foo }}\"\r\n\r\n- block:\r\n  - debug:\r\n      msg: \"It doesn't work!\"\r\n  tags: \"{{ foo }}\"\r\n\r\n```\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nExpect no error/exception.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nPLAY [localhost] ****************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************************************************************\r\ntask path: /path/to/playbookyaml:1\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root&& sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp `\"&& mkdir /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988 && echo ansible-tmp-1591344487.38-3637-236016727326988=\"` echo /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/setup.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-3624x3uVOu/tmpEbcyP4 TO /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988/AnsiballZ_setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988/ /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python2 /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988/AnsiballZ_setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1591344487.38-3637-236016727326988/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\n\r\nTASK [debug] ********************************************************************************************************************************************************************************\r\ntask path: /path/to/playbook.yaml:24\r\nok: [localhost] => {}\r\n\r\nMSG:\r\n\r\nIt works!\r\n\r\nMETA: ran handlers\r\n\r\nTASK [/path/to/role : debug] ******************************************************************************************************************************************************\r\ntask path: /path/to/role/tasks/main.yml:2\r\nok: [localhost] => {}\r\n\r\nMSG:\r\n\r\nIt works!\r\n\r\n\r\nTASK [/path/to/role : debug] ******************************************************************************************************************************************************\r\ntask path: /path/to/role/tasks/main.yml:7\r\nfatal: [localhost]: FAILED! => {}\r\n\r\nMSG:\r\n\r\nthe field 'tags' should be a list of ((<type 'basestring'>,), <type 'int'>), but the item '[u'camunda', u'spec']' is a <type 'list'>\r\n\r\nThe error appears to be in '/path/to/role/tasks/main.yml': line 7, column 5, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n- block:\r\n  - debug:\r\n    ^ here\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\n",
        "created_at": "2020-06-05T08:30:21Z",
        "user": "nkromano",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 69882,
        "title": "import_tasks within import_role not working",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nimport/include_tasks from within an import/include_role not working.\r\n\r\nLooks like: https://github.com/ansible/ansible/issues/27345\r\n\r\n\r\nTrying to import/include_role:\r\nhttps://github.com/oVirt/ovirt-ansible-hosted-engine-setup\r\n\r\nfails because the two import_tasks at the beginning\r\nhttps://github.com/oVirt/ovirt-ansible-hosted-engine-setup/blob/master/tasks/pre_checks/002_validate_hostname_tasks.yml\r\n\r\nDue to the import on\r\nhttps://github.com/oVirt/ovirt-ansible-hosted-engine-setup/blob/master/tasks/full_execution.yml\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nimport_role\r\ninclude_role\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.9.9\r\n  config file = /root/huertasv10/ansible/ansible.cfg\r\n  configured module search path = [u'/root/huertasv10/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Apr  9 2019, 14:30:50) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\nand\r\n```\r\nansible 2.8.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Apr  9 2019, 14:30:50) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nANSIBLE_PIPELINING(/root/huertasv10/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/root/huertasv10/ansible/ansible.cfg) = -C -o ControlMaster=auto -o ControlPersist=30m\r\nANSIBLE_SSH_CONTROL_PATH(/root/huertasv10/ansible/ansible.cfg) = %(directory)s/%%h-%%r\r\nANSIBLE_SSH_CONTROL_PATH_DIR(/root/huertasv10/ansible/ansible.cfg) = /root/cp\r\nDEFAULT_MODULE_PATH(/root/huertasv10/ansible/ansible.cfg) = [u'/root/huertasv10/ansible/plugins/modules']\r\nDEFAULT_MODULE_UTILS_PATH(/root/huertasv10/ansible/ansible.cfg) = [u'/root/huertasv10/ansible/plugins/module_utils']\r\nDEFAULT_ROLES_PATH(/root/huertasv10/ansible/ansible.cfg) = [u'/root/huertasv10/ansible/roles', u'/root/huertasv10/ansible/roles_\r\nHOST_KEY_CHECKING(/root/huertasv10/ansible/ansible.cfg) = False\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentOS Linux release 7.6.1810 (Core)\r\novirt-node-ng-installer-4.3.4-2019061016.el7\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- name: Deploy ovirt hosted engine over a physical host\r\n  include_role:\r\n    name: ovirt.hosted_engine_setup\r\n\r\n```\r\nor\r\n```\r\n- name: Deploy ovirt hosted engine over a physical host\r\n  import_role:\r\n    name: ovirt.hosted_engine_setup\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nimport/include_role should work as regular role invocation\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [ovirt.hosted_engine_setup : System configuration validations] ************************************************************\r\ntask path: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/full_execution.yml:7\r\nMETA: noop\r\nMETA: noop\r\nMETA: noop\r\nMETA: noop\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/files/pre_checks\"\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/pre_checks\"\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles/ovirt.he.iscsi.deploy/files/pre_checks\"\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles/ovirt.he.iscsi.deploy/pre_checks\"\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/files/pre_checks\"\r\nlooking for \"pre_checks\" at \"/root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks\"\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_network_test.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_memory_size.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/define_variables.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_data_center_name.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_gateway.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/001_validate_network_interfaces.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_mac_address.yml for fenix1\r\nincluded: /root/huertasv10/ansible/roles_lib/ovirt.hosted_engine_setup/tasks/pre_checks/validate_services_status.yml for fenix1\r\nERROR! Unexpected Exception, this is probably a bug: 'NoneType' object has no attribute 'rfind'\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-playbook\", line 110, in <module>\r\n    exit_code = cli.run()\r\n  File \"/usr/lib/python2.7/site-packages/ansible/cli/playbook.py\", line 123, in run\r\n    results = pbex.run()\r\n  File \"/usr/lib/python2.7/site-packages/ansible/executor/playbook_executor.py\", line 169, in run\r\n    result = self._tqm.run(play=play)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/executor/task_queue_manager.py\", line 249, in run\r\n    play_return = strategy.run(iterator, play_context)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/strategy/linear.py\", line 355, in run\r\n    new_blocks = self._load_included_file(included_file, iterator=iterator)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/strategy/__init__.py\", line 807, in _load_included_file\r\n    variable_manager=self._variable_manager,\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/helpers.py\", line 77, in load_list_of_blocks\r\n    loader=loader,\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/block.py\", line 95, in load\r\n    return b.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/base.py\", line 240, in load_data\r\n    self._attributes[target_name] = method(name, ds[name])\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/block.py\", line 131, in _load_block\r\n    use_handlers=self._use_handlers,\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/helpers.py\", line 193, in load_list_of_tasks\r\n    parent_include_dir = os.path.dirname(templar.template(parent_include.args.get('_raw_params')))\r\n  File \"/usr/lib64/python2.7/posixpath.py\", line 129, in dirname\r\n    i = p.rfind('/') + 1\r\nAttributeError: 'NoneType' object has no attribute 'rfind'\r\n```\r\n",
        "created_at": "2020-06-04T14:16:40Z",
        "user": "ffgomez",
        "labels": [
            "module",
            "support:core",
            "include_role",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "verified",
            "utilities",
            "affects_2.9"
        ]
    },
    {
        "number": 69813,
        "title": "Galaxy commands identify collection namespace.name incorrectly",
        "body": "##### SUMMARY\r\nThe `ansible-galaxy collection *` commands will recognize a collection `namespace.name` from its `galaxy.yml` or `galaxy.yaml` file.\r\n\r\nThis is a problem, because that's not how `ansible-playbook` recognizes a collection.\r\n\r\nThings conflict, and user has a bad day. Specific case: an installed collection has the `namespace.name` of a different collection. Now, it becomes impossible to install that other collection, even though it is not installed.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/galaxy/collection.py\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\n$ ansible --version\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under\r\ndevelopment. This is a rapidly changing source of code and can become unstable at any point.\r\nansible 2.10.0.dev0\r\n  config file = None\r\n  configured module search path = ['/Users/alancoding/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/alancoding/Documents/repos/ansible/lib/ansible\r\n  executable location = /Users/alancoding/.virtualenvs/awx_collection/bin/ansible\r\n  python version = 3.7.7 (default, Mar 10 2020, 15:43:03) [Clang 11.0.0 (clang-1100.0.33.17)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```paste below\r\n$ ansible-config dump --only-changed\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under\r\ndevelopment. This is a rapidly changing source of code and can become unstable at any point.\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nN/A, control machine, installing collections\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nrm -rf ~/.ansible/collections/ansible_collections/alancoding/\r\nrm -rf ~/.ansible/collections/ansible_collections/awx/\r\nansible-galaxy collection install awx.awx\r\nmkdir ~/.ansible/collections/ansible_collections/alancoding\r\nmv ~/.ansible/collections/ansible_collections/awx/awx ~/.ansible/collections/ansible_collections/alancoding/awx\r\n```\r\n\r\nTry to run a playbook\r\n\r\n```\r\nansible-playbook -i localhost, sanity/organization.yml\r\n```\r\n\r\nwhere that playbook is:\r\n\r\n```yaml\r\n---\r\n- name: Most basic example\r\n  hosts: localhost\r\n  connection: local\r\n  gather_facts: false\r\n  collections:\r\n    - awx.awx\r\n\r\n  tasks:\r\n  - tower_organization:\r\n      name: Default\r\n\r\n```\r\n\r\nReplace `awx.awx` with `alancoding.awx` and try to run it again.\r\n\r\nNow check the output of the list command\r\n\r\n```\r\nansible-galaxy collection list\r\n```\r\n\r\nTo illustrate the severity of this, try to install the _correct_ collection again\r\n\r\n```\r\nansible-galaxy collection install awx.awx\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nthat `ansible-galaxy` and `ansible-playbook` are consistent.\r\n\r\nIf one discovers `alancoding.awx`, then the other one should also.\r\n\r\n\r\n##### ACTUAL RESULTS\r\nPlaybooks run with `alancoding.awx` but the list command does not find that, and instead finds `awx.awx`.\r\n\r\nAdditionally, re-installing `awx.awx` fails, because it believes it is already installed (it's not).\r\n\r\n---\r\n\r\nAs another bonus to this issue, let's get things real messed up.\r\n\r\n```\r\nmkdir ~/.ansible/collections/ansible_collections/cmeyers\r\ncp -Ra ~/.ansible/collections/ansible_collections/alancoding/awx ~/.ansible/collections/ansible_collections/cmeyers/awx\r\n```\r\n\r\nwhat does that give us? Two `awx.awx` collections!\r\n\r\n```\r\n$ ansible-galaxy collection list\r\n[WARNING]: You are running the development version of Ansible. You should only run Ansible from \"devel\" if you are modifying the Ansible engine, or trying out features under\r\ndevelopment. This is a rapidly changing source of code and can become unstable at any point.\r\n[WARNING]: Collection at '/Users/alancoding/.ansible/collections/ansible_collections/testns/testcoll' does not have a galaxy.yml or a MANIFEST.json file, cannot detect version.\r\n[WARNING]: Collection at '/Users/alancoding/.ansible/collections/ansible_collections/chrismeyersfsu/hax0r' does not have a galaxy.yml or a MANIFEST.json file, cannot detect\r\nversion.\r\n\r\n# /Users/alancoding/.ansible/collections/ansible_collections\r\nCollection             Version    \r\n---------------------- -----------\r\namazon.aws             0.1.0      \r\nansible.posix          0.1.1      \r\nansible.tower          3.7.0      \r\nawx.awx                11.2.0     \r\nawx.awx                11.2.0     \r\nazure.azcollection     0.1.2      \r\nchrismeyersfsu.hax0r   *          \r\ncommunity.general      0.1.1      \r\ncommunity.vmware       0.1.0      \r\nf5networks.f5_modules  1.1.0      \r\ngoogle.cloud           0.0.9      \r\njunipernetworks.junos  0.0.2      \r\nmnecas.vm_infra        1.0.13     \r\nopenstack.cloud        0.0.1-dev85\r\novirt.ovirt            1.0.0      \r\novirt.ovirt_collection 1.0.1      \r\ntestns.testcoll        *          \r\ntheforeman.foreman     0.7.0      \r\ntirasa.syncope         1.0.2   \r\n```\r\n\r\n",
        "created_at": "2020-06-01T19:49:17Z",
        "user": "AlanCoding",
        "labels": [
            "support:core",
            "galaxy",
            "bug",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 69799,
        "title": "Modified \"vars:\" not visible inside include_role.",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\nIMHO. Not included in https://github.com/ansible/ansible/projects/19\r\n\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\ntested with ansible 2.9.6\r\n\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nA modification of a variable declared in \"vars\" is not visible inside the included role.\r\n```\r\n    - include_role:\r\n        name: test\r\n        tasks_from: task.yml\r\n      vars:\r\n        my_var: A\r\n```\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\ninclude_role\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.6\r\n  config file = /export/home/vlado.config/.ansible/ansible-examples/examples/example-136/ansible.cfg\r\n  configured module search path = ['/home/vlado/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.2 (default, Apr 27 2020, 15:53:34) [GCC 9.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_HOST_LIST(/export/home/vlado.config/.ansible/ansible-examples/examples/example-136/an$\r\nDEFAULT_ROLES_PATH(/export/home/vlado.config/.ansible/ansible-examples/examples/example-136/a$\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nLinux host9 5.4.0-31-generic #35-Ubuntu SMP Thu May 7 20:20:34 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\nFresh role with this task only\r\n```\r\nshell> cat roles/test/tasks/task.yml\r\n- debug:\r\n    var: my_var\r\n- set_fact:\r\n    my_var: B\r\n- debug:\r\n    var: my_var\r\n```\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- hosts: localhost\r\n  connection: local\r\n  tasks:\r\n    - include_role:\r\n        name: test\r\n        tasks_from: task.yml\r\n        apply:\r\n          vars:\r\n            my_var: A\r\n    - debug:\r\n        var: my_var\r\n\r\n# Variable must be declared by \"apply: vars\".\r\n#\r\n#    \"my_var\": \"A\"\r\n#    \"my_var\": \"B\"\r\n#    \"my_var\": \"B\"\r\n\r\n- hosts: localhost\r\n  connection: local\r\n  gather_facts: false\r\n  tasks:\r\n    - include_role:\r\n        name: test\r\n        tasks_from: task.yml\r\n      vars:\r\n        my_var: A\r\n    - debug:\r\n        var: my_var\r\n\r\n# New copy visible outside the role only will be created if the variable\r\n# is declared by \"vars:\".\r\n#\r\n#    \"my_var\": \"A\"\r\n#    \"my_var\": \"A\"\r\n#    \"my_var\": \"B\"\r\n```\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nFix the documentation\r\n\r\n```\r\n- name: Pass variables to role\r\n  include_role:\r\n    name: myrole\r\n    apply:\r\n      vars:\r\n        rolevar1: value from task\r\n```\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nQuoting from Examples\r\nhttps://docs.ansible.com/ansible/latest/modules/include_role_module.html#examples\r\n\r\n```\r\n- name: Pass variables to role\r\n  include_role:\r\n    name: myrole\r\n  vars:\r\n    rolevar1: value from task\r\n```\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2020-06-01T10:47:38Z",
        "user": "vbotka",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.9",
            "affects_2.16"
        ]
    },
    {
        "number": 69731,
        "title": "Loop variables with leading underscore appear in debug message",
        "body": "##### SUMMARY\r\n\r\nIf a loop variable uses a leading underscore it is printed in debug output, which is surprising behavior.\r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nDebug output in callback plugins.\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.5\r\n  config file = /home/jkupfere/test/ansible.cfg\r\n  configured module search path = ['/home/jkupfere/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/jkupfere/.local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.7 (default, Mar 13 2020, 10:23:39) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nExample playbook:\r\n\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n  - debug:\r\n      msg: \"{{ x }}\"\r\n    loop: ['a']\r\n    loop_control:\r\n      loop_var: x\r\n  - debug:\r\n      msg: \"{{ _x }}\"\r\n    loop: ['a']\r\n    loop_control:\r\n      loop_var: _x\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected that the variable name should not matter in output. In particular, common convention is that a leading underscore marks a variable as private, so it is extra surprising that it would be exposed in this case.\r\n\r\n```\r\nTASK [debug] *********************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=a) => {\r\n    \"msg\": \"a\"\r\n}\r\n\r\nTASK [debug] *********************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=a) => {\r\n    \"msg\": \"a\"\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\nActual result shows variable `_x`.\r\n\r\n```\r\nTASK [debug] *********************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=a) => {\r\n    \"msg\": \"a\"\r\n}\r\n\r\nTASK [debug] *********************************************************************************************************************************************************************************************************************************\r\nok: [localhost] => (item=a) => {\r\n    \"_x\": \"a\",\r\n    \"msg\": \"a\"\r\n}\r\n```\r\n\r\nThis appears to be because of code in the callback plugins:\r\n\r\nhttps://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/callback/__init__.py#L256-L265\r\n\r\n```\r\n                for key in list(result.keys()):\r\n                    if key not in _DEBUG_ALLOWED_KEYS and not key.startswith('_'):\r\n                        result.pop(key)\r\n```\r\n\r\nIt seems like this can simply be changed to:\r\n\r\n```\r\n                for key in list(result.keys()):\r\n                    if key not in _DEBUG_ALLOWED_KEYS:\r\n                        result.pop(key)\r\n```",
        "created_at": "2020-05-27T16:40:52Z",
        "user": "jkupferer",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 69638,
        "title": "Interface ipv4 facts not correctly typed on FreeBSD",
        "body": "##### SUMMARY\r\nAs of 2.9.7, ansible facts for FreeBSD appear to no longer collect or present correctly for interfaces. Instead of a type of `dict`, `ansible_facts['interface']['ipv4']` is now a `list`. On other operating systems, it is still a `dict`.\r\nThis breaks certain common simple usages, such `ansible_facts['em0']['ipv4']['address']` or `ansible_facts['em0']['ipv4']`\r\nPlease note that in the example code, the `interfaces` variable AND static values must be updated to match the host.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nfacts\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.7\r\n  config file = /REDACTED/ansible/ansible.cfg\r\n  configured module search path = ['/REDACTED/ansible/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.7 (default, Mar 20 2020, 11:33:03) [Clang 8.0.1 (tags/RELEASE_801/final 366581)]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_PIPELINING(/REDACTED/ansible/ansible.cfg) = True\r\nCACHE_PLUGIN(/REDACTED/ansible/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/REDACTED/ansible/ansible.cfg) = ~/.ansible/cache\r\nDEFAULT_BECOME(/REDACTED/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_ASK_PASS(/REDACTED/ansible/ansible.cfg) = False\r\nDEFAULT_BECOME_METHOD(/REDACTED/ansible/ansible.cfg) = sudo\r\nDEFAULT_BECOME_USER(/REDACTED/ansible/ansible.cfg) = root\r\nDEFAULT_CALLBACK_WHITELIST(/REDACTED/ansible/ansible.cfg) = ['timer', 'mail']\r\nDEFAULT_FORKS(/REDACTED/ansible/ansible.cfg) = 5\r\nDEFAULT_GATHERING(/REDACTED/ansible/ansible.cfg) = implicit\r\nDEFAULT_GATHER_SUBSET(/REDACTED/ansible/ansible.cfg) = ['all']\r\nDEFAULT_GATHER_TIMEOUT(/REDACTED/ansible/ansible.cfg) = 10\r\nDEFAULT_HOST_LIST(/REDACTED/ansible/ansible.cfg) = ['/REDACTED/ansible/hosts']\r\nDEFAULT_JINJA2_NATIVE(/REDACTED/ansible/ansible.cfg) = True\r\nDEFAULT_LOCAL_TMP(/REDACTED/ansible/ansible.cfg) = /REDACTED/.ansible/tmp/ansible-local-22576vs5wa>\r\nDEFAULT_LOG_PATH(/REDACTED/ansible/ansible.cfg) = /REDACTED/ansible.log\r\nDEFAULT_MANAGED_STR(/REDACTED/ansible/ansible.cfg) = Ansible: modified on %Y-%m-%d %H:%M:%S by {ui>\r\nDEFAULT_MODULE_PATH(/REDACTED/ansible/ansible.cfg) = ['/REDACTED/ansible/modules']\r\nDEFAULT_MODULE_UTILS_PATH(/REDACTED/ansible/ansible.cfg) = ['/REDACTED/ansible/module_utils']\r\nDEFAULT_POLL_INTERVAL(/REDACTED/ansible/ansible.cfg) = 15\r\nDEFAULT_ROLES_PATH(/REDACTED/ansible/ansible.cfg) = ['/REDACTED/ansible/roles']\r\nDEFAULT_SCP_IF_SSH(/REDACTED/ansible/ansible.cfg) = smart\r\nDEFAULT_SSH_TRANSFER_METHOD(/REDACTED/ansible/ansible.cfg) = smart\r\nDEFAULT_TRANSPORT(/REDACTED/ansible/ansible.cfg) = smart\r\nDIFF_ALWAYS(/REDACTED/ansible/ansible.cfg) = False\r\nDIFF_CONTEXT(/REDACTED/ansible/ansible.cfg) = 5\r\nINJECT_FACTS_AS_VARS(/REDACTED/ansible/ansible.cfg) = True\r\nINVENTORY_ENABLED(/REDACTED/ansible/ansible.cfg) = ['auto', 'ini', 'host_list', 'yaml', 'vmware_vm>\r\nINVENTORY_IGNORE_EXTS(/REDACTED/ansible/ansible.cfg) = ['.pyc', '.pyo', '.swp', '.bak', '~', '.rpm>\r\nPARAMIKO_HOST_KEY_AUTO_ADD(/REDACTED/ansible/ansible.cfg) = True\r\nPERSISTENT_COMMAND_TIMEOUT(/REDACTED/ansible/ansible.cfg) = 10\r\nPERSISTENT_CONNECT_RETRY_TIMEOUT(/REDACTED/ansible/ansible.cfg) = 15\r\nPERSISTENT_CONNECT_TIMEOUT(/REDACTED/ansible/ansible.cfg) = 30\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nFailure case observed on FreeBSD 12.1-RELEASE, 12-STABLE, 11.3-RELEASE. Counter-tested on Alpine Linux 3.11.6.\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\n---\r\n- hosts: \"{{ target|default('localhost') }}\"\r\n  vars:\r\n    interfaces: vmx0\r\n  tasks:\r\n  - name: Test interface.ipv4 with variable\r\n    debug:\r\n      msg: \"{{ ansible_facts[interfaces]['ipv4'] }}\"\r\n  - name: Test interface.ipv4 with absolute\r\n    debug:\r\n      msg: \"{{ ansible_facts['vmx0']['ipv4'] }}\"\r\n  - name: Test interface.ipv4 with variable (type)\r\n    debug:\r\n      msg: \"{{ ansible_facts[interfaces]['ipv4'] | type_debug }}\"\r\n  - name: Test interface.ipv4 with absolute (type)\r\n    debug:\r\n      msg: \"{{ ansible_facts['vmx0']['ipv4'] | type_debug }}\"\r\n\r\n  ## XXX: This will fail on FreeBSD due to ansible_facts[interface]['ipv4'] being a list\r\n  - name: Test interface.ipv4.address with absolute\r\n    debug:\r\n      msg: \"{{ ansible_facts['vmx0']['ipv4']['address'] }}\"\r\n  - name: Test interface.ipv4.address with variable\r\n    debug:\r\n      msg: \"{{ ansible_facts[interfaces]['ipv4']['address'] }}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nExpected results (validated on Alpine Linux 3.11.6):\r\n```\r\nTASK [Test interface.ipv4 with variable (type)] ***************************************************\r\nok: [ALPINE.REDACTED] => {\r\n    \"msg\": \"dict\"\r\n}\r\n\r\nTASK [Test interface.ipv4 with absolute (type)] ***************************************************\r\nok: [ALPINE.REDACTED] => {\r\n    \"msg\": \"dict\"\r\n}\r\n\r\nTASK [Test interface.ipv4.address with absolute] **************************************************\r\nok: [ALPINE.REDACTED] => {\r\n    \"msg\": \"192.168.1.232\"\r\n}\r\n\r\nTASK [Test interface.ipv4.address with variable] **************************************************\r\nok: [ALPINE.REDACTED] => {\r\n    \"msg\": \"192.168.1.232\"\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nansible-playbook 2.9.7\r\n  config file = /REDACTED/ansible/ansible.cfg\r\n  configured module search path = ['/REDACTED/ansible/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 3.7.7 (default, Mar 20 2020, 11:33:03) [Clang 8.0.1 (tags/RELEASE_801/final 366581)]\r\nUsing /REDACTED/ansible/ansible.cfg as config file\r\nauto declined parsing /REDACTED/ansible/hosts as it did not pass its verify_file() method\r\nParsed /REDACTED/ansible/hosts inventory source with ini plugin\r\n\r\nPLAYBOOK: vartest.yml *****************************************************************************\r\n1 plays in vartest.yml\r\n\r\nPLAY [localhost] **********************************************************************************\r\n\r\nTASK [Gathering Facts] ****************************************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:2\r\nUsing module file /usr/local/lib/python3.7/site-packages/ansible/modules/system/setup.py\r\nPipelining is enabled.\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: REDACTED\r\n<127.0.0.1> EXEC /bin/sh -c 'sudo -H -S -n  -u root /bin/sh -c '\"'\"'echo BECOME-SUCCESS-mjbwhcfhhzsomgawqzssxueocwvwccda ; /usr/local/bin/python3.7'\"'\"' && sleep 0'\r\nok: [localhost]\r\nMETA: ran handlers\r\n\r\nTASK [Test interface.ipv4 with variable] **********************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:6\r\nok: [localhost] => {\r\n    \"msg\": [\r\n        {\r\n            \"address\": \"192.168.1.220\",\r\n            \"broadcast\": \"192.168.1.255\",\r\n            \"netmask\": \"255.255.255.0\",\r\n            \"network\": \"192.168.1.0\"\r\n        }\r\n    ]\r\n}\r\n\r\nTASK [Test interface.ipv4 with absolute] **********************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:9\r\nok: [localhost] => {\r\n    \"msg\": [\r\n        {\r\n            \"address\": \"192.168.1.220\",\r\n            \"broadcast\": \"192.168.1.255\",\r\n            \"netmask\": \"255.255.255.0\",\r\n            \"network\": \"192.168.1.0\"\r\n        }\r\n    ]\r\n}\r\n\r\nTASK [Test interface.ipv4 with variable (type)] ***************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:12\r\nok: [localhost] => {\r\n    \"msg\": \"list\"\r\n}\r\n\r\nTASK [Test interface.ipv4 with absolute (type)] ***************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:15\r\nok: [localhost] => {\r\n    \"msg\": \"list\"\r\n}\r\n\r\nTASK [Test interface.ipv4.address with absolute] **************************************************\r\ntask path: /REDACTED/ansible/vartest.yml:20\r\nfatal: [localhost]: FAILED! => {\r\n    \"msg\": \"The task includes an option with an undefined variable. The error was: 'list object' has no attribute 'address'\\n\\nThe error appears to be in '/REDACTED/ansible/vartest.yml': line 20, column 5, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n  ## XXX: This SHOULD NOT fail (have existing working templates)\\n  - name: Test interface.ipv4.address with absolute\\n    ^ here\\n\"\r\n}\r\n[WARNING]: Failure using method (v2_runner_on_failed) in callback plugin\r\n(<ansible.plugins.callback.mail.CallbackModule object at 0x8039bab50>): [Errno 61] Connection\r\nrefused\r\nCallback Exception:\r\n  File \"/usr/local/lib/python3.7/site-packages/ansible/executor/task_queue_manager.py\", line 324, in send_callback\r\n    method(*new_args, **kwargs)\r\n   File \"/usr/local/lib/python3.7/site-packages/ansible/plugins/callback/mail.py\", line 223, in v2_runner_on_failed\r\n    self.mail_result(result, 'Failed')\r\n   File \"/usr/local/lib/python3.7/site-packages/ansible/plugins/callback/mail.py\", line 213, in mail_result\r\n    self.mail(subject=subject, body=body)\r\n   File \"/usr/local/lib/python3.7/site-packages/ansible/plugins/callback/mail.py\", line 108, in mail\r\n    smtp = smtplib.SMTP(self.smtphost, port=self.smtpport)\r\n   File \"/usr/local/lib/python3.7/smtplib.py\", line 251, in __init__\r\n    (code, msg) = self.connect(host, port)\r\n   File \"/usr/local/lib/python3.7/smtplib.py\", line 336, in connect\r\n    self.sock = self._get_socket(host, port, self.timeout)\r\n   File \"/usr/local/lib/python3.7/smtplib.py\", line 307, in _get_socket\r\n    self.source_address)\r\n   File \"/usr/local/lib/python3.7/socket.py\", line 728, in create_connection\r\n    raise err\r\n   File \"/usr/local/lib/python3.7/socket.py\", line 716, in create_connection\r\n    sock.connect(sa)\r\n\r\nPLAY RECAP ****************************************************************************************\r\nlocalhost                  : ok=5    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n\r\nPlaybook run took 0 days, 0 hours, 0 minutes, 0 seconds\r\n```",
        "created_at": "2020-05-20T23:14:01Z",
        "user": "rootwyrm",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "needs_verified",
            "affects_2.9",
            "on_hold"
        ]
    },
    {
        "number": 69544,
        "title": "Variables are not delegated in sub-task loop",
        "body": "##### SUMMARY\r\n\r\nWhen running a delegated subtask then variables are not delegated to host.\r\n\r\nOnly the last item of loop is delegated. The delegating host gets the variable value.\r\nIf I set `delegate_facts: no` then results are populated to delegating host (as expected).\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nansible-playbook\r\n\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\n[domscheit@p-ansbl-as-01 case]$ ansible-playbook --version\r\nansible-playbook 2.9.5\r\n  config file = /home/domscheit/case/ansible.cfg\r\n  configured module search path = [u'/home/domscheit/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Sep 26 2019, 13:23:47) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\n[domscheit@p-ansbl-as-01 case]$ ansible-config dump --only-changed\r\nCOLOR_DIFF_REMOVE(/home/domscheit/case/ansible.cfg) = bright purple\r\nCOLOR_ERROR(/home/domscheit/case/ansible.cfg) = bright red\r\nCOLOR_UNREACHABLE(/home/domscheit/case/ansible.cfg) = bright red\r\nCOLOR_VERBOSE(/home/domscheit/case/ansible.cfg) = cyan\r\nDEFAULT_HOST_LIST(/home/domscheit/case/ansible.cfg) = [u'/home/domscheit/case/inventory']\r\nHOST_KEY_CHECKING(/home/domscheit/case/ansible.cfg) = False\r\nINVENTORY_ENABLED(/home/domscheit/case/ansible.cfg) = [u'yaml', u'ini']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n\r\n```\r\n[domscheit@p-ansbl-as-01 case]$ hostnamectl\r\n   Static hostname: p-ansbl-as-01\r\n         Icon name: computer-vm\r\n           Chassis: vm\r\n        Machine ID: 1f825306d5ee467d9aa34bea35751abc\r\n           Boot ID: 5cb9042c6b3f4f539f9e1ad4c2840189\r\n    Virtualization: vmware\r\n  Operating System: Red Hat Enterprise Linux\r\n       CPE OS Name: cpe:/o:redhat:enterprise_linux:7.8:GA:server\r\n            Kernel: Linux 3.10.0-1127.8.2.el7.x86_64\r\n      Architecture: x86-64\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe main playbook:\r\n\r\n```\r\n---\r\n- hosts: all\r\n  vars:\r\n    results: {}\r\n  tasks:\r\n  - include_tasks: \"subtask.yml\"\r\n    vars:\r\n      par: \"{{ item }}\"\r\n    loop:\r\n      - \"a\"\r\n      - \"b\"\r\n      - \"c\"\r\n    when: \"'d-mipmdb-cfg-01' == inventory_hostname_short\"\r\n    \r\n  - include_tasks: \"subtask-delegate.yml\"\r\n    vars:\r\n      par: \"{{ item }}\"\r\n    loop:\r\n      - \"x\"\r\n      - \"y\"\r\n      - \"z\"\r\n    when: \"'d-mipmdb-cfg-01' == inventory_hostname_short\"\r\n\r\n  - debug:\r\n      var: results\r\n...  \r\n```\r\nAnd these subtasks files:\r\n```\r\n---\r\n# subtask.yml\r\n- shell:\r\n    cmd: \"echo {{ par }}\"\r\n  register: ret\r\n- set_fact:\r\n    results: \"{{ results | combine({par: ret.rc}) }}\"\r\n...  \r\n\r\n---\r\n# subtask-delegate.yml\r\n- shell:\r\n    cmd: \"echo {{ par }}\"\r\n  register: ret\r\n  delegate_to: d-mipmdb-arb-01\r\n  delegate_facts: yes\r\n- set_fact:\r\n    results: \"{{ results | combine({par: ret.rc}) }}\"\r\n  delegate_to: d-mipmdb-arb-01\r\n  delegate_facts: yes\r\n...  \r\n```\r\n##### EXPECTED RESULTS\r\n\r\n```\r\nTASK [debug] **********************************************\r\nok: [d-mipmdb-cfg-01] => {\r\n    \"results\": {\r\n        \"a\": 0, \r\n        \"b\": 0, \r\n        \"c\": 0\r\n    }\r\n}\r\nok: [d-mipmdb-arb-01] => {\r\n    \"results\": {\r\n        \"x\": 0\r\n        \"y\": 0\r\n        \"z\": 0\r\n    }\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nTASK [debug] **********************************************\r\nok: [d-mipmdb-cfg-01] => {\r\n    \"results\": {\r\n        \"a\": 0, \r\n        \"b\": 0, \r\n        \"c\": 0\r\n    }\r\n}\r\nok: [d-mipmdb-arb-01] => {\r\n    \"results\": {\r\n        \"a\": 0, \r\n        \"b\": 0, \r\n        \"c\": 0, \r\n        \"z\": 0\r\n    }\r\n}\r\n\r\n```\r\n",
        "created_at": "2020-05-15T18:12:23Z",
        "user": "Wernfried",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 69519,
        "title": "AnsibleFileNotFound suggests module options that are not valid",
        "body": "##### SUMMARY\r\nAnsibleFileNotFound error is invoked and suggests the `remote_src` option, which is not valid for some modules that produce this error.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/errors/__init__.py\r\nlib/ansible/modules/files/template.py\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.7\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/notting/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.2 (default, Feb 28 2020, 00:00:00) [GCC 10.0.1 20200216 (Red Hat 10.0.1-0.8)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /tmp/ansible.log\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nLinux, but shouldn't matter\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n  tasks:\r\n  - name: template a remote file\r\n    template:\r\n      src: /some/file/on/remote\r\n      dest: /some/other/file/on/remote\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nan error that applies\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nfatal: [somehost]: FAILED! => {\"changed\": false, \"msg\": \"Could not find or access '/some/file/on/remote' on the Ansible Controller.\\nIf you are using a module and expect the file to exist on the remote, see the remote_src option\"}\r\n```\r\n\r\n`remote_src` is not a valid option for template.",
        "created_at": "2020-05-14T18:49:37Z",
        "user": "wenottingham",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "files",
            "collection",
            "affects_2.9",
            "affects_2.10"
        ]
    },
    {
        "number": 69383,
        "title": "fetch results in checksum mismatch",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nFetch results in checksum mismatch. Become must be used to acquire it from the location due to permissions.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nfetch\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\n2.9.7\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nACTION_WARNINGS(default) = True\r\nAGNOSTIC_BECOME_PROMPT(default) = True\r\nALLOW_WORLD_READABLE_TMPFILES(default) = False\r\nANSIBLE_CONNECTION_PATH(default) = None\r\nANSIBLE_COW_PATH(default) = None\r\nANSIBLE_COW_SELECTION(default) = default\r\nANSIBLE_COW_WHITELIST(default) = ['bud-frogs', 'bunny', 'cheese', 'daemon', 'default', 'dragon', 'elephant-in-snake', 'elephant', 'eyes', 'hellokitty', 'kitty', 'luke-koala', 'meow', 'milk', 'moofasa', 'moose', \r\nANSIBLE_FORCE_COLOR(default) = False\r\nANSIBLE_NOCOLOR(default) = False\r\nANSIBLE_NOCOWS(default) = False\r\nANSIBLE_PIPELINING(/deployuser/ansible.cfg) = False\r\nANSIBLE_SSH_ARGS(default) = -C -o ControlMaster=auto -o ControlPersist=60s\r\nANSIBLE_SSH_CONTROL_PATH(default) = None\r\nANSIBLE_SSH_CONTROL_PATH_DIR(default) = ~/.ansible/cp\r\nANSIBLE_SSH_EXECUTABLE(default) = ssh\r\nANSIBLE_SSH_RETRIES(/deployuser/ansible.cfg) = 10\r\nANY_ERRORS_FATAL(default) = False\r\nBECOME_ALLOW_SAME_USER(default) = False\r\nBECOME_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/become', u'/usr/share/ansible/plugins/become']\r\nCACHE_PLUGIN(default) = memory\r\nCACHE_PLUGIN_CONNECTION(default) = None\r\nCACHE_PLUGIN_PREFIX(default) = ansible_facts\r\nCACHE_PLUGIN_TIMEOUT(default) = 86400\r\nCOLLECTIONS_PATHS(default) = [u'/home/deployuser/.ansible/collections', u'/usr/share/ansible/collections']\r\nCOLOR_CHANGED(default) = yellow\r\nCOLOR_CONSOLE_PROMPT(default) = white\r\nCOLOR_DEBUG(default) = dark gray\r\nCOLOR_DEPRECATE(default) = purple\r\nCOLOR_DIFF_ADD(default) = green\r\nCOLOR_DIFF_LINES(default) = cyan\r\nCOLOR_DIFF_REMOVE(default) = red\r\nCOLOR_ERROR(default) = red\r\nCOLOR_HIGHLIGHT(default) = white\r\nCOLOR_OK(default) = green\r\nCOLOR_SKIP(default) = cyan\r\nCOLOR_UNREACHABLE(default) = bright red\r\nCOLOR_VERBOSE(default) = blue\r\nCOLOR_WARN(default) = bright purple\r\nCOMMAND_WARNINGS(default) = True\r\nCONDITIONAL_BARE_VARS(default) = True\r\nCONNECTION_FACTS_MODULES(default) = {'junos': 'junos_facts', 'eos': 'eos_facts', 'frr': 'frr_facts', 'iosxr': 'iosxr_facts', 'nxos': 'nxos_facts', 'ios': 'ios_facts', 'vyos': 'vyos_facts'}\r\nCOVERAGE_REMOTE_OUTPUT(default) = None\r\nCOVERAGE_REMOTE_WHITELIST(default) = *\r\nDEFAULT_ACTION_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/action', u'/usr/share/ansible/plugins/action']\r\nDEFAULT_ALLOW_UNSAFE_LOOKUPS(default) = False\r\nDEFAULT_ASK_PASS(default) = False\r\nDEFAULT_ASK_VAULT_PASS(default) = False\r\nDEFAULT_BECOME(default) = False\r\nDEFAULT_BECOME_ASK_PASS(default) = False\r\nDEFAULT_BECOME_EXE(default) = None\r\nDEFAULT_BECOME_FLAGS(default) = \r\nDEFAULT_BECOME_METHOD(default) = sudo\r\nDEFAULT_BECOME_USER(default) = root\r\nDEFAULT_CACHE_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/cache', u'/usr/share/ansible/plugins/cache']\r\nDEFAULT_CALLABLE_WHITELIST(default) = []\r\nDEFAULT_CALLBACK_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/callback', u'/usr/share/ansible/plugins/callback']\r\nDEFAULT_CALLBACK_WHITELIST(/deployuser/ansible.cfg) = [u'profile_tasks']\r\nDEFAULT_CLICONF_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/cliconf', u'/usr/share/ansible/plugins/cliconf']\r\nDEFAULT_CONNECTION_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/connection', u'/usr/share/ansible/plugins/connection']\r\nDEFAULT_DEBUG(default) = False\r\nDEFAULT_EXECUTABLE(default) = /bin/sh\r\nDEFAULT_FACT_PATH(default) = None\r\nDEFAULT_FILTER_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/filter', u'/usr/share/ansible/plugins/filter']\r\nDEFAULT_FORCE_HANDLERS(default) = False\r\nDEFAULT_FORKS(default) = 5\r\nDEFAULT_GATHERING(default) = implicit\r\nDEFAULT_GATHER_SUBSET(/deployuser/ansible.cfg) = [u'!hardware # this line may help deal with an issue where a bad nfs mount will prevent ansible from connecting to the host.']\r\nDEFAULT_GATHER_TIMEOUT(default) = 10\r\nDEFAULT_HANDLER_INCLUDES_STATIC(default) = False\r\nDEFAULT_HASH_BEHAVIOUR(default) = replace\r\nDEFAULT_HOST_LIST(env: ANSIBLE_INVENTORY) = [u'/vagrant/ansible/hosts']\r\nDEFAULT_HTTPAPI_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/httpapi', u'/usr/share/ansible/plugins/httpapi']\r\nDEFAULT_INTERNAL_POLL_INTERVAL(default) = 0.001\r\nDEFAULT_INVENTORY_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/inventory', u'/usr/share/ansible/plugins/inventory']\r\nDEFAULT_JINJA2_EXTENSIONS(default) = []\r\nDEFAULT_JINJA2_NATIVE(default) = False\r\nDEFAULT_KEEP_REMOTE_FILES(default) = False\r\nDEFAULT_LIBVIRT_LXC_NOSECLABEL(default) = False\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/deployuser/ansible.cfg) = True\r\nDEFAULT_LOCAL_TMP(default) = /home/deployuser/.ansible/tmp/ansible-local-285749tfiB1\r\nDEFAULT_LOG_FILTER(default) = []\r\nDEFAULT_LOG_PATH(/deployuser/ansible.cfg) = /deployuser/tmp/ansible_log\r\nDEFAULT_LOOKUP_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/lookup', u'/usr/share/ansible/plugins/lookup']\r\nDEFAULT_MANAGED_STR(default) = Ansible managed\r\nDEFAULT_MODULE_ARGS(default) = \r\nDEFAULT_MODULE_COMPRESSION(default) = ZIP_DEFLATED\r\nDEFAULT_MODULE_NAME(default) = command\r\nDEFAULT_MODULE_PATH(default) = [u'/home/deployuser/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\nDEFAULT_MODULE_UTILS_PATH(default) = [u'/home/deployuser/.ansible/plugins/module_utils', u'/usr/share/ansible/plugins/module_utils']\r\nDEFAULT_NETCONF_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/netconf', u'/usr/share/ansible/plugins/netconf']\r\nDEFAULT_NO_LOG(default) = False\r\nDEFAULT_NO_TARGET_SYSLOG(default) = False\r\nDEFAULT_NULL_REPRESENTATION(default) = None\r\nDEFAULT_POLL_INTERVAL(default) = 15\r\nDEFAULT_PRIVATE_KEY_FILE(default) = None\r\nDEFAULT_PRIVATE_ROLE_VARS(default) = False\r\nDEFAULT_REMOTE_PORT(default) = None\r\nDEFAULT_REMOTE_USER(default) = None\r\nDEFAULT_ROLES_PATH(default) = [u'/home/deployuser/.ansible/roles', u'/usr/share/ansible/roles', u'/etc/ansible/roles']\r\nDEFAULT_SCP_IF_SSH(default) = smart\r\nDEFAULT_SELINUX_SPECIAL_FS(default) = ['fuse', 'nfs', 'vboxsf', 'ramfs', '9p', 'vfat']\r\nDEFAULT_SFTP_BATCH_MODE(default) = True\r\nDEFAULT_SQUASH_ACTIONS(default) = ['apk', 'apt', 'dnf', 'homebrew', 'openbsd_pkg', 'pacman', 'pip', 'pkgng', 'yum', 'zypper']\r\nDEFAULT_SSH_TRANSFER_METHOD(default) = None\r\nDEFAULT_STDOUT_CALLBACK(env: ANSIBLE_STDOUT_CALLBACK) = debug\r\nDEFAULT_STRATEGY(/deployuser/ansible.cfg) = mitogen_linear\r\nDEFAULT_STRATEGY_PLUGIN_PATH(/deployuser/ansible.cfg) = [u'/deployuser/ansible/plugins/mitogen-0.2.9/ansible_mitogen/plugins/strategy']\r\nDEFAULT_SU(default) = False\r\nDEFAULT_SYSLOG_FACILITY(default) = LOG_USER\r\nDEFAULT_TASK_INCLUDES_STATIC(default) = False\r\nDEFAULT_TERMINAL_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/terminal', u'/usr/share/ansible/plugins/terminal']\r\nDEFAULT_TEST_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/test', u'/usr/share/ansible/plugins/test']\r\nDEFAULT_TIMEOUT(default) = 10\r\nDEFAULT_TRANSPORT(default) = smart\r\nDEFAULT_UNDEFINED_VAR_BEHAVIOR(default) = True\r\nDEFAULT_VARS_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/vars', u'/usr/share/ansible/plugins/vars']\r\nDEFAULT_VAULT_ENCRYPT_IDENTITY(default) = None\r\nDEFAULT_VAULT_IDENTITY(default) = default\r\nDEFAULT_VAULT_IDENTITY_LIST(default) = []\r\nDEFAULT_VAULT_ID_MATCH(default) = False\r\nDEFAULT_VAULT_PASSWORD_FILE(default) = None\r\nDEFAULT_VERBOSITY(default) = 0\r\nDEPRECATION_WARNINGS(default) = True\r\nDIFF_ALWAYS(default) = False\r\nDIFF_CONTEXT(default) = 3\r\nDISPLAY_ARGS_TO_STDOUT(default) = False\r\nDISPLAY_SKIPPED_HOSTS(default) = True\r\nDOCSITE_ROOT_URL(default) = https://docs.ansible.com/ansible/\r\nDOC_FRAGMENT_PLUGIN_PATH(default) = [u'/home/deployuser/.ansible/plugins/doc_fragments', u'/usr/share/ansible/plugins/doc_fragments']\r\nDUPLICATE_YAML_DICT_KEY(default) = warn\r\nENABLE_TASK_DEBUGGER(default) = False\r\nERROR_ON_MISSING_HANDLER(default) = True\r\nFACTS_MODULES(default) = ['smart']\r\nGALAXY_IGNORE_CERTS(default) = False\r\nGALAXY_ROLE_SKELETON(default) = None\r\nGALAXY_ROLE_SKELETON_IGNORE(default) = ['^.git$', '^.*/.git_keep$']\r\nGALAXY_SERVER(default) = https://galaxy.ansible.com\r\nGALAXY_SERVER_LIST(default) = None\r\nGALAXY_TOKEN(default) = None\r\nGALAXY_TOKEN_PATH(default) = /home/deployuser/.ansible/galaxy_token\r\nHOST_KEY_CHECKING(default) = True\r\nHOST_PATTERN_MISMATCH(default) = warning\r\nINJECT_FACTS_AS_VARS(default) = True\r\nINTERPRETER_PYTHON(default) = auto_legacy\r\nINTERPRETER_PYTHON_DISTRO_MAP(default) = {'centos': {'8': '/usr/libexec/platform-python', '6': '/usr/bin/python'}, 'rhel': {'8': '/usr/libexec/platform-python', '6': '/usr/bin/python'}, 'fedora': {'23': '/usr/bi\r\nINTERPRETER_PYTHON_FALLBACK(default) = ['/usr/bin/python', 'python3.7', 'python3.6', 'python3.5', 'python2.7', 'python2.6', '/usr/libexec/platform-python', '/usr/bin/python3', 'python']\r\nINVALID_TASK_ATTRIBUTE_FAILED(default) = True\r\nINVENTORY_ANY_UNPARSED_IS_FAILED(default) = False\r\nINVENTORY_CACHE_ENABLED(default) = False\r\nINVENTORY_CACHE_PLUGIN(default) = None\r\nINVENTORY_CACHE_PLUGIN_CONNECTION(default) = None\r\nINVENTORY_CACHE_PLUGIN_PREFIX(default) = ansible_facts\r\nINVENTORY_CACHE_TIMEOUT(default) = 3600\r\nINVENTORY_ENABLED(default) = ['host_list', 'script', 'auto', 'yaml', 'ini', 'toml']\r\nINVENTORY_EXPORT(default) = False\r\nINVENTORY_IGNORE_EXTS(default) = {{(BLACKLIST_EXTS + ( '.orig', '.ini', '.cfg', '.retry'))}}\r\nINVENTORY_IGNORE_PATTERNS(default) = []\r\nINVENTORY_UNPARSED_IS_FAILED(default) = False\r\nLOCALHOST_WARNING(default) = True\r\nMAX_FILE_SIZE_FOR_DIFF(default) = 104448\r\nNETCONF_SSH_CONFIG(default) = None\r\nNETWORK_GROUP_MODULES(default) = ['eos', 'nxos', 'ios', 'iosxr', 'junos', 'enos', 'ce', 'vyos', 'sros', 'dellos9', 'dellos10', 'dellos6', 'asa', 'aruba', 'aireos', 'bigip', 'ironware', 'onyx', 'netconf']\r\nOLD_PLUGIN_CACHE_CLEARING(default) = False\r\nPARAMIKO_HOST_KEY_AUTO_ADD(default) = False\r\nPARAMIKO_LOOK_FOR_KEYS(default) = True\r\nPERSISTENT_COMMAND_TIMEOUT(default) = 30\r\nPERSISTENT_CONNECT_RETRY_TIMEOUT(default) = 15\r\nPERSISTENT_CONNECT_TIMEOUT(default) = 30\r\nPERSISTENT_CONTROL_PATH_DIR(default) = /home/deployuser/.ansible/pc\r\nPLAYBOOK_DIR(default) = None\r\nPLAYBOOK_VARS_ROOT(default) = top\r\nPLUGIN_FILTERS_CFG(default) = None\r\nPYTHON_MODULE_RLIMIT_NOFILE(default) = 0\r\nRETRY_FILES_ENABLED(default) = False\r\nRETRY_FILES_SAVE_PATH(default) = None\r\nSHOW_CUSTOM_STATS(default) = False\r\nSTRING_CONVERSION_ACTION(default) = warn\r\nSTRING_TYPE_FILTERS(default) = ['string', 'to_json', 'to_nice_json', 'to_yaml', 'ppretty', 'json']\r\nSYSTEM_WARNINGS(default) = True\r\nTAGS_RUN(default) = []\r\nTAGS_SKIP(default) = []\r\nTASK_DEBUGGER_IGNORE_ERRORS(default) = True\r\nTRANSFORM_INVALID_GROUP_CHARS(default) = never\r\nUSE_PERSISTENT_CONNECTIONS(default) = False\r\nVARIABLE_PRECEDENCE(default) = ['all_inventory', 'groups_inventory', 'all_plugins_inventory', 'all_plugins_play', 'groups_plugins_inventory', 'groups_plugins_play']\r\nVERBOSE_TO_STDERR(default) = False\r\nYAML_FILENAME_EXTENSIONS(default) = ['.yml', '.yaml', '.json']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nubuntu 16.04\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n- name: Get files in a folder\r\n  find:\r\n    paths: \"/opt/Thinkbox/DeadlineDatabase10/mongo/data/logs/\"\r\n  register: found_files\r\n  no_log: true\r\n\r\n- name: Get latest file\r\n  set_fact:\r\n    latest_file: \"{{ found_files.files | sort(attribute='mtime',reverse=true) | first }}\"\r\n\r\n- name: \"Get file {{ latest_file.path }} copy to {{ firehawk_path }}/tmp/deadline_db.log\"\r\n  fetch:\r\n    src: \"{{ latest_file.path }}\"\r\n    dest: \"{{ firehawk_path }}/tmp/deadline_db.log\"\r\n    flat: yes\r\n  become: true\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nIt should fetch the file without any error.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\n fatal: [firehawkgateway]: FAILED! => {\r\n     \"changed\": false, \r\n     \"checksum\": \"3ed68ded03e48466d7ccab9abdb174fd8d6d8dac\", \r\n     \"dest\": \"/deployuser/tmp/deadline_db.log\", \r\n     \"file\": \"/opt/Thinkbox/DeadlineDatabase10/mongo/data/logs/log.txt\", \r\n     \"md5sum\": \"cfcc74c8732a2c5318d891f141afa3f1\", \r\n     \"remote_checksum\": \"603c321f1e631188401d082be08a83f67515f84c\", \r\n     \"remote_md5sum\": null\r\n }\r\n \r\n MSG:\r\n \r\n checksum mismatch\r\n```\r\n",
        "created_at": "2020-05-07T23:50:23Z",
        "user": "queglay",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "files",
            "affects_2.9"
        ]
    },
    {
        "number": 69270,
        "title": "Unable to generate empty files with template module and if-statements",
        "body": "#### SUMMARY\r\nIt seems that the template-module always adds an empty line to the resulting file, even if whitespaces are trimmed, when there's an if-statement in the jinja2 template.\r\n\r\nI've tried a variety of lstrips and trims but the last empty line is always added.\r\n\r\nThis all seems to drill down to `preserve_trailing_newlines=True` in ansible/plugins/action/template.py -- setting this to False gives me the expected results.\r\n\r\nSetting jinja2_native to True in ansible.cfg doesn't impact the outcome.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n- template module\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.7\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/wouter.schoot/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.16 (default, Oct 10 2019, 22:02:15) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\n$ ansible-config dump --only-changed\r\n$ \r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n```\r\n$ cat /etc/debian_version \r\n10.3\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n- name: template\r\n  hosts: localhost\r\n  tasks:\r\n  - name: template\r\n    template:\r\n      src: foo.j2\r\n      dest: ./foo\r\n```\r\n\r\nfoo.j2\r\n```\r\n{%- if false -%}\r\nfoo\r\n{%- endif -%}\r\n\r\n```\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\n$ cat foo\r\n$ \r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n$ ansible-playbook playbook.yml -l localhost \r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [template] **********************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [template] **********************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n$ cat foo\r\n\r\n$ \r\n\r\n```\r\n",
        "created_at": "2020-05-01T09:53:42Z",
        "user": "wschoot",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "files",
            "affects_2.9"
        ]
    },
    {
        "number": 69190,
        "title": "Strange behaviour with required / required_* module parameters",
        "body": "##### SUMMARY\r\n\r\nThe 'required', 'required_together', 'required_if', etc parameters when creating modules behave oddly when passed `None`.  This can be achieved a couple of ways in a playbook:\r\n\r\n```\r\n- some_module:\r\n    arg_a: null\r\n    arg_b: ~\r\n    arg_c:\r\n```\r\n\r\nAn example can be seen in the lambda integration tests:\r\nhttps://github.com/ansible-collections/community.aws/blob/dedf734b21def6c1968869f8ac57cf59a20ee18f/tests/integration/targets/aws_lambda/tasks/main.yml#L55\r\n\r\nWhen this is done the type checking is ignored and the argument is treated as having been passed.  This means that None can end up propagating as a value even though the argument is set as 'required' or 'required_together'.  Which is extremely counterintuitive and means that as a module author I can't actually rely on any of the 'required' options actually existing.\r\n\r\nThis behaviour appears to have been introduced in commit\r\ne4e913b33131aed03123dab9932aaa44f0183c09\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/module_utils/basic.py\r\n\r\n##### ANSIBLE VERSION\r\nansible \r\n\r\n##### CONFIGURATION\r\n```\r\nansible 2.9.6\r\n  config file = /home/mchappel/.ansible.cfg\r\n  configured module search path = ['/home/mchappel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/mchappel/vcs/redhat/ansicloud-full/python3/ansible-2.9/lib/python3.6/site-packages/ansible\r\n  executable location = /home/mchappel/vcs/redhat/ansicloud-full/python3/ansible-2.9/bin/ansible\r\n  python version = 3.6.8 (default, Jun 11 2019, 15:15:01) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n```\r\nansible 2.10.0.dev0\r\n  config file = /home/mchappel/.ansible.cfg\r\n  configured module search path = ['/home/mchappel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/mchappel/vcs/ansible/ansible/lib/ansible\r\n  executable location = /home/mchappel/vcs/ansible/ansible/bin/ansible\r\n  python version = 3.6.8 (default, Jun 11 2019, 15:15:01) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n##### OS / ENVIRONMENT\r\n\r\nThis can be seen in the standard integration test environment\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn a module (example taken from community.aws.lambda) define:\r\n```\r\ndef main():\r\n    argument_spec = dict(\r\n        name=dict(required=True),\r\n...\r\n        vpc_subnet_ids=dict(type='list', elements='str'),\r\n        vpc_security_group_ids=dict(type='list', elements='str'),\r\n...\r\n    )\r\n...\r\n    required_together = [['vpc_subnet_ids', 'vpc_security_group_ids']]\r\n...\r\n    module = AnsibleAWSModule(argument_spec=argument_spec,\r\n...\r\n                              required_together=required_together,\r\n...\r\n    )\r\n```\r\n\r\nWhen invoking the module use `null` as the value (or ~, or leave it blank)  This may be desired when (for example) module_defaults are in use.\r\n\r\n```\r\n  - name: test state=present with security group but no vpc \r\n    lambda:\r\n      name: '{{lambda_function_name}}'\r\n      runtime: python2.7\r\n      role: ansible_lambda_role\r\n      zip_file: '{{zip_res.dest}}'\r\n      handler: null\r\n      description: null\r\n      vpc_subnet_ids: null\r\n      vpc_security_group_ids: sg-FA6E\r\n      environment_variables: null\r\n      dead_letter_arn: null\r\n    register: result\r\n    ignore_errors: true\r\n  - name: assert lambda fails with proper message\r\n    assert:\r\n      that:\r\n      - result is failed\r\n      - result.msg != \"MODULE FAILURE\"\r\n      - result.changed == False\r\n      - '\"requires at least one security group and one subnet\" in result.msg'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe test should 'pass' (ie the module should complain that the argument is missing)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe test fails because although 'required' and defined as needing to be a list of strings, `None` is treated as an acceptable value for `vpc_subnet_ids`",
        "created_at": "2020-04-27T07:52:41Z",
        "user": "tremble",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.10"
        ]
    },
    {
        "number": 69088,
        "title": "Reboot module in playbook timeout after upgrading from 2.7.10 to 2.9.7",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nAfter upgrading Ansible from 2.7.10 to 2.9.7, reboot module no longer works. System reboots but fails the alive check, appears to be stuck after issuing a sudo.\r\n\r\n- Dynamic Inventory is used via azure_rm\r\n- ansible_become_pass and ansible_ssh_private_key_file are defined and connecting properly\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nreboot module\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible-playbook 2.9.7\r\n  config file = /Users/calcheu/Documents/code/pcf-cloud/modules/gateway/gw_config/ansible.cfg\r\n  configured module search path = ['/Users/calcheu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 3.7.5 (default, Nov  1 2019, 02:16:32) [Clang 11.0.0 (clang-1100.0.33.8)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nDEFAULT_LOG_PATH(/Users/(redacted)/ansible.cfg) = /tmp/ansible.log\r\nDEFAULT_VAULT_PASSWORD_FILE(env: ANSIBLE_VAULT_PASSWORD_FILE) = /Users/(redacted)/.ansible/.vault_pass\r\nINVENTORY_ENABLED(/Users/(redacted)/ansible.cfg) = ['host_list', 'script', 'yaml', 'ini', 'auto', 'azure_rm']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nCentos 6.10\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a task to reboot server\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n  - name: \"Restart Server\"\r\n    become: yes\r\n    reboot:\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nSystem Rebooted and reboot task successful\r\n\r\n\r\n##### ACTUAL RESULTS\r\nReboot fails. Log shows SSH is completed but appears to be stuck on a sudo password prompt.\r\n\r\nThis just keeps repeating until reboot timeout occurs.\r\n```\r\n2020-04-21 16:59:38,531 p=25414 u=(redacted) n=ansible | Escalation succeeded\r\n2020-04-21 17:02:39,131 p=25414 u=(redacted) n=ansible | <10.78.212.113> (255, b'[sudo via ansible, key=newnwxyosxampdiugreejxgxaojkngja] password:', b'OpenSSH_7.9p1, LibreSSL 2.7.3\r\ndebug1: Reading configuration data /Users/(redacted)/.ssh/config\r\ndebug1: /Users/(redacted)/.ssh/config line 7: Applying options for 10.78.*\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\r\ndebug1: /etc/ssh/ssh_config line 52: Applying options for *\r\ndebug2: resolve_canonicalize: hostname 10.78.212.113 is address\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \"/Users/(redacted)/.ansible/cp/984d78a27f\" does not exist\r\ndebug2: ssh_connect_direct\r\ndebug1: Connecting to 10.78.212.113 [10.78.212.113] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9847 ms remain after connect\r\ndebug1: identity file /Users/(redacted)/temp/10.78.212.113.pem type -1\r\ndebug1: identity file /Users/(redacted)/temp/10.78.212.113.pem-cert type -1\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.9\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_5.3\r\ndebug1: match: OpenSSH_5.3 pat OpenSSH_5* compat 0x0c000002\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 10.78.212.113:22 as \\'ssgadmin\\'\r\ndebug3: hostkeys_foreach: reading file \"/dev/null\"\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none\r\ndebug2: compression stoc: none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: diffie-hellman-group-exchange-sha256\r\ndebug1: kex: host key algorithm: ssh-rsa\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64@openssh.com compression: none\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64@openssh.com compression: none\r\ndebug3: send packet: type 34\r\ndebug1: SSH2_MSG_KEX_DH_GEX_REQUEST(2048<3072<8192) sent\r\ndebug3: receive packet: type 31\r\ndebug1: got SSH2_MSG_KEX_DH_GEX_GROUP\r\ndebug2: bits set: 1568/3072\r\ndebug3: send packet: type 32\r\ndebug1: SSH2_MSG_KEX_DH_GEX_INIT sent\r\ndebug3: receive packet: type 33\r\ndebug1: got SSH2_MSG_KEX_DH_GEX_REPLY\r\ndebug1: Server host key: ssh-rsa SHA256:QtNLE2aVPXj88gbCgPPcc7t0aECqlrx8WexTTyGEcQU\r\ndebug3: hostkeys_foreach: reading file \"/dev/null\"\r\nWarning: Permanently added \\'10.78.212.113\\' (RSA) to the list of known hosts.\r\ndebug2: bits set: 1544/3072\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: Will attempt key: /Users/(redacted)/temp/10.78.212.113.pem  explicit\r\ndebug2: pubkey_prepare: done\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 53\r\ndebug3: input_userauth_banner\r\nCA API Gateway v9.2.00\\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,gssapi-keyex,gssapi-with-mic,password,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,gssapi-keyex,gssapi-with-mic,password,keyboard-interactive\r\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_lookup gssapi-with-mic\r\ndebug3: remaining preferred: gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_lookup gssapi-keyex\r\ndebug3: remaining preferred: hostbased,publickey\r\ndebug2: Unrecognized authentication method name: gssapi-keyex\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: ,publickey\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Trying private key: /Users/(redacted)/temp/10.78.212.113.pem\r\ndebug3: sign_and_send_pubkey: RSA SHA256:Lqh9KVvuMe8k5GN7qg5Xqe3ldB5gkg4UN76UImS5oPI\r\ndebug3: sign_and_send_pubkey: signing using ssh-rsa\r\ndebug3: send packet: type 50\r\ndebug2: we sent a publickey packet, wait for reply\r\ndebug3: receive packet: type 52\r\ndebug1: Authentication succeeded (publickey).\r\nAuthenticated to 10.78.212.113 ([10.78.212.113]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /Users/(redacted)/.ansible/cp/984d78a27f.eZ3vRx6oHOEbB9p0\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/Users/(redacted)/.ansible/cp/984d78a27f]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x20\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 25580\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\ndebug1: multiplexing control connection\r\ndebug3: fd 5 is O_NONBLOCK\r\ndebug3: fd 5 is O_NONBLOCK\r\ndebug1: channel 1: new [mux-control]\r\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\r\ndebug3: mux_master_read_cb: channel 1: hello sent\r\ndebug2: set_control_persist_exit_time: cancel scheduled exit\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\r\ndebug2: mux_master_process_hello: channel 1 slave version 4\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\r\ndebug2: mux_master_process_alive_check: channel 1: alive check\r\ndebug3: mux_client_request_alive: done pid = 25582\r\ndebug3: mux_client_request_session: session request sent\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 297\r\ndebug3: mux_master_process_new_session: got fds stdin 6, stdout 7, stderr 8\r\ndebug2: fd 7 setting O_NONBLOCK\r\ndebug2: fd 8 setting O_NONBLOCK\r\ndebug1: channel 2: new [client-session]\r\ndebug2: mux_master_process_new_session: channel_new: 2 linked to control channel 1\r\ndebug2: channel 2: send open\r\ndebug3: send packet: type 90\r\ndebug3: receive packet: type 91\r\ndebug2: channel_input_open_confirmation: channel 2: callback start\r\ndebug2: client_session2_setup: id 2\r\ndebug2: channel 2: request pty-req confirm 1\r\ndebug3: send packet: type 98\r\ndebug1: Sending environment.\r\ndebug1: Sending env LANG = en_US.UTF-8\r\ndebug2: channel 2: request env confirm 0\r\ndebug3: send packet: type 98\r\ndebug1: Sending command: /bin/sh -c \\'sudo -H -S  -p \"[sudo via ansible, key=newnwxyosxampdiugreejxgxaojkngja] password:\" -u root /bin/sh -c \\'\"\\'\"\\'echo BECOME-SUCCESS-newnwxyosxampdiugreejxgxaojkngja ; cat /proc/sys/kernel/random/boot_id\\'\"\\'\"\\' && sleep 0\\'\r\ndebug2: channel 2: request exec confirm 1\r\ndebug3: send packet: type 98\r\ndebug3: mux_session_confirm: sending success reply\r\ndebug2: channel_input_open_confirmation: channel 2: callback done\r\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\r\ndebug3: receive packet: type 99\r\ndebug2: channel_input_status_confirm: type 99 id 2\r\ndebug2: PTY allocation request accepted on channel 2\r\ndebug2: channel 2: rcvd adjust 2097152\r\ndebug3: receive packet: type 99\r\ndebug2: channel_input_status_confirm: type 99 id 2\r\ndebug2: exec request accepted on channel 2\r\ndebug3: send packet: type 1\r\ndebug1: channel 0: free: /Users/(redacted)/.ansible/cp/984d78a27f, nchannels 3\r\ndebug3: channel 0: status: The following connections are open:\r\n  #1 mux-control (t16 r2 i0/0 o0/0 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\r\n  #2 client-session (t4 r0 i0/0 o0/0 e[write]/0 fd 6/7/8 sock -1 cc 1)\r\n\r\ndebug1: channel 1: free: mux-control, nchannels 2\r\ndebug3: channel 1: status: The following connections are open:\r\n  #1 mux-control (t16 r2 i0/0 o0/0 e[closed]/0 fd 5/5/-1 sock 5 cc -1)\r\n  #2 client-session (t4 r0 i0/0 o0/0 e[write]/0 fd 6/7/8 sock -1 cc 1)\r\n\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Control master terminated unexpectedly\r\nShared connection to 10.78.212.113 closed.\r\ndebug1: channel 2: free: client-session, nchannels 1\r\ndebug3: channel 2: status: The following connections are open:\r\n  #2 client-session (t4 r0 i0/0 o0/0 e[write]/0 fd 6/7/8 sock -1 cc 1)\r\n\r\ndebug3: fd 0 is not O_NONBLOCK\r\ndebug3: fd 1 is not O_NONBLOCK\r\ndebug1: fd 2 clearing O_NONBLOCK\r\nConnection to 10.78.212.113 closed by remote host.\r\nTransferred: sent 3256, received 2408 bytes, in 180.6 seconds\r\nBytes per second: sent 18.0, received 13.3\r\ndebug1: Exit status -1\r\n')\r\n2020-04-21 17:02:43,473 p=25414 u=(redacted) n=ansible | reboot: attempting to get system boot time\r\n```\r\n",
        "created_at": "2020-04-21T21:30:56Z",
        "user": "ToniCipriani",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 68915,
        "title": "ansible-galaxy collection init doesn't respect configured collections_paths",
        "body": "##### SUMMARY\r\n\r\nWhen I am creating a new playbook, I want to create local collections (since I like to separate out my roles into collection(s)) for that playbook. I have a `collections_paths` configured in my playbook project's `ansible.cfg` file, but when I initialize a collection in my project with the following command:\r\n\r\n    ansible-galaxy collection init local.stuff\r\n\r\nThe `collections_paths` seems to be ignored, as a new collection is instantiated in `./local/stuff` instead of `./ansible_collections/local/stuff`.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nansible-galaxy\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.6\r\n  config file = /Users/jgeerling/Downloads/test/ansible.cfg\r\n  configured module search path = ['/Users/jgeerling/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.7 (default, Apr  9 2020, 17:13:06) [Clang 11.0.3 (clang-1103.0.32.29)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_NOCOWS(/Users/jgeerling/Downloads/test/ansible.cfg) = True\r\nCOLLECTIONS_PATHS(/Users/jgeerling/Downloads/test/ansible.cfg) = ['/Users/jgeerling/Downloads/test']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n\r\n  - macOS\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAnsible.cfg contents:\r\n\r\n```\r\n[defaults]\r\n# Installs collections into [current dir]/ansible_collections/namespace/collection_name\r\ncollections_paths = ./\r\n```\r\n\r\nWhen I run the command:\r\n\r\n    ansible-galaxy collection init local.stuff\r\n\r\nThen it creates a collection in the path `./local/stuff`\r\n\r\nAnd my local playbook can't find that collection since it's not in the configured `collections_paths`.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnsible would create a collection in `./ansible_collections/local/stuff`\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAnsible created a collection in `./local/stuff`\r\n\r\nAdditionally, if I try to specify a path on the command line directly I get:\r\n\r\n```\r\n$ ansible-galaxy collection init local.stuff -p ./\r\nusage: ansible-galaxy [-h] [--version] [-v] TYPE ...\r\nansible-galaxy: error: unrecognized arguments: -p ./\r\n```",
        "created_at": "2020-04-13T15:15:22Z",
        "user": "geerlingguy",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 68795,
        "title": "known_hosts changes permissions on file when removing a named host",
        "body": "##### SUMMARY\r\nAfter using known_hosts to remove a key from /etc/ssh/ssh_known_hosts, I was unable to ssh without being prompted about the authenticity of the destination host, when I knew it was listed.  Investigation showed that known_hosts changed the permissions of that file from 644 to 600.\r\n\r\nIt appears that the issue is due to the use of ssh-keygen to remove the entry.  I've opened a bug there (https://bugzilla.mindrot.org/show_bug.cgi?id=3146), but am not sure it will be fixed, and would like to see a fix in Ansible.  Maybe it's possible to remove the entry without ssh-keygen?\r\n\r\nA fix for #29223 would offer a way to keep the permissions the same without adding another task.\r\n\r\nI'd at least like to see the permission-changing behavior documented, so others won't have to dig so much to figure out why Ansible is changing the permissions.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nknown_hosts\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.7\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.3 (default, Dec 20 2019, 18:57:59) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\nInspection of current master shows that the problem is very likely still present.\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nDebian 10.3, with ssh 1:7.9p1-10+deb10u2\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nUse known_hosts to remove a key that is present in a file that has group/other readability, eg /etc/ssh/ssh_known_hosts. Do not provide the key to remove.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- hosts: [ 'localhost' ]\r\n  become: true\r\n  connection: ssh\r\n  remote_user: ansible\r\n\r\n  tasks:\r\n  - known_hosts:\r\n      path: /etc/ssh/ssh_known_hosts\r\n      name: <some host that is present>\r\n      state: absent\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nPermissions on existing file are retained.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nPermissions on existing file are changed to 600.\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n$ ls -l /etc/ssh/ssh_known_hosts\r\n-rw------- 1 root root 120 Apr  8 12:52 /etc/ssh/ssh_known_hosts\r\n```\r\n",
        "created_at": "2020-04-09T02:27:29Z",
        "user": "edgewood",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3",
            "verified",
            "system"
        ]
    },
    {
        "number": 68763,
        "title": "v2.9.6 templating performance regression due to caching change in #67429",
        "body": "##### SUMMARY\r\n#67429 (included in Ansible v2.9.6) causes a massive performance penalty compared to Ansible v2.9.5. I have a project making heavy use of Ansible's `template` module. With v2.9.5 it takes about 15 seconds to render a file. With v2.9.6, it takes about 9 minutes. Reverting the change in #67429 (just changing `if cache and only_one:` back to `if cache:`) restores the v2.9.5 performance.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n`lib/ansible/template/__init__.py`\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.6\r\n  config file = /users/kenyon/git/tni4/ansible.cfg\r\n  configured module search path = ['/users/kenyon/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /users/kenyon/.local/share/virtualenvs/tni4-I44CyCAv/lib/python3.6/site-packages/ansible\r\n  executable location = /users/kenyon/.local/share/virtualenvs/tni4-I44CyCAv/bin/ansible\r\n  python version = 3.6.8 (default, Apr 25 2019, 21:02:35) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_HOST_LIST(/users/kenyon/git/tni4/ansible.cfg) = ['/users/kenyon/git/tni4/hosts']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentOS 7\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nUse large templates with lots of Jinja code. I am rendering configuration files for network devices, so the end resulting rendered files are around 2000 lines or less, but the templates use a lot of Jinja features.\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nNo performance regression.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nPerformance regression.",
        "created_at": "2020-04-08T07:45:58Z",
        "user": "kenyon",
        "labels": [
            "python3",
            "performance",
            "support:core",
            "bug",
            "P3",
            "files",
            "affects_2.9",
            "data_tagging"
        ]
    },
    {
        "number": 68696,
        "title": "service module not restarting Elastic filebeat on Debian Wheezy",
        "body": "##### SUMMARY\r\n\r\nUsing system ```service``` module to restart an installed and running filebeat service on Debian Wheezy stops the service.\r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/modules/system/sysvinit.py\r\nlib/ansible/module_utils/service.py \r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.6.0\r\n  config file = None\r\n  configured module search path = ['/Users/jeanfabrice/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/jeanfabrice/ansible/build/lib/ansible\r\n  executable location = bin/ansible\r\n  python version = 3.7.6 (default, Dec 22 2019, 01:09:06) [Clang 11.0.0 (clang-1100.0.33.12)]\r\n```\r\n\r\n2.7, 2.8 and 2.9 are also affected\r\n\r\n##### CONFIGURATION\r\n```\r\nHOST_KEY_CHECKING(env: ANSIBLE_HOST_KEY_CHECKING) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nTarget OS : Debian Wheezy (```Linux target 3.2.0-4-686-pae #1 SMP Debian 3.2.46-1+deb7u1 i686 GNU/Linux```)\r\nService : filebeat 7.6.1 from Elastic deb repo\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```shell\r\nansible -i 'target,' -m service -a \"name=filebeat state=restarted\" -vvv target\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nService filebeat restarted and kept running\r\n\r\n\r\n##### ACTUAL RESULTS\r\nFilebeat service is first correctly restarted but immediately after the Ansible command terminates, the service is stopped. Seems that Ansible get trouble trouble to daemonize the service\r\n\r\n```shell\r\ncontroller$ ansible -i 'target,' -m service -a \"name=filebeat state=restarted\" -vvv target\r\ntarget | SUCCESS => {\r\n    \"changed\": true,\r\n    \"name\": \"filebeat\",\r\n    \"status\": {\r\n        \"enabled\": {\r\n            \"changed\": true,\r\n            \"rc\": 0,\r\n            \"stderr\": \"\",\r\n            \"stdout\": \"filebeat is running.\\n\"\r\n        },\r\n        \"restarted\": {\r\n            \"changed\": true,\r\n            \"rc\": 0,\r\n            \"stderr\": \"2020-04-04T23:29:15.869+0200\\tINFO\\tinstance/beat.go:622\\tHome path: [/usr/share/filebeat] Config path: [/etc/filebeat] Data path: [/data/filebeat/data/filebeat] Logs path: [/data/filebeat/logs]\\n2020-04-04T23:29:15.869+0200\\tINFO\\tinstance/beat.go:630\\tBeat ID: 7dd36599-bb12-48ee-bb1d-31c63324e7cb\\n2020-04-04T23:29:15.870+0200\\tINFO\\t[beat]\\tinstance/beat.go:958\\tBeat info\\t{\\\"system_info\\\": {\\\"beat\\\": {\\\"path\\\": {\\\"config\\\": \\\"/etc/filebeat\\\", \\\"data\\\": \\\"/data/filebeat/data/filebeat\\\", \\\"home\\\": \\\"/usr/share/filebeat\\\", \\\"logs\\\": \\\"/data/filebeat/logs\\\"}, \\\"type\\\": \\\"filebeat\\\", \\\"uuid\\\": \\\"7dd36599-bb12-48ee-bb1d-31c63324e7cb\\\"}}}\\n2020-04-04T23:29:15.871+0200\\tINFO\\t[beat]\\tinstance/beat.go:967\\tBuild info\\t{\\\"system_info\\\": {\\\"build\\\": {\\\"commit\\\": \\\"c1c49432bdc53563e63e9d684ca3e9843626e448\\\", \\\"libbeat\\\": \\\"7.6.1\\\", \\\"time\\\": \\\"2020-02-28T23:12:27.000Z\\\", \\\"version\\\": \\\"7.6.1\\\"}}}\\n2020-04-04T23:29:15.871+0200\\tINFO\\t[beat]\\tinstance/beat.go:970\\tGo runtime info\\t{\\\"system_info\\\": {\\\"go\\\": {\\\"os\\\":\\\"linux\\\",\\\"arch\\\":\\\"386\\\",\\\"max_procs\\\":2,\\\"version\\\":\\\"go1.13.8\\\"}}}\\n2020-04-04T23:29:15.871+0200\\tINFO\\t[beat]\\tinstance/beat.go:974\\tHost info\\t{\\\"system_info\\\": {\\\"host\\\": {\\\"architecture\\\":\\\"i686\\\",\\\"boot_time\\\":\\\"2018-09-27T15:54:08+02:00\\\",\\\"containerized\\\":false,\\\"name\\\":\\\"target\\\",\\\"ip\\\":[\\\"127.0.0.1/8\\\",\\\"::1/128\\\",\\\"x.x.x.x/24\\\",\\\"fe80/64\\\"],\\\"kernel_version\\\":\\\"3.2.0-4-686-pae\\\",\\\"mac\\\":[\\\"00:aa:bb:cc:dd:ee\\\"],\\\"os\\\":{\\\"family\\\":\\\"debian\\\",\\\"platform\\\":\\\"debian\\\",\\\"name\\\":\\\"Debian GNU/Linux\\\",\\\"version\\\":\\\"7 (wheezy)\\\",\\\"major\\\":7,\\\"minor\\\":0,\\\"patch\\\":0,\\\"codename\\\":\\\"wheezy\\\"},\\\"timezone\\\":\\\"CEST\\\",\\\"timezone_offset_sec\\\":7200}}}\\n2020-04-04T23:29:15.872+0200\\tINFO\\t[beat]\\tinstance/beat.go:1003\\tProcess info\\t{\\\"system_info\\\": {\\\"process\\\": {\\\"capabilities\\\": {\\\"inheritable\\\":null,\\\"permitted\\\":[\\\"chown\\\",\\\"dac_override\\\",\\\"dac_read_search\\\",\\\"fowner\\\",\\\"fsetid\\\",\\\"kill\\\",\\\"setgid\\\",\\\"setuid\\\",\\\"setpcap\\\",\\\"linux_immutable\\\",\\\"net_bind_service\\\",\\\"net_broadcast\\\",\\\"net_admin\\\",\\\"net_raw\\\",\\\"ipc_lock\\\",\\\"ipc_owner\\\",\\\"sys_module\\\",\\\"sys_rawio\\\",\\\"sys_chroot\\\",\\\"sys_ptrace\\\",\\\"sys_pacct\\\",\\\"sys_admin\\\",\\\"sys_boot\\\",\\\"sys_nice\\\",\\\"sys_resource\\\",\\\"sys_time\\\",\\\"sys_tty_config\\\",\\\"mknod\\\",\\\"lease\\\",\\\"audit_write\\\",\\\"audit_control\\\",\\\"setfcap\\\",\\\"mac_override\\\",\\\"mac_admin\\\",\\\"syslog\\\",\\\"wake_alarm\\\",\\\"block_suspend\\\",\\\"audit_read\\\",\\\"38\\\",\\\"39\\\",\\\"40\\\",\\\"41\\\",\\\"42\\\",\\\"43\\\",\\\"44\\\",\\\"45\\\",\\\"46\\\",\\\"47\\\",\\\"48\\\",\\\"49\\\",\\\"50\\\",\\\"51\\\",\\\"52\\\",\\\"53\\\",\\\"54\\\",\\\"55\\\",\\\"56\\\",\\\"57\\\",\\\"58\\\",\\\"59\\\",\\\"60\\\",\\\"61\\\",\\\"62\\\",\\\"63\\\"],\\\"effective\\\":[\\\"chown\\\",\\\"dac_override\\\",\\\"dac_read_search\\\",\\\"fowner\\\",\\\"fsetid\\\",\\\"kill\\\",\\\"setgid\\\",\\\"setuid\\\",\\\"setpcap\\\",\\\"linux_immutable\\\",\\\"net_bind_service\\\",\\\"net_broadcast\\\",\\\"net_admin\\\",\\\"net_raw\\\",\\\"ipc_lock\\\",\\\"ipc_owner\\\",\\\"sys_module\\\",\\\"sys_rawio\\\",\\\"sys_chroot\\\",\\\"sys_ptrace\\\",\\\"sys_pacct\\\",\\\"sys_admin\\\",\\\"sys_boot\\\",\\\"sys_nice\\\",\\\"sys_resource\\\",\\\"sys_time\\\",\\\"sys_tty_config\\\",\\\"mknod\\\",\\\"lease\\\",\\\"audit_write\\\",\\\"audit_control\\\",\\\"setfcap\\\",\\\"mac_override\\\",\\\"mac_admin\\\",\\\"syslog\\\",\\\"wake_alarm\\\",\\\"block_suspend\\\",\\\"audit_read\\\",\\\"38\\\",\\\"39\\\",\\\"40\\\",\\\"41\\\",\\\"42\\\",\\\"43\\\",\\\"44\\\",\\\"45\\\",\\\"46\\\",\\\"47\\\",\\\"48\\\",\\\"49\\\",\\\"50\\\",\\\"51\\\",\\\"52\\\",\\\"53\\\",\\\"54\\\",\\\"55\\\",\\\"56\\\",\\\"57\\\",\\\"58\\\",\\\"59\\\",\\\"60\\\",\\\"61\\\",\\\"62\\\",\\\"63\\\"],\\\"bounding\\\":[\\\"chown\\\",\\\"dac_override\\\",\\\"dac_read_search\\\",\\\"fowner\\\",\\\"fsetid\\\",\\\"kill\\\",\\\"setgid\\\",\\\"setuid\\\",\\\"setpcap\\\",\\\"linux_immutable\\\",\\\"net_bind_service\\\",\\\"net_broadcast\\\",\\\"net_admin\\\",\\\"net_raw\\\",\\\"ipc_lock\\\",\\\"ipc_owner\\\",\\\"sys_module\\\",\\\"sys_rawio\\\",\\\"sys_chroot\\\",\\\"sys_ptrace\\\",\\\"sys_pacct\\\",\\\"sys_admin\\\",\\\"sys_boot\\\",\\\"sys_nice\\\",\\\"sys_resource\\\",\\\"sys_time\\\",\\\"sys_tty_config\\\",\\\"mknod\\\",\\\"lease\\\",\\\"audit_write\\\",\\\"audit_control\\\",\\\"setfcap\\\",\\\"mac_override\\\",\\\"mac_admin\\\",\\\"syslog\\\",\\\"wake_alarm\\\",\\\"block_suspend\\\",\\\"audit_read\\\",\\\"38\\\",\\\"39\\\",\\\"40\\\",\\\"41\\\",\\\"42\\\",\\\"43\\\",\\\"44\\\",\\\"45\\\",\\\"46\\\",\\\"47\\\",\\\"48\\\",\\\"49\\\",\\\"50\\\",\\\"51\\\",\\\"52\\\",\\\"53\\\",\\\"54\\\",\\\"55\\\",\\\"56\\\",\\\"57\\\",\\\"58\\\",\\\"59\\\",\\\"60\\\",\\\"61\\\",\\\"62\\\",\\\"63\\\"],\\\"ambient\\\":null}, \\\"cwd\\\": \\\"/root\\\", \\\"exe\\\": \\\"/usr/share/filebeat/bin/filebeat\\\", \\\"name\\\": \\\"filebeat\\\", \\\"pid\\\": 21201, \\\"ppid\\\": 21200, \\\"seccomp\\\": {\\\"mode\\\":\\\"\\\"}, \\\"start_time\\\": \\\"2020-04-04T23:29:15.740+0200\\\"}}}\\n2020-04-04T23:29:15.872+0200\\tINFO\\tinstance/beat.go:298\\tSetup Beat: filebeat; Version: 7.6.1\\n2020-04-04T23:29:15.873+0200\\tINFO\\t[publisher]\\tpipeline/module.go:110\\tBeat name: target\\n2020-04-04T23:29:15.873+0200\\tWARN\\tbeater/filebeat.go:152\\tFilebeat is unable to load the Ingest Node pipelines for the configured modules because the Elasticsearch output is not configured/enabled. If you have already loaded the Ingest Node pipelines or are using Logstash pipelines, you can ignore this warning.\\n\",\r\n            \"stdout\": \"Config OK\\n\"\r\n        }\r\n    }\r\n}\r\n\r\nroot@target:/data/filebeat/logs# ps -ef | grep filebeat\r\nroot     21230 16351  0 23:29 pts/0    00:00:00 grep filebeat\r\n\r\nroot@target:/data/filebeat/logs# cat filebeat.log\r\n2020-04-04T23:29:15.920+0200    INFO    instance/beat.go:622    Home path: [/usr/share/filebeat] Config path: [/etc/filebeat] Data path: [/data/filebeat/data/filebeat] Logs path: [/data/filebeat/logs]\r\n2020-04-04T23:29:15.921+0200    INFO    instance/beat.go:630    Beat ID: 7dd36599-bb12-48ee-bb1d-31c63324e7cb\r\n2020-04-04T23:29:15.922+0200    INFO    [seccomp]       seccomp/seccomp.go:101  Syscall filter could not be installed because the kernel does not support seccomp\r\n2020-04-04T23:29:15.922+0200    INFO    [beat]  instance/beat.go:958    Beat info     {\"system_info\": {\"beat\": {\"path\": {\"config\": \"/etc/filebeat\", \"data\": \"/data/filebeat/data/filebeat\", \"home\": \"/usr/share/filebeat\", \"logs\": \"/data/filebeat/logs\"}, \"type\": \"filebeat\", \"uuid\": \"7dd36599-bb12-48ee-bb1d-31c63324e7cb\"}}}\r\n2020-04-04T23:29:15.922+0200    INFO    [beat]  instance/beat.go:967    Build info    {\"system_info\": {\"build\": {\"commit\": \"c1c49432bdc53563e63e9d684ca3e9843626e448\", \"libbeat\": \"7.6.1\", \"time\": \"2020-02-28T23:12:27.000Z\", \"version\": \"7.6.1\"}}}\r\n2020-04-04T23:29:15.922+0200    INFO    [beat]  instance/beat.go:970    Go runtime info{\"system_info\": {\"go\": {\"os\":\"linux\",\"arch\":\"386\",\"max_procs\":2,\"version\":\"go1.13.8\"}}}\r\n2020-04-04T23:29:15.923+0200    INFO    [beat]  instance/beat.go:974    Host info     {\"system_info\": {\"host\": {\"architecture\":\"i686\",\"boot_time\":\"2018-09-27T15:54:08+02:00\",\"containerized\":false,\"name\":\"target\",\"ip\":[\"127.0.0.1/8\",\"::1/128\",\"x.x.x.x/24\",\"fe80/64\"],\"kernel_version\":\"3.2.0-4-686-pae\",\"mac\":[\"00:50:56:b2:02:c1\"],\"os\":{\"family\":\"debian\",\"platform\":\"debian\",\"name\":\"Debian GNU/Linux\",\"version\":\"7 (wheezy)\",\"major\":7,\"minor\":0,\"patch\":0,\"codename\":\"wheezy\"},\"timezone\":\"CEST\",\"timezone_offset_sec\":7200}}}\r\n2020-04-04T23:29:15.924+0200    INFO    [beat]  instance/beat.go:1003   Process info  {\"system_info\": {\"process\": {\"capabilities\": {\"inheritable\":null,\"permitted\":[\"chown\",\"dac_override\",\"dac_read_search\",\"fowner\",\"fsetid\",\"kill\",\"setgid\",\"setuid\",\"setpcap\",\"linux_immutable\",\"net_bind_service\",\"net_broadcast\",\"net_admin\",\"net_raw\",\"ipc_lock\",\"ipc_owner\",\"sys_module\",\"sys_rawio\",\"sys_chroot\",\"sys_ptrace\",\"sys_pacct\",\"sys_admin\",\"sys_boot\",\"sys_nice\",\"sys_resource\",\"sys_time\",\"sys_tty_config\",\"mknod\",\"lease\",\"audit_write\",\"audit_control\",\"setfcap\",\"mac_override\",\"mac_admin\",\"syslog\",\"wake_alarm\",\"block_suspend\",\"audit_read\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\"],\"effective\":[\"chown\",\"dac_override\",\"dac_read_search\",\"fowner\",\"fsetid\",\"kill\",\"setgid\",\"setuid\",\"setpcap\",\"linux_immutable\",\"net_bind_service\",\"net_broadcast\",\"net_admin\",\"net_raw\",\"ipc_lock\",\"ipc_owner\",\"sys_module\",\"sys_rawio\",\"sys_chroot\",\"sys_ptrace\",\"sys_pacct\",\"sys_admin\",\"sys_boot\",\"sys_nice\",\"sys_resource\",\"sys_time\",\"sys_tty_config\",\"mknod\",\"lease\",\"audit_write\",\"audit_control\",\"setfcap\",\"mac_override\",\"mac_admin\",\"syslog\",\"wake_alarm\",\"block_suspend\",\"audit_read\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\"],\"bounding\":[\"chown\",\"dac_override\",\"dac_read_search\",\"fowner\",\"fsetid\",\"kill\",\"setgid\",\"setuid\",\"setpcap\",\"linux_immutable\",\"net_bind_service\",\"net_broadcast\",\"net_admin\",\"net_raw\",\"ipc_lock\",\"ipc_owner\",\"sys_module\",\"sys_rawio\",\"sys_chroot\",\"sys_ptrace\",\"sys_pacct\",\"sys_admin\",\"sys_boot\",\"sys_nice\",\"sys_resource\",\"sys_time\",\"sys_tty_config\",\"mknod\",\"lease\",\"audit_write\",\"audit_control\",\"setfcap\",\"mac_override\",\"mac_admin\",\"syslog\",\"wake_alarm\",\"block_suspend\",\"audit_read\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\"],\"ambient\":null}, \"cwd\": \"/\", \"exe\": \"/usr/share/filebeat/bin/filebeat\", \"name\": \"filebeat\", \"pid\": 21212, \"ppid\": 21211, \"seccomp\": {\"mode\":\"\"}, \"start_time\": \"2020-04-04T23:29:15.790+0200\"}}}\r\n2020-04-04T23:29:15.924+0200    INFO    instance/beat.go:298    Setup Beat: filebeat; Version: 7.6.1\r\n2020-04-04T23:29:15.924+0200    INFO    [publisher]     pipeline/module.go:110  Beat name: target\r\n2020-04-04T23:29:15.925+0200    WARN    beater/filebeat.go:152  Filebeat is unable to load the Ingest Node pipelines for the configured modules because the Elasticsearch output is not configured/enabled. If you have already loaded the Ingest Node pipelines or are using Logstash pipelines, you can ignore this warning.\r\n2020-04-04T23:29:15.925+0200    INFO    [monitoring]    log/log.go:118  Starting metrics logging every 10m0s\r\n2020-04-04T23:29:15.925+0200    INFO    instance/beat.go:439    filebeat start running.\r\n2020-04-04T23:29:15.925+0200    INFO    registrar/registrar.go:145      Loading registrar data from /data/filebeat/data/filebeat/registry/filebeat/data.json\r\n2020-04-04T23:29:15.925+0200    INFO    registrar/registrar.go:152      States Loaded from registrar: 6\r\n2020-04-04T23:29:15.925+0200    WARN    beater/filebeat.go:368  Filebeat is unable to load the Ingest Node pipelines for the configured modules because the Elasticsearch output is not configured/enabled. If you have already loaded the Ingest Node pipelines or are using Logstash pipelines, you can ignore this warning.\r\n2020-04-04T23:29:15.925+0200    INFO    crawler/crawler.go:72   Loading Inputs: 1\r\n2020-04-04T23:29:15.926+0200    INFO    log/input.go:152        Configured paths: [/var/log/mail.log*]\r\n2020-04-04T23:29:15.926+0200    INFO    input/input.go:114      Starting input of type: log; ID: 17474473810420849218 \r\n2020-04-04T23:29:15.926+0200    INFO    crawler/crawler.go:106  Loading and starting Inputs completed. Enabled inputs: 1\r\n2020-04-04T23:29:15.926+0200    INFO    cfgfile/reload.go:171   Config reloader started\r\n2020-04-04T23:29:15.927+0200    INFO    cfgfile/reload.go:226   Loading of config files completed.\r\n2020-04-04T23:29:16.902+0200    INFO    beater/filebeat.go:443  Stopping filebeat\r\n2020-04-04T23:29:16.902+0200    INFO    crawler/crawler.go:139  Stopping Crawler\r\n2020-04-04T23:29:16.902+0200    INFO    crawler/crawler.go:149  Stopping 1 inputs\r\n2020-04-04T23:29:16.902+0200    INFO    cfgfile/reload.go:229   Dynamic config reloader stopped\r\n2020-04-04T23:29:16.902+0200    INFO    input/input.go:149      input ticker stopped\r\n2020-04-04T23:29:16.902+0200    INFO    input/input.go:167      Stopping Input: 17474473810420849218\r\n2020-04-04T23:29:16.902+0200    INFO    crawler/crawler.go:165  Crawler stopped\r\n2020-04-04T23:29:16.902+0200    INFO    registrar/registrar.go:367      Stopping Registrar\r\n2020-04-04T23:29:16.902+0200    INFO    registrar/registrar.go:293      Ending Registrar\r\n2020-04-04T23:29:16.917+0200    INFO    [monitoring]    log/log.go:153  Total non-zero metrics {\"monitoring\": {\"metrics\": {\"beat\":{\"cpu\":{\"system\":{\"ticks\":30,\"time\":{\"ms\":36}},\"total\":{\"ticks\":70,\"time\":{\"ms\":80},\"value\":70},\"user\":{\"ticks\":40,\"time\":{\"ms\":44}}},\"handles\":{\"limit\":{\"hard\":4096,\"soft\":1024},\"open\":11},\"info\":{\"ephemeral_id\":\"8b67b1ac-a247-421d-8ef9-848569b0bc4b\",\"uptime\":{\"ms\":1027}},\"memstats\":{\"gc_next\":6461104,\"memory_alloc\":3837496,\"memory_total\":10912192,\"rss\":24752128},\"runtime\":{\"goroutines\":33}},\"filebeat\":{\"events\":{\"added\":3,\"done\":3},\"harvester\":{\"open_files\":0,\"running\":0}},\"libbeat\":{\"config\":{\"module\":{\"running\":0},\"reloads\":1},\"output\":{\"type\":\"logstash\"},\"pipeline\":{\"clients\":0,\"events\":{\"active\":0,\"filtered\":3,\"total\":3}}},\"registrar\":{\"states\":{\"current\":6,\"update\":3},\"writes\":{\"success\":4,\"total\":4}},\"system\":{\"cpu\":{\"cores\":2},\"load\":{\"1\":0,\"15\":0.05,\"5\":0.01,\"norm\":{\"1\":0,\"15\":0.025,\"5\":0.005}}}}}}\r\n2020-04-04T23:29:16.917+0200    INFO    [monitoring]    log/log.go:154  Uptime: 1.031433146s\r\n2020-04-04T23:29:16.917+0200    INFO    [monitoring]    log/log.go:131  Stopping metrics logging.\r\n2020-04-04T23:29:16.918+0200    INFO    instance/beat.go:445    filebeat stopped.\r\n\r\n\r\nroot@target:/etc/init.d/# cat filebeat\r\n#!/bin/sh\r\n### BEGIN INIT INFO\r\n# Provides:          filebeat\r\n# Required-Start:    $local_fs $network $syslog\r\n# Required-Stop:     $local_fs $network $syslog\r\n# Default-Start:     2 3 4 5\r\n# Default-Stop:      0 1 6\r\n# Short-Description: Filebeat sends log files to Logstash or directly to Elasticsearch.\r\n# Description:       Filebeat is a shipper part of the Elastic Beats\r\n#                    family. Please see: https://www.elastic.co/products/beats\r\n### END INIT INFO\r\n\r\n# Do NOT \"set -e\"\r\n\r\n# PATH should only include /usr/* if it runs after the mountnfs.sh script\r\nPATH=/sbin:/usr/sbin:/bin:/usr/bin\r\nDESC=\"Filebeat sends log files to Logstash or directly to Elasticsearch.\"\r\nNAME=\"filebeat\"\r\nDAEMON=/usr/share/filebeat/bin/filebeat\r\nDAEMON_ARGS=\"-c /etc/filebeat/filebeat.yml -path.home /usr/share/filebeat -path.config /etc/filebeat -path.data /data/filebeat/data/filebeat -path.logs /data/filebeat/logs\"\r\nTEST_ARGS=\"-e test config\"\r\nPIDFILE=/var/run/filebeat.pid\r\nWRAPPER=\"/usr/share/${NAME}/bin/${NAME}-god\"\r\nBEAT_USER=\"root\"\r\nWRAPPER_ARGS=\"-r / -n -p $PIDFILE\"\r\nSCRIPTNAME=/etc/init.d/filebeat\r\n\r\n# Exit if the package is not installed\r\n[ -x \"$DAEMON\" ] || exit 0\r\n\r\n# Read configuration variable file if it is present\r\n[ -r /etc/default/filebeat ] && . /etc/default/filebeat\r\n\r\n[ \"$BEAT_USER\" != \"root\" ] && WRAPPER_ARGS=\"$WRAPPER_ARGS -u $BEAT_USER\"\r\nUSER_WRAPPER=\"su\"\r\nUSER_WRAPPER_ARGS=\"$BEAT_USER -c\"\r\n\r\nif command -v runuser >/dev/null 2>&1; then\r\n    USER_WRAPPER=\"runuser\"\r\nfi\r\n\r\n# Load the VERBOSE setting and other rcS variables\r\n. /lib/init/vars.sh\r\n\r\n# Define LSB log_* functions.\r\n# Depend on lsb-base (>= 3.2-14) to ensure that this file is present\r\n# and status_of_proc is working.\r\n. /lib/lsb/init-functions\r\n\r\n#\r\n# Function that calls runs the service in foreground\r\n# to test its configuration.\r\n#\r\ndo_test()\r\n{\r\n        $USER_WRAPPER $USER_WRAPPER_ARGS \"$DAEMON $DAEMON_ARGS $TEST_ARGS\"\r\n}\r\n\r\n#\r\n# Function that starts the daemon/service\r\n#\r\ndo_start()\r\n{\r\n        # Return\r\n        #   0 if daemon has been started\r\n        #   1 if daemon was already running\r\n        #   2 if daemon could not be started\r\n        start-stop-daemon --start \\\r\n                --pidfile $PIDFILE  \\\r\n                --exec $WRAPPER -- $WRAPPER_ARGS -- $DAEMON $DAEMON_ARGS \\\r\n                || return 2\r\n}\r\n\r\n#\r\n# Function that stops the daemon/service\r\n#\r\ndo_stop()\r\n{\r\n        # Return\r\n        #   0 if daemon has been stopped\r\n        #   1 if daemon was already stopped\r\n        #   2 if daemon could not be stopped\r\n        #   other if a failure occurred\r\n        start-stop-daemon --stop --quiet --retry=TERM/5/KILL/5 --pidfile $PIDFILE --exec $WRAPPER\r\n        RETVAL=\"$?\"\r\n        [ \"$RETVAL\" = 2 ] && return 2\r\n        # Wait for children to finish too if this is a daemon that forks\r\n        # and if the daemon is only ever run from this initscript.\r\n        # If the above conditions are not satisfied then add some other code\r\n        # that waits for the process to drop all resources that could be\r\n        # needed by services started subsequently.  A last resort is to\r\n        # sleep for some time.\r\n        start-stop-daemon --stop --quiet --oknodo --retry=0/30/KILL/5 --exec $DAEMON\r\n        [ \"$?\" = 2 ] && return 2\r\n        # Many daemons don't delete their pidfiles when they exit.\r\n        rm -f $PIDFILE\r\n        return \"$RETVAL\"\r\n}\r\n\r\n#\r\n# Function that sends a SIGHUP to the daemon/service\r\n#\r\ndo_reload() {\r\n        #\r\n        # If the daemon can reload its configuration without\r\n        # restarting (for example, when it is sent a SIGHUP),\r\n        # then implement that here.\r\n        #\r\n        start-stop-daemon --stop --signal 1 --quiet --pidfile $PIDFILE --exec $DAEMON\r\n        return 0\r\n}\r\n\r\ncase \"$1\" in\r\n  start)\r\n        [ \"$VERBOSE\" != no ] && log_daemon_msg \"Starting $DESC\" \"$NAME\"\r\n        do_test\r\n        case \"$?\" in\r\n                0) ;;\r\n                *)\r\n                        log_end_msg 1\r\n                        exit 1\r\n                        ;;\r\n        esac\r\n        do_start\r\n        case \"$?\" in\r\n                0|1) [ \"$VERBOSE\" != no ] && log_end_msg 0 ;;\r\n                2) [ \"$VERBOSE\" != no ] && log_end_msg 1 ;;\r\n        esac\r\n        ;;\r\n  stop)\r\n        [ \"$VERBOSE\" != no ] && log_daemon_msg \"Stopping $DESC\" \"$NAME\"\r\n        do_stop\r\n        case \"$?\" in\r\n                0|1) [ \"$VERBOSE\" != no ] && log_end_msg 0 ;;\r\n                2) [ \"$VERBOSE\" != no ] && log_end_msg 1 ;;\r\n        esac\r\n        ;;\r\n  status)\r\n       status_of_proc \"$WRAPPER\" \"$NAME\" && exit 0 || exit $?\r\n       ;;\r\n  #reload|force-reload)\r\n        #\r\n        # If do_reload() is not implemented then leave this commented out\r\n        # and leave 'force-reload' as an alias for 'restart'.\r\n        #\r\n        #log_daemon_msg \"Reloading $DESC\" \"$NAME\"\r\n        #do_reload\r\n        #log_end_msg $?\r\n        #;;\r\n  restart|force-reload)\r\n        #\r\n        # If the \"reload\" option is implemented then remove the\r\n        # 'force-reload' alias\r\n        #\r\n        log_daemon_msg \"Restarting $DESC\" \"$NAME\"\r\n        do_test\r\n        case \"$?\" in\r\n                0) ;;\r\n                *)\r\n                        log_end_msg 1  # Old process is still running\r\n                        exit 1\r\n                        ;;\r\n        esac\r\n\r\n        do_stop\r\n        case \"$?\" in\r\n          0|1)\r\n                do_start\r\n                case \"$?\" in\r\n                        0) log_end_msg 0 ;;\r\n                        1) log_end_msg 1 ;; # Old process is still running\r\n                        *) log_end_msg 1 ;; # Failed to start\r\n                esac\r\n                ;;\r\n          *)\r\n                # Failed to stop\r\n                log_end_msg 1\r\n                ;;\r\n        esac\r\n        ;;\r\n  *)\r\n        #echo \"Usage: $SCRIPTNAME {start|stop|restart|reload|force-reload}\" >&2\r\n        echo \"Usage: $SCRIPTNAME {start|stop|status|restart|force-reload}\" >&2\r\n        exit 3\r\n        ;;\r\nesac\r\n\r\n:\r\n```\r\n\r\n##### RELATED\r\nThis issue seems related to #42309\r\n\r\n\r\n##### HINTS\r\n```use: service``` seems to workaround the issue.\r\n\r\nAlso, bisecting between v2.5.9 (good) and v2.6.0 (bad) give:\r\n```\r\ncc61c860492d3165a68b4c3361bac900d29613d2 is the first bad commit\r\ncommit cc61c860492d3165a68b4c3361bac900d29613d2\r\nAuthor: Adam Miller <admiller@redhat.com>\r\nDate:   Thu May 17 17:32:27 2018 -0500\r\n\r\n    sysvinit service module (#34962)\r\n    \r\n    * sysvinit service module\r\n    \r\n    Signed-off-by: Adam Miller <admiller@redhat.com>\r\n\r\n lib/ansible/module_utils/service.py    |  29 ++-\r\n lib/ansible/modules/system/sysvinit.py | 350 +++++++++++++++++++++++++++++++++\r\n 2 files changed, 377 insertions(+), 2 deletions(-)\r\n create mode 100644 lib/ansible/modules/system/sysvinit.py\r\n```\r\n\r\n",
        "created_at": "2020-04-04T22:11:51Z",
        "user": "jeanfabrice",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 68685,
        "title": "ansible-test doesn't recognize modules written in bash",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nansible-test doesn't recognize modules written in bash\r\nI am trying to work with migrating RHEL system roles to collection and there is a module named `timesync_provider.sh` \r\nAfter migrating and running `ansible-test sanity` on the collection root I am seeing the below error\r\n\r\n```\r\nERROR: Found 1 shebang issue(s) which need to be resolved:\r\nERROR: plugins/modules/timesync_provider.sh:0:0: expected module extension \"\" or \".py\" or \".ps1\" but found: .sh\r\n\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nansible-test\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/abehl/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.5 (default, Oct 17 2019, 12:09:47) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n- Migrate a bash module to a new collection\r\n- Run `ansible-test sanity` on the collection\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nbash modules should be recognized as well like `.py` and `.ps1`\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nBash module is not recognized\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nRunning sanity test 'shebang' with Python 3.7\r\nERROR: Found 1 shebang issue(s) which need to be resolved:\r\nERROR: plugins/modules/timesync_provider.sh:0:0: expected module extension \"\" or \".py\" or \".ps1\" but found: .sh\r\n```\r\n\r\ncc: @mattclay ",
        "created_at": "2020-04-03T19:07:18Z",
        "user": "anshulbehl",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 68680,
        "title": "Systemd needs to be runned twice to mask enabled service",
        "body": "##### SUMMARY\r\n\r\nMask and enabled operations are actually mutually exclusive ones. So if service is enabled, it can't be masked at the same time. This leads to neccesity to launch systemd module twice to disable and mask service (or vice versa).\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nsystemd\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n(ansible) [root@fedora fedora]# ansible --version\r\nansible 2.9.6\r\n  config file = /root/.ansible.cfg\r\n  configured module search path = ['/root/.ansible/roles/config_template/library', '/root/.ansible/plugins/library', '/root/.ansible/roles/ceph-ansible/library']\r\n  ansible python module location = /home/fedora/ansible/lib64/python3.7/site-packages/ansible\r\n  executable location = /home/fedora/ansible/bin/ansible\r\n  python version = 3.7.6 (default, Jan 30 2020, 10:29:04) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\n(ansible) [root@fedora fedora]# \r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n(ansible) [root@fedora fedora]# ansible-config dump --only-changed\r\n(ansible) [root@fedora fedora]# \r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nDoesn't matter\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nTry do mask and disable currently enabld service\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n    -   systemd:\r\n          name: ctrl-alt-del.target\r\n          enabled: no\r\n          masked: yes\r\n          daemon_reload: yes\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nExpected that service will be disabled and masked after running playbook\r\n```\r\n(ansible) [root@fedora fedora]# systemctl is-enabled ctrl-alt-del.target\r\nmasked\r\n(ansible) [root@fedora fedora]# \r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nModule tries to mask enabled package wich actually results in failure and after that it just disables it. Next run of the playbook will mask already disabled service.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n(ansible) [root@fedora fedora]# systemctl is-enabled ctrl-alt-del.target                                  \r\nenabled\r\n(ansible) [root@fedora fedora]#\r\n(ansible) [root@fedora fedora]# ansible-playbook test.yml  -e ansible_python_interpreter=/usr/bin/python3 -vvv    \r\nansible-playbook 2.9.6\r\n  config file = /root/.ansible.cfg\r\n  configured module search path = ['/root/.ansible/roles/config_template/library', '/root/.ansible/plugins/library', '/root/.ansible/roles/ceph-ansible/library']                                                                                         \r\n  ansible python module location = /home/fedora/ansible/lib64/python3.7/site-packages/ansible\r\n  executable location = /home/fedora/ansible/bin/ansible-playbook\r\n  python version = 3.7.6 (default, Jan 30 2020, 10:29:04) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\nUsing /root/.ansible.cfg as config file\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n[WARNING]: Skipping plugin (/root/.ansible/plugins/callback/ara/callbacks/log_ara.py) as it seems to be invalid: No module\r\nnamed 'ara'\r\n\r\nPLAYBOOK: test.yml **********************************************************************************************************\r\n1 plays in test.yml\r\n\r\nPLAY [localhost] ************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************\r\ntask path: /home/fedora/test.yml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699 `\" && echo ansible-tmp-1585935657.640251-136830445580699=\"` echo /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699 `\" ) && sleep 0'                                                                                                        \r\nUsing module file /home/fedora/ansible/lib64/python3.7/site-packages/ansible/modules/system/setup.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-25506gvhlm36m/tmp4v2ujv0x TO /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699/AnsiballZ_setup.py                                                                                         \r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699/ /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699/AnsiballZ_setup.py && sleep 0'                                                  \r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699/AnsiballZ_setup.py && sleep 0'                                                                                                             \r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1585935657.640251-136830445580699/ > /dev/null 2>&1 && sleep 0'                                                                                                                      \r\nok: [localhost]\r\nMETA: ran handlers\r\n\r\nTASK [systemd] **************************************************************************************************************\r\ntask path: /home/fedora/test.yml:4\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538 `\" && echo ansible-tmp-1585935658.8976514-35489627107538=\"` echo /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538 `\" ) && sleep 0'                                                                                                        \r\nUsing module file /home/fedora/ansible/lib64/python3.7/site-packages/ansible/modules/system/systemd.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-25506gvhlm36m/tmp5c2yqdqo TO /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538/AnsiballZ_systemd.py                                                                                       \r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538/ /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538/AnsiballZ_systemd.py && sleep 0'                                                \r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538/AnsiballZ_systemd.py && sleep 0'                                                                                                           \r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1585935658.8976514-35489627107538/ > /dev/null 2>&1 && sleep 0'                                                                                                                      \r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"enabled\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"daemon_reexec\": false,\r\n            \"daemon_reload\": true,\r\n            \"enabled\": false,\r\n            \"force\": null,\r\n            \"masked\": true,\r\n            \"name\": \"ctrl-alt-del.target\",\r\n            \"no_block\": false,\r\n            \"scope\": null,\r\n            \"state\": null,\r\n            \"user\": null\r\n        }\r\n    },\r\n    \"name\": \"ctrl-alt-del.target\",\r\n    \"status\": {\r\n        \"ActiveEnterTimestampMonotonic\": \"0\",\r\n        \"ActiveExitTimestampMonotonic\": \"0\",\r\n        \"ActiveState\": \"inactive\",\r\n        \"After\": \"systemd-reboot.service\",\r\n        \"AllowIsolate\": \"yes\",\r\n        \"AssertResult\": \"no\",\r\n        \"AssertTimestampMonotonic\": \"0\",\r\n        \"CanIsolate\": \"yes\",\r\n        \"CanReload\": \"no\",\r\n        \"CanStart\": \"yes\",\r\n        \"CanStop\": \"yes\",\r\n        \"CollectMode\": \"inactive\",\r\n        \"ConditionResult\": \"no\",\r\n        \"ConditionTimestampMonotonic\": \"0\",\r\n        \"DefaultDependencies\": \"no\",\r\n        \"Description\": \"Reboot\",\r\n        \"Documentation\": \"man:systemd.special(7)\",\r\n        \"FailureAction\": \"none\",\r\n        \"FailureActionExitStatus\": \"-1\",\r\n        \"FragmentPath\": \"/usr/lib/systemd/system/reboot.target\",\r\n        \"Id\": \"reboot.target\",\r\n        \"IgnoreOnIsolate\": \"no\",\r\n        \"InactiveEnterTimestampMonotonic\": \"0\",\r\n        \"InactiveExitTimestampMonotonic\": \"0\",\r\n        \"JobRunningTimeoutUSec\": \"30min\",\r\n        \"JobTimeoutAction\": \"reboot-force\",\r\n        \"JobTimeoutUSec\": \"30min\",\r\n        \"LoadState\": \"loaded\",\r\n        \"Names\": \"ctrl-alt-del.target reboot.target\",\r\n        \"NeedDaemonReload\": \"no\",\r\n        \"OnFailureJobMode\": \"replace\",\r\n        \"Perpetual\": \"no\",\r\n        \"RefuseManualStart\": \"no\",\r\n        \"RefuseManualStop\": \"no\",\r\n        \"Requires\": \"systemd-reboot.service\",\r\n        \"StartLimitAction\": \"none\",\r\n        \"StartLimitBurst\": \"5\",\r\n        \"StartLimitIntervalUSec\": \"10s\",\r\n        \"StateChangeTimestampMonotonic\": \"0\",\r\n        \"StopWhenUnneeded\": \"no\",\r\n        \"SubState\": \"dead\",\r\n        \"SuccessAction\": \"none\",\r\n        \"SuccessActionExitStatus\": \"-1\",\r\n        \"Transient\": \"no\",\r\n        \"UnitFilePreset\": \"enabled\",\r\n        \"UnitFileState\": \"enabled\"\r\n    }\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ******************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n(ansible) [root@fedora fedora]# systemctl is-enabled ctrl-alt-del.target                                              \r\ndisabled\r\n(ansible) [root@fedora fedora]# ansible-playbook test.yml  -e ansible_python_interpreter=/usr/bin/python3 -vvv\r\nansible-playbook 2.9.6\r\n  config file = /root/.ansible.cfg\r\n  configured module search path = ['/root/.ansible/roles/config_template/library', '/root/.ansible/plugins/library', '/root/.ansible/roles/ceph-ansible/library']                                                                                         \r\n  ansible python module location = /home/fedora/ansible/lib64/python3.7/site-packages/ansible\r\n  executable location = /home/fedora/ansible/bin/ansible-playbook\r\n  python version = 3.7.6 (default, Jan 30 2020, 10:29:04) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\nUsing /root/.ansible.cfg as config file\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n[WARNING]: Skipping plugin (/root/.ansible/plugins/callback/ara/callbacks/log_ara.py) as it seems to be invalid: No module\r\nnamed 'ara'\r\n\r\nPLAYBOOK: test.yml **********************************************************************************************************\r\n1 plays in test.yml\r\n\r\nPLAY [localhost] ************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************\r\ntask path: /home/fedora/test.yml:2\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539 `\" && echo ansible-tmp-1585935679.585976-197976670952539=\"` echo /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539 `\" ) && sleep 0'                                                                                                        \r\nUsing module file /home/fedora/ansible/lib64/python3.7/site-packages/ansible/modules/system/setup.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-25757r28e02zx/tmp9wba6qxt TO /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539/AnsiballZ_setup.py                                                                                         \r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539/ /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539/AnsiballZ_setup.py && sleep 0'                                                  \r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539/AnsiballZ_setup.py && sleep 0'                                                                                                             \r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1585935679.585976-197976670952539/ > /dev/null 2>&1 && sleep 0'                                                                                                                      \r\nok: [localhost]\r\nMETA: ran handlers\r\n\r\nTASK [systemd] **************************************************************************************************************\r\ntask path: /home/fedora/test.yml:4\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783 `\" && echo ansible-tmp-1585935680.8203676-175635629303783=\"` echo /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783 `\" ) && sleep 0'                                                                                                     \r\nUsing module file /home/fedora/ansible/lib64/python3.7/site-packages/ansible/modules/system/systemd.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-25757r28e02zx/tmpwc4jtut6 TO /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783/AnsiballZ_systemd.py                                                                                      \r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783/ /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783/AnsiballZ_systemd.py && sleep 0'                                              \r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783/AnsiballZ_systemd.py && sleep 0'                                                                                                          \r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1585935680.8203676-175635629303783/ > /dev/null 2>&1 && sleep 0'                                                                                                                     \r\nchanged: [localhost] => {\r\n    \"changed\": true,\r\n    \"enabled\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"daemon_reexec\": false,\r\n            \"daemon_reload\": true,\r\n            \"enabled\": false,\r\n            \"force\": null,\r\n            \"masked\": true,\r\n            \"name\": \"ctrl-alt-del.target\",\r\n            \"no_block\": false,\r\n            \"scope\": null,\r\n            \"state\": null,\r\n            \"user\": null\r\n        }\r\n    },\r\n    \"name\": \"ctrl-alt-del.target\",\r\n    \"status\": {\r\n        \"ActiveEnterTimestampMonotonic\": \"0\",\r\n        \"ActiveExitTimestampMonotonic\": \"0\",\r\n        \"ActiveState\": \"inactive\",\r\n        \"After\": \"systemd-reboot.service\",\r\n        \"AllowIsolate\": \"yes\",\r\n        \"AssertResult\": \"no\",\r\n        \"AssertTimestampMonotonic\": \"0\",\r\n        \"CanIsolate\": \"yes\",\r\n        \"CanReload\": \"no\",\r\n        \"CanStart\": \"yes\",\r\n        \"CanStop\": \"yes\",\r\n        \"CollectMode\": \"inactive\",\r\n        \"ConditionResult\": \"no\",\r\n        \"ConditionTimestampMonotonic\": \"0\",\r\n        \"DefaultDependencies\": \"no\",\r\n        \"Description\": \"Reboot\",\r\n        \"Documentation\": \"man:systemd.special(7)\",\r\n        \"FailureAction\": \"none\",\r\n        \"FailureActionExitStatus\": \"-1\",\r\n        \"FragmentPath\": \"/usr/lib/systemd/system/reboot.target\",\r\n        \"Id\": \"reboot.target\",\r\n        \"IgnoreOnIsolate\": \"no\",\r\n        \"InactiveEnterTimestampMonotonic\": \"0\",\r\n        \"InactiveExitTimestampMonotonic\": \"0\",\r\n        \"JobRunningTimeoutUSec\": \"30min\",\r\n        \"JobTimeoutAction\": \"reboot-force\",\r\n        \"JobTimeoutUSec\": \"30min\",\r\n        \"LoadState\": \"loaded\",\r\n        \"Names\": \"ctrl-alt-del.target reboot.target\",\r\n        \"NeedDaemonReload\": \"no\",\r\n        \"OnFailureJobMode\": \"replace\",\r\n        \"Perpetual\": \"no\",\r\n        \"RefuseManualStart\": \"no\",\r\n        \"RefuseManualStop\": \"no\",\r\n        \"Requires\": \"systemd-reboot.service\",\r\n        \"StartLimitAction\": \"none\",\r\n        \"StartLimitBurst\": \"5\",\r\n        \"StartLimitIntervalUSec\": \"10s\",\r\n        \"StateChangeTimestampMonotonic\": \"0\",\r\n        \"StopWhenUnneeded\": \"no\",\r\n        \"SubState\": \"dead\",\r\n        \"SuccessAction\": \"none\",\r\n        \"SuccessActionExitStatus\": \"-1\",\r\n        \"Transient\": \"no\",\r\n        \"UnitFilePreset\": \"enabled\",\r\n        \"UnitFileState\": \"disabled\"\r\n    }\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ******************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n(ansible) [root@fedora fedora]# systemctl is-enabled ctrl-alt-del.target\r\nmasked\r\n(ansible) [root@fedora fedora]# \r\n```\r\n",
        "created_at": "2020-04-03T18:13:02Z",
        "user": "noonedeadpunk",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 68676,
        "title": "Ansible creates locked user on Alpine",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nI'm creating an user via ansible. This works on Debian based system like Ubuntu 16, 18, Raspbian, Debian.\r\n\r\nThe same tasks don't work on Alpine Linux. The user is created but no login is possible. Die user is locked.\r\n\r\nThis issue is maybe related to #61911 and #66679.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/modules/system/user.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.9.6\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/florian/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.6/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.9 (default, Nov  7 2019, 10:44:02) [GCC 8.3.0]\r\n```\r\nI had the same problem on 2.9.5\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/etc/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=5m\r\nDEFAULT_CALLBACK_WHITELIST(/etc/ansible/ansible.cfg) = ['timer', 'profile_tasks', 'profile_roles']\r\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 20\r\nDEFAULT_STRATEGY_PLUGIN_PATH(/etc/ansible/ansible.cfg) = ['/usr/local/lib/python3.6/dist-packages/ansible_mitogen/plugins/strategy\\nstrategy = mitogen_linear']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTarget:\r\nAlpine 3.11.5\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: \"create user\"\r\n  user:\r\n    name: testuser\r\n    shell: /bin/ash\r\n  become: true\r\n\r\n- name: \"Set up authorized key\"\r\n  authorized_key:\r\n    user: testuser\r\n    state: present\r\n    key: '{{ item }}'\r\n  with_file:\r\n    - ssh.publickey\r\n  become: true\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nUser is created and it is possible to login.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nUser is created and it is not possible to login.",
        "created_at": "2020-04-03T16:34:49Z",
        "user": "FloMiau",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "system",
            "collection",
            "affects_2.9"
        ]
    },
    {
        "number": 68640,
        "title": "Clearing extent flag not supported on <FILE>",
        "body": "##### SUMMARY\r\nWhen trying to copy files to a machine with extended attributes enabled, sometimes the backup files get the extended attribute, which the copy module tries to delete and produces a \r\n\"Clearing extent flag not supported\" error\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ncopy module\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.9.2\r\n  config file = /home/pallinger/dsd-ansible/ansible.cfg\r\n  configured module search path = [u'/home/pallinger/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.16 (default, Oct 10 2019, 22:02:15) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n```paste below\r\nDEFAULT_REMOTE_USER(/home/pallinger/dsd-ansible/ansible.cfg) = root\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n- Debian 10 on controller\r\n- Debian 7 VM on target\r\n  - ext4 filesystem mounted with options: (rw,relatime,errors=remount-ro,user_xattr,acl,barrier=1,data=ordered)\r\n\r\n##### STEPS TO REPRODUCE\r\nTry to copy some files with the copy module to a server with user_xattr enabled. On the current server, all new files seem to be created with the extent attribute.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: install scripts in /usr/local/sbin/                                                                                                               \r\n  copy:                                                                                                                                                               \r\n    src: usr_local_sbin/\r\n    dest: /usr/local/sbin/\r\n    backup: true\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nThere should be no error, at most a warning. \r\n\r\nThe extent flag has no bearing on access rights or anything else, really, and while the operating system does not support removing it, it also does not change anything other than chattr behaviour, so it should not be considered an error.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [common : install scripts in /usr/local/sbin/] ******************************************************************************************************\r\ntask path: /<REDACTED>/common/tasks/main.yml:26\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: Exception: Error while setting attributes: /usr/bin/chattr: Clearing extent flag not supported on /usr/local/sbin/tinc_supervisor.sh.24108.2020-04-02@15:30:58~\r\nfatal: [<REDACTED>]: FAILED! => {\"changed\": false, \"checksum\": \"56e89210d1f62bb6b080de583104216d0ebd1b1d\", \"details\": \"Error while setting attributes: /usr/bin/chattr: Clearing extent flag not supported on /usr/local/sbin/tinc_supervisor.sh.24108.2020-04-02@15:30:58~\\n\", \"gid\": 0, \"group\": \"root\", \"mode\": \"0755\", \"msg\": \"chattr failed\", \"owner\": \"root\", \"path\": \"/usr/local/sbin/tinc_supervisor.sh.24108.2020-04-02@15:30:58~\", \"size\": 445, \"state\": \"file\", \"uid\": 0}\r\n```\r\n",
        "created_at": "2020-04-02T14:01:42Z",
        "user": "pallinger",
        "labels": [
            "module",
            "plugin",
            "support:core",
            "bug",
            "traceback",
            "P3",
            "needs_verified",
            "files",
            "affects_2.9"
        ]
    },
    {
        "number": 68599,
        "title": "YUM groupremove is not idempotent",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nI have this task, that runs OK the first time:\r\n\r\n\r\n```yaml\r\n- name: Ensure X Window System is not installed (Scored)\r\n  yum:\r\n    name:\r\n      - \"@X Window System\"\r\n      - \"@Server with GUI\"\r\n    state: absent\r\n```\r\n\r\nBut the second time that my playbook runs it gives me the error:\r\n\r\n```json\r\nfatal: [redhat7]: FAILED! => {\r\n    \"changed\": false,\r\n    \"changes\": {\r\n        \"removed\": [\r\n            \"@Server with GUI\"\r\n        ]\r\n    },\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"allow_downgrade\": false,\r\n            \"autoremove\": false,\r\n            \"bugfix\": false,\r\n            \"conf_file\": null,\r\n            \"disable_excludes\": null,\r\n            \"disable_gpg_check\": false,\r\n            \"disable_plugin\": [],\r\n            \"disablerepo\": [],\r\n            \"download_dir\": null,\r\n            \"download_only\": false,\r\n            \"enable_plugin\": [],\r\n            \"enablerepo\": [],\r\n            \"exclude\": [],\r\n            \"install_repoquery\": true,\r\n            \"install_weak_deps\": true,\r\n            \"installroot\": \"/\",\r\n            \"list\": null,\r\n            \"lock_timeout\": 30,\r\n            \"name\": [\r\n                \"@X Window System\",\r\n                \"@Server with GUI\"\r\n            ],\r\n            \"releasever\": null,\r\n            \"security\": false,\r\n            \"skip_broken\": false,\r\n            \"state\": \"absent\",\r\n            \"update_cache\": false,\r\n            \"update_only\": false,\r\n            \"use_backend\": \"auto\",\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"msg\": \"Package '@Server with GUI' couldn't be removed!\",\r\n    \"rc\": 0,\r\n    \"results\": [\r\n        \"@X Window System is not installed\",\r\n        \"Loaded plugins: langpacks, ovl, product-id, search-disabled-repos, subscription-\\n              : manager\\nNo Packages marked for removal\\n\"\r\n    ]\r\n}\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nI believe is: lib/ansible/modules/packaging/os/yum.py \r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```shell\r\nansible --version\r\nansible 2.9.4\r\n  config file = None\r\n  configured module search path = ['~/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = ~/.virtualenvs/ca-env/lib/python3.7/site-packages/ansible\r\n  executable location = ~/.virtualenvs/ca-env/bin/ansible\r\n  python version = 3.7.6 (default, Dec 30 2019, 19:38:28) [Clang 11.0.0 (clang-1100.0.33.16)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTARGET: RHEL7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Ensure X Window System is not installed (Scored)\r\n  yum:\r\n    name:\r\n      - \"@X Window System\"\r\n      - \"@Server with GUI\"\r\n    state: absent\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nIf the YUM group is NOT installed, I expect do not generate an error and marked the task as ok on the second run.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```json\r\n\"results\": [\r\n        \"@X Window System is not installed\",\r\n        \"Loaded plugins: langpacks, ovl, product-id, search-disabled-repos, subscription-\\n              : manager\\nNo Packages marked for removal\\n\"\r\n    ]\r\n\r\n```\r\n",
        "created_at": "2020-03-31T21:23:03Z",
        "user": "luiscachog",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "packaging",
            "collection",
            "affects_2.9"
        ]
    },
    {
        "number": 68365,
        "title": "Some way to customize junit callback plugin in ansible-test run for a collection",
        "body": "##### SUMMARY\r\nI would like to customize the junit test data from running `ansible-test` in a collection. It does not seem to let me do this.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nansible-test\r\njunit callback plugin\r\n\r\n##### ADDITIONAL INFORMATION\r\nI would like to integrate the junit output from `ansible-test integration` into Jenkins. We are running `ansible-test` for our collection. That means that we build and install `awx.awx`, then cd into `<install location>/ansible_collections/awx/awx` and run `ansible-test integration`.\r\n\r\nThe reported names of our tests are shockingly long.\r\n\r\n```\r\n/usr/share/ansible/collections/ansible_collections/awx/awx/tests/output/.tmp/integration/demo_data-ik89ppto-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/demo_data/tasks/main\r\n```\r\n\r\nThat's the root-level name. The full test path looks something like:\r\n\r\n> /usr/share/ansible/collections/ansible_collections/awx/awx/tests/output/.tmp/integration/demo_data-ik89ppto-\u00c5\u00d1\u015a\u00cc\u03b2\u0141\u00c8/tests/integration/targets/demo_data/tasks/main.yml:19.[testhost] testhost: demo_data : Assure that demo job template exists name=Demo Job Template, project=Demo Project, inventory=Demo Inventory, playbook=hello_world.yml\r\n\r\nThis does not play nice with Jenkins.\r\n\r\nSeveral problems in here have already been solved, but we can't use them:\r\n\r\nhttps://github.com/ansible/ansible/blob/308723c3ca1122363e419070f1fa1d76ff5611a9/lib/ansible/plugins/callback/junit.py#L151\r\n\r\nhttps://github.com/ansible/ansible/blob/308723c3ca1122363e419070f1fa1d76ff5611a9/lib/ansible/plugins/callback/junit.py#L155\r\n\r\nYes, please! I want both of these settings turned on.\r\n\r\nIf I set these and run `ansible-test`, it does not take effect, because apparently `ansible-test` strips out the environment.\r\n\r\nI would like some way to set these, and thus, clean up my test data. I asked on IRC and got no indications that there is something available for this, and after diving into the test code, the closest I found are these [plugins](https://github.com/ansible/ansible/tree/482885e0c8ebc9554ae5eb81dce67253f64455f2/test/lib/ansible_test/config), but function is very unclear, and I don't see how that would translate to a collection test, if it's even relevant at all.",
        "created_at": "2020-03-20T12:42:32Z",
        "user": "AlanCoding",
        "labels": [
            "support:core",
            "feature",
            "affects_2.17"
        ]
    },
    {
        "number": 68005,
        "title": "unrelated variables get evaluated in set_fact every time resulting in high CPU load",
        "body": "##### SUMMARY\r\nI use the following:\r\n```\r\ngroup_vars/all.yaml:ansible_become_pass: \"{{ lookup('passwordstore', 'sudo') }}\"\r\n```\r\n\r\nThis allows to get the sudo password via pass.\r\n\r\nNow I found out, that, when using set_fact in a loop, that task produced high CPU load. -vvv does not show why but when killing the gpg-agent, it gives the error:\r\n```\r\nAn unhandled exception occurred while running the lookup plugin 'passwordstore'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Command '['pass', 'sudo']' returned non-zero exit status 2.\r\n```\r\n\r\nSo it seems that this variable is evaluated every time in the loop.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ncore\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.9.4\r\n  config file = /home/klaus/devel/ansible/ansible.cfg\r\n  configured module search path = ['/home/klaus/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.6 (default, Jan 19 2020, 22:34:52) [GCC 9.2.1 20200117]\r\n```\r\n\r\n##### CONFIGURATION\r\niDoes not apply.\r\n\r\n##### OS / ENVIRONMENT\r\niDoes not apply but on Debian linux.\r\n\r\n##### STEPS TO REPRODUCE\r\nAdd the var above and use set_fact in a loop\r\n\r\n##### EXPECTED RESULTS\r\niFast run with no CPU load\r\n\r\n##### ACTUAL RESULTS\r\niVery high CPU load and the task runs very long.",
        "created_at": "2020-03-04T15:00:58Z",
        "user": "mowgli",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "P3",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 67964,
        "title": "Unexpected CLIXML in stderr output",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nHi,\r\nI'm using ansible v2.9.5 (the problem exists at least since version 2.9.1).\r\nThe issue:\r\nUsing the script module in order to execute scripts with escalated rights leads to unexpected output in stderr.\r\nIn ansible version 2.7.10 the behavior is as expected.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nscript\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/XXX/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/XXX/.local/lib/python2.7/site-packages/ansible\r\n  executable location = /home/XXX/.local/bin/ansible\r\n  python version = 2.7.15+ (default, Oct  7 2019, 17:39:04) [GCC 7.4.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEPRECATION_WARNINGS(/etc/ansible/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nWindows Server 2016\r\n64bit\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nSimply execute the following playbook.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nFile `site.yml`\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: no   \r\n  tasks:\r\n    - name: Execute Script with Escalated Rights\r\n      script: 'SomeScript.ps1'\r\n      become: yes\r\n```\r\nFile `SomeScript.ps1` is empty.\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\n<XXX> ESTABLISH WINRM CONNECTION FOR USER: Administrator on PORT 5986 TO XXX\r\nchecking if winrm_host XXX is an IPv6 address\r\n<XXX> WINRM CONNECT: transport=credssp endpoint=https://XXX:5986/wsman\r\n<XXX> WINRM OPEN SHELL: BE1C4CD1-2E3D-4E8B-A92A-840CB1D4D41A\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAAVQB3AEIAbABBAEgAUQBBAEwAUQBCAFQAQQBIAFEAQQBjAGcAQgBwAEEARwBNAEEAZABBAEIATgBBAEcAOABBAFoAQQBCAGwAQQBDAEEAQQBMAFEAQgBXAEEARwBVAEEAYwBnAEIAegBBAEcAawBBAGIAdwBCAHUAQQBDAEEAQQBUAEEAQgBoAEEASABRAEEAWgBRAEIAegBBAEgAUQBBAEMAZwBBAGsAQQBIAFEAQQBiAFEAQgB3AEEARgA4AEEAYwBBAEIAaABBAEgAUQBBAGEAQQBBAGcAQQBEADAAQQBJAEEAQgBiAEEARgBNAEEAZQBRAEIAegBBAEgAUQBBAFoAUQBCAHQAQQBDADQAQQBSAFEAQgB1AEEASABZAEEAYQBRAEIAeQBBAEcAOABBAGIAZwBCAHQAQQBHAFUAQQBiAGcAQgAwAEEARgAwAEEATwBnAEEANgBBAEUAVQBBAGUAQQBCAHcAQQBHAEUAQQBiAGcAQgBrAEEARQBVAEEAYgBnAEIAMgBBAEcAawBBAGMAZwBCAHYAQQBHADQAQQBiAFEAQgBsAEEARwA0AEEAZABBAEIAVwBBAEcARQBBAGMAZwBCAHAAQQBHAEUAQQBZAGcAQgBzAEEARwBVAEEAYwB3AEEAbwBBAEMAYwBBAEoAUQBCAFUAQQBFAFUAQQBUAFEAQgBRAEEAQwBVAEEASgB3AEEAcABBAEEAbwBBAEoAQQBCADAAQQBHADAAQQBjAEEAQQBnAEEARAAwAEEASQBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFAGsAQQBkAEEAQgBsAEEARwAwAEEASQBBAEEAdABBAEYAUQBBAGUAUQBCAHcAQQBHAFUAQQBJAEEAQgBFAEEARwBrAEEAYwBnAEIAbABBAEcATQBBAGQAQQBCAHYAQQBIAEkAQQBlAFEAQQBnAEEAQwAwAEEAVQBBAEIAaABBAEgAUQBBAGEAQQBBAGcAQQBDAFEAQQBkAEEAQgB0AEEASABBAEEAWAB3AEIAdwBBAEcARQBBAGQAQQBCAG8AQQBDAEEAQQBMAFEAQgBPAEEARwBFAEEAYgBRAEIAbABBAEMAQQBBAEoAdwBCAGgAQQBHADQAQQBjAHcAQgBwAEEARwBJAEEAYgBBAEIAbABBAEMAMABBAGQAQQBCAHQAQQBIAEEAQQBMAFEAQQB4AEEARABVAEEATwBBAEEAegBBAEQASQBBAE0AdwBBADUAQQBEAFEAQQBNAHcAQQA0AEEAQwA0AEEATQBRAEEAdABBAEQARQBBAE0AZwBBAHcAQQBEAGcAQQBNAFEAQQA0AEEARABrAEEATQB3AEEAdwBBAEQAVQBBAE0AZwBBADEAQQBEAGcAQQBNAFEAQQB4AEEAQwBjAEEAQwBnAEIAWABBAEgASQBBAGEAUQBCADAAQQBHAFUAQQBMAFEAQgBQAEEASABVAEEAZABBAEIAdwBBAEgAVQBBAGQAQQBBAGcAQQBDADAAQQBTAFEAQgB1AEEASABBAEEAZABRAEIAMABBAEUAOABBAFkAZwBCAHEAQQBHAFUAQQBZAHcAQgAwAEEAQwBBAEEASgBBAEIAMABBAEcAMABBAGMAQQBBAHUAQQBFAFkAQQBkAFEAQgBzAEEARwB3AEEAVABnAEIAaABBAEcAMABBAFoAUQBBAEsAQQBFAGsAQQBaAGcAQQBnAEEAQwBnAEEATABRAEIAdQBBAEcAOABBAGQAQQBBAGcAQQBDAFEAQQBQAHcAQQBwAEEAQwBBAEEAZQB3AEEAZwBBAEUAawBBAFoAZwBBAGcAQQBDAGcAQQBSAHcAQgBsAEEASABRAEEATABRAEIAVwBBAEcARQBBAGMAZwBCAHAAQQBHAEUAQQBZAGcAQgBzAEEARwBVAEEASQBBAEIATQBBAEUARQBBAFUAdwBCAFUAQQBFAFUAQQBXAEEAQgBKAEEARgBRAEEAUQB3AEIAUABBAEUAUQBBAFIAUQBBAGcAQQBDADAAQQBSAFEAQgB5AEEASABJAEEAYgB3AEIAeQBBAEUARQBBAFkAdwBCADAAQQBHAGsAQQBiAHcAQgB1AEEAQwBBAEEAVQB3AEIAcABBAEcAdwBBAFoAUQBCAHUAQQBIAFEAQQBiAEEAQgA1AEEARQBNAEEAYgB3AEIAdQBBAEgAUQBBAGEAUQBCAHUAQQBIAFUAQQBaAFEAQQBwAEEAQwBBAEEAZQB3AEEAZwBBAEcAVQBBAGUAQQBCAHAAQQBIAFEAQQBJAEEAQQBrAEEARQB3AEEAUQBRAEIAVABBAEYAUQBBAFIAUQBCAFkAQQBFAGsAQQBWAEEAQgBEAEEARQA4AEEAUgBBAEIARgBBAEMAQQBBAGYAUQBBAGcAQQBFAFUAQQBiAEEAQgB6AEEARwBVAEEASQBBAEIANwBBAEMAQQBBAFoAUQBCADQAQQBHAGsAQQBkAEEAQQBnAEEARABFAEEASQBBAEIAOQBBAEMAQQBBAGYAUQBBAD0A']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"C:\\\\Users\\\\Administrat\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT C:\\Users\\Administrator\\AppData\\Local\\Temp\\ansible-tmp-1583239438.1-120818930525811\r\n\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><Obj S=\"progress\" RefId=\"1\"><TNRef RefId=\"0\" /><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\nlooking for \"scripts/SomeScript.ps1\" at \"/home/ansible/XXX/Playbooks/Test/roles/TestRole/files/scripts/SomeScript.ps1\"\r\nlooking for \"scripts/SomeScript.ps1\" at \"/home/ansible/XXX/Playbooks/Test/roles/TestRole/scripts/SomeScript.ps1\"\r\n<XXX> PUT \"/home/ansible/XXX/Playbooks/Test/roles/TestRole/scripts/SomeScript.ps1\" TO \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\ansible-tmp-1583239438.1-120818930525811\\SomeScript.ps1\"\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'YgBlAGcAaQBuACAAewAKACQAcABhAHQAaAAgAD0AIAAnAEMAOgBcAFUAcwBlAHIAcwBcAEEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwAVABlAG0AcABcAGEAbgBzAGkAYgBsAGUALQB0AG0AcAAtADEANQA4ADMAMgAzADkANAAzADgALgAxAC0AMQAyADAAOAAxADgAOQAzADAANQAyADUAOAAxADEAXABTAG8AbQBlAFMAYwByAGkAcAB0AC4AcABzADEAJwAKACQARABlAGIAdQBnAFAAcgBlAGYAZQByAGUAbgBjAGUAIAA9ACAAIgBDAG8AbgB0AGkAbgB1AGUAIgAKACQARQByAHIAbwByAEEAYwB0AGkAbwBuAFAAcgBlAGYAZQByAGUAbgBjAGUAIAA9ACAAIgBTAHQAbwBwACIACgBTAGUAdAAtAFMAdAByAGkAYwB0AE0AbwBkAGUAIAAtAFYAZQByAHMAaQBvAG4AIAAyAAoAJABmAGQAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAQwByAGUAYQB0AGUAKAAkAHAAYQB0AGgAKQAKACQAcwBoAGEAMQAgAD0AIABbAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBTAEgAQQAxAEMAcgB5AHAAdABvAFMAZQByAHYAaQBjAGUAUAByAG8AdgBpAGQAZQByAF0AOgA6AEMAcgBlAGEAdABlACgAKQAKACQAYgB5AHQAZQBzACAAPQAgAEAAKAApACAAIwBpAG4AaQB0AGkAYQBsAGkAegBlACAAZgBvAHIAIABlAG0AcAB0AHkAIABmAGkAbABlACAAYwBhAHMAZQAKAH0ACgBwAHIAbwBjAGUAcwBzACAAewAKACQAYgB5AHQAZQBzACAAPQAgAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAkAGkAbgBwAHUAdAApAAoAJABzAGgAYQAxAC4AVAByAGEAbgBzAGYAbwByAG0AQgBsAG8AYwBrACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgALAAgACQAYgB5AHQAZQBzACwAIAAwACkAIAB8ACAATwB1AHQALQBOAHUAbABsAAoAJABmAGQALgBXAHIAaQB0AGUAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApAAoAfQAKAGUAbgBkACAAewAKACQAcwBoAGEAMQAuAFQAcgBhAG4AcwBmAG8AcgBtAEYAaQBuAGEAbABCAGwAbwBjAGsAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAMAApACAAfAAgAE8AdQB0AC0ATgB1AGwAbAAKACQAaABhAHMAaAAgAD0AIABbAFMAeQBzAHQAZQBtAC4AQgBpAHQAQwBvAG4AdgBlAHIAdABlAHIAXQA6ADoAVABvAFMAdAByAGkAbgBnACgAJABzAGgAYQAxAC4ASABhAHMAaAApAC4AUgBlAHAAbABhAGMAZQAoACIALQAiACwAIAAiACIAKQAuAFQAbwBMAG8AdwBlAHIASQBuAHYAYQByAGkAYQBuAHQAKAApAAoAJABmAGQALgBDAGwAbwBzAGUAKAApAAoAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAiAHsAIgAiAHMAaABhADEAIgAiADoAIgAiACQAaABhAHMAaAAiACIAfQAiAAoAfQA=']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"{\"sha1\":\"da39a3ee5e6\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT {\"sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\"}\r\n\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAASgBnAEIAagBBAEcAZwBBAFkAdwBCAHcAQQBDADQAQQBZAHcAQgB2AEEARwAwAEEASQBBAEEAMgBBAEQAVQBBAE0AQQBBAHcAQQBEAEUAQQBJAEEAQQArAEEAQwBBAEEASgBBAEIAdQBBAEgAVQBBAGIAQQBCAHMAQQBBAG8AQQBKAEEAQgBsAEEASABnAEEAWgBRAEIAagBBAEYAOABBAGQAdwBCAHkAQQBHAEUAQQBjAEEAQgB3AEEARwBVAEEAYwBnAEIAZgBBAEgATQBBAGQAQQBCAHkAQQBDAEEAQQBQAFEAQQBnAEEAQwBRAEEAYQBRAEIAdQBBAEgAQQBBAGQAUQBCADAAQQBDAEEAQQBmAEEAQQBnAEEARQA4AEEAZABRAEIAMABBAEMAMABBAFUAdwBCADAAQQBIAEkAQQBhAFEAQgB1AEEARwBjAEEAQwBnAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBBAGcAQQBEADAAQQBJAEEAQQBrAEEARwBVAEEAZQBBAEIAbABBAEcATQBBAFgAdwBCADMAQQBIAEkAQQBZAFEAQgB3AEEASABBAEEAWgBRAEIAeQBBAEYAOABBAGMAdwBCADAAQQBIAEkAQQBMAGcAQgBUAEEASABBAEEAYgBBAEIAcABBAEgAUQBBAEsAQQBCAEEAQQBDAGcAQQBJAGcAQgBnAEEARABBAEEAWQBBAEEAdwBBAEcAQQBBAE0AQQBCAGcAQQBEAEEAQQBJAGcAQQBwAEEAQwB3AEEASQBBAEEAeQBBAEMAdwBBAEkAQQBCAGIAQQBGAE0AQQBkAEEAQgB5AEEARwBrAEEAYgBnAEIAbgBBAEYATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBQAEEASABBAEEAZABBAEIAcABBAEcAOABBAGIAZwBCAHoAQQBGADAAQQBPAGcAQQA2AEEARgBJAEEAWgBRAEIAdABBAEcAOABBAGQAZwBCAGwAQQBFAFUAQQBiAFEAQgB3AEEASABRAEEAZQBRAEIARgBBAEcANABBAGQAQQBCAHkAQQBHAGsAQQBaAFEAQgB6AEEAQwBrAEEAQwBnAEIASgBBAEcAWQBBAEkAQQBBAG8AQQBDADAAQQBiAGcAQgB2AEEASABRAEEASQBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBBAHUAQQBFAHcAQQBaAFEAQgB1AEEARwBjAEEAZABBAEIAbwBBAEMAQQBBAEwAUQBCAGwAQQBIAEUAQQBJAEEAQQB5AEEAQwBrAEEASQBBAEIANwBBAEMAQQBBAGQAQQBCAG8AQQBIAEkAQQBiAHcAQgAzAEEAQwBBAEEASQBnAEIAcABBAEcANABBAGQAZwBCAGgAQQBHAHcAQQBhAFEAQgBrAEEAQwBBAEEAYwBBAEIAaABBAEgAawBBAGIAQQBCAHYAQQBHAEUAQQBaAEEAQQBpAEEAQwBBAEEAZgBRAEEASwBBAEYATQBBAFoAUQBCADAAQQBDADAAQQBWAGcAQgBoAEEASABJAEEAYQBRAEIAaABBAEcASQBBAGIAQQBCAGwAQQBDAEEAQQBMAFEAQgBPAEEARwBFAEEAYgBRAEIAbABBAEMAQQBBAGEAZwBCAHoAQQBHADgAQQBiAGcAQgBmAEEASABJAEEAWQBRAEIAMwBBAEMAQQBBAEwAUQBCAFcAQQBHAEUAQQBiAEEAQgAxAEEARwBVAEEASQBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBCAGIAQQBEAEUAQQBYAFEAQQBLAEEAQwBRAEEAWgBRAEIANABBAEcAVQBBAFkAdwBCAGYAQQBIAGMAQQBjAGcAQgBoAEEASABBAEEAYwBBAEIAbABBAEgASQBBAEkAQQBBADkAQQBDAEEAQQBXAHcAQgBUAEEARwBNAEEAYwBnAEIAcABBAEgAQQBBAGQAQQBCAEMAQQBHAHcAQQBiAHcAQgBqAEEARwBzAEEAWABRAEEANgBBAEQAbwBBAFEAdwBCAHkAQQBHAFUAQQBZAFEAQgAwAEEARwBVAEEASwBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBCAGIAQQBEAEEAQQBYAFEAQQBwAEEAQQBvAEEASgBnAEEAawBBAEcAVQBBAGUAQQBCAGwAQQBHAE0AQQBYAHcAQgAzAEEASABJAEEAWQBRAEIAdwBBAEgAQQBBAFoAUQBCAHkAQQBBAD0APQA=']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAAVQB3AEIAbABBAEgAUQBBAEwAUQBCAFQAQQBIAFEAQQBjAGcAQgBwAEEARwBNAEEAZABBAEIATgBBAEcAOABBAFoAQQBCAGwAQQBDAEEAQQBMAFEAQgBXAEEARwBVAEEAYwBnAEIAegBBAEcAawBBAGIAdwBCAHUAQQBDAEEAQQBUAEEAQgBoAEEASABRAEEAWgBRAEIAegBBAEgAUQBBAEMAZwBCAFMAQQBHAFUAQQBiAFEAQgB2AEEASABZAEEAWgBRAEEAdABBAEUAawBBAGQAQQBCAGwAQQBHADAAQQBJAEEAQQBpAEEARQBNAEEATwBnAEIAYwBBAEYAVQBBAGMAdwBCAGwAQQBIAEkAQQBjAHcAQgBjAEEARQBFAEEAWgBBAEIAdABBAEcAawBBAGIAZwBCAHAAQQBIAE0AQQBkAEEAQgB5AEEARwBFAEEAZABBAEIAdgBBAEgASQBBAFgAQQBCAEIAQQBIAEEAQQBjAEEAQgBFAEEARwBFAEEAZABBAEIAaABBAEYAdwBBAFQAQQBCAHYAQQBHAE0AQQBZAFEAQgBzAEEARgB3AEEAVgBBAEIAbABBAEcAMABBAGMAQQBCAGMAQQBHAEUAQQBiAGcAQgB6AEEARwBrAEEAWQBnAEIAcwBBAEcAVQBBAEwAUQBCADAAQQBHADAAQQBjAEEAQQB0AEEARABFAEEATgBRAEEANABBAEQATQBBAE0AZwBBAHoAQQBEAGsAQQBOAEEAQQB6AEEARABnAEEATABnAEEAeABBAEMAMABBAE0AUQBBAHkAQQBEAEEAQQBPAEEAQQB4AEEARABnAEEATwBRAEEAegBBAEQAQQBBAE4AUQBBAHkAQQBEAFUAQQBPAEEAQQB4AEEARABFAEEASQBnAEEAZwBBAEMAMABBAFIAZwBCAHYAQQBIAEkAQQBZAHcAQgBsAEEAQwBBAEEATABRAEIAUwBBAEcAVQBBAFkAdwBCADEAQQBIAEkAQQBjAHcAQgBsAEEARABzAEEAQwBnAEIASgBBAEcAWQBBAEkAQQBBAG8AQQBDADAAQQBiAGcAQgB2AEEASABRAEEASQBBAEEAawBBAEQAOABBAEsAUQBBAGcAQQBIAHMAQQBJAEEAQgBKAEEARwBZAEEASQBBAEEAbwBBAEUAYwBBAFoAUQBCADAAQQBDADAAQQBWAGcAQgBoAEEASABJAEEAYQBRAEIAaABBAEcASQBBAGIAQQBCAGwAQQBDAEEAQQBUAEEAQgBCAEEARgBNAEEAVgBBAEIARgBBAEYAZwBBAFMAUQBCAFUAQQBFAE0AQQBUAHcAQgBFAEEARQBVAEEASQBBAEEAdABBAEUAVQBBAGMAZwBCAHkAQQBHADgAQQBjAGcAQgBCAEEARwBNAEEAZABBAEIAcABBAEcAOABBAGIAZwBBAGcAQQBGAE0AQQBhAFEAQgBzAEEARwBVAEEAYgBnAEIAMABBAEcAdwBBAGUAUQBCAEQAQQBHADgAQQBiAGcAQgAwAEEARwBrAEEAYgBnAEIAMQBBAEcAVQBBAEsAUQBBAGcAQQBIAHMAQQBJAEEAQgBsAEEASABnAEEAYQBRAEIAMABBAEMAQQBBAEoAQQBCAE0AQQBFAEUAQQBVAHcAQgBVAEEARQBVAEEAVwBBAEIASgBBAEYAUQBBAFEAdwBCAFAAQQBFAFEAQQBSAFEAQQBnAEEASAAwAEEASQBBAEIARgBBAEcAdwBBAGMAdwBCAGwAQQBDAEEAQQBlAHcAQQBnAEEARwBVAEEAZQBBAEIAcABBAEgAUQBBAEkAQQBBAHgAQQBDAEEAQQBmAFEAQQBnAEEASAAwAEEA']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\n<XXX> WINRM CLOSE SHELL: BE1C4CD1-2E3D-4E8B-A92A-840CB1D4D41A\r\n\r\nchanged: [XXX] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nThe task seems to be executed correctly.\r\n<!--- Paste verbatim command output between quotes -->\r\nI executed with -vvvvvv\r\n```paste below\r\n<XXX> ESTABLISH WINRM CONNECTION FOR USER: Administrator on PORT 5986 TO XXX\r\n<XXX> WINRM CONNECT: transport=credssp endpoint=https://XXX:5986/wsman\r\n<XXX> WINRM OPEN SHELL: D44AF5E4-E69E-4903-82C4-E14EE4583647\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAAVQB3AEIAbABBAEgAUQBBAEwAUQBCAFQAQQBIAFEAQQBjAGcAQgBwAEEARwBNAEEAZABBAEIATgBBAEcAOABBAFoAQQBCAGwAQQBDAEEAQQBMAFEAQgBXAEEARwBVAEEAYwBnAEIAegBBAEcAawBBAGIAdwBCAHUAQQBDAEEAQQBUAEEAQgBoAEEASABRAEEAWgBRAEIAegBBAEgAUQBBAEMAZwBBAGsAQQBIAFEAQQBiAFEAQgB3AEEARgA4AEEAYwBBAEIAaABBAEgAUQBBAGEAQQBBAGcAQQBEADAAQQBJAEEAQgBiAEEARgBNAEEAZQBRAEIAegBBAEgAUQBBAFoAUQBCAHQAQQBDADQAQQBSAFEAQgB1AEEASABZAEEAYQBRAEIAeQBBAEcAOABBAGIAZwBCAHQAQQBHAFUAQQBiAGcAQgAwAEEARgAwAEEATwBnAEEANgBBAEUAVQBBAGUAQQBCAHcAQQBHAEUAQQBiAGcAQgBrAEEARQBVAEEAYgBnAEIAMgBBAEcAawBBAGMAZwBCAHYAQQBHADQAQQBiAFEAQgBsAEEARwA0AEEAZABBAEIAVwBBAEcARQBBAGMAZwBCAHAAQQBHAEUAQQBZAGcAQgBzAEEARwBVAEEAYwB3AEEAbwBBAEMAYwBBAEoAUQBCAFUAQQBFAFUAQQBUAFEAQgBRAEEAQwBVAEEASgB3AEEAcABBAEEAbwBBAEoAQQBCADAAQQBHADAAQQBjAEEAQQBnAEEARAAwAEEASQBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFAGsAQQBkAEEAQgBsAEEARwAwAEEASQBBAEEAdABBAEYAUQBBAGUAUQBCAHcAQQBHAFUAQQBJAEEAQgBFAEEARwBrAEEAYwBnAEIAbABBAEcATQBBAGQAQQBCAHYAQQBIAEkAQQBlAFEAQQBnAEEAQwAwAEEAVQBBAEIAaABBAEgAUQBBAGEAQQBBAGcAQQBDAFEAQQBkAEEAQgB0AEEASABBAEEAWAB3AEIAdwBBAEcARQBBAGQAQQBCAG8AQQBDAEEAQQBMAFEAQgBPAEEARwBFAEEAYgBRAEIAbABBAEMAQQBBAEoAdwBCAGgAQQBHADQAQQBjAHcAQgBwAEEARwBJAEEAYgBBAEIAbABBAEMAMABBAGQAQQBCAHQAQQBIAEEAQQBMAFEAQQB4AEEARABVAEEATwBBAEEAegBBAEQASQBBAE0AdwBBADUAQQBEAFEAQQBNAHcAQQAzAEEAQwA0AEEATgBBAEEAdABBAEQARQBBAE4AUQBBADQAQQBEAGMAQQBNAGcAQQA1AEEARABJAEEATQB3AEEANABBAEQAZwBBAE4AZwBBADEAQQBEAFUAQQBNAFEAQQB6AEEAQwBjAEEAQwBnAEIAWABBAEgASQBBAGEAUQBCADAAQQBHAFUAQQBMAFEAQgBQAEEASABVAEEAZABBAEIAdwBBAEgAVQBBAGQAQQBBAGcAQQBDADAAQQBTAFEAQgB1AEEASABBAEEAZABRAEIAMABBAEUAOABBAFkAZwBCAHEAQQBHAFUAQQBZAHcAQgAwAEEAQwBBAEEASgBBAEIAMABBAEcAMABBAGMAQQBBAHUAQQBFAFkAQQBkAFEAQgBzAEEARwB3AEEAVABnAEIAaABBAEcAMABBAFoAUQBBAEsAQQBFAGsAQQBaAGcAQQBnAEEAQwBnAEEATABRAEIAdQBBAEcAOABBAGQAQQBBAGcAQQBDAFEAQQBQAHcAQQBwAEEAQwBBAEEAZQB3AEEAZwBBAEUAawBBAFoAZwBBAGcAQQBDAGcAQQBSAHcAQgBsAEEASABRAEEATABRAEIAVwBBAEcARQBBAGMAZwBCAHAAQQBHAEUAQQBZAGcAQgBzAEEARwBVAEEASQBBAEIATQBBAEUARQBBAFUAdwBCAFUAQQBFAFUAQQBXAEEAQgBKAEEARgBRAEEAUQB3AEIAUABBAEUAUQBBAFIAUQBBAGcAQQBDADAAQQBSAFEAQgB5AEEASABJAEEAYgB3AEIAeQBBAEUARQBBAFkAdwBCADAAQQBHAGsAQQBiAHcAQgB1AEEAQwBBAEEAVQB3AEIAcABBAEcAdwBBAFoAUQBCAHUAQQBIAFEAQQBiAEEAQgA1AEEARQBNAEEAYgB3AEIAdQBBAEgAUQBBAGEAUQBCAHUAQQBIAFUAQQBaAFEAQQBwAEEAQwBBAEEAZQB3AEEAZwBBAEcAVQBBAGUAQQBCAHAAQQBIAFEAQQBJAEEAQQBrAEEARQB3AEEAUQBRAEIAVABBAEYAUQBBAFIAUQBCAFkAQQBFAGsAQQBWAEEAQgBEAEEARQA4AEEAUgBBAEIARgBBAEMAQQBBAGYAUQBBAGcAQQBFAFUAQQBiAEEAQgB6AEEARwBVAEEASQBBAEIANwBBAEMAQQBBAFoAUQBCADQAQQBHAGsAQQBkAEEAQQBnAEEARABFAEEASQBBAEIAOQBBAEMAQQBBAGYAUQBBAD0A']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"C:\\\\Users\\\\Administrat\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT C:\\Users\\Administrator\\AppData\\Local\\Temp\\ansible-tmp-1583239437.4-158729238865513\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><Obj S=\"progress\" RefId=\"1\"><TNRef RefId=\"0\" /><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\nlooking for \"scripts/SomeScript.ps1\" at \"/home/XXX/Playbooks/Test/roles/TestRole/files/scripts/SomeScript.ps1\"\r\nlooking for \"scripts/SomeScript.ps1\" at \"/home/XXX/Playbooks/Test/roles/TestRole/scripts/SomeScript.ps1\"\r\n<XXX> PUT \"/home/XXX/Playbooks/Test/roles/TestRole/scripts/SomeScript.ps1\" TO \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\ansible-tmp-1583239437.4-158729238865513\\SomeScript.ps1\"\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'YgBlAGcAaQBuACAAewAKACQAcABhAHQAaAAgAD0AIAAnAEMAOgBcAFUAcwBlAHIAcwBcAEEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwAVABlAG0AcABcAGEAbgBzAGkAYgBsAGUALQB0AG0AcAAtADEANQA4ADMAMgAzADkANAAzADcALgA0AC0AMQA1ADgANwAyADkAMgAzADgAOAA2ADUANQAxADMAXABTAG8AbQBlAFMAYwByAGkAcAB0AC4AcABzADEAJwAKACQARABlAGIAdQBnAFAAcgBlAGYAZQByAGUAbgBjAGUAIAA9ACAAIgBDAG8AbgB0AGkAbgB1AGUAIgAKACQARQByAHIAbwByAEEAYwB0AGkAbwBuAFAAcgBlAGYAZQByAGUAbgBjAGUAIAA9ACAAIgBTAHQAbwBwACIACgBTAGUAdAAtAFMAdAByAGkAYwB0AE0AbwBkAGUAIAAtAFYAZQByAHMAaQBvAG4AIAAyAAoAJABmAGQAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAQwByAGUAYQB0AGUAKAAkAHAAYQB0AGgAKQAKACQAcwBoAGEAMQAgAD0AIABbAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBTAEgAQQAxAEMAcgB5AHAAdABvAFMAZQByAHYAaQBjAGUAUAByAG8AdgBpAGQAZQByAF0AOgA6AEMAcgBlAGEAdABlACgAKQAKACQAYgB5AHQAZQBzACAAPQAgAEAAKAApACAAIwBpAG4AaQB0AGkAYQBsAGkAegBlACAAZgBvAHIAIABlAG0AcAB0AHkAIABmAGkAbABlACAAYwBhAHMAZQAKAH0ACgBwAHIAbwBjAGUAcwBzACAAewAKACQAYgB5AHQAZQBzACAAPQAgAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAkAGkAbgBwAHUAdAApAAoAJABzAGgAYQAxAC4AVAByAGEAbgBzAGYAbwByAG0AQgBsAG8AYwBrACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgALAAgACQAYgB5AHQAZQBzACwAIAAwACkAIAB8ACAATwB1AHQALQBOAHUAbABsAAoAJABmAGQALgBXAHIAaQB0AGUAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApAAoAfQAKAGUAbgBkACAAewAKACQAcwBoAGEAMQAuAFQAcgBhAG4AcwBmAG8AcgBtAEYAaQBuAGEAbABCAGwAbwBjAGsAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAMAApACAAfAAgAE8AdQB0AC0ATgB1AGwAbAAKACQAaABhAHMAaAAgAD0AIABbAFMAeQBzAHQAZQBtAC4AQgBpAHQAQwBvAG4AdgBlAHIAdABlAHIAXQA6ADoAVABvAFMAdAByAGkAbgBnACgAJABzAGgAYQAxAC4ASABhAHMAaAApAC4AUgBlAHAAbABhAGMAZQAoACIALQAiACwAIAAiACIAKQAuAFQAbwBMAG8AdwBlAHIASQBuAHYAYQByAGkAYQBuAHQAKAApAAoAJABmAGQALgBDAGwAbwBzAGUAKAApAAoAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAiAHsAIgAiAHMAaABhADEAIgAiADoAIgAiACQAaABhAHMAaAAiACIAfQAiAAoAfQA=']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"{\"sha1\":\"da39a3ee5e6\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT {\"sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\"}\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAASgBnAEIAagBBAEcAZwBBAFkAdwBCAHcAQQBDADQAQQBZAHcAQgB2AEEARwAwAEEASQBBAEEAMgBBAEQAVQBBAE0AQQBBAHcAQQBEAEUAQQBJAEEAQQArAEEAQwBBAEEASgBBAEIAdQBBAEgAVQBBAGIAQQBCAHMAQQBBAG8AQQBKAEEAQgBsAEEASABnAEEAWgBRAEIAagBBAEYAOABBAGQAdwBCAHkAQQBHAEUAQQBjAEEAQgB3AEEARwBVAEEAYwBnAEIAZgBBAEgATQBBAGQAQQBCAHkAQQBDAEEAQQBQAFEAQQBnAEEAQwBRAEEAYQBRAEIAdQBBAEgAQQBBAGQAUQBCADAAQQBDAEEAQQBmAEEAQQBnAEEARQA4AEEAZABRAEIAMABBAEMAMABBAFUAdwBCADAAQQBIAEkAQQBhAFEAQgB1AEEARwBjAEEAQwBnAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBBAGcAQQBEADAAQQBJAEEAQQBrAEEARwBVAEEAZQBBAEIAbABBAEcATQBBAFgAdwBCADMAQQBIAEkAQQBZAFEAQgB3AEEASABBAEEAWgBRAEIAeQBBAEYAOABBAGMAdwBCADAAQQBIAEkAQQBMAGcAQgBUAEEASABBAEEAYgBBAEIAcABBAEgAUQBBAEsAQQBCAEEAQQBDAGcAQQBJAGcAQgBnAEEARABBAEEAWQBBAEEAdwBBAEcAQQBBAE0AQQBCAGcAQQBEAEEAQQBJAGcAQQBwAEEAQwB3AEEASQBBAEEAeQBBAEMAdwBBAEkAQQBCAGIAQQBGAE0AQQBkAEEAQgB5AEEARwBrAEEAYgBnAEIAbgBBAEYATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBQAEEASABBAEEAZABBAEIAcABBAEcAOABBAGIAZwBCAHoAQQBGADAAQQBPAGcAQQA2AEEARgBJAEEAWgBRAEIAdABBAEcAOABBAGQAZwBCAGwAQQBFAFUAQQBiAFEAQgB3AEEASABRAEEAZQBRAEIARgBBAEcANABBAGQAQQBCAHkAQQBHAGsAQQBaAFEAQgB6AEEAQwBrAEEAQwBnAEIASgBBAEcAWQBBAEkAQQBBAG8AQQBDADAAQQBiAGcAQgB2AEEASABRAEEASQBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBBAHUAQQBFAHcAQQBaAFEAQgB1AEEARwBjAEEAZABBAEIAbwBBAEMAQQBBAEwAUQBCAGwAQQBIAEUAQQBJAEEAQQB5AEEAQwBrAEEASQBBAEIANwBBAEMAQQBBAGQAQQBCAG8AQQBIAEkAQQBiAHcAQgAzAEEAQwBBAEEASQBnAEIAcABBAEcANABBAGQAZwBCAGgAQQBHAHcAQQBhAFEAQgBrAEEAQwBBAEEAYwBBAEIAaABBAEgAawBBAGIAQQBCAHYAQQBHAEUAQQBaAEEAQQBpAEEAQwBBAEEAZgBRAEEASwBBAEYATQBBAFoAUQBCADAAQQBDADAAQQBWAGcAQgBoAEEASABJAEEAYQBRAEIAaABBAEcASQBBAGIAQQBCAGwAQQBDAEEAQQBMAFEAQgBPAEEARwBFAEEAYgBRAEIAbABBAEMAQQBBAGEAZwBCAHoAQQBHADgAQQBiAGcAQgBmAEEASABJAEEAWQBRAEIAMwBBAEMAQQBBAEwAUQBCAFcAQQBHAEUAQQBiAEEAQgAxAEEARwBVAEEASQBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBCAGIAQQBEAEUAQQBYAFEAQQBLAEEAQwBRAEEAWgBRAEIANABBAEcAVQBBAFkAdwBCAGYAQQBIAGMAQQBjAGcAQgBoAEEASABBAEEAYwBBAEIAbABBAEgASQBBAEkAQQBBADkAQQBDAEEAQQBXAHcAQgBUAEEARwBNAEEAYwBnAEIAcABBAEgAQQBBAGQAQQBCAEMAQQBHAHcAQQBiAHcAQgBqAEEARwBzAEEAWABRAEEANgBBAEQAbwBBAFEAdwBCAHkAQQBHAFUAQQBZAFEAQgAwAEEARwBVAEEASwBBAEEAawBBAEgATQBBAGMAQQBCAHMAQQBHAGsAQQBkAEEAQgBmAEEASABBAEEAWQBRAEIAeQBBAEgAUQBBAGMAdwBCAGIAQQBEAEEAQQBYAFEAQQBwAEEAQQBvAEEASgBnAEEAawBBAEcAVQBBAGUAQQBCAGwAQQBHAE0AQQBYAHcAQgAzAEEASABJAEEAWQBRAEIAdwBBAEgAQQBBAFoAUQBCAHkAQQBBAD0APQA=']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"\\r\\n\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><S S=\"Error\">#&lt; CLIXML_x000D__x000A_&lt;Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"&gt;&lt;Obj S=\"progress\" RefId=\"0\"&gt;&lt;TN RefId=\"0\"&gt;&lt;T&gt;System.Management.Automation.PSCustomObject&lt;/T&gt;&lt;T&gt;System.Object&lt;/T&gt;&lt;/TN&gt;&lt;MS&gt;&lt;I64 N=\"SourceId\"&gt;1&lt;/I64&gt;&lt;PR N=\"Record\"&gt;&lt;AV&gt;Module werden f\ufffdr erstmalige Verwendung vorbereitet.&lt;/AV&gt;&lt;AI&gt;0&lt;/AI&gt;&lt;Nil /&gt;&lt;PI&gt;-1&lt;/PI&gt;&lt;PC&gt;-1&lt;/PC&gt;&lt;T&gt;Completed&lt;/T&gt;&lt;SR&gt;-1&lt;/SR&gt;&lt;SD&gt; &lt;/SD&gt;&lt;/PR&gt;&lt;/MS&gt;&lt;/Obj&gt;&lt;/Objs&gt;_x000D__x000A_</S></Objs>\r\nEXEC (via pipeline wrapper)\r\n<XXX> WINRM EXEC 'PowerShell' ['-NoProfile', '-NonInteractive', '-ExecutionPolicy', 'Unrestricted', '-EncodedCommand', u'UABvAHcAZQByAFMAaABlAGwAbAAgAC0ATgBvAFAAcgBvAGYAaQBsAGUAIAAtAE4AbwBuAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIABVAG4AcgBlAHMAdAByAGkAYwB0AGUAZAAgAC0ARQBuAGMAbwBkAGUAZABDAG8AbQBtAGEAbgBkACAAVQB3AEIAbABBAEgAUQBBAEwAUQBCAFQAQQBIAFEAQQBjAGcAQgBwAEEARwBNAEEAZABBAEIATgBBAEcAOABBAFoAQQBCAGwAQQBDAEEAQQBMAFEAQgBXAEEARwBVAEEAYwBnAEIAegBBAEcAawBBAGIAdwBCAHUAQQBDAEEAQQBUAEEAQgBoAEEASABRAEEAWgBRAEIAegBBAEgAUQBBAEMAZwBCAFMAQQBHAFUAQQBiAFEAQgB2AEEASABZAEEAWgBRAEEAdABBAEUAawBBAGQAQQBCAGwAQQBHADAAQQBJAEEAQQBpAEEARQBNAEEATwBnAEIAYwBBAEYAVQBBAGMAdwBCAGwAQQBIAEkAQQBjAHcAQgBjAEEARQBFAEEAWgBBAEIAdABBAEcAawBBAGIAZwBCAHAAQQBIAE0AQQBkAEEAQgB5AEEARwBFAEEAZABBAEIAdgBBAEgASQBBAFgAQQBCAEIAQQBIAEEAQQBjAEEAQgBFAEEARwBFAEEAZABBAEIAaABBAEYAdwBBAFQAQQBCAHYAQQBHAE0AQQBZAFEAQgBzAEEARgB3AEEAVgBBAEIAbABBAEcAMABBAGMAQQBCAGMAQQBHAEUAQQBiAGcAQgB6AEEARwBrAEEAWQBnAEIAcwBBAEcAVQBBAEwAUQBCADAAQQBHADAAQQBjAEEAQQB0AEEARABFAEEATgBRAEEANABBAEQATQBBAE0AZwBBAHoAQQBEAGsAQQBOAEEAQQB6AEEARABjAEEATABnAEEAMABBAEMAMABBAE0AUQBBADEAQQBEAGcAQQBOAHcAQQB5AEEARABrAEEATQBnAEEAegBBAEQAZwBBAE8AQQBBADIAQQBEAFUAQQBOAFEAQQB4AEEARABNAEEAWABBAEEAdQBBAEMASQBBAEkAQQBBAHQAQQBFAFkAQQBiAHcAQgB5AEEARwBNAEEAWgBRAEEAZwBBAEMAMABBAFUAZwBCAGwAQQBHAE0AQQBkAFEAQgB5AEEASABNAEEAWgBRAEEANwBBAEEAbwBBAFMAUQBCAG0AQQBDAEEAQQBLAEEAQQB0AEEARwA0AEEAYgB3AEIAMABBAEMAQQBBAEoAQQBBAC8AQQBDAGsAQQBJAEEAQgA3AEEAQwBBAEEAUwBRAEIAbQBBAEMAQQBBAEsAQQBCAEgAQQBHAFUAQQBkAEEAQQB0AEEARgBZAEEAWQBRAEIAeQBBAEcAawBBAFkAUQBCAGkAQQBHAHcAQQBaAFEAQQBnAEEARQB3AEEAUQBRAEIAVABBAEYAUQBBAFIAUQBCAFkAQQBFAGsAQQBWAEEAQgBEAEEARQA4AEEAUgBBAEIARgBBAEMAQQBBAEwAUQBCAEYAQQBIAEkAQQBjAGcAQgB2AEEASABJAEEAUQBRAEIAagBBAEgAUQBBAGEAUQBCAHYAQQBHADQAQQBJAEEAQgBUAEEARwBrAEEAYgBBAEIAbABBAEcANABBAGQAQQBCAHMAQQBIAGsAQQBRAHcAQgB2AEEARwA0AEEAZABBAEIAcABBAEcANABBAGQAUQBCAGwAQQBDAGsAQQBJAEEAQgA3AEEAQwBBAEEAWgBRAEIANABBAEcAawBBAGQAQQBBAGcAQQBDAFEAQQBUAEEAQgBCAEEARgBNAEEAVgBBAEIARgBBAEYAZwBBAFMAUQBCAFUAQQBFAE0AQQBUAHcAQgBFAEEARQBVAEEASQBBAEIAOQBBAEMAQQBBAFIAUQBCAHMAQQBIAE0AQQBaAFEAQQBnAEEASABzAEEASQBBAEIAbABBAEgAZwBBAGEAUQBCADAAQQBDAEEAQQBNAFEAQQBnAEEASAAwAEEASQBBAEIAOQBBAEEAPQA9AA==']\r\n<XXX> WINRM RESULT u'<Response code 0, out \"\", err \"#< CLIXML\\r\\n<Objs Ver\">'\r\n<XXX> WINRM STDOUT\r\n<XXX> WINRM STDERR #< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Module werden f\u00fcr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\n<XXX> WINRM CLOSE SHELL: D44AF5E4-E69E-4903-82C4-E14EE4583647\r\n\r\nchanged: [XXX] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"#< CLIXML<Objs Version=\\\"1.1.0.1\\\" xmlns=\\\"http://schemas.microsoft.com/powershell/2004/04\\\"><Obj S=\\\"progress\\\" RefId=\\\"0\\\"><TN RefId=\\\"0\\\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\\\"SourceId\\\">1</I64><PR N=\\\"Record\\\"><AV>Module werden f\ufffdr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\",\r\n    \"stderr_lines\": [\r\n        \"#< CLIXML<Objs Version=\\\"1.1.0.1\\\" xmlns=\\\"http://schemas.microsoft.com/powershell/2004/04\\\"><Obj S=\\\"progress\\\" RefId=\\\"0\\\"><TN RefId=\\\"0\\\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\\\"SourceId\\\">1</I64><PR N=\\\"Record\\\"><AV>Module werden f\ufffdr erstmalige Verwendung vorbereitet.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\"\r\n    ],\r\n    \"stdout\": \"\\r\\n\",\r\n    \"stdout_lines\": [\r\n        \"\"\r\n    ]\r\n}\r\n```\r\nThe message \"Module werden f\u00fcr erstmalige Verwendung vorbereitet.\" translates to \"Modules are prepared for first usage.\"\r\n\r\nThe reason for the stderr output seems to be the additional element\r\n```\r\n<S S=\"Error\">#&lt; CLIXML_x000D__x000A_&lt;Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"&gt;&lt;Obj S=\"progress\" RefId=\"0\"&gt;&lt;TN RefId=\"0\"&gt;&lt;T&gt;System.Management.Automation.PSCustomObject&lt;/T&gt;&lt;T&gt;System.Object&lt;/T&gt;&lt;/TN&gt;&lt;MS&gt;&lt;I64 N=\"SourceId\"&gt;1&lt;/I64&gt;&lt;PR N=\"Record\"&gt;&lt;AV&gt;Module werden f\ufffdr erstmalige Verwendung vorbereitet.&lt;/AV&gt;&lt;AI&gt;0&lt;/AI&gt;&lt;Nil /&gt;&lt;PI&gt;-1&lt;/PI&gt;&lt;PC&gt;-1&lt;/PC&gt;&lt;T&gt;Completed&lt;/T&gt;&lt;SR&gt;-1&lt;/SR&gt;&lt;SD&gt; &lt;/SD&gt;&lt;/PR&gt;&lt;/MS&gt;&lt;/Obj&gt;&lt;/Objs&gt;_x000D__x000A_</S>\r\n```\r\ninside the 3rd <Objs>-element.",
        "created_at": "2020-03-03T13:15:19Z",
        "user": "P-Hessler",
        "labels": [
            "windows",
            "module",
            "support:core",
            "bug",
            "commands",
            "affects_2.9",
            "affects_2.15"
        ]
    },
    {
        "number": 67804,
        "title": "handle `register` expressions for dict specs",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\nCurrently `register` saves the entire module output to a variable, but many times you only need one part of the output. For example, I would love to be able to set:\r\n`register: something=result.stdout` \r\nafter running a shell command.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nBasically - add dictionary support for `register`\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\nEssentially, you should be able to transform:\r\n```yaml\r\n- name: run command\r\n  shell: echo 'hi'\r\n  register: hi_out\r\n\r\n- name: extract output\r\n  set_fact: hi=hi_out.stdout\r\n```\r\nto:\r\n```yaml\r\n- name: run command\r\n  shell: echo 'hi'\r\n  register: hi=result.stdout\r\n```\r\nThis doesn't affect normal functionality as strings would still work the same way. \r\n\r\nIt would also let you set multiple variables if you so needed\r\n```yaml\r\n- name: run command\r\n  shell: echo 'afdasdfasdfasdf'\r\n  register: \r\n    start: result.stdout[:5]\r\n    end: result.stdout[-5:]\r\n    err: result.stderr\r\n```\r\n\r\nThis would have the added benefit of not polluting ansible output logs (big plus !!) and variable namespace.\r\n\r\nHere's an especially ugly one that I didn't have fun writing:\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Load the supervisord config content\r\n  slurp: src=/etc/supervisord.conf\r\n  register: supervisord_conf_b64 # ughh..\r\n\r\n- name: ughhh..\r\n  set_fact:\r\n    supervisord_conf: \"{{ supervisord_conf_b64['content'] | b64decode }}\"\r\n\r\n- name: Extract ...\r\n  set_fact:\r\n    supd_pidfile: {{ supervisord_conf | regex_search(line_pattern, multiline=True) | first }}\r\n```\r\n\r\nBut It'd be so much cleaner to be able to do:\r\n```yaml\r\n- name: Get the supervisord value\r\n  slurp: src=/etc/supervisord.conf\r\n  register: \r\n    supervisord_conf: > \r\n      result['content'] \r\n         | b64decode \r\n         | regex_search(line_pattern, multiline=True) | first\r\n```\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2020-02-27T01:03:52Z",
        "user": "beasteers",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 67760,
        "title": "ansible-galaxy collection install - support rollback on failures",
        "body": "##### SUMMARY\r\nThe `ansible-galaxy collection install` command should be able to safely rollback any changes that have been made in case an error has occurred. Currently we just extract the downloaded collection to the actual install location but that should only occur with all collections at the same time once everything is extracted.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nansible-galaxy",
        "created_at": "2020-02-26T00:37:58Z",
        "user": "jborean93",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 67759,
        "title": "Add ansible-galaxy collection uninstall",
        "body": "##### SUMMARY\r\nWhile users can just delete the directory it would be nice to have a command that removed/uninstalled collections in the current (or all found paths) and it's dependencies using and `ansible-galaxy` command.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nansible-galaxy",
        "created_at": "2020-02-26T00:36:40Z",
        "user": "jborean93",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "affects_2.16"
        ]
    },
    {
        "number": 67758,
        "title": "Create alias for ansible-galaxy collection",
        "body": "##### SUMMARY\r\nI feel that we should have an alias for the command `ansible-galaxy collection <action>`. There are a few reasons why I feel like this should be done for 2 reasons\r\n\r\n* Writing `ansible-galaxy collection <action>` is annoying to do multiple times, most package manager tools use 3 letters for their binary; `dnf`, `yum`, `apt`\r\n* It's too similar to `ansible-galaxy <action>` which causes confusing when you try and do `ansible-galaxy install namespace.name` and it can't find the collection\r\n   * Especially for https://github.com/ansible/ansible/issues/65673, doing `ansible-galaxy install -r requirements.yml` will ignore any collections in that list which is probably not what one would expect. Having the alias won't solve this problem but at least it gives the idea to the user that the command is purely for `collections` and `ansible-galaxy` is for `roles`\r\n\r\nWe can still keep `ansible-galaxy collection <action>` working in the background for backwards compatibility but having that alias can help solve a few UX issues we have currently. As for coming up with the actual alias we could just continue on with `mazer` as that was the original name for the separate tool that did collection work. Honestly it could be anything, `acd` (Ansible content delivery), `col` (col(lections) but that doesn't need to be decided right now.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nansible-galaxy",
        "created_at": "2020-02-26T00:33:12Z",
        "user": "jborean93",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 67757,
        "title": "Add an file extension specific to vault encrypted files",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nVault files are not yaml/json from the perspective of tools that are not vault aware. Running a basic yamllint against a vault encrypted yaml file results in an error.  It would be nice to have a dedicated extension for vault encrypted files.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n- core\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI want to be able to use `yamllint *.yaml` without getting errors from vaulted encrypted files.\r\n\r\nAs far as I know this would only take a very simple adjustment to the default value of `YAML_FILENAME_EXTENSIONS`, since that is what is used by the vars plugins.\r\n\r\nI could be wrong, but it might be as simple as something like this?\r\n\r\n    diff --git a/lib/ansible/config/base.yml b/lib/ansible/config/base.yml\r\n    index 1a588b747e..c042547021 100644\r\n    --- a/lib/ansible/config/base.yml\r\n    +++ b/lib/ansible/config/base.yml\r\n    @@ -1865,7 +1865,7 @@ WIN_ASYNC_STARTUP_TIMEOUT:\r\n      version_added: '2.10'\r\n    YAML_FILENAME_EXTENSIONS:\r\n      name: Valid YAML extensions\r\n    -  default: [\".yml\", \".yaml\", \".json\"]\r\n    +  default: [\".yml\", \".yaml\", \".json\", \"*.vault\"]\r\n      description:\r\n        - \"Check all of these extensions when looking for 'variable' files which should be YAML or JSON or vaulted versis\"\r\n        - 'This affects vars_files, include_vars, inventory and vars plugins among others.'\r\n\r\nAbout the only problem I can think of is that some really small percentage of people might have files with the `.vault` in the vars directories, but they aren't ansible-vault encrypted.\r\n",
        "created_at": "2020-02-25T23:44:36Z",
        "user": "zoredache",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 67242,
        "title": "delegate_to: '' tries to decrypt other host's vaults than the specified one",
        "body": "##### SUMMARY\r\nIn an ansible project with vault-encrypted files in host_vars , when a task has his delegate_to set to an empty string '' ansible tries to read and decrypt (!) other host_var files than the specified in hosts. If the other files have different vault-password the task fails with following error.\r\n\r\n`ERROR! Decryption failed (no vault secrets were found that could decrypt) on /home/map/ansible_project/test_directory/host_vars/192.168.45.139.yml`\r\n\r\nI didn't find any specification of this behavior in the docs. Thus I don't know if this is a bug or a feature.\r\n\r\n##### COMPONENT NAME\r\ndelegate_to\r\n##### ANSIBLE VERSION\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/map/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.12 (default, Oct  8 2019, 14:14:10) [GCC 5.4.0 20160609]\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```bash\r\n# create a tmp_directory\r\nmkdir tmp_directory\r\ncd tmp_directory\r\n\r\n# create host_vars directory\r\nmkdir -p host_vars\r\n\r\n# create two vault-encrypted vars files, one for 192.168.45.163 and one for 192.168.45.139\r\ncat <<EOF | tee vault-password-for-192.168.45.163.yml\r\nsecret163\r\nEOF\r\ncat <<EOF | tee vault-password-for-192.168.45.139.yml\r\nsecret139\r\nEOF\r\ncat <<EOF | tee host_vars/192.168.45.163.yml\r\nx: using var from 192.168.45.163.yml\r\nEOF\r\ncat <<EOF | tee host_vars/192.168.45.139.yml\r\nx: using var from 192.168.45.139.yml\r\nEOF\r\nansible-vault encrypt host_vars/192.168.45.163.yml --vault-password-file vault-password-for-192.168.45.163.yml\r\nansible-vault encrypt host_vars/192.168.45.139.yml --vault-password-file vault-password-for-192.168.45.139.yml\r\nansible-vault view host_vars/192.168.45.163.yml --vault-password-file vault-password-for-192.168.45.163.yml\r\nansible-vault view host_vars/192.168.45.139.yml --vault-password-file vault-password-for-192.168.45.139.yml\r\n\r\n# define my_inventory\r\ncat <<EOF | tee my_inventory\r\n192.168.45.163\r\n192.168.45.139\r\nEOF\r\n\r\n# create test-playbook.yml\r\ncat <<EOF | tee test-playbook.yml\r\n- name: example\r\n  hosts: 192.168.45.163\r\n  vars:\r\n    delegated_host: ''\r\n  tasks:\r\n    - debug:\r\n        msg: '{{ x }}'\r\n      delegate_to: '{{ delegated_host }}'\r\nEOF\r\n\r\n# run test-playbook.yml\r\nansible-playbook -v -i my_inventory test-playbook.yml --vault-password-file vault-password-for-192.168.45.163.yml\r\n```",
        "created_at": "2020-02-08T10:25:59Z",
        "user": "me-kell",
        "labels": [
            "support:core",
            "bug",
            "feature",
            "P3",
            "affects_2.9",
            "affects_2.10"
        ]
    },
    {
        "number": 67047,
        "title": "Shared documentation RETURN values ",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nLike we have for `DOCUMENTATION` block \r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nplugins/docs\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2020-02-03T13:28:03Z",
        "user": "gundalow",
        "labels": [
            "support:core",
            "has_pr",
            "docs",
            "feature",
            "affects_2.14",
            "affects_2.18"
        ]
    },
    {
        "number": 66983,
        "title": "diff mode isn't working when copy module remote_src parameter is used",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\ncopy module with remote_src parameter in diff mode only returns state (CHANGED or SUCCESS), but files differences are not printout.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ncopy, remote_src, check_mode, diff\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/cloud_user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Aug  7 2019, 00:51:29) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\nDefault Ansible configuration after fresh installation.\r\n\r\n```\r\n[cloud_user@jonasbunevicius1c ~]$ ansible-config dump --only-changed\r\n[cloud_user@jonasbunevicius1c ~]$\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n```\r\nNAME=\"CentOS Linux\"\r\nVERSION=\"7 (Core)\"\r\nID=\"centos\"\r\nID_LIKE=\"rhel fedora\"\r\nVERSION_ID=\"7\"\r\nPRETTY_NAME=\"CentOS Linux 7 (Core)\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:centos:centos:7\"\r\nHOME_URL=\"https://www.centos.org/\"\r\nBUG_REPORT_URL=\"https://bugs.centos.org/\"\r\n\r\nCENTOS_MANTISBT_PROJECT=\"CentOS-7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT=\"centos\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nCreate two different files on remote host:\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\necho 'Original file with text' > test_file1; echo 'Modified file with text' > test_file2\r\n```\r\nRun ad-hoc command from Ansible server:\r\n```\r\nansible server -m copy -a 'src=test_file2 dest=test_file1 remote_src=yes' --check --diff\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nExpected to get the same result as using copy module without remote_src parameter in diff mode:\r\n```\r\n[cloud_user@jonasbunevicius1c ~]$ ansible localhost -m copy -a 'src=test_file2 dest=test_file1' --check --diff\r\n--- before: test_file1\r\n+++ after: /home/cloud_user/test_file2\r\n@@ -1 +1 @@\r\n-Original file with text\r\n+Modified file with text\r\n\r\nlocalhost | CHANGED => {\r\n    \"changed\": true\r\n}\r\n\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nIf files are different, result shows only 'CHANGED' state but does not printout detected differences:\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/cloud_user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Aug  7 2019, 00:51:29) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\nLoading callback plugin minimal of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/minimal.pyc\r\nMETA: ran handlers\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b jonasbunevicius3c '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, '/home/cloud_user\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b jonasbunevicius3c '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187 `\" && echo ansible-tmp-1580474726.49-210381288765187=\"` echo /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187 `\" ) && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, 'ansible-tmp-1580474726.49-210381288765187=/home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<jonasbunevicius3c> Attempting python interpreter discovery\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b jonasbunevicius3c '/bin/sh -c '\"'\"'echo PLATFORM; uname; echo FOUND; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python3.5'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.7'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python2.6'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/libexec/platform-python'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'/usr/bin/python3'\"'\"'\"'\"'\"'\"'\"'\"'; command -v '\"'\"'\"'\"'\"'\"'\"'\"'python'\"'\"'\"'\"'\"'\"'\"'\"'; echo ENDFOUND && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, 'PLATFORM\\nLinux\\nFOUND\\n/usr/bin/python\\n/usr/bin/python2.7\\n/usr/libexec/platform-python\\n/usr/bin/python\\nENDFOUND\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b jonasbunevicius3c '/bin/sh -c '\"'\"'/usr/bin/python && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, '{\"osrelease_content\": \"NAME=\\\\\"CentOS Linux\\\\\"\\\\nVERSION=\\\\\"7 (Core)\\\\\"\\\\nID=\\\\\"centos\\\\\"\\\\nID_LIKE=\\\\\"rhel fedora\\\\\"\\\\nVERSION_ID=\\\\\"7\\\\\"\\\\nPRETTY_NAME=\\\\\"CentOS Linux 7 (Core)\\\\\"\\\\nANSI_COLOR=\\\\\"0;31\\\\\"\\\\nCPE_NAME=\\\\\"cpe:/o:centos:centos:7\\\\\"\\\\nHOME_URL=\\\\\"https://www.centos.org/\\\\\"\\\\nBUG_REPORT_URL=\\\\\"https://bugs.centos.org/\\\\\"\\\\n\\\\nCENTOS_MANTISBT_PROJECT=\\\\\"CentOS-7\\\\\"\\\\nCENTOS_MANTISBT_PROJECT_VERSION=\\\\\"7\\\\\"\\\\nREDHAT_SUPPORT_PRODUCT=\\\\\"centos\\\\\"\\\\nREDHAT_SUPPORT_PRODUCT_VERSION=\\\\\"7\\\\\"\\\\n\\\\n\", \"platform_dist_result\": [\"centos\", \"7.7.1908\", \"Core\"]}\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/files/copy.py\r\n<jonasbunevicius3c> PUT /home/cloud_user/.ansible/tmp/ansible-local-4784M0rYMw/tmpDAKsBU TO /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/AnsiballZ_copy.py\r\n<jonasbunevicius3c> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b '[jonasbunevicius3c]'\r\n<jonasbunevicius3c> (0, 'sftp> put /home/cloud_user/.ansible/tmp/ansible-local-4784M0rYMw/tmpDAKsBU /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/AnsiballZ_copy.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 5 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/cloud_user size 0\\r\\ndebug3: Looking up /home/cloud_user/.ansible/tmp/ansible-local-4784M0rYMw/tmpDAKsBU\\r\\ndebug3: Sent message fd 5 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/AnsiballZ_copy.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:14478\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 14478 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b jonasbunevicius3c '/bin/sh -c '\"'\"'chmod u+x /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/ /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/AnsiballZ_copy.py && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<jonasbunevicius3c> ESTABLISH SSH CONNECTION FOR USER: None\r\n<jonasbunevicius3c> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/cloud_user/.ansible/cp/10e5dec29b -tt jonasbunevicius3c '/bin/sh -c '\"'\"'/usr/bin/python /home/cloud_user/.ansible/tmp/ansible-tmp-1580474726.49-210381288765187/AnsiballZ_copy.py && sleep 0'\"'\"''\r\n<jonasbunevicius3c> (0, '\\r\\n{\"src\": \"test_file2\", \"changed\": true, \"group\": \"cloud_user\", \"uid\": 1002, \"dest\": \"./test_file1\", \"checksum\": \"cb848e4f836c58438bb1956059cd36cd568ea8b7\", \"md5sum\": \"7050a9b4092fabad858a03a401768e0c\", \"owner\": \"cloud_user\", \"state\": \"file\", \"gid\": 1003, \"secontext\": \"unconfined_u:object_r:user_home_t:s0\", \"mode\": \"0664\", \"invocation\": {\"module_args\": {\"directory_mode\": null, \"force\": true, \"remote_src\": true, \"_original_basename\": null, \"owner\": null, \"follow\": false, \"local_follow\": null, \"group\": null, \"unsafe_writes\": null, \"setype\": null, \"content\": null, \"serole\": null, \"dest\": \"./test_file1\", \"selevel\": null, \"regexp\": null, \"validate\": null, \"src\": \"test_file2\", \"checksum\": null, \"seuser\": null, \"delimiter\": null, \"mode\": null, \"attributes\": null, \"backup\": false}}, \"size\": 24}\\r\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 4774\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to jonasbunevicius3c closed.\\r\\n')\r\njonasbunevicius3c | CHANGED => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/bin/python\"\r\n    },\r\n    \"changed\": true,\r\n    \"checksum\": \"cb848e4f836c58438bb1956059cd36cd568ea8b7\",\r\n    \"dest\": \"./test_file1\",\r\n    \"gid\": 1003,\r\n    \"group\": \"cloud_user\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_original_basename\": null,\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": null,\r\n            \"content\": null,\r\n            \"delimiter\": null,\r\n            \"dest\": \"./test_file1\",\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"force\": true,\r\n            \"group\": null,\r\n            \"local_follow\": null,\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"regexp\": null,\r\n            \"remote_src\": true,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": \"test_file2\",\r\n            \"unsafe_writes\": null,\r\n            \"validate\": null\r\n        }\r\n    },\r\n    \"md5sum\": \"7050a9b4092fabad858a03a401768e0c\",\r\n    \"mode\": \"0664\",\r\n    \"owner\": \"cloud_user\",\r\n    \"secontext\": \"unconfined_u:object_r:user_home_t:s0\",\r\n    \"size\": 24,\r\n    \"src\": \"test_file2\",\r\n    \"state\": \"file\",\r\n    \"uid\": 1002\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n```\r\n",
        "created_at": "2020-01-31T12:49:34Z",
        "user": "jonsbun",
        "labels": [
            "python3",
            "test",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "files",
            "collection",
            "affects_2.9"
        ]
    },
    {
        "number": 66679,
        "title": "user.py Busybox support broke modifying users",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below --> \r\nThe commit bf3e397ea7922e8bd8b8ffbc05d1aede0317d119 (PR #45507) that introduced Busybox support and changed so that class is always used on Alpine Linux, broke modifying existing user accounts.\r\n\r\nHence for instance a shell can not be changed for an existing user account.\r\n\r\nExample\r\n```yaml\r\n - name: add users                                                                                                                                                                                                                                  \r\n    user:\r\n      name: \"userA\"\r\n      shell: \"/bin/zsh\"\r\n      password: '*'\r\n      update_password: on_create\r\n    ....\r\n```\r\nand then changing shell to `/bin/bash`. Will only change the shell on for instance Debian systems but on Alpine systems the shell will not be changed.\r\n\r\nLooking at the code it seems the Busybox class `modify_user` implementation only handles groups memberships and passwords and not things like shell, comment etc.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nlib/ansible/modules/system/user.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n2.8.8\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\nAlpine Linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n - name: add users                                                                                                                                                                                                                                  \r\n    user:\r\n      name: \"userA\"\r\n      shell: \"/bin/zsh\"\r\n      password: '*'\r\n      update_password: on_create\r\n    ....\r\n```\r\n\r\nChanging the shell for the user above works until upgrading to Ansible v2.8 or later.\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nSee above\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\nSee above\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2020-01-22T07:17:27Z",
        "user": "HRio",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3",
            "system",
            "collection"
        ]
    },
    {
        "number": 66676,
        "title": "Inconsistent handling of inventory with comma (,)",
        "body": "##### SUMMARY\r\n\r\nCurrently, Ansible calls ansible.utils.path.unfrackpath on the inventory, special-casing inventories containing comma (`,`) for the use of `host_list`. This causes two complementary problems:\r\n\r\n* Custom inventory plugins which are not file-based cannot access the original string (for instance, containing a URL).\r\n* The `host_list` inventory plugin calls `os.path.isfile()` on a path that has not been unfracked. If `os.path.isfile()` returns True, or the `host_list` plugin is disabled, other inventory plugins will unexpectedly receive and handle a path that has not been unfracked.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ninventory manager\r\n\r\n##### ANSIBLE VERSION\r\n\r\nansible 2.9.1\r\n\r\nThe issue is present in the devel branch: https://github.com/ansible/ansible/blob/devel/lib/ansible/inventory/manager.py#L221\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```yaml\r\nclass InventoryModule(BaseInventoryModule):\r\n    def verify_file(self, path):\r\n        ''' Return whether this looks like a URL.\r\n\r\n            Note: Don't call base class as we don't expect a path, but a URL. '''\r\n\r\n        self.display.v(\"Got: %s\" % path)\r\n        return path.startswith('http://') or path.startswith('https://')\r\n```\r\n\r\nThis will always return `False`, as the URL is prefixed with the current working directory and `//` is reduced to `/` (or presumably `\\`, on Windows systems).\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* Custom inventory plugins can access the raw inventory string to generate the inventory in situ, like `host_list` does. All inventory plugins have a consistent interface, without special cases in the inventory manager.\r\n* Neither `host_list` nor other inventory plugins use the inventory as a path when it has not been unfracked.",
        "created_at": "2020-01-22T05:02:23Z",
        "user": "sabik",
        "labels": [
            "inventory",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 66497,
        "title": "include_role sometimes ignores dynamic vars_from parameter",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWe're trying to implement roles, which can be individualized by supplying host related vars files. This doesn't seem to work under certain circumstances. Up to now we're not yet sure, whether this is a bug or works as designed.\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ninclude_role\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.9\r\n  config file = /adm/afroebel/ansible/unix/ansible.cfg\r\n  configured module search path = [u'/adm/afroebel/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.16 (default, Oct 10 2019, 22:02:15) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_GATHERING(/adm/afroebel/ansible/unix/ansible.cfg) = explicit\r\nDEFAULT_MANAGED_STR(/adm/afroebel/ansible/unix/ansible.cfg) = {file}\r\nDEFAULT_PRIVATE_ROLE_VARS(/adm/afroebel/ansible/unix/ansible.cfg) = True\r\nPERSISTENT_CONNECT_TIMEOUT(/adm/afroebel/ansible/unix/ansible.cfg) = 30\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nAnsible controller: Debian GNU/Linux 10\r\nmanaged devices: Oracle Solaris 11.3/11.4\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nWe've got 3 simple roles with exactly the same content, one task file and two vars files named like ansible hosts:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# cksum test/roles/test_role/*/*/*\r\n201185725 22 test/roles/test_role/solaris/tasks/main.yml\r\n1196793317 19 test/roles/test_role/solaris/vars/test07\r\n2721971076 19 test/roles/test_role/solaris/vars/test08\r\n201185725 22 test/roles/test_role/test07/tasks/main.yml\r\n1196793317 19 test/roles/test_role/test07/vars/test07\r\n2721971076 19 test/roles/test_role/test07/vars/test08\r\n201185725 22 test/roles/test_role/test08/tasks/main.yml\r\n1196793317 19 test/roles/test_role/test08/vars/test07\r\n2721971076 19 test/roles/test_role/test08/vars/test08\r\n\r\n# cat test/roles/test_role/solaris/tasks/main.yml\r\n---\r\n- debug: var=var1\r\n\r\n# cat test/roles/test_role/solaris/vars/test07\r\n---\r\nvar1: \"test07\"\r\n\r\n# cat test/roles/test_role/solaris/vars/test08\r\n---\r\nvar1: \"test08\"\r\n```\r\nWe now executed the playbook test/include_role.yml:\r\n```yaml\r\n---\r\n- name:   \"Test Playbook\"\r\n  hosts:  \"test07:test08\"\r\n  tasks:\r\n    - include_role:\r\n        name:      \"test_role/{{ inventory_hostname_short}}\"\r\n        vars_from: \"{{ inventory_hostname_short }}\"\r\n```\r\nIt worked well and produced the following output:\r\n```yaml\r\n# ansible-playbook -i inventory test/include_role.yml\r\n\r\nPLAY [Test Playbook] *******************************************************************\r\n\r\nTASK [include_role : test_role/{{ inventory_hostname_short}}] **************************\r\n\r\nTASK [test_role/test07 : debug] ********************************************************\r\nok: [test07] => {\r\n    \"var1\": \"test07\"\r\n}\r\n\r\nTASK [test_role/test08 : debug] ********************************************************\r\nok: [test08] => {\r\n    \"var1\": \"test08\"\r\n}\r\n\r\nPLAY RECAP *****************************************************************************\r\ntest07:  ok=1  changed=0  unreachable=0  failed=0  skipped=0  rescued=0  ignored=0\r\ntest08:  ok=1  changed=0  unreachable=0  failed=0  skipped=0  rescued=0  ignored=0\r\n```\r\nTracing the ansible-playbook command using strace revealed, that tasks and vars files of either role were actually opened and read from.\r\n\r\nThe playbook test/include_role.yml was slightly changed in order to include a generic role test_role/solaris instead of the host related roles.\r\n```yaml\r\n---\r\n- name:   \"Test Playbook\"\r\n  hosts:  \"test07:test08\"\r\n  tasks:\r\n    - include_role:\r\n        name:      \"test_role/solaris\"\r\n        vars_from: \"{{ inventory_hostname_short }}\"\r\n```\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nAs the content of the generic role was exactly the same as the content of the host related roles, we would expect the playbook to produce the same output.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nEven though the host related vars files contained different values for variable var1, ansible only used one of them during execution.\r\n<!--- Paste verbatim command output between quotes -->\r\n```yaml\r\n# ansible-playbook -i inventory test/include_role.yml\r\n\r\nPLAY [Test Playbook] *******************************************************************\r\n\r\nTASK [include_role : test_role/solaris] ************************************************\r\n\r\nTASK [test_role/solaris : debug] *******************************************************\r\nok: [test07] => {\r\n    \"var1\": \"test07\"\r\n}\r\nok: [test08] => {\r\n    \"var1\": \"test07\"\r\n}\r\n\r\nPLAY RECAP *****************************************************************************\r\ntest07:  ok=1  changed=0  unreachable=0  failed=0  skipped=0  rescued=0  ignored=0\r\ntest08:  ok=1  changed=0  unreachable=0  failed=0  skipped=0  rescued=0  ignored=0\r\n```\r\nTracing the ansible-playbook command using strace revealed, that this time only vars file test07 was opened and read from.",
        "created_at": "2020-01-15T14:19:59Z",
        "user": "froebela",
        "labels": [
            "easyfix",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 66196,
        "title": "systemd module doesn't handle units starting with '-'",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWhen working with a unit file starting with a dash (e.g a custom -.mount unit) the systemd module fails with the message `Could not find the requested service`\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nsystemd.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.1 (default, Dec 21 2019, 20:57:38) [GCC 9.2.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nOS: Arch Linux\r\nsystemd `244.1-1`\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n- create the file `/etc/systemd/system/-.mount` with the following content:\r\n```\r\n[Unit]\r\nDescription=root partition\r\n\r\n[Mount]\r\nWhere=/\r\nWhat=YOUR_ROOT_PARTITION_HERE\r\n\r\n[Install]\r\nWantedBy=local-fs.target\r\n```\r\n- execute the following ad-hoc command from root:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```shell\r\nansible localhost -m systemd -a 'service=-.mount daemon_reload=yes enabled=yes'\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nThe newly created mount unit is enabled.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/root/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.8/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.8.1 (default, Dec 21 2019, 20:57:38) [GCC 9.2.0]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nyaml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\nini declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nSkipping due to inventory source not existing or not being readable by the current user\r\ntoml declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n\r\nLoading callback plugin minimal of type stdout, v2.0 from /usr/lib/python3.8/site-packages/ansible/plugins/callback/mini\r\nmal.py\r\nMETA: ran handlers\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~root && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1578232873.6904685-2341044811\r\n88629 `\" && echo ansible-tmp-1578232873.6904685-234104481188629=\"` echo /root/.ansible/tmp/ansible-tmp-1578232873.690468\r\n5-234104481188629 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.8/site-packages/ansible/modules/system/systemd.py\r\n<127.0.0.1> PUT /root/.ansible/tmp/ansible-local-51853ntq15hrl/tmpjzdh5on3 TO /root/.ansible/tmp/ansible-tmp-1578232873.\r\n6904685-234104481188629/AnsiballZ_systemd.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1578232873.6904685-234104481188629/ /root/.ansible\r\n/tmp/ansible-tmp-1578232873.6904685-234104481188629/AnsiballZ_systemd.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /root/.ansible/tmp/ansible-tmp-1578232873.6904685-234104481188629/AnsiballZ\r\n_systemd.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /root/.ansible/tmp/ansible-tmp-1578232873.6904685-234104481188629/ > /dev/null 2>&\r\n1 && sleep 0'\r\nlocalhost | FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"daemon_reexec\": false,\r\n            \"daemon_reload\": true,\r\n            \"enabled\": true,\r\n            \"force\": null,\r\n            \"masked\": null,\r\n            \"name\": \"-.mount\",\r\n            \"no_block\": false,\r\n            \"scope\": null,\r\n            \"service\": \"-.mount\",\r\n            \"state\": null,\r\n            \"user\": null\r\n        }\r\n    },\r\n    \"msg\": \"Could not find the requested service -.mount: host\"\r\n}```\r\n",
        "created_at": "2020-01-05T14:03:46Z",
        "user": "grcancelliere",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 66023,
        "title": "Allow ignore missing file errors on fileglob plugin",
        "body": "##### SUMMARY\r\n\r\nI would found it nice to have the possibility to remove the warning printed by lookup plugins when a file is missing from the controller search path. \r\nWhile using the lookup plugin \"alone\" I found this can by done using a couple of test like  `query('fileglob', 'X')` protected by `when: \"'x' is is_file\"`. But using fileglob in a `loop` it seems that the lookup is performed before the condition on the `when` is evaluated leading to a warning on the console.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n- plugins/lookup/fileglob.py\r\n\r\n##### ADDITIONAL INFORMATION\r\n By default set to strict mode or False a user can add an extra option to lookup call:\r\n\r\n```yaml\r\n- name: Do not warn if ../taskss does not exist\r\n  copy:\r\n    src: '{{ item }}'\r\n    dest: '/a'\r\n  loop: \"{{ query('fileglob', '../taskss/*', errors='ignore') }}\"\r\n\r\n- name: By default warn if something is missing\r\n  copy:\r\n    src: '{{ item }}'\r\n    dest: '/a'\r\n  loop: \"{{ query('fileglob', '../taskss/*') }}\"\r\n\r\n- name: Ask to warn if something is missing\r\n  copy:\r\n    src: '{{ item }}'\r\n    dest: '/a'\r\n  loop: \"{{ query('fileglob', '../taskss/*', errors='strict') }}\"\r\n```\r\n\r\nFor the fileglob plugin the patch could looks like this (I've quickly looked up other codes and issue, so I'm not especially proud of:\r\n\r\n```\r\n18a19,23\r\n>       ignore_missing:\r\n>         description: whether or not to ignore missing terms.\r\n>         type: bool\r\n>         required: False\r\n>         default: False\r\n58a64,65\r\n>         ignore_missing = kwargs.pop('ignore_missing', False)\r\n> \r\n61c68\r\n<             dwimmed_path = self.find_file_in_search_path(variables, 'files', os.path.dirname(term))\r\n---\r\n>             dwimmed_path = self.find_file_in_search_path(variables, 'files', os.path.dirname(term), ignore_missing=ignore_missing)\r\n```",
        "created_at": "2019-12-22T00:54:37Z",
        "user": "bobsaintcool",
        "labels": [
            "support:core",
            "feature",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 66002,
        "title": "module_utils: does not properly encode URLs",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nmodule_utils:urls.py causes traceback when passed certain URLs.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nmodule_utils\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/notting/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.5 (default, Oct 17 2019, 12:16:48) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /tmp/ansible.log\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nFedora 31.\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nansible localhost, -m get_url -vvv -a \"url=https://notting.fedorapeople.org/\ud83d\udc15\u2795\ud83c\udf08/testfile.tgz dest=/tmp/testcase/foo\"\r\nansible 2.9.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/notting/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.5 (default, Oct 17 2019, 12:16:48) [GCC 9.2.1 20190827 (Red Hat 9.2.1-1)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nhost_list declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nscript declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nauto declined parsing /etc/ansible/hosts as it did not pass its verify_file() method\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nMETA: ran handlers\r\nUsing module file /usr/lib/python3.7/site-packages/ansible/modules/net_tools/basics/get_url.py\r\nPipelining is enabled.\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: notting\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3 && sleep 0'\r\nThe full traceback is:\r\n  File \"/tmp/ansible_get_url_payload_blyxha2h/ansible_get_url_payload.zip/ansible/module_utils/urls.py\", line 1494, in fetch_url\r\n    unix_socket=unix_socket, ca_path=ca_path)\r\n  File \"/tmp/ansible_get_url_payload_blyxha2h/ansible_get_url_payload.zip/ansible/module_utils/urls.py\", line 1390, in open_url\r\n    unredirected_headers=unredirected_headers)\r\n  File \"/tmp/ansible_get_url_payload_blyxha2h/ansible_get_url_payload.zip/ansible/module_utils/urls.py\", line 1294, in open\r\n    r = urllib_request.urlopen(*urlopen_args)\r\n  File \"/usr/lib64/python3.7/urllib/request.py\", line 222, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/usr/lib64/python3.7/urllib/request.py\", line 525, in open\r\n    response = self._open(req, data)\r\n  File \"/usr/lib64/python3.7/urllib/request.py\", line 543, in _open\r\n    '_open', req)\r\n  File \"/usr/lib64/python3.7/urllib/request.py\", line 503, in _call_chain\r\n    result = func(*args)\r\n  File \"/tmp/ansible_get_url_payload_blyxha2h/ansible_get_url_payload.zip/ansible/module_utils/urls.py\", line 448, in https_open\r\n    req\r\n  File \"/usr/lib64/python3.7/urllib/request.py\", line 1317, in do_open\r\n    encode_chunked=req.has_header('Transfer-encoding'))\r\n  File \"/usr/lib64/python3.7/http/client.py\", line 1252, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/lib64/python3.7/http/client.py\", line 1263, in _send_request\r\n    self.putrequest(method, url, **skips)\r\n  File \"/usr/lib64/python3.7/http/client.py\", line 1118, in putrequest\r\n    self._output(self._encode_request(request))\r\n  File \"/usr/lib64/python3.7/http/client.py\", line 1198, in _encode_request\r\n    return request.encode('ascii')\r\n\r\nlocalhost | FAILED! => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backup\": null,\r\n            \"checksum\": \"\",\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"content\": null,\r\n            \"delimiter\": null,\r\n            \"dest\": \"/tmp/testcase/foo\",\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"force\": false,\r\n            \"force_basic_auth\": false,\r\n            \"group\": null,\r\n            \"headers\": null,\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"regexp\": null,\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"sha256sum\": \"\",\r\n            \"src\": null,\r\n            \"timeout\": 10,\r\n            \"tmp_dest\": null,\r\n            \"unsafe_writes\": null,\r\n            \"url\": \"https://notting.fedorapeople.org/\ud83d\udc15\u2795\ud83c\udf08/testfile.tgz\",\r\n            \"url_password\": null,\r\n            \"url_username\": null,\r\n            \"use_proxy\": true,\r\n            \"validate_certs\": true\r\n        }\r\n    },\r\n    \"msg\": \"'ascii' codec can't encode characters in position 5-7: ordinal not in range(128)\",\r\n    \"status\": -1,\r\n    \"url\": \"https://notting.fedorapeople.org/\ud83d\udc15\u2795\ud83c\udf08/testfile.tgz\"\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nSucceeds. For example curl and wget take the exact same URL on the commandline fine.\r\n\r\n##### ACTUAL RESULTS\r\ntraceback, per above.\r\n\r\n",
        "created_at": "2019-12-20T19:10:49Z",
        "user": "wenottingham",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 65687,
        "title": "get_url in check_mode reports changed status when there is nothing to change",
        "body": "##### SUMMARY\r\nWhen using `get_url` module with `url` argument and `dest` argument pointing to a file, running in check mode will always cause status changed even if the local file is already downloaded and identical to the remote file.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nget_url\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.1\r\n  config file = /data/src/mediator/mediator-ansible/ansible.cfg\r\n  configured module search path = [u'/home/r.krypa/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.17 (default, Oct 19 2019, 23:36:22) [GCC 9.2.1 20191008]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\n##### OS / ENVIRONMENT\r\nDebian testing with ansible package installed from ansible PPA for Ubuntu Disco\r\n\r\n##### STEPS TO REPRODUCE\r\nMinimal playbook, saved as `get_url.yml`:\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: no\r\n  tasks:\r\n  - get_url:\r\n      url: https://github.githubassets.com/favicon.ico\r\n      dest: /tmp/favicon.ico\r\n```\r\nRunning for the first time, it will download the file and correctly set status as changed:\r\n```console\r\n$ ansible-playbook get_url.yml \r\n\r\nPLAY [localhost] ***************************************************************\r\n\r\nTASK [get_url] *****************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nWhen running for the second time, there are no changes to apply:\r\n```console\r\n$ ansible-playbook get_url.yml \r\n\r\nPLAY [localhost] ***************************************************************\r\n\r\nTASK [get_url] *****************************************************************\r\nok: [localhost]\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost: ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nBut when run in check mode, it detects changes:\r\n```console\r\n$ ansible-playbook get_url.yml --check -v\r\n\r\nPLAY [localhost] ***************************************************************\r\n\r\nTASK [get_url] *****************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"checksum_dest\": \"07ed688be6d6288a669778f65f7eccdd96770925\", \"checksum_src\": \"da39a3ee5e6b4b0d3255bfef95601890afd80709\", \"dest\": \"/tmp/favicon.ico\", \"elapsed\": 0, \"gid\": 1000, \"group\": \"r.krypa\", \"mode\": \"0644\", \"msg\": \"OK (6518 bytes)\", \"owner\": \"r.krypa\", \"size\": 6518, \"src\": \"/home/r.krypa/.ansible/tmp/ansible-tmp-1575979280.66-100488643343463/tmplpOjyR\", \"state\": \"file\", \"uid\": 1000, \"url\": \"https://github.githubassets.com/favicon.ico\"}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nInteresting part of the supposedly changed run in check mode is `\"checksum_src\": \"da39a3ee5e6b4b0d3255bfef95601890afd80709\"`. This is a checksum of an empty string (the same one can be produced by `sha1sum </dev/null`). It seems that `get_url` module compares checksum of an existing file on disk against checksum of an empty string and detects a change based on that comparison.\r\n\r\n##### EXPECTED RESULTS\r\nIf a playbook runs in normal mode and doesn't perform any changes, it shouldn't report changes when run in check mode.\r\n\r\n##### ACTUAL RESULTS\r\nChanges are reported by `get_url` module because in check mode it seems to compare empty string with existing file on the host.",
        "created_at": "2019-12-10T12:06:06Z",
        "user": "rafal-krypa",
        "labels": [
            "module",
            "net_tools",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 65466,
        "title": "cron: cron_file validation skip option",
        "body": "\r\n##### SUMMARY\r\n\r\nIn  #11295 there was a discussion about validating a cron file name. This is a good thing in most case.\r\n\r\nDone in commit  e8a396be16a737119e62d1e72ccafeec60c884bc\r\n\r\n\r\nHowever if for some reason someone has to deploy a *disabled* cron file (such as `/etc/cron.d/task.disabled`) the role will produce unwanted warning.\r\n\r\nA simple solution would be to add a parameter such as `cron_file_name_check` defaulted to `True` which allow user to safely deploy a disabled cron file. \r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\ncron\r\n\r\n##### ANSIBLE VERSION\r\nAll\r\n\r\n\r\n\r\n##### OS / ENVIRONMENT\r\nall\r\n\r\n##### EXPECTED RESULTS\r\nAbility to disable filename checks\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\n[WARNING]: Filename portion of cron_file (\"task.disabled\") should consist solely of upper- and lower-case letters, digits, underscores, and hyphens\r\n```\r\n",
        "created_at": "2019-12-03T15:22:29Z",
        "user": "renard",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "system",
            "affects_2.10"
        ]
    },
    {
        "number": 65391,
        "title": "Red Hat Core Os (rhcos) not properly discovered",
        "body": "##### SUMMARY\r\nDistribution rhcos 4.2 is improperly detected as redhat 4.2 (this is not totally incorrect though) \r\n\r\n```\r\n[root@rhel-7 ~]# ansible -m setup -i inventory -u core node.dom.tld | grep distribution\r\n [WARNING]: Distribution redhat 4.2 on host node.dom.tld should use /usr/bin/python, but is using /usr/libexec/platform-python, since the discovered\r\nplatform python interpreter was not present. See https://docs.ansible.com/ansible/2.8/reference_appendices/interpreter_discovery.html for more information.\r\n        \"ansible_distribution\": \"RedHat\",\r\n        \"ansible_distribution_file_parsed\": true,\r\n        \"ansible_distribution_file_path\": \"/etc/redhat-release\",\r\n        \"ansible_distribution_file_search_string\": \"Red Hat\",\r\n        \"ansible_distribution_file_variety\": \"RedHat\",\r\n        \"ansible_distribution_major_version\": \"4\",\r\n        \"ansible_distribution_release\": \"NA\",\r\n        \"ansible_distribution_version\": \"4.2\",\r\n```\r\n```\r\n[core@node ~]$ cat /etc/redhat-release\r\nRed Hat Enterprise Linux CoreOS release 4.2\r\n```\r\n\r\n```\r\n[core@node ~]$  cat /etc/os-release\r\nNAME=\"Red Hat Enterprise Linux CoreOS\"\r\nVERSION=\"42.80.20191010.0\"\r\nVERSION_ID=\"4.2\"\r\nPRETTY_NAME=\"Red Hat Enterprise Linux CoreOS 42.80.20191010.0 (Ootpa)\"\r\nID=\"rhcos\"\r\nID_LIKE=\"rhel fedora\"\r\nANSI_COLOR=\"0;31\"\r\nHOME_URL=\"https://www.redhat.com/\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\nREDHAT_BUGZILLA_PRODUCT=\"OpenShift Container Platform\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=\"4.2\"\r\nREDHAT_SUPPORT_PRODUCT=\"OpenShift Container Platform\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"4.2\"\r\nOSTREE_VERSION=42.80.20191010.0\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ndistribution\r\n\r\n##### ANSIBLE VERSION\r\nansible 2.8\r\n\r\n##### CONFIGURATION\r\nnot relevant I think\r\n\r\n##### OS / ENVIRONMENT\r\nRed Hat CoreOs 4.2\r\n\r\n##### STEPS TO REPRODUCE\r\nnothing special",
        "created_at": "2019-11-30T18:56:15Z",
        "user": "bmillemathias-1a",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 64630,
        "title": "Using ansible-pull with --ask-pass parameter does not prompt",
        "body": "##### SUMMARY\r\nWhen using `ansible-pull` and providing `--ask-pass` or `--ask-vault-pass` does not prompt for password. \r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n`ansible-pull`\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/georgi/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.15+ (default, Oct  7 2019, 17:39:04) [GCC 7.4.0]\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nOS: Windows 10\r\nEnvironment: WSL \r\n\r\n##### STEPS TO REPRODUCE\r\n1.1 `ansible-pull \u2013U https://github.com/gmarokov/ansible-win-postinstall.git -e ansible_user=your_win_user --ask-pass`\r\n\r\n1.2 `ansible-pull \u2013U https://github.com/gmarokov/ansible-win-postinstall.git -e ansible_user=your_win_user --ask-vault-pass`\r\n\r\n##### EXPECTED RESULTS\r\nExpecting before executing to ask for the connection password or ask for the password of the vault.\r\n`--ask-become-pass` actually works and prompts for password.\r\n\r\n##### ACTUAL RESULTS\r\nPlaybook is being pulled and executed without asking for password.\r\n",
        "created_at": "2019-11-09T09:13:09Z",
        "user": "gmarokov",
        "labels": [
            "support:core",
            "bug",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 64353,
        "title": "Use streaming for the replace module to avoid memory issues",
        "body": "##### SUMMARY\r\nThe replace module reads in the complete file into memory and works from there. This causes problems with big files (i.e. database dumps). As a suggestion, support a stream option, which will read the file using streams line by line (this obviously removes the multiline regexp feature).\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nreplace\r\n\r\n##### ADDITIONAL INFORMATION\r\nI tried modifying database dumps while building up a playbook, that clones production into an integration environment. The dump was 1.7GB big and processing it killed the Python process.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: \"Replace on a big file\"\r\n   replace:\r\n     path: \"big_file.txt\"\r\n     regexp: \"some.*regex\"\r\n     replace: \"something different\"\r\n     use_stream: \"yes\r\n```\r\n",
        "created_at": "2019-11-02T21:09:35Z",
        "user": "dploeger",
        "labels": [
            "module",
            "support:core",
            "feature",
            "P3",
            "files",
            "affects_2.10"
        ]
    },
    {
        "number": 64016,
        "title": "ansible 2.8.6 get_url repeatedly downloads file with force==no",
        "body": "##### SUMMARY\r\nUnlike in version 2.8.5, get_url module repeatedly downloads an URL even if destination exists with Ansible 2.8.6\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nget_url\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\n$ ansible --version\r\nansible 2.8.6\r\n  config file = None\r\n  configured module search path = [u'/Users/XXX/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/XXX/.virtualenvs/ansible2.8/lib/python2.7/site-packages/ansible\r\n  executable location = /Users/XXX/.virtualenvs/ansible2.8/bin/ansible\r\n  python version = 2.7.16 (default, Sep  2 2019, 11:59:44) [GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\n$ ansible-config dump --only-changed\r\n$\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nMacOS\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n$ touch foofile\r\n$ cat > test_playbook.yaml\r\n---\r\n- hosts: localhost\r\n  connection: local\r\n\r\n  tasks:\r\n    - name:           Fetch file\r\n      get_url:\r\n        url:          http://google.com\r\n        dest:         ./foofile\r\n        force:        no\r\n\r\n$ ansible-playbook -i 'localhost,' test_playbook.yaml\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nNo changes, since \"foofile\" already exists. With the same playbook, a run with Ansible 2.8.5 results in:\r\n```\r\nPLAY RECAP ********************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n\r\n##### ACTUAL RESULTS\r\nFile gets overwritten/downloaded every time\r\n```\r\n$ ansible-playbook -i 'localhost,' test_playbook.yaml\r\nPLAY [localhost] **************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [Fetch file] *************************************************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP ********************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n",
        "created_at": "2019-10-28T11:47:51Z",
        "user": "gtie",
        "labels": [
            "easyfix",
            "module",
            "net_tools",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 63629,
        "title": "[Cron module] Disabled option should work with a cron_file specified",
        "body": "##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\nThere doesn't seem to be a way to disable a cronjob with a pre-existing cron_file without removing it completely. The disabled=true only seems to work when creating a new cron job using the cron module. If I want to comment out a pre-existing cronfile in Ansible (e.g. under /etc/cron.d), I'll use the replace module and match with the start of every line. I believe this kind of functionality should be provided in the cron module itself (disabling/enabling pre-existing jobs).\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nThe cron module (`ansible/modules/system/cron.py`)\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nIdeal usage could be something like this for disabling:\r\n```yaml\r\n- name: Disable cronjob playbook\r\n  tasks:\r\n    - name: Disable /etc/cron.d/backup_system\r\n      cron:\r\n        cron_file: /etc/cron.d/backup_system\r\n        disabled: true\r\n```\r\nIf disabled=false with a cron_file specified, every line in the cron_file can be uncommented.\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\nI'm open to discussion on this (feel free to tell me if this is a bad idea/won't work because of x). If there are no opposing views I'll attempt a PR",
        "created_at": "2019-10-17T13:50:42Z",
        "user": "mjip",
        "labels": [
            "module",
            "support:core",
            "feature",
            "P3",
            "system",
            "affects_2.10"
        ]
    },
    {
        "number": 63314,
        "title": "Playbook log output of different plays are intermixed",
        "body": "##### SUMMARY\r\nWhen I run a playbook with several plays, the CLI output subdivides the log into all plays by these `PLAY [<HOSTS>] ************************` dividing lines. Somehow, however, warnings about not matched host patterns are sorted in the play logs section of the _preceeding_ play.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nansible-playbook\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.8.5\r\n  config file = /var/home/frank/Projekte/Ansible/ansible.cfg\r\n  configured module search path = ['/var/home/frank/Projekte/Ansible/library']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.4 (default, Aug 12 2019, 14:45:07) [GCC 9.1.1 20190605 (Red Hat 9.1.1-2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_HOST_LIST(/var/home/frank/Projekte/Ansible/ansible.cfg) = ['/var/home/frank/Projekte/Ansible/inventory/hosts']\r\nDEFAULT_MODULE_PATH(/var/home/frank/Projekte/Ansible/ansible.cfg) = ['/var/home/frank/Projekte/Ansible/library']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n* Fedora Silverblue 31 beta\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nJust run this playbook below via `ansible-playbook <FILE>`.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: host1\r\n  gather_facts: no\r\n  tasks:\r\n    - name: Task 1\r\n      local_action: command ping -c 3 localhost\r\n\r\n- hosts: host2\r\n  gather_facts: no\r\n  tasks:\r\n    - name: Task 2\r\n      command: command ping -c 3 localhost\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nI expect all output of each play to be contained within its corresponding section.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nAs you can see below, the warnings are grouped above the corresponding section, instead of inside if it. So the output that `host2` of the second play cannot be matched, is already printed before the second play starts. Would be cool if this could be fixed, as this aids error search, especially we as beginners would faster understand what\u2019s going up.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n> ansible-playbook test.yaml\r\n [WARNING]: Could not match supplied host pattern, ignoring: host1\r\n\r\n\r\nPLAY [host1] *************************************************************************\r\nskipping: no hosts matched\r\n [WARNING]: Could not match supplied host pattern, ignoring: host2\r\n\r\n\r\nPLAY [host2] *************************************************************************\r\nskipping: no hosts matched\r\n\r\nPLAY RECAP ***************************************************************************\r\n```\r\n\r\n\r\n\r\nInstead, I would expect something like this:\r\n\r\n```paste below\r\n> ansible-playbook test.yaml\r\n\r\nPLAY [host1] *************************************************************************\r\n [WARNING]: Could not match supplied host pattern, ignoring: host1\r\nskipping: no hosts matched\r\n\r\n\r\nPLAY [host2] *************************************************************************\r\n [WARNING]: Could not match supplied host pattern, ignoring: host2\r\nskipping: no hosts matched\r\n\r\nPLAY RECAP ***************************************************************************\r\n```",
        "created_at": "2019-10-10T01:27:48Z",
        "user": "fbruetting",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 63188,
        "title": "incorrect service state with sub=exited",
        "body": "##### SUMMARY\r\n```\r\nok: [localhost] => {\r\n    \"ansible_facts.services[\\\"iptables.service\\\"]\": {\r\n        \"name\": \"iptables.service\", \r\n        \"source\": \"systemd\", \r\n        \"state\": \"stopped\", \r\n        \"status\": \"enabled\"\r\n    }\r\n}\r\n```\r\n\r\nbut the real state is \"running\"\r\n\r\n```\r\n# systemctl status iptables.service \r\n\u25cf iptables.service - IPv4 firewall with iptables\r\n   Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)\r\n   Active: active (exited) since Mon 2019-10-07 09:55:37 MSK; 8min ago\r\n  Process: 20887 ExecStart=/usr/libexec/iptables/iptables.init start (code=exited, status=0/SUCCESS)\r\n Main PID: 20887 (code=exited, status=0/SUCCESS)\r\n\r\nOct 07 09:55:37 ansible systemd[1]: Starting IPv4 firewall with iptables...\r\nOct 07 09:55:37 ansible iptables.init[20887]: iptables: Applying firewall rules: [  OK  ]\r\nOct 07 09:55:37 ansible systemd[1]: Started IPv4 firewall with iptables.\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n`lib/ansible/modules/system/service_facts.py`\r\n\r\n##### ANSIBLE VERSION\r\nansible 2.8.5\r\n\r\n##### CONFIGURATION\r\nnothing changed\r\n\r\n##### OS / ENVIRONMENT\r\nCentOS 7 \r\nMint 19\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nsudo yum install iptables-services\r\nsudo systemctl stop firewalld\r\nsudo systemctl mask firewalld\r\nsudo systemctl enable iptables --now\r\nsystemctl status iptables\r\n```\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  become: true\r\n  tasks:\r\n\r\n  - name: Gathering services info\r\n    service_facts:\r\n\r\n  - debug:\r\n      var: ansible_facts.services[\"iptables.service\"]\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nstate: running\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n# systemctl list-units --no-pager --type service --all\r\n  iptables.service            loaded    active   exited  IPv4 firewall with iptables\r\n```\r\n\r\nsub=exited doesn't written in service_facts.py\r\n\r\n\r\nWhat has happened is iptables-restore has loaded the firewall rules, and then exited, because after loading the rules it does not need to stick around. This is typical for Type=oneshot services.\r\n",
        "created_at": "2019-10-07T07:11:40Z",
        "user": "ghost",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "system"
        ]
    },
    {
        "number": 62906,
        "title": "only last iteration will be effective using set_fact with delegation to update object",
        "body": "##### SUMMARY\r\nWhen updating list a of other hosts in a loop will only update the list with the last iteration of the loop.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n- set_fact\r\n- delegation\r\n- loop\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.8.5\r\n  config file = None\r\n  configured module search path = ['/Users/spolack/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.3 (default, Mar 27 2019, 09:23:15) [Clang 10.0.1 (clang-1001.0.46.3)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nNO OUTPUT\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n- MacOSX / Linux, locally ran\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ninventory:\r\n```\r\nhost_a peers='[\"a\",\"b\"]'\r\nhost_b peers='[\"c\",\"d\"]'\r\nhost_c peers='[\"e\",\"f\"]'\r\n```\r\n\r\n\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: no\r\n  tasks:\r\n   - name: set cache_host\r\n     set_fact:\r\n       cache_host: \"{{ inventory_hostname }}\"\r\n     run_once: yes\r\n\r\n   - name: set play-global cache\r\n     set_fact:\r\n       global_cache: []\r\n     when: inventory_hostname == cache_host\r\n\r\n   - name: show global_cache before test\r\n     debug: var=hostvars[cache_host]['global_cache']\r\n\r\n   - name: add local peers to global cache\r\n     set_fact:\r\n       global_cache: \"{{ hostvars[cache_host]['global_cache'] + [item] }}\"\r\n     loop: \"{{ peers }}\"\r\n     delegate_to: \"{{ cache_host }}\"\r\n     delegate_facts: yes\r\n     when:\r\n      - inventory_hostname == 'host_a'\r\n\r\n   - name: show global_cache after adding host_a peers\r\n     debug: var=hostvars[cache_host]['global_cache']\r\n     run_once: yes\r\n\r\n   - name: add local peers to global cache\r\n     set_fact:\r\n       global_cache: \"{{ hostvars[cache_host]['global_cache'] + [item]}}\"\r\n     loop: \"{{ peers }}\"\r\n     delegate_to: \"{{ cache_host }}\"\r\n     delegate_facts: yes\r\n     when:\r\n      - inventory_hostname == 'host_b'\r\n\r\n   - name: show global_cache after adding host_b peers\r\n     debug: var=hostvars[cache_host]['global_cache']\r\n     run_once: yes\r\n\r\n   - name: add local peers to global cache\r\n     set_fact:\r\n       global_cache: \"{{ hostvars[cache_host]['global_cache'] + [item] }}\"\r\n     loop: \"{{ peers }}\"\r\n     delegate_to: \"{{ cache_host }}\"\r\n     delegate_facts: yes\r\n     when:\r\n      - inventory_hostname == 'host_c'\r\n\r\n   - name: show global_cache after adding host_c peers\r\n     debug: var=hostvars[cache_host]['global_cache']\r\n     run_once: yes\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nAfter executing all tasks:\r\n`hostvars[cache_host]['global_cache'] == [a,b,c,d,e,f]`\r\n\r\n\r\n##### ACTUAL RESULTS\r\n`hostvars[cache_host]['global_cache'] == [b,d,f]`\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\n$ ansible-playbook -i inventory play.yml\r\n\r\nPLAY [all] *************************************************************************************************************************************************************************\r\n\r\nTASK [set cache_host] **************************************************************************************************************************************************************\r\nok: [host_a]\r\n\r\nTASK [set play-global cache] *******************************************************************************************************************************************************\r\nok: [host_a]\r\nskipping: [host_b]\r\nskipping: [host_c]\r\n\r\nTASK [show global_cache before test] ***********************************************************************************************************************************************\r\nok: [host_a] => {\r\n    \"hostvars[cache_host]['global_cache']\": []\r\n}\r\nok: [host_b] => {\r\n    \"hostvars[cache_host]['global_cache']\": []\r\n}\r\nok: [host_c] => {\r\n    \"hostvars[cache_host]['global_cache']\": []\r\n}\r\n\r\nTASK [add local peers to global cache] *********************************************************************************************************************************************\r\nok: [host_a -> host_a] => (item=a)\r\nok: [host_a -> host_a] => (item=b)\r\nskipping: [host_b] => (item=c)\r\nskipping: [host_b] => (item=d)\r\nskipping: [host_c] => (item=e)\r\nskipping: [host_c] => (item=f)\r\n\r\nTASK [show global_cache after adding host_a peers] *********************************************************************************************************************************\r\nok: [host_a] => {\r\n    \"hostvars[cache_host]['global_cache']\": [\r\n        \"b\"\r\n    ]\r\n}\r\n\r\nTASK [add local peers to global cache] *********************************************************************************************************************************************\r\nskipping: [host_a] => (item=a)\r\nskipping: [host_a] => (item=b)\r\nok: [host_b -> host_a] => (item=c)\r\nok: [host_b -> host_a] => (item=d)\r\nskipping: [host_c] => (item=e)\r\nskipping: [host_c] => (item=f)\r\n\r\nTASK [show global_cache after adding host_b peers] *********************************************************************************************************************************\r\nok: [host_a] => {\r\n    \"hostvars[cache_host]['global_cache']\": [\r\n        \"b\",\r\n        \"d\"\r\n    ]\r\n}\r\n\r\nTASK [add local peers to global cache] *********************************************************************************************************************************************\r\nskipping: [host_a] => (item=a)\r\nskipping: [host_a] => (item=b)\r\nskipping: [host_b] => (item=c)\r\nskipping: [host_b] => (item=d)\r\nok: [host_c -> host_a] => (item=e)\r\nok: [host_c -> host_a] => (item=f)\r\n\r\nTASK [show global_cache after adding host_c peers] *********************************************************************************************************************************\r\nok: [host_a] => {\r\n    \"hostvars[cache_host]['global_cache']\": [\r\n        \"b\",\r\n        \"d\",\r\n        \"f\"\r\n    ]\r\n}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************\r\nhost_a                     : ok=7    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0\r\nhost_b                     : ok=2    changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0\r\nhost_c                     : ok=2    changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0\r\n```\r\n",
        "created_at": "2019-09-27T11:51:16Z",
        "user": "ghost",
        "labels": [
            "python3",
            "test",
            "module",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified",
            "utilities"
        ]
    },
    {
        "number": 62826,
        "title": "pip module always set to changed when using check mode",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nThe pip module will always be 'changed' when using a virtualenv and when running in check mode.\r\n\r\nThis is caused by [this block](https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/packaging/language/pip.py#L472) in the pip module:\r\n```python\r\ndef setup_virtualenv(module, env, chdir, out, err):\r\n    if module.check_mode:\r\n        module.exit_json(changed=True)\r\n    ...\r\n```\r\nInstead of actually checking if the virtualenv exists and if all the requirements are present.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nPip module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.8.5\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nAll OS'es\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Test pip\r\n  hosts: 127.0.0.1\r\n  connection: local\r\n\r\n  pre_tasks:\r\n    - name: Create test dir\r\n      file:\r\n        path: /tmp/test-playbook/\r\n        state: directory\r\n\r\n    - name: Create requirements.txt\r\n      copy:\r\n        dest: /tmp/test-playbook/requirements.txt\r\n        content: \"ansible==2.8.5\"\r\n\r\n    - name: Install virtualenv\r\n      pip:\r\n        requirements: /tmp/test-playbook/requirements.txt\r\n        virtualenv: /tmp/test-playbook/venv\r\n        virtualenv_python: python3\r\n```\r\n\r\nFirst execute this playbook with `ansible-playbook test.yml` and then run `ansible-playbook --check test.yml`.\r\n\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nThe \"Install virtualenv\" task should not be changed.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nThe task shows that it's changed.\r\n\r\n\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n/t/test-playbook \u276f\u276f\u276f ansible-playbook test.yml --check\r\n [WARNING]: No inventory was parsed, only implicit localhost is available\r\n\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\n\r\nPLAY [Test pip] *******************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ************************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Create test dir] ************************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Create requirements.txt] ****************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Install virtualenv] *********************************************************************************************************************************************************************\r\nchanged: [127.0.0.1]\r\n\r\nPLAY RECAP ************************************************************************************************************************************************************************************\r\n127.0.0.1                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\nNote: when running the playbook without check mode, it is not changed.\r\n```\r\n [WARNING]: No inventory was parsed, only implicit localhost is available\r\n\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\n\r\nPLAY [Test pip] *******************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ************************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Create test dir] ************************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Create requirements.txt] ****************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nTASK [Install virtualenv] *********************************************************************************************************************************************************************\r\nok: [127.0.0.1]\r\n\r\nPLAY RECAP ************************************************************************************************************************************************************************************\r\n127.0.0.1                  : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n",
        "created_at": "2019-09-25T12:10:41Z",
        "user": "rien",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3",
            "needs_verified",
            "packaging"
        ]
    },
    {
        "number": 61911,
        "title": "User module does not update user attribute in Alpine docker container",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nI'm trying to update a user's shell in an Alpine docker container using the user module, but it does not get updated. The task is marked as changed or ok, but when I check /etc/passwd the user's shell field is not updated. This works in Ansible 2.7.x and seems to only happen in 2.8.\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nuser module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.8.4\r\n  config file = /home/centos/ansible.cfg\r\n  configured module search path = ['/home/centos/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/centos/venv/lib/python3.6/site-packages/ansible\r\n  executable location = /home/centos/venv/bin/ansible\r\n  python version = 3.6.8 (default, May  2 2019, 20:40:44) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_ROLES_PATH(/home/centos/ansible.cfg) = ['/home/centos/workspace/roles']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nControl machine: CentOS 7\r\nAlpine docker container v3.10.2\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n- pull latest [alpine image](https://hub.docker.com/_/alpine)\r\n- alpine container is running\r\n\r\nexample:\r\n```yaml\r\n- name: Alpine Issue\r\n  hosts: local\r\n\r\n  tasks:\r\n    # making sure to have the shadow package\r\n    - name: install shadow package (needed for user module)\r\n      package:\r\n        name: shadow\r\n        state: present\r\n\r\n    - name: Make temp_user\r\n      user:\r\n        name: temp_user\r\n\r\n    - name: get temp_user /etc/passwd info before update\r\n      command: grep temp_user /etc/passwd\r\n      register: temp_user_info\r\n\r\n    - name: print temp_user info\r\n      debug:\r\n        msg:\r\n          - \"{{ temp_user_info.stdout }}\"\r\n    \r\n    - name: update shell for temp_user\r\n      user:\r\n        name: temp_user\r\n        shell: /sbin/nologin\r\n\r\n    - name: get temp_user /etc/passwd info after update\r\n      command: grep temp_user /etc/passwd\r\n      register: temp_user_info_after\r\n\r\n    - name: print temp_user info\r\n      debug:\r\n        msg:\r\n          - \"{{ temp_user_info_after.stdout }}\"\r\n    \r\n    - name: remove user\r\n      user:\r\n        name: temp_user\r\n        state: absent\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\ntemp_user's shell gets updated to `/sbin/nologin`\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n(venv) [centos@ansible-control ~]$ ansible-playbook ansible_issue.yml\r\n\r\nPLAY [Alpine Issue] *************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************\r\nok: [alpine_container]\r\n\r\nTASK [install shadow package (needed for user module)] **************************************************************\r\nok: [alpine_container]\r\n\r\nTASK [Make temp_user] ***********************************************************************************************\r\nchanged: [alpine_container]\r\n\r\nTASK [get temp_user /etc/passwd info before update] *****************************************************************\r\nchanged: [alpine_container]\r\n\r\nTASK [print temp_user info] *****************************************************************************************\r\nok: [alpine_container] => {\r\n    \"msg\": [\r\n        \"temp_user:x:1000:1000:Linux User,,,:/home/temp_user:/bin/ash\"\r\n    ]\r\n}\r\n\r\nTASK [update shell for temp_user] ***********************************************************************************\r\nok: [alpine_container]\r\n\r\nTASK [get temp_user /etc/passwd info after update] ******************************************************************\r\nchanged: [alpine_container]\r\n\r\nTASK [print temp_user info] *****************************************************************************************\r\nok: [alpine_container] => {\r\n    \"msg\": [\r\n        \"temp_user:x:1000:1000:Linux User,,,:/home/temp_user:/bin/ash\"\r\n    ]\r\n}\r\n\r\nTASK [remove user] **************************************************************************************************\r\nchanged: [alpine_container]\r\n\r\nPLAY RECAP **********************************************************************************************************\r\nalpine_container           : ok=9    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n```\r\n",
        "created_at": "2019-09-06T02:00:50Z",
        "user": "eauser-8",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 61757,
        "title": "[Bug] import_role does not respect sudirectories",
        "body": "##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### SUMMARY\r\n`include_role` respects sudirectories, but `import_role` does not.\r\n\r\n##### STEPS TO REPRODUCE\r\nworks:\r\n````\r\n- include_role: name=myrole tasks_from=foo/bar\r\n````\r\n\r\nfails:\r\n````\r\n- import_role: name=myrole tasks_from=foo/bar\r\n````\r\n\r\nerror:\r\n> ERROR! Could not find specified file in role: foo/bar\r\n\r\n##### ANSIBLE VERSION\r\nubuntu 19.04\r\nansible 2.8.4\r\n",
        "created_at": "2019-09-04T08:54:31Z",
        "user": "lonix1",
        "labels": [
            "module",
            "needs_template",
            "support:core",
            "bug",
            "P3",
            "verified",
            "utilities",
            "affects_2.10"
        ]
    },
    {
        "number": 61527,
        "title": "Role dep cycle detection broken on Py3.7+",
        "body": "##### SUMMARY\r\nAnsible's role cycle \"detection\" relied on the fact that stack overflows were recoverable in Python < 3.7- they'd catch (any old) RuntimeError and display a fatal message that a cycle was detected. This no longer works in 3.7+, and instead results in a crash with SIGABRT. \r\n\r\nThe recursive role dependency loader needs to explicitly detect cycles. Until then, the unit test for the cycle case in `units.playbook.role.test_role.TestRole.test_load_role_with_metadata` has been commented out.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nrole metadata\r\n\r\n##### ANSIBLE VERSION\r\n2.9.0dev0\r\n\r\n##### CONFIGURATION\r\nNA\r\n##### OS / ENVIRONMENT\r\nNA\r\n\r\n##### STEPS TO REPRODUCE\r\nuncomment the cycle unit test above, and run it on Py3.7+\r\n\r\n##### EXPECTED RESULTS\r\nsuccess\r\n\r\n##### ACTUAL RESULTS\r\nfail with SIGABRT\r\n",
        "created_at": "2019-08-29T08:50:35Z",
        "user": "nitzmahone",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 61176,
        "title": "apt update_cache=yes Failed to lock apt for exclusive operation when /var/lib/apt/lists does not exist.",
        "body": "##### SUMMARY\r\n\r\nWhen `/var/lib/apt/lists/` does not exists, `update_cache=yes` will failed by:\r\n\r\n```json\r\n{\r\n    \"changed\": false,\r\n    \"msg\": \"Failed to lock apt for exclusive operation\"\r\n}\r\n```\r\n\r\nBut when I create the `/var/lib/apt/lists/` manually or just `apt-get update`, it works.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.8.4\r\n  config file = /c/Users/fengyu/projects/ansible_playbooks/ansible.cfg\r\n  configured module search path = ['/c/Users/fengyu/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.4 (default, Jul 11 2019, 09:35:14) [GCC 9.1.0]\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\ntarget OS: Ubuntu Server 18.04\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHere is the recurrence:\r\n\r\n```bash\r\nrm -fr /var/lib/apt/lists\r\n# Failed\r\nansible -i hosts barn-new -m apt -a 'update_cache=yes'\r\n\r\nmkdir -p /var/lib/apt/lists/ \r\n# or\r\napt update\r\n# then\r\nansible -i hosts barn-new -m apt -a 'update_cache=yes'\r\n# { \"cache_update_time\": 1566483301, \"cache_updated\": true, \"changed\": true }\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`update_cache=yes` should automatic refresh cache by `apt-get update`.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n```json\r\n{\r\n    \"changed\": false,\r\n    \"msg\": \"Failed to lock apt for exclusive operation\"\r\n}\r\n```\r\n",
        "created_at": "2019-08-22T14:19:23Z",
        "user": "abcfy2",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified",
            "packaging"
        ]
    },
    {
        "number": 61025,
        "title": "any_errors_fatal not accepting variables",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\n- any_errors_true always runs as \"true\" when trying to use a variable (any_errors_true: \"{{ foo }}\")\r\n- String under setting fails as well (any_errors_fatal: \"False\")\r\n- Works as intended if defined statically (any_errors_fatal: False)\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nany_errors_fatal\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.8.4\r\n  config file = /private/etc/ansible/ansible.cfg\r\n  configured module search path = ['/Users/jspringe/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/Cellar/ansible/2.8.4/libexec/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.4 (default, Jul  9 2019, 18:13:23) [Clang 10.0.1 (clang-1001.0.46.4)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_SSH_CONTROL_PATH(/private/etc/ansible/ansible.cfg) = ~/.ssh/mux-%r@%h:%p\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/private/etc/ansible/ansible.cfg) = ['/etc/ansible/plugins']\r\nDEFAULT_CALLBACK_WHITELIST(/private/etc/ansible/ansible.cfg) = ['timer', 'profile_roles', 'task_roles']\r\nDEFAULT_GATHERING(/private/etc/ansible/ansible.cfg) = explicit\r\nDEFAULT_HOST_LIST(/private/etc/ansible/ansible.cfg) = ['/etc/ansible/host']\r\nHOST_KEY_CHECKING(/private/etc/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n- MacOS\r\n- RHEL 7.X\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n- hosts: all\r\n  gather_facts: false\r\n  any_errors_fatal: \"{{ fatal }}\"\r\n  vars:\r\n    fatal: false\r\n  tasks:\r\n  - debug:\r\n      msg: Fatal is set to \"{{ fatal }}\"\r\n\r\n  - fail:\r\n      msg: triggering a failure\r\n    when: \"inventory_hostname == 'localhost'\"\r\n\r\n  - debug:\r\n      msg: I should still run on other hosts\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nWhen a variable is included and set to false, playbook should not trigger fatal_error failure. The playbook should continue as expected. \r\n\r\n```yaml\r\nPLAY [all] **************************************************************************************************************************************************************************\r\n\r\nTASK [debug] ************************************************************************************************************************************************************************\r\nWednesday 21 August 2019  12:23:02 -0400 (0:00:00.113)       0:00:00.113 ******\r\nok: [localhost] => {\r\n    \"msg\": \"Fatal is set to \\\"False\\\"\"\r\n}\r\nok: [rhel-bastion-1] => {\r\n    \"msg\": \"Fatal is set to \\\"False\\\"\"\r\n}\r\n\r\nTASK [fail] *************************************************************************************************************************************************************************\r\nWednesday 21 August 2019  12:23:02 -0400 (0:00:00.050)       0:00:00.163 ******\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"triggering a failure\"}\r\nskipping: [rhel-bastion-1]\r\n\r\nTASK [debug] ************************************************************************************************************************************************************************\r\nWednesday 21 August 2019  12:23:02 -0400 (0:00:00.041)       0:00:00.205 ******\r\nok: [rhel-bastion-1] => {\r\n    \"msg\": \"I should still run on other hosts\"\r\n}\r\n\r\nPLAY RECAP **************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\nrhel-bastion-1             : ok=2    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nPlaybook fails on remaining hosts when a failure is triggered.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [debug] ************************************************************************************************************************************************************************\r\nWednesday 21 August 2019  12:11:23 -0400 (0:00:00.125)       0:00:00.125 ******\r\nok: [localhost] => {\r\n    \"msg\": \"Fatal is set to \\\"False\\\"\"\r\n}\r\nok: [rhel-bastion-1] => {\r\n    \"msg\": \"Fatal is set to \\\"False\\\"\"\r\n}\r\n\r\nTASK [fail] *************************************************************************************************************************************************************************\r\nWednesday 21 August 2019  12:11:23 -0400 (0:00:00.043)       0:00:00.168 ******\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"triggering a failure\"}\r\nskipping: [rhel-bastion-1]\r\n\r\nNO MORE HOSTS LEFT ******************************************************************************************************************************************************************\r\n\r\nPLAY RECAP **************************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\nrhel-bastion-1             : ok=1    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0\r\n```\r\n",
        "created_at": "2019-08-21T16:18:41Z",
        "user": "johannes-cabal",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.14",
            "data_tagging"
        ]
    },
    {
        "number": 60880,
        "title": "Use human-readable 'name' for headings in Common Options in Config docs",
        "body": "##### SUMMARY\r\n\r\nAll the Ansible configuration settings have a `name` field, which seems to be unused currently. On the Ansible Configuration Settings page, under the ['Common Options' section](https://docs.ansible.com/ansible/devel/reference_appendices/config.html#common-options), I see a listing like:\r\n\r\n  - ACTION_WARNINGS\r\n    - details here\r\n  - AGNOSTIC_BECOME_PROMPT\r\n    - details here\r\n  - ...\r\n\r\nThen later in the document, I see another section [Environment Variables](https://docs.ansible.com/ansible/devel/reference_appendices/config.html#environment-variables), which has a listing like:\r\n\r\nANSIBLE_ACTION_WARNINGS\r\n  description here\r\nANSIBLE_AGNOSTIC_BECOME_PROMPT\r\n  description here\r\n\r\nWhen I was looking up the environment variable used to control paths for Collections, I was initially confused because there was a section at the bottom of the page for `ANSIBLE_COLLECTIONS_PATHS`, but then it said \"see also COLLECTIONS_PATHS\"... and that led to some confusion: why are all the configuration options headings ALL_CAPS?\r\n\r\nAre they all environment variables too? Can I use `COLLECTIONS_PATHS` instead of `ANSIBLE_COLLECTIONS_PATHS`, and if so, which one takes precedence?\r\n\r\nI think if the names of the Common Options were human readable text (e.g. `Collections Paths` instead of `COLLECTIONS_PATHS`), it might reduce the amount of potential confusion for someone dropping into the middle of this page from a Google search (how I normally arrive).\r\n\r\n##### ISSUE TYPE\r\n- Documentation Report\r\n\r\n##### COMPONENT NAME\r\n[Ansible Configuration Settings page](https://docs.ansible.com/ansible/devel/reference_appendices/config.html)\r\n\r\n##### ANSIBLE VERSION\r\nN/A\r\n\r\n##### CONFIGURATION\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\nN/A\r\n\r\n##### ADDITIONAL INFORMATION\r\nN/A",
        "created_at": "2019-08-19T17:45:23Z",
        "user": "geerlingguy",
        "labels": [
            "support:core",
            "docs",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 60632,
        "title": "uri: sourcing vaulted file doesn't work",
        "body": "##### SUMMARY\r\n\r\nI'm using `uri` module to send the vaulted file, but Ansible doesn't decrypt it.\r\n\r\n```\r\n    uri:\r\n      url: \"http://localhost:8888/\"\r\n      method: POST\r\n      src: file-encrypted.json\r\n```\r\n\r\nInstead, it's sending raw vault format, despite specifying `--ask-vault-pass`.\r\n\r\n##### ISSUE TYPE\r\n- ~Bug Report~\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nuri\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```paste below\r\nansible 2.8.0\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nn/a\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nmacOS\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a `file.json` with `{'foo': 'bar'}` content.\r\n2. Vault it via: `ansible-vault encrypt file.json`\r\n3. Create the following playbook (e.g. `uri.yml`):\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n  - name: Send JSON file\r\n    uri:\r\n      url: \"http://localhost:8888/\"\r\n      method: POST\r\n      src: file.json\r\n      headers:\r\n        Content-Type: \"application/json\"\r\n```\r\n4. On the other terminal, run the netcat on port 8888: `nc -vl 8888`.\r\n5. Run playbook via: `ansible-playbook uri.yml --ask-vault-pass -vvv`\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nOriginal content of JSON file is sent.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nEncrypted version is received instead:\r\n\r\n```paste below\r\n$  nc -vl 8888\r\nPOST / HTTP/1.1\r\nAccept-Encoding: identity\r\nHost: localhost:8888\r\nUser-Agent: ansible-httpget\r\nContent-Type: application/json\r\nContent-Length: 355\r\nConnection: close\r\n\r\n$ANSIBLE_VAULT;1.1;AES256\r\n39373739353265643239323865303463303638656538663366663330343835353834306462646232\r\n3332326234303438396263663337646134393563333165640a616433366364666161366231326463\r\n```\r\n",
        "created_at": "2019-08-15T11:59:29Z",
        "user": "kenorb",
        "labels": [
            "easyfix",
            "module",
            "net_tools",
            "support:core",
            "has_pr",
            "feature",
            "affects_2.8",
            "P3",
            "hacktoberfest"
        ]
    },
    {
        "number": 60349,
        "title": "yum cleanup is broken",
        "body": "##### SUMMARY\r\nPerforming a one off cleanup task like the cli command `$ yum autoremove` should remove orphaned packages, like previous dependencies. But translated into an ansible task, no changes are applied to the system.\r\n\r\n```yaml\r\n- yum:\r\n    autoremove: yes\r\n```\r\n\r\nQuoting from the docs for the `autoremove` option of the yum module:\r\n\r\n> Should be used alone or when state is absent\r\n\r\nI already spotted the bug (-> PR https://github.com/ansible/ansible/pull/60350), but noticed another issue.\r\n\r\nYum would now remove packages for which I previously set `state=present` via ansible.\r\n\r\nThis is due to the _install reason_ handling of yum. Given a package PARENT and a dependency CHILD. Both packages are not present on the target system. Installing PARENT would set reason to _user_ for PARENT and _dep_ for the CHILD. Installing CHILD explicit would not make any changes to the _install reason_ of it. After removing PARENT and performing an autoremove, the package CHILD is gone too.\r\n\r\nTL;DR Packages that were previously installed as dependency are not marked as user-installed.\r\n\r\n`$ yum install SOME_PACKAGE` would not mark it as well, but we are likely not seeing a change here any time soon. I found some bug reports that seem to be related, but none of them received too much attention (https://bugzilla.redhat.com/show_bug.cgi?id=1177540, can't find the other one) or were marked as duplicate of an unrelated bug (1376597, 1303721).\r\n\r\nIn addition to the PR for the missing autoremove invocation, I am proposing to mark packages installed via ansible with the install reason _user_.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nyum\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.9.0.dev0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/SNIP/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /SNIP/ansible/lib/ansible\r\n  executable location = /SNIP/ansible/venv/bin/ansible\r\n  python version = 2.7.15 SNIP\r\n```\r\na01ee2759d309f8433aefbdaf477903fe0156639\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentOS7\r\nFedora30\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nhttps://github.com/ansible/ansible/issues/60349#issuecomment-526770917\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\norphaned packages are removed, excluding packages that were previously installed via ansible\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nno changes applied",
        "created_at": "2019-08-09T23:26:08Z",
        "user": "das7pad",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "packaging",
            "affects_2.9"
        ]
    },
    {
        "number": 60314,
        "title": "Better error when validate command does not exist",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nError in template module when using `validate` parameter is used\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ntemplate\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.8.3\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/adminsalvo/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.13 (default, Sep 26 2018, 18:42:22) [GCC 6.3.0 20170516]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_LOAD_CALLBACK_PLUGINS(/etc/ansible/ansible.cfg) = False\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /home/adminsalvo/ansible.log\r\nINTERPRETER_PYTHON(/etc/ansible/ansible.cfg) = /usr/bin/python\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nansible controller: Debian 9.9\r\nansible target: Debian 10 (buster)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nI use ansible in order to render haproxy.cfg file and I use the template module. If the target is Debian 10, I receive an exception. The same playbook runs fine on other Debian version\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n       - name: haproxy template\r\n         template:\r\n           src: templates/haproxy.cfg.j2\r\n           dest: /etc/haproxy/haproxy.cfg\r\n           validate: \"haproxy -c -f %s\"\r\n         notify:\r\n          - reload haproxy\r\n         tags:\r\n          - haproxy\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nok or changed\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nI receive `file not found`\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [haproxy template] *********************************************************************************************************************************************************************************************************************\r\ntask path: /home/adminsalvo/haproxytpl/haproxy_configuration.yml:83\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, '/home/adminsalvo\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650 `\" && echo ansible-tmp-1565358755.58-250077078598650=\"` echo /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650 `\" ) && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, 'ansible-tmp-1565358755.58-250077078598650=/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python2.7/dist-packages/ansible/modules/files/stat.py\r\n<vt-btdeblbcl01n01> PUT /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpwJ2B2O TO /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_stat.py\r\n<vt-btdeblbcl01n01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 '[vt-btdeblbcl01n01]'\r\n<vt-btdeblbcl01n01> (0, 'sftp> put /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpwJ2B2O /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_stat.py\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 6 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/adminsalvo size 0\\r\\ndebug3: Looking up /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpwJ2B2O\\r\\ndebug3: Sent message fd 6 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_stat.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:8065\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 8065 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'chmod u+x /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/ /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_stat.py && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, '', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 -tt vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'su  root -c '\"'\"'\"'\"'\"'\"'\"'\"'/bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-nlekwtpveakgvtbteejsqnsxzytdrgcv ; /usr/bin/python /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_stat.py'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"''\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<vt-btdeblbcl01n01> (0, '\\r\\n\\r\\n{\"invocation\": {\"module_args\": {\"checksum_algorithm\": \"sha1\", \"get_checksum\": true, \"follow\": false, \"path\": \"/etc/haproxy/haproxy.cfg\", \"get_md5\": null, \"get_mime\": true, \"get_attributes\": true}}, \"stat\": {\"charset\": \"us-ascii\", \"uid\": 0, \"exists\": true, \"attr_flags\": \"e\", \"woth\": false, \"isreg\": true, \"device_type\": 0, \"mtime\": 1565348675.4864147, \"block_size\": 4096, \"inode\": 260432, \"isgid\": false, \"size\": 4944, \"executable\": false, \"isuid\": false, \"readable\": true, \"version\": \"1888867132\", \"pw_name\": \"root\", \"gid\": 0, \"ischr\": false, \"wusr\": true, \"writeable\": true, \"mimetype\": \"text/plain\", \"blocks\": 16, \"xoth\": false, \"islnk\": false, \"nlink\": 1, \"issock\": false, \"rgrp\": true, \"gr_name\": \"root\", \"path\": \"/etc/haproxy/haproxy.cfg\", \"xusr\": false, \"atime\": 1565348677.226422, \"isdir\": false, \"ctime\": 1565348675.7984161, \"isblk\": false, \"wgrp\": false, \"checksum\": \"8d181aad026051e40e2b9508dbd5537665702daf\", \"dev\": 65024, \"roth\": true, \"isfifo\": false, \"mode\": \"0644\", \"xgrp\": false, \"rusr\": true, \"attributes\": [\"extents\"]}, \"changed\": false}\\r\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\nShared connection to vt-btdeblbcl01n01 closed.\\r\\n')\r\n<vt-btdeblbcl01n01> PUT /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmp1MniVQ/haproxy.cfg.j2 TO /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\r\n<vt-btdeblbcl01n01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 '[vt-btdeblbcl01n01]'\r\n<vt-btdeblbcl01n01> (0, 'sftp> put /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmp1MniVQ/haproxy.cfg.j2 /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 6 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/adminsalvo size 0\\r\\ndebug3: Looking up /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmp1MniVQ/haproxy.cfg.j2\\r\\ndebug3: Sent message fd 6 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:4943\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 4943 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'chmod u+x /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/ /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, '', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/lib/python2.7/dist-packages/ansible/modules/files/copy.py\r\n<vt-btdeblbcl01n01> PUT /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpW01ZSK TO /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_copy.py\r\n<vt-btdeblbcl01n01> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 '[vt-btdeblbcl01n01]'\r\n<vt-btdeblbcl01n01> (0, 'sftp> put /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpW01ZSK /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_copy.py\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 6 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/adminsalvo size 0\\r\\ndebug3: Looking up /home/adminsalvo/.ansible/tmp/ansible-local-143088GWdDIC/tmpW01ZSK\\r\\ndebug3: Sent message fd 6 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_copy.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:7 O:98304 S:12228\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 32768 bytes at 65536\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 7 12228 bytes at 98304\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'chmod u+x /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/ /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_copy.py && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, '', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 -tt vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'su  root -c '\"'\"'\"'\"'\"'\"'\"'\"'/bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-iteaflnvnzgwiwemxonvzjflbulfibai ; /usr/bin/python /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/AnsiballZ_copy.py'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"'\"''\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<vt-btdeblbcl01n01> (1, '\\r\\n\\r\\n{\"exception\": \"WARNING: The below traceback may *not* be related to the actual failure.\\\\n  File \\\\\"/tmp/ansible_copy_payload_tqQYr5/ansible_copy_payload.zip/ansible/module_utils/basic.py\\\\\", line 2561, in run_command\\\\n    cmd = subprocess.Popen(args, **kwargs)\\\\n  File \\\\\"/usr/lib/python2.7/subprocess.py\\\\\", line 394, in __init__\\\\n    errread, errwrite)\\\\n  File \\\\\"/usr/lib/python2.7/subprocess.py\\\\\", line 1047, in _execute_child\\\\n    raise child_exception\\\\n\", \"cmd\": \"haproxy -c -f /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\", \"failed\": true, \"rc\": 2, \"invocation\": {\"module_args\": {\"directory_mode\": null, \"force\": true, \"remote_src\": null, \"_original_basename\": \"haproxy.cfg.j2\", \"owner\": null, \"follow\": false, \"local_follow\": null, \"group\": null, \"unsafe_writes\": null, \"serole\": null, \"content\": null, \"setype\": null, \"dest\": \"/etc/haproxy/haproxy.cfg\", \"selevel\": null, \"regexp\": null, \"validate\": \"haproxy -c -f %s\", \"src\": \"/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\", \"checksum\": \"0944496867bccc552a413600c02837137fffba9a\", \"seuser\": null, \"delimiter\": null, \"mode\": null, \"attributes\": null, \"backup\": false}}, \"msg\": \"[Errno 2] No such file or directory\"}\\r\\n', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 1\\r\\nShared connection to vt-btdeblbcl01n01 closed.\\r\\n')\r\n<vt-btdeblbcl01n01> Failed to connect to the host via ssh: OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 142997\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 1\r\nShared connection to vt-btdeblbcl01n01 closed.\r\n<vt-btdeblbcl01n01> ESTABLISH SSH CONNECTION FOR USER: None\r\n<vt-btdeblbcl01n01> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/home/adminsalvo/.ansible/cp/53efca6490 vt-btdeblbcl01n01 '/bin/sh -c '\"'\"'rm -f -r /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<vt-btdeblbcl01n01> (0, '', 'OpenSSH_7.4p1 Debian-10+deb9u6, OpenSSL 1.0.2s  28 May 2019\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 19: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 142997\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nThe full traceback is:\r\nWARNING: The below traceback may *not* be related to the actual failure.\r\n  File \"/tmp/ansible_copy_payload_tqQYr5/ansible_copy_payload.zip/ansible/module_utils/basic.py\", line 2561, in run_command\r\n    cmd = subprocess.Popen(args, **kwargs)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 394, in __init__\r\n    errread, errwrite)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 1047, in _execute_child\r\n    raise child_exception\r\n\r\nfatal: [vt-btdeblbcl01n01]: FAILED! => {\r\n    \"changed\": false,\r\n    \"checksum\": \"0944496867bccc552a413600c02837137fffba9a\",\r\n    \"cmd\": \"haproxy -c -f /home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\",\r\n    \"diff\": [],\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_original_basename\": \"haproxy.cfg.j2\",\r\n            \"attributes\": null,\r\n            \"backup\": false,\r\n            \"checksum\": \"0944496867bccc552a413600c02837137fffba9a\",\r\n            \"content\": null,\r\n            \"delimiter\": null,\r\n            \"dest\": \"/etc/haproxy/haproxy.cfg\",\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"force\": true,\r\n            \"group\": null,\r\n            \"local_follow\": null,\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"regexp\": null,\r\n            \"remote_src\": null,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": \"/home/adminsalvo/.ansible/tmp/ansible-tmp-1565358755.58-250077078598650/source\",\r\n            \"unsafe_writes\": null,\r\n            \"validate\": \"haproxy -c -f %s\"\r\n        }\r\n    },\r\n    \"msg\": \"[Errno 2] No such file or directory\",\r\n    \"rc\": 2\r\n}\r\n\r\n```\r\n",
        "created_at": "2019-08-09T14:16:37Z",
        "user": "Gianlu",
        "labels": [
            "module",
            "support:core",
            "bug",
            "traceback",
            "affects_2.8",
            "P3",
            "files"
        ]
    },
    {
        "number": 60311,
        "title": "git module does not need `repo` if update and clone is both set to no",
        "body": "### SUMMARY\r\nThe git module needs `repo` set if a checked-out tree already exists and it should neither clone nor update the working directory.  A use case is getting the latest commits shasum.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ngit\r\n\r\n##### ANSIBLE VERSION\r\nansible 2.8.2\r\n\r\n##### CONFIGURATION\r\n\r\nansible localhost -m git -a 'clone=no update=no repo=oeu dest=../website\r\n\r\n##### OS / ENVIRONMENT\r\nall\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nansible localhost -m git -a 'clone=no update=no dest=../path-to-wd\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n```\r\nlocalhost | SUCCESS => {\r\n    \"after\": \"3b387e6c4ace16a5cb8573e7908920d062ff9f2c\",\r\n    \"before\": \"3b387e6c4ace16a5cb8573e7908920d062ff9f2c\",\r\n    \"changed\": false\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nlocalhost | FAILED! => {                                                                                  \u2502~                                                                                                        \r\n    \"changed\": false,                                                                                     \u2502~                                                                                                        \r\n    \"msg\": \"missing required arguments: repo\"                                                             \u2502~                                                                                                        \r\n}                                                                                                         \u2502~                                                                                                        \r\n```",
        "created_at": "2019-08-09T11:38:37Z",
        "user": "ibotty",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified",
            "source_control"
        ]
    },
    {
        "number": 60077,
        "title": "Ansible fails to report matching but broken symlink in host_vars directory",
        "body": "##### SUMMARY\r\nThe host_vars directory contains a symlink that matches a host but is broken (i.e. target does not exist). Ansible fails to warn or error on this and silently continues.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nAnsible core\r\n\r\n##### ANSIBLE VERSION\r\n2.8.0\r\n\r\n##### CONFIGURATION\r\nn/a\r\n\r\n##### OS / ENVIRONMENT\r\nUbuntu controlling machine / CentOS target\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a symlink in host_vars directory that matches a host but is broken. Rely on a variable defined in the said broken file and see the run fail.\r\n\r\n##### EXPECTED RESULTS\r\nWarning or error.\r\n\r\n##### ACTUAL RESULTS\r\nSilence.",
        "created_at": "2019-08-05T15:26:25Z",
        "user": "ljalbinson",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 60008,
        "title": "Using \"update_only\" attribute with yum module reports different results in check mode",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nI have a behavior that has existed since 2.5 (when the \"update_only: yes\" attribute was added to the yum module) and still exists with 2.8:\r\n\r\nWhen using the attribute \"update_only: yes\" with the yum module when updating specific packages on a system to their latest version, when it comes across a package that is not currently installed, the output incorrectly reports it as \"changed\" when it check mode (using the \"--check\" option).\u00a0 When not in check mode and doing it for real, it correctly reports the same uninstalled package step with \"ok:\" (no change).\u00a0 It's only in check mode that it doesn't report correctly what it would do for real, so you get two different results for check mode vs. non-check mode, and can't use check mode to properly check whether systems have been updated.\u00a0 Is this a bug?\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nyum module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n# ansible --version\r\nansible 2.8.3\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/etc/ansible/library']\r\n  ansible python module location = /usr/local/conda-py3.7-x86_64/envs/ansible-py3/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/conda-py3.7-x86_64/envs/ansible-py3/bin/ansible\r\n  python version = 3.7.3 (default, Mar 27 2019, 22:11:17) [GCC 7.3.0]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTarget OS:  RHEL7, RHEL6\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n--Run a playbook with the \"yum\" module to update specific packages to their latest version (state: latest), and which contains the \"update_only: yes\" directive so as to only update the package if it is already installed.\r\n--If you run the playbook WITH the \"--check\" option, it incorrectly shows packages that are not yet installed as \"changed\", indicating that it would make a change to the system.\r\n--If you run the package WITHOUT the \"--check\" option, it correctly shows packages that are not yet installed as \"ok\", and makes no changes.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nI should receive the same results both with and without using the \"--check\" option.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2019-08-02T18:28:23Z",
        "user": "mpilgrim8",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "needs_verified",
            "packaging"
        ]
    },
    {
        "number": 59813,
        "title": "systemd module misses to 'enable' when Install section has changed",
        "body": "##### SUMMARY\r\nUpon changing the `[Install]` section of an unit file, the unit should be enabled again for changes to take effect, `systemctl` [documentation](https://www.freedesktop.org/software/systemd/man/systemctl.html#enable%20UNIT%E2%80%A6)\r\n\r\nAs far as I can tell from [systemd.py](https://github.com/ansible/ansible/blob/691976c3d0be3c5c29ff92da46cf8b1d7cacb233/lib/ansible/modules/system/systemd.py#L460) if the unit changes after the first `enable` then it'll never be changed again unless cycling through disable/enable, and thus changes to `[Install]` are never applied.\r\n\r\nI couldn't find this behavior documented, and found it surprising. I'd like the module to take care of this but having the behavior documented might be enough too!\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nsystemd\r\n\r\n##### ANSIBLE VERSION\r\nhttps://github.com/ansible/ansible/commit/691976c3d0be3c5c29ff92da46cf8b1d7cacb233\r\n\r\n##### OS / ENVIRONMENT\r\nLinux / systemd",
        "created_at": "2019-07-30T19:41:58Z",
        "user": "filippog",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system",
            "affects_2.9"
        ]
    },
    {
        "number": 59401,
        "title": "ansible_play_host vars don't always match play",
        "body": "##### SUMMARY\r\nWhen mid-play dynamic inventory actions (eg `add_host`, `meta: refresh_inventory` that causes hosts to appear/disappear) affect the host list for the currently-running play, `ansible_play_hosts` and `ansible_play_hosts_all` don't always reflect the current reality.\r\n\r\nBy design, the in-flight play will not start running tasks on newly-added hosts, but it will *stop* running tasks on hosts that have disappeared.\r\n\r\nNewly-created hosts from an inventory refresh are immediately visible in `ansible_play_hosts`, even though they're not executing. Hosts added by an `add_host` do *not* appear in `ansible_play_hosts`. The behavior should probably be consistent, and favor reflecting what the current play is actually doing (ie the inventory refresh behavior seems incorrect).\r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nStrategyBase\r\n\r\n##### ANSIBLE VERSION\r\n2.8\r\n\r\n##### CONFIGURATION\r\nNA\r\n\r\n##### OS / ENVIRONMENT\r\nNA\r\n\r\n##### STEPS TO REPRODUCE\r\nAdd a host mid-play via `meta: refresh_inventory`, dump `ansible_play_hosts`, note that the new host appears in the list. Add another host via `add_host` in the same play, dump `ansible_play_hosts`, note that the newest host does *not* appear.\r\n\r\n##### EXPECTED RESULTS\r\nConsistent behavior between dynamically-added hosts- preferably that `ansible_play_hosts` always shows the actual list of hosts executing for the current play at the current time.\r\n\r\n##### ACTUAL RESULTS\r\nNewly-added dynamic inventory-sourced hosts show up in `ansible_play_hosts`.",
        "created_at": "2019-07-22T19:01:17Z",
        "user": "nitzmahone",
        "labels": [
            "support:core",
            "bug",
            "needs_verified",
            "affects_2.16"
        ]
    },
    {
        "number": 58787,
        "title": "Privilage escalation prompt timeout when working in a loop with different users",
        "body": "##### SUMMARY\r\nAnsible reports password escalation prompt timeout when running a task with a loop, but only during 2nd iteration when using `ansible_connection=local`. The first iteration passes. See the attached playbook for a repro and details.\r\n\r\nThis is a change compared to older versions. I am not 100% sure but I think 2.7 did not have this behaviour, it started happening during last 1-2 months.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nbecome, privilege escalation\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.8.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/vespian/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.3 (default, May 11 2019, 00:45:16) [GCC 8.3.1 20190223 (Red Hat 8.3.1-2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_FORKS(/etc/ansible/ansible.cfg) = 5\r\nDEFAULT_GATHERING(/etc/ansible/ansible.cfg) = implicit\r\nDEFAULT_JINJA2_EXTENSIONS(/etc/ansible/ansible.cfg) = jinja2.ext.do,jinja2.ext.i18n\r\nDEFAULT_LOCAL_TMP(/etc/ansible/ansible.cfg) = /home/vespian/.ansible/tmp/ansible-local-17565m8xdgny3\r\nDEFAULT_POLL_INTERVAL(/etc/ansible/ansible.cfg) = 15\r\nDEFAULT_TRANSPORT(/etc/ansible/ansible.cfg) = ssh\r\nDIFF_ALWAYS(/etc/ansible/ansible.cfg) = True\r\nRETRY_FILES_ENABLED(/etc/ansible/ansible.cfg) = False\r\n```\r\nThe problem manifests itself only when using `ansible_connection=local`, it works on remote hosts.\r\n\r\n##### OS / ENVIRONMENT\r\nx86_64, Fedora 29\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Sample playbook\r\n  hosts:\r\n    - budrys\r\n    - engel2\r\n  tasks:\r\n    - name: checkout plugins from upstream git repos\r\n      command: whoami\r\n      become: yes\r\n      become_user: \"{{ item[1] }}\"\r\n      with_nested:\r\n        - - a\r\n          - b\r\n          - c\r\n        - - vespian\r\n          - root\r\n          - kamila\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nThe loop is executed without errors\r\n\r\n##### ACTUAL RESULTS\r\nThe loop is unable to execute due to password prompt timeout error\r\n```paste below\r\n$ ap -l budrys -D -K /tmp/playbook.yml\r\nBECOME password:\r\n\r\nPLAY [Sample playbook] *******************************************************************************************************\r\n\r\nTASK [Gathering Facts] *******************************************************************************************************\r\nok: [budrys]\r\n\r\nTASK [checkout plugins from upstream git repos] ******************************************************************************\r\nchanged: [budrys] => (item=['a', 'vespian'])\r\nchanged: [budrys] => (item=['a', 'root'])\r\nchanged: [budrys] => (item=['a', 'kamila'])\r\nfatal: [budrys]: FAILED! => {\"msg\": \"timeout waiting for privilege escalation password prompt:\\n\"}\r\n\r\nPLAY RECAP *******************************************************************************************************************\r\nbudrys                     : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\r\n```\r\nOn a remote hosts, it works though (removed user `kamila` from the playbook as it is not present on the host`):\r\n```\r\n$ ap -l engel2 -D -K /tmp/playbook.yml\r\nBECOME password:\r\n\r\nPLAY [Sample playbook] **********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************************************\r\nok: [engel2]\r\n\r\nTASK [checkout plugins from upstream git repos] **********************************************************************************************************************************\r\nchanged: [engel2] => (item=['a', 'vespian'])\r\nchanged: [engel2] => (item=['a', 'root'])\r\nchanged: [engel2] => (item=['b', 'vespian'])\r\nchanged: [engel2] => (item=['b', 'root'])\r\nchanged: [engel2] => (item=['c', 'vespian'])\r\nchanged: [engel2] => (item=['c', 'root'])\r\n\r\nPLAY RECAP **********************************************************************************************************************************\r\nengel2                     : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n\r\n```\r\n",
        "created_at": "2019-07-06T15:19:08Z",
        "user": "vespian",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3",
            "verified"
        ]
    },
    {
        "number": 58723,
        "title": "Xcode crashes when run as ansible created user",
        "body": "##### SUMMARY\r\nCreating a basic user through ansible on a macOS system results in a partially unusable user account. Deleting the user and recreating it using the GUI User tool results in a working user.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nuser\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.1\r\n  config file = /Users/palmerc/Development/macansible/ansible.cfg\r\n  configured module search path = [u'/Users/palmerc/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/palmerc/.pyenv/versions/2.7.15/lib/python2.7/site-packages/ansible\r\n  executable location = /Users/palmerc/.pyenv/versions/2.7.15/bin/ansible\r\n  python version = 2.7.15 (default, Nov  7 2018, 14:45:27) [GCC 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nALLOW_WORLD_READABLE_TMPFILES(/Users/palmerc/Development/macansible/ansible.cfg)\r\nDEFAULT_ROLES_PATH(/Users/palmerc/Development/macansible/ansible.cfg) = [u'/User\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nmacOS Mojave 10.14.5\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n- name: Create user\r\n  user:\r\n    name: testuser\r\n    comment: \"TestUser\"\r\n    groups:\r\n      - staff\r\n      - com.apple.access_ssh\r\n    password: \"SECRET\"\r\n    shell: /bin/bash\r\n    state: present\r\n    system: no\r\n  become: yes\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nFully functional user\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nProcess:               Xcode [39209]\r\nPath:                  /Applications/Xcode.app/Contents/MacOS/Xcode\r\nIdentifier:            com.apple.dt.Xcode\r\nVersion:               10.2.1 (14490.122)\r\nBuild Info:            IDEFrameworks-14490122000000000~6\r\nCode Type:             X86-64 (Native)\r\nParent Process:        ??? [1]\r\nResponsible:           Xcode [39209]\r\nUser ID:               503\r\n\r\nDate/Time:             2019-07-04 14:05:01.437 +0200\r\nOS Version:            Mac OS X 10.14.5 (18F132)\r\nReport Version:        12\r\nBridge OS Version:     3.5 (16P5125)\r\nAnonymous UUID:        8FE4FC24-0BFD-358B-D7E1-4D665576081F\r\n\r\n\r\nTime Awake Since Boot: 230000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        1  Dispatch queue: com.apple.libdispatch-io.opq\r\n\r\nException Type:        EXC_BAD_INSTRUCTION (SIGILL)\r\nException Codes:       0x0000000000000001, 0x0000000000000000\r\nException Note:        EXC_CORPSE_NOTIFY\r\n\r\nTermination Signal:    Illegal instruction: 4\r\nTermination Reason:    Namespace SIGNAL, Code 0x4\r\nTerminating Process:   exc handler [39209]\r\n\r\nApplication Specific Information:\r\nProductBuildVersion: 10E1001\r\n\r\nThread 0:: Dispatch queue: com.apple.main-thread\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c22a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff7011c76c mach_msg + 60\r\n2   com.apple.CoreFoundation      \t0x00007fff440b9bee __CFRunLoopServiceMachPort + 328\r\n3   com.apple.CoreFoundation      \t0x00007fff440b915c __CFRunLoopRun + 1612\r\n4   com.apple.CoreFoundation      \t0x00007fff440b88be CFRunLoopRunSpecific + 455\r\n5   com.apple.HIToolbox           \t0x00007fff433a496b RunCurrentEventLoopInMode + 292\r\n6   com.apple.HIToolbox           \t0x00007fff433a46a5 ReceiveNextEventCommon + 603\r\n7   com.apple.HIToolbox           \t0x00007fff433a4436 _BlockUntilNextEventMatchingListInModeWithFilter + 64\r\n8   com.apple.AppKit              \t0x00007fff4173e987 _DPSNextEvent + 965\r\n9   com.apple.AppKit              \t0x00007fff4173d71f -[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 1361\r\n10  com.apple.dt.DVTKit           \t0x00000001011c7862 -[DVTApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 385\r\n11  com.apple.AppKit              \t0x00007fff4173783c -[NSApplication run] + 699\r\n12  com.apple.AppKit              \t0x00007fff41726d7c NSApplicationMain + 777\r\n13  com.apple.dt.Xcode            \t0x000000010091b8a2 main + 578\r\n14  libdyld.dylib                 \t0x00007fff6ffe73d5 start + 1\r\n\r\nThread 1 Crashed:: Dispatch queue: com.apple.libdispatch-io.opq\r\n0   com.apple.dt.IDE.XCBuildSupport\t0x000000012003f287 closure #1 in closure #1 in IDEXCBuildServiceSession.sendPIF(completion:) + 839\r\n1   com.apple.dt.IDE.XCBuildSupport\t0x0000000120049a19 partial apply for closure #1 in closure #1 in IDEXCBuildServiceSession.sendPIF(completion:) + 25\r\n2   com.apple.dt.XCBuild          \t0x00000001200c8854 closure #1 in XCBBuildServiceSession.setUserInfoForUser(_:group:uid:gid:home:processEnvironment:buildSystemEnvironment:usePerConfigurationBuildDirectories:completion:) + 148\r\n3   com.apple.dt.XCBuild          \t0x00000001200cc711 partial apply for closure #1 in XCBBuildServiceSession.setSystemInfo(operatingSystemVersion:productBuildVersion:nativeArchitecture:completion:) + 17\r\n4   com.apple.dt.XCBuild          \t0x00000001200fd917 partial apply for closure #1 in XCBBuildService.sendAsync(_:completion:) + 39\r\n5   com.apple.dt.XCBuild          \t0x00000001200fe4c9 closure #1 in XCBBuildService.sendAsync(_:completion:)partial apply + 9\r\n6   com.apple.dt.XCBuild          \t0x00000001200f6d70 closure #1 in closure #1 in XCBBuildService.send(_:_:) + 368\r\n7   com.apple.dt.XCBuild          \t0x00000001200fc9d1 partial apply for closure #1 in closure #1 in XCBBuildService.send(_:_:) + 17\r\n8   com.apple.dt.XCBuild          \t0x00000001200fe4a9 closure #1 in closure #1 in XCBBuildService.send(_:_:)partial apply + 9\r\n9   com.apple.dt.XCBuild          \t0x00000001201186c0 closure #1 in XCBBuildServiceConnection.send(_:replyHandler:) + 256\r\n10  com.apple.dt.XCBuild          \t0x00000001200fc9f5 partial apply for closure #1 in XCBBuildServiceConnection.send(_:replyHandler:) + 21\r\n11  com.apple.dt.XCBuild          \t0x00000001200fe099 closure #1 in XCBBuildServiceConnection.send(_:replyHandler:)partial apply + 9\r\n12  com.apple.dt.XCBuild          \t0x000000012011a874 partial apply for thunk for @escaping @callee_guaranteed (@unowned UInt64, @in_guaranteed DispatchData) -> () + 20\r\n13  com.apple.dt.XCBuild          \t0x000000012011aa29 thunk for @escaping @callee_guaranteed (@unowned UInt64, @in_guaranteed DispatchData) -> ()partial apply + 9\r\n14  com.apple.dt.XCBuild          \t0x000000012011a5c9 partial apply for thunk for @escaping @callee_guaranteed (@in_guaranteed UInt64, @in_guaranteed DispatchData) -> (@out ()) + 25\r\n15  com.apple.dt.XCBuild          \t0x000000012011a874 partial apply for thunk for @escaping @callee_guaranteed (@unowned UInt64, @in_guaranteed DispatchData) -> () + 20\r\n16  com.apple.dt.XCBuild          \t0x00000001201178c9 closure #1 in closure #1 in XCBBuildServiceConnection.resume() + 969\r\n17  com.apple.dt.XCBuild          \t0x000000012011a4c5 partial apply for closure #1 in closure #1 in XCBBuildServiceConnection.resume() + 21\r\n18  com.apple.dt.XCBuild          \t0x000000012011a501 partial apply for thunk for @callee_guaranteed (@unowned UnsafePointer<UInt8>) -> (@error @owned Error) + 17\r\n19  libswiftDispatch.dylib        \t0x00007fff6fae932f DispatchData.withUnsafeBytes<A, B>(body:) + 127\r\n20  com.apple.dt.XCBuild          \t0x0000000120117435 closure #1 in XCBBuildServiceConnection.resume() + 549\r\n21  com.apple.dt.XCBuild          \t0x000000012011a20c partial apply for closure #1 in XCBBuildServiceConnection.resume() + 12\r\n22  libswiftDispatch.dylib        \t0x00007fff6faf2a77 partial apply for closure #1 in OS_dispatch_io.read(offset:length:queue:ioHandler:) + 71\r\n23  libswiftDispatch.dylib        \t0x00007fff6faeba4e thunk for @escaping @callee_guaranteed (@unowned Bool, @guaranteed OS_dispatch_data?, @unowned Int32) -> () + 62\r\n24  libdispatch.dylib             \t0x00007fff6ffc245d ___dispatch_operation_deliver_data_block_invoke + 109\r\n25  libdispatch.dylib             \t0x00007fff6ff995f8 _dispatch_call_block_and_release + 12\r\n26  libdispatch.dylib             \t0x00007fff6ff9a63d _dispatch_client_callout + 8\r\n27  libdispatch.dylib             \t0x00007fff6ffa08e0 _dispatch_lane_serial_drain + 602\r\n28  libdispatch.dylib             \t0x00007fff6ffa13c6 _dispatch_lane_invoke + 433\r\n29  libdispatch.dylib             \t0x00007fff6ffa0792 _dispatch_lane_serial_drain + 268\r\n30  libdispatch.dylib             \t0x00007fff6ffa1396 _dispatch_lane_invoke + 385\r\n31  libdispatch.dylib             \t0x00007fff6ffa96ed _dispatch_workloop_worker_thread + 598\r\n32  libsystem_pthread.dylib       \t0x00007fff701da611 _pthread_wqthread + 421\r\n33  libsystem_pthread.dylib       \t0x00007fff701da3fd start_wqthread + 13\r\n\r\nThread 2:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 3:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 4:: Dispatch queue: NSOperationQueue 0x7f9e6e886e10 (QOS: UNSPECIFIED)\r\n0   libsystem_kernel.dylib        \t0x00007fff7011f86a __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff701de56e _pthread_cond_wait + 722\r\n2   com.apple.Foundation          \t0x00007fff463be86f -[__NSOperationInternal _waitUntilFinished:] + 858\r\n3   com.apple.Foundation          \t0x00007fff463f3396 -[NSOperationQueue waitUntilAllOperationsAreFinished] + 282\r\n4   com.apple.dt.IDEFoundation    \t0x0000000101c182a4 __75+[IDEBuildOperationGroup operationGroupWithBuildOperation:otherOperations:]_block_invoke + 10\r\n5   com.apple.dt.DVTFoundation    \t0x0000000100a7558a __DVTOPERATIONGROUP_CREATED_BY_CALLEE_IS_WAITING_ON_SUBOPERATIONS__ + 164\r\n6   com.apple.dt.DVTFoundation    \t0x0000000100a757f6 -[DVTOperationGroup main] + 69\r\n7   com.apple.Foundation          \t0x00007fff4632c1dd -[__NSOperationInternal _start:] + 685\r\n8   com.apple.dt.DVTFoundation    \t0x0000000100a757a6 -[DVTOperationGroup start] + 113\r\n9   com.apple.Foundation          \t0x00007fff46356197 __NSOQSchedule_f + 227\r\n10  libdispatch.dylib             \t0x00007fff6ff995f8 _dispatch_call_block_and_release + 12\r\n11  libdispatch.dylib             \t0x00007fff6ff9a63d _dispatch_client_callout + 8\r\n12  libdispatch.dylib             \t0x00007fff6ff9cde6 _dispatch_continuation_pop + 414\r\n13  libdispatch.dylib             \t0x00007fff6ff9c4a3 _dispatch_async_redirect_invoke + 703\r\n14  libdispatch.dylib             \t0x00007fff6ffa83bc _dispatch_root_queue_drain + 324\r\n15  libdispatch.dylib             \t0x00007fff6ffa8b46 _dispatch_worker_thread2 + 90\r\n16  libsystem_pthread.dylib       \t0x00007fff701da6b3 _pthread_wqthread + 583\r\n17  libsystem_pthread.dylib       \t0x00007fff701da3fd start_wqthread + 13\r\n\r\nThread 5:: Dispatch queue: <IDEXCBuildServiceBuildOperation:0x7f9e6ea0cf40:REfc>-builder-queue (QOS: UNSPECIFIED)\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c266 semaphore_wait_trap + 10\r\n1   libdispatch.dylib             \t0x00007fff6ff9abd9 _dispatch_sema4_wait + 16\r\n2   libdispatch.dylib             \t0x00007fff6ff9b3a0 _dispatch_semaphore_wait_slow + 98\r\n3   com.apple.dt.IDE.XCBuildSupport\t0x0000000120029ef1 __56-[IDEXCBuildServiceBuildOperation addOperationsToQueue:]_block_invoke + 155\r\n4   com.apple.Foundation          \t0x00007fff4635655c __NSBLOCKOPERATION_IS_CALLING_OUT_TO_A_BLOCK__ + 7\r\n5   com.apple.Foundation          \t0x00007fff46356464 -[NSBlockOperation main] + 68\r\n6   com.apple.Foundation          \t0x00007fff4632c1dd -[__NSOperationInternal _start:] + 685\r\n7   com.apple.Foundation          \t0x00007fff46356197 __NSOQSchedule_f + 227\r\n8   libdispatch.dylib             \t0x00007fff6ff995f8 _dispatch_call_block_and_release + 12\r\n9   libdispatch.dylib             \t0x00007fff6ff9a63d _dispatch_client_callout + 8\r\n10  libdispatch.dylib             \t0x00007fff6ff9cde6 _dispatch_continuation_pop + 414\r\n11  libdispatch.dylib             \t0x00007fff6ff9c4a3 _dispatch_async_redirect_invoke + 703\r\n12  libdispatch.dylib             \t0x00007fff6ffa83bc _dispatch_root_queue_drain + 324\r\n13  libdispatch.dylib             \t0x00007fff6ffa8b46 _dispatch_worker_thread2 + 90\r\n14  libsystem_pthread.dylib       \t0x00007fff701da6b3 _pthread_wqthread + 583\r\n15  libsystem_pthread.dylib       \t0x00007fff701da3fd start_wqthread + 13\r\n\r\nThread 6:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 7:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 8:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 9:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 10:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 11:: Dispatch queue: activity log section queue\r\n0   libsystem_kernel.dylib        \t0x00007fff7011e9de __ulock_wait + 10\r\n1   libdispatch.dylib             \t0x00007fff6ff9ae19 _dispatch_ulock_wait + 47\r\n2   libdispatch.dylib             \t0x00007fff6ff9aef8 _dispatch_thread_event_wait_slow + 33\r\n3   libdispatch.dylib             \t0x00007fff6ffa637f __DISPATCH_WAIT_FOR_QUEUE__ + 286\r\n4   libdispatch.dylib             \t0x00007fff6ffa5fce _dispatch_sync_f_slow + 171\r\n5   com.apple.dt.DVTFoundation    \t0x0000000100be8fd3 DVTDispatchSync + 168\r\n6   com.apple.dt.IDEFoundation    \t0x0000000101901cbe __59-[IDEActivityLogSectionRecorder _performOrderedAsyncBlock:]_block_invoke_2 + 20\r\n7   com.apple.dt.DVTFoundation    \t0x0000000100be933e __DVTDispatchAsync_block_invoke + 801\r\n8   libdispatch.dylib             \t0x00007fff6ff995f8 _dispatch_call_block_and_release + 12\r\n9   libdispatch.dylib             \t0x00007fff6ff9a63d _dispatch_client_callout + 8\r\n10  libdispatch.dylib             \t0x00007fff6ffa08e0 _dispatch_lane_serial_drain + 602\r\n11  libdispatch.dylib             \t0x00007fff6ffa1396 _dispatch_lane_invoke + 385\r\n12  libdispatch.dylib             \t0x00007fff6ffa96ed _dispatch_workloop_worker_thread + 598\r\n13  libsystem_pthread.dylib       \t0x00007fff701da611 _pthread_wqthread + 421\r\n14  libsystem_pthread.dylib       \t0x00007fff701da3fd start_wqthread + 13\r\n\r\nThread 12:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 13:\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c22a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff7011c76c mach_msg + 60\r\n2   com.apple.CoreFoundation      \t0x00007fff440b9bee __CFRunLoopServiceMachPort + 328\r\n3   com.apple.CoreFoundation      \t0x00007fff440b915c __CFRunLoopRun + 1612\r\n4   com.apple.CoreFoundation      \t0x00007fff440b88be CFRunLoopRunSpecific + 455\r\n5   com.apple.Foundation          \t0x00007fff4631c8ef -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 280\r\n6   com.apple.DTDeviceKitBase     \t0x00000001170a5de1 +[DTDKRemoteDeviceConnection startServiceBrowsers] + 217\r\n7   com.apple.Foundation          \t0x00007fff463126d2 __NSThread__start__ + 1194\r\n8   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n9   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n10  libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 14:\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c22a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff7011c76c mach_msg + 60\r\n2   com.apple.CoreFoundation      \t0x00007fff440b9bee __CFRunLoopServiceMachPort + 328\r\n3   com.apple.CoreFoundation      \t0x00007fff440b915c __CFRunLoopRun + 1612\r\n4   com.apple.CoreFoundation      \t0x00007fff440b88be CFRunLoopRunSpecific + 455\r\n5   com.apple.Foundation          \t0x00007fff4631c8ef -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 280\r\n6   com.apple.DTDeviceKitBase     \t0x00000001170b3c5d -[DTDKRemoteDeviceDataListener listenerThreadImplementation] + 791\r\n7   com.apple.Foundation          \t0x00007fff463126d2 __NSThread__start__ + 1194\r\n8   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n9   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n10  libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 15:: com.apple.CFSocket.private\r\n0   libsystem_kernel.dylib        \t0x00007fff7012361a __select + 10\r\n1   com.apple.CoreFoundation      \t0x00007fff440e7572 __CFSocketManager + 635\r\n2   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n3   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n4   libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 16:: JavaScriptCore bmalloc scavenger\r\n0   libsystem_kernel.dylib        \t0x00007fff7011f86a __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff701de56e _pthread_cond_wait + 722\r\n2   libc++.1.dylib                \t0x00007fff6d219a0a std::__1::condition_variable::wait(std::__1::unique_lock<std::__1::mutex>&) + 18\r\n3   com.apple.JavaScriptCore      \t0x00007fff47595122 void std::__1::condition_variable_any::wait<std::__1::unique_lock<bmalloc::Mutex> >(std::__1::unique_lock<bmalloc::Mutex>&) + 82\r\n4   com.apple.JavaScriptCore      \t0x00007fff4759920b bmalloc::Scavenger::threadRunLoop() + 139\r\n5   com.apple.JavaScriptCore      \t0x00007fff47598a39 bmalloc::Scavenger::threadEntryPoint(bmalloc::Scavenger*) + 9\r\n6   com.apple.JavaScriptCore      \t0x00007fff4759a3a7 void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(bmalloc::Scavenger*), bmalloc::Scavenger*> >(void*) + 39\r\n7   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n8   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n9   libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 17:\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c27e semaphore_timedwait_trap + 10\r\n1   libdispatch.dylib             \t0x00007fff6ff9ac99 _dispatch_sema4_timedwait + 76\r\n2   libdispatch.dylib             \t0x00007fff6ff9b378 _dispatch_semaphore_wait_slow + 58\r\n3   libdispatch.dylib             \t0x00007fff6ffa81fd _dispatch_worker_thread + 317\r\n4   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n5   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n6   libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 18:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 19:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 20:: com.apple.NSEventThread\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c22a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff7011c76c mach_msg + 60\r\n2   com.apple.CoreFoundation      \t0x00007fff440b9bee __CFRunLoopServiceMachPort + 328\r\n3   com.apple.CoreFoundation      \t0x00007fff440b915c __CFRunLoopRun + 1612\r\n4   com.apple.CoreFoundation      \t0x00007fff440b88be CFRunLoopRunSpecific + 455\r\n5   com.apple.AppKit              \t0x00007fff417466a6 _NSEventThread + 175\r\n6   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n7   libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n8   libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 21:: DYMobileDeviceManager\r\n0   libsystem_kernel.dylib        \t0x00007fff7011c22a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff7011c76c mach_msg + 60\r\n2   com.apple.CoreFoundation      \t0x00007fff440b9bee __CFRunLoopServiceMachPort + 328\r\n3   com.apple.CoreFoundation      \t0x00007fff440b915c __CFRunLoopRun + 1612\r\n4   com.apple.CoreFoundation      \t0x00007fff440b88be CFRunLoopRunSpecific + 455\r\n5   com.apple.Foundation          \t0x00007fff4631c8ef -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 280\r\n6   com.apple.Foundation          \t0x00007fff4631c7c4 -[NSRunLoop(NSRunLoop) run] + 76\r\n7   com.apple.GPUToolsMobileFoundation\t0x000000011e23306e -[DYMobileDeviceManager _deviceNotificationThread:] + 134\r\n8   com.apple.Foundation          \t0x00007fff463126d2 __NSThread__start__ + 1194\r\n9   libsystem_pthread.dylib       \t0x00007fff701db2eb _pthread_body + 126\r\n10  libsystem_pthread.dylib       \t0x00007fff701de249 _pthread_start + 66\r\n11  libsystem_pthread.dylib       \t0x00007fff701da40d thread_start + 13\r\n\r\nThread 22:: Dispatch queue: -[IDEExecutionEnvironment initWithWorkspaceArena:] (QOS: UNSPECIFIED)\r\n0   libsystem_kernel.dylib        \t0x00007fff7011f86a __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff701de56e _pthread_cond_wait + 722\r\n2   com.apple.Foundation          \t0x00007fff463be86f -[__NSOperationInternal _waitUntilFinished:] + 858\r\n3   com.apple.Foundation          \t0x00007fff463f3396 -[NSOperationQueue waitUntilAllOperationsAreFinished] + 282\r\n4   com.apple.dt.IDEFoundation    \t0x0000000101ba211a __61-[IDEScheme _groupAndImposeDependenciesForOrderedOperations:]_block_invoke + 10\r\n5   com.apple.dt.DVTFoundation    \t0x0000000100a7558a __DVTOPERATIONGROUP_CREATED_BY_CALLEE_IS_WAITING_ON_SUBOPERATIONS__ + 164\r\n6   com.apple.dt.DVTFoundation    \t0x0000000100a757f6 -[DVTOperationGroup main] + 69\r\n7   com.apple.Foundation          \t0x00007fff4632c1dd -[__NSOperationInternal _start:] + 685\r\n8   com.apple.dt.DVTFoundation    \t0x0000000100a757a6 -[DVTOperationGroup start] + 113\r\n9   com.apple.Foundation          \t0x00007fff46356197 __NSOQSchedule_f + 227\r\n10  libdispatch.dylib             \t0x00007fff6ff995f8 _dispatch_call_block_and_release + 12\r\n11  libdispatch.dylib             \t0x00007fff6ff9a63d _dispatch_client_callout + 8\r\n12  libdispatch.dylib             \t0x00007fff6ff9cde6 _dispatch_continuation_pop + 414\r\n13  libdispatch.dylib             \t0x00007fff6ff9c4a3 _dispatch_async_redirect_invoke + 703\r\n14  libdispatch.dylib             \t0x00007fff6ffa83bc _dispatch_root_queue_drain + 324\r\n15  libdispatch.dylib             \t0x00007fff6ffa8b46 _dispatch_worker_thread2 + 90\r\n16  libsystem_pthread.dylib       \t0x00007fff701da6b3 _pthread_wqthread + 583\r\n17  libsystem_pthread.dylib       \t0x00007fff701da3fd start_wqthread + 13\r\n\r\nThread 23:\r\n0   libsystem_pthread.dylib       \t0x00007fff701da3f0 start_wqthread + 0\r\n\r\nThread 1 crashed with X86 Thread State (64-bit):\r\n  rax: 0xffffffffffffffff  rbx: 0xf10e27964db2273d  rcx: 0x00007fff7011d156  rdx: 0x0000000000000000\r\n  rdi: 0xf10e27964db2273d  rsi: 0x8080808080808080  rbp: 0x00007000035fe1e0  rsp: 0x00007000035fe120\r\n   r8: 0x00007000035fe008   r9: 0x0000000000000004  r10: 0x00007fff7011d0f6  r11: 0x0000000000000206\r\n  r12: 0x00007f9e6df7c060  r13: 0x00007fff9f31dc30  r14: 0xe700000000000000  r15: 0x00007f9e6d342620\r\n  rip: 0x000000012003f287  rfl: 0x0000000000010286  cr2: 0x000000012003ef40\r\n  \r\nLogical CPU:     4\r\nError Code:      0x00000000\r\nTrap Number:     6\r\n\r\n\r\nBinary Images:\r\n       0x10091a000 -        0x10091cff7  com.apple.dt.Xcode (10.2.1 - 14490.122) <C72AE759-8DA1-3A2D-82E7-34EF209152A9> /Applications/Xcode.app/Contents/MacOS/Xcode\r\n       0x10092b000 -        0x100ef0fff  com.apple.dt.DVTFoundation (10.2.1 - 14490.95) <826F73B6-CC8B-3E34-BCE0-20EFDA36711D> /Applications/Xcode.app/Contents/SharedFrameworks/DVTFoundation.framework/Versions/A/DVTFoundation\r\n       0x101163000 -        0x1015a8ff7  com.apple.dt.DVTKit (10.2.1 - 14490.95) <CF4EDC03-0042-3B06-8161-3B722A017E5A> /Applications/Xcode.app/Contents/SharedFrameworks/DVTKit.framework/Versions/A/DVTKit\r\n       0x1018f1000 -        0x10200fff7  com.apple.dt.IDEFoundation (10.2.1 - 14490.122) <1013D71D-0F7C-3241-8E0C-4975C5406761> /Applications/Xcode.app/Contents/Frameworks/IDEFoundation.framework/Versions/A/IDEFoundation\r\n       0x102523000 -        0x102e7cfff  com.apple.dt.IDEKit (10.2.1 - 14490.122) <E443E02C-59C3-3AC4-9149-DC268A6B168F> /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Versions/A/IDEKit\r\n       0x1035a6000 -        0x1035b6ff7  com.apple.dt.DVTJRPC (1.0 - 1) <A500C091-6648-3198-85BA-E32B5081CE13> /Applications/Xcode.app/Contents/SharedFrameworks/DVTJRPC.framework/Versions/A/DVTJRPC\r\n       0x1035d3000 -        0x1035daff7  com.apple.dt.DVTDeviceControlServices (1.0 - 1) <627E1CE1-9B49-32F6-9341-DE2A1C373C90> /Applications/Xcode.app/Contents/SharedFrameworks/DVTDeviceControlServices.framework/Versions/A/DVTDeviceControlServices\r\n       0x1035f2000 -        0x103630ff7  com.apple.DebugSymbols (192 - 192) <390EBD0F-C06F-3667-9CCB-B516A9A1A817> /Applications/Xcode.app/Contents/SharedFrameworks/DebugSymbolsDT.framework/Versions/A/DebugSymbolsDT\r\n       0x103658000 -        0x1036ddff7  com.apple.CoreSymbolicationDT (10.2.1 - 64490.27) <4B6DC8DE-537E-3A1C-89A7-9C4EC7D75074> /Applications/Xcode.app/Contents/SharedFrameworks/CoreSymbolicationDT.framework/Versions/A/CoreSymbolicationDT\r\n       0x103735000 -        0x10375afff  com.apple.dt.instruments.DTXConnectionServices (10.2.1 - 64490.43) <9529FF3A-7740-3942-BEF2-234A33EC7A14> /Applications/Xcode.app/Contents/SharedFrameworks/DTXConnectionServices.framework/Versions/A/DTXConnectionServices\r\n       0x103782000 -        0x10383fff7  com.apple.dt.instruments.DVTInstrumentsFoundation (10.2.1 - 64490.43) <00123692-DEEC-30DF-B2E0-C9BFEB54B543> /Applications/Xcode.app/Contents/SharedFrameworks/DVTInstrumentsFoundation.framework/Versions/A/DVTInstrumentsFoundation\r\n       0x1038e5000 -        0x103970ff7  com.apple.SymbolicationDT (10.2.1 - 64490.39) <DF4A8E17-F7A0-3D1C-BA16-B57FD3BF838B> /Applications/Xcode.app/Contents/SharedFrameworks/SymbolicationDT.framework/Versions/A/SymbolicationDT\r\n       0x1039d2000 -        0x1039d9ffb  com.apple.kperfdataDT (1.0 - 1) <905A60DC-6DE9-319F-8382-8BE902F23F78> /Applications/Xcode.app/Contents/SharedFrameworks/kperfdataDT.framework/Versions/A/kperfdataDT\r\n       0x1039e2000 -        0x103a16fff  com.apple.libktrace (1.0 - 271.250.1) <32BF3392-ACE1-3749-AA1E-931C21A23641> /Applications/Xcode.app/Contents/SharedFrameworks/ktraceDT.framework/Versions/A/ktraceDT\r\n       0x103a37000 -        0x103a6afff  com.apple.dt.instruments.DVTInstrumentsUtilities (10.2.1 - 64490.43) <DB5F0297-A492-3C46-B090-AFBEFE56C22C> /Applications/Xcode.app/Contents/SharedFrameworks/DVTInstrumentsUtilities.framework/Versions/A/DVTInstrumentsUtilities\r\n       0x103aa7000 -        0x103ab1ff3  com.apple.dt.DVTServices (10.2.1 - 14490.95) <D050C722-F450-3FA5-A601-F319F150CA08> /Applications/Xcode.app/Contents/SharedFrameworks/DVTServices.framework/Versions/A/DVTServices\r\n       0x103ac3000 -        0x103b04ffb  com.apple.dt.DVTPortal (10.2.1 - 1) <8E03D795-627F-359B-B456-C435BA77D162> /Applications/Xcode.app/Contents/SharedFrameworks/DVTPortal.framework/Versions/A/DVTPortal\r\n       0x103b38000 -        0x103c63fff  com.apple.dt.XCTest (1.0 - 14490.71) <FDF93133-8979-3655-A44D-74FC7BD234FA> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/Frameworks/XCTest.framework/Versions/A/XCTest\r\n       0x103d2c000 -        0x103d44ff3  com.apple.dt.DVTDeviceFoundation (10.2.1 - 1) <0A30F034-B4E6-3193-BB82-2733ECEB378A> /Applications/Xcode.app/Contents/SharedFrameworks/DVTDeviceFoundation.framework/Versions/A/DVTDeviceFoundation\r\n       0x103d5e000 -        0x103d61047  libobjc-trampolines.dylib (756.2) <5795A048-3940-3801-90CE-33D1B1AF81F4> /usr/lib/libobjc-trampolines.dylib\r\n       0x103d65000 -        0x103d9bff3  com.apple.dt.XCTAutomationSupport (1.0 - 14490.71) <85052CF3-027B-3693-9F14-7F13A9CEA77B> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/PrivateFrameworks/XCTAutomationSupport.framework/Versions/A/XCTAutomationSupport\r\n       0x103de5000 -        0x103e61ff7  com.apple.dt.SourceKit (1.0 - 14490.29) <8913459E-FF29-3FEA-9C96-8B65D3EA8151> /Applications/Xcode.app/Contents/SharedFrameworks/SourceKit.framework/Versions/A/SourceKit\r\n       0x103e9c000 -        0x105f16ff7 +libLTO.dylib (1001.0.46.4) <3549DEC8-04A1-3AD1-993A-0691D8CD4035> /Applications/Xcode.app/Contents/Frameworks/libLTO.dylib\r\n       0x106658000 -        0x1066d6ff7  com.apple.dt.DVTAnalytics (1.0 - 1) <B3136798-3685-3C30-B0C1-A8EFB6F8CDC4> /Applications/Xcode.app/Contents/SharedFrameworks/DVTAnalytics.framework/Versions/A/DVTAnalytics\r\n       0x106758000 -        0x10678dff7  com.apple.dt.DVTDocumentation (1.0 - 14490.95) <BCC26620-54FA-307D-9FE6-4B73AEB9775C> /Applications/Xcode.app/Contents/SharedFrameworks/DVTDocumentation.framework/Versions/A/DVTDocumentation\r\n       0x1067cf000 -        0x1068cefff  com.apple.DNTDocumentationModel (1.0 - 14490.35) <40C13050-BEE4-33A9-A5EF-ADFAB2F7C9A1> /Applications/Xcode.app/Contents/SharedFrameworks/DNTDocumentationModel.framework/Versions/A/DNTDocumentationModel\r\n       0x106a49000 -        0x106bc7fff  com.apple.DNTDocumentationSupport (1.0 - 14490.35) <7409FBA7-F1BF-3C5D-9557-99084BB7D999> /Applications/Xcode.app/Contents/SharedFrameworks/DNTDocumentationSupport.framework/Versions/A/DNTDocumentationSupport\r\n       0x106d1e000 -        0x106d37ff7  com.apple.dt.XCTDaemonControl (1.0 - 14490.71) <C4195122-83A6-3FF5-9F15-97851DD662AB> /Applications/Xcode.app/Contents/SharedFrameworks/XCTDaemonControl.framework/Versions/A/XCTDaemonControl\r\n       0x106d59000 -        0x106e70fff  com.apple.LocFramework (2.0 - 54) <ADC13A8B-8B86-3E58-8F7C-05BD4935FF88> /Applications/Xcode.app/Contents/SharedFrameworks/Localization.framework/Versions/A/Localization\r\n       0x106ed4000 -        0x106f5ffff  com.apple.dt.Xcode.DVTSourceControl (10.2.1 - 14490.33) <A82FE73C-C818-3F99-B321-9704964CB706> /Applications/Xcode.app/Contents/SharedFrameworks/DVTSourceControl.framework/Versions/A/DVTSourceControl\r\n       0x106fbd000 -        0x106fd7ffb  com.apple.dt.XcodeKit (10.2.1 - 14490.122) <19CEE0DC-28F7-3762-B53D-585C262E374C> /Applications/Xcode.app/Contents/Developer/Library/Frameworks/XcodeKit.framework/Versions/A/XcodeKit\r\n       0x106ff3000 -        0x10706aff7  com.apple.DNTSourceKitSupport (1.0 - 14490.35) <703DBCC6-28E5-3ACF-9E61-767018DA303B> /Applications/Xcode.app/Contents/SharedFrameworks/DNTSourceKitSupport.framework/Versions/A/DNTSourceKitSupport\r\n       0x1070bc000 -        0x107141ff7 +SKToolchain.dylib (14490.29) <C6F63642-3F5E-37C8-A779-42DAD20D00F3> /Applications/Xcode.app/Contents/SharedFrameworks/SourceKit.framework/Versions/A/XPCServices/com.apple.dt.SKAgent.xpc/Contents/Frameworks/SKToolchain.dylib\r\n       0x107173000 -        0x1071dcff7 +SKIPC.dylib (14490.29) <9AF5EF68-7911-3558-996D-8C455F107180> /Applications/Xcode.app/Contents/SharedFrameworks/SourceKit.framework/Versions/A/XPCServices/com.apple.dt.SKAgent.xpc/Contents/Frameworks/SKIPC.dylib\r\n       0x10720f000 -        0x107273ffb +SKSupport.dylib (14490.29) <A1B3F6B1-6144-3DB6-8C05-29CA9A6D9E13> /Applications/Xcode.app/Contents/SharedFrameworks/SourceKit.framework/Versions/A/XPCServices/com.apple.dt.SKAgent.xpc/Contents/Frameworks/SKSupport.dylib\r\n       0x1072a1000 -        0x1072cbfff  com.apple.dt.DVTAnalyticsClient (10.2.1 - 1) <7E50EDDE-3D9B-3945-B051-1251C58644F1> /Applications/Xcode.app/Contents/SharedFrameworks/DVTAnalyticsClient.framework/Versions/A/DVTAnalyticsClient\r\n       0x10731d000 -        0x107416fff  com.apple.DNTTransformer (1.0 - 14490.35) <E96D2BE9-6BF5-3E32-9CF1-06552F2C1182> /Applications/Xcode.app/Contents/SharedFrameworks/DNTTransformer.framework/Versions/A/DNTTransformer\r\n       0x1074f2000 -        0x107527fff  com.apple.dt.IDEProducts (1.0 - 1) <D8EFA4C5-5E73-36E0-A6FE-89567FA404F3> /Applications/Xcode.app/Contents/SharedFrameworks/IDEProducts.framework/Versions/A/IDEProducts\r\n       0x107551000 -        0x107551ff7  com.apple.assetvalidation-plugin (1.0 - 1) <4C7A46D4-21AC-314D-9B60-A6F470612A38> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/assetvalidation.xcplugin/Contents/MacOS/assetvalidation\r\n       0x107555000 -        0x1075bf6ef  dyld (655.1.1) <CE635DB2-D47E-3C05-A0A3-6BD982E7E750> /usr/lib/dyld\r\n       0x107620000 -        0x10b773ff3 +libclang.dylib (1001.0.46.4) <6EFA4734-CAF3-3067-9AE0-E2B81366C3D1> /Applications/Xcode.app/Contents/Frameworks/libclang.dylib\r\n       0x10cbe3000 -        0x10cbe5ff7  com.apple.dt.DVTDeveloperModeHelper (1.0 - 1) <6551D54A-A186-371C-9AE3-8634491CA373> /Applications/Xcode.app/Contents/SharedFrameworks/DVTDeveloperModeHelper.framework/Versions/A/DVTDeveloperModeHelper\r\n       0x10cbee000 -        0x10ccb5fff  com.apple.dt.instruments.DTGraphKit (10.2.1 - 64490.29) <1AF6C481-7ACF-3A4F-8E08-5C59EA3E84AA> /Applications/Xcode.app/Contents/SharedFrameworks/DTGraphKit.framework/Versions/A/DTGraphKit\r\n       0x10cdee000 -        0x10cdeefff  com.apple.IDEWatchKit1SupportUI (10.2.1 - 14490.6) <8A6D4C4B-8435-33E0-AAA2-AC1E927330BE> /Applications/Xcode.app/Contents/PlugIns/IDEWatchKit1SupportUI.ideplugin/Contents/MacOS/IDEWatchKit1SupportUI\r\n       0x10cdf6000 -        0x10cdf7ffb  com.apple.dt.dbg.DebuggerLLDBService (10.2.1 - 14490.99) <4FA4D4F1-2145-3B7A-B8CB-934C047F7BC3> /Applications/Xcode.app/Contents/PlugIns/DebuggerLLDBService.ideplugin/Contents/MacOS/DebuggerLLDBService\r\n       0x1102e3000 -        0x11030eff7 +libMainThreadChecker.dylib (64490.34) <B3ED1BB5-3E38-3588-B375-D73D95FC4668> /Applications/Xcode.app/Contents/Developer/usr/lib/libMainThreadChecker.dylib\r\n       0x110b51000 -        0x110ba5ff3  com.apple.dt.dbg.DebuggerFoundation (10.2.1 - 14490.99) <E886B432-F88B-31C2-B00A-C637DA615EEC> /Applications/Xcode.app/Contents/PlugIns/DebuggerFoundation.ideplugin/Contents/MacOS/DebuggerFoundation\r\n       0x110bea000 -        0x110c7dffb  com.apple.CoreSimulator (587.35 - 587.35) <C2BE48E5-B20A-31BE-AE8A-FADBD5136AD0> /Library/Developer/PrivateFrameworks/CoreSimulator.framework/Versions/A/CoreSimulator\r\n       0x110cc9000 -        0x110ce7ffb  com.apple.dt.DebugHierarchyFoundation (1.0 - 2) <27FA53E7-5FCE-30C6-83A3-EECC1D73638A> /Applications/Xcode.app/Contents/SharedFrameworks/DebugHierarchyFoundation.framework/Versions/A/DebugHierarchyFoundation\r\n       0x110d05000 -        0x110d1bff7  com.apple.dt.DebugHierarchyKit (1.0 - 2) <1B9B50EC-2C75-33CC-B3F6-3B089BBC3BCD> /Applications/Xcode.app/Contents/SharedFrameworks/DebugHierarchyKit.framework/Versions/A/DebugHierarchyKit\r\n       0x110d39000 -        0x110dc4fff  com.apple.dt.IBAutolayoutFoundation (10.2.1 - 14490.70) <C20327A4-98C4-3794-8268-9B0BDF579D46> /Applications/Xcode.app/Contents/Frameworks/IBAutolayoutFoundation.framework/Versions/A/IBAutolayoutFoundation\r\n       0x110e26000 -        0x110f5eff7  com.apple.dt.IBFoundation (10.2.1 - 14490.70) <F869114E-B663-31F8-BDF2-BE4449FE8561> /Applications/Xcode.app/Contents/Frameworks/IBFoundation.framework/Versions/A/IBFoundation\r\n       0x11103d000 -        0x111045ffb  com.apple.CoreSimulator.CoreSimulatorUtilities (587.35 - 587.35) <BE7FDDE7-917E-3E8F-BFFF-3D5D6D0F04DF> /Library/Developer/PrivateFrameworks/CoreSimulator.framework/Versions/A/Frameworks/CoreSimulatorUtilities.framework/Versions/A/CoreSimulatorUtilities\r\n       0x111050000 -        0x11105aff3  com.apple.CoreSimulator.CoreSimDeviceIO (587.35 - 587.35) <F1545921-49F9-3506-8A43-836A19FBEB6C> /Library/Developer/PrivateFrameworks/CoreSimulator.framework/Versions/A/Frameworks/CoreSimDeviceIO.framework/Versions/A/CoreSimDeviceIO\r\n       0x11106a000 -        0x111157fff  com.apple.AppleCV3D (1.21.31 - 1.21.31) <BD103358-BAF8-3258-95B4-95DA2EF36045> /Applications/Xcode.app/Contents/SharedFrameworks/AppleCV3D.framework/Versions/A/AppleCV3D\r\n       0x111167000 -        0x1111dbfff  com.apple.dt.dbg.DebuggerLLDB (10.2.1 - 14490.99) <FE7165AF-03C4-3295-9712-7E8CA0B2E335> /Applications/Xcode.app/Contents/PlugIns/DebuggerLLDB.ideplugin/Contents/MacOS/DebuggerLLDB\r\n       0x111259000 -        0x1154a8fff  com.apple.LLDB.framework (1.1001.0.13.3 - 1001.0.13.3) <0C5653E6-985B-3789-9ED5-5B8C0F8C5657> /Applications/Xcode.app/Contents/SharedFrameworks/LLDB.framework/Versions/A/LLDB\r\n       0x11683d000 -        0x116881ff7  com.apple.LLDBRPC (1.0 - 1001.0.13.3) <082D71B1-46DF-3200-9C80-8B3F8178E405> /Applications/Xcode.app/Contents/SharedFrameworks/LLDBRPC.framework/Versions/A/LLDBRPC\r\n       0x1168ba000 -        0x11693cff3  com.apple.dt.IDE.Xcode3Core (10.2.1 - 14490.83) <FFAC8C5A-4A80-3EA1-8A41-86CEF03F931F> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/MacOS/Xcode3Core\r\n       0x116987000 -        0x116d1efff  com.apple.Xcode.DevToolsCore (12.2.1 - 14490.83) <29B48630-B294-3D3B-AD00-7333535FDC22> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/Frameworks/DevToolsCore.framework/Versions/A/DevToolsCore\r\n       0x116edb000 -        0x116ee3fff  com.apple.DevToolsFoundation (12.2.1 - 14490.83) <48516E69-217B-3446-89CF-3884BDF3D2D6> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/Frameworks/DevToolsFoundation.framework/Versions/A/DevToolsFoundation\r\n       0x116ef0000 -        0x116f23ff3  com.apple.Xcode.DevToolsSupport (12.2.1 - 14490.83) <FEE31C4C-6B18-38DA-844A-4225922C4684> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/Frameworks/DevToolsSupport.framework/Versions/A/DevToolsSupport\r\n       0x116f4c000 -        0x116fe8ff7  com.apple.dt.IDE.IDEiOSSupportCore (10.2.1 - 14490.49) <54D1C2D0-74D7-35D5-99A2-1E1B6CDAF3E8> /Applications/Xcode.app/Contents/PlugIns/IDEiOSSupportCore.ideplugin/Contents/MacOS/IDEiOSSupportCore\r\n       0x11704e000 -        0x117053fff  com.apple.dt.XCTDaemonControlMobileDevice (1.0 - 14490.71) <F6165B74-5DF8-38E6-B2CE-0FD1A7775CE8> /Applications/Xcode.app/Contents/SharedFrameworks/XCTDaemonControlMobileDevice.framework/Versions/A/XCTDaemonControlMobileDevice\r\n       0x11705f000 -        0x117074fff  com.apple.DVTiPhoneSimulatorRemoteClient (10.2.1 - 14490.49) <F55FCE7D-72FA-311E-8703-CF253B839741> /Applications/Xcode.app/Contents/SharedFrameworks/DVTiPhoneSimulatorRemoteClient.framework/Versions/A/DVTiPhoneSimulatorRemoteClient\r\n       0x11708a000 -        0x117121ff7  com.apple.DTDeviceKitBase (10.2.1 - 14490.49) <2F9DAF4E-D99C-3742-AF3D-2B1C8288AD90> /Applications/Xcode.app/Contents/SharedFrameworks/DTDeviceKitBase.framework/Versions/A/DTDeviceKitBase\r\n       0x11717d000 -        0x117180ffb  com.apple.XCWatchOSSupport (1.0 - 1) <6CB58616-4E83-39DE-AAEA-E67EE7DB607A> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/XCWatchOSSupport.xcplugin/Contents/MacOS/XCWatchOSSupport\r\n       0x117188000 -        0x117188fff  com.apple.XCWatchKit1Support (1.0 - 1) <EDCB3DE6-D156-3595-A0B1-797D1CD579EA> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/XCWatchKit1Support.xcplugin/Contents/MacOS/XCWatchKit1Support\r\n       0x11718e000 -        0x1171aaffb  com.apple.dt.XCLanguageSupport (10.2.1 - 14490.24) <F532607A-3839-3120-9306-86AAC1361838> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/XCLanguageSupport.xcplugin/Contents/MacOS/XCLanguageSupport\r\n       0x1171bf000 -        0x1171c2ff7  com.apple.xcode.compilers.mlkit (12.2.1 - 14490.8) <2921F3F3-ACCB-37E6-A956-31AAE178AC97> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/MLKit.xcplugin/Contents/MacOS/MLKit\r\n       0x1171ca000 -        0x1171caff7  com.apple.Metal (1.0 - 1) <AE37F8B7-03B3-3114-A4D8-9E304CC04024> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/Metal.xcplugin/Contents/MacOS/Metal\r\n       0x1171d0000 -        0x1171d4ff7  com.apple.xcode.compilers.intents (10.2.1 - 14490.14) <FC7AC0B6-0416-37BB-81FC-1204FBD29218> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/Intents.xcplugin/Contents/MacOS/Intents\r\n       0x1171dd000 -        0x1171ddfff  com.apple.IBCompilerPlugin (10.2.1 - 14490.70) <9B9D9426-81DB-34E6-A61D-79272FB8F7F1> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/IBCompilerPlugin.xcplugin/Contents/MacOS/IBCompilerPlugin\r\n       0x1171e3000 -        0x1171edfff  com.apple.xcode.plug-in.CoreBuildTasks (12.2.1 - 14490.83) <4CF07CB6-44B9-3874-A9F9-4BBB67892A46> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/CoreBuildTasks.xcplugin/Contents/MacOS/CoreBuildTasks\r\n       0x1171f8000 -        0x1171f8ff7  com.apple.xcode.compilers.coredata (12.2.1 - 14490.83) <9D2A37CF-8F78-3B63-B968-7839DC93EF64> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/Core Data.xcplugin/Contents/MacOS/Core Data\r\n       0x1171fe000 -        0x1171feff7  com.apple.compilers.clang (12.2.1 - 14490.83) <CC59CFA6-8F62-3B67-AD0D-8F89D1320CF1> /Applications/Xcode.app/Contents/PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins/Clang LLVM 1.0.xcplugin/Contents/MacOS/Clang LLVM 1.0\r\n       0x117204000 -        0x117205fff  com.apple.dt.IDEWatchSupportCore (1.0 - 1) <D497891E-1D3E-3A63-B5FE-622E4623E344> /Applications/Xcode.app/Contents/Developer/Platforms/WatchOS.platform/Developer/Library/Xcode/PrivatePlugIns/IDEWatchSupportCore.ideplugin/Contents/MacOS/IDEWatchSupportCore\r\n       0x11720d000 -        0x117212ff7  com.apple.dt.IDEiOSPlatformSupportCore (1.0 - 1.0) <E2D3EAB6-DDF1-3BFA-8D8C-37FAE4CCFE3A> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/PrivatePlugIns/IDEiOSPlatformSupportCore.ideplugin/Contents/MacOS/IDEiOSPlatformSupportCore\r\n       0x11721b000 -        0x11721dff3  com.apple.dt.IDEAppleTVSupportCore (1.0 - 1) <5505B6DF-2A2F-3C61-930F-4E1D5F86BCCB> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/Xcode/PrivatePlugIns/IDEAppleTVSupportCore.ideplugin/Contents/MacOS/IDEAppleTVSupportCore\r\n       0x117228000 -        0x11722fff7  com.apple.dt.IDE.IDEOSXSupportCore (10.2.1 - 14490.6) <8ED1310C-1294-33CD-9D74-B4782B369F59> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/Xcode/PrivatePlugIns/IDEOSXSupportCore.ideplugin/Contents/MacOS/IDEOSXSupportCore\r\n       0x117bdd000 -        0x117bfdff3  com.apple.IBCocoaTouchToolFoundation (10.2.1 - 14490.49) <538454A5-4F03-3B65-8906-372A71F14A78> /Applications/Xcode.app/Contents/Frameworks/IBCocoaTouchToolFoundation.framework/Versions/A/IBCocoaTouchToolFoundation\r\n       0x117c30000 -        0x117c40ffb  com.apple.DTDeviceKit (4.2 - 14490.49) <952378A9-2267-3594-A5A8-B06A4ADF36B0> /Applications/Xcode.app/Contents/SharedFrameworks/DTDeviceKit.framework/Versions/A/DTDeviceKit\r\n       0x117c54000 -        0x117c6dff7  com.apple.dt.IDE.IDEInterfaceBuilderiOSIntegration (10.2.1 - 14490.49) <DC11CA3A-8A28-3166-AB10-7180E0CB3BCF> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderiOSIntegration.ideplugin/Contents/MacOS/IDEInterfaceBuilderiOSIntegration\r\n       0x117c86000 -        0x117ccdff7  com.apple.dt.IDE.IDEInterfaceBuilderAppleTVIntegration (10.2.1 - 14490.22) <3A00CB85-0D33-379A-9067-12A15BF9DD13> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVSimulator.platform/Developer/Library/Xcode/PrivatePlugIns/IDEInterfaceBuilderAppleTVIntegration.ideplugin/Contents/MacOS/IDEInterfaceBuilderAppleTVIntegration\r\n       0x117d2c000 -        0x117d2dff3 +liblaunch_sim.dylib (1336.254.1) <093CE8B4-838F-3A51-8217-FE70F186127E> /Applications/Xcode.app/Contents/Developer/Platforms/WatchOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/watchOS.simruntime/Contents/Resources/RuntimeRoot/usr/lib/system/host/liblaunch_sim.dylib\r\n       0x117f77000 -        0x117ffbff3  com.apple.dt.IDE.IDEInterfaceBuilderWatchKitIntegration (10.2.1 - 14490.21) <E04E50A4-1ED5-3826-9B8C-0C073F261E90> /Applications/Xcode.app/Contents/Developer/Platforms/WatchSimulator.platform/Developer/Library/Xcode/PrivatePlugIns/IDEInterfaceBuilderWatchKitIntegration.ideplugin/Contents/MacOS/IDEInterfaceBuilderWatchKitIntegration\r\n       0x118082000 -        0x1180a8fff  com.apple.dt.IDE.IDEInterfaceBuilderDFRSupport (10.2.1 - 14490.12) <B7155EA7-E492-3754-B36A-9021D8FABA50> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderDFRSupport.ideplugin/Contents/MacOS/IDEInterfaceBuilderDFRSupport\r\n       0x1180d6000 -        0x1180d7ff3 +liblaunch_sim.dylib (1336.252.1) <CE709E3F-E10F-31C5-8DD7-FEA160F2DC39> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/usr/lib/system/host/liblaunch_sim.dylib\r\n       0x1180dd000 -        0x1180deff3 +liblaunch_sim.dylib (1336.253.1) <5DC5F11E-18C2-3F54-8038-476586AA7D80> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/tvOS.simruntime/Contents/Resources/RuntimeRoot/usr/lib/system/host/liblaunch_sim.dylib\r\n       0x1180e9000 -        0x1180eefff  com.apple.dt.IDE.IDEInterfaceBuilderEditorDFRSupport (10.2.1 - 14490.7) <33C14306-424E-3F67-9C4C-A1175DD48CA7> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderEditorDFRSupport.ideplugin/Contents/MacOS/IDEInterfaceBuilderEditorDFRSupport\r\n       0x1180f9000 -        0x118143fff  com.apple.dt.IDE.IDESourceCodeComparisonEditor (10.2.1 - 14490.99) <66331C65-80DB-3732-8471-0D36C2DC92CA> /Applications/Xcode.app/Contents/PlugIns/IDESourceCodeComparisonEditor.ideplugin/Contents/MacOS/IDESourceCodeComparisonEditor\r\n       0x1181a2000 -        0x1181b3fff  com.apple.MarkupSupport (1.0 - 1) <253C453A-1D8D-3A31-AA6E-FCB11F225E19> /Applications/Xcode.app/Contents/SharedFrameworks/MarkupSupport.framework/Versions/A/MarkupSupport\r\n       0x1181d2000 -        0x1181d7ffb  com.apple.dt.dbg.DebuggerKit (1.0 - 1) <430689F6-AA74-3A9F-8E81-150043D1F465> /Applications/Xcode.app/Contents/PlugIns/DebuggerKit.ideplugin/Contents/MacOS/DebuggerKit\r\n       0x118477000 -        0x118a76fff  com.apple.dt.IDE.IDEInterfaceBuilderKit (10.2.1 - 14490.70) <5CF81A21-6616-39E7-8C36-BB5A0A9ECE3C> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderKit.framework/IDEInterfaceBuilderKit\r\n       0x118ea4000 -        0x1190c3fff  com.apple.dt.IDE.IDEInterfaceBuilderCocoaIntegration (10.2.1 - 14490.70) <F68660B2-4E8F-3A8A-A00E-8C1965A2A62F> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderCocoaIntegration.framework/IDEInterfaceBuilderCocoaIntegration\r\n       0x1192aa000 -        0x1194e3ff3  com.apple.dt.IDE.IDEInterfaceBuilderCocoaTouchIntegration (10.2.1 - 14490.49) <A6FE8C1F-F7A3-39B2-A319-CA4D39F2AFFE> /Applications/Xcode.app/Contents/PlugIns/IDEInterfaceBuilderCocoaTouchIntegration.framework/IDEInterfaceBuilderCocoaTouchIntegration\r\n       0x1196d6000 -        0x1196ddfff  com.apple.dt.IDE.HexEditor (10.2.1 - 14490.99) <234AD94C-F569-37B8-BAC3-0980FFB10E22> /Applications/Xcode.app/Contents/PlugIns/HexEditor.ideplugin/Contents/MacOS/HexEditor\r\n       0x119800000 -        0x119995fff  com.apple.audio.units.Components (1.14 - 1.14) <4A4751B8-0C55-3A6E-B639-0299F3B3081A> /System/Library/Components/CoreAudio.component/Contents/MacOS/CoreAudio\r\n       0x119a31000 -        0x119ad0ff3  com.apple.dt.IDE.IDESourceEditor (10.2.1 - 14490.99) <962D7C85-2C9E-3D9D-86AB-3F926E86B36F> /Applications/Xcode.app/Contents/PlugIns/IDESourceEditor.ideplugin/Contents/MacOS/IDESourceEditor\r\n       0x119b37000 -        0x119ef5fff  com.apple.dt.SourceEditor (1.0 - 1) <365D5A4E-510B-3652-BC13-46F896A7DC61> /Applications/Xcode.app/Contents/SharedFrameworks/SourceEditor.framework/Versions/A/SourceEditor\r\n       0x11a21c000 -        0x11a403fff  com.apple.dt.IDESourceEditor (1.0 - 1) <98278C73-135D-3089-B146-00B56DF8BB67> /Applications/Xcode.app/Contents/PlugIns/IDESourceEditor.framework/Versions/A/IDESourceEditor\r\n       0x11a5b9000 -        0x11a636fff  com.apple.SourceKitSupport (1.0 - 1) <7E6BA46F-DAD9-3106-8AC5-17A4EF54CACA> /Applications/Xcode.app/Contents/SharedFrameworks/SourceKitSupport.framework/Versions/A/SourceKitSupport\r\n       0x11a6ca000 -        0x11a6ebff7  com.apple.SourceModelSupport (1.0 - 1) <4F5CFAB4-6276-3C90-A841-FDF3772E0C06> /Applications/Xcode.app/Contents/SharedFrameworks/SourceModelSupport.framework/Versions/A/SourceModelSupport\r\n       0x11a70f000 -        0x11a75bfff  com.apple.dt.DVTSourceEditor (1.0 - 1) <B5BF8C98-0966-3256-A66B-D0E56CEA9EC4> /Applications/Xcode.app/Contents/SharedFrameworks/DVTSourceEditor.framework/Versions/A/DVTSourceEditor\r\n       0x11a7e4000 -        0x11a83aff7  com.apple.dt.DVTMarkdown (1.0 - 1) <ED1E1C00-91EF-37C2-9E54-B5A0ADBCD40C> /Applications/Xcode.app/Contents/SharedFrameworks/DVTMarkup.framework/Versions/A/DVTMarkup\r\n       0x11a863000 -        0x11a895ffb  com.apple.dt.CommonMark (1.0 - 1) <E310527B-E466-33BD-9F8B-298E1CE08C58> /Applications/Xcode.app/Contents/SharedFrameworks/DVTMarkup.framework/Versions/A/Frameworks/CommonMark.framework/Versions/A/CommonMark\r\n       0x11a8a6000 -        0x11a9dffff  com.apple.dt.IDE.IDESourceControlUI (10.2.1 - 14490.99) <4F0A26A2-44BB-3D27-999B-68009B39FEA0> /Applications/Xcode.app/Contents/PlugIns/IDESourceControlUI.ideplugin/Contents/MacOS/IDESourceControlUI\r\n       0x11ab5c000 -        0x11abaaff7  com.apple.dt.IDE.IDEiPhoneSupport (10.2.1 - 14490.49) <396478DE-1EF5-3575-B0FC-FE07D1D8CF12> /Applications/Xcode.app/Contents/PlugIns/IDEiPhoneSupport.ideplugin/Contents/MacOS/IDEiPhoneSupport\r\n       0x11abf6000 -        0x11ada3ff7  com.apple.dt.IDE.Xcode3UI (10.2.1 - 14490.83) <E3E35C98-39D3-3680-9EB5-51CC2F696FF3> /Applications/Xcode.app/Contents/PlugIns/Xcode3UI.ideplugin/Contents/MacOS/Xcode3UI\r\n       0x11af0b000 -        0x11af39ff7  com.apple.dt.HexFiendFramework (10.2.1 - 14490.99) <20E95526-E8A3-345C-9708-8545F7563769> /Applications/Xcode.app/Contents/SharedFrameworks/HexFiend.framework/Versions/A/HexFiend\r\n       0x11af6b000 -        0x11af6cff7  com.apple.GPUToolsInterface (1.0 - 24490.5) <12EB864F-AE49-30D6-90D8-34D4C6969475> /Applications/Xcode.app/Contents/SharedFrameworks/GPUToolsInterface.framework/Versions/A/GPUToolsInterface\r\n       0x11af7e000 -        0x11b0bcfff  com.apple.dt.dbg.DebuggerUI (10.2.1 - 14490.99) <96F5FCB8-569B-31CC-8646-84EC1391568C> /Applications/Xcode.app/Contents/PlugIns/DebuggerUI.ideplugin/Contents/MacOS/DebuggerUI\r\n       0x11b1c9000 -        0x11b1fdff3  com.apple.dt.IDE.IDEMemoryGraphDebugger (10.2.1 - 14490.99) <7467AD7A-3831-31E4-919B-17B4DECD3E6F> /Applications/Xcode.app/Contents/PlugIns/IDEMemoryGraphDebugger.ideplugin/Contents/MacOS/IDEMemoryGraphDebugger\r\n       0x11b22e000 -        0x11b2acfff  com.apple.dt.IDEProductsUI (1.0 - 1) <F9666330-E07B-39B4-8516-EB290E52929E> /Applications/Xcode.app/Contents/PlugIns/IDEProductsUI.ideplugin/Contents/MacOS/IDEProductsUI\r\n       0x11b32a000 -        0x11b340fff  com.apple.security.csparser (3.0 - 58286.260.20) <9B538E9C-2FF3-3FFF-943C-945D73CF68CF> /System/Library/Frameworks/Security.framework/PlugIns/csparser.bundle/Contents/MacOS/csparser\r\n       0x11d5df000 -        0x11d651ff7  com.apple.dt.gpu.GPUDebuggerFoundation (10.2.1 - 24490.14) <02611926-349C-348B-B895-40A655B38B0F> /Applications/Xcode.app/Contents/PlugIns/GPUDebuggerFoundation.ideplugin/Contents/MacOS/GPUDebuggerFoundation\r\n       0x11d6b0000 -        0x11d6b6ff7  com.apple.GPUToolsPlatform (1.0 - 24490.7) <236E4A81-2739-3F59-90FB-7DC14DF3058D> /Applications/Xcode.app/Contents/SharedFrameworks/GPUToolsPlatform.framework/Versions/A/GPUToolsPlatform\r\n       0x11d6c1000 -        0x11d6d3ff7  com.apple.GPUToolsShaderProfiler (1.0 - 24490.5) <4D878796-43A8-3B56-8FDC-6F82497EA98B> /Applications/Xcode.app/Contents/SharedFrameworks/GPUToolsShaderProfiler.framework/Versions/A/GPUToolsShaderProfiler\r\n       0x11d6e7000 -        0x11d731fff  com.apple.GPUToolsCore (1.0 - 24490.7) <6BD90FBF-48E7-309B-8BB9-F76A80823D2A> /Applications/Xcode.app/Contents/SharedFrameworks/GPUToolsCore.framework/Versions/A/GPUToolsCore\r\n       0x11d770000 -        0x11d7aefff  com.apple.GPUTools (1.0 - 24490.7) <E79FAA29-3CEC-3FF4-A3FF-AF03BC59EE95> /Applications/Xcode.app/Contents/SharedFrameworks/GPUTools.framework/Versions/A/GPUTools\r\n       0x11d7e1000 -        0x11d834fff  com.apple.GLToolsServices (1.0 - 24490.5) <74F7DFB6-097A-3E4D-8265-6AF6B84A8699> /Applications/Xcode.app/Contents/SharedFrameworks/GLToolsServices.framework/Versions/A/GLToolsServices\r\n       0x11d876000 -        0x11d8efff7  com.apple.GPUToolsServices (1.0 - 24490.5) <0737D983-E0D6-391C-9EB9-A805F64DB757> /Applications/Xcode.app/Contents/SharedFrameworks/GPUToolsServices.framework/Versions/A/GPUToolsServices\r\n       0x11d940000 -        0x11d955fff  com.apple.GLToolsInterface (1.0 - 24490.5) <DFD68615-F18E-300C-826E-5DDB096AE2C9> /Applications/Xcode.app/Contents/SharedFrameworks/GLToolsInterface.framework/Versions/A/GLToolsInterface\r\n       0x11d964000 -        0x11d9cbff7  com.apple.GLToolsCore (1.0 - 24490.7) <07832E2D-3CCE-3D6E-8AE0-4818AFA51DB1> /Applications/Xcode.app/Contents/SharedFrameworks/GLToolsCore.framework/Versions/A/GLToolsCore\r\n       0x11d9e9000 -        0x11d9feff7  com.apple.GLTools (1.0 - 24490.7) <F0C2C9E5-E56A-3B8E-8956-0F470E48918D> /Applications/Xcode.app/Contents/SharedFrameworks/GLTools.framework/Versions/A/GLTools\r\n       0x11da06000 -        0x11da87fff  com.apple.gputools.GLToolsAnalysisEngine (1.0 - 24490.5) <497ADD86-FD91-3BE4-B5EC-5C6964628BF7> /Applications/Xcode.app/Contents/SharedFrameworks/GLToolsAnalysisEngine.framework/Versions/A/GLToolsAnalysisEngine\r\n       0x11dacb000 -        0x11dad3ff3  com.apple.dt.gpu.GPUTraceDebugger (10.2.1 - 24490.14) <9E1C56A4-3D14-33CD-BBD7-BF7B8E4E211D> /Applications/Xcode.app/Contents/PlugIns/GPUTraceDebugger.ideplugin/Contents/MacOS/GPUTraceDebugger\r\n       0x11dae0000 -        0x11db49fff  com.apple.dt.gpu.GPUDebuggerKit (10.2.1 - 24490.14) <8E36D77C-75A7-39E7-AE48-CE2341CBC509> /Applications/Xcode.app/Contents/PlugIns/GPUDebuggerKit.ideplugin/Contents/MacOS/GPUDebuggerKit\r\n       0x11dba6000 -        0x11dc3aff7  com.apple.dt.IDE.IDEDocViewer (10.2.1 - 14490.99) <9A663B20-E381-3CBE-8F3D-31B8A613242A> /Applications/Xcode.app/Contents/PlugIns/IDEDocViewer.ideplugin/Contents/MacOS/IDEDocViewer\r\n       0x11dcd2000 -        0x11dd7aff7  com.apple.dt.gpu.GPUTraceDebuggerUI (10.2.1 - 24490.14) <98AA6A7F-48D7-3C62-8F09-C6E8352E4ED2> /Applications/Xcode.app/Contents/PlugIns/GPUTraceDebuggerUI.ideplugin/Contents/MacOS/GPUTraceDebuggerUI\r\n       0x11dded000 -        0x11de11ff7  com.apple.dt.IDEIODebugGaugesUI (10.2.1 - 14490.99) <5DA93A21-DB07-392D-9274-143C860CD9DB> /Applications/Xcode.app/Contents/PlugIns/IDEIODebugGaugesUI.ideplugin/Contents/MacOS/IDEIODebugGaugesUI\r\n       0x11de3d000 -        0x11de45ff3  com.apple.dt.IDEIODebugGaugesCore (10.2.1 - 14490.99) <807364C7-058B-325F-B6F4-C2AB11877F5F> /Applications/Xcode.app/Contents/PlugIns/IDEIODebugGaugesCore.ideplugin/Contents/MacOS/IDEIODebugGaugesCore\r\n       0x11de56000 -        0x11dfddfff  com.apple.dt.gpu.GPURenderTargetEditor (10.2.1 - 24490.14) <EF97F33C-BC79-3EAB-80A8-EB2E8CA36B6C> /Applications/Xcode.app/Contents/PlugIns/GPURenderTargetEditor.ideplugin/Contents/MacOS/GPURenderTargetEditor\r\n       0x11e11d000 -        0x11e120fff  com.apple.MTLToolsServices (1.0 - 1) <5F0D6FC9-24AB-37F4-8FCA-19EBDAF11350> /Applications/Xcode.app/Contents/SharedFrameworks/MTLToolsServices.framework/Versions/A/MTLToolsServices\r\n       0x11e127000 -        0x11e146fff  com.apple.MTLTools (1.0 - 1) <AA3CD45A-0A02-3879-8E8F-BC4D7975E64D> /Applications/Xcode.app/Contents/SharedFrameworks/MTLTools.framework/Versions/A/MTLTools\r\n       0x11e156000 -        0x11e158fff  com.apple.gdt.MTLToolsAnalysisEngine (1.0 - 24490.5) <A74C2E30-A0E9-397B-8F7F-961BFF029AD2> /Applications/Xcode.app/Contents/SharedFrameworks/MTLToolsAnalysisEngine.framework/Versions/A/MTLToolsAnalysisEngine\r\n       0x11e15e000 -        0x11e161ff3  com.apple.dt.gpu.GPUDebuggertvOSSupport (10.2.1 - 24209) <B5AF07E2-BF98-38F4-9E9E-9F16F35A1DC4> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/Xcode/PrivatePlugIns/GPUDebuggertvOSSupport.ideplugin/Contents/MacOS/GPUDebuggertvOSSupport\r\n       0x11e169000 -        0x11e169fff  com.apple.GLToolsMobileFoundation (1.0 - 24215) <3372CDD5-C45B-3F62-A3BF-6DBC06E36127> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/PrivateFrameworks/GLToolsMobileFoundation.framework/Versions/A/GLToolsMobileFoundation\r\n       0x11e16e000 -        0x11e1caff7  com.apple.GLToolsExpert (1.0 - 24215) <7BF339B8-05D0-351B-B4AE-49800818FF06> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/PrivateFrameworks/GLToolsExpert.framework/Versions/A/GLToolsExpert\r\n       0x11e204000 -        0x11e21dff7  com.apple.GLToolsShaderProfiler (1.0 - 24490.5) <9016A232-C46B-36FF-853E-834142E16911> /Applications/Xcode.app/Contents/SharedFrameworks/GLToolsShaderProfiler.framework/Versions/A/GLToolsShaderProfiler\r\n       0x11e22b000 -        0x11e23dfff  com.apple.GPUToolsMobileFoundation (1.0 - 24215) <A67389A2-3DA6-3296-80D6-87898DCF898B> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/PrivateFrameworks/GPUToolsMobileFoundation.framework/Versions/A/GPUToolsMobileFoundation\r\n       0x11e250000 -        0x11e253ff3  com.apple.dt.gpu.GPUDebuggerOSXSupport (10.2.1 - 24490.14) <56E8F75D-2267-35E3-8D65-CDE34E4486DE> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/Xcode/PrivatePlugIns/GPUDebuggerOSXSupport.ideplugin/Contents/MacOS/GPUDebuggerOSXSupport\r\n       0x11e25b000 -        0x11e267fff  com.apple.GPUToolsDesktopFoundation (1.0 - 24205) <E6070CF8-065C-3A87-8A6E-BDBC8A5730C1> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/PrivateFrameworks/GPUToolsDesktopFoundation.framework/Versions/A/GPUToolsDesktopFoundation\r\n       0x11e274000 -        0x11e277ff7  com.apple.dt.gpu.GPUDebuggeriOSSupport (10.2.1 - 24209) <EC7CFDE0-FBBF-3D3F-A089-3DA800309708> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/PrivatePlugIns/GPUDebuggeriOSSupport.ideplugin/Contents/MacOS/GPUDebuggeriOSSupport\r\n       0x11e27f000 -        0x11e27ffff  com.apple.dt.IDEContinuousIntegration (1.0 - 1) <89726EA8-731E-3648-A4DC-CD7BA17525D8> /Applications/Xcode.app/Contents/PlugIns/IDEContinuousIntegration.ideplugin/Contents/MacOS/IDEContinuousIntegration\r\n       0x11e285000 -        0x11e365ff7  com.apple.XCSCore (1.0 - 1) <C87F93BA-10F3-3485-957E-5A90836E50D0> /Applications/Xcode.app/Contents/SharedFrameworks/XCSCore.framework/Versions/A/XCSCore\r\n       0x11e400000 -        0x11e5b2ff7  com.apple.dt.XCSUI (1.0 - 1) <035192F3-92F2-367C-9E5C-A873B5AAAA74> /Applications/Xcode.app/Contents/SharedFrameworks/XCSUI.framework/Versions/A/XCSUI\r\n       0x11e71e000 -        0x11e747ff3  com.apple.dt.XCSUIDataSource (1.0 - 14490.22) <716A4D76-CF2E-37A9-97C2-4758FE2F4986> /Applications/Xcode.app/Contents/SharedFrameworks/XCSUIDataSource.framework/Versions/A/XCSUIDataSource\r\n       0x11e770000 -        0x11e7fbff7  com.apple.dt.XCSAdministration (1.0 - 1) <FEA4325A-415A-3A54-91C0-B1E741F3FED5> /Applications/Xcode.app/Contents/SharedFrameworks/XCSAdministration.framework/Versions/A/XCSAdministration\r\n       0x11e8a2000 -        0x11e8b0ff7  com.apple.dt.XCSSecurity (1.0 - 1) <39FAC97D-BB4A-3D02-9AB5-B9D0A515C7B4> /Applications/Xcode.app/Contents/SharedFrameworks/XCSSecurity.framework/Versions/A/XCSSecurity\r\n       0x11e8bd000 -        0x11e8c0fff  com.apple.IDEServerTools (1.0 - 1) <FAF9C235-0A1A-3D14-B97F-039A93D9772D> /Applications/Xcode.app/Contents/SharedFrameworks/IDEServerTools.framework/Versions/A/IDEServerTools\r\n       0x11e8c8000 -        0x11e993fff  com.apple.protobuf.SwiftProtobuf (1.0 - 1.0.3) <D9A7DFFC-678D-3C54-BE23-1204F370CF5E> /Applications/Xcode.app/Contents/SharedFrameworks/XCSAdministration.framework/Versions/A/Frameworks/SwiftProtobuf.framework/Versions/A/SwiftProtobuf\r\n       0x11eb12000 -        0x11eb1eff3  com.apple.dt.PlistEditor (10.2.1 - 14490.99) <11BB66E2-FFF7-3298-80A1-0911BB6C1F0F> /Applications/Xcode.app/Contents/PlugIns/PlistEditor.ideplugin/Contents/MacOS/PlistEditor\r\n       0x11eb30000 -        0x11eb46fff  com.apple.dt.IDE.IDERTFEditor (10.2.1 - 14490.99) <2C8CDEAF-9D7A-3B40-87D7-925A38F9E2B8> /Applications/Xcode.app/Contents/PlugIns/IDERTFEditor.ideplugin/Contents/MacOS/IDERTFEditor\r\n       0x11ebaf000 -        0x11ebb5ff7  com.apple.dt.DVTPlaygroundCommunication (1.0 - 14490.7) <EBD42E53-B97C-3813-8474-82C47E3E0747> /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/PrivateFrameworks/DVTPlaygroundCommunication.framework/Versions/A/DVTPlaygroundCommunication\r\n       0x11ec35000 -        0x11ec35fff  com.apple.dt.IDE.IDEPegasusSourceEditor (10.2.1 - 14490.99) <EEE2982C-C297-37DC-B3F7-6F93C264BCE8> /Applications/Xcode.app/Contents/PlugIns/IDEPegasusSourceEditor.ideplugin/Contents/MacOS/IDEPegasusSourceEditor\r\n       0x11ec6d000 -        0x11ed9efff  com.apple.dt.IDE.IDESceneKitEditor (10.2.1 - 14490.14) <842195AE-2C93-3F98-BF95-462F0EB67B91> /Applications/Xcode.app/Contents/PlugIns/IDESceneKitEditor.ideplugin/Contents/MacOS/IDESceneKitEditor\r\n       0x11eea6000 -        0x11ef2fff7  com.apple.xcode.GameToolsFoundation (1.0 - 14490.8) <B53E7656-A010-3C2F-AB70-BCCD24337E3E> /Applications/Xcode.app/Contents/SharedFrameworks/GameToolsFoundation.framework/Versions/A/GameToolsFoundation\r\n       0x11f02b000 -        0x11f05eff3  com.apple.gputools.GLToolsMobileAnalysis (1.0 - 24215) <403E22E0-356D-3081-8B9A-6E45A327002F> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/GPUTools/PlugIns/GLToolsMobileAnalysis.gtplugin/Contents/MacOS/GLToolsMobileAnalysis\r\n       0x11f06e000 -        0x11f07eff7  com.apple.gputools.GLToolsShaderProfilerMobileSupport (1.0 - 24215) <DC518DA8-890F-3049-AD28-762D7C6A71B6> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/GPUTools/PlugIns/GLToolsShaderProfilerMobileSupport.gtplugin/Contents/MacOS/GLToolsShaderProfilerMobileSupport\r\n       0x11f088000 -        0x11f202ff7  com.apple.gputools.GLToolsAnalysisHeuristics (1.0 - 24490.5) <00334410-A7FC-3567-AB71-AF51196244FC> /Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/Library/GPUTools/PlugIns/GLToolsAnalysisHeuristics.gtplugin/Contents/MacOS/GLToolsAnalysisHeuristics\r\n       0x11f6d3000 -        0x11f734fff  com.apple.dt.IDE.IDEPlaygroundEditor (10.2.1 - 14490.99) <092C5652-EAD2-30FB-AD6F-5641BC9DB331> /Applications/Xcode.app/Contents/PlugIns/IDEPlaygroundEditor.ideplugin/Contents/MacOS/IDEPlaygroundEditor\r\n       0x11f789000 -        0x11f7acff7  com.apple.dt.IDE.IDEPlaygroundExecution (10.2.1 - 14490.99) <D9A544CC-0CA5-3247-8225-55398340FAB8> /Applications/Xcode.app/Contents/PlugIns/IDEPlaygroundExecution.ideplugin/Contents/MacOS/IDEPlaygroundExecution\r\n       0x11f7cd000 -        0x11f861ff7  com.apple.dt.IDE.IDEPegasusPlaygroundEditor (10.2.1 - 14490.99) <0A767882-C0CA-3AD5-B5EE-3339C68C9930> /Applications/Xcode.app/Contents/PlugIns/IDEPegasusPlaygroundEditor.ideplugin/Contents/MacOS/IDEPegasusPlaygroundEditor\r\n       0x11fa1a000 -        0x11faa9ff7  com.apple.dt.IDE.IDEModelFoundation (10.2.1 - 14490.99) <2CCC2FE7-D504-3046-8052-C4EF55A0176E> /Applications/Xcode.app/Contents/PlugIns/IDEModelFoundation.ideplugin/Contents/MacOS/IDEModelFoundation\r\n       0x11fb15000 -        0x11fbefffb  com.apple.dt.IDE.IDEModelEditor (10.2.1 - 14490.99) <0657F1C2-A0E0-313F-8A61-D9E5C7B31D1D> /Applications/Xcode.app/Contents/PlugIns/IDEModelEditor.ideplugin/Contents/MacOS/IDEModelEditor\r\n       0x11fc8e000 -        0x11fdc3fff  com.apple.IDESpriteKitParticleEditor (2.0 - 2) <E4A9C84F-11F8-33FB-BBCE-45491AC7D345> /Applications/Xcode.app/Contents/PlugIns/IDESpriteKitParticleEditor.ideplugin/Contents/MacOS/IDESpriteKitParticleEditor\r\n       0x11fe99000 -        0x11fea0ff7  com.apple.dt.ScriptingDefinitionEditor (10.2.1 - 14490.99) <53D2FA57-B33C-35BE-A3DE-05E3D492C3B2> /Applications/Xcode.app/Contents/PlugIns/ScriptingDefinitionEditor.ideplugin/Contents/MacOS/ScriptingDefinitionEditor\r\n       0x12001d000 -        0x120074fff  com.apple.dt.IDE.XCBuildSupport (1.0 - 14490.99) <10662908-33C4-36FA-B8BC-7D709C9B9EB8> /Applications/Xcode.app/Contents/PlugIns/XCBuildSupport.ideplugin/Contents/MacOS/XCBuildSupport\r\n       0x1200c0000 -        0x120135ff7  com.apple.dt.XCBuild (1.0 - 14490.97) <6F09D5EE-BC98-3C9F-9805-B65ED8F1DD43> /Applications/Xcode.app/Contents/SharedFrameworks/XCBuild.framework/Versions/A/XCBuild\r\n       0x1201c3000 -        0x12025aff7  com.apple.dt.XCBProtocol (1.0 - 14490.97) <8EAD3E7D-7808-3176-9672-4ED4C492A5E8> /Applications/Xcode.app/Contents/SharedFrameworks/XCBuild.framework/Versions/A/PlugIns/XCBBuildService.bundle/Contents/Frameworks/XCBProtocol.framework/Versions/A/XCBProtocol\r\n       0x12031c000 -        0x1203d4fff  com.apple.dt.XCBUtil (1.0 - 14490.97) <9B1EEFC2-36B4-33AD-A768-D88311072B74> /Applications/Xcode.app/Contents/SharedFrameworks/XCBuild.framework/Versions/A/PlugIns/XCBBuildService.bundle/Contents/Frameworks/XCBUtil.framework/Versions/A/XCBUtil\r\n       0x120479000 -        0x120481ff7  com.apple.dt.XCBCSupport (1.0 - 14490.97) <FBAA5800-B43F-3116-95CC-2F848987F1EE> /Applications/Xcode.app/Contents/SharedFrameworks/XCBuild.framework/Versions/A/PlugIns/XCBBuildService.bundle/Contents/Frameworks/XCBCSupport.framework/Versions/A/XCBCSupport\r\n       0x1204da000 -        0x1204e3ffb  com.apple.dt.IDE.IDEInstrumentsService (10.2.1 - 14490.99) <B9FCBFA5-C94B-3A20-82C6-03F3942DC299> /Applications/Xcode.app/Contents/PlugIns/IDEInstrumentsService.ideplugin/Contents/MacOS/IDEInstrumentsService\r\n       0x1204ef000 -        0x12051ffff  com.apple.sourcekitd (1.0 - 1001.0.82.4) <DCA56F83-F6FA-3197-B935-91F7FE022738> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/sourcekitd.framework/sourcekitd\r\n       0x120537000 -        0x121962ff3 +libmetal.dylib (902.1.49) <5374EF7B-D4B0-3F3E-A090-CC777FDE904E> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/metal/macos/lib/metalfe/libmetal.dylib\r\n       0x121fe7000 -        0x121fedfff  com.apple.dt.IDEWatchSupportUI (1.0 - 1) <4427AC5C-D4BF-3805-900A-24BCDD94D7D4> /Applications/Xcode.app/Contents/Developer/Platforms/WatchOS.platform/Developer/Library/Xcode/PrivatePlugIns/IDEWatchSupportUI.ideplugin/Contents/MacOS/IDEWatchSupportUI\r\n    0x7fff38893000 -     0x7fff38becfff  com.apple.RawCamera.bundle (8.15.0 - 1031.4.4) <FBDF396C-3751-34C2-B452-F1449C583AE2> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera\r\n    0x7fff3d6b3000 -     0x7fff3d9e4fff  com.apple.driver.AppleIntelKBLGraphicsMTLDriver (12.9.22 - 12.0.9) <E8460F51-23F4-3B8A-8B02-5A69F5AB9249> /System/Library/Extensions/AppleIntelKBLGraphicsMTLDriver.bundle/Contents/MacOS/AppleIntelKBLGraphicsMTLDriver\r\n    0x7fff40146000 -     0x7fff40322ff3  com.apple.avfoundation (2.0 - 1548.22) <733E940A-7E18-3F0C-89AC-D7C6CA289BA6> /System/Library/Frameworks/AVFoundation.framework/Versions/A/AVFoundation\r\n    0x7fff40323000 -     0x7fff403e8fff  com.apple.audio.AVFAudio (1.0 - ???) <DDEE9303-EDD6-323D-B270-E8D2B98509FE> /System/Library/Frameworks/AVFoundation.framework/Versions/A/Frameworks/AVFAudio.framework/Versions/A/AVFAudio\r\n    0x7fff403ea000 -     0x7fff404effff  com.apple.AVKit (1.1 - 446.50.101) <56AD537F-0BA5-360D-8B83-D5BB16A1BF4E> /System/Library/Frameworks/AVKit.framework/Versions/A/AVKit\r\n    0x7fff404f0000 -     0x7fff404f0fff  com.apple.Accelerate (1.11 - Accelerate 1.11) <762942CB-CFC9-3A0C-9645-A56523A06426> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate\r\n    0x7fff404f1000 -     0x7fff40507ff7  libCGInterfaces.dylib (506.22) <09E81708-D0A7-3AB6-9B7C-8245E33E27A3> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/Libraries/libCGInterfaces.dylib\r\n    0x7fff40508000 -     0x7fff40ba1fef  com.apple.vImage (8.1 - ???) <EFFD9A9C-5563-3762-91CA-9F50FDB7A547> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage\r\n    0x7fff40ba2000 -     0x7fff40e1bff3  libBLAS.dylib (1243.200.4) <417CA0FC-B6CB-3FB3-ACBC-8914E3F62D20> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib\r\n    0x7fff40e1c000 -     0x7fff40e8effb  libBNNS.dylib (38.250.1) <538D12A2-9B9D-3E22-9896-F90F6E69C06E> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBNNS.dylib\r\n    0x7fff40e8f000 -     0x7fff41238ff3  libLAPACK.dylib (1243.200.4) <92175DF4-863A-3780-909A-A3E5C410F2E9> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib\r\n    0x7fff41239000 -     0x7fff4124efeb  libLinearAlgebra.dylib (1243.200.4) <CB671EE6-DEA1-391C-9B2B-AA09A46B4D7A> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib\r\n    0x7fff4124f000 -     0x7fff41254ff3  libQuadrature.dylib (3.200.2) <1BAE7E22-2862-379F-B334-A3756067730F> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libQuadrature.dylib\r\n    0x7fff41255000 -     0x7fff412d1ff3  libSparse.dylib (79.200.5) <E78B33D3-672A-3C53-B512-D3DDB2E9AC8D> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparse.dylib\r\n    0x7fff412d2000 -     0x7fff412e5fe3  libSparseBLAS.dylib (1243.200.4) <E9243341-DB77-37C1-97C5-3DFA00DD70FA> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparseBLAS.dylib\r\n    0x7fff412e6000 -     0x7fff414cdff7  libvDSP.dylib (671.250.4) <7B110627-A9C1-3FB7-A077-0C7741BA25D8> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib\r\n    0x7fff414ce000 -     0x7fff41581ff7  libvMisc.dylib (671.250.4) <73637194-497A-39F9-90F5-004DA772AC69> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib\r\n    0x7fff41582000 -     0x7fff41582fff  com.apple.Accelerate.vecLib (3.11 - vecLib 3.11) <74288115-EF61-30B6-843F-0593B31D4929> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib\r\n    0x7fff41583000 -     0x7fff415ddfff  com.apple.Accounts (113 - 113) <251A1CB1-F972-3F60-8662-85459EAD6318> /System/Library/Frameworks/Accounts.framework/Versions/A/Accounts\r\n    0x7fff415e0000 -     0x7fff41723fff  com.apple.AddressBook.framework (11.0 - 1894) <4D4DF3AE-C333-3646-8BA6-F0E8DFE1A46E> /System/Library/Frameworks/AddressBook.framework/Versions/A/AddressBook\r\n    0x7fff41724000 -     0x7fff424d9ff3  com.apple.AppKit (6.9 - 1671.50.111) <933155DC-6404-3646-B6AE-087D34F611BE> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit\r\n    0x7fff4251a000 -     0x7fff4252afff  com.apple.AppleScriptObjC (1.4 - 35) <9BDF3D28-05F7-3FFF-A890-68C809F0DD66> /System/Library/Frameworks/AppleScriptObjC.framework/Versions/A/AppleScriptObjC\r\n    0x7fff4252b000 -     0x7fff4252bfff  com.apple.ApplicationServices (50.1 - 50.1) <4A6ACC13-2623-36B8-A196-2300980803CD> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices\r\n    0x7fff4252c000 -     0x7fff42597fff  com.apple.ApplicationServices.ATS (377 - 453.11.2.2) <A258DA73-114B-3102-A056-4AAAD3CEB9DD> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS\r\n    0x7fff42630000 -     0x7fff42747fff  libFontParser.dylib (228.6.2.3) <3602D55B-3B9E-3B3A-A814-08C1244A8AE4> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib\r\n    0x7fff42748000 -     0x7fff4278afff  libFontRegistry.dylib (228.12.2.3) <2A56347B-2809-3407-A8B4-2AB88E484062> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib\r\n    0x7fff427e4000 -     0x7fff42816fff  libTrueTypeScaler.dylib (228.6.2.3) <7E4C5D9C-51AF-3EC1-8FA5-11CD4BEE477A> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libTrueTypeScaler.dylib\r\n    0x7fff4287b000 -     0x7fff4287fff3  com.apple.ColorSyncLegacy (4.13.0 - 1) <B53D557C-071F-3ED9-826A-847DEB465F62> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSyncLegacy.framework/Versions/A/ColorSyncLegacy\r\n    0x7fff4291a000 -     0x7fff4296cff7  com.apple.HIServices (1.22 - 628) <26A8B7C0-41CC-3DB4-99D7-BD922866DC77> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices\r\n    0x7fff4296d000 -     0x7fff4297cfff  com.apple.LangAnalysis (1.7.0 - 1.7.0) <F5617A2A-FEA6-3832-B5BA-C2111B98786F> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis\r\n    0x7fff4297d000 -     0x7fff429c6ff7  com.apple.print.framework.PrintCore (14.2 - 503.8) <57C2FE32-0E74-3079-B626-C2D52F2D2717> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore\r\n    0x7fff429c7000 -     0x7fff42a00ff7  com.apple.QD (3.12 - 407.2) <28C7D39F-59C9-3314-BECC-67045487229C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD\r\n    0x7fff42a01000 -     0x7fff42a0dfff  com.apple.speech.synthesis.framework (8.1.3 - 8.1.3) <80FA7439-EC77-3CEC-B5D1-5EFE9E503E11> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis\r\n    0x7fff42a0e000 -     0x7fff42c85ff7  com.apple.audio.toolbox.AudioToolbox (1.14 - 1.14) <EB71583C-58C9-3CF8-92F9-2D57B24BBD4F> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox\r\n    0x7fff42c87000 -     0x7fff42c87fff  com.apple.audio.units.AudioUnit (1.14 - 1.14) <121176B6-7ABE-3AFB-A252-CCED694D98D4> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit\r\n    0x7fff42dc1000 -     0x7fff42fbaff3  com.apple.AutomatorFramework (2.9 - 444.42) <1A69204D-19C4-36EA-A39C-55CB71DA685E> /System/Library/Frameworks/Automator.framework/Versions/A/Automator\r\n    0x7fff42fdf000 -     0x7fff43380fff  com.apple.CFNetwork (978.0.7 - 978.0.7) <9FDEFE50-BE1B-386E-8B3C-AEF251069E52> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork\r\n    0x7fff43395000 -     0x7fff43395fff  com.apple.Carbon (158 - 158) <AC9E8C1E-2566-3C2C-8B6B-B5B4C9A1B8B7> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon\r\n    0x7fff43396000 -     0x7fff43399ffb  com.apple.CommonPanels (1.2.6 - 98) <1CD6D56D-8EC7-3528-8CBC-FC69533519B5> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels\r\n    0x7fff4339a000 -     0x7fff43690ff7  com.apple.HIToolbox (2.1.1 - 918.5) <F7DA4F20-123B-30FB-9C27-5AB1746DEF63> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox\r\n    0x7fff43691000 -     0x7fff43694ff3  com.apple.help (1.3.8 - 66) <A08517EB-8958-36C9-AEE0-1A8FEEACBE3F> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help\r\n    0x7fff43695000 -     0x7fff4369aff7  com.apple.ImageCapture (9.0 - 1534.2) <DB063E87-ED8F-3E4E-A7E2-A6B45FA73EF7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture\r\n    0x7fff4369b000 -     0x7fff43730ff3  com.apple.ink.framework (10.9 - 225) <7C7E9483-2E91-3DD3-B1E0-C238F42CA0DD> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink\r\n    0x7fff43731000 -     0x7fff43749ff7  com.apple.openscripting (1.7 - 179.1) <9B8C1ECC-5864-3E21-9149-863E884EA25C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting\r\n    0x7fff43769000 -     0x7fff4376aff7  com.apple.print.framework.Print (14.2 - 267.4) <A7A9D2A0-D4E0-35EF-A0F7-50521F707C33> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print\r\n    0x7fff4376b000 -     0x7fff4376dff7  com.apple.securityhi (9.0 - 55006) <05717F77-7A7B-37E6-AB3E-03F063E9095B> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI\r\n    0x7fff4376e000 -     0x7fff43774ff7  com.apple.speech.recognition.framework (6.0.3 - 6.0.3) <3CC050FB-EBCB-3087-8EA5-F378C8F99217> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition\r\n    0x7fff43896000 -     0x7fff43896fff  com.apple.Cocoa (6.11 - 23) <9378783B-65FE-3E78-A7D5-0D11EE9117AE> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa\r\n    0x7fff43897000 -     0x7fff438a3ffb  com.apple.Collaboration (81 - 81) <617DE98E-196A-3866-9E74-953D1E3BBED7> /System/Library/Frameworks/Collaboration.framework/Versions/A/Collaboration\r\n    0x7fff438a4000 -     0x7fff43970ff7  com.apple.ColorSync (4.13.0 - 3340.7) <74B373AB-42C7-330D-A577-1C43BFA6024F> /System/Library/Frameworks/ColorSync.framework/Versions/A/ColorSync\r\n    0x7fff43971000 -     0x7fff43a59ff7  com.apple.contacts (1.0 - 2901) <A6734AF0-D8E6-32C7-B283-DF1E7627F0D3> /System/Library/Frameworks/Contacts.framework/Versions/A/Contacts\r\n    0x7fff43afc000 -     0x7fff43b82fff  com.apple.audio.CoreAudio (4.3.0 - 4.3.0) <1E8E64E6-0E58-375A-97F7-07CB4EE181AC> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio\r\n    0x7fff43be6000 -     0x7fff43c10ffb  com.apple.CoreBluetooth (1.0 - 1) <F08FE8C0-DD18-37E0-B707-3EF704A73FD6> /System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth\r\n    0x7fff43c11000 -     0x7fff43f95fe3  com.apple.CoreData (120 - 866.5) <37F35F2E-FE57-3E3F-A1E5-AD274A8C1FDE> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData\r\n    0x7fff43f96000 -     0x7fff4407dff7  com.apple.CoreDisplay (101.3 - 109.19) <B00A19C2-4A6A-388C-8AD6-33A42D10D7F0> /System/Library/Frameworks/CoreDisplay.framework/Versions/A/CoreDisplay\r\n    0x7fff4407e000 -     0x7fff444c2fff  com.apple.CoreFoundation (6.9 - 1575.12) <64C38BF2-1869-33C8-B1B6-DCA9C824C0E4> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation\r\n    0x7fff444c4000 -     0x7fff44b53fe7  com.apple.CoreGraphics (2.0 - 1260.2) <23436C9A-7D62-3E9F-867A-798C93B52080> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics\r\n    0x7fff44b55000 -     0x7fff44e75fff  com.apple.CoreImage (14.4.0 - 750.0.140) <96FA4D1B-AC88-305C-8F4D-D7D44657B733> /System/Library/Frameworks/CoreImage.framework/Versions/A/CoreImage\r\n    0x7fff44e76000 -     0x7fff44eeefff  com.apple.corelocation (2245.16.11) <C49D3654-18B6-3478-A4EB-81D3DC1483A6> /System/Library/Frameworks/CoreLocation.framework/Versions/A/CoreLocation\r\n    0x7fff44f48000 -     0x7fff45171fff  com.apple.CoreML (1.0 - 1) <9EC1FED2-BA47-307B-A326-43C4D05166E7> /System/Library/Frameworks/CoreML.framework/Versions/A/CoreML\r\n    0x7fff45172000 -     0x7fff45276ff7  com.apple.CoreMedia (1.0 - 2288.40) <9BB054FB-68F1-3F03-A8B3-3E55471A6F9B> /System/Library/Frameworks/CoreMedia.framework/Versions/A/CoreMedia\r\n    0x7fff45277000 -     0x7fff452d2fff  com.apple.CoreMediaIO (900.0 - 5050.1) <D4105C95-50F3-35F4-A132-B9A2FA653704> /System/Library/Frameworks/CoreMediaIO.framework/Versions/A/CoreMediaIO\r\n    0x7fff452d3000 -     0x7fff452d3fff  com.apple.CoreServices (945 - 945) <E937BA69-19D5-3A30-B31E-8A6B94E9D9A0> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices\r\n    0x7fff452d4000 -     0x7fff45350ff7  com.apple.AE (773 - 773) <55AE7C9E-27C3-30E9-A047-3B92A6FD53B4> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE\r\n    0x7fff45351000 -     0x7fff45628fff  com.apple.CoreServices.CarbonCore (1178.32 - 1178.32) <52F5484E-94B1-37B7-B1AC-E210DF5721AE> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore\r\n    0x7fff45629000 -     0x7fff45671ff7  com.apple.DictionaryServices (1.2 - 284.16.4) <C3D15FD1-759B-3815-8128-42D8220BC459> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices\r\n    0x7fff45672000 -     0x7fff4567affb  com.apple.CoreServices.FSEvents (1239.200.12 - 1239.200.12) <8406D379-8D33-3611-861B-7ABD26DB50D2> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents\r\n    0x7fff4567b000 -     0x7fff4582dfff  com.apple.LaunchServices (945 - 945) <05FA145B-75AA-3AE6-BB82-F156B29F4FF1> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices\r\n    0x7fff4582e000 -     0x7fff458ccff7  com.apple.Metadata (10.7.0 - 1191.57) <BFFAED00-2560-318A-BB8F-4E7E5123EC61> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata\r\n    0x7fff458cd000 -     0x7fff45917ff7  com.apple.CoreServices.OSServices (945 - 945) <119C5548-59C3-3F94-B23F-8AF02CA10EAA> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices\r\n    0x7fff45918000 -     0x7fff4597fff7  com.apple.SearchKit (1.4.0 - 1.4.0) <DA08AA6F-A6F1-36C0-87F4-E26294E51A3A> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit\r\n    0x7fff45980000 -     0x7fff459a1ff3  com.apple.coreservices.SharedFileList (71.28 - 71.28) <487A8464-729E-305A-B5D1-E3FE8EB9CFC5> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SharedFileList.framework/Versions/A/SharedFileList\r\n    0x7fff45cac000 -     0x7fff45e0eff3  com.apple.CoreText (352.0 - 584.26.3.2) <A99FD623-7F6E-3C77-8241-E98F664EC039> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText\r\n    0x7fff45e0f000 -     0x7fff45e4efff  com.apple.CoreVideo (1.8 - 0.0) <1AD23C58-E68E-329B-A1FA-6BF7DD577687> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo\r\n    0x7fff45e4f000 -     0x7fff45edefff  com.apple.framework.CoreWLAN (13.0 - 1375.2) <F2EA31D8-53BF-32E8-B537-64B4F2BF4B6E> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN\r\n    0x7fff46055000 -     0x7fff46060ffb  com.apple.DirectoryService.Framework (10.14 - 207.200.4) <49B086F4-AFA2-3ABB-8D2E-CE253044C1C0> /System/Library/Frameworks/DirectoryService.framework/Versions/A/DirectoryService\r\n    0x7fff46061000 -     0x7fff4610ffff  com.apple.DiscRecording (9.0.3 - 9030.4.5) <D7A28B57-C025-3D44-BB17-82243B7B91BC> /System/Library/Frameworks/DiscRecording.framework/Versions/A/DiscRecording\r\n    0x7fff46110000 -     0x7fff46134fff  com.apple.DiscRecordingUI (9.0.3 - 9030.4.5) <ED9144F4-1C1D-3995-8C76-CC9CA6E8707A> /System/Library/Frameworks/DiscRecordingUI.framework/Versions/A/DiscRecordingUI\r\n    0x7fff46135000 -     0x7fff4613affb  com.apple.DiskArbitration (2.7 - 2.7) <F481F2C0-884E-3265-8111-ABBEC93F0920> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration\r\n    0x7fff46300000 -     0x7fff466adfff  com.apple.Foundation (6.9 - 1575.12) <AD258ED7-64AE-367C-AE5F-48D45089D9F2> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\r\n    0x7fff466af000 -     0x7fff466d8ff7  com.apple.GLKit (1.0 - 101) <624A3A60-BD78-32A4-8F2B-D1F673AC3263> /System/Library/Frameworks/GLKit.framework/Versions/A/GLKit\r\n    0x7fff4671c000 -     0x7fff4674bffb  com.apple.GSS (4.0 - 2.0) <E41430E5-713B-3E53-BF7E-A3991A881B62> /System/Library/Frameworks/GSS.framework/Versions/A/GSS\r\n    0x7fff46767000 -     0x7fff46812fff  com.apple.GameplayKit (1.0 - 1) <5FB5EC0F-4823-3FC1-A678-0578D099D818> /System/Library/Frameworks/GameplayKit.framework/Versions/A/GameplayKit\r\n    0x7fff4684b000 -     0x7fff46955fff  com.apple.Bluetooth (6.0.12 - 6.0.12f1) <58A607F0-A818-3535-A7BD-858D5BB0A807> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth\r\n    0x7fff469b7000 -     0x7fff46a46fff  com.apple.framework.IOKit (2.0.2 - 1483.260.4) <CCA92450-8808-37EC-B68E-2C2846B086CE> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit\r\n    0x7fff46a48000 -     0x7fff46a57ffb  com.apple.IOSurface (255.5.4 - 255.5.4) <83F58E47-0D06-3E78-9D19-D38D3205464B> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface\r\n    0x7fff46a58000 -     0x7fff46aaaff3  com.apple.ImageCaptureCore (1.0 - 1534.2) <27942C51-8108-3ED9-B37E-7C365A31EC2D> /System/Library/Frameworks/ImageCaptureCore.framework/Versions/A/ImageCaptureCore\r\n    0x7fff46aab000 -     0x7fff46c36fef  com.apple.ImageIO.framework (3.3.0 - 1850.2) <E1CC52A4-1074-3997-849B-42EF20EE1ADC> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO\r\n    0x7fff46c37000 -     0x7fff46c3bffb  libGIF.dylib (1850.2) <FB52622F-2A7D-36D0-B821-35DB2BAF9EE8> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib\r\n    0x7fff46c3c000 -     0x7fff46d18fef  libJP2.dylib (1850.2) <7FAC16D8-1144-30A1-BABC-008423C7A851> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib\r\n    0x7fff46d19000 -     0x7fff46d3efeb  libJPEG.dylib (1850.2) <78401F6E-345B-3179-A82A-01F813F15D95> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib\r\n    0x7fff47001000 -     0x7fff47027feb  libPng.dylib (1850.2) <FF3ABAE1-43F0-3A76-A284-398397693D46> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib\r\n    0x7fff47028000 -     0x7fff4702affb  libRadiance.dylib (1850.2) <92529333-0935-341B-B271-69C235FEF6B5> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib\r\n    0x7fff4702b000 -     0x7fff47078fe7  libTIFF.dylib (1850.2) <FFC74F3B-16F9-38FE-9D3F-D8DC6DEDB9E9> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib\r\n    0x7fff47373000 -     0x7fff481d7ff3  com.apple.JavaScriptCore (14607 - 14607.2.6.1.1) <63604178-EF3B-3CD3-AD4B-F4189963C51D> /System/Library/Frameworks/JavaScriptCore.framework/Versions/A/JavaScriptCore\r\n    0x7fff481ef000 -     0x7fff48208fff  com.apple.Kerberos (3.0 - 1) <DB1E0679-37E1-3B93-9789-32F63D660C3B> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos\r\n    0x7fff48209000 -     0x7fff4823eff3  com.apple.LDAPFramework (2.4.28 - 194.5) <95DAD9EE-9B6F-3FF5-A5EF-F6672AD3CC55> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP\r\n    0x7fff482bf000 -     0x7fff484c0fff  com.apple.MapKit (1.0 - 1832.25.12.18.16) <92A5C096-EC8D-3CBA-A2F1-1196BDABEA36> /System/Library/Frameworks/MapKit.framework/Versions/A/MapKit\r\n    0x7fff484c2000 -     0x7fff484ccfff  com.apple.MediaAccessibility (1.0 - 114.4) <76C449C5-DB45-3D7F-BFAD-3DACEF15DA21> /System/Library/Frameworks/MediaAccessibility.framework/Versions/A/MediaAccessibility\r\n    0x7fff484e1000 -     0x7fff4857bffb  com.apple.MediaPlayer (1.0 - 1.0) <82224671-7441-3545-ABE8-EE6F59D7C374> /System/Library/Frameworks/MediaPlayer.framework/Versions/A/MediaPlayer\r\n    0x7fff4857c000 -     0x7fff48c22ff7  com.apple.MediaToolbox (1.0 - 2288.40) <0629E756-3D2A-36A4-B25F-9C050FC859B5> /System/Library/Frameworks/MediaToolbox.framework/Versions/A/MediaToolbox\r\n    0x7fff48c24000 -     0x7fff48cccff7  com.apple.Metal (161.9.16 - 161.9.16) <A93AA7FC-B72A-3CBF-9932-81DDDFA1DFCD> /System/Library/Frameworks/Metal.framework/Versions/A/Metal\r\n    0x7fff48cce000 -     0x7fff48ce7ff3  com.apple.MetalKit (1.0 - 113) <51CDE966-54A7-3556-971B-1173E9986BB8> /System/Library/Frameworks/MetalKit.framework/Versions/A/MetalKit\r\n    0x7fff48ce8000 -     0x7fff48d07ff7  com.apple.MetalPerformanceShaders.MPSCore (1.0 - 1) <EE85B6D5-5C12-3CE8-8C33-54A203EDC76E> /System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSCore.framework/Versions/A/MPSCore\r\n    0x7fff48d08000 -     0x7fff48d84fe7  com.apple.MetalPerformanceShaders.MPSImage (1.0 - 1) <5A78F2DC-9D2B-37BA-B21F-ECFFCC6F7720> /System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSImage.framework/Versions/A/MPSImage\r\n    0x7fff48d85000 -     0x7fff48dacfff  com.apple.MetalPerformanceShaders.MPSMatrix (1.0 - 1) <096DB3E6-7DDF-3B47-857A-46A203642ACF> /System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSMatrix.framework/Versions/A/MPSMatrix\r\n    0x7fff48dad000 -     0x7fff48ed8ff7  com.apple.MetalPerformanceShaders.MPSNeuralNetwork (1.0 - 1) <D2128338-F1E8-3BEE-A729-AC13A524DD78> /System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSNeuralNetwork.framework/Versions/A/MPSNeuralNetwork\r\n    0x7fff48ed9000 -     0x7fff48ef3fff  com.apple.MetalPerformanceShaders.MPSRayIntersector (1.0 - 1) <ADA5A93C-F79E-3931-840D-48C6B6B305EA> /System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSRayIntersector.framework/Versions/A/MPSRayIntersector\r\n    0x7fff48ef4000 -     0x7fff48ef5ff7  com.apple.MetalPerformanceShaders.MetalPerformanceShaders (1.0 - 1) <515A92B3-A23B-3AC2-8D1B-85B248595B76> /System/Library/Frameworks/MetalPerformanceShaders.framework/Versions/A/MetalPerformanceShaders\r\n    0x7fff48ef6000 -     0x7fff49c73ff7  com.apple.ModelIO (1.0 - 1) <0E4E4B6F-914F-314C-9FA8-2B81F0D03CE2> /System/Library/Frameworks/ModelIO.framework/Versions/A/ModelIO\r\n    0x7fff49cec000 -     0x7fff49cf8ff7  com.apple.NetFS (6.0 - 4.0) <E917806F-0607-3292-B2D6-A15404D61B99> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS\r\n    0x7fff49cf9000 -     0x7fff49e36ffb  com.apple.Network (1.0 - 1) <F46AFEE5-A56E-3BD9-AC07-C5D6334B3572> /System/Library/Frameworks/Network.framework/Versions/A/Network\r\n    0x7fff4a01f000 -     0x7fff4a05afff  com.apple.OSAKit (1.5 - 107) <879FB449-D01A-3D47-B733-F228FC060B1B> /System/Library/Frameworks/OSAKit.framework/Versions/A/OSAKit\r\n    0x7fff4a05b000 -     0x7fff4a07eff7  com.apple.audio.OpenAL (1.8 - 1.8) <2EE5236C-775B-36B1-97A8-DEE5FB80F5B5> /System/Library/Frameworks/OpenAL.framework/Versions/A/OpenAL\r\n    0x7fff4c796000 -     0x7fff4c7edff7  com.apple.opencl (2.15.3 - 2.15.3) <AA9CE8F7-DB7C-35A5-A019-2207D1BBFF38> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL\r\n    0x7fff4c7ee000 -     0x7fff4c809ff7  com.apple.CFOpenDirectory (10.14 - 207.200.4) <F03D84EB-49B2-3A00-9127-B9A269824026> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory\r\n    0x7fff4c80a000 -     0x7fff4c815ffb  com.apple.OpenDirectory (10.14 - 207.200.4) <A8020CEE-5B78-3581-A735-EA2833683F31> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory\r\n    0x7fff4d165000 -     0x7fff4d167fff  libCVMSPluginSupport.dylib (17.7.2) <247121BB-626C-318E-B24E-3D436E752DF7> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib\r\n    0x7fff4d168000 -     0x7fff4d16dff3  libCoreFSCache.dylib (166.2) <222C2A4F-7E32-30F6-8459-2FAB98073A3D> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreFSCache.dylib\r\n    0x7fff4d16e000 -     0x7fff4d172fff  libCoreVMClient.dylib (166.2) <6789ECD4-91DD-32EF-A1FD-F27D2344CD8B> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib\r\n    0x7fff4d173000 -     0x7fff4d17bff7  libGFXShared.dylib (17.7.2) <B75A6E93-E5BE-32A8-8D46-00D8E909DFD3> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib\r\n    0x7fff4d17c000 -     0x7fff4d187fff  libGL.dylib (17.7.2) <E88FF023-7E15-3E95-88FD-6C415550F769> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib\r\n    0x7fff4d188000 -     0x7fff4d1c2fe7  libGLImage.dylib (17.7.2) <B4C140F3-AF8C-30C8-A03E-B16A20BB05A7> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib\r\n    0x7fff4d336000 -     0x7fff4d374fff  libGLU.dylib (17.7.2) <EA69FA36-3F20-337C-A6B3-EC49DC2F12F5> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib\r\n    0x7fff4dd11000 -     0x7fff4dd20ffb  com.apple.opengl (17.7.2 - 17.7.2) <8EFFA6F9-ABE8-3131-9D3F-37E9796DDF34> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL\r\n    0x7fff4dfaf000 -     0x7fff4e09cff7  org.python.python (2.7.10 - 2.7.10) <57BD29EC-2274-3DC4-B5E4-7A1A045BD573> /System/Library/Frameworks/Python.framework/Versions/2.7/Python\r\n    0x7fff4e09d000 -     0x7fff4e1e6ff7  com.apple.QTKit (7.7.3 - 3040) <62DEEB24-E90A-3919-8B13-6A8840C6E800> /System/Library/Frameworks/QTKit.framework/Versions/A/QTKit\r\n    0x7fff4e1e7000 -     0x7fff4e43bfff  com.apple.imageKit (3.0 - 1067) <4F398AF4-828E-3FC2-9E3D-4EE3F36F7619> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/ImageKit.framework/Versions/A/ImageKit\r\n    0x7fff4e43c000 -     0x7fff4e528fff  com.apple.PDFKit (1.0 - 745.3) <96FCB240-CB6C-395E-8BBC-F0A5C223F557> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/PDFKit.framework/Versions/A/PDFKit\r\n    0x7fff4e529000 -     0x7fff4e9f8ff7  com.apple.QuartzComposer (5.1 - 370) <9C59494E-8D09-359E-B457-AA893520984C> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzComposer.framework/Versions/A/QuartzComposer\r\n    0x7fff4e9f9000 -     0x7fff4ea1fff7  com.apple.quartzfilters (1.10.0 - 83.1) <1CABB0FA-A6DB-3DD5-A598-F298F081E04E> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzFilters.framework/Versions/A/QuartzFilters\r\n    0x7fff4ea20000 -     0x7fff4eb21ff7  com.apple.QuickLookUIFramework (5.0 - 775.6) <11B2F7F1-818B-353C-BBC9-3BC0C0DCE637> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuickLookUI.framework/Versions/A/QuickLookUI\r\n    0x7fff4eb22000 -     0x7fff4eb22fff  com.apple.quartzframework (1.5 - 23) <62B9AB40-3BE3-3A81-B132-3168898BD748> /System/Library/Frameworks/Quartz.framework/Versions/A/Quartz\r\n    0x7fff4eb23000 -     0x7fff4ed79fff  com.apple.QuartzCore (1.11 - 699.27.4.1) <BB3BBD58-84DF-3849-B4ED-5FF8DA4015B8> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore\r\n    0x7fff4ed7a000 -     0x7fff4edd1fff  com.apple.QuickLookFramework (5.0 - 775.6) <FB5BBD33-7AA6-34C0-9121-59C98F9B1A3D> /System/Library/Frameworks/QuickLook.framework/Versions/A/QuickLook\r\n    0x7fff4ef98000 -     0x7fff4efafff7  com.apple.SafariServices.framework (14607 - 14607.2.6.1.1) <EBBD0D29-808F-313A-AC14-A1AD5FB90DA4> /System/Library/Frameworks/SafariServices.framework/Versions/A/SafariServices\r\n    0x7fff4efb0000 -     0x7fff4f571ff7  com.apple.SceneKit (1.0 - 470.10) <18ED018F-D022-3150-94DF-EFC0D16F718D> /System/Library/Frameworks/SceneKit.framework/Versions/A/SceneKit\r\n    0x7fff4f595000 -     0x7fff4f5adfff  com.apple.ScriptingBridge (1.4 - 78) <DCF38614-C6E9-3EB1-88F9-985F247A57B9> /System/Library/Frameworks/ScriptingBridge.framework/Versions/A/ScriptingBridge\r\n    0x7fff4f5ae000 -     0x7fff4f8adfff  com.apple.security (7.0 - 58286.260.20) <59B4100E-5A31-3EF4-954A-2A69341995F3> /System/Library/Frameworks/Security.framework/Versions/A/Security\r\n    0x7fff4f8ae000 -     0x7fff4f93afff  com.apple.securityfoundation (6.0 - 55185.260.1) <DB8EB672-5D3A-3082-A62E-4D75C81D94A4> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation\r\n    0x7fff4f93b000 -     0x7fff4f96bffb  com.apple.securityinterface (10.0 - 55109.200.8) <4F6896A5-4947-39A9-817A-3C23D97946AD> /System/Library/Frameworks/SecurityInterface.framework/Versions/A/SecurityInterface\r\n    0x7fff4f96c000 -     0x7fff4f970fff  com.apple.xpc.ServiceManagement (1.0 - 1) <4AD0F8EE-884C-3FA7-85D9-27F201BC3C64> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement\r\n    0x7fff4f9c1000 -     0x7fff4fbbdff7  com.apple.SpriteKit (1.0 - 1) <842BD7BE-B2E2-315F-B388-F8A95DA30427> /System/Library/Frameworks/SpriteKit.framework/Versions/A/SpriteKit\r\n    0x7fff4fd08000 -     0x7fff4fd75fff  com.apple.SystemConfiguration (1.17 - 1.17) <1562078D-3251-31B2-B9C6-2667C567F883> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration\r\n    0x7fff4ffd4000 -     0x7fff50333ff7  com.apple.VideoToolbox (1.0 - 2288.40) <17BD9E7F-3B8E-3B62-BACE-AE04824F4B7B> /System/Library/Frameworks/VideoToolbox.framework/Versions/A/VideoToolbox\r\n    0x7fff50608000 -     0x7fff50c15ff7  libwebrtc.dylib (7607.2.6.1.1) <3F40BD92-BDB6-3969-B898-F519ED661E55> /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/Frameworks/libwebrtc.dylib\r\n    0x7fff50c16000 -     0x7fff525e5ff7  com.apple.WebCore (14607 - 14607.2.6.1.1) <EB94C3FF-2425-3954-9386-D47EDE2DF373> /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore\r\n    0x7fff525e6000 -     0x7fff527d7ff3  com.apple.WebKitLegacy (14607 - 14607.2.6.1.1) <33D50B13-5473-3DDF-9D2B-D39E00CB8C79> /System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebKitLegacy.framework/Versions/A/WebKitLegacy\r\n    0x7fff527d8000 -     0x7fff52d23fff  com.apple.WebKit (14607 - 14607.2.6.1.1) <019283CC-5A1D-34FE-85CD-307B8C15D637> /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit\r\n    0x7fff52ff4000 -     0x7fff53099feb  com.apple.APFS (1.0 - 1) <C001DCC2-32BE-327A-AE03-281885BD93BF> /System/Library/PrivateFrameworks/APFS.framework/Versions/A/APFS\r\n    0x7fff53624000 -     0x7fff5362efff  com.apple.accessibility.AXCoreUtilities (1.0 - 1) <5C32D5F7-4A89-3262-B3AC-461603A69E42> /System/Library/PrivateFrameworks/AXCoreUtilities.framework/Versions/A/AXCoreUtilities\r\n    0x7fff53945000 -     0x7fff53a8fff7  com.apple.AddressBook.core (1.0 - 1) <1996684C-449B-3246-93C2-66AB4B212706> /System/Library/PrivateFrameworks/AddressBookCore.framework/Versions/A/AddressBookCore\r\n    0x7fff53aab000 -     0x7fff53aacff7  com.apple.AggregateDictionary (1.0 - 1) <A6AF8AC4-1F25-37C4-9157-A02E9C200926> /System/Library/PrivateFrameworks/AggregateDictionary.framework/Versions/A/AggregateDictionary\r\n    0x7fff53e67000 -     0x7fff53faafff  com.apple.AnnotationKit (1.0 - 232.3.30) <A35C5450-FBA1-3E76-9F27-4ED0179AE6A6> /System/Library/PrivateFrameworks/AnnotationKit.framework/Versions/A/AnnotationKit\r\n    0x7fff53fab000 -     0x7fff53fc6ff7  com.apple.AppContainer (4.0 - 360.250.1) <0795BF3B-4755-3F4F-B230-99A29114A260> /System/Library/PrivateFrameworks/AppContainer.framework/Versions/A/AppContainer\r\n    0x7fff53fc7000 -     0x7fff53fd4fff  com.apple.AppSandbox (4.0 - 360.250.1) <D15FBBAB-0716-394C-82D0-3E0F0B274690> /System/Library/PrivateFrameworks/AppSandbox.framework/Versions/A/AppSandbox\r\n    0x7fff54089000 -     0x7fff540a9fff  com.apple.AppSupportUI (1.0 - ???) <8297F6CE-4216-356F-AC8B-588A183E5E99> /System/Library/PrivateFrameworks/AppSupportUI.framework/Versions/A/AppSupportUI\r\n    0x7fff540aa000 -     0x7fff540d6ff7  com.apple.framework.Apple80211 (13.0 - 1380.2) <3850E3A9-E00A-374E-87EA-AB01E503E769> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple80211\r\n    0x7fff541fe000 -     0x7fff5420dfc7  com.apple.AppleFSCompression (96.200.3 - 1.0) <3CF60CE8-976E-3CB8-959D-DD0948C1C2DE> /System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression\r\n    0x7fff54309000 -     0x7fff54314fff  com.apple.AppleIDAuthSupport (1.0 - 1) <2E9D1398-DBE6-328B-ADDA-20FA5FAD7405> /System/Library/PrivateFrameworks/AppleIDAuthSupport.framework/Versions/A/AppleIDAuthSupport\r\n    0x7fff54355000 -     0x7fff5439eff3  com.apple.AppleJPEG (1.0 - 1) <4C1F426B-7D77-3980-9633-7DBD8C666B9A> /System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG\r\n    0x7fff5439f000 -     0x7fff543affff  com.apple.AppleLDAP (10.14 - 46.200.2) <DA9C0E8E-86D6-3CE8-8A12-B9C2254920A8> /System/Library/PrivateFrameworks/AppleLDAP.framework/Versions/A/AppleLDAP\r\n    0x7fff545cf000 -     0x7fff545ecfff  com.apple.aps.framework (4.0 - 4.0) <83FB4BD1-0C45-3CEF-8640-567DA5A300A7> /System/Library/PrivateFrameworks/ApplePushService.framework/Versions/A/ApplePushService\r\n    0x7fff545ed000 -     0x7fff545f1ff7  com.apple.AppleSRP (5.0 - 1) <EDD16B2E-4F35-3E13-B389-CF77B3CAD4EB> /System/Library/PrivateFrameworks/AppleSRP.framework/Versions/A/AppleSRP\r\n    0x7fff545f2000 -     0x7fff54614fff  com.apple.applesauce (1.0 - ???) <F49107C7-3C51-3024-8EF1-C57643BE4F3B> /System/Library/PrivateFrameworks/AppleSauce.framework/Versions/A/AppleSauce\r\n    0x7fff546d4000 -     0x7fff546d7ff7  com.apple.AppleSystemInfo (3.1.5 - 3.1.5) <F6FBF74B-0512-39DB-A1DA-69610D69186D> /System/Library/PrivateFrameworks/AppleSystemInfo.framework/Versions/A/AppleSystemInfo\r\n    0x7fff546d8000 -     0x7fff54728ff7  com.apple.AppleVAFramework (5.1.4 - 5.1.4) <63EBC1A7-25B5-3FF2-AA73-BB378B5FE8D4> /System/Library/PrivateFrameworks/AppleVA.framework/Versions/A/AppleVA\r\n    0x7fff54773000 -     0x7fff54787ffb  com.apple.AssertionServices (1.0 - 1) <11FC4241-6069-3B3A-9BCE-9B68F3A4D2AB> /System/Library/PrivateFrameworks/AssertionServices.framework/Versions/A/AssertionServices\r\n    0x7fff54788000 -     0x7fff547a5fff  com.apple.AssetCacheServices (83.4 - 83.4) <B123F3B2-F048-3862-9EE6-43AFCA07A54B> /System/Library/PrivateFrameworks/AssetCacheServices.framework/Versions/A/AssetCacheServices\r\n    0x7fff54b56000 -     0x7fff54c42ff7  com.apple.AuthKit (1.0 - 1) <34496FD5-4BAB-3DF3-BF7F-70F38C66848D> /System/Library/PrivateFrameworks/AuthKit.framework/Versions/A/AuthKit\r\n    0x7fff54c43000 -     0x7fff54cabffb  com.apple.AuthKitUI (1.0 - 1) <61894772-2B24-39C1-98CC-FC6487BE7D4B> /System/Library/PrivateFrameworks/AuthKitUI.framework/Versions/A/AuthKitUI\r\n    0x7fff54e04000 -     0x7fff54e0cfff  com.apple.coreservices.BackgroundTaskManagement (1.0 - 57.1) <2A396FC0-7B79-3088-9A82-FB93C1181A57> /System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Versions/A/BackgroundTaskManagement\r\n    0x7fff54e0d000 -     0x7fff54ea2fff  com.apple.backup.framework (1.10.5 - ???) <BAFC1D7F-9D75-3C45-AAD4-569D13E445C5> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup\r\n    0x7fff54ea3000 -     0x7fff54f10ff3  com.apple.BaseBoard (360.28 - 360.28) <DBE27FB4-3FFD-3E9A-846C-F6E7D797286A> /System/Library/PrivateFrameworks/BaseBoard.framework/Versions/A/BaseBoard\r\n    0x7fff54f19000 -     0x7fff54f1fff3  com.apple.BezelServicesFW (317.1 - 317.1) <FEF16A10-E460-31F9-803A-55F7030B17F7> /System/Library/PrivateFrameworks/BezelServices.framework/Versions/A/BezelServices\r\n    0x7fff54f96000 -     0x7fff54fd2ff3  com.apple.bom (14.0 - 197.6) <A99A6F9A-AFDE-3BC6-95CE-AA90B268B805> /System/Library/PrivateFrameworks/Bom.framework/Versions/A/Bom\r\n    0x7fff5529f000 -     0x7fff552bcffb  com.apple.CacheDelete (1.0 - 1) <DE59FD6D-15AF-36E4-888E-93522DCFE38A> /System/Library/PrivateFrameworks/CacheDelete.framework/Versions/A/CacheDelete\r\n    0x7fff55681000 -     0x7fff556adffb  com.apple.CalendarAgentLink (8.0 - 250) <4702E078-86DF-373F-BF2F-AB6230E19010> /System/Library/PrivateFrameworks/CalendarAgentLink.framework/Versions/A/CalendarAgentLink\r\n    0x7fff55d6e000 -     0x7fff55dbdff7  com.apple.ChunkingLibrary (201 - 201) <DFE16C42-24E6-386F-AC50-0058F61980A2> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary\r\n    0x7fff55ed7000 -     0x7fff55f5cff7  com.apple.CloudDocs (1.0 - 575.302) <524BC6E6-9AF7-3DBE-8FC5-BD35B7A94B55> /System/Library/PrivateFrameworks/CloudDocs.framework/Versions/A/CloudDocs\r\n    0x7fff56b6d000 -     0x7fff56b79ff7  com.apple.CommerceCore (1.0 - 708.4.2) <7CACE483-6E55-30BB-BF3B-E6515849971F> /System/Library/PrivateFrameworks/CommerceKit.framework/Versions/A/Frameworks/CommerceCore.framework/Versions/A/CommerceCore\r\n    0x7fff56b7a000 -     0x7fff56b83ffb  com.apple.CommonAuth (4.0 - 2.0) <81C987FD-69EB-344B-94D9-B9D93624D257> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth\r\n    0x7fff56b97000 -     0x7fff56bacffb  com.apple.commonutilities (8.0 - 900) <080E168B-21B7-3CCA-AB84-BB9911D18DAC> /System/Library/PrivateFrameworks/CommonUtilities.framework/Versions/A/CommonUtilities\r\n    0x7fff56cd6000 -     0x7fff56d48fff  com.apple.framework.ConfigurationProfiles (11.2 - 1181) <2EC7DE8C-AEE9-38DF-A668-1A676AAB738E> /System/Library/PrivateFrameworks/ConfigurationProfiles.framework/Versions/A/ConfigurationProfiles\r\n    0x7fff56e54000 -     0x7fff56eb6ff3  com.apple.AddressBook.ContactsFoundation (8.0 - ???) <71D864D2-D3A6-37AD-9920-F2A2FC52CF70> /System/Library/PrivateFrameworks/ContactsFoundation.framework/Versions/A/ContactsFoundation\r\n    0x7fff56eb7000 -     0x7fff56edaff3  com.apple.contacts.ContactsPersistence (1.0 - ???) <4082E8CF-5C89-3DE1-97BF-6434F3E03C16> /System/Library/PrivateFrameworks/ContactsPersistence.framework/Versions/A/ContactsPersistence\r\n    0x7fff5701c000 -     0x7fff573fffef  com.apple.CoreAUC (274.0.0 - 274.0.0) <C71F1581-E73B-3DA0-958B-E912C3FB3F23> /System/Library/PrivateFrameworks/CoreAUC.framework/Versions/A/CoreAUC\r\n    0x7fff57400000 -     0x7fff5742eff7  com.apple.CoreAVCHD (6.0.0 - 6000.4.1) <A04A99B8-DAC5-36FC-BAC7-7431600C1F89> /System/Library/PrivateFrameworks/CoreAVCHD.framework/Versions/A/CoreAVCHD\r\n    0x7fff5744e000 -     0x7fff5746cfff  com.apple.CoreAnalytics.CoreAnalytics (1.0 - 1) <5AFC8A18-30CA-3D29-A509-DF21AC4DB921> /System/Library/PrivateFrameworks/CoreAnalytics.framework/Versions/A/CoreAnalytics\r\n    0x7fff574c4000 -     0x7fff57521ff7  com.apple.corebrightness (1.0 - 1) <998DECDF-0DFF-38FA-B5A5-6174B6615E00> /System/Library/PrivateFrameworks/CoreBrightness.framework/Versions/A/CoreBrightness\r\n    0x7fff57658000 -     0x7fff57661fff  com.apple.frameworks.CoreDaemon (1.3 - 1.3) <89BDACE6-32AA-3933-BD8C-A44650488873> /System/Library/PrivateFrameworks/CoreDaemon.framework/Versions/B/CoreDaemon\r\n    0x7fff5785b000 -     0x7fff5786cff7  com.apple.CoreEmoji (1.0 - 69.19.9) <228457B3-E191-356E-9A5B-3C0438D05FBA> /System/Library/PrivateFrameworks/CoreEmoji.framework/Versions/A/CoreEmoji\r\n    0x7fff57a14000 -     0x7fff57b03fff  com.apple.CoreHandwriting (161 - 1.2) <7CBB18C3-FE95-3352-9D67-B441E89AD10F> /System/Library/PrivateFrameworks/CoreHandwriting.framework/Versions/A/CoreHandwriting\r\n    0x7fff57cd5000 -     0x7fff57cebffb  com.apple.CoreMediaAuthoring (2.2 - 959) <822B4E1A-6177-3E0A-867E-0B477A54EC17> /System/Library/PrivateFrameworks/CoreMediaAuthoring.framework/Versions/A/CoreMediaAuthoring\r\n    0x7fff57e15000 -     0x7fff57e7bff7  com.apple.CoreNLP (1.0 - 130.15.22) <27877820-17D0-3B02-8557-4014E876CCC7> /System/Library/PrivateFrameworks/CoreNLP.framework/Versions/A/CoreNLP\r\n    0x7fff57fe2000 -     0x7fff57fe6ff7  com.apple.CoreOptimization (1.0 - 1) <1C724E01-E9FA-3AEE-BE4B-C4DB8EC0C812> /System/Library/PrivateFrameworks/CoreOptimization.framework/Versions/A/CoreOptimization\r\n    0x7fff57fe7000 -     0x7fff58073fff  com.apple.CorePDF (4.0 - 414) <E4ECDD15-34C0-30C2-AFA9-27C8EDAC3DB0> /System/Library/PrivateFrameworks/CorePDF.framework/Versions/A/CorePDF\r\n    0x7fff58128000 -     0x7fff58130ff7  com.apple.CorePhoneNumbers (1.0 - 1) <7A826DA2-4725-39D8-AF27-6F034DC53C4E> /System/Library/PrivateFrameworks/CorePhoneNumbers.framework/Versions/A/CorePhoneNumbers\r\n    0x7fff58131000 -     0x7fff58187ff7  com.apple.CorePrediction (1.0 - 1) <A66C8A6F-C3B2-3547-985D-C62C62F9FA48> /System/Library/PrivateFrameworks/CorePrediction.framework/Versions/A/CorePrediction\r\n    0x7fff582ac000 -     0x7fff582ddff3  com.apple.CoreServicesInternal (358 - 358) <DD6EF60D-048F-3186-83DA-EB191EDF48AE> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal\r\n    0x7fff586a4000 -     0x7fff58728fff  com.apple.CoreSymbolication (10.2 - 64490.25.1) <28B2FF2D-3FDE-3A20-B343-341E5BD4E22F> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication\r\n    0x7fff58729000 -     0x7fff587affff  com.apple.CoreThemeDefinition (2.0 - 349) <DAABF595-C261-3AEE-BCED-AF829A06B170> /System/Library/PrivateFrameworks/CoreThemeDefinition.framework/Versions/A/CoreThemeDefinition\r\n    0x7fff587b8000 -     0x7fff588e3ff7  com.apple.coreui (2.1 - 499.10) <105F61F3-D0AE-332B-A485-8615187BB409> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI\r\n    0x7fff588e4000 -     0x7fff58a82fff  com.apple.CoreUtils (5.8 - 580.19) <CF9C5677-4946-3328-8CE3-C70F2E8599D8> /System/Library/PrivateFrameworks/CoreUtils.framework/Versions/A/CoreUtils\r\n    0x7fff58ad6000 -     0x7fff58b39ff7  com.apple.framework.CoreWiFi (13.0 - 1375.2) <77E078A7-A34F-333B-B50F-8829537D6E9D> /System/Library/PrivateFrameworks/CoreWiFi.framework/Versions/A/CoreWiFi\r\n    0x7fff58b3a000 -     0x7fff58b4bff7  com.apple.CrashReporterSupport (10.13 - 938.25) <C7665EC7-9389-3717-B152-A59D7872C63C> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport\r\n    0x7fff58bdb000 -     0x7fff58beafff  com.apple.framework.DFRFoundation (1.0 - 211.1) <E3F02F2A-2059-39CC-85DA-969676EB88EB> /System/Library/PrivateFrameworks/DFRFoundation.framework/Versions/A/DFRFoundation\r\n    0x7fff58beb000 -     0x7fff58beffff  com.apple.DSExternalDisplay (3.1 - 380) <645C719D-05D4-3CD7-84D7-4C5218859E0C> /System/Library/PrivateFrameworks/DSExternalDisplay.framework/Versions/A/DSExternalDisplay\r\n    0x7fff58c31000 -     0x7fff58c6fff7  com.apple.datadetectors (5.0 - 390.2) <B6DEDE81-832C-3078-ACAF-767F01E9615D> /System/Library/PrivateFrameworks/DataDetectors.framework/Versions/A/DataDetectors\r\n    0x7fff58c70000 -     0x7fff58ce5ff3  com.apple.datadetectorscore (7.0 - 590.24) <72F0CBF1-D3E9-36C5-B877-F42E1EC59A0E> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore\r\n    0x7fff58d31000 -     0x7fff58d6eff7  com.apple.DebugSymbols (190 - 190) <6F4FAACA-E06B-38AD-A0C2-14EA5408A231> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols\r\n    0x7fff58d6f000 -     0x7fff58eaaff7  com.apple.desktopservices (1.13.5 - ???) <4AF2E011-2CB0-3588-83CB-882ADDA78CAD> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv\r\n    0x7fff58ecf000 -     0x7fff58ee4ff3  com.apple.DeviceLinkX (5.0 - 264) <24CE90FE-764F-3E5C-9744-0680BDF5F52C> /System/Library/PrivateFrameworks/DeviceLink.framework/Versions/A/DeviceLink\r\n    0x7fff58f54000 -     0x7fff58f55ff7  com.apple.diagnosticlogcollection (10.0 - 1000) <225C684D-CFDD-378A-A30A-400AACF89D58> /System/Library/PrivateFrameworks/DiagnosticLogCollection.framework/Versions/A/DiagnosticLogCollection\r\n    0x7fff58fe7000 -     0x7fff590b5fff  com.apple.DiskImagesFramework (480.260.1 - 480.260.1) <A908F053-27B9-30B2-A5B8-2A185E62DEF6> /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages\r\n    0x7fff590b6000 -     0x7fff5917cfff  com.apple.DiskManagement (12.1 - 1555) <15C076CB-FE60-30F1-93DC-A9F6A0048899> /System/Library/PrivateFrameworks/DiskManagement.framework/Versions/A/DiskManagement\r\n    0x7fff5917d000 -     0x7fff59181ffb  com.apple.DisplayServicesFW (3.1 - 380) <92947649-CB60-394E-8445-C92564F96466> /System/Library/PrivateFrameworks/DisplayServices.framework/Versions/A/DisplayServices\r\n    0x7fff591f2000 -     0x7fff59227ff3  com.apple.SystemConfiguration.EAP8021X (14.0.0 - 14.0) <053C5AA0-CDB1-3DAA-982C-BDAEB6021858> /System/Library/PrivateFrameworks/EAP8021X.framework/Versions/A/EAP8021X\r\n    0x7fff59228000 -     0x7fff5922bff3  com.apple.EFILogin (2.0 - 2) <8023157A-05A3-3FB0-967A-BC30710E8350> /System/Library/PrivateFrameworks/EFILogin.framework/Versions/A/EFILogin\r\n    0x7fff5994b000 -     0x7fff59960fff  com.apple.Engram (1.0 - 1) <953027A3-9E31-3C34-B927-3071E82106C9> /System/Library/PrivateFrameworks/Engram.framework/Versions/A/Engram\r\n    0x7fff59961000 -     0x7fff59c43ff7  com.apple.vision.EspressoFramework (1.0 - 120) <0E116245-4F64-3A42-AEE2-484F445D3916> /System/Library/PrivateFrameworks/Espresso.framework/Versions/A/Espresso\r\n    0x7fff59de7000 -     0x7fff5a202fff  com.apple.vision.FaceCore (3.3.4 - 3.3.4) <A576E2DA-BF6F-3B18-8FEB-324E5C5FA9BD> /System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore\r\n    0x7fff5a20c000 -     0x7fff5a22cff7  com.apple.framework.familycontrols (4.1 - 410) <7E50D03F-363B-3342-841D-B3583662B0B1> /System/Library/PrivateFrameworks/FamilyControls.framework/Versions/A/FamilyControls\r\n    0x7fff5a233000 -     0x7fff5a2b8ff7  com.apple.FileProvider (125.130 - 125.130) <D95A997E-33E6-3427-9A4B-B16756ACBA0B> /System/Library/PrivateFrameworks/FileProvider.framework/Versions/A/FileProvider\r\n    0x7fff5dab6000 -     0x7fff5dab7fff  libmetal_timestamp.dylib (902.3.2) <05389463-AF2E-33E2-A14F-1416E4A30835> /System/Library/PrivateFrameworks/GPUCompiler.framework/Versions/3902/Libraries/libmetal_timestamp.dylib\r\n    0x7fff5f157000 -     0x7fff5f15cfff  com.apple.GPUWrangler (3.40.16 - 3.40.16) <B9D4F2DD-5D11-32FF-B5BE-29E137458728> /System/Library/PrivateFrameworks/GPUWrangler.framework/Versions/A/GPUWrangler\r\n    0x7fff5f4e9000 -     0x7fff5f50dff3  com.apple.GenerationalStorage (2.0 - 285.101) <84C2E52C-F2C6-3FF8-87E5-3C88A40D3881> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage\r\n    0x7fff5f526000 -     0x7fff5ff25ff7  com.apple.GeoServices (1.0 - 1364.25.12.18.16) <48613B98-3C86-3684-8E5E-D899927A1CA8> /System/Library/PrivateFrameworks/GeoServices.framework/Versions/A/GeoServices\r\n    0x7fff5ff67000 -     0x7fff5ff76fff  com.apple.GraphVisualizer (1.0 - 5) <48D020B7-5938-3FAE-B468-E291AEE2C06F> /System/Library/PrivateFrameworks/GraphVisualizer.framework/Versions/A/GraphVisualizer\r\n    0x7fff5ff77000 -     0x7fff5ff84ff7  com.apple.GraphicsServices (1.0 - 1.0) <56646B62-B331-31DC-80EB-7996DCAB6944> /System/Library/PrivateFrameworks/GraphicsServices.framework/Versions/A/GraphicsServices\r\n    0x7fff600c6000 -     0x7fff6013affb  com.apple.Heimdal (4.0 - 2.0) <5E8F6B79-960D-3030-B889-D29A4015D205> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal\r\n    0x7fff60b41000 -     0x7fff60b77fff  com.apple.IASUtilities (1.0 - 507) <5F8AF58C-4E20-3CC5-AC6E-0D72905C2F2E> /System/Library/PrivateFrameworks/IASUtilities.framework/Versions/A/IASUtilities\r\n    0x7fff60b78000 -     0x7fff60c71ff7  com.apple.ids (10.0 - 1000) <BC8B45E2-E3DD-356E-BB34-283F447BEE3E> /System/Library/PrivateFrameworks/IDS.framework/Versions/A/IDS\r\n    0x7fff60c72000 -     0x7fff60d72ffb  com.apple.idsfoundation (10.0 - 1000) <72406083-7F30-3303-BF6B-D5EAA220F67C> /System/Library/PrivateFrameworks/IDSFoundation.framework/Versions/A/IDSFoundation\r\n    0x7fff612ee000 -     0x7fff6134ffff  com.apple.imfoundation (10.0 - 1000) <ACD066B8-A3E4-309B-AE6F-105CAF5F5BFD> /System/Library/PrivateFrameworks/IMFoundation.framework/Versions/A/IMFoundation\r\n    0x7fff61429000 -     0x7fff61430ffb  com.apple.IOAccelerator (404.9 - 404.9) <F9C604B3-3DF7-3EE7-8A44-7877FAF2E6A4> /System/Library/PrivateFrameworks/IOAccelerator.framework/Versions/A/IOAccelerator\r\n    0x7fff61433000 -     0x7fff61433fff  com.apple.IOPlatformPluginFamily (1.0 - 1) <04E02642-812E-3F93-BED7-D9304E39596D> /System/Library/PrivateFrameworks/IOPlatformPluginFamily.framework/Versions/A/IOPlatformPluginFamily\r\n    0x7fff61434000 -     0x7fff6144cfff  com.apple.IOPresentment (1.0 - 42.6) <55CB91EF-90F1-3D0A-A59E-2F75CD2EB4AE> /System/Library/PrivateFrameworks/IOPresentment.framework/Versions/A/IOPresentment\r\n    0x7fff617f4000 -     0x7fff61821ff7  com.apple.IconServices (379 - 379) <7BAD562D-4FA3-3E11-863C-1EEBE2406D2C> /System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices\r\n    0x7fff6194b000 -     0x7fff6194fffb  com.apple.InternationalSupport (1.0 - 10.15.6) <6226A905-D055-321D-B665-5B0CC4798A74> /System/Library/PrivateFrameworks/InternationalSupport.framework/Versions/A/InternationalSupport\r\n    0x7fff619b9000 -     0x7fff619c6ffb  com.apple.IntlPreferences (2.0 - 227.18) <41C499DF-E698-3E33-822D-28CA472B619E> /System/Library/PrivateFrameworks/IntlPreferences.framework/Versions/A/IntlPreferences\r\n    0x7fff61a41000 -     0x7fff61a5dff7  com.apple.Jet (1.0 - 1) <00828887-0DF4-3C70-9000-54FB9BDBB239> /System/Library/PrivateFrameworks/Jet.framework/Versions/A/Jet\r\n    0x7fff61ab5000 -     0x7fff61ac7ff3  com.apple.security.KeychainCircle.KeychainCircle (1.0 - 1) <5AAC527E-D197-39B2-A6C9-E0D0FB9CA9B9> /System/Library/PrivateFrameworks/KeychainCircle.framework/Versions/A/KeychainCircle\r\n    0x7fff61ae2000 -     0x7fff61bbdff7  com.apple.LanguageModeling (1.0 - 159.15.15) <3DE3CE61-542B-37B7-883E-4B9717CAC65F> /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling\r\n    0x7fff61bbe000 -     0x7fff61bfaff7  com.apple.Lexicon-framework (1.0 - 33.15.10) <4B5E843E-2809-3E70-9560-9254E2656419> /System/Library/PrivateFrameworks/Lexicon.framework/Versions/A/Lexicon\r\n    0x7fff61c01000 -     0x7fff61c06fff  com.apple.LinguisticData (1.0 - 238.25) <61910887-D5CE-3567-9A5F-6DFEC942EC1F> /System/Library/PrivateFrameworks/LinguisticData.framework/Versions/A/LinguisticData\r\n    0x7fff61ca4000 -     0x7fff61cf9fff  com.apple.LoggingSupport (1.0 - 906.260.1) <717E018D-5AAC-3D6F-9036-5FED3BD66DC0> /System/Library/PrivateFrameworks/LoggingSupport.framework/Versions/A/LoggingSupport\r\n    0x7fff61cfa000 -     0x7fff61cffffb  com.apple.LoginUICore (4.0 - 4.0) <426BBB42-8972-3AD1-BA5B-845258C64D64> /System/Library/PrivateFrameworks/LoginUIKit.framework/Versions/A/Frameworks/LoginUICore.framework/Versions/A/LoginUICore\r\n    0x7fff61d58000 -     0x7fff61d71ff3  com.apple.LookupFramework (1.2 - 251) <50031B5A-F3D5-39CC-954A-B3AEAF52FB89> /System/Library/PrivateFrameworks/Lookup.framework/Versions/A/Lookup\r\n    0x7fff62424000 -     0x7fff62427fff  com.apple.Mangrove (1.0 - 25) <537A5B2E-4C30-3CFD-8BDC-79F9A04AC327> /System/Library/PrivateFrameworks/Mangrove.framework/Versions/A/Mangrove\r\n    0x7fff624ab000 -     0x7fff624adff3  com.apple.marco (10.0 - 1000) <BD9409A8-C0FF-3327-86A5-64D92C4EA6F1> /System/Library/PrivateFrameworks/Marco.framework/Versions/A/Marco\r\n    0x7fff624ae000 -     0x7fff624d4ff3  com.apple.MarkupUI (1.0 - 232.3.30) <C6A452D8-CA97-3044-A025-8ED4B7264FE2> /System/Library/PrivateFrameworks/MarkupUI.framework/Versions/A/MarkupUI\r\n    0x7fff6253c000 -     0x7fff6256fff7  com.apple.MediaKit (16 - 906) <A5938E64-A0D0-395F-B8D7-D9B179415E2E> /System/Library/PrivateFrameworks/MediaKit.framework/Versions/A/MediaKit\r\n    0x7fff62570000 -     0x7fff62893fff  com.apple.MediaRemote (1.0 - 1) <5E407449-1018-3501-B5C0-75AB68E52ECD> /System/Library/PrivateFrameworks/MediaRemote.framework/Versions/A/MediaRemote\r\n    0x7fff62894000 -     0x7fff628b7fff  com.apple.MediaServices (1.0 - 1) <1B4ED547-2E98-38D8-91A4-1582C0774702> /System/Library/PrivateFrameworks/MediaServices.framework/Versions/A/MediaServices\r\n    0x7fff628fb000 -     0x7fff62923ff7  com.apple.spotlight.metadata.utilities (1.0 - 1191.57) <38BB1FB7-3336-384C-B71F-4D0D402EB606> /System/Library/PrivateFrameworks/MetadataUtilities.framework/Versions/A/MetadataUtilities\r\n    0x7fff62924000 -     0x7fff629b1ff7  com.apple.gpusw.MetalTools (1.0 - 1) <DBC4718E-F588-382D-A415-405D0028804D> /System/Library/PrivateFrameworks/MetalTools.framework/Versions/A/MetalTools\r\n    0x7fff629c7000 -     0x7fff629e0ffb  com.apple.MobileAssets (1.0 - 437.250.3) <8BE5B3A0-8F3A-3FAE-9AFF-32836300183C> /System/Library/PrivateFrameworks/MobileAsset.framework/Versions/A/MobileAsset\r\n    0x7fff629f2000 -     0x7fff62b5dff7  com.apple.mobiledevice (988.250.11.100.2 - 988.250.11.100.2) <E3A6F6AC-EF91-3A77-8AD8-82D51C7F0388> /System/Library/PrivateFrameworks/MobileDevice.framework/Versions/A/MobileDevice\r\n    0x7fff62b5e000 -     0x7fff62b79ffb  com.apple.MobileKeyBag (2.0 - 1.0) <4678FECE-538B-381C-80F2-27AA4805F160> /System/Library/PrivateFrameworks/MobileKeyBag.framework/Versions/A/MobileKeyBag\r\n    0x7fff62b8c000 -     0x7fff62c01fff  com.apple.Montreal (1.0 - 42.15.9) <17BFD046-4362-3A76-A496-648D00FF3743> /System/Library/PrivateFrameworks/Montreal.framework/Versions/A/Montreal\r\n    0x7fff62c02000 -     0x7fff62c2cffb  com.apple.MultitouchSupport.framework (2450.1 - 2450.1) <3BF81F33-89A8-3A2D-84B3-B343020B6D98> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport\r\n    0x7fff62cfc000 -     0x7fff62decff7  com.apple.Navigation (1.0 - 1) <83EBED08-8353-3FA9-983B-5A0D372C2C69> /System/Library/PrivateFrameworks/Navigation.framework/Versions/A/Navigation\r\n    0x7fff62e68000 -     0x7fff62e72fff  com.apple.NetAuth (6.2 - 6.2) <0D01BBE5-0269-310D-B148-D19DAE143DEB> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth\r\n    0x7fff62f48000 -     0x7fff62f62ff7  com.apple.network.statistics.framework (1.2 - 1) <B056D329-5C7C-3FB4-991E-7092DB2F9A5B> /System/Library/PrivateFrameworks/NetworkStatistics.framework/Versions/A/NetworkStatistics\r\n    0x7fff636d3000 -     0x7fff63724ff3  com.apple.OTSVG (1.0 - ???) <3976F8CC-1CFB-3E09-9009-FE985550565B> /System/Library/PrivateFrameworks/OTSVG.framework/Versions/A/OTSVG\r\n    0x7fff64122000 -     0x7fff6424bfcb  com.apple.PackageKit (3.0 - 831) <644E6F77-BE47-3CB2-B9CE-BB434FA48CA9> /System/Library/PrivateFrameworks/PackageKit.framework/Versions/A/PackageKit\r\n    0x7fff647b5000 -     0x7fff648a8fff  com.apple.PencilKit (1.0 - 1) <79225726-6980-3680-AC0B-D8C5C5DB2224> /System/Library/PrivateFrameworks/PencilKit.framework/Versions/A/PencilKit\r\n    0x7fff648a9000 -     0x7fff648b8ff7  com.apple.PerformanceAnalysis (1.218.2 - 218.2) <65F3DB3E-6D4E-33A0-B510-EF768D323DAB> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis\r\n    0x7fff648b9000 -     0x7fff648e2ff3  com.apple.persistentconnection (1.0 - 1.0) <9ECE64D9-8C5F-3FCE-8A46-29D7B3966920> /System/Library/PrivateFrameworks/PersistentConnection.framework/Versions/A/PersistentConnection\r\n    0x7fff64adf000 -     0x7fff64adffff  com.apple.PhoneNumbers (1.0 - 1) <85818A1B-19D2-3EAE-8CE6-F7E888E07DEC> /System/Library/PrivateFrameworks/PhoneNumbers.framework/Versions/A/PhoneNumbers\r\n    0x7fff66212000 -     0x7fff66269ff7  com.apple.PhysicsKit (1.0 - 1) <7CFDA5AC-9C40-3F87-9633-8FB4AD6AD815> /System/Library/PrivateFrameworks/PhysicsKit.framework/Versions/A/PhysicsKit\r\n    0x7fff66299000 -     0x7fff662bcffb  com.apple.pluginkit.framework (1.0 - 1) <910C3AFE-7C46-3C34-B000-4ED92336B9FD> /System/Library/PrivateFrameworks/PlugInKit.framework/Versions/A/PlugInKit\r\n    0x7fff662e7000 -     0x7fff662f8ffb  com.apple.PowerLog (1.0 - 1) <4883AC77-F1EB-386F-B3E7-AEA56AD28CDB> /System/Library/PrivateFrameworks/PowerLog.framework/Versions/A/PowerLog\r\n    0x7fff662f9000 -     0x7fff662f9ff7  com.apple.PowerlogControl (1.0 - 1) <2A9678CA-7892-3533-839D-4CCACBFA4171> /System/Library/PrivateFrameworks/PowerlogControl.framework/Versions/A/PowerlogControl\r\n    0x7fff666f3000 -     0x7fff66747ffb  com.apple.ProtectedCloudStorage (1.0 - 1) <4664F8D2-3DE3-3AF8-8F1B-47A22D27A63A> /System/Library/PrivateFrameworks/ProtectedCloudStorage.framework/Versions/A/ProtectedCloudStorage\r\n    0x7fff66748000 -     0x7fff66766ff7  com.apple.ProtocolBuffer (1 - 263.2) <907D6C95-D050-31DE-99CA-16A5135BC6F9> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer\r\n    0x7fff668e4000 -     0x7fff668e7ff3  com.apple.QuickLookNonBaseSystem (1.0 - 1) <EDDFEBCC-E628-3DE8-8619-0265AAD2303A> /System/Library/PrivateFrameworks/QuickLookNonBaseSystem.framework/Versions/A/QuickLookNonBaseSystem\r\n    0x7fff668e8000 -     0x7fff668fdff3  com.apple.QuickLookThumbnailing (1.0 - 1) <B5E746AE-1DCB-3299-8626-10CCCBC2D5EE> /System/Library/PrivateFrameworks/QuickLookThumbnailing.framework/Versions/A/QuickLookThumbnailing\r\n    0x7fff668fe000 -     0x7fff6694efff  com.apple.ROCKit (27.6 - 27.6) <756C2253-E8B1-3C48-9945-DE8D6AD24DE2> /System/Library/PrivateFrameworks/ROCKit.framework/Versions/A/ROCKit\r\n    0x7fff66a83000 -     0x7fff66a8efff  com.apple.xpc.RemoteServiceDiscovery (1.0 - 1336.261.2) <4DCA0403-5482-3602-AD23-6B8E4C72C231> /System/Library/PrivateFrameworks/RemoteServiceDiscovery.framework/Versions/A/RemoteServiceDiscovery\r\n    0x7fff66aa1000 -     0x7fff66ac3fff  com.apple.RemoteViewServices (2.0 - 128) <8FB0E4EB-DCBB-32E6-94C6-AA9BA9EE4CAC> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices\r\n    0x7fff66ac4000 -     0x7fff66ad7ff3  com.apple.xpc.RemoteXPC (1.0 - 1336.261.2) <88075C7F-64C4-3AB0-800F-9730C1B7A26E> /System/Library/PrivateFrameworks/RemoteXPC.framework/Versions/A/RemoteXPC\r\n    0x7fff67801000 -     0x7fff6784afff  com.apple.Safari.SafeBrowsing (14607 - 14607.2.6.1.1) <9083E333-A8A3-32AF-AB92-39DC0EC4FC4B> /System/Library/PrivateFrameworks/SafariSafeBrowsing.framework/Versions/A/SafariSafeBrowsing\r\n    0x7fff68169000 -     0x7fff6816cff7  com.apple.SecCodeWrapper (4.0 - 360.250.1) <691D2675-DDDE-38BE-9A02-3901F26C53E3> /System/Library/PrivateFrameworks/SecCodeWrapper.framework/Versions/A/SecCodeWrapper\r\n    0x7fff68237000 -     0x7fff6823cfff  com.apple.ServerInformation (2.0 - 1) <41AAB1A3-D684-338C-AD45-18205CBE9DF1> /System/Library/PrivateFrameworks/ServerInformation.framework/Versions/A/ServerInformation\r\n    0x7fff682c8000 -     0x7fff683e6fff  com.apple.Sharing (1288.43 - 1288.43) <B9AB8C05-F2F2-371F-A9AF-1D139E2CE54C> /System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing\r\n    0x7fff691f7000 -     0x7fff694a5ffb  com.apple.SkyLight (1.600.0 - 340.26) <CD2A7069-6CEA-3737-9E9D-7AE2FED912AB> /System/Library/PrivateFrameworks/SkyLight.framework/Versions/A/SkyLight\r\n    0x7fff69c47000 -     0x7fff69c53fff  com.apple.SpeechRecognitionCore (5.0.21 - 5.0.21) <7A6A67DB-C813-328E-AAFB-D267A5B50B3D> /System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore\r\n    0x7fff69d05000 -     0x7fff69f68ff3  com.apple.spotlight.index (10.7.0 - 1191.57) <04DE70D5-D9C4-3886-A3DB-6E32040D69E3> /System/Library/PrivateFrameworks/SpotlightIndex.framework/Versions/A/SpotlightIndex\r\n    0x7fff6a049000 -     0x7fff6a058ff3  com.apple.StorageManagement (1.0 - 1) <9E7DA9EA-DFF3-3C76-B9CD-86AD8E86E40E> /System/Library/PrivateFrameworks/StorageManagement.framework/Versions/A/StorageManagement\r\n    0x7fff6a2f2000 -     0x7fff6a32eff3  com.apple.StreamingZip (1.0 - 1) <AF132752-3532-3BFD-8C32-8BA9D1B3449A> /System/Library/PrivateFrameworks/StreamingZip.framework/Versions/A/StreamingZip\r\n    0x7fff6a3a4000 -     0x7fff6a42ffc7  com.apple.Symbolication (10.2 - 64490.38.1) <9FDCC98D-5B32-35AD-A9BF-94DF2B78507F> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication\r\n    0x7fff6a430000 -     0x7fff6a438ffb  com.apple.SymptomDiagnosticReporter (1.0 - 820.267.1) <DB68EC08-EC2D-35DC-8D34-B4A2C36A9DE9> /System/Library/PrivateFrameworks/SymptomDiagnosticReporter.framework/Versions/A/SymptomDiagnosticReporter\r\n    0x7fff6a677000 -     0x7fff6a6a1ffb  com.apple.framework.SystemAdministration (1.0 - 1.0) <E483B568-084F-3FE6-9284-BAC66FCF4A94> /System/Library/PrivateFrameworks/SystemAdministration.framework/Versions/A/SystemAdministration\r\n    0x7fff6a906000 -     0x7fff6a912ff7  com.apple.private.SystemPolicy (1.0 - 1) <D0883FE8-B047-3EDC-9DB7-32B80D5BABC5> /System/Library/PrivateFrameworks/SystemPolicy.framework/Versions/A/SystemPolicy\r\n    0x7fff6a917000 -     0x7fff6a923ffb  com.apple.TCC (1.0 - 1) <968ECAE1-FBB9-3478-BDCE-85E54B6C422D> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC\r\n    0x7fff6ab89000 -     0x7fff6ac51ff3  com.apple.TextureIO (3.8.4 - 3.8.1) <7CEAC05A-D283-3D5A-B1E3-C849285FA0BF> /System/Library/PrivateFrameworks/TextureIO.framework/Versions/A/TextureIO\r\n    0x7fff6acae000 -     0x7fff6acc9fff  com.apple.ToneKit (1.0 - 1) <84911F2C-394F-3FFF-8220-B51F581BB8E6> /System/Library/PrivateFrameworks/ToneKit.framework/Versions/A/ToneKit\r\n    0x7fff6acca000 -     0x7fff6acefff7  com.apple.ToneLibrary (1.0 - 1) <4D7D03EB-744F-3402-8C3E-B483A74BEF1E> /System/Library/PrivateFrameworks/ToneLibrary.framework/Versions/A/ToneLibrary\r\n    0x7fff6ad07000 -     0x7fff6ad08fff  com.apple.TrustEvaluationAgent (2.0 - 31.200.1) <15DF9C73-54E4-3C41-BCF4-378338C55FB4> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent\r\n    0x7fff6ad0e000 -     0x7fff6aec4ff7  com.apple.UIFoundation (1.0 - 551) <E9D17DAD-230D-390A-B117-3D100C5AF5F2> /System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation\r\n    0x7fff6af12000 -     0x7fff6af18ffb  com.apple.URLFormatting (59 - 59.42) <E3CF4159-0195-3E61-8806-CEC75A313C77> /System/Library/PrivateFrameworks/URLFormatting.framework/Versions/A/URLFormatting\r\n    0x7fff6af19000 -     0x7fff6af1dfff  com.apple.Uninstall (1.0.1 - 211) <8788927D-F426-3ACA-946E-FB2EB8C1F8E1> /System/Library/PrivateFrameworks/Uninstall.framework/Versions/A/Uninstall\r\n    0x7fff6af75000 -     0x7fff6af77fff  libUAPreferences.dylib (361.53) <4891C9D8-DFA5-396F-82CE-E6F0F3B563D0> /System/Library/PrivateFrameworks/UniversalAccess.framework/Versions/A/Libraries/libUAPreferences.dylib\r\n    0x7fff6b0c8000 -     0x7fff6b76fff7  com.apple.VectorKit (1.0 - 1360.25.12.18.4) <FD6BA025-6289-3D90-AAFD-FC5AF733A1D9> /System/Library/PrivateFrameworks/VectorKit.framework/Versions/A/VectorKit\r\n    0x7fff6bb40000 -     0x7fff6bc19fff  com.apple.ViewBridge (401.1 - 401.1) <18144EC1-5DEF-369C-8EBA-2826E7142784> /System/Library/PrivateFrameworks/ViewBridge.framework/Versions/A/ViewBridge\r\n    0x7fff6c05c000 -     0x7fff6c2cdfff  libAWDSupportFramework.dylib (2128) <F0DEF979-B44A-3F1D-B433-59D74B905955> /System/Library/PrivateFrameworks/WirelessDiagnostics.framework/Versions/A/Libraries/libAWDSupportFramework.dylib\r\n    0x7fff6c2ce000 -     0x7fff6c2dffff  libprotobuf-lite.dylib (2128) <01384CD9-734E-3614-B55E-8FDCF8AF7A5B> /System/Library/PrivateFrameworks/WirelessDiagnostics.framework/Versions/A/Libraries/libprotobuf-lite.dylib\r\n    0x7fff6c2e0000 -     0x7fff6c33afff  libprotobuf.dylib (2128) <7E183D4E-E6F6-3FAC-8AEA-9842B050F331> /System/Library/PrivateFrameworks/WirelessDiagnostics.framework/Versions/A/Libraries/libprotobuf.dylib\r\n    0x7fff6c33b000 -     0x7fff6c37cff7  com.apple.awd (1.0 - 930.11) <99842C06-BBA9-339A-A235-F8195F2DDEB9> /System/Library/PrivateFrameworks/WirelessDiagnostics.framework/Versions/A/WirelessDiagnostics\r\n    0x7fff6c3f0000 -     0x7fff6c3f3fff  com.apple.dt.XCTTargetBootstrap (1.0 - 14490.66) <7AE3457F-AF40-3508-93FB-1D9E31EB1C9D> /System/Library/PrivateFrameworks/XCTTargetBootstrap.framework/Versions/A/XCTTargetBootstrap\r\n    0x7fff6c45b000 -     0x7fff6c45dff3  com.apple.private.XprotectFrameWork.XprotectFramework (1.0 - 1) <B145A839-96DF-3625-8301-EC111C64B01C> /System/Library/PrivateFrameworks/XprotectFramework.framework/Versions/A/XprotectFramework\r\n    0x7fff6c7ac000 -     0x7fff6c7b0ff3  com.apple.kperf (1.0 - 1) <E40B74D4-FB08-399E-AFCE-8764502DF5BF> /System/Library/PrivateFrameworks/kperf.framework/Versions/A/kperf\r\n    0x7fff6c7f4000 -     0x7fff6c7f6ffb  com.apple.loginsupport (1.0 - 1) <3F8D6334-BCD6-36C1-BA20-CC8503A84375> /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport\r\n    0x7fff6c7f7000 -     0x7fff6c80cfff  com.apple.login (3.0 - 3.0) <E168F05D-A5DF-3848-8686-DF5015EA4BA4> /System/Library/PrivateFrameworks/login.framework/Versions/A/login\r\n    0x7fff6c843000 -     0x7fff6c874ffb  com.apple.contacts.vCard (1.0 - ???) <651AD944-66CA-3408-818F-484E0F53A1DE> /System/Library/PrivateFrameworks/vCard.framework/Versions/A/vCard\r\n    0x7fff6ca30000 -     0x7fff6ca44ffb  libAccessibility.dylib (2402.92) <DC4EB84A-15EF-3B09-ADE4-D8226AFBC15E> /usr/lib/libAccessibility.dylib\r\n    0x7fff6cac0000 -     0x7fff6caf4fff  libCRFSuite.dylib (41.15.4) <406DAC06-0C77-3F90-878B-4D38F11F0256> /usr/lib/libCRFSuite.dylib\r\n    0x7fff6caf7000 -     0x7fff6cb01ff7  libChineseTokenizer.dylib (28.15.3) <9B7F6109-3A5D-3641-9A7E-31D2239D73EE> /usr/lib/libChineseTokenizer.dylib\r\n    0x7fff6cb02000 -     0x7fff6cb8bfff  libCoreStorage.dylib (546.50.1) <8E643B27-7986-3351-B37E-038FB6794BF9> /usr/lib/libCoreStorage.dylib\r\n    0x7fff6cb8f000 -     0x7fff6cb90ffb  libDiagnosticMessagesClient.dylib (107) <A14D0819-0970-34CD-8680-80E4D7FE8C2C> /usr/lib/libDiagnosticMessagesClient.dylib\r\n    0x7fff6cbc7000 -     0x7fff6ce1eff3  libFosl_dynamic.dylib (18.3.4) <45E50221-1A39-3AB3-8267-C1E4E39ECF83> /usr/lib/libFosl_dynamic.dylib\r\n    0x7fff6ce3e000 -     0x7fff6ce45fff  libMatch.1.dylib (31.200.1) <EF8164CB-B599-39D9-9E73-4958A372DC0B> /usr/lib/libMatch.1.dylib\r\n    0x7fff6ce6f000 -     0x7fff6ce8dfff  libMobileGestalt.dylib (645.260.6) <0232958E-1EF2-3627-B8FF-09C6522594C7> /usr/lib/libMobileGestalt.dylib\r\n    0x7fff6ce8e000 -     0x7fff6ce8efff  libOpenScriptingUtil.dylib (179.1) <4D603146-EDA5-3A74-9FF8-4F75D8BB9BC6> /usr/lib/libOpenScriptingUtil.dylib\r\n    0x7fff6cfce000 -     0x7fff6cfcfffb  libSystem.B.dylib (1252.250.1) <1A13E822-B59C-3A36-A2E4-9968149714F9> /usr/lib/libSystem.B.dylib\r\n    0x7fff6cfd0000 -     0x7fff6d04aff7  libTelephonyUtilDynamic.dylib (3705) <FB760750-6327-36E5-A265-E0F9D9FAF559> /usr/lib/libTelephonyUtilDynamic.dylib\r\n    0x7fff6d04b000 -     0x7fff6d04cfff  libThaiTokenizer.dylib (2.15.1) <ADB37DC3-7D9B-3E73-A72A-BCC3433C937A> /usr/lib/libThaiTokenizer.dylib\r\n    0x7fff6d04d000 -     0x7fff6d050ffb  libUniversalAccess.dylib (361.53) <056BBF08-B031-3A57-8355-881D42170F5C> /usr/lib/libUniversalAccess.dylib\r\n    0x7fff6d05e000 -     0x7fff6d074ffb  libapple_nghttp2.dylib (1.24.1) <6F04250A-6686-3FDC-9A8D-290C64B06502> /usr/lib/libapple_nghttp2.dylib\r\n    0x7fff6d075000 -     0x7fff6d09effb  libarchive.2.dylib (54.250.1) <47289946-8504-3966-9127-6CE39993DC2C> /usr/lib/libarchive.2.dylib\r\n    0x7fff6d09f000 -     0x7fff6d11efff  libate.dylib (1.13.8) <92B44EDB-369D-3EE8-AEC5-61F8B9313DBF> /usr/lib/libate.dylib\r\n    0x7fff6d122000 -     0x7fff6d122ff3  libauto.dylib (187) <3E3780E1-96F3-3A22-91C5-92F9A5805518> /usr/lib/libauto.dylib\r\n    0x7fff6d123000 -     0x7fff6d1f1fff  libboringssl.dylib (109.250.2) <8044BBB7-F6E0-36C1-95D1-9C2AB19CF94A> /usr/lib/libboringssl.dylib\r\n    0x7fff6d1f2000 -     0x7fff6d202ffb  libbsm.0.dylib (39.200.18) <CF381E0B-025B-364F-A83D-2527E03F1AA3> /usr/lib/libbsm.0.dylib\r\n    0x7fff6d203000 -     0x7fff6d210fff  libbz2.1.0.dylib (38.200.3) <272953A1-8D36-329B-BDDB-E887B347710F> /usr/lib/libbz2.1.0.dylib\r\n    0x7fff6d211000 -     0x7fff6d264ff7  libc++.1.dylib (400.9.4) <9A60A190-6C34-339F-BB3D-AACE942009A4> /usr/lib/libc++.1.dylib\r\n    0x7fff6d265000 -     0x7fff6d27aff7  libc++abi.dylib (400.17) <38C09CED-9090-3719-90F3-04A2749F5428> /usr/lib/libc++abi.dylib\r\n    0x7fff6d27b000 -     0x7fff6d27bff3  libcharset.1.dylib (51.200.6) <2A27E064-314C-359C-93FC-8A9B06206174> /usr/lib/libcharset.1.dylib\r\n    0x7fff6d27c000 -     0x7fff6d28cffb  libcmph.dylib (6.15.1) <9C52B2FE-179F-32AC-B87E-2AFC49ABF817> /usr/lib/libcmph.dylib\r\n    0x7fff6d28d000 -     0x7fff6d2a5ffb  libcompression.dylib (52.250.2) <7F4BB18C-1FB4-3825-8D8B-6E6B168774C6> /usr/lib/libcompression.dylib\r\n    0x7fff6d51a000 -     0x7fff6d530fff  libcoretls.dylib (155.220.1) <4C64BE3E-41E3-3020-8BB7-07E90C0C861C> /usr/lib/libcoretls.dylib\r\n    0x7fff6d531000 -     0x7fff6d532ff3  libcoretls_cfhelpers.dylib (155.220.1) <0959B3E9-6643-3589-8BB3-21D52CDF0EF1> /usr/lib/libcoretls_cfhelpers.dylib\r\n    0x7fff6d6d0000 -     0x7fff6d7c8ff7  libcrypto.35.dylib (22.260.1) <03FBCE39-6B59-314E-A18C-CF045D132C4A> /usr/lib/libcrypto.35.dylib\r\n    0x7fff6d8ca000 -     0x7fff6d9cafcb  libcrypto.42.dylib (22.260.1) <A5C810D8-2148-36C7-88ED-64877E5EADD6> /usr/lib/libcrypto.42.dylib\r\n    0x7fff6d9cb000 -     0x7fff6d9d6ff7  libcsfde.dylib (546.50.1) <7BAF8FCF-33A1-3C7C-8FEB-2020C8ED6063> /usr/lib/libcsfde.dylib\r\n    0x7fff6d9de000 -     0x7fff6da34ff7  libcups.2.dylib (462.10) <2AC7B8C3-0D25-3E0F-A34A-94658A06FF94> /usr/lib/libcups.2.dylib\r\n    0x7fff6da5d000 -     0x7fff6dab0fff  libcurl.4.dylib (105.200.2) <CC3D005E-CD2F-3345-A8B3-B8A3050B284B> /usr/lib/libcurl.4.dylib\r\n    0x7fff6dabb000 -     0x7fff6db36ff7  libdtrace.dylib (284.250.4) <803C30C7-E9F2-3321-BA65-CC7539E3727F> /usr/lib/libdtrace.dylib\r\n    0x7fff6db37000 -     0x7fff6db3aff7  libdz.dylib (1.0.0 - 110.250.10) <68507118-9E70-3063-8416-B3645588896B> /usr/lib/libdz.dylib\r\n    0x7fff6db4a000 -     0x7fff6db67ff7  libedit.3.dylib (50.200.2) <8FBA9760-CFF6-3F53-8DBE-AEC526337D7A> /usr/lib/libedit.3.dylib\r\n    0x7fff6db68000 -     0x7fff6db68fff  libenergytrace.dylib (17.200.1) <80BB567A-FD18-3497-BF97-353F57D98CDD> /usr/lib/libenergytrace.dylib\r\n    0x7fff6db83000 -     0x7fff6db8ffff  libexslt.0.dylib (16.1) <EC2E3DA9-5B3D-38E6-B05E-8C9F42B01009> /usr/lib/libexslt.0.dylib\r\n    0x7fff6db90000 -     0x7fff6db91fff  libffi.dylib (18.1) <DA1198F8-9789-3F16-BF60-9DA170519295> /usr/lib/libffi.dylib\r\n    0x7fff6db9a000 -     0x7fff6db9fff7  libgermantok.dylib (17.15.2) <E5F0F794-FF27-3D64-AE52-C78C6A84DD67> /usr/lib/libgermantok.dylib\r\n    0x7fff6dba0000 -     0x7fff6dba5ff7  libheimdal-asn1.dylib (520.260.1) <DC44D1D1-D3DF-38B3-AFC3-1D50B92BE401> /usr/lib/libheimdal-asn1.dylib\r\n    0x7fff6dbd0000 -     0x7fff6dcc0fff  libiconv.2.dylib (51.200.6) <2047C9B7-3F74-3A95-810D-2ED8F0475A99> /usr/lib/libiconv.2.dylib\r\n    0x7fff6dcc1000 -     0x7fff6df22fff  libicucore.A.dylib (62135.0.1) <2B292561-798A-381C-AA41-90EE6549C7CF> /usr/lib/libicucore.A.dylib\r\n    0x7fff6df6f000 -     0x7fff6df70fff  liblangid.dylib (128.15.1) <22D05C4F-769B-3075-ABCF-44A0EBACE028> /usr/lib/liblangid.dylib\r\n    0x7fff6df71000 -     0x7fff6df89ff3  liblzma.5.dylib (10.200.3) <E1F4FD60-1CE4-37B9-AD95-29D348AF1AC0> /usr/lib/liblzma.5.dylib\r\n    0x7fff6dfa1000 -     0x7fff6e045ff7  libmecab.1.0.0.dylib (779.24.1) <A8D0379B-85FA-3B3D-89ED-5CF2C3826AB2> /usr/lib/libmecab.1.0.0.dylib\r\n    0x7fff6e046000 -     0x7fff6e24afff  libmecabra.dylib (779.24.1) <D71F71E0-30E2-3DB3-B636-7DE13D51FB4B> /usr/lib/libmecabra.dylib\r\n    0x7fff6e24f000 -     0x7fff6e27ffff  libncurses.5.4.dylib (53.200.3) <767B4D3D-CF4C-33DF-B282-0CAC013A7AD0> /usr/lib/libncurses.5.4.dylib\r\n    0x7fff6e422000 -     0x7fff6e773ff7  libnetwork.dylib (1229.250.15) <72C7E9E3-B2BE-3300-BE1B-64606222022C> /usr/lib/libnetwork.dylib\r\n    0x7fff6e805000 -     0x7fff6ef8afdf  libobjc.A.dylib (756.2) <7C312627-43CB-3234-9324-4DEA92D59F50> /usr/lib/libobjc.A.dylib\r\n    0x7fff6ef8b000 -     0x7fff6ef8cfff  libodfde.dylib (24.50.1) <46EA989F-415B-3FE6-983D-30CC9BE63DAE> /usr/lib/libodfde.dylib\r\n    0x7fff6ef9c000 -     0x7fff6efa0ffb  libpam.2.dylib (22.200.1) <586CF87F-349C-393D-AEEB-FB75F94A5EB7> /usr/lib/libpam.2.dylib\r\n    0x7fff6efa1000 -     0x7fff6efa2ff7  libpanel.5.4.dylib (53.200.3) <D98D5D77-B79B-3FCF-8B07-B45603FE73EF> /usr/lib/libpanel.5.4.dylib\r\n    0x7fff6efa3000 -     0x7fff6efd8fff  libpcap.A.dylib (79.250.1) <C0893641-7DFF-3A33-BDAE-190FF54837E8> /usr/lib/libpcap.A.dylib\r\n    0x7fff6f0ef000 -     0x7fff6f0f0ff3  libquit.dylib (267.3) <FF577E42-737C-3240-9547-E7F784FDEB2F> /usr/lib/libquit.dylib\r\n    0x7fff6f0f1000 -     0x7fff6f109ffb  libresolv.9.dylib (65.200.2) <893142A5-F153-3437-A22D-407EE542B5C5> /usr/lib/libresolv.9.dylib\r\n    0x7fff6f10b000 -     0x7fff6f146ff3  libsandbox.1.dylib (851.260.2) <5BB0426C-6DE4-3E12-B6B6-35D4FC318A89> /usr/lib/libsandbox.1.dylib\r\n    0x7fff6f147000 -     0x7fff6f159ff7  libsasl2.2.dylib (211) <10987614-6763-3B5D-9F28-91D121BB4924> /usr/lib/libsasl2.2.dylib\r\n    0x7fff6f15a000 -     0x7fff6f15bff7  libspindump.dylib (267.3) <A584E403-8C95-3841-9C16-E22664A5A63F> /usr/lib/libspindump.dylib\r\n    0x7fff6f15c000 -     0x7fff6f339fe7  libsqlite3.dylib (274.25) <55CE34C4-00C0-3844-B7ED-80FA7F0AF03F> /usr/lib/libsqlite3.dylib\r\n    0x7fff6f396000 -     0x7fff6f3c9ff3  libssl.35.dylib (22.260.1) <276288BE-EE67-30DC-9794-B91FFC3934BD> /usr/lib/libssl.35.dylib\r\n    0x7fff6f3fd000 -     0x7fff6f42cfff  libssl.44.dylib (22.260.1) <A2C39D0B-9A5D-31DF-A8ED-55C339243D8B> /usr/lib/libssl.44.dylib\r\n    0x7fff6f42d000 -     0x7fff6f478ff7  libstdc++.6.dylib (104.1) <BF6E1E5B-5DF2-3069-A926-20ABF03832B3> /usr/lib/libstdc++.6.dylib\r\n    0x7fff6f47e000 -     0x7fff6f47fff7  libsysmon.dylib (100.250.1) <6E541FB9-6E07-3E46-BD7D-6B07C9258224> /usr/lib/libsysmon.dylib\r\n    0x7fff6f4a8000 -     0x7fff6f4d8ffb  libtidy.A.dylib (16.1) <658662AF-0DE4-3EB6-8884-9D10E7038FCB> /usr/lib/libtidy.A.dylib\r\n    0x7fff6f4f2000 -     0x7fff6f551ffb  libusrtcp.dylib (1229.250.15) <36BBD474-FAE5-366F-946D-16C5C4B4A792> /usr/lib/libusrtcp.dylib\r\n    0x7fff6f552000 -     0x7fff6f555ff7  libutil.dylib (51.200.4) <CE9B18C9-66ED-32D4-9D29-01F8FCB467B0> /usr/lib/libutil.dylib\r\n    0x7fff6f556000 -     0x7fff6f563fff  libxar.1.dylib (417.1) <39CCF46B-C81A-34B1-92A1-58C4E5DA846E> /usr/lib/libxar.1.dylib\r\n    0x7fff6f568000 -     0x7fff6f64aff3  libxml2.2.dylib (32.8) <54F896CF-6D83-300B-9CD9-1636BE5375A4> /usr/lib/libxml2.2.dylib\r\n    0x7fff6f64b000 -     0x7fff6f673ff3  libxslt.1.dylib (16.1) <31F7018B-D8F2-36ED-A13B-1E5A16DFAAA1> /usr/lib/libxslt.1.dylib\r\n    0x7fff6f674000 -     0x7fff6f686ff7  libz.1.dylib (70.200.4) <B048FC1F-058F-3A08-A1FE-81D5308CB3E6> /usr/lib/libz.1.dylib\r\n    0x7fff6f6f6000 -     0x7fff6f702ff3  libswiftAVFoundation.dylib (??? - ???) <0343ADA8-C7A9-38CF-9834-D455F914E6B3> /usr/lib/swift/libswiftAVFoundation.dylib\r\n    0x7fff6f709000 -     0x7fff6f71cff3  libswiftAppKit.dylib (??? - ???) <390B2331-342E-367F-9308-01447A4442E6> /usr/lib/swift/libswiftAppKit.dylib\r\n    0x7fff6f735000 -     0x7fff6faa6ff7  libswiftCore.dylib (5.0 - 1001.8.63.13) <931B3D8E-C66D-3DF8-88C9-00FB6978BCF4> /usr/lib/swift/libswiftCore.dylib\r\n    0x7fff6faa7000 -     0x7fff6faacff3  libswiftCoreAudio.dylib (??? - ???) <7DCC2F3C-C9E9-3FCC-81A0-E1C536626EF5> /usr/lib/swift/libswiftCoreAudio.dylib\r\n    0x7fff6faad000 -     0x7fff6fab4ffb  libswiftCoreData.dylib (??? - ???) <7D7D21CE-8F68-390F-BE47-2AB1DC0439ED> /usr/lib/swift/libswiftCoreData.dylib\r\n    0x7fff6fab5000 -     0x7fff6fab7ff3  libswiftCoreFoundation.dylib (??? - ???) <3192FF82-E322-3B09-805F-6AEB48C00478> /usr/lib/swift/libswiftCoreFoundation.dylib\r\n    0x7fff6fab8000 -     0x7fff6fac6ff3  libswiftCoreGraphics.dylib (??? - ???) <FEFE340D-865B-3C8C-AF13-AB1DE8866C01> /usr/lib/swift/libswiftCoreGraphics.dylib\r\n    0x7fff6fac7000 -     0x7fff6facaffb  libswiftCoreImage.dylib (??? - ???) <4AC0B024-190B-31F8-8EC5-C9E2761C580E> /usr/lib/swift/libswiftCoreImage.dylib\r\n    0x7fff6fad0000 -     0x7fff6fad6fff  libswiftCoreMedia.dylib (??? - ???) <C6607E85-DBA1-3A32-B0E5-88789A019133> /usr/lib/swift/libswiftCoreMedia.dylib\r\n    0x7fff6fadd000 -     0x7fff6fae3ffb  libswiftDarwin.dylib (??? - ???) <FD515CE3-A057-36EC-A787-E78F773973F3> /usr/lib/swift/libswiftDarwin.dylib\r\n    0x7fff6fae4000 -     0x7fff6fafafff  libswiftDispatch.dylib (??? - ???) <40AA9542-FE66-37F0-B0BE-70C8D057488C> /usr/lib/swift/libswiftDispatch.dylib\r\n    0x7fff6fafb000 -     0x7fff6fc8cff7  libswiftFoundation.dylib (??? - ???) <A24C3092-3B6D-3680-945E-292A0D31436F> /usr/lib/swift/libswiftFoundation.dylib\r\n    0x7fff6fc9b000 -     0x7fff6fc9dff3  libswiftIOKit.dylib (??? - ???) <C7E2E0F9-D04C-348E-A5B6-DD59A9F40BDD> /usr/lib/swift/libswiftIOKit.dylib\r\n    0x7fff6fcab000 -     0x7fff6fcb2fff  libswiftMetal.dylib (??? - ???) <03736BFF-B1E4-32FB-B3C3-12FFF7681854> /usr/lib/swift/libswiftMetal.dylib\r\n    0x7fff6fcb3000 -     0x7fff6fcb9ffb  libswiftMetalKit.dylib (??? - ???) <531E08E1-6472-3644-AB5D-3227F68237FB> /usr/lib/swift/libswiftMetalKit.dylib\r\n    0x7fff6fcba000 -     0x7fff6fcc2ffb  libswiftModelIO.dylib (??? - ???) <EE913B98-93DA-3BDA-BF57-78A2766F04EE> /usr/lib/swift/libswiftModelIO.dylib\r\n    0x7fff6fcf4000 -     0x7fff6fcf7ff7  libswiftObjectiveC.dylib (??? - ???) <A4201F26-A2B3-3F2A-8B0F-D17F166C26BC> /usr/lib/swift/libswiftObjectiveC.dylib\r\n    0x7fff6fd02000 -     0x7fff6fd07ffb  libswiftQuartzCore.dylib (??? - ???) <FB83F05B-766E-3211-8CC7-E8B634B34BA0> /usr/lib/swift/libswiftQuartzCore.dylib\r\n    0x7fff6fe10000 -     0x7fff6fe38ff7  libswiftSwiftOnoneSupport.dylib (5.0 - 1001.8.63.13) <4C9E4D9E-6511-3090-8707-36CDCC778F0B> /usr/lib/swift/libswiftSwiftOnoneSupport.dylib\r\n    0x7fff6fe3f000 -     0x7fff6fe41ffb  libswiftXPC.dylib (??? - ???) <61CDCF0E-FFD3-31FD-A6B1-175B06EA6659> /usr/lib/swift/libswiftXPC.dylib\r\n    0x7fff6fe42000 -     0x7fff6fe48fff  libswiftos.dylib (??? - ???) <D3083D22-DF42-3879-8AD2-F668D47B3E0C> /usr/lib/swift/libswiftos.dylib\r\n    0x7fff6fe49000 -     0x7fff6fe69ffb  libswiftsimd.dylib (??? - ???) <8D005E6E-A365-394E-8042-493162C9D7F2> /usr/lib/swift/libswiftsimd.dylib\r\n    0x7fff6fe6a000 -     0x7fff6fe6eff3  libcache.dylib (81) <1987D1E1-DB11-3291-B12A-EBD55848E02D> /usr/lib/system/libcache.dylib\r\n    0x7fff6fe6f000 -     0x7fff6fe79ff3  libcommonCrypto.dylib (60118.250.2) <1765BB6E-6784-3653-B16B-CB839721DC9A> /usr/lib/system/libcommonCrypto.dylib\r\n    0x7fff6fe7a000 -     0x7fff6fe81ff7  libcompiler_rt.dylib (63.4) <5212BA7B-B7EA-37B4-AF6E-AC4F507EDFB8> /usr/lib/system/libcompiler_rt.dylib\r\n    0x7fff6fe82000 -     0x7fff6fe8bff7  libcopyfile.dylib (146.250.1) <98CD00CD-9B91-3B5C-A9DB-842638050FA8> /usr/lib/system/libcopyfile.dylib\r\n    0x7fff6fe8c000 -     0x7fff6ff10fc3  libcorecrypto.dylib (602.260.2) <BED0F385-D8A2-334A-BD7B-0673B5DABBC5> /usr/lib/system/libcorecrypto.dylib\r\n    0x7fff6ff97000 -     0x7fff6ffd0ff7  libdispatch.dylib (1008.250.7) <26DF5B1E-A388-38EF-B73B-AF0E93FB02DB> /usr/lib/system/libdispatch.dylib\r\n    0x7fff6ffd1000 -     0x7fff6fffdff7  libdyld.dylib (655.1.1) <002418CC-AD11-3D10-865B-015591D24E6C> /usr/lib/system/libdyld.dylib\r\n    0x7fff6fffe000 -     0x7fff6fffeffb  libkeymgr.dylib (30) <0D0F9CA2-8D5A-3273-8723-59987B5827F2> /usr/lib/system/libkeymgr.dylib\r\n    0x7fff6ffff000 -     0x7fff7000bff3  libkxld.dylib (4903.261.4) <71CF1ECD-AC4E-3FDD-BEDF-14933D843EEE> /usr/lib/system/libkxld.dylib\r\n    0x7fff7000c000 -     0x7fff7000cff7  liblaunch.dylib (1336.261.2) <BD5CDB35-2BB4-349A-8D14-78E387563F89> /usr/lib/system/liblaunch.dylib\r\n    0x7fff7000d000 -     0x7fff70012fff  libmacho.dylib (927.0.2) <3C5C9024-45FD-38C2-B01A-07A322966063> /usr/lib/system/libmacho.dylib\r\n    0x7fff70013000 -     0x7fff70015ffb  libquarantine.dylib (86.220.1) <6D0BC770-7348-3608-9254-F7FFBD347634> /usr/lib/system/libquarantine.dylib\r\n    0x7fff70016000 -     0x7fff70017ff7  libremovefile.dylib (45.200.2) <9FBEB2FF-EEBE-31BC-BCFC-C71F8D0E99B6> /usr/lib/system/libremovefile.dylib\r\n    0x7fff70018000 -     0x7fff7002fff3  libsystem_asl.dylib (356.200.4) <A62A7249-38B8-33FA-9875-F1852590796C> /usr/lib/system/libsystem_asl.dylib\r\n    0x7fff70030000 -     0x7fff70030ff7  libsystem_blocks.dylib (73) <A453E8EE-860D-3CED-B5DC-BE54E9DB4348> /usr/lib/system/libsystem_blocks.dylib\r\n    0x7fff70031000 -     0x7fff700b8fff  libsystem_c.dylib (1272.250.1) <7EDACF78-2FA3-35B8-B051-D70475A35117> /usr/lib/system/libsystem_c.dylib\r\n    0x7fff700b9000 -     0x7fff700bcffb  libsystem_configuration.dylib (963.260.1) <C7D2BA09-8D5B-3393-8D84-304D76C55DEF> /usr/lib/system/libsystem_configuration.dylib\r\n    0x7fff700bd000 -     0x7fff700c0ff7  libsystem_coreservices.dylib (66) <719F75A4-74C5-3BA6-A09E-0C5A3E5889D7> /usr/lib/system/libsystem_coreservices.dylib\r\n    0x7fff700c1000 -     0x7fff700c7fff  libsystem_darwin.dylib (1272.250.1) <EC9B39A5-9592-3577-8997-7DC721D20D8C> /usr/lib/system/libsystem_darwin.dylib\r\n    0x7fff700c8000 -     0x7fff700ceff7  libsystem_dnssd.dylib (878.260.1) <64B79B01-B1B0-3C7E-87A1-023B71843F1F> /usr/lib/system/libsystem_dnssd.dylib\r\n    0x7fff700cf000 -     0x7fff7011affb  libsystem_info.dylib (517.200.9) <D09D5AE0-2FDC-3A6D-93EC-729F931B1457> /usr/lib/system/libsystem_info.dylib\r\n    0x7fff7011b000 -     0x7fff70143ff7  libsystem_kernel.dylib (4903.261.4) <7B0F52C4-4CC9-3282-8457-C18C6FE1B99E> /usr/lib/system/libsystem_kernel.dylib\r\n    0x7fff70144000 -     0x7fff7018fff7  libsystem_m.dylib (3158.200.7) <F19B6DB7-014F-3820-831F-389CCDA06EF6> /usr/lib/system/libsystem_m.dylib\r\n    0x7fff70190000 -     0x7fff701bafff  libsystem_malloc.dylib (166.261.1) <4D1CEF38-DE32-3ECF-9F70-0ADDD5C8775F> /usr/lib/system/libsystem_malloc.dylib\r\n    0x7fff701bb000 -     0x7fff701c5ff7  libsystem_networkextension.dylib (767.250.2) <FF06F13A-AEFE-3A27-A073-910EF78AEA36> /usr/lib/system/libsystem_networkextension.dylib\r\n    0x7fff701c6000 -     0x7fff701cdfff  libsystem_notify.dylib (172.200.21) <145B5CFC-CF73-33CE-BD3D-E8DDE268FFDE> /usr/lib/system/libsystem_notify.dylib\r\n    0x7fff701ce000 -     0x7fff701d7fef  libsystem_platform.dylib (177.250.1) <16949870-9152-3B0D-9EF0-40FAF84B0F1E> /usr/lib/system/libsystem_platform.dylib\r\n    0x7fff701d8000 -     0x7fff701e2ff7  libsystem_pthread.dylib (330.250.2) <2D5C08FF-484F-3D59-9132-CE1DCB3F76D7> /usr/lib/system/libsystem_pthread.dylib\r\n    0x7fff701e3000 -     0x7fff701e6ff7  libsystem_sandbox.dylib (851.260.2) <9CACC5F5-3859-3A1F-BCC6-96DDD4A556A8> /usr/lib/system/libsystem_sandbox.dylib\r\n    0x7fff701e7000 -     0x7fff701e9ff3  libsystem_secinit.dylib (30.260.2) <88F3CE61-5FAD-3CDA-AA13-B5B18B3EBD26> /usr/lib/system/libsystem_secinit.dylib\r\n    0x7fff701ea000 -     0x7fff701f1ff3  libsystem_symptoms.dylib (820.267.1) <03F1C2DD-0F5A-3D9D-88F6-B26C0F94EB52> /usr/lib/system/libsystem_symptoms.dylib\r\n    0x7fff701f2000 -     0x7fff70207fff  libsystem_trace.dylib (906.260.1) <100013AE-0443-3CF0-AC17-5D934608B60B> /usr/lib/system/libsystem_trace.dylib\r\n    0x7fff70209000 -     0x7fff7020effb  libunwind.dylib (35.4) <24A97A67-F017-3CFC-B0D0-6BD0224B1336> /usr/lib/system/libunwind.dylib\r\n    0x7fff7020f000 -     0x7fff7023efff  libxpc.dylib (1336.261.2) <9A0FFA79-082F-3293-BF49-63976B073B74> /usr/lib/system/libxpc.dylib\r\n\r\nExternal Modification Summary:\r\n  Calls made by other processes targeting this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by all processes on this machine:\r\n    task_for_pid: 79602\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n\r\nVM Region Summary:\r\nReadOnly portion of Libraries: Total=932.3M resident=0K(0%) swapped_out_or_unallocated=932.3M(100%)\r\nWritable regions: Total=2.7G written=0K(0%) resident=0K(0%) swapped_out=0K(0%) unallocated=2.7G(100%)\r\n \r\n                                VIRTUAL   REGION \r\nREGION TYPE                        SIZE    COUNT (non-coalesced) \r\n===========                     =======  ======= \r\nActivity Tracing                   256K        1 \r\nCG backing stores                  224K        2 \r\nCG image                           276K       36 \r\nCoreAnimation                     1136K       76 \r\nCoreGraphics                         8K        1 \r\nCoreImage                          168K       35 \r\nCoreServices                        40K        1 \r\nCoreUI image data                 1396K       29 \r\nCoreUI image file                  460K       10 \r\nDispatch continuations            24.0M        1 \r\nFoundation                          16K        4 \r\nImage IO                            16K        3 \r\nJS JIT generated code              1.0G        3 \r\nKernel Alloc Once                    8K        1 \r\nMALLOC                           368.5M       65 \r\nMALLOC guard page                   72K       13 \r\nMALLOC_MEDIUM (reserved)           1.3G       12         reserved VM address space (unallocated)\r\nMemory Tag 242                      12K        1 \r\nMemory Tag 251                     100K        3 \r\nSQLite page cache                  128K        2 \r\nSTACK GUARD                       56.1M       24 \r\nStack                             19.7M       24 \r\nVM_ALLOCATE                        136K       15 \r\nWebKit Malloc                     1144K        2 \r\n__DATA                            84.4M      661 \r\n__FONT_DATA                          4K        1 \r\n__LINKEDIT                       312.4M      301 \r\n__TEXT                           621.0M      620 \r\n__UNICODE                          564K        1 \r\nlibnetwork                        1152K        1 \r\nmapped file                       88.8M       76 \r\nshared memory                     2688K       15 \r\n===========                     =======  ======= \r\nTOTAL                              3.9G     2040 \r\nTOTAL, minus reserved VM space     2.5G     2040 \r\n\r\nModel: Macmini8,1, BootROM 220.260.170.0.0 (iBridge: 16.16.5125.0.0,0), 6 processors, Intel Core i7, 3,2 GHz, 32 GB, SMC \r\nGraphics: kHW_IntelUHDGraphics630Item, Intel UHD Graphics 630, spdisplays_builtin\r\nMemory Module: BANK 0/ChannelA-DIMM0, 16 GB, DDR4, 2667 MHz, Kingston, 9905630-063.A00G\r\nMemory Module: BANK 2/ChannelB-DIMM0, 16 GB, DDR4, 2667 MHz, Kingston, 9905630-063.A00G\r\nAirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0x7BF), wl0: Mar 28 2019 19:17:52 version 9.137.9.0.32.6.34 FWID 01-36f56c94\r\nBluetooth: Version 6.0.12f1, 3 services, 27 devices, 1 incoming serial ports\r\nNetwork Service: Ethernet, Ethernet, en0\r\nNetwork Service: Wi-Fi, AirPort, en1\r\nUSB Device: USB 3.1 Bus\r\nUSB Device: iBridge Bus\r\nUSB Device: Headset\r\nUSB Device: iBridge\r\nThunderbolt Bus: Mac mini, Apple Inc., 41.2\r\nThunderbolt Bus: Mac mini, Apple Inc., 41.2\r\n```",
        "created_at": "2019-07-04T12:07:10Z",
        "user": "palmerc",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "needs_verified",
            "macos",
            "system"
        ]
    },
    {
        "number": 58426,
        "title": "Integration tests fail without LC_ALL set.",
        "body": "##### SUMMARY\r\n\r\nIntegration tests fail without LC_ALL set.\r\n\r\n##### ISSUE TYPE\r\n\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nansible\r\n\r\n##### ANSIBLE VERSION\r\n\r\ndevel\r\n\r\n##### CONFIGURATION\r\n\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSee commands below in ACTUAL RESULTS section.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTests pass.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`ansible-test integration copy --docker centos7 -v`\r\n\r\n```\r\nUnhandled error:\r\n Traceback (most recent call last):\r\n  File \"/root/ansible/lib/ansible/config/manager.py\", line 522, in update_config_data\r\n    value, origin = self.get_config_value_and_origin(config, configfile)\r\n  File \"/root/ansible/lib/ansible/config/manager.py\", line 425, in get_config_value_and_origin\r\n    value, origin = self._loop_entries(py3compat.environ, defs[config]['env'])\r\n  File \"/root/ansible/lib/ansible/config/manager.py\", line 365, in _loop_entries\r\n    temp_value = container.get(name, None)\r\n  File \"/usr/lib64/python2.7/_abcoll.py\", line 363, in get\r\n    return self[key]\r\n  File \"/root/ansible/lib/ansible/utils/py3compat.py\", line 50, in __getitem__\r\n    nonstring='passthru', errors='surrogate_or_strict')\r\n  File \"/root/ansible/lib/ansible/module_utils/_text.py\", line 235, in to_text\r\n    return obj.decode(encoding, errors)\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 36: ordinal not in range(128)\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"/root/ansible/bin/ansible-playbook\", line 61, in <module>\r\n    import ansible.constants as C\r\n  File \"/root/ansible/lib/ansible/constants.py\", line 174, in <module>\r\n    config = ConfigManager()\r\n  File \"/root/ansible/lib/ansible/config/manager.py\", line 262, in __init__\r\n    self.update_config_data()\r\n  File \"/root/ansible/lib/ansible/config/manager.py\", line 534, in update_config_data\r\n    raise AnsibleError(\"Invalid settings supplied for %s: %s\\n\" % (config, to_native(e)), orig_exc=e)\r\nansible.errors.AnsibleError: Invalid settings supplied for DEFAULT_ROLES_PATH: 'ascii' codec can't decode byte 0xc3 in position 36: ordinal not in range(128)\r\n```\r\n\r\n`ansible-test integration ansible -v`\r\n\r\n```\r\nUnhandled error:\r\n Traceback (most recent call last):\r\n  File \"/Users/mclay/code/mattclay/ansible/lib/ansible/config/manager.py\", line 522, in update_config_data\r\n    value, origin = self.get_config_value_and_origin(config, configfile)\r\n  File \"/Users/mclay/code/mattclay/ansible/lib/ansible/config/manager.py\", line 430, in get_config_value_and_origin\r\n    self._parse_config_file(cfile)\r\n  File \"/Users/mclay/code/mattclay/ansible/lib/ansible/config/manager.py\", line 291, in _parse_config_file\r\n    with open(to_bytes(cfile), 'rb') as f:\r\nFileNotFoundError: [Errno 2] No such file or directory: b'/Users/mclay/.ansible/test/tmp/ansible-sqozqaum-\\xc3\\x85\\xc3\\x91\\xc5\\x9a\\xc3\\x8c\\xce\\xb2\\xc5\\x81\\xc3\\x88/test/integration/targets/ansible/ansible-non-existent.cfg'\r\n```\r\n\r\n`ansible-test integration includes --docker centos7 -vvv`\r\n\r\n```\r\nERROR! Unexpected Exception, this is probably a bug: 'ascii' codec can't encode characters in position 40-46: ordinal not in range(128)\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/root/ansible/bin/ansible-playbook\", line 111, in <module>\r\n    exit_code = cli.run()\r\n  File \"/root/ansible/lib/ansible/cli/playbook.py\", line 121, in run\r\n    results = pbex.run()\r\n  File \"/root/ansible/lib/ansible/executor/playbook_executor.py\", line 91, in run\r\n    pb = Playbook.load(playbook_path, variable_manager=self._variable_manager, loader=self._loader)\r\n  File \"/root/ansible/lib/ansible/playbook/__init__.py\", line 50, in load\r\n    pb._load_playbook_data(file_name=file_name, variable_manager=variable_manager)\r\n  File \"/root/ansible/lib/ansible/playbook/__init__.py\", line 93, in _load_playbook_data\r\n    pb = PlaybookInclude.load(entry, basedir=self._basedir, variable_manager=variable_manager, loader=self._loader)\r\n  File \"/root/ansible/lib/ansible/playbook/playbook_include.py\", line 42, in load\r\n    return PlaybookInclude().load_data(ds=data, basedir=basedir, variable_manager=variable_manager, loader=loader)\r\n  File \"/root/ansible/lib/ansible/playbook/playbook_include.py\", line 72, in load_data\r\n    pb._load_playbook_data(file_name=file_name, variable_manager=variable_manager, vars=self.vars.copy())\r\n  File \"/root/ansible/lib/ansible/playbook/__init__.py\", line 100, in _load_playbook_data\r\n    entry_obj = Play.load(entry, variable_manager=variable_manager, loader=self._loader, vars=vars)\r\n  File \"/root/ansible/lib/ansible/playbook/play.py\", line 116, in load\r\n    return p.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/root/ansible/lib/ansible/playbook/base.py\", line 235, in load_data\r\n    self._attributes[target_name] = method(name, ds[name])\r\n  File \"/root/ansible/lib/ansible/playbook/play.py\", line 201, in _load_roles\r\n    roles.append(Role.load(ri, play=self))\r\n  File \"/root/ansible/lib/ansible/playbook/role/__init__.py\", line 165, in load\r\n    r._load_role_data(role_include, parent_role=parent_role)\r\n  File \"/root/ansible/lib/ansible/playbook/role/__init__.py\", line 247, in _load_role_data\r\n    self._task_blocks = load_list_of_blocks(task_data, play=self._play, role=self, loader=self._loader, variable_manager=self._variable_manager)\r\n  File \"/root/ansible/lib/ansible/playbook/helpers.py\", line 77, in load_list_of_blocks\r\n    loader=loader,\r\n  File \"/root/ansible/lib/ansible/playbook/block.py\", line 94, in load\r\n    return b.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/root/ansible/lib/ansible/playbook/base.py\", line 235, in load_data\r\n    self._attributes[target_name] = method(name, ds[name])\r\n  File \"/root/ansible/lib/ansible/playbook/block.py\", line 130, in _load_block\r\n    use_handlers=self._use_handlers,\r\n  File \"/root/ansible/lib/ansible/playbook/helpers.py\", line 278, in load_list_of_tasks\r\n    variable_manager=variable_manager,\r\n  File \"/root/ansible/lib/ansible/playbook/helpers.py\", line 77, in load_list_of_blocks\r\n    loader=loader,\r\n  File \"/root/ansible/lib/ansible/playbook/block.py\", line 94, in load\r\n    return b.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/root/ansible/lib/ansible/playbook/base.py\", line 235, in load_data\r\n    self._attributes[target_name] = method(name, ds[name])\r\n  File \"/root/ansible/lib/ansible/playbook/block.py\", line 130, in _load_block\r\n    use_handlers=self._use_handlers,\r\n  File \"/root/ansible/lib/ansible/playbook/helpers.py\", line 216, in load_list_of_tasks\r\n    if os.path.exists(include_file):\r\n  File \"/usr/lib64/python2.7/genericpath.py\", line 18, in exists\r\n    os.stat(path)\r\nUnicodeEncodeError: 'ascii' codec can't encode characters in position 40-46: ordinal not in range(128)\r\n```\r\n\r\nThere are likely more failures than those exposed by these tests. I just picked these as specific examples.",
        "created_at": "2019-06-26T19:51:56Z",
        "user": "mattclay",
        "labels": [
            "python3",
            "support:core",
            "bug",
            "traceback",
            "needs_verified",
            "affects_2.9"
        ]
    },
    {
        "number": 58281,
        "title": "Automatically template inventory config options",
        "body": "Automatically import existing variables and allow for templating of inventory config options by default for all plugins.\r\n\r\nAs a side effect, this should also allow for using inline vaults on options.\r\n\r\nsuperset of #58213\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ninventory",
        "created_at": "2019-06-24T14:48:10Z",
        "user": "bcoca",
        "labels": [
            "inventory",
            "support:core",
            "has_pr",
            "feature",
            "collection",
            "affects_2.17"
        ]
    },
    {
        "number": 57573,
        "title": "file module reports \"absent\" on PermissionError",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n`file` module reports `absent`, when it can't access path to delete.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n`file` module\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.9.0.dev0\r\n  config file = None\r\n  configured module search path = ['/home/jakski/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/jakski/lib/ansible\r\n  executable location = /home/jakski/venv/bin/ansible\r\n  python version = 3.6.7 (default, Oct 22 2018, 11:32:17) [GCC 8.2.0]\r\n```\r\nIt's from commit `c50a75a41e902cebf9f6438818570306e3ea71ba`(`devel` branch).\r\n\r\n##### CONFIGURATION\r\n`ansible-config dump --only-changed` doesn't return anything. I didn't overwrite any defaults.\r\n\r\n##### OS / ENVIRONMENT\r\n```\r\nDistributor ID: Ubuntu\r\nDescription:    Ubuntu 18.04.2 LTS\r\nRelease:        18.04\r\nCodename:       bionic\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  gather_facts: false\r\n  tasks:\r\n    - file:\r\n        path: tst\r\n        state: directory\r\n\r\n    - file:\r\n        path: tst/test1\r\n        state: touch\r\n\r\n    - file:\r\n        path: tst\r\n        state: directory\r\n        mode: 0000\r\n\r\n    - file:\r\n        path: tst/test1\r\n        state: absent\r\n\r\n    - file:\r\n        path: tst\r\n        state: directory\r\n        mode: 0700\r\n\r\n    - stat:\r\n        path: tst/test1\r\n      register: _test1\r\n\r\n    - fail:\r\n        msg: File tst/test1 still exists\r\n      when: _test1.stat.exists\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFile should be removed or `file` module should report error, that it can't access path.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAnsible runs all tasks and reports error:\r\n\r\n```\r\nTASK [fail] ***********************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"File tst/test1 still exists\"}\r\n```\r\nDeleting `tst/test1` is being reported as an unchanged task.\r\n",
        "created_at": "2019-06-08T16:09:41Z",
        "user": "Jakski",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "files",
            "affects_2.9"
        ]
    },
    {
        "number": 57061,
        "title": "gather_facts/setup fails with encrypted sudo password",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhen `gather_facts` is enabled in a playbook that has a vaulted sudo password, the gather_facts tasks fails. Ad hoc setup module commands with `-K b -k` work ( but not with the below playbook, even when all vault/become sections are commented out)\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ngather_facts\r\nsetup\r\nansible vault\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible-playbook 2.7.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Sep 12 2018, 05:31:16) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nDEFAULT_BECOME(/etc/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_ASK_PASS(/etc/ansible/ansible.cfg) = False\r\nDEFAULT_BECOME_METHOD(/etc/ansible/ansible.cfg) = sudo\r\nDEFAULT_BECOME_USER(/etc/ansible/ansible.cfg) = root\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = [u'/etc/ansible/sat_inventory']\r\nDEFAULT_LOG_PATH(/etc/ansible/ansible.cfg) = /var/log/ansible.log\r\nDEFAULT_PRIVATE_KEY_FILE(/etc/ansible/ansible.cfg) = /home/users/svc_ansible/.ssh/id_rsa\r\nDEFAULT_REMOTE_USER(/etc/ansible/ansible.cfg) = svc_ansible\r\nDEFAULT_ROLES_PATH(/etc/ansible/ansible.cfg) = [u'/etc/ansible/roles', u'/usr/share/ansible/roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(/etc/ansible/ansible.cfg) = /etc/ansible/vaultpass\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nINVENTORY_ENABLED(/etc/ansible/ansible.cfg) = [u'foreman', u'ini', u'host_list', u'yaml', u'']\r\nPARAMIKO_HOST_KEY_AUTO_ADD(/etc/ansible/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nControl host: RHEL 7.6\r\nTarget System: RHEL 7.6\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nCreate playbook with vaulted `ansible_become_pass` and `gather_facts: True`\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n\r\n- name: Config \r\n  hosts: all\r\n  become: yes\r\n  gather_facts: True\r\n  vars:\r\n    ansible_become_password: !vault |\r\n             $ANSIBLE_VAULT;1.2;AES256;\r\n    \r\n             < encrypted string blob >\r\n             \r\n  tasks:\r\n   - name: include_vars\r\n     include_vars: /etc/ansible/ansiblesudo.yml\r\n   - import_role:\r\n      name: network\r\n   - import_role:\r\n      name: sat_register7\r\n   - import_role:\r\n      name: sshkey\r\n   - import_role:\r\n      name: ldap\r\n   - import_role:\r\n      name: firewalld\r\n   - import_role:\r\n      name: ntp\r\n   - import_role:\r\n      name: config_files\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\ngather_facts runs to populate host vars. Then roles are imported and ran. \r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\ninventory is parsed. Ansible ssh login is performed, but sudo fails with 'incorrect sudo password' \r\n\r\n/var/log/secure on the target system shows \"incorrect password attempt\" (authentication failure)\r\n\r\nWhen `gather_facts` is set to `False`, roles that require `sudo` run w/o issue. \r\n\r\nmanual ssh and sudo -i to target host works. \r\n[ansible_error.txt](https://github.com/ansible/ansible/files/3228040/ansible_error.txt)\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2019-05-28T14:08:23Z",
        "user": "SadFaceSmith",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 57013,
        "title": "Single import_tasks, but double task file execution",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nSingle `import_tasks`, but double task file execution.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n`import_tasks`\r\n\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n`master`\r\n```paste below\r\nansible 2.9.0.dev0\r\n  config file = /<PATH>/ansible-import/ansible.cfg\r\n  configured module search path = ['/home/<USER>/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /<PATH>/ansible-import/ansible/lib/ansible\r\n  executable location = /<PATH>/ansible-import/ansible/bin/ansible\r\n  python version = 3.7.3 (default, Apr  3 2019, 05:39:12) [GCC 8.3.0]\r\n```\r\nalso affected:\r\n* `2.7.10`\r\n* `2.7.11`\r\n* `2.8.0`\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_NOCOWS(/<PATH>/ansible-import/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nIt doesn't matter if target is\r\n* `localhost` with `Ubuntu 19.04`\r\n\r\nor\r\n* vagrant box with `FreeBSD 11.2-RELEASE-p10`\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n1. `git clone https://github.com/joachimmathes/ansible-import.git`\r\n2. Run `ansible-playbook pb_import.yml`\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\nPLAY [localhost] ****************************************************************************************************************************\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/main.yml\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/bar.yml\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/baz/baz.yml\"\r\n}\r\n\r\nTASK [foo : set_fact] ***********************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \">>>>>>>>>>>>>>>>>>>> RUN 1 <<<<<<<<<<<<<<<<<<<<\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/baz.yml\"\r\n}\r\n\r\nPLAY RECAP **********************************************************************************************************************************\r\nlocalhost                  : ok=6    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nPLAY [localhost] ****************************************************************************************************************************\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/main.yml\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/bar.yml\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/baz/baz.yml\"\r\n}\r\n\r\nTASK [foo : set_fact] ***********************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \">>>>>>>>>>>>>>>>>>>> RUN 1 <<<<<<<<<<<<<<<<<<<<\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/baz/baz.yml\"\r\n}\r\n\r\nTASK [foo : set_fact] ***********************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \">>>>>>>>>>>>>>>>>>>> RUN 2 <<<<<<<<<<<<<<<<<<<<\"\r\n}\r\n\r\nTASK [foo : debug] **************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"This is roles/foo/tasks/baz.yml\"\r\n}\r\n\r\nPLAY RECAP **********************************************************************************************************************************\r\nlocalhost                  : ok=9    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```\r\n\r\n##### Further information\r\n\r\nIf you run more verbose `ansible-playbook -vv pb_import.yml`, the\r\noutput tells you that tasks file\r\n`/<PATH>/ansible-import/roles/foo/tasks/baz/baz.yml` is imported\r\ntwice. But it should be imported once.\r\n```\r\nstatically imported: /<PATH>/ansible-import/roles/foo/tasks/bar.yml\r\nstatically imported: /<PATH>/ansible-import/roles/foo/tasks/baz/baz.yml\r\nstatically imported: /<PATH>/ansible-import/roles/foo/tasks/baz/baz.yml\r\nstatically imported: /<PATH>/ansible-import/roles/foo/tasks/baz.yml\r\n```\r\n\r\n##### Workaround 1\r\n\r\nIf you change the task file name of\r\n`/<PATH>/ansible-import/roles/foo/tasks/baz.yml` to\r\n`/<PATH>/ansible-import/roles/foo/tasks/bam.yml`\r\nand adjust the import tasks accordingly, the behaviour is as expected:\r\n\r\nCheckout branch `rename_file` and run `ansible-playbook pb_import.yml`.\r\n\r\n##### Workaround 2\r\n\r\nAlternatively, if you replace task\r\n```\r\n- import_tasks: ../baz.yml\r\n```\r\nby\r\n```\r\n- import_tasks: \"{{ role_path }}/tasks/baz.yml\"\r\n```\r\nthe behaviour is as expected, too.\r\n\r\nCheckout branch `use_role_path` and run `ansible-playbook pb_import.yml`.\r\n",
        "created_at": "2019-05-27T13:19:10Z",
        "user": "joachimmathes",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "utilities",
            "affects_2.9"
        ]
    },
    {
        "number": 56779,
        "title": "Fix output message in `x transfer mechanism failed`",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nContinuing #22127: I receive:\r\n```\r\nTASK [Gathering Facts] *********************************************************\r\n[1;35m [WARNING]: sftp transfer mechanism failed on [192.168.0.3]. Use[0m\r\n[1;35mANSIBLE_DEBUG=1 to see detailed information[0m\r\n[1;35m[0m\r\n[1;35m [WARNING]: scp transfer mechanism failed on [192.168.0.3]. Use ANSIBLE_DEBUG=1[0m\r\n[1;35mto see detailed information[0m\r\n[1;35m[0m\r\n[0;32mok: [192.168.0.3][0m\r\n```\r\n\r\nWhereas, a simple\r\n```\r\nstdout=xyz\r\nstderr=xyz\r\nrc=127\r\n```\r\noutput would save me the trouble of reading the 205 (!!) lines of the the `ANSIBLE_DEBUG=1` output\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nGathering Facts\r\nTransfer Mechanism\r\nStdout callback\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.0\r\n  config file = None\r\n  configured module search path = ['/tf/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Apr  8 2019, 18:17:52) [GCC 8.3.0]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n# Empty - just the newline\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nAlpine OS\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nCompliment:\r\n```\r\nTASK [Gathering Facts] *********************************************************\r\n[1;35m [WARNING]: sftp transfer mechanism failed on [192.168.0.3]. Use[0m\r\n[1;35mANSIBLE_DEBUG=1 to see detailed information[0m\r\n[1;35m[0m\r\n[1;35m [WARNING]: scp transfer mechanism failed on [192.168.0.3]. Use ANSIBLE_DEBUG=1[0m\r\n[1;35mto see detailed information[0m\r\n[1;35m[0m\r\n[0;32mok: [192.168.0.3][0m\r\n```\r\n\r\nWith ssh / command output like:\r\n```\r\nssh.stdout=xyz\r\nssh.stderr=xyz\r\nssh.rc=127\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n\r\n```\r\n",
        "created_at": "2019-05-22T10:56:24Z",
        "user": "stdedos",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "system"
        ]
    },
    {
        "number": 56716,
        "title": "ansible 2.7/2.8: copy result registration in check mode",
        "body": "##### SUMMARY\r\nWhen running a playbook in check mode the `copy` module behaves differently than in \"live\" mode.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ncopy\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.8.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/phil/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.3 (default, May 11 2019, 00:38:04) [GCC 9.1.1 20190503 (Red Hat 9.1.1-1)]\r\n```\r\n```\r\nansible 2.7.10 (detached HEAD e75f58f305) last updated 2019/05/21 09:56:29 (GMT +200)\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/phil/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/phil/ansible/lib/ansible\r\n  executable location = /home/phil/ansible/bin/ansible\r\n  python version = 2.7.16 (default, Apr 30 2019, 15:54:43) [GCC 9.0.1 20190312 (Red Hat 9.0.1-0.10)]\r\n```\r\n\r\n##### CONFIGURATION\r\nn/a\r\n\r\n##### OS / ENVIRONMENT\r\nn/a\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  gather_facts: no\r\n  tasks:\r\n    - copy:\r\n        content: \"{{item}}\"\r\n        dest: '/tmp/ansible-copy-{{item}}.tmp'\r\n      loop: ['a', 'b', 'c']\r\n      register: foo\r\n    - debug: var=item\r\n      loop: '{{foo.results|select(\"changed\")|map(attribute=\"dest\")|list}}'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nsame output as without `--check`.\r\n\r\n##### ACTUAL RESULTS\r\n```paste below\r\n$ ANSIBLE_LOG=/dev/null ansible-playbook copy2.yml -C\r\nPLAY [localhost] *************************************************************************************\r\n\r\nTASK [copy] ******************************************************************************************\r\nchanged: [localhost] => (item=a)\r\nchanged: [localhost] => (item=b)\r\nchanged: [localhost] => (item=c)\r\n\r\nTASK [debug] *****************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"msg\": \"Invalid data passed to 'loop', it requires a list, got this instead: [AnsibleUndefined, AnsibleUndefined, AnsibleUndefined]. Hint: If you passed a list/dict of just one element, try adding wantlist=True to your lookup invocation or use q/query instead of lookup.\"}\r\n\r\nPLAY RECAP *******************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0 \r\n```\r\n```$ ANSIBLE_LOG=/dev/null ansible-playbook copy2.yml\r\n\r\nPLAY [localhost] *************************************************************************************\r\n\r\nTASK [copy] ******************************************************************************************\r\nchanged: [localhost] => (item=a)\r\nchanged: [localhost] => (item=b)\r\nchanged: [localhost] => (item=c)\r\n\r\nTASK [debug] *****************************************************************************************\r\nok: [localhost] => (item=/tmp/ansible-copy-a.tmp) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"item\": \"/tmp/ansible-copy-a.tmp\"\r\n}\r\nok: [localhost] => (item=/tmp/ansible-copy-b.tmp) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"item\": \"/tmp/ansible-copy-b.tmp\"\r\n}\r\nok: [localhost] => (item=/tmp/ansible-copy-c.tmp) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"item\": \"/tmp/ansible-copy-c.tmp\"\r\n}\r\n\r\nPLAY RECAP *******************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\r\n```",
        "created_at": "2019-05-21T13:29:56Z",
        "user": "philfry",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "files",
            "affects_2.14",
            "affects_2.15"
        ]
    },
    {
        "number": 56495,
        "title": "Group module fails if local: true, state: absent, and group exists in centralized management",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nIf `local: true` is specified, trying to remove a group that exists in centralized management results in a failure.\r\n\r\nThis is in part because the `group.group_exists()` tests for the existence of a group using the python `grp` module which cannot distinguish between local and centralized groups.  Since `grp` reports the group exists, `group.group_del()` is called.  There `command_name` is set to `lgroupdel` because `self.local` is `True`.  The return code from `lgroupdel` is `2` because the group does not exists locally.  The `group` module considers any non-zero return code a failure.\r\n\r\nPossible solutions are:\r\nInstall the python libuser library on the remote host and use `libuser.admin().lookupGroupByName('developers')` instead of `grp.getgrnam('developers')` when `local: true`\r\nTest for local group existence using the libuser util `lid -g developers` on RedHat or `libuser-lid -g developers` on Debian.\r\nAccept a return code of `2` as success when `local: true`.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ngroup\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.7.10\r\n  config file = /Users/billym/.ansible.cfg\r\n  configured module search path = [u'/Users/billym/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.15 (default, Jan 12 2019, 21:07:57) [GCC 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nANSIBLE_PIPELINING(/Users/billym/.ansible.cfg) = True\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/Users/billym/.ansible.cfg) = [u'/Users/billym/tree/trunk/datacenter/config_mgmt/ansible/plugins/callback']\r\nDEFAULT_HOST_LIST(/Users/billym/.ansible.cfg) = [u'/Users/billym/tree/trunk/datacenter/config_mgmt/ansible/hosts']\r\nDEFAULT_LOG_PATH(/Users/billym/.ansible.cfg) = /Users/billym/.ansible/ansible.log\r\nDEFAULT_LOOKUP_PLUGIN_PATH(/Users/billym/.ansible.cfg) = [u'/Users/billym/tree/trunk/datacenter/config_mgmt/ansible/plugins/lookup']\r\nDEFAULT_MANAGED_STR(/Users/billym/.ansible.cfg) = Do not manually edit this file!  This file is managed by Ansible.  Make all changes in the appropriate Ansible template, then push the changes.  If you do not follow this procedure, your changes will be overwritten on the next push!\r\nDISPLAY_SKIPPED_HOSTS(/Users/billym/.ansible.cfg) = False\r\nHOST_KEY_CHECKING(/Users/billym/.ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/Users/billym/.ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/Users/billym/.ansible.cfg) = /Users/billym/.ansible-retry\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nTarget server is Debian 9.9, kernel 4.9.0-8-amd64\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nCreate LDAP group, `developers` cn=developers,ou=group,dc=example,dc=com\r\nDo NOT create any group locally.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```\r\n      - name: Delete group\r\n        group:\r\n          name: 'developers'\r\n          state: absent\r\n          local: true\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nI would expect that the task would report `ok` because nothing was changed.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\nfailed: [ldap-sam0-0001] (item=developers) => {\"changed\": false, \"item\": \"developers\", \"msg\": \"Group developers does not exist.\\n\", \"name\": \"developers\"}\r\n```\r\n",
        "created_at": "2019-05-16T00:08:16Z",
        "user": "reshippie",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "system"
        ]
    },
    {
        "number": 56345,
        "title": "`ignore_errors: {{ ansible_check_mode }}` is always true",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nWhen having a task which uses `ignore_errors: {{ ansible_check_mode }}` and the task results in an exception the error is always ignored. \r\nThis is especially bad when running in non-check mode.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ntask_executor\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.7.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/cedric/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/cedric/test/venv/lib/python2.7/site-packages/ansible\r\n  executable location = /home/cedric/test/venv/bin/ansible\r\n  python version = 2.7.5 (default, Apr 11 2018, 07:36:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nnothing\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: bug on ignore_errors and ansible_check_mode\r\n  hosts: localhost\r\n  gather_facts: false\r\n\r\n  tasks:\r\n    - debug:\r\n        var: ansible_check_mode\r\n\r\n    - debug:\r\n        msg: \"foo = {{ foo }}\"\r\n      when: foo\r\n      ignore_errors: \"{{ ansible_check_mode }}\"\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nIgnore errors only in the check mode, as indicated in the documentation https://docs.ansible.com/ansible/latest/user_guide/playbooks_checkmode.html?information-about-check-mode-in-variables#information-about-check-mode-in-variables\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n(venv) cedric@jacksbastion ~/test $ ansible-playbook test.yml -vv\r\nansible-playbook 2.7.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/cedric/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/cedric/test/venv/lib/python2.7/site-packages/ansible\r\n  executable location = /home/cedric/test/venv/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Apr 11 2018, 07:36:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\n\r\nPLAYBOOK: test.yml *****************************************************************************************************************************************************************************************\r\n1 plays in test.yml\r\n\r\nPLAY [bug on ignore_errors and ansible_check_mode] *********************************************************************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [debug] ***********************************************************************************************************************************************************************************************\r\ntask path: /home/cedric/test/test.yml:6\r\nok: [localhost] => {\r\n    \"ansible_check_mode\": false\r\n}\r\n\r\nTASK [debug] ***********************************************************************************************************************************************************************************************\r\ntask path: /home/cedric/test/test.yml:9\r\nfatal: [localhost]: FAILED! => {\"msg\": \"The conditional check 'foo' failed. The error was: error while evaluating conditional (foo): 'foo' is undefined\\n\\nThe error appears to have been in '/home/cedric/test/test.yml': line 9, column 7, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n\\n    - debug:\\n      ^ here\\n\"}\r\n...ignoring\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0\r\n```\r\nThe `foo` variable is undefined but the play ignores the error `...ignoring`\r\n\r\n",
        "created_at": "2019-05-13T09:02:13Z",
        "user": "cdelgehier",
        "labels": [
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "data_tagging"
        ]
    },
    {
        "number": 56265,
        "title": "When host becomes unreachable any_errors_fatal aborts the play but max_fail_percentage=0 continues",
        "body": "##### SUMMARY\r\nWhen a host becomes unreachable with `any_errors_fatal=true` the play aborts. However, the same situation with `max_fail_percentage=0` makes the play continue with the remaining host(s).\r\nThe documentation section [Aborting the play](https://docs.ansible.com/ansible/latest/user_guide/playbooks_error_handling.html#aborting-the-play) suggests that both settings should behave in a similar way.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nany_errors_fatal\r\nmax_fail_percentage\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.10\r\n  config file = /home/jjautz/src/git/1und1/deleng/systems/elog/ansible.cfg\r\n  configured module search path = [u'/home/jjautz/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/jjautz/.venv/ansible2710/local/lib/python2.7/site-packages/ansible\r\n  executable location = /home/jjautz/.venv/ansible2710/bin/ansible\r\n  python version = 2.7.16 (default, Mar  4 2019, 15:29:09) [GCC 8.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_SSH_CONTROL_PATH(/home/jjautz/src/git/1und1/deleng/systems/elog/ansible.cfg) = %(directory)s/%%h-%%r\r\nDEFAULT_ROLES_PATH(/home/jjautz/src/git/1und1/deleng/systems/elog/ansible.cfg) = [u'/home/jjautz/src/git/1und1/deleng/systems/elog/external_roles']\r\nDEFAULT_STDOUT_CALLBACK(/home/jjautz/src/git/1und1/deleng/systems/elog/ansible.cfg) = yaml\r\nHOST_KEY_CHECKING(/home/jjautz/src/git/1und1/deleng/systems/elog/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(env: ANSIBLE_RETRY_FILES_ENABLED) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n- controller: Debian GNU/Linux buster (testing)\r\n- managed hosts: Debian GNU/Linux 9.9 (stretch)\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdapt the host names in the inventory list below, pick one that is reachable, and one that is unreachable. In my example node 02 has been shut down:\r\n```\r\nansible-playbook -i elog-dev01.server.lan,elog-dev02.server.lan site.yml\r\n```\r\nIn site.yml uncomment either max_fail_percentage or any_errors_fatal to see the different behaviour:\r\n```yaml\r\n- hosts: all\r\n  gather_facts: false\r\n\r\n  # this continues when any managed host is unreachable:\r\n  #max_fail_percentage: 0\r\n\r\n  # this aborts when any managed host is unreachable:\r\n  #any_errors_fatal: true\r\n\r\n  tasks:\r\n    - name: Task1, expected to fail on the second node\r\n      command: echo Task 1 on {{ inventory_hostname_short }}\r\n\r\n    - name: Task2, expected not to be run at all, the play should abort after the previous error\r\n      command: echo Task 2 on {{ inventory_hostname_short }}\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nWith any_errors_fatal the result is as expected (it looks like feature request #18782 has been implemented and could be resolved?).\r\nI would expect max_fail_percentage to work in the same way any_errors_fatal works, resulting in \"no more hosts left\":\r\n```\r\nPLAY [all] ******************************************************************************************************************************************************************************\r\n\r\nTASK [Task1, expected to fail on the second node] ***************************************************************************************************************************************\r\nchanged: [elog-dev01.server.lan]\r\nfatal: [elog-dev02.server.lan]: UNREACHABLE! => changed=false \r\n  msg: 'Failed to connect to the host via ssh: ssh: connect to host elog-dev02.server.lan port 22: Connection timed out'\r\n  unreachable: true\r\n\r\nNO MORE HOSTS LEFT **********************************************************************************************************************************************************************\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************************\r\nelog-dev01.server.lan      : ok=1    changed=1    unreachable=0    failed=0   \r\nelog-dev02.server.lan      : ok=0    changed=0    unreachable=1    failed=0\r\n```\r\n\r\n\r\n##### ACTUAL RESULTS\r\nWith max_fail_percentage set to zero (or one, does no matter), the second task is run on node 01 after the first task has failed on node 02:\r\n\r\n```\r\nPLAY [all] ******************************************************************************************************************************************************************************\r\n\r\nTASK [Task1, expected to fail on the second node] ***************************************************************************************************************************************\r\nchanged: [elog-dev01.server.lan]\r\nfatal: [elog-dev02.server.lan]: UNREACHABLE! => changed=false \r\n  msg: 'Failed to connect to the host via ssh: ssh: connect to host elog-dev02.server.lan port 22: Connection timed out'\r\n  unreachable: true\r\n\r\nTASK [Task2, expected not to be run at all, the play should abort after the previous error] *********************************************************************************************\r\nchanged: [elog-dev01.server.lan]\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************************\r\nelog-dev01.server.lan      : ok=2    changed=2    unreachable=0    failed=0   \r\nelog-dev02.server.lan      : ok=0    changed=0    unreachable=1    failed=0\r\n```\r\n",
        "created_at": "2019-05-09T13:04:15Z",
        "user": "jautz",
        "labels": [
            "support:community",
            "bug",
            "affects_2.7",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 55669,
        "title": "Randomly receiving 'NoneType' object has no attribute 'name' after inventory refresh",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nI have a long playbook with multiple plays, where I multiple times refresh my inventory against google cloud right before running the next play.\r\nI randomly receive an error at exactly the same point on my playbook.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ninventory\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/albert/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.3 (default, Mar 26 2019, 21:43:19) [GCC 8.2.1 20181127]\r\n```\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nThe playbook would continue fine.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nParsed /workspace/inventory/prod-hosts inventory source with script plugin\r\nMETA: inventory successfully refreshed\r\nMETA: ran handlers\r\n\r\nPLAY [tag_green:&us-central1-a:!status_terminated:!tag_bake:&tag_browser] ***\r\nERROR! Unexpected Exception, this is probably a bug: 'NoneType' object has no attribute 'name'\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/ansible-playbook\", line 118, in <module>\r\n    exit_code = cli.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/ansible/cli/playbook.py\", line 122, in run\r\n    results = pbex.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/ansible/executor/playbook_executor.py\", line 156, in run\r\n    result = self._tqm.run(play=play)\r\n  File \"/usr/local/lib/python2.7/dist-packages/ansible/executor/task_queue_manager.py\", line 280, in run\r\n    iterator.mark_host_failed(host)\r\n  File \"/usr/local/lib/python2.7/dist-packages/ansible/executor/play_iterator.py\", line 481, in mark_host_failed\r\n    s = self.get_host_state(host)\r\n  File \"/usr/local/lib/python2.7/dist-packages/ansible/executor/play_iterator.py\", line 240, in get_host_state\r\n    if host.name not in self._host_states:\r\nAttributeError: 'NoneType' object has no attribute 'name'\r\n```\r\n\r\nI would like some help to debug it, as it's a random error, and probably really hard to reproduce on other environments.",
        "created_at": "2019-04-23T19:08:25Z",
        "user": "Tahvok",
        "labels": [
            "python3",
            "inventory",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "affects_2.7",
            "P3",
            "collection"
        ]
    },
    {
        "number": 55125,
        "title": "Copy module shows 'changed' in check mode",
        "body": "##### SUMMARY\r\nAs already described in closed issue #23955, the copy module reports \"changed\" in check mode, even though it does nothing when running normally. This bug occurs when target is a symlink.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ncopy module\r\n\r\n##### ANSIBLE VERSION\r\n```ansible-playbook 2.7.10\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/svs/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.7.3 (default, Mar 26 2019, 21:43:19) [GCC 8.2.1 20181127]\r\n```\r\n\r\nAlso tested with 2.7.9\r\n\r\n##### CONFIGURATION\r\nn/a\r\n\r\n##### OS / ENVIRONMENT\r\nLinux pacha.ndr.de 5.0.2-arch1-1-ARCH #1 SMP PREEMPT Thu Mar 14 18:47:49 UTC 2019 x86_64 GNU/Linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate symlink\r\n```\r\ncd /tmp\r\nln -s /tmp symlink\r\n```\r\nCreate dummy file .motd, run playbook.yml:\r\n```yaml\r\n- name: Test\r\n  hosts: localhost\r\n\r\n  tasks:\r\n    - name: Copy .motd to /tmp/symlink\r\n      copy:\r\n        src=\".motd\"\r\n        dest=/tmp/symlink\r\n```\r\n##### EXPECTED RESULTS\r\nFirst run of playbook.yml: File .motd is copied to /tmp/symlink\r\nSecond run of playbook.yml: No change is made because .motd does already exist in /tmp/symlink\r\nRun playbook.yml in check mode: No change is reported\r\n\r\n##### ACTUAL RESULTS\r\nFirst run of playbook.yml: File .motd is copied to /tmp/symlink\r\n```\r\n-> % ansible-playbook playbook.yml   \r\n[...]\r\nTASK [Copy .motd to /tmp/symlink] *************************************************\r\nchanged: [localhost]\r\n```\r\nSecond run of playbook.yml: No change is made because .motd does already exist in /tmp/symlink\r\n```\r\n-> % ansible-playbook playbook.yml  \r\n[...]\r\nTASK [Copy .motd to /tmp/symlink] *************************************************\r\nok: [localhost]\r\n```\r\nRun playbook.yml in check mode: Change **is** reported\r\n```\r\n-> % ansible-playbook playbook.yml -C\r\n[...]\r\nTASK [Copy .motd to /tmp/symlink] *************************************************\r\nchanged: [localhost]\r\n```\r\n\r\nWorkarounds are:\r\n* Add trailing slash to \"dest\":\r\n```\r\ndest=/tmp/symlink/\r\n```\r\ninstead of\r\n```\r\ndest=/tmp/symlink\r\n```\r\n* Don't use symlinks ;)",
        "created_at": "2019-04-11T07:01:50Z",
        "user": "muffl0n",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "files"
        ]
    },
    {
        "number": 55037,
        "title": "Set fact_path by variable",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\nPlease allow setting `fact_path` by a variable, e.g. `ansible_fact_path`, so it would be possible to make it dependent on client OS (or other attributes) and change implicit fact gathering accordingly.\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nsetup\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# group_vars/os-linux\r\nansible_fact_path: /etc/ansible/facts.d\r\n\r\n# group_vars/os-freebsd\r\nansible_fact_path: /usr/local/etc/ansible/facts.d\r\n```\r\nCurrently implicit gathering always uses fact path from control machine, unless manual setup task is used.\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2019-04-09T12:36:44Z",
        "user": "Vladimir-csp",
        "labels": [
            "module",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "system",
            "collection",
            "affects_2.11"
        ]
    },
    {
        "number": 54949,
        "title": "dnf: successful etckeeper commit causes successful package install to fail",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWhen etckeeper commits, dnf package installs (that are successfully installed) fail.\r\nIt may be due to the etckeeper output preceding dnf output?\r\n\r\nWorkarounds:\r\n1. in `/etc/etckeeper/etckeeper.conf`, set `GIT_OPTIONS=\"-q\"`\r\n   - This is suboptimal, because I generally want to see the git output when running `etckeeper commit` (and in the ansible logs, TBH)\r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ndnf module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.9\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['~/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.2 (default, Mar 21 2019, 10:09:12) [GCC 8.3.1 20190223 (Red Hat 8.3.1-2)]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n.\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n- Fedora 29\r\n- dnf: 4.2.2\r\n- etckeeper: 1.18.8\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n- Install etckeeper: `package: name=etckeeper`\r\n- Modify a file in /etc: ``echo \"TestTest\" | sudo tee /etc/README.md``\r\n- Install a package: `package: name=ctags-etags`\r\n- Error: \r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- package: name=etckeeper\r\n- command: etckeeper init\r\n- command: etckeeper commit \"Initial etckeeper commit by ansible\"\r\n```\r\n\r\n```bash\r\necho \"TestTest\" | sudo tee /etc/README.md\r\n```\r\n\r\n```yaml\r\n- package: name=ctags-etags\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n-  `package: name=ctags-etags` installs successfully\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n- `package: name=ctags-etags` does not install\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nfatal: [node1]: FAILED! => {\"changed\": false,\r\n\r\n \"module_stderr\":\r\n \"~/.ansible/tmp/ansible-tmp-1554590827.5738285-108733131594711/AnsiballZ_dnf.py:17:\r\n DeprecationWarning: the imp module is deprecated in favour of\r\n importlib; see the module's documentation for alternative uses\\n\r\n import imp\\n\",\r\n\r\n \"module_stdout\": \"[master 2151996] saving uncommitted changes in /etc\r\n prior to dnf run\\n Author: Wes Turner <~>\\n 1 file changed, 1\r\n insertion(+)\\n\\n{\\\"msg\\\": \\\"Nothing to do\\\", \\\"changed\\\": false,\r\n \\\"results\\\": [\\\"Installed: libX11-xcb\\\", \\\"Installed: which\\\"], \\\"rc\\\":\r\n 0, \\\"invocation\\\": {\\\"module_args\\\": {\\\"name\\\": [\\\"libX11-xcb\\\",\r\n \\\"which\\\"], \\\"state\\\": \\\"present\\\", \\\"allow_downgrade\\\": false,\r\n \\\"autoremove\\\": false, \\\"bugfix\\\": false, \\\"disable_gpg_check\\\": false,\r\n \\\"disable_plugin\\\": [], \\\"disablerepo\\\": [], \\\"download_only\\\": false,\r\n \\\"enable_plugin\\\": [], \\\"enablerepo\\\": [], \\\"exclude\\\": [],\r\n \\\"installroot\\\": \\\"/\\\", \\\"install_repoquery\\\": true, \\\"security\\\":\r\n false, \\\"skip_broken\\\": false, \\\"update_cache\\\": false,\r\n \\\"update_only\\\": false, \\\"validate_certs\\\": true, \\\"conf_file\\\": null,\r\n \\\"disable_excludes\\\": null, \\\"list\\\": null, \\\"releasever\\\": null}}}\\n\",\r\n \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\":\r\n 0}\r\n\r\n```\r\n",
        "created_at": "2019-04-06T23:29:55Z",
        "user": "westurner",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3",
            "verified",
            "packaging"
        ]
    },
    {
        "number": 54721,
        "title": "Multiple 'set-cookie' python 3",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nThe module `uri` don't return the same numbers of `set-cookie` depending of the python version.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nuri\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.9\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/lunik/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/lunik/role_api/venv/lib/python3.5/site-packages/ansible\r\n  executable location = /home/lunik/role_api/venv/bin/ansible\r\n  python version = 3.5.2 (default, Nov 12 2018, 13:43:14) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nI have a API wich return multiple Cookies when making a POST request to authenticate. And I'm trying to save thoses specific cookie in an ansible fact.\r\n\r\nI'm using the `uri` module \r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: \"Auth | Authenticate \"\r\n  uri:\r\n    url: \"{{ api_url }}/login\"\r\n    method: POST\r\n    body:\r\n      username: \"{{ api_username }}\"\r\n      password: \"{{ api_password }}\"\r\n    body_format: form-urlencoded\r\n    follow_redirects: none\r\n    status_code: 302\r\n  register: login\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nI should receiv two cookie with the HTTP header 'set-cookie'.\r\nIt's the case with python 2.7 but it's not the case in python 3.5\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nIn python 2.7 I'm getting the two cookies in attribute `set_cookie`, but not in python 3.5\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\nWith Python 2.7\r\n```paste below\r\nok: [localhost] => {\r\n    \"cache_control\": \"no-cache\",\r\n    \"changed\": false,\r\n    \"connection\": \"close\",\r\n    \"content_length\": \"424\",\r\n    \"content_type\": \"text/html; charset=UTF-8\",\r\n    \"date\": \"Tue, 02 Apr 2019 11:51:20 GMT\",\r\n    \"invocation\": { [...] },\r\n    \"location\": \"http://myapi.com/\",\r\n    \"msg\": \"HTTP Error 302: Found\",\r\n    \"redirected\": false,\r\n    \"server\": \"Apache/2.4.6 (CentOS) PHP/5.6.40\",\r\n    \"set_cookie\": \"PHPSESSID=2b15irrkvg495sgke3l19mqn22; path=/; HttpOnly, REMEMBERME=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; httponly\",\r\n    \"status\": 302,\r\n    \"url\": \"http://myapi.com/login\",\r\n    \"x_powered_by\": \"PHP/5.6.40\"\r\n}\r\n```\r\n\r\nWith Python 3.5\r\n```paste below\r\nok: [localhost] => {\r\n    \"cache_control\": \"no-cache\",\r\n    \"changed\": false,\r\n    \"connection\": \"close\",\r\n    \"content_length\": \"424\",\r\n    \"content_type\": \"text/html; charset=UTF-8\",\r\n    \"date\": \"Tue, 02 Apr 2019 11:55:21 GMT\",\r\n    \"invocation\": { [...] },\r\n    \"location\": \"http://myapi.com/\",\r\n    \"msg\": \"HTTP Error 302: Found\",\r\n    \"redirected\": false,\r\n    \"server\": \"Apache/2.4.6 (CentOS) PHP/5.6.40\",\r\n    \"set_cookie\": \"REMEMBERME=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; httponly\",\r\n    \"status\": 302,\r\n    \"url\": \"http://myapi.com/login\",\r\n    \"x_powered_by\": \"PHP/5.6.40\"\r\n}\r\n```\r\n\r\nWith curl\r\n```\r\n(venv) ~/role_api \u276f\u276f\u276f curl -v  -X POST --data \"username=user&password=pass123\" http://myapi.com/login\r\n*   Trying 10.24.209.129...\r\n* Connected to myapi.com (127.0.0.1) port 80 (#0)\r\n> POST /login HTTP/1.1\r\n> Host: myapi.com\r\n> User-Agent: curl/7.47.0\r\n> Accept: */*\r\n> Cookie: PHPSESSID=63581ocu43slf3c893aggflcf5;\r\n> Content-Length: 87\r\n> Content-Type: application/x-www-form-urlencoded\r\n>\r\n* upload completely sent off: 87 out of 87 bytes\r\n< HTTP/1.1 302 Found\r\n< Date: Tue, 02 Apr 2019 12:14:52 GMT\r\n< Server: Apache/2.4.6 (CentOS) PHP/5.6.40\r\n< X-Powered-By: PHP/5.6.40\r\n< Set-Cookie: PHPSESSID=jllttvi5pb3er9on68tevv52i2; path=/; HttpOnly\r\n< Cache-Control: no-cache\r\n< Location: http://myapi.com/\r\n< Set-Cookie: REMEMBERME=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/; httponly\r\n< Content-Length: 444\r\n< Content-Type: text/html; charset=UTF-8\r\n<\r\n<!DOCTYPE html>\r\n[...]\r\n```",
        "created_at": "2019-04-02T12:21:10Z",
        "user": "Lunik",
        "labels": [
            "python3",
            "module",
            "net_tools",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3"
        ]
    },
    {
        "number": 54412,
        "title": "Do not produce a warning when setting errors='ignore' in lookup()",
        "body": "##### SUMMARY\r\nThe lookup plugin has an option `errors` which can be either `strict`, `warn` or `ignore`  \r\nBut `warn` produces 2 warnings per error and `ignore` produces one as demonstrated in the documentation : https://docs.ansible.com/ansible/latest/plugins/lookup.html#id5\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nLookup plugins\r\n\r\n##### ADDITIONAL INFORMATION\r\nHave one meaningful warning per lookup use when using `warn` and none when using `ignore`\r\n\r\n`warn`\r\n```\r\n- name: file doesnt exist, but i dont care .. file plugin itself warns anyways ...\r\n  debug: msg=\"{{ lookup('file', '/idontexist', errors='ignore') }}\"\r\n\r\n[WARNING]: Unable to find '/idontexist' in expected paths (use -vvvvv to see paths)\r\n\r\nok: [localhost] => {\r\n    \"msg\": \"\"\r\n}\r\n```\r\n\r\n`ignore` : \r\n```\r\n- name: file doesnt exist, but i dont care .. file plugin itself warns anyways ...\r\n  debug: msg=\"{{ lookup('file', '/idontexist', errors='ignore') }}\"\r\n\r\nok: [localhost] => {\r\n    \"msg\": \"\"\r\n}\r\n```\r\n\r\n##### CONTEXT\r\nI want to copy the content of files whose name match one of the groups of the current host, so I loop over the host's groups but I get a warning every time the file doesn't exist\r\n```yaml\r\n- blockinfile:\r\n      path: /my/file\r\n      marker: \"# {mark} {{ group }}\"\r\n      #block: \"{{ lookup('template', group~'.j2', errors='ignore') }}\"\r\n      block: \"{{ lookup('template', group~'.j2', errors='warn') }}\"\r\n    loop: \"{{ group_names }}\"\r\n    loop_control:\r\n      loop_var: group\r\n```\r\n\r\nI can't split it in a `local_action: stat` loop'd + `blockinfile` over the register because the playbook repository path is unpredictable in my context...",
        "created_at": "2019-03-26T16:49:24Z",
        "user": "mveroone",
        "labels": [
            "support:core",
            "feature",
            "affects_2.15",
            "affects_2.16"
        ]
    },
    {
        "number": 54403,
        "title": "apt_repository modify comment line /etc/apt/sources.list",
        "body": "##### SUMMARY\r\napt_repository rewrite line in /etc/apt/sources.list even if we specify another filename. It's break idempotent when we use templating for /etc/apt/sources.list\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\napt_repository\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.5.44\r\n\r\n```\r\n##### STEPS TO REPRODUCE\r\n\r\n```\r\n- name: Deploy sources.list\r\n  template:\r\n    src: etc/apt/sources.list.j2\r\n    dest: /etc/apt/sources.list\r\n    owner: root\r\n    group: root\r\n    mode: 0644\r\n  notify: update apt_repo\r\n\r\n- name: debug file before calling apt_repository\r\n  debug:\r\n    msg: \"{{lookup('file', '/etc/apt/sources.list') }}\"\r\n\r\n- name: Deploy docker-ce repo\r\n  apt_repository:\r\n    repo: deb [arch=amd64] https://download.docker.com/linux/ubuntu  xenial stable\r\n    state: present\r\n    filename: docker-ce\r\n\r\n- name: debug file after calling apt_repository\r\n  debug:\r\n    msg: \"{{lookup('file', '/etc/apt/sources.list') }}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nNo modification of source.lists\r\n\r\n\r\n##### ACTUAL RESULTS\r\nFirst line of sources.list habe been modified, see the spaces added on the first line after the \"#\" in debug:\r\n\r\n```\r\nPLAY [localhost] *********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [orange.thisrole : Deploy sources.list] *****************************************************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"checksum\": \"8753d6da90963e923698cefba95416a6a8be484a\", \"dest\": \"/etc/apt/sources.list\", \"gid\": 0, \"group\": \"root\", \"md5sum\": \"8c4152a2f9b6d43bd9da4c59d31c86c8\", \"mode\": \"0644\", \"owner\": \"root\", \"size\": 534, \"src\": \"/root/.ansible/tmp/ansible-tmp-1553610857.34-86430352605538/source\", \"state\": \"file\", \"uid\": 0}\r\n\r\nTASK [orange.thisrole : debug file before calling apt_repository] ********************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"## File managed by ansible, do not edit by hands\\n\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial main restricted universe multiverse\\n\\n###### Ubuntu Update Repos\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-security main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-updates main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-proposed main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-backports main restricted universe multiverse\"\r\n}\r\n\r\nTASK [orange.thisrole : Deploy docker-ce repo] ***************************************************************************************************\r\nchanged: [localhost] => {\"changed\": true, \"repo\": \"deb [arch=amd64] https://download.docker.com/linux/ubuntu  xenial stable\", \"state\": \"present\"}\r\n\r\nTASK [orange.thisrole : debug file after calling apt_repository] *********************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"# # File managed by ansible, do not edit by hands\\n\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial main restricted universe multiverse\\n\\n# ##### Ubuntu Update Repos\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-security main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-updates main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-proposed main restricted universe multiverse\\ndeb http://fr.archive.ubuntu.com/ubuntu/ xenial-backports main restricted universe multiverse\"\r\n}\r\n\r\nRUNNING HANDLER [orange.thisrole : update apt_repo] **********************************************************************************************\r\nchanged: [localhost] => {\"cache_update_time\": 1553610945, \"cache_updated\": true, \"changed\": true}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************\r\nlocalhost                  : ok=6    changed=3    unreachable=0    failed=0\r\n\r\n```\r\n",
        "created_at": "2019-03-26T14:42:26Z",
        "user": "DarkStar1973",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "packaging"
        ]
    },
    {
        "number": 54274,
        "title": "Unexpected interpolation of env var in role name",
        "body": "##### SUMMARY\r\nAn env var reference (or something that looks like one) in a role name will be interpolated. This is unexpected behavior. It appears that this is happening in `unfrackpath()` when `os.path.expandvars()` is called.\r\n\r\nThis issue was discovered when I accidentally called ansible with `-e 'service=$SERVICE'` (single quotes, so no interpolation by the shell), and then `{{ service }}` was used as the `name` parameter to `include_role`.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nrole loader and/or unfrackpath\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```\r\nansible 2.8.0.dev0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/agaffney/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/agaffney/dev/misc/ansible/lib/ansible\r\n  executable location = /home/agaffney/dev/misc/ansible/bin/ansible\r\n  python version = 2.7.12 (default, Nov 12 2018, 14:36:49) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n`foo.yml`:\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: no\r\n  vars:\r\n    role_name: $ROLE_NAME\r\n  tasks:\r\n    - include_role:\r\n        name: '{{ role_name }}'\r\n\r\n```\r\n\r\n`roles/test1/tasks/main.yml`:\r\n```yaml\r\n- name: debug task\r\n  debug:\r\n    msg: in test1 role\r\n```\r\n\r\nCommand:\r\n```\r\n$ ROLE_NAME=test1 ansible-playbook foo.yml\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nNOTE: this is what the output currently looks like when the env var does not resolve to a valid role name or when the env var does not exist.\r\n\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\n$ ROLE_NAME=test1 ansible-playbook foo.yml\r\n\r\nPLAY [localhost] ****************************************************************************************************************************************************************\r\n\r\nTASK [include_role : {{ role_name }}] *******************************************************************************************************************************************\r\nERROR! the role '$ROLE_NAME' was not found in /tmp/ansible_test/role_env_var/roles:/home/agaffney/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/tmp/ansible_test/role_env_var\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************\r\n\r\n```\r\n##### ACTUAL RESULTS\r\n```\r\n$ ROLE_NAME=test1 ansible-playbook foo.yml\r\n\r\nPLAY [localhost] ****************************************************************************************************************************************************************\r\n\r\nTASK [include_role : {{ role_name }}] *******************************************************************************************************************************************\r\n\r\nTASK [$ROLE_NAME : debug task] **************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"in test1 role\"\r\n}\r\n\r\nPLAY RECAP **********************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n```\r\n",
        "created_at": "2019-03-23T00:05:52Z",
        "user": "agaffney",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 53215,
        "title": "Endianless Linux BIOS UUID for use by VMware modules",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\n\r\nAdd a new Ansible fact that reports Linux PC BIOS UUIDs without byte swapping.\r\n\r\nThis could be a VMware guest specific fact called `ansible_product_uuid_vmware` derived from the DMI serial number or it could be a general purpose fact called `ansible_product_uuid_endianless` derived from `/sys/firmware/dmi/entries/1-0/raw`. \r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n\r\nsetup\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\nFor Linux VMware guests created with hardware version 13 or greater (ESXi 6.5+) the fact `ansible_product_uuid` no longer works to identify guests when used in the `uuid` parameter of Ansible VMware modules such as `vmware_guest`. \r\n\r\nThe reason for this is that VMware have updated the version of SMBIOS being used and this triggers a code path in the dmidecode program that byte swaps half of the UUID when the UUID is converted to its human readable text representation. Unfortunately it's the human readable text representation that is used by the VMware API. This is described in https://kb.vmware.com/s/article/53609\r\n\r\n1. On VMware guests, the BIOS UUID is also present in the DMI serial number field, but without any endian issues. We can reliable parse that into a VMware specific fact.\r\n1. We can directly parse `/sys/firmware/dmi/entries/1-0/raw` into a generic endianless UUID fact.\r\n\r\nHere is some smaple code that could be added to the end of the `get_dmi_facts()` function in lib/ansible/module_utils/facts/hardware/linux.py to suplement the DMI facts with the information needed by the VMware modules.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```python\r\nif os.path.exists('/sys/firmware/dmi/entries/1-0/raw'):\r\n    data = get_file_content('/sys/firmware/dmi/entries/1-0/raw')\r\n    dmi_facts['product_uuid_endianless'] = \"%08X-%04X-%04X-%04X-%04X%08X\" % struct.unpack(\">LHHHHL\", data[8:24])\r\n\r\nif 'product_serial' in dmi_facts and re.match('VMware((?:[- ][0-9a-f][0-9a-f]){16})$', dmi_facts['product_serial']):\r\n    raw = string.upper(string.replace(dmi_facts['product_serial'][7:], ' ', ''))\r\n    dmi_facts['product_uuid_vmware'] = \"%s-%s-%s-%s\" % (raw[0:8], raw[8:12], raw[12:21], raw[21:33])\r\n\r\n```\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2019-03-02T23:48:05Z",
        "user": "lparkes",
        "labels": [
            "module",
            "support:core",
            "feature",
            "affects_2.8",
            "P3",
            "system"
        ]
    },
    {
        "number": 52651,
        "title": "known_host module fails tryin to install a @cert-authority key using an IP as name",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nTrying to insert a @cert-authority line fails if I use an IP\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\nknown_hosts\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.5.1\r\n  config file = /home/xxx/ansible/ansible.cfg\r\n  configured module search path = [u'/home/xxx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.15rc1 (default, Nov 12 2018, 14:31:15) [GCC 7.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_NOCOWS(/home/xxx/ansible/ansible.cfg) = True\r\nDEFAULT_FILTER_PLUGIN_PATH(/home/xxx/ansible/ansible.cfg) = [u'/home/xxx/ansible/filter_plugins']\r\nDEFAULT_HOST_LIST(/home/xxx/ansible/ansible.cfg) = [u'/home/xxx/ansible/hosts']\r\nDEFAULT_ROLES_PATH(/home/xxx/ansible/ansible.cfg) = [u'/home/xxx/ansible/roles']\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nUbuntu 18.04.2 LTS, Mate desktop\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\nJust use a task like the one on the example below, and it fails.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\nvars:\r\n  ssh_ca_pub_key: \"{{lookup('file', 'my_ssh_ca_file.pub')}}\"\r\ntasks:\r\n\r\n  - name: Add SSH CA for 192.168.42.18 to known_hosts\r\n    known_hosts:\r\n      name: '@cert-authority 192.168.42.18'\r\n      key: \"@cert-authority  192.168.42.18 {{ssh_ca_pub_key}}\"\r\n\r\n```\r\nGives:\r\n\r\n```\r\nTASK [Add SSH CA for 192.168.42.18 to known_hosts] *****************************\r\nfatal: [192.168.77.7]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/ssh-keygen -F '' -f /tmp/tmpZn4ZLH\", \"msg\": \"\", \"rc\": 1, \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"\", \"stdout_lines\": []}\r\n```\t\r\n\r\nNote, if I run instead:\r\n\r\n```yaml\r\nvars:\r\n  ssh_ca_pub_key: \"{{lookup('file', 'my_ssh_ca_file.pub')}}\"\r\ntasks:\r\n\r\n  - name: Add SSH CA for *.truelite.it to known_hosts\r\n    known_hosts:\r\n      name: '@cert-authority *.truelite.it'\r\n      key: \"@cert-authority  *.truelite.it {{ssh_ca_pub_key}}\"\r\n\r\n```\r\n\r\nit works fine:\r\n\r\n```\r\nTASK [Add SSH CA for *.truelite.it to known_hosts] *****************************\r\nchanged: [192.168.77.7]\r\n```\r\n\r\nand in the .ssh/known host I got the correct line\r\n\r\n```\r\n@cert-authority  *.truelite.it ssh-rsa AAAAB3NzaC...\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\nIt should just create the correct line, now I'm forced to get it the line using:\r\n\r\n```yaml\r\n - name: Add SSH CA for 192.168.42.18 to known_hosts\r\n   lineinfile:\r\n     path: /root/.ssh/known_hosts\r\n     line: \"@cert-authority 192.168.42.18 {{ssh_ca_pub_key}}\"\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nIt fails, below the error with -vvvv.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n...\r\nfatal: [192.168.77.7]: FAILED! => {\r\n    \"changed\": false, \r\n    \"cmd\": \"/usr/bin/ssh-keygen -F '' -f /tmp/tmpcMVWP9\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"hash_host\": false, \r\n            \"key\": \"@cert-authority  192.168.42.18 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDhS69JFW+P+IV6WaYiBpfSLqUNx/n9HdS4ZAlhPIt4bebKO/lCzBE7UKy6ZHMFhgYxLSf4eU8XP8zIQUyqabvh9w9+qWkd6rlbA88jHDmkOrguzQG2zXLooIiDfA0htaFv7PLpmQstniZAN9rlAy0isLGdQQJUX1SQFNpQmRfSgcZrgPJQPGmMumz+N24vWB3Uh2sE59aAxSAXfQ2a25og9gfxcJ8jOJGCS5RtffhI/mpc29AxTSmIpaHyEiA9Kyi83XlgBN6Wz/pxZguG3z8f0yBofSn9S2b8gBo7Eaugpf/HWJGStchvzRvEa7i6YKBXra9H8/yXR4Ay6AjZcRwF CA for matheria.it\", \r\n            \"name\": \"@cert-authority 192.168.42.18\", \r\n            \"path\": \"/root/.ssh/known_hosts\", \r\n            \"state\": \"present\"\r\n        }\r\n    }, \r\n    \"msg\": \"\", \r\n    \"rc\": 1, \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"\", \r\n    \"stdout_lines\": []\r\n}\r\n\r\n```\r\n",
        "created_at": "2019-02-20T14:35:03Z",
        "user": "piccardi",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 52026,
        "title": "The git module fails with the separate_git_dir option when the dest directory does not exist",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nRunning the `git` module with the `separate_git_dir` option fails and wipes out the contents of the bare repository if the `dest` directory does not exist but the `separate_git_dir` does. (It works fine when both the `separate_git_dir` and the `dest` directories do not exist, or when both already exist.)\r\n\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\ngit\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.6\r\n  config file = None\r\n  configured module search path = ['/Users/me/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/Cellar/ansible/2.7.6/libexec/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.2 (default, Jan 13 2019, 12:50:15) [Clang 10.0.0 (clang-1000.11.45.5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nI am testing this on virtual machines with Ubuntu Bionic 18.04 LTS.\r\n\r\n##### DEPENDENCY PROBLEMS\r\n<!--- If you're having problems with a Python library (e.g. you've installed a library but\r\nAnsible is still telling you it's missing) add a task to the failing playbook:\r\n\r\n```\r\n- python_requirements_facts:\r\n    dependencies:\r\n      - $PROBLEM_LIBRARY (e.g. openshift, boto3, etc.)\r\n```\r\n\r\n-->\r\n```paste below\r\n\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nUse the `git` module with the `separate_git_dir` option, when the `separate_git_dir` directory has already been cloned but the `dest` directory does not exist.\r\n\r\nThe following playbook will reproduce the problem if run twice on an Ubuntu 18.04 LTS system. (I have created a Vagrantfile to easily reproduce it [here](https://github.com/AlphaHydrae/ansible-separate-git-dir-bug)).\r\n\r\nSetting the `force` or `update` options does not change the behavior.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  become: true\r\n  gather_facts: no\r\n\r\n  tasks:\r\n\r\n    # Install Python (not present on Ubuntu 18.04 by default).\r\n    - raw: command -v python || { apt-get update && apt-get install -y python; }\r\n      changed_when: false\r\n\r\n    # Gather facts.\r\n    - setup:\r\n\r\n    - block:\r\n\r\n        # Clone ansible into a bare repository and checkout in a separate directory.\r\n        - git:\r\n            repo: https://github.com/ansible/ansible.git\r\n            dest: /tmp/checkout\r\n            #force: true\r\n            separate_git_dir: /tmp/repo\r\n            #update: true\r\n            version: devel\r\n\r\n        # There would be other tasks here using the temporary checkout directory...\r\n\r\n      always:\r\n\r\n        # Delete the checkout directory.\r\n        - file:\r\n            path: /tmp/checkout\r\n            state: absent\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nI expected that:\r\n\r\n* The bare repository indicated by `separate_git_dir` should not be modified (or should be updated if the `update` option is set).\r\n* The missing `dest` directory should be created and the correct version of the repository checked out in it.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n* The contents of the bare repository was deleted.\r\n* The `dest` directory was not created.\r\n* The task failed with the following error: `fatal: /path/to/separate_git_dir already exists`\r\n\r\nThe output below is the result of running the playbook through Vagrant with verbosity `-vvvv`.\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nTASK [git] *********************************************************************\r\ntask path: /Users/me/ansible-separate-git-dir-bug/playbook.yml:18\r\n<127.0.0.1> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<127.0.0.1> SSH: EXEC ssh -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 127.0.0.1 '/bin/sh -c '\"'\"'echo ~vagrant && sleep 0'\"'\"''\r\n<127.0.0.1> (0, b'/home/vagrant\\n', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<127.0.0.1> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<127.0.0.1> SSH: EXEC ssh -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 127.0.0.1 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600 `\" && echo ansible-tmp-1549892845.60197-203977266471600=\"` echo /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600 `\" ) && sleep 0'\"'\"''\r\n<127.0.0.1> (0, b'ansible-tmp-1549892845.60197-203977266471600=/home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600\\n', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nUsing module file /usr/local/Cellar/ansible/2.7.6/libexec/lib/python3.7/site-packages/ansible/modules/source_control/git.py\r\n<127.0.0.1> PUT /Users/me/.ansible/tmp/ansible-local-3273413qa0o4m/tmp6wvj1v9q TO /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/AnsiballZ_git.py\r\n<127.0.0.1> SSH: EXEC sftp -b - -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 '[127.0.0.1]'\r\n<127.0.0.1> (0, b'sftp> put /Users/me/.ansible/tmp/ansible-local-3273413qa0o4m/tmp6wvj1v9q /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/AnsiballZ_git.py\\n', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 3 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/vagrant size 0\\r\\ndebug3: Looking up /Users/me/.ansible/tmp/ansible-local-3273413qa0o4m/tmp6wvj1v9q\\r\\ndebug3: Sent message fd 3 T:17 I:2\\r\\ndebug3: Received stat reply T:101 I:2\\r\\ndebug1: Couldn\\'t stat remote file: No such file or directory\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/AnsiballZ_git.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:19316\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 19316 bytes at 65536\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<127.0.0.1> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<127.0.0.1> SSH: EXEC ssh -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 127.0.0.1 '/bin/sh -c '\"'\"'chmod u+x /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/ /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/AnsiballZ_git.py && sleep 0'\"'\"''\r\n<127.0.0.1> (0, b'', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<127.0.0.1> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<127.0.0.1> SSH: EXEC ssh -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 -tt 127.0.0.1 '/bin/sh -c '\"'\"'sudo -H -S -n -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-kilsslwepzbfyapybolqamsxjbpkhwba; /usr/bin/python /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/AnsiballZ_git.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\nEscalation succeeded\r\n<127.0.0.1> (1, b'\\r\\n{\"exception\": \"WARNING: The below traceback may *not* be related to the actual failure.\\\\n  File \\\\\"/tmp/ansible_git_payload_IswDQ8/__main__.py\\\\\", line 450, in clone\\\\n    os.makedirs(dest_dirname)\\\\n  File \\\\\"/usr/lib/python2.7/os.py\\\\\", line 157, in makedirs\\\\n    mkdir(name, mode)\\\\n\", \"stdout\": \"\", \"cmd\": \"/usr/bin/git clone --origin origin --separate-git-dir=/tmp/repo https://github.com/ansible/ansible.git /tmp/checkout\", \"failed\": true, \"stderr\": \"Cloning into \\'/tmp/checkout\\'...\\\\nfatal: /tmp/repo already exists\\\\n\", \"rc\": 128, \"invocation\": {\"module_args\": {\"depth\": null, \"executable\": null, \"force\": false, \"track_submodules\": false, \"reference\": null, \"dest\": \"/tmp/checkout\", \"recursive\": true, \"clone\": true, \"verify_commit\": false, \"update\": true, \"accept_hostkey\": false, \"ssh_opts\": null, \"repo\": \"https://github.com/ansible/ansible.git\", \"umask\": null, \"version\": \"devel\", \"bare\": false, \"remote\": \"origin\", \"key_file\": null, \"separate_git_dir\": \"/tmp/repo\", \"archive\": null, \"refspec\": null}}, \"msg\": \"Cloning into \\'/tmp/checkout\\'...\\\\nfatal: /tmp/repo already exists\"}\\r\\n', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 1\\r\\nShared connection to 127.0.0.1 closed.\\r\\n')\r\n<127.0.0.1> ESTABLISH SSH CONNECTION FOR USER: vagrant\r\n<127.0.0.1> SSH: EXEC ssh -vvv -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o Port=2200 -o 'IdentityFile=\"/Users/me/ansible-separate-git-dir-bug/.vagrant/machines/default/virtualbox/private_key\"' -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=30 -o ControlPath=/Users/me/.ansible/cp/17d6e21220 127.0.0.1 '/bin/sh -c '\"'\"'rm -f -r /home/vagrant/.ansible/tmp/ansible-tmp-1549892845.60197-203977266471600/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<127.0.0.1> (0, b'', b'OpenSSH_7.8p1, LibreSSL 2.6.2\\r\\ndebug1: Reading configuration data /Users/me/.ssh/config\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 48: Applying options for *\\r\\ndebug2: resolve_canonicalize: hostname 127.0.0.1 is address\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 32482\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\nThe full traceback is:\r\nWARNING: The below traceback may *not* be related to the actual failure.\r\n  File \"/tmp/ansible_git_payload_IswDQ8/__main__.py\", line 450, in clone\r\n    os.makedirs(dest_dirname)\r\n  File \"/usr/lib/python2.7/os.py\", line 157, in makedirs\r\n    mkdir(name, mode)\r\nfatal: [default]: FAILED! => {\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/bin/git clone --origin origin --separate-git-dir=/tmp/repo https://github.com/ansible/ansible.git /tmp/checkout\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"accept_hostkey\": false,\r\n            \"archive\": null,\r\n            \"bare\": false,\r\n            \"clone\": true,\r\n            \"depth\": null,\r\n            \"dest\": \"/tmp/checkout\",\r\n            \"executable\": null,\r\n            \"force\": false,\r\n            \"key_file\": null,\r\n            \"recursive\": true,\r\n            \"reference\": null,\r\n            \"refspec\": null,\r\n            \"remote\": \"origin\",\r\n            \"repo\": \"https://github.com/ansible/ansible.git\",\r\n            \"separate_git_dir\": \"/tmp/repo\",\r\n            \"ssh_opts\": null,\r\n            \"track_submodules\": false,\r\n            \"umask\": null,\r\n            \"update\": true,\r\n            \"verify_commit\": false,\r\n            \"version\": \"devel\"\r\n        }\r\n    },\r\n    \"msg\": \"Cloning into '/tmp/checkout'...\\nfatal: /tmp/repo already exists\",\r\n    \"rc\": 128,\r\n    \"stderr\": \"Cloning into '/tmp/checkout'...\\nfatal: /tmp/repo already exists\\n\",\r\n    \"stderr_lines\": [\r\n        \"Cloning into '/tmp/checkout'...\",\r\n        \"fatal: /tmp/repo already exists\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n```\r\n\r\nFYI, what I am trying to do is perform a temporary checkout in a directory, run a build, then delete the checked out files because I do not need them taking up space on the server except when it's building. I expect this to work the first time (the repo needs to be cloned and the checkout performed), and also on subsequent runs of the playbook (the repo has already been cloned but the checkout directory has been deleted).\r\n\r\nI know I can do it with two tasks, but I expected to be able to do it with one from reading the documentation. Even if doing it with one task is not supported, the current behavior is not ideal.",
        "created_at": "2019-02-11T14:00:23Z",
        "user": "AlphaHydrae",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "traceback",
            "affects_2.7",
            "needs_verified",
            "source_control"
        ]
    },
    {
        "number": 51988,
        "title": "[module: cron] Add option to change cron name without duplicate",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nProvide a safer and/or more automatic way to change the unique `name` parameter of a cron task without getting a duplicate crontab entry.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nmodule: cron\r\n\r\n##### ADDITIONAL INFORMATION\r\nI understand that if you change the `name` parameter of an Ansible cron task, you get a new entry in the crontab. However, there are many legitimate reasons why someone may want to change a `name` parameter _without_ getting a new entry:\r\n* To fix a typo in `name`\r\n* To update or better describe what the job actually does\r\n* Because they don't understand the implications of changing it\r\n\r\nRegardless of the reason, getting a duplicate cron entry can sometimes have disastrous results, and I think there should be a way to avoid it.\r\n\r\nI propose a couple options to achieve a safer and/or more automatic way to change the `name` parameter of a cron task. They are based on the assumption that the module knows about all the crons in the crontab, and can distinguish if they are identical or not.\r\n\r\n1. Add a new parameter to the cron module, e.g. `unique` or `duplicate_policy`. This could either be a bool, or a 3-way switch with possible values \"error\", \"warn\", and \"delete\". Then, if true (or \"delete\"), it would delete any orphaned entries in the crontab that _exactly_ match the line that Ansible will be adding. This addition would be backwards-compatible.\r\n\r\n2. The same functionality as above, but done by default, without the addition of an option. This functionality would not be backwards-compatible, but would likely result in a safer default.\r\n\r\nAnsible already has the capacity to take ownership of orphaned cron jobs (e.g. see https://github.com/ansible/ansible-modules-core/issues/3256), and I think this would simply be another aspect of that. I think this would allow for greater safety to be baked into cron tasks.\r\n\r\nMany thanks to the community members who maintain this module!",
        "created_at": "2019-02-08T23:55:54Z",
        "user": "hemberger",
        "labels": [
            "module",
            "support:core",
            "feature",
            "affects_2.8",
            "P3",
            "system"
        ]
    },
    {
        "number": 51862,
        "title": "Ensure ansible-vault decrypt to stdout inserts newline before printing success message",
        "body": "##### SUMMARY\r\nOutput of 'ansible-vault decrypt' is in a different order depending of the decrypted string.\r\nAdditionally, it often blends with the following prompt.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nvault\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.6.8\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.6.6 (r266:84292, Aug  9 2016, 06:11:56) [GCC 4.4.7 20120313 (Red Hat 4.4.7-17)]\r\n```\r\n\r\n##### CONFIGURATION\r\nNot applicable.\r\n\r\n##### OS / ENVIRONMENT\r\nRHEL 6.10.\r\n\r\n##### DEPENDENCY PROBLEMS\r\nNot applicable.\r\n\r\n##### STEPS TO REPRODUCE\r\nFirst decrypt a string without a trailing newline (use vault password \"aa\"):\r\n\r\n```yaml\r\nuser@host:~> echo '$ANSIBLE_VAULT;1.1;AES256\r\n37653438373035346136643061373334313765343835313134343436356362373038623031636137\r\n6562613532373465313138326530623763393431656632370a643130393265323634303839373730\r\n65356533333763336361663039626465333137373965633230346638653964653938363437303662\r\n3834643566623333360a666462653631326263666364303262633665626638653630303063313331\r\n3962' | ansible-vault decrypt\r\nVault password:\r\nDecryption successful\r\naauser@host:~>\r\n```\r\n\r\nNotice the order here - first \"Decryption successful\", then the encrypted string. Also notice that the decrypted string blends with the prompt.\r\n\r\nNow decrypt a string with a trailing newline (use vault password \"aa\"):\r\n\r\n```\r\nuser@host:~> echo '$ANSIBLE_VAULT;1.1;AES256\r\n61393830656433393361646636373336653166323063623564373835666335346162646133333331\r\n6236613430333365363930343565643239336338393234330a376234643966396136646133633336\r\n39653362663230333831363136326133613036316538323634363063616535393239663933313034\r\n3436366666383039390a633837383138363837306161616432666132313563656665356439323933\r\n6231' | ansible-vault decrypt\r\nVault password:\r\naa\r\nDecryption successful\r\nuser@host:~>\r\n```\r\n\r\nNotice how the order now has the decrypted string first, \"Decryption successful\" later. There is also no blending with the prompt (because of the embedded newline).\r\n\r\n##### EXPECTED RESULTS\r\nOrder to be the same in both cases, and the output never to blend with the prompt.\r\n\r\nIt would be great if it could also warn about trailing newline being present - similar to how 'svn diff' mentions changes in the trailing newline. For example, output could be:\r\n\r\n```\r\n...| ansible-vault decrypt\r\nVault password:\r\naa\r\nWARNING: The encrypted string contains a trailing newline.\r\nDecryption successful\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nDescribed in the step section above.",
        "created_at": "2019-02-07T11:31:24Z",
        "user": "richlv",
        "labels": [
            "easyfix",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.13"
        ]
    },
    {
        "number": 51663,
        "title": "apt upgrade full raises a \"Could not get lock /var/lib/dpkg/lock-frontend\"",
        "body": "##### SUMMARY\r\n\r\nWhen trying to `apt: upgrade: full` frequently it errors with `\"Could not get lock /var/lib/dpkg/lock-frontend\"`. I already tried to delete the lock file before running upgrade, but it still raises the error. To fix it I just have to run `ansible-playbook` again and it usually works.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.6\r\n  config file = None\r\n  configured module search path = ['/Users/antoniocarlos/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/Cellar/ansible/2.7.6/libexec/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.2 (default, Feb  2 2019, 18:43:53) [Clang 10.0.0 (clang-1000.11.45.5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n<nothing is printed with this command>\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nAnsible environment\r\nmacOS 10.14\r\n\r\nTarget OS\r\nUbuntu 18.04\r\nIt's a new host, clean 18.04 install, and Ansible is the only thing installing packages on it.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n###### Delete the lock file\r\nI usually get a green on this one, meaning the file was not present:\r\n\r\n``` yaml\r\n- name: Remove apt lock file\r\n  file:\r\n    state: absent\r\n    path: \"/var/lib/dpkg/lock-frontend\"\r\n  become: true\r\n  tags: apt\r\n```\r\n\r\n###### Ugrade all packages\r\nThe one who fails \r\n\r\n``` yaml\r\n- name: Update all packages to the latest version\r\n  apt:\r\n    upgrade: full\r\n  become: true\r\n  tags: apt\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/3182864/52177249-368fed80-27a5-11e9-8844-07426452da38.png)\r\n\r\n```\r\nTASK [apt : Remove apt lock file] *******************************************************************************************************************************************\r\ntask path: /Users/antoniocarlos/code/xxxxxxx/xxxxxxxx/roles/apt/tasks/main.yml:61\r\nok: [xx.xxx.xxx.xx] => {\"changed\": false, \"path\": \"/var/lib/dpkg/lock-frontend\", \"state\": \"absent\"}\r\n\r\nTASK [apt : Update all packages to the latest version] **********************************************************************************************************************\r\ntask path: /Users/antoniocarlos/code/xxxxxxx/xxxxxxxx/roles/apt/tasks/main.yml:67\r\nfatal: [xx.xxx.xxx.xx]: FAILED! => {\"changed\": false, \"msg\": \"'/usr/bin/aptitude full-upgrade' failed: E: Could not get lock /var/lib/dpkg/lock-frontend - open (11: Resource temporarily unavailable)\\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\\nE: Could not regain the system lock!  (Perhaps another apt or dpkg is running?)\\nE: Could not get lock /var/lib/dpkg/lock-frontend - open (11: Resource temporarily unavailable)\\nE: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?\\nW: Could not lock the cache file; this usually means that dpkg or another apt tool is already installing packages.  Opening in read-only mode; any changes you make to the states of packages will NOT be preserved!\\n\", \"rc\": 255, \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nReading extended state information...\\nInitializing package states...\\nWriting extended state information...\\nBuilding tag database...\\nNo packages will be installed, upgraded, or removed.\\n0 packages upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\\nNeed to get 0 B of archives. After unpacking 0 B will be used.\\nWriting extended state information...\\nReading package lists...\\nBuilding dependency tree...\\nReading state information...\\nReading extended state information...\\nInitializing package states...\\nBuilding tag database...\\n\", \"stdout_lines\": [\"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"Reading extended state information...\", \"Initializing package states...\", \"Writing extended state information...\", \"Building tag database...\", \"No packages will be installed, upgraded, or removed.\", \"0 packages upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\", \"Need to get 0 B of archives. After unpacking 0 B will be used.\", \"Writing extended state information...\", \"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"Reading extended state information...\", \"Initializing package states...\", \"Building tag database...\"]}\r\n\tto retry, use: --limit @/Users/antoniocarlos/code/xxxxxxx/xxxxxxxx/playbook.retry\r\n```\r\n\r\n",
        "created_at": "2019-02-03T13:48:17Z",
        "user": "antonioribeiro",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3"
        ]
    },
    {
        "number": 51618,
        "title": "y|Y|n|N|on|On|ON|off|Off|OFF not Converted to Boolean when DEFAULT_JINJA2_NATIVE is False",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nWhen  `DEFAULT_JINJA2_NATIVE` is `False` certain strings which resemble YAML Booleans according to https://yaml.org/type/bool.html are not converted into Booleans, but kept as strings.  Affected strings are variations of `y`/`n` and `on`/`off`.\r\n\r\nWhile I would argue that `DEFAULT_JINJA2_NATIVE` **should** be enabled as default, Ansible currently displays inconsistent behaviour when it is not.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nset_fact\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n$ ansible --version\r\nansible 2.8.0.dev0\r\n  config file = /Users/dennis.conrad/ansible_devel/ansible/ansible.cfg\r\n  configured module search path = ['/Users/dennis.conrad/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/dennis.conrad/ansible_devel/ansible/lib/ansible\r\n  executable location = /Users/dennis.conrad/ansible_devel/ansible/bin/ansible\r\n  python version = 3.6.5 (default, Dec 11 2018, 12:40:45) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n$ ansible-config dump --only-changed\r\n$\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\nHere's a short playbook which will fail if `DEFAULT_JINJA2_NATIVE` is set to `False`, as `y`/`n` and `on`/`off` are not parsed to Booleans: \r\n\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: no\r\n\r\n  tasks:\r\n    - set_fact:\r\n        string_y: \"y\"\r\n        string_n: \"n\"\r\n        string_yes: \"yes\"\r\n        string_no: \"no\"\r\n        string_on: \"on\"\r\n        string_off: \"off\"\r\n        string_true: \"true\"\r\n        string_false: \"false\"\r\n    \r\n    - assert:\r\n        that:\r\n          - string_y ==  \"y\"\r\n          - string_n ==  \"n\"\r\n          - string_yes ==  \"yes\"\r\n          - string_no ==  \"no\"\r\n          - string_on ==  \"on\"\r\n          - string_off ==  \"off\"\r\n          - string_true ==  \"true\"\r\n          - string_false ==  \"false\"\r\n      when: lookup('config', 'DEFAULT_JINJA2_NATIVE') == true\r\n\r\n    - assert:\r\n        that:\r\n          - string_y ==  true\r\n          - string_n ==  false\r\n          - string_yes ==  true\r\n          - string_no ==  false\r\n          - string_on ==  true\r\n          - string_off ==  false\r\n          - string_true ==  true\r\n          - string_false ==  false\r\n      when: lookup('config', 'DEFAULT_JINJA2_NATIVE') == false\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nAssertions to pass when `DEFAULT_JINJA2_NATIVE` is set to `False`.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nAssertions fail when `DEFAULT_JINJA2_NATIVE` is set to `False`.\r\n",
        "created_at": "2019-02-01T16:34:55Z",
        "user": "dennisconrad",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3",
            "utilities"
        ]
    },
    {
        "number": 51580,
        "title": "git module with invalid reference succeeds in check mode, fails when run normally",
        "body": "\r\n##### SUMMARY\r\n\r\n```\r\n[notting@nostromo: ~/prog/awx]$ ansible -i localhost, localhost -c local -m git -a \"dest=$(pwd)/foof repo=https://github.com/ansible/test-playbooks version=does-not-exist\" --check\r\nlocalhost | CHANGED => {\r\n    \"after\": \"does-not-exist\",\r\n    \"before\": \"46c131495dfb9a6cf70e57545354702165f8a7e0\",\r\n    \"changed\": true,\r\n    \"remote_url_changed\": false\r\n}\r\n[notting@nostromo: ~/prog/awx]$ ansible -i localhost, localhost -c local -m git -a \"dest=$(pwd)/foof repo=https://github.com/ansible/test-playbooks version=does-not-exist\" \r\nlocalhost | FAILED! => {\r\n    \"changed\": false,\r\n    \"cmd\": \"/usr/bin/git checkout --force does-not-exist\",\r\n    \"msg\": \"Failed to checkout does-not-exist\",\r\n    \"rc\": 1,\r\n    \"stderr\": \"error: pathspec 'does-not-exist' did not match any file(s) known to git\\n\",\r\n    \"stderr_lines\": [\r\n        \"error: pathspec 'does-not-exist' did not match any file(s) known to git\"\r\n    ],\r\n    \"stdout\": \"\",\r\n    \"stdout_lines\": []\r\n}\r\n```\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\ngit\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/notting/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.7.2 (default, Jan 16 2019, 19:49:22) [GCC 8.2.1 20181215 (Red Hat 8.2.1-6)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_PIPELINING(/etc/ansible/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/etc/ansible/ansible.cfg) = False\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nFedora 29 (shouldn't be relevant?)\r\ngit-2.20.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nsee above\r\n\r\n##### EXPECTED RESULTS\r\n\r\nideally: check mode also fails\r\nrequired: check mode doesn't return a bogus `after` and `changed`\r\n\r\n",
        "created_at": "2019-01-31T22:06:53Z",
        "user": "wenottingham",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "source_control"
        ]
    },
    {
        "number": 51218,
        "title": "apt module reports an error when package is included in `apt-mark hold`",
        "body": "##### SUMMARY\r\napt module\r\n- does upgrade packages when `state=present` is specified\r\n- reports an error when package is included in `apt-mark hold` or `dpkg hold` and an upgraded version is available\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.5\r\n  config file = /Users/andy/workspace/ansible/ansible.cfg\r\n  configured module search path = ['/Users/andy/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/Cellar/ansible/2.7.5/libexec/lib/python3.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.7.2 (default, Jan 12 2019, 20:09:31) [Clang 10.0.0 (clang-1000.11.45.5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```\r\nANSIBLE_PIPELINING(/Users/andy/workspace/ansible/ansible.cfg) = True\r\nDEFAULT_HOST_LIST(/Users/andy/workspace/ansible/ansible.cfg) = ['/Users/andy/workspace/ansible/hosts.gcp.yml']\r\nDEFAULT_STDOUT_CALLBACK(/Users/andy/workspace/ansible/ansible.cfg) = yaml\r\nDEFAULT_STRATEGY(env: ANSIBLE_STRATEGY) = debug\r\nDEFAULT_VAULT_IDENTITY(/Users/andy/workspace/ansible/ansible.cfg) = local\r\nDEFAULT_VAULT_PASSWORD_FILE(/Users/andy/workspace/ansible/ansible.cfg) = /Users/andy/workspace/ansible/library/vault_password.sh\r\nDISPLAY_SKIPPED_HOSTS(/Users/andy/workspace/ansible/ansible.cfg) = False\r\nINVENTORY_ENABLED(/Users/andy/workspace/ansible/ansible.cfg) = ['host_list', 'ini', 'gcp_compute', 'auto']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nTested on Ubuntu 16.04 LTS, but I pretty much sure this issue is the same on every Debian OS\r\n```\r\nUbuntu 16.04.5 LTS (GNU/Linux 4.15.0-1026-gcp x86_64)\r\napt/xenial-updates,xenial-security,now 1.2.29ubuntu0.1 amd64 [installed]\r\npython-apt/xenial-updates,now 1.1.0~beta1ubuntu0.16.04.2 amd64 [installed]\r\npython-apt-common/xenial-updates,now 1.1.0~beta1ubuntu0.16.04.2 all [installed]\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Scenario A\r\n    - install erlang-base:\r\n    ```\r\n    sudo apt-get install -y erlang-base=1:21.1.2-1\r\n    ```\r\n    - launch ansible playbook:\r\n    ```yaml\r\n    - name: install packages\r\n      package:\r\n        name:\r\n          - erlang-base=1:21.1.*\r\n        state: present\r\n    ```\r\n\r\n2. Scenario B\r\n    - install erlang-base and hold it:\r\n    ```\r\n    sudo apt-get install -y erlang-base=1:21.1.2-1\r\n    sudo apt-mark hold erlang-base\r\n    ```\r\n    - launch ansible playbook:\r\n    ```yaml\r\n    - name: install packages\r\n      package:\r\n        name:\r\n          - erlang-base=1:21.1.*\r\n        state: present  \r\n    ```\r\n\r\n##### EXPECTED RESULTS\r\n1. Scenario A\r\n    I expect the module to do nothing ([ok]), because:\r\n    - package is installed\r\n    - it matches (by wildcard) the version requested\r\n    - `state=present` implies no upgrades if package is installed already\r\n\r\n2. Scenario B\r\n    I expect the module to do nothing ([ok]), because:\r\n    - package is installed\r\n    - it matches (by wildcard) the version requested\r\n    - `state=present` implies no upgrades if package is installed already\r\n    - `apt-mark hold` prevents it from being updated and this is ok\r\n\r\n\r\n##### ACTUAL RESULTS\r\n1. Scenario A - the package is updated ([changed])\r\n    ```\r\n    TASK [rmq : install apt packages] **************************************************************************************************************\r\n    task path: /Users/andy/workspace/ansible/roles/rmq/tasks/packages.yml:52\r\n    ok: [db-stage] => changed=false\r\n      cache_update_time: 1548238202\r\n      cache_updated: true\r\n    The following additional packages will be installed:\r\n      erlang-base\r\n    1 upgraded, 0 newly installed, 0 to remove and 8 not upgraded.\r\n    changed: [db-qa] => changed=true\r\n      cache_update_time: 1548238203\r\n      cache_updated: true\r\n      stderr: ''\r\n      stderr_lines: []\r\n      stdout: |-\r\n        Reading package lists...\r\n        Building dependency tree...\r\n        Reading state information...\r\n        The following additional packages will be installed:\r\n          erlang-base\r\n        1 upgraded, 0 newly installed, 0 to remove and 8 not upgraded.\r\n        Inst erlang-base (1:21.1.4-1 Bintray:xenial [amd64])\r\n        Conf erlang-base (1:21.1.4-1 Bintray:xenial [amd64])\r\n      stdout_lines: <omitted>    \r\n    ```\r\n2. Scenario B - an error is reported:\r\n    ```\r\n    TASK [rmq : install apt packages] ***************************************************************************************************************************\r\n    fatal: [pg-tmp-ubuntu]: FAILED! => changed=false\r\n      cache_update_time: 1548231820\r\n      cache_updated: false\r\n      msg: |-\r\n        '/usr/bin/apt-get -y -o \"Dpkg::Options::=--force-confdef\" -o \"Dpkg::Options::=--force-confold\"     install 'erlang-base=1:21.1.*'' failed: E: Unable to correct problems, you have held broken packages.\r\n      rc: 100\r\n      stderr: |-\r\n        E: Unable to correct problems, you have held broken packages.\r\n      stderr_lines:\r\n      - 'E: Unable to correct problems, you have held broken packages.'\r\n      stdout: |-\r\n        Reading package lists... Done\r\n        Building dependency tree\r\n        Reading state information... Done\r\n        Selected version '1:21.1.4-1' (Bintray:xenial [amd64]) for 'erlang-base'\r\n        Suggested packages:\r\n          erlang-tools erlang erlang-manpages erlang-doc\r\n        Recommended packages:\r\n          erlang-crypto erlang-syntax-tools\r\n        The following held packages will be changed:\r\n          erlang-base\r\n        The following packages will be upgraded:\r\n          erlang-base\r\n        1 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.\r\n      stdout_lines: <omitted>\r\n    ```\r\n",
        "created_at": "2019-01-23T12:42:20Z",
        "user": "astorath",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "needs_verified",
            "packaging"
        ]
    },
    {
        "number": 50822,
        "title": "service module detects status incorrectly when using openrc",
        "body": "##### SUMMARY\r\nWhen using openrc, the service module does not always correctly detect a service that has already been started. This is caused by ansible looking for string output from `rc-service myservicename status` instead of looking at the return code.\r\n\r\nSee https://github.com/ansible/ansible/blob/devel/lib/ansible/modules/system/service.py line 615-618.\r\n\r\nTo confirm the behaviour is incorrect, I opened two bugs for affected gentoo packages:\r\nhttps://bugs.gentoo.org/672128\r\nhttps://bugs.gentoo.org/674836\r\n\r\nAs a result, I was pointed to\r\nhttp://refspecs.linuxfoundation.org/LSB_5.0.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html\r\n\r\nOn freenode #openrc it was confirmed, that the return code is the correct way of checking for the current status. I was also given a warning that it might not always conform to the standard, but should at least have return code zero for \"started\" and non-zero for any error condition.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nservice\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.1\r\n  config file = /home/david/.ansible.cfg\r\n  configured module search path = [u'/home/david/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib64/python2.7/site-packages/ansible\r\n  executable location = /usr/lib/python-exec/python2.7/ansible\r\n  python version = 2.7.14 (default, Feb  2 2018, 06:32:02) [GCC 6.4.0]\r\n```\r\n\r\n##### CONFIGURATION\r\nirrelevant.\r\n```\r\nANSIBLE_NOCOWS(/home/david/.ansible.cfg) = True\r\nDEFAULT_CALLBACK_WHITELIST(/home/david/.ansible.cfg) = [u'profile_roles']\r\nDEFAULT_FORKS(/home/david/.ansible.cfg) = 50\r\nDEFAULT_HOST_LIST(/home/david/.ansible.cfg) = [u'/home/david/ansible/hosts']\r\nDEFAULT_LOCAL_TMP(/home/david/.ansible.cfg) = /tmp/ansible/ansible-local-283898scY7h\r\nDEFAULT_STDOUT_CALLBACK(/home/david/.ansible.cfg) = default\r\nDISPLAY_SKIPPED_HOSTS(/home/david/.ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/home/david/.ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nGentoo, using openrc\r\n\r\n##### STEPS TO REPRODUCE\r\n1) Install some package with an init script that overrides status() output\r\n2) start said init script\r\n3) run ansible service module, set state=started\r\n\r\n##### EXPECTED RESULTS\r\nin step 3 above, the status should be ok, not changed\r\n\r\n##### ACTUAL RESULTS\r\nthe status is changed, despite the service already running",
        "created_at": "2019-01-11T22:15:04Z",
        "user": "davidklaftenegger",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "system"
        ]
    },
    {
        "number": 50585,
        "title": "script: chdir on Windows does not work",
        "body": "##### SUMMARY\r\nUsing the `chdir` module option for `script` on Windows does not work due to various issues. We don't have any integration tests and it looks like this has been broken for a few releases now.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nscript\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\ndevel\r\n```\r\n\r\n##### CONFIGURATION\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\nWindows as a remote host\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n---\r\n- hosts: windows\r\n  gather_facts: no\r\n\r\n  tasks:\r\n  - copy:\r\n      content: '$pwd'\r\n      dest: test.ps1\r\n    delegate_to: localhost\r\n\r\n  - script: test.ps1\r\n    args:\r\n      chdir: C:\\Windows\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nThe script to execute and the output being `C:\\Windows`.\r\n\r\n```\r\nTASK [script] ******************************************************************************************\r\ntask path: /Users/jborean/dev/module-tester/adhoc.yml:11\r\n<server2016.domain.local> ESTABLISH WINRM CONNECTION FOR USER: vagrant on PORT 5986 TO server2016.domain.local                                                                                                  \r\nEXEC (via pipeline wrapper)\r\n<server2016.domain.local> PUT \"/Users/jborean/dev/module-tester/test.ps1\" TO \"C:\\Users\\vagrant\\AppData\\Local\\Temp\\ansible-tmp-1546807144.946774-18271179278802\\test.ps1\"                                        \r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nchanged: [2016] => {\r\n    \"changed\": true,\r\n    \"rc\": 0,\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"C:\\\\Windows\\r\\n\",\r\n    \"stdout_lines\": [\r\n        \"C:\\\\Windows\"\r\n    ]\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nBefore https://github.com/ansible/ansible/pull/50365\r\n\r\n```\r\nTASK [script] ******************************************************************************************\r\ntask path: /Users/jborean/dev/module-tester/adhoc.yml:11\r\n<server2016.domain.local> ESTABLISH WINRM CONNECTION FOR USER: vagrant on PORT 5986 TO server2016.domain.local                                                                                                  \r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/executor/task_executor.py\", line 142, in run\r\n    res = self._execute()\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/executor/task_executor.py\", line 644, in _execute\r\n    result = self._handler.run(task_vars=variables)\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/plugins/action/script.py\", line 69, in run\r\n    not self.windows_absolute_path_detection.matches(chdir):\r\nAttributeError: 're.Pattern' object has no attribute 'matches'\r\n\r\nfatal: [2016]: FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n```\r\n\r\nAfter https://github.com/ansible/ansible/pull/50365\r\n\r\n```\r\nTASK [script] ******************************************************************************************\r\ntask path: /Users/jborean/dev/module-tester/adhoc.yml:11\r\n<server2016.domain.local> ESTABLISH WINRM CONNECTION FOR USER: vagrant on PORT 5986 TO server2016.domain.local                                                                                                  \r\nEXEC (via pipeline wrapper)\r\n<server2016.domain.local> PUT \"/Users/jborean/dev/module-tester/test.ps1\" TO \"C:\\Users\\vagrant\\AppData\\Local\\Temp\\ansible-tmp-1546807259.5340679-129273677441460\\test.ps1\"                                      \r\nEXEC (via pipeline wrapper)\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/executor/task_executor.py\", line 142, in run\r\n    res = self._execute()\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/executor/task_executor.py\", line 644, in _execute\r\n    result = self._handler.run(task_vars=variables)\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/plugins/action/script.py\", line 142, in run\r\n    result.update(self._low_level_execute_command(cmd=script_cmd, in_data=exec_data, sudoable=True, chdir=chdir))                                                                                               \r\n  File \"/Users/jborean/dev/ansible/lib/ansible/plugins/action/__init__.py\", line 961, in _low_level_execute_command                                                                                             \r\n    cmd = self._connection._shell.append_command('cd %s' % chdir, cmd)\r\n  File \"/Users/jborean/dev/ansible/lib/ansible/plugins/shell/__init__.py\", line 210, in append_command\r\n    if self._SHELL_AND:\r\nAttributeError: 'ShellModule' object has no attribute '_SHELL_AND'\r\n\r\nfatal: [2016]: FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n```",
        "created_at": "2019-01-06T20:43:43Z",
        "user": "jborean93",
        "labels": [
            "windows",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "commands",
            "affects_2.17"
        ]
    },
    {
        "number": 50044,
        "title": "Handlers should respect skip-tags",
        "body": "##### SUMMARY\r\nHandlers should respect skip-tags. Currently they do not.\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/playbook/taggable.py\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n- hosts: localhost\r\n  gather_facts: false\r\n  handlers:\r\n    - name: debug_handler\r\n      debug:\r\n        msg: handler\r\n      tags:\r\n        - handlers\r\n  tasks:\r\n    - command: \"true\"\r\n      notify:\r\n        - debug_handler\r\n```\r\n\r\n```\r\n$ ansible-playbook --skip-tags handlers playbook.yml\r\nPLAY [localhost] *****************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [command] *******************************************************************************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nRUNNING HANDLER [debug_handler] **************************************************************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"handler\"\r\n}\r\n\r\nPLAY RECAP ***********************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0\r\n```",
        "created_at": "2018-12-17T19:18:52Z",
        "user": "514amir",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "affects_2.8",
            "P3",
            "verified",
            "affects_2.11",
            "affects_2.14"
        ]
    },
    {
        "number": 49946,
        "title": "Allow vaulted configuration for plugins that only support ansible.cfg configs",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Describe the new feature/improvement briefly below -->\r\nThe ability to use either vaulted credentials or encrypted password in mongodb database connection string for Ansible fact caching\r\n\r\nCurrently, the only way to use authentication in combination with the mongodb fact caching plugin is to include plain-text username and password in the ansible.cfg.  I would like to see the ability to either leverage an encrypted password string in ansible.cfg for this or to override these values via extra variables.\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below, use your best guess if unsure -->\r\n/usr/lib/python2.7/site-packages/ansible/plugins/cache/mongodb.py\r\n\r\n##### ANSIBLE VERSION\r\nansible 2.7.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /bin/ansible\r\n  python version = 2.7.5 (default, May 31 2018, 09:41:32) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!--- Describe how the feature would be used, why it is needed and what it would solve -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can also paste gist.github.com links for larger files -->\r\n",
        "created_at": "2018-12-14T14:40:56Z",
        "user": "JMack89427",
        "labels": [
            "support:core",
            "has_pr",
            "feature",
            "affects_2.7",
            "affects_2.14",
            "affects_2.15",
            "affects_2.16",
            "data_tagging"
        ]
    },
    {
        "number": 49900,
        "title": "Provide deprecation warnings on return values/facts",
        "body": "##### SUMMARY\r\nAllow modules and actions to tag attributes of return values (including facts) as deprecated. Preserve the tagging within the controller and variable store, and only fire a deprecation warning when a tagged attribute is \"touched\" by a user-initiated event (usually templating). \r\n\r\nThis is prerequisite for the ultimate fix to #43798 (deprecating usage of all un-namespaced facts and eventually changing the default to namespaced-only).\r\n\r\nDepends on https://github.com/ansible/ansible/issues/80747\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nAnsibleUnsafe\r\n\r\n##### ADDITIONAL INFORMATION\r\nRefactor AnsibleUnsafe to a new class that supports multiple types of tagging, and ensure that the various tagged data is always preserved if attempting to add a new tag. Trigger the warning when encountering a tagged value during templating.",
        "created_at": "2018-12-13T17:46:47Z",
        "user": "nitzmahone",
        "labels": [
            "support:core",
            "feature",
            "affects_2.17",
            "data_tagging"
        ]
    },
    {
        "number": 49837,
        "title": "Ansible fetch sticky bit",
        "body": "##### SUMMARY\r\n\r\nUsing Fetch module trying to move files from windows host to unix, sticky bit on directory is not inherited to files moved under unix directory\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nFetch module ansible\r\n\r\n##### ANSIBLE VERSION\r\n\r\nAnsible 2.6.2\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n- name: Creates archive directory\r\n  file:\r\n    path: \"/tmp/files/\"\r\n    state: directory\r\n    mode: 01777\r\n- name: Move files to archive directory\r\n  fetch:\r\n    validate_checksum: yes\r\n    src: 'D:\\tmp\\files\\temp.txt'\r\n    dest: /tmp/files/\r\n    flat: yes\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nfiles to be copied with permissions and user set on files directory, but getting created with 0644 permissions and random user and group\r\n\r\n##### ACTUAL RESULTS\r\n\r\nN/A",
        "created_at": "2018-12-12T20:46:37Z",
        "user": "gopurx",
        "labels": [
            "windows",
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "needs_verified",
            "files"
        ]
    },
    {
        "number": 49567,
        "title": "WinRM: wait_for_connection improvements",
        "body": "##### SUMMARY\r\nWinRM throws fatal errors on various low level networking and authentication (kerberos) problems well before win_ping can execute, killing the run.\r\n\r\nOne would reasonably expect that wait_for_connection actually waits for a connection and not fatally errors out when the connection failed for low-level reasons.\r\n\r\nThis should be reworked so wait_for_connection is at least configurable to ignore the fatal errors that happen before a connection happens.\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/plugins/connection/winrm.py\r\n\r\n##### ANSIBLE VERSION\r\n2.8",
        "created_at": "2018-12-05T21:25:18Z",
        "user": "jeffwarnica",
        "labels": [
            "windows",
            "support:core",
            "feature",
            "affects_2.8",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 49408,
        "title": "unarchive fails to decompress non-ascii-filenames from zip-files",
        "body": "##### SUMMARY\r\nThe unarchive-module throws an error when trying to extract an zip-archive that contains non-ascii-filenames.\r\n\r\nThis issue is reproducable for archives that are created with macOS-Finder \"compress\" and also with standard zip.\r\n\r\nThis issue is related to https://github.com/ansible/ansible/issues/22922\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nmodule: unarchive\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.2\r\n  config file = None\r\n  configured module search path = *snip*\r\n  ansible python module location = /usr/local/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.15 (default, Oct  2 2018, 11:42:04) [GCC 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_PIPELINING(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=120\r\nCOMMAND_WARNINGS(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_METHOD(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = sudo\r\nDEFAULT_CALLBACK_WHITELIST(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = [u'timer']\r\nDEFAULT_TIMEOUT(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = 10\r\nDEPRECATION_WARNINGS(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = True\r\nDISPLAY_SKIPPED_HOSTS(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = False\r\nHOST_KEY_CHECKING(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = False\r\nSYSTEM_WARNINGS(/Users/myuser/git/bcw/bcw/ansible/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nAnsible controller: macOS Mojave, Ansible 2.7.2 (installed via pip),\r\nAnsible target: Debian Stretch (Vagrant box)\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\nname: Unarchive a file that is already on the remote machine\r\n  unarchive:\r\n    src: \"~/tmp/zipfoo/archives/mac_archive.zip\"\r\n    dest: \"/tmp\"\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nFile content is extracted properly.\r\nFilenames with non-ascii-chareacters are extracted properly as well.\r\n\r\n\r\n##### ACTUAL RESULTS\r\nI  found out that archives created with the macOS Finder action \"compress\" will trigger an error when having filenames that are non-ascii.\r\n\r\nArchives that where created via the standard zip on a shell (macOS) did not trigger this issue.\r\nThis test was made with the same set of files.\r\n\r\nList of filenames:\r\n\r\n- alien.\ud83d\udc7d\r\n- koeln.txt\r\n- k\u00f6ln.txt\r\n- spa\u00df.txt\r\n- \u237e.txt\r\n- \u2622\ufe0e.ray\r\n- \u2620\ufe0f.txt\r\n\r\n```\r\nfatal: [bcw-server-1]: FAILED! => {\r\n    \"changed\": false,\r\n    \"module_stderr\": \"OpenSSH_7.8p1, LibreSSL 2.7.3\r\n    debug1: Reading configuration data /etc/ssh/ssh_config\r\n    debug1: /etc/ssh/ssh_config line 48: Applying options for *\r\n    debug2: resolve_canonicalize: hostname 192.168.50.101 is address\r\n    debug1: auto-mux: Trying existing master\r\n    debug2: fd 3 setting O_NONBLOCK\r\n    debug2: mux_client_hello_exchange: master version 4\r\n    debug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\n    debug3: mux_client_request_session: entering\r\n    debug3: mux_client_request_alive: entering\r\n    debug3: mux_client_request_alive: done pid = 69236\r\n    debug3: mux_client_request_session: session request sent\r\n    debug3: mux_client_read_packet: read header failed: Broken pipe\r\n    debug2: Received exit status from master 1\r\n    Shared connection to 192.168.50.101 closed.\r\n    \",\r\n    \"module_stdout\": \"Traceback (most recent call last):\r\n    File \\\"/home/vagrant/.ansible/tmp/ansible-tmp-1543696189.28-158647235595942/AnsiballZ_unarchive.py\\\", line 113, in <module>\r\n        _ansiballz_main()\r\n    File \\\"/home/vagrant/.ansible/tmp/ansible-tmp-1543696189.28-158647235595942/AnsiballZ_unarchive.py\\\", line 105, in _ansiballz_main\r\n        invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n    File \\\"/home/vagrant/.ansible/tmp/ansible-tmp-1543696189.28-158647235595942/AnsiballZ_unarchive.py\\\", line 48, in invoke_module\r\n        imp.load_module('__main__', mod, module, MOD_DESC)\r\n    File \\\"/tmp/ansible_unarchive_payload_n9EvQE/__main__.py\\\", line 909, in <module>\r\n    File \\\"/tmp/ansible_unarchive_payload_n9EvQE/__main__.py\\\", line 867, in main\r\n    File \\\"/tmp/ansible_unarchive_payload_n9EvQE/__main__.py\\\", line 494, in is_unarchived\r\n    File \\\"/tmp/ansible_unarchive_payload_n9EvQE/__main__.py\\\", line 247, in _crc32\r\n    KeyError: u'\\\\u2620\\\\ufe0f.txt'\r\n    \",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 1\r\n}\r\n```\r\n",
        "created_at": "2018-12-01T20:48:26Z",
        "user": "ppuschmann",
        "labels": [
            "module",
            "support:core",
            "m:unarchive",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "needs_verified",
            "files",
            "affects_2.16"
        ]
    },
    {
        "number": 49294,
        "title": "Undefined built-in variable when used within a loop",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nIn latest ansible version (2.7.1 and 2.7.2), the variable \"ansible_user\" is reported as undefined in the loop context (please have a look at the example playbook below). Other variables may also be impacted.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below -->\r\ntask_executor.py\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.12 (default, Nov 12 2018, 14:36:49) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n<no changes>\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentOS Linux release 7.4.1708 (Core)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nRun ansible-playbook with the example playbook in argument:\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- name: Undefined variable playbook\r\n  hosts: localhost\r\n  gather_facts: yes\r\n  tasks:\r\n    - debug:\r\n        msg: \"{{ ansible_user }}\"\r\n\r\n    - debug:\r\n        msg: \"{{ item }}\"\r\n      loop:\r\n        - \"{{ ansible_user_id }}\"\r\n\r\n    - debug:\r\n        msg: \"{{ item }}\"\r\n      loop:\r\n        - \"{{ ansible_user }}\"\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\nmmallet@mmallet-dev1:~$ ansible-playbook playbook_error.yml\r\n\r\nPLAY [Undefined variable playbook] *****************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"mmallet\"\r\n}\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nok: [localhost] => (item=mmallet) => {\r\n    \"msg\": \"mmallet\"\r\n}\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nok: [localhost] => (item=mmallet) => {\r\n    \"msg\": \"mmallet\"\r\n}\r\n\r\nPLAY RECAP ********************************************************************************************************************************************\r\nlocalhost                  : ok=4    changed=0    unreachable=0    failed=0\r\n\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\n\r\nPLAY [Undefined variable] *****************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"mmallet\"\r\n}\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nok: [localhost] => (item=mmallet) => {\r\n    \"msg\": \"mmallet\"\r\n}\r\n\r\nTASK [debug] ******************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"msg\": \"'ansible_user' is undefined\"}\r\n        to retry, use: --limit @/home/mmallet/playbook_error.retry\r\n\r\nPLAY RECAP ********************************************************************************************************************************************\r\nlocalhost                  : ok=3    changed=0    unreachable=0    failed=1\r\n```\r\n",
        "created_at": "2018-11-29T12:40:47Z",
        "user": "mmallet-digipok",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3",
            "verified"
        ]
    },
    {
        "number": 49245,
        "title": "Either Ansible or aws_ec2 plugin compute group vars as host",
        "body": "##### SUMMARY\r\nAs per title, when using the `aws_ec2` plugin I get returned the content of a `group_vars` file (and its secrets!) instead of the actual (or lack of) list of hosts.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n`awc_ec2`\r\n\r\n##### ANSIBLE VERSION\r\n2.7.0\r\n\r\n##### CONFIGURATION\r\nNot relevant\r\n\r\n##### OS / ENVIRONMENT\r\nNot relevant\r\n\r\n##### STEPS TO REPRODUCE\r\nGet the following folder structure in place:\r\n```\r\nansible/\r\n   group_vars/\r\n      all/\r\n         vars.yml\r\n         vault\r\n   inventory.aws_ec2.yml\r\n   the-vault-passphrase\r\nansible.cfg\r\n```\r\n\r\nGet the following files in line:\r\n```\r\n#\u00a0ansible.cfg\r\n[defaults]\r\nhost_key_checking = False\r\nretry_files_enabled = False\r\nvault_password_file = ./ansible/the-vault-passphrase\r\n\r\n# ansible/inventory.aws_ec2.yml\r\n---\r\nplugin: aws_ec2\r\nfilters:\r\n  tag:Name: somename\r\n  tag:Team: somename*\r\ngroups:\r\n  ungrouped: false\r\n\r\n# ansible/group_vars/all/vars.yml\r\n---\r\nsome_var1: \"6.4.3\"\r\nsome_var2:\r\n   some_var2_val1: \"foo\"\r\n   #\u00a0etc etc\r\n\r\nsome_var3: \"{{ vault_some_var3 }}\"\r\n\r\n# ansible/group_vars/all/vault\r\n# this is shown as encrypted here but it should be encrypted\r\n---\r\nvault_some_var3: \"value of some_var3\"\r\n```\r\n\r\nLaunch the command:\r\n```\r\n ansible-inventory -i ansible/inventory.aws_ec2.yml --list\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nGet either an empty list of hosts if the dynamic inventory matched the criteria defined in the inventory, some actual list of hosts or some meaningful error message if something went wrong.\r\n\r\n##### ACTUAL RESULTS\r\nVars (and secrets!) exposed and seen as hostvars in the output JSON (??). See an excerpt below.\r\n\r\n```\r\n{\r\n    \"_meta\": {\r\n        \"hostvars\": {\r\n            \"---\": {\r\n                \"some_var1\": \"6.4.3\", \r\n                \"some_var2\": {\r\n                    \"some_var2_val1: \"foo\"\r\n                 },\r\n                \"some_var3\": \"value of some_var3\"\r\n# ....\r\n```",
        "created_at": "2018-11-28T16:19:08Z",
        "user": "walterdolce",
        "labels": [
            "c:vars/variable_manager",
            "support:core",
            "bug",
            "affects_2.7",
            "P3",
            "verified"
        ]
    },
    {
        "number": 49207,
        "title": "Ansible carries out work after forks and sometimes has threads running.  ",
        "body": "If you have found this issue with a search and need a quick fix, you can probably simply run\r\n\r\n`export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES\r\n`\r\nin bash and have a work around.  This will not fix the underlying issue but will allow you to complete your work today.    \r\n\r\n##### SUMMARY\r\n\r\nIn some cases, ansible first forks and then does other work.  If a thread was running before a fork this thread may hold a lock on a resource.  If the work that is done either attempts to also lock that resource or triggers another library that triggers a thread that attempts to lock that resource it is possible to have a deadlock.   \r\n\r\nUnfortunately since ansible runs on many platforms with many different underlying operating systems, it is impossible to predict if an underlying library will trigger a thread.  This means this is a potential bug anywhere and even if the system works today it might stop working tomorrow.  \r\n\r\nThis bug is primarily observed on MacOS where there is a library which deliberately poisons the system when it detects that a deadlock is possible.  \r\n\r\nN.B. This does *not* mean that this is just a MacOS bug.  The bug in ansible on other operating systems is (potentially) worse and more difficult to debug because it will only happen if you are unlucky with the state of your threads.  Here is a more detailed explanation: \r\n\r\nhttps://blog.phusion.nl/2017/10/13/why-ruby-app-servers-break-on-macos-high-sierra-and-what-can-be-done-about-it/\r\n\r\nExamples of bug reports on MacOS that have been triggered by this;  N.B. these have all been solved with a work around (that I have also been partly to blame for):\r\n\r\n* https://github.com/ansible/ansible/issues/37074\r\n* https://github.com/ansible/ansible/issues/34056\r\n* https://github.com/ansible/ansible/issues/32499\r\n* https://github.com/ansible/ansible/issues/34056\r\n\r\n##### ISSUE TYPE\r\n\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nCore - most easily triggered by lookups it seems.  \r\n\r\n##### ANSIBLE VERSION\r\n\r\nI will follow up with the version info where I experience this soon.  \r\n\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nOn MacOS you get errors like the following:\r\n<!--- Paste verbatim command output between quotes -->\r\n```\r\nobjc[33642]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called.\r\nobjc[33642]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\r\n```\r\n\r\nOn other  platforms this would be experienced as a random freeze, possibly just of one thread.  Running ansible again would solve the problem so bug reports would be much rarer than problems.  E.g. maybe some of these (I haven't looked in detail - just saw that the report doesn't seem to rule this out).\r\n\r\n* https://github.com/ansible/ansible/issues/26347\r\n* https://github.com/ansible/ansible/issues/19214",
        "created_at": "2018-11-27T20:38:20Z",
        "user": "mikedlr",
        "labels": [
            "support:core",
            "bug",
            "has_pr",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 48984,
        "title": "blockinfile fails when block is a jinja template with a for loop inside and quotes inside",
        "body": "##### SUMMARY\r\nI use blockinfile and block is taken from variable like this:\r\n```yaml\r\n    foo_block: |\r\n      {\r\n      {% for i in a_list_of_strings %}\r\n        '{{ i }}',\r\n      {% endfor %}\r\n      }\r\n```\r\nIt fails with some weird internal errors. \r\n\r\nIf I remove single quotes around `{{ i }}` it's not failing.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nblockinfile\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.7.1\r\n  config file = /home/etam/.ansible.cfg\r\n  configured module search path = ['/home/etam/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.5 (default, Mar 31 2018, 19:45:04) [GCC]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_NOCOWS(/home/etam/.ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nOS: openSUSE Tumbleweed, snapshot 20181116\r\n\r\n##### STEPS TO REPRODUCE\r\n`inventory.yml`:\r\n```yaml\r\nall:\r\n  hosts:\r\n    localhost:\r\n      ansible_connection: local\r\n  vars:\r\n    ansible_python_interpreter: /usr/bin/python3\r\n```\r\n\r\n`play.yml`:\r\n```yaml\r\n- hosts: localhost\r\n  gather_facts: no\r\n  vars:\r\n    a_list_of_strings:\r\n      - \"a\"\r\n      - \"b\"\r\n      - \"c\"\r\n      - \"d\"\r\n    foo_block: |\r\n      {\r\n      {% for i in a_list_of_strings %}\r\n        '{{ i }}',\r\n      {% endfor %}\r\n      }\r\n  tasks:\r\n    - blockinfile:\r\n        path: /tmp/foo.txt\r\n        create: yes\r\n        state: present\r\n        block: \"{{ bar_block }}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n`/tmp/foo.txt` should contain\r\n```\r\n# BEGIN ANSIBLE MANAGED BLOCK\r\n{\r\n  'a',\r\n  'b',\r\n  'c',\r\n  'd',\r\n}\r\n# END ANSIBLE MANAGED BLOCK\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n`ansible-playbook -i inventory.yml play.yml -vvv` fails with error:\r\n```\r\nTASK [blockinfile] *****************************************************************************************************************\r\ntask path: /home/etam/code/test/ansible/play.yml:16\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: etam\r\n<localhost> EXEC /bin/sh -c 'echo ~etam && sleep 0'\r\n<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/etam/.ansible/tmp/ansible-tmp-1542802657.983047-76135995275779 `\" && echo ansible-tmp-1542802657.983047-76135995275779=\"` echo /home/etam/.ansible/tmp/ansible-tmp-1542802657.983047-76135995275779 `\" ) && sleep 0'\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/site-packages/ansible/executor/task_executor.py\", line 139, in run\r\n    res = self._execute()\r\n  File \"/usr/lib/python3.6/site-packages/ansible/executor/task_executor.py\", line 603, in _execute\r\n    result = self._handler.run(task_vars=variables)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/action/normal.py\", line 46, in run\r\n    result = merge_hash(result, self._execute_module(task_vars=task_vars, wrap_async=wrap_async))\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/action/__init__.py\", line 738, in _execute_module\r\n    (module_style, shebang, module_data, module_path) = self._configure_module(module_name=module_name, module_args=module_args, task_vars=task_vars)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/action/__init__.py\", line 177, in _configure_module\r\n    environment=final_environment)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/executor/module_common.py\", line 972, in modify_module\r\n    environment=environment)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/executor/module_common.py\", line 742, in _find_module_utils\r\n    python_repred_params = repr(json.dumps(params))\r\n  File \"/usr/lib64/python3.6/json/__init__.py\", line 231, in dumps\r\n    return _default_encoder.encode(obj)\r\n  File \"/usr/lib64/python3.6/json/encoder.py\", line 199, in encode\r\n    chunks = self.iterencode(o, _one_shot=True)\r\n  File \"/usr/lib64/python3.6/json/encoder.py\", line 257, in iterencode\r\n    return _iterencode(o, 0)\r\n  File \"/usr/lib64/python3.6/json/encoder.py\", line 180, in default\r\n    o.__class__.__name__)\r\nTypeError: Object of type 'set' is not JSON serializable\r\nfatal: [localhost]: FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n\tto retry, use: --limit @/home/etam/code/test/ansible/play.retry\r\n\r\nPLAY RECAP *************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1   \r\n```\r\n",
        "created_at": "2018-11-21T12:29:01Z",
        "user": "etam",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "affects_2.7",
            "P3",
            "verified",
            "files"
        ]
    },
    {
        "number": 48839,
        "title": "Adding file attributes always reports changed when attribute exists alongside others",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nThe File module always reports changed when adding an attribute to a file when already has other attributes, even if the attribute is already present.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below -->\r\nFile\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.7.1\r\n  config file = /Users/user/personal-projects/ap-ansible/ansible.cfg\r\n  configured module search path = ['/Users/user/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.5 (default, Jun 17 2018, 12:13:06) [GCC 4.2.1 Compatible Apple LLVM 9.1.0 (clang-902.0.39.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\nNone\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nCentOS 7\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n1. Create a file with multiple attributes, e.g. `A` and `i`.\r\n2. Use the `file` module to set `+A` on the file. The module will report changed, despite the file already having the `A` attribute.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Set file attributes\r\n  file:\r\n    path: /tmp/file_with_attrs\r\n    state: touch\r\n    attributes: \"dA\"\r\n\r\n- name: Set existing file attribute (+A)\r\n  file:\r\n    path: /tmp/file_with_attrs\r\n    state: file\r\n    attributes: \"+A\"\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\n```\r\nTASK [common : Set file attributes]\r\nchanged: [host]\r\n\r\nTASK [common : Set +A]\r\nok: [host]\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\n\r\nSetting `+A` reports changed, despite the file already having the `A` attribute.\r\n\r\n```\r\nTASK [common : Set file attributes]\r\nchanged: [host]\r\n\r\nTASK [common : Set +A]\r\nchanged: [host]\r\n```\r\n",
        "created_at": "2018-11-17T07:55:26Z",
        "user": "NFarrington",
        "labels": [
            "python3",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.7",
            "P3",
            "files"
        ]
    },
    {
        "number": 48320,
        "title": "ansible_console: colored prompt breaks input longer than line",
        "body": "##### SUMMARY\r\nWhen entering a long line of text in `ansible-console` with colors on, console input breaks.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nansible-console\r\n\r\n##### ANSIBLE VERSION\r\n```\r\n2.8.0\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nLinux console, xterm-256color\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Start `ansible-console`\r\n2. Enter a too long line\r\n3. Execute\r\n4. Press arrow-up, arrow-down\r\n\r\n##### EXPECTED RESULTS\r\nLast prompt is still there and cursor is in correct position (after prompt).\r\n\r\n##### ACTUAL RESULTS\r\nLast prompt is gone and cursor is in wrong line.\r\n",
        "created_at": "2018-11-07T20:50:15Z",
        "user": "felixfontein",
        "labels": [
            "support:core",
            "bug",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 47837,
        "title": "iptables module attempts to use incompatible policy and action commands",
        "body": "<!--- Verify first that your issue is not already reported on GitHub -->\r\n<!--- Also test if the latest release and devel branch are affected too -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly below -->\r\nIf I try to open a port on a RHEL6 machine with the following task:\r\n\r\n    - name: Habilitar el firewall para SNMP (RHEL6)\r\n      iptables:\r\n        action: append\r\n        chain: INPUT\r\n        protocol: udp\r\n        destination_port: 161\r\n        policy: ACCEPT\r\n        state: present\r\n        table: filter\r\n\r\nThen when running, I get the following error:\r\n\r\n```\r\nTASK [Habilitar el firewall para SNMP (RHEL6)] *********************************\r\nfatal: [10.41.0.117]: FAILED! => {\"changed\": false, \"cmd\": \"/sbin/iptables -t filter -L INPUT -p udp --destination-port 161\", \"msg\": \"iptables v1.4.7: Illegal option `-p' with this command\\n\\nTry `iptables -h' or 'iptables --help' for more information.\", \"rc\": 2, \"stderr\": \"iptables v1.4.7: Illegal option `-p' with this command\\n\\nTry `iptables -h' or 'iptables --help' for more information.\\n\", \"stderr_lines\": [\"iptables v1.4.7: Illegal option `-p' with this command\", \"\", \"Try `iptables -h' or 'iptables --help' for more information.\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n```\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Write the short name of the module, plugin, task or feature below -->\r\nmodule iptables\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\n[root@srvvtowerprd ~]# ansible --version\r\nansible 2.6.4\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Feb 20 2018, 09:19:12) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n[root@srvvtowerprd ~]# \r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\n[root@srvvtowerprd ~]# ansible-config dump --only-changed\r\n[root@srvvtowerprd ~]# \r\n\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Provide all relevant information below, e.g. target OS versions, network device firmware, etc. -->\r\nRHEL6\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\nCreate a playbook with the task described before and run it on a RHEL6 (or RHEL7) machine. It will fail.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n    - name: Habilitar el firewall para SNMP (RHEL6)\r\n      iptables:\r\n        action: append\r\n        chain: INPUT\r\n        protocol: udp\r\n        destination_port: 161\r\n        policy: ACCEPT\r\n        state: present\r\n        table: filter\r\n```\r\n\r\n<!--- HINT: You can paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- Describe what you expected to happen when running the steps above -->\r\nThe port is opened in iptables\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\nIt fails with an error about wrong option passed to iptables command\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nansible-playbook  -b --become-method sudo -K -i ./inventory open-iptables-port.yaml\r\n```\r\n",
        "created_at": "2018-10-31T01:05:15Z",
        "user": "gpulido-redhat",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "system"
        ]
    },
    {
        "number": 47350,
        "title": "better report if Ansible fails to parse output from module",
        "body": "<!--- Verify first that your feature was not already discussed on GitHub -->\r\n<!--- Complete *all* sections as described, this form is processed automatically -->\r\n\r\n##### SUMMARY\r\nAnsible returns generic error if it cannot parse output from module.\r\n```\r\nfatal: [server]: FAILED! => {\r\n    \"changed\": false,\r\n    \"module_stderr\": \"\",\r\n    \"module_stdout\": \"\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 0\r\n}\r\n```\r\nAnsible could report something more meaningfull like 'Failed to parse output from module'.\r\nCode handling the message is in /lib/ansible/plugins/action/__init__.py\r\n\r\n##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nplugins/action\r\n\r\n##### ADDITIONAL INFORMATION\r\n",
        "created_at": "2018-10-19T12:09:31Z",
        "user": "balonik",
        "labels": [
            "support:core",
            "feature",
            "affects_2.8",
            "P3"
        ]
    },
    {
        "number": 46744,
        "title": "Systemd module behavior differs from systemd when enabling services",
        "body": "##### SUMMARY\r\nActions that systemd module takes when enabling/disabling a service differ from the actions that calling systemctl from console produces.\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\nsystemd\r\n\r\n##### ANSIBLE VERSION\r\n```paste below\r\nansible 2.8.0.dev0 (systemd-unit-enabled-fix c9c8653e1a) last updated 2018/10/10 12:34:32 (GMT +200)\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/tadej/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/tadej/xlab/ansible/ansible/lib/ansible\r\n  executable location = /home/tadej/xlab/ansible/ansible/bin/ansible\r\n  python version = 2.7.15 (default, Sep 21 2018, 23:26:48) [GCC 8.1.1 20180712 (Red Hat 8.1.1-5)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```paste below\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nAnsible versions tested:\r\n\r\n  * 2.8.0.dev0 from git on GNU/Linux Fedora 28\r\n  * 2.7 from pypi on GNU/Linux Fedora 28\r\n  * 2.6 from official repos on GNU/Linux Fedora 28\r\n\r\nHosts being managed were Fedora 28 and CentOS 7.\r\n\r\n##### STEPS TO REPRODUCE\r\nRun the following playbook (we assume here that `tftp-server` package was installed on Fedora/CentOS):\r\n\r\n```yaml\r\n- hosts: all\r\n  become: yes\r\n\r\n  tasks:\r\n    - name: start tftp server\r\n      service:\r\n        name: tftp\r\n        enabled: yes\r\n```\r\n\r\nRelevant systemd units: `tftp.service` and `tftp.socket`\r\n\r\n```\r\n[Unit]\r\nDescription=Tftp Server\r\nRequires=tftp.socket\r\nDocumentation=man:in.tftpd\r\n\r\n[Service]\r\nExecStart=/usr/sbin/in.tftpd -s /var/lib/tftpboot\r\nStandardInput=socket\r\n\r\n[Install]\r\nAlso=tftp.socket\r\n```\r\n\r\n```\r\n[Unit]\r\nDescription=Tftp Server Activation Socket\r\n\r\n[Socket]\r\nListenDatagram=69\r\n\r\n[Install]\r\nWantedBy=sockets.target\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n`tftp.socket` service should be enabled, since this is what `Install` section of the `tftp.service` dictates.\r\n\r\n##### ACTUAL RESULTS\r\n`tftp.socket` is not modified at all.",
        "created_at": "2018-10-10T11:25:57Z",
        "user": "tadeboro",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "verified",
            "system",
            "affects_2.17"
        ]
    },
    {
        "number": 46112,
        "title": "Cannot remove sysvinit with apt module on debian wheezy",
        "body": "##### SUMMARY\r\nCannot remove sysvinit with apt module on debian wheezy\r\n\r\n##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes -->\r\n```paste below\r\nansible 2.5.1\r\n  config file = /home/user/playbook_path/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.15rc1 (default, Apr 15 2018, 21:51:34) [GCC 7.3.0]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- Paste verbatim output from \"ansible-config dump --only-changed\" between quotes -->\r\n```paste below\r\nANSIBLE_PIPELINING(/home/user/playbook_path/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/home/user/playbook_path/ansible.cfg) = -o ControlMaster=auto -o ControlPersist=60s\r\nANSIBLE_SSH_CONTROL_PATH_DIR(/home/user/playbook_path/ansible.cfg) = ./.ansible_cp\r\nANSIBLE_SSH_RETRIES(/home/user/playbook_path/ansible.cfg) = 5\r\nDEFAULT_PRIVATE_KEY_FILE(/home/usr/playbook_path/ansible.cfg) = /home/user/projects/playbook_path/test.pem\r\nDEFAULT_REMOTE_USER(/home/user/playbook_path/ansible.cfg) = root\r\nHOST_KEY_CHECKING(/home/user/playbook_path/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nLocal machine: \r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 18.04.1 LTS\r\nRelease:\t18.04\r\nCodename:\tbionic\r\n\r\nManaged machine: \r\nDistributor ID:\tDebian\r\nDescription:\tDebian GNU/Linux 7.11 (wheezy)\r\nRelease:\t7.11\r\nCodename:\twheezy\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- Describe exactly how to reproduce the problem, using a minimal test-case -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Remove sysvinit.\r\n  apt:\r\n    pkg: sysvinit\r\n    state: absent\r\n    force: yes\r\n\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nPackage removed.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!--- Describe what actually happened. If possible run with extra verbosity (-vvvv) -->\r\napt-get expects `'Yes, do as I say!'` as confirmation. `--force-yes`, `--assume-yes`, `--yes` flags are not working.\r\n<!--- Paste verbatim command output between quotes -->\r\n```paste below\r\nfatal: [remote_ip]: FAILED! => {\"changed\": false, \"msg\": \"'apt-get remove 'sysvinit'' failed: \", \"rc\": 1, \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"Reading package lists...\\nBuilding dependency tree...\\nReading state information...\\nThe following packages will be REMOVED:\\n  sysvinit\\nWARNING: The following essential packages will be removed.\\nThis should NOT be done unless you know exactly what you are doing!\\n  sysvinit\\n0 upgraded, 0 newly installed, 1 to remove and 5 not upgraded.\\nAfter this operation, 283 kB disk space will be freed.\\nYou are about to do something potentially harmful.\\nTo continue type in the phrase 'Yes, do as I say!'\\n ?] Abort.\\n\", \"stdout_lines\": [\"Reading package lists...\", \"Building dependency tree...\", \"Reading state information...\", \"The following packages will be REMOVED:\", \"  sysvinit\", \"WARNING: The following essential packages will be removed.\", \"This should NOT be done unless you know exactly what you are doing!\", \"  sysvinit\", \"0 upgraded, 0 newly installed, 1 to remove and 5 not upgraded.\", \"After this operation, 283 kB disk space will be freed.\", \"You are about to do something potentially harmful.\", \"To continue type in the phrase 'Yes, do as I say!'\", \" ?] Abort.\"]}\r\n```\r\n",
        "created_at": "2018-09-25T11:17:42Z",
        "user": "Fotoblysk",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3",
            "packaging"
        ]
    },
    {
        "number": 44869,
        "title": "setup module: gathering facts fails on FreeBSD if tunnel is present",
        "body": "##### SUMMARY\r\nOn FreeBSD hosts gathering network facts does'n work for tunnel interface ([tun(4)](https://www.freebsd.org/cgi/man.cgi?query=tun&sektion=4)) is present. If `IFCONFIG_FORMAT=inet:cid` environment variable is set module fails with error `error('illegal IP address string passed to inet_aton',)` otherwise incorrect netmask returned for tun interface.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nsetup module\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```ansible 2.6.3\r\n  config file = /usr/home/citrin/w/ansible-test/ansible.cfg\r\n  configured module search path = ['/home/citrin/.ansible/plugins/modules', '/usr/local/share/py36-ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.6 (default, Aug  7 2018, 12:18:31) [GCC 4.2.1 Compatible FreeBSD Clang 4.0.0 (tags/RELEASE_400/final 297347)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nNo relevant config changes.\r\n\r\n##### OS / ENVIRONMEN\r\n\r\nFreeBSD 11 amd64 on both: control and managed hosts.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create tunnel interface. In my case it was created by OpenVPN, but it can be created manually\r\n```\r\nifconfig tun9 create\r\nifconfig tun9 inet 192.0.2.1 192.0.2.2 netmask 255.255.255.0\r\nifconfig tun9 up\r\n```\r\n2. Set `IFCONFIG_FORMAT=inet:cidr,inet6:cidr` environment variable (exacts steps depends on used shell).\r\n\r\nifconfig output looks like:\r\n```\r\n> ifconfig tun9                                                                                                                               [0]\r\ntun9: flags=8051<UP,POINTOPOINT,RUNNING,MULTICAST> metric 0 mtu 1500\r\n\toptions=80000<LINKSTATE>\r\n\tinet 192.0.2.1 --> 192.0.2.2/24 \r\n\tnd6 options=29<PERFORMNUD,IFDISABLED,AUTO_LINKLOCAL>\r\n\tgroups: tun\r\n```\r\n\r\n3. Run `ansible localhost -m setup`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNetwork settings in resulting JSON\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFacts JSON without network settings.\r\n\r\n```\r\n> ANSIBLE_KEEP_REMOTE_FILES=1 ansible localhost -m setup -vvv\r\n...skipped...\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/local/bin/python3.6 /tmp/citrin/ansible-tmp-1535579150.976911-61719197742330/setup.py && sleep 0'\r\n...skipped...\r\n> /usr/local/bin/python3.6 /tmp/citrin/ansible-tmp-1535579150.976911-61719197742330/setup.py\r\n...skipped...\r\nOSError('illegal IP address string passed to inet_aton',)\r\n```",
        "created_at": "2018-08-29T21:52:15Z",
        "user": "citrin",
        "labels": [
            "easyfix",
            "python3",
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "bsd",
            "system"
        ]
    },
    {
        "number": 44338,
        "title": "Add SOCKS proxy support to uri module",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nTHIS FORM WILL BE READ BY A MACHINE, COMPLETE ALL SECTIONS AS DESCRIBED.\r\nAlso test if the latest release, and devel branch are affected too.\r\nALWAYS add information AFTER (OUTSIDE) these html comments.\r\nOtherwise it may end up being automatically closed by our bot. -->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nHTTP/HTTPS proxies are supported with uri, but not SOCKS. \r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Insert, BELOW THIS COMMENT, the name of the module, plugin, task or feature.\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path-->\r\nuri\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste, BELOW THIS COMMENT, verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.6.2\r\n  config file = /Users/sdodd/net_dump/ansible.cfg\r\n  configured module search path = [u'/Users/sdodd/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.14 (default, Jan  6 2018, 12:16:16) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- If using Ansible 2.4 or above, paste, BELOW THIS COMMENT, the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Mention, BELOW THIS COMMENT, the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.-->\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- For bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used. -->\r\nTopology:\r\n[localhost] -- [bastion] -- [remote]\r\n\r\nSimilar to the following shell commands:\r\nssh -D 9000 -N bastion.net\r\ncurl --proxy socks5://localhost:9000 https://remote.com\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\nOne option could be to set an environment variable, similar to the examples here:\r\nhttps://docs.ansible.com/ansible/2.6/user_guide/playbooks_environment.html\r\n\r\n```\r\n environment:\r\n      ALL_PROXY: \"socks5://localhost:9000\"\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nI would expect the proxied request to successfully transact.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n<10.0.5.191> EXEC /bin/sh -c 'ALL_PROXY=socks5://localhost:9000 all_proxy=socks5://localhost:9000 /usr/bin/python /Users/sdodd/.ansible/tmp/ansible-tmp-1534544584.6-36889175351587/uri.py && sleep 0'\r\n\r\n...\r\n    \"msg\": \"Status code was -1 and not [200]: Request failed: <urlopen error timed out>\",\r\n    \"redirected\": false,\r\n    \"status\": -1,\r\n    \"url\": \"https://10.0.5.191/logincheck\"\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n\r\n```\r\n",
        "created_at": "2018-08-17T22:26:31Z",
        "user": "idahood",
        "labels": [
            "module",
            "net_tools",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "affects_2.11"
        ]
    },
    {
        "number": 44186,
        "title": "User module does not populate home folder with skel when creating a home folder",
        "body": "##### SUMMARY\r\nWhen creating a new user account using the `user` module of Ansible for a macOS 10.13 target with this playbook:\r\n\r\n```yaml\r\n---\r\n- hosts: all\r\n  gather_facts: True\r\n  tasks:\r\n    - user:\r\n        name=foo\r\n        shell=/bin/bash\r\n        comment=Foo\r\n```\r\n\r\nI expect the newly created home folder to contain the contents of the skel directory (located at `/System/Library/User Template/English.lproj/` on macOS when using an English locale). Instead the newly created home folder is empty. On Debian, for example, the contents of `/etc/skel` is copied to new home folders as expected.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nuser\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.6.1\r\n  config file = /Users/ploy/config/ansible/ansible.cfg\r\n  configured module search path = ['/Users/ploy/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Users/ploy/Library/Python/3.5/lib/python/site-packages/ansible\r\n  executable location = /Users/ploy/Library/Python/3.5/bin/ansible\r\n  python version = 3.5.6 (default, Aug  4 2018, 07:39:57) [GCC 4.2.1 Compatible Apple LLVM 9.1.0 (clang-902.0.39.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nDEFAULT_BECOME_METHOD(/Users/ploy/config/ansible/ansible.cfg) = machinectl\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/Users/ploy/config/ansible/ansible.cfg) = ['/Users/ploy/config/ansible/callback']\r\nDEFAULT_FORKS(/Users/ploy/config/ansible/ansible.cfg) = 20\r\nDEFAULT_HOST_LIST(/Users/ploy/config/ansible/ansible.cfg) = ['/Users/ploy/config/ansible/inv/default']\r\nRETRY_FILES_ENABLED(/Users/ploy/config/ansible/ansible.cfg) = True\r\nRETRY_FILES_SAVE_PATH(/Users/ploy/config/ansible/ansible.cfg) = /Users/ploy/config/ansible/retry\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nRunning from: macOS 10.13\r\nManaging: macOS 10.13\r\n\r\n##### STEPS TO REPRODUCE\r\nSee the summary above.\r\n\r\n##### EXPECTED RESULTS\r\nThe newly created home folder contains directories such as: Desktop, Documents, Downloads, Library, Movies, Music, Pictures, Public... Exactly the content that I see when I create a new user manually using the GUI tool `System Preferences.app`.\r\n\r\n##### ACTUAL RESULTS\r\nThe newly created home folder is empty.",
        "created_at": "2018-08-15T16:57:12Z",
        "user": "Ploy-XIV",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "affects_2.6",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 43274,
        "title": "script module with become prepends stdout with \\r\\n",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nTHIS FORM WILL BE READ BY A MACHINE, COMPLETE ALL SECTIONS AS DESCRIBED.\r\nAlso test if the latest release, and devel branch are affected too.\r\nALWAYS add information AFTER (OUTSIDE) these html comments.\r\nOtherwise it may end up being automatically closed by our bot. -->\r\n\r\n##### SUMMARY\r\nscript module prepends stdout with \\r\\n when used with become=yes\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Insert, BELOW THIS COMMENT, the name of the module, plugin, task or feature.\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path-->\r\nscript\r\nssh\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste, BELOW THIS COMMENT, verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.6.1\r\n  config file = /home/rowagn/ansible.cfg\r\n  configured module search path = [u'/home/rowagn/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /bin/ansible\r\n  python version = 2.7.5 (default, Feb 20 2018, 09:19:12) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- If using Ansible 2.4 or above, paste, BELOW THIS COMMENT, the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).-->\r\nALLOW_WORLD_READABLE_TMPFILES(/home/rowagn/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/home/rowagn/ansible.cfg) = True\r\nANSIBLE_SSH_ARGS(/home/rowagn/ansible.cfg) = -o ControlMaster=no\r\nDEFAULT_EXECUTABLE(/home/rowagn/ansible.cfg) = /etc/ansible-wrapper\r\nDEFAULT_HOST_LIST(/home/rowagn/ansible.cfg) = [u'/home/rowagn/hosts']\r\nRETRY_FILES_ENABLED(/home/rowagn/ansible.cfg) = False\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Mention, BELOW THIS COMMENT, the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.-->\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- For bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used. -->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\nrowagn@dbatower01:~#> cat hosts\r\n[all]\r\nlocalhost\r\n\r\nrowagn@dbatower01:~#> cat a.sh\r\n#!/bin/sh\r\n\r\necho \"line 1\"\r\necho \"line 2\"\r\n\r\nrowagn@dbatower01:~#> cat a.yml\r\n---\r\n- hosts: all\r\n#  become: yes\r\n#  become_user: root\r\n  tasks:\r\n  - script: \"{{ playbook_dir }}/a.sh\"\r\n    register: A\r\n  - debug:\r\n      msg=\"{{ A }}\"\r\n\r\nrowagn@dbatower01:~#> cat b.yml\r\n---\r\n- hosts: all\r\n  become: yes\r\n  become_user: root\r\n  tasks:\r\n  - script: \"{{ playbook_dir }}/a.sh\"\r\n    register: A\r\n  - debug:\r\n      msg=\"{{ A }}\"\r\n\r\nrowagn@dbatower01:~#> ansible-playbook a.yml -k\r\nrowagn@dbatower01:~#> ansible-playbook b.yml -k -K\r\n\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nstdout should be identical between the two playbooks.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nstdout is prepended with \\r\\n when running b.yml (i.e., when including become: yes)\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nrowagn@dbatower01:~#> ansible-playbook a.yml -k\r\nSSH password:\r\n\r\nPLAY [all] ***************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [script] ************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [debug] *************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": {\r\n        \"changed\": true,\r\n        \"failed\": false,\r\n        \"rc\": 0,\r\n        \"stderr\": \"Connection to localhost closed.\\r\\n\",\r\n        \"stderr_lines\": [\r\n            \"Connection to localhost closed.\"\r\n        ],\r\n        \"stdout\": \"line 1\\r\\nline 2\\r\\n\",\r\n        \"stdout_lines\": [\r\n            \"line 1\",\r\n            \"line 2\"\r\n        ]\r\n    }\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************\r\nlocalhost                  : ok=3    changed=1    unreachable=0    failed=0\r\n\r\nrowagn@dbatower01:~#> ansible-playbook b.yml -k -K\r\nSSH password:\r\nSUDO password[defaults to SSH password]:\r\n\r\nPLAY [all] ***************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [script] ************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [debug] *************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"msg\": {\r\n        \"changed\": true,\r\n        \"failed\": false,\r\n        \"rc\": 0,\r\n        \"stderr\": \"Connection to localhost closed.\\r\\n\",\r\n        \"stderr_lines\": [\r\n            \"Connection to localhost closed.\"\r\n        ],\r\n        \"stdout\": \"\\r\\nline 1\\r\\nline 2\\r\\n\",\r\n        \"stdout_lines\": [\r\n            \"\",\r\n            \"line 1\",\r\n            \"line 2\"\r\n        ]\r\n    }\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************************************\r\nlocalhost                  : ok=3    changed=1    unreachable=0    failed=0\r\n\r\n\r\n```\r\n",
        "created_at": "2018-07-25T20:44:43Z",
        "user": "rwagnergit",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "verified",
            "commands"
        ]
    },
    {
        "number": 42561,
        "title": " 'class' is not a valid variable name from include_* vars section but is valid as a command line argument",
        "body": "##### SUMMARY\r\nWhen using the extravars commandline argument to pass a value to a variable called **class**, used inside the playbook we get no warning. When using the same variable name when calling the same playbook with the include call specifying the variable **class** in the vars section, we get the following error.\r\n\r\n`\"Invalid variable name in vars specified for TaskInclude: 'class' is not a valid variable name`\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Insert, BELOW THIS COMMENT, the name of the module, plugin, task or feature.\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path-->\r\ninclude_tasks\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste, BELOW THIS COMMENT, verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.5.4\r\n  config file = .ansible.cfg\r\n  configured module search path = [u'/usr/lib/python2.7/site-packages/ara/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.14 (default, Sep 25 2017, 09:53:17) [GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.42.1)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- If using Ansible 2.4 or above, paste, BELOW THIS COMMENT, the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).-->\r\n\r\nANSIBLE_SSH_ARGS(/Volumes/.ansible.cfg) = -o ControlPersist=300s -o ControlMaster=auto\r\nDEFAULT_ACTION_PLUGIN_PATH(/Volumes/.ansible.cfg) = [u'/usr/lib/python2.7/site-packages/ara/plugins/actions']\r\nDEFAULT_CALLBACK_PLUGIN_PATH(/Volumes/.ansible.cfg) = [u'/usr/lib/python2.7/site-packages/ara/plugins/callbacks']\r\nDEFAULT_CALLBACK_WHITELIST(/Volumes/.ansible.cfg) = ['profile_tasks', 'logstash']\r\nDEFAULT_LOG_PATH(/Volumes/.ansible.cfg) = /Volumes/diskE/Users/msn3/log/DS/svc_worker.log\r\nDEFAULT_MODULE_PATH(/Volumes/.ansible.cfg) = [u'/usr/lib/python2.7/site-packages/ara/plugins/modules']\r\nDEFAULT_ROLES_PATH(/Volumes/.ansible.cfg) = [u'/Volumes/ansible-workspace/ds-roles']\r\nDEFAULT_STDOUT_CALLBACK(/Volumes/.ansible.cfg) = skippy\r\nDEFAULT_VAULT_PASSWORD_FILE(/Volumes/.ansible.cfg) = /Volumes/vps.txt\r\nHOST_KEY_CHECKING(/Volumes/.ansible.cfg) = False\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Mention, BELOW THIS COMMENT, the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.-->\r\nMac osx 10.11.6\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- For bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used. -->\r\nThis works:\r\n`ansible-playbook playbooks/infrastructure.yml -i inventory -u root -e class=host -e do=create  -e target=justatest01 `\r\n\r\nthis does not work:\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n    - include: \"playbooks/infrastructure.yml\"\r\n      vars:\r\n        class: host\r\n        do: create\r\n        target: justatest01\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nWe expected that the included playbook would just work as the command line version\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nthe playbook does not run \r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n    fatal: [localhost]: FAILED! => {\r\n        \"reason\": \"Invalid variable name in vars specified for TaskInclude: 'class' is not a valid variable name\\\r\n```\r\n",
        "created_at": "2018-07-10T08:26:18Z",
        "user": "mihai-satmarean",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "utilities"
        ]
    },
    {
        "number": 41413,
        "title": "Fact caching fails for hosts that contain / character with file based cache plugins",
        "body": "##### SUMMARY\r\nHosts that contain the `/` character in their name will cause fact gathering to fail when using file-based plugins, such as `jsonfile`.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ngather_facts\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.5.4\r\n  config file = None\r\n  configured module search path = [u'/home/ryanpetrello/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/ryanpetrello/venvs/tmp-f30da7ecd0904ce6/lib/python2.7/site-packages/ansible\r\n  executable location = /home/ryanpetrello/venvs/tmp-f30da7ecd0904ce6/bin/ansible\r\n  python version = 2.7.14 (default, Mar 14 2018, 16:45:33) [GCC 8.0.1 20180222 (Red Hat 8.0.1-0.16)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\n$ ansible-config dump --only-changed\r\n(empty)\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nFedora 28\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\n$ cat gather.yml\r\n- hosts: all\r\n  gather_facts: true\r\n```\r\n\r\n```\r\n$ cat inv\r\n[all]\r\nfoo/bar ansible_ssh_host=localhost ansible_connection=local\r\n```\r\n##### EXPECTED RESULTS\r\nFacts for the `foo/bar` host to be cached on the local file system.\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n$ mkdir `pwd`/facts\r\n$ ANSIBLE_CACHE_PLUGIN=jsonfile ANSIBLE_CACHE_PLUGIN_CONNECTION=`pwd`/facts ansible-playbook -i inv gather.yml\r\n\r\nPLAY [all] ******************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************************************\r\n [WARNING]: error in 'jsonfile' cache plugin while trying to write to /home/ryanpetrello/venvs/tmp-f30da7ecd0904ce6/facts/foo/bar : [Errno 2] No such file or\r\ndirectory: u'/home/ryanpetrello/venvs/tmp-f30da7ecd0904ce6/facts/foo/bar'\r\n\r\nok: [foo/bar]\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************\r\nfoo/bar                    : ok=1    changed=0    unreachable=0    failed=0\r\n```",
        "created_at": "2018-06-11T18:43:30Z",
        "user": "ryanpetrello",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "system",
            "affects_2.11"
        ]
    },
    {
        "number": 39828,
        "title": "Module \"git\" returns changed every time when url.<base>.insteadOf is used",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nTHIS FORM WILL BE READ BY A MACHINE, COMPLETE ALL SECTIONS AS DESCRIBED.\r\nAlso test if the latest release, and devel branch are affected too.\r\nALWAYS add information AFTER (OUTSIDE) these html comments.\r\nOtherwise it may end up being automatically closed by our bot. -->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Insert, BELOW THIS COMMENT, the name of the module, plugin, task or feature.\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path-->\r\ngit\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste, BELOW THIS COMMENT, verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.6.0 (devel ea7883ef7e) last updated 2018/05/07 22:13:24 (GMT +200)\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/git/ansible/lib/ansible\r\n  executable location = /home/user/git/ansible/bin/ansible\r\n  python version = 2.7.14 (default, Mar 14 2018, 13:29:26) [GCC 7.3.1 20180130 (Red Hat 7.3.1-2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!--- If using Ansible 2.4 or above, paste, BELOW THIS COMMENT, the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).-->\r\nNone\r\n\r\n##### OS / ENVIRONMENT\r\n<!--- Mention, BELOW THIS COMMENT, the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.-->\r\nN/A\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nThe `git` module always returns `\"remote_url_changed\": true` and therefore `\"changed\": true` when a Git variable [`url.<base>.insteadOf`](https://git-scm.com/docs/git-config#git-config-urlltbasegtinsteadOf) is used as URL alias.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!--- For bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used. -->\r\nCreate a Git \"URL alias\":\r\n```\r\n$ git config --global url.'https://github.com'.insteadOf 'github'\r\n```\r\nCreate a minimal example playbook `git-test.yaml`:\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  tasks:\r\n    - git:\r\n        repo: 'github/ansible/ansible'\r\n        dest: '~/ansible'\r\n        version: stable-2.5\r\n```\r\nRun the playbook twice:\r\n```\r\n$ ansible-playbook -v git-test.yaml\r\n```\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nThe second time the playbook is run I expect no change (unless someone changed the branch `stable-2.5` between the two invocations).\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nThe task returns `changed` every time and `remote_url_changed` is true.\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n$ ansible-playbook -vvvv git-test.yaml\r\nansible-playbook 2.6.0 (devel ea7883ef7e) last updated 2018/05/07 22:13:24 (GMT +200)\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/git/ansible/lib/ansible\r\n  executable location = /home/user/git/ansible/bin/ansible-playbook\r\n  python version = 2.7.14 (default, Mar 14 2018, 13:29:26) [GCC 7.3.1 20180130 (Red Hat 7.3.1-2)]\r\nNo config file found; using defaults\r\nsetting up inventory plugins\r\n [WARNING]: Unable to parse /etc/ansible/hosts as an inventory source\r\n\r\n [WARNING]: No inventory was parsed, only implicit localhost is available\r\n\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nLoading callback plugin default of type stdout, v2.0 from /home/user/git/ansible/lib/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: git-test.yaml ***********************************************************************************************************************\r\n1 plays in git-test.yaml\r\n\r\nPLAY [localhost] ******************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ************************************************************************************************************************\r\ntask path: /home/user/git/git-test/git-test.yaml:2\r\nUsing module file /home/user/git/ansible/lib/ansible/modules/system/setup.py\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: user\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~user && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014 `\" && echo ansible-tmp-1525729687.0-109597551709014=\"` echo /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014 `\" ) && sleep 0'\r\n<127.0.0.1> PUT /home/user/.ansible/tmp/ansible-local-11633UFWJ4U/tmpDoxoH_ TO /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014/setup.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014/ /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014/setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/home/user/git/ansible/venv/bin/python /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014/setup.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/user/.ansible/tmp/ansible-tmp-1525729687.0-109597551709014/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost]\r\nMETA: ran handlers\r\n\r\nTASK [git] ************************************************************************************************************************************\r\ntask path: /home/user/git/git-test/git-test.yaml:4\r\nUsing module file /home/user/git/ansible/lib/ansible/modules/source_control/git.py\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: user\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~user && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000 `\" && echo ansible-tmp-1525729688.31-252984094974000=\"` echo /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000 `\" ) && sleep 0'\r\n<127.0.0.1> PUT /home/user/.ansible/tmp/ansible-local-11633UFWJ4U/tmp8abKlW TO /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000/git.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000/ /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000/git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/home/user/git/ansible/venv/bin/python /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000/git.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/user/.ansible/tmp/ansible-tmp-1525729688.31-252984094974000/ > /dev/null 2>&1 && sleep 0'\r\nchanged: [localhost] => {\r\n    \"after\": \"bf1436ca52a5088109812931fc51667ffafc2199\", \r\n    \"before\": \"bf1436ca52a5088109812931fc51667ffafc2199\", \r\n    \"changed\": true, \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"accept_hostkey\": false, \r\n            \"archive\": null, \r\n            \"bare\": false, \r\n            \"clone\": true, \r\n            \"depth\": null, \r\n            \"dest\": \"/home/user/ansible\", \r\n            \"executable\": null, \r\n            \"force\": false, \r\n            \"key_file\": null, \r\n            \"recursive\": true, \r\n            \"reference\": null, \r\n            \"refspec\": null, \r\n            \"remote\": \"origin\", \r\n            \"repo\": \"github/ansible/ansible\", \r\n            \"ssh_opts\": null, \r\n            \"track_submodules\": false, \r\n            \"umask\": null, \r\n            \"update\": true, \r\n            \"verify_commit\": false, \r\n            \"version\": \"stable-2.5\"\r\n        }\r\n    }, \r\n    \"remote_url_changed\": true\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0   \r\n```\r\n",
        "created_at": "2018-05-07T21:52:17Z",
        "user": "labanskoller",
        "labels": [
            "module",
            "support:core",
            "bug",
            "affects_2.6",
            "P3",
            "needs_verified",
            "source_control"
        ]
    },
    {
        "number": 38938,
        "title": "copy: Reports 'ok' when copying nested directories",
        "body": "##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nCopy module\r\n\r\n##### ANSIBLE VERSION\r\n2.5.0\r\n\r\n##### CONFIGURATION\r\n\r\n##### OS / ENVIRONMENT\r\nlinux\r\n\r\n##### SUMMARY\r\nI have a problem with ansible 2.5 and i don't have the same behaviour with 2.2\r\nWhen I copy a folder contain just a folder I have an OK not Changed\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\ntask : \r\n- name:  copy folder share\r\n  copy:\r\n     dest: \"/opt/\"\r\n     mode: 0644\r\n     owner: root\r\n     group: root\r\n     src: \"./share\"\r\n```\r\n\r\n share folder contain just one folder named folder1 and folder1 contains one file:file1\r\n##### EXPECTED RESULTS\r\nansible task status is changed\r\n##### ACTUAL RESULTS\r\nansible task status is OK\r\n\r\n```\r\n\r\n```\r\n",
        "created_at": "2018-04-18T09:18:18Z",
        "user": "simanat",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3",
            "verified",
            "files",
            "affects_2.13"
        ]
    },
    {
        "number": 38791,
        "title": "apt autoremove and autoclean ignored when other options are set",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and devel branch are affected too.\r\nAlways add information AFTER of these html comments.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\napt\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.5.0\r\n  config file = /home/r/Dokumente/Computersachen/ansible/ansible.cfg\r\n  configured module search path = [u'/home/r/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.14+ (default, Apr  2 2018, 04:16:25) [GCC 7.3.0]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nDEFAULT_BECOME(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = True\r\nDEFAULT_BECOME_ASK_PASS(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = True\r\nDEFAULT_HASH_BEHAVIOUR(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = merge\r\nDEFAULT_HOST_LIST(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = [u'/home/r/Dokumente/Computersachen/ansible/hosts']\r\nDEFAULT_STDOUT_CALLBACK(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = debug\r\nDIFF_ALWAYS(/home/r/Dokumente/Computersachen/ansible/ansible.cfg) = True\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nAnsible host: Debian testing\r\nAnsible remote: Debian Stretch\r\n\r\n##### SUMMARY\r\n`apt` silently does not run `autoremove` or `autoclean` when it is doing other things, like `upgrade`.\r\n\r\n##### STEPS TO REPRODUCE\r\nBased on the documentation, I expected the following task\r\n```\r\n  - name: autoremove\r\n    apt: autoremove=yes autoclean=yes update_cache=yes upgrade=dist\r\n```\r\nto do all of the jobs I enabled. However, after using this for some time I realized that autoremove and autoclean are not run.\r\nSo I turned this into two tasks\r\n```\r\n  - name: autoremove\r\n    apt: autoremove=yes autoclean=yes\r\n  - name: system upgrade\r\n    apt: update_cache=yes upgrade=dist\r\n```\r\nonly to realize that now autoclean runs, but autoremove still does not.\r\n\r\n##### EXPECTED RESULTS\r\nThe two tasksets above should both run all the jobs (autoremove, autoclean, update, upgrade).\r\n\r\nOr, of that for some reason is not desired behavior (though I think it is), this should be clearly stated in the documentation *and* warnings should be emitted when things are enabled but not run.\r\n\r\n##### ACTUAL RESULTS\r\nThe first one just runs update and upgrade. The second one runs autoclean, update, upgrade.\r\n\r\n\r\n",
        "created_at": "2018-04-15T14:00:40Z",
        "user": "RalfJung",
        "labels": [
            "module",
            "support:core",
            "affects_2.5",
            "bug",
            "P3",
            "packaging"
        ]
    },
    {
        "number": 38702,
        "title": "Become Method fails with permission denied ansible 2.5.0 with local connection method",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and devel branch are affected too.\r\nAlways add information AFTER of these html comments.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nbecome\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.5.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/admin/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nEmpty (no changes listed)\r\n-->\r\nansible-config dump --only-changed\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n--->\r\n##### SUMMARY\r\nWhen using the 'become' method from a root user to a non-privileged user, the system responds with permission denied atal: [localhost]: \r\n\r\nFAILED! => {\"changed\": false, \"module_stderr\": \"/usr/bin/python2: can't open file '/root/.ansible/tmp/ansible-tmp-1523570295.39-97329820046336/command.py': [Errno 13] Permission denied\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\", \"rc\": 2}\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n - name: create new keys since they aren't part of build process\r\n    become: true\r\n    become_user: admin\r\n    command: /home/admin/mcp D\r\n    args:\r\n      chdir: /home/admin\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\nPlays happen next but get error\r\n\r\n##### ACTUAL RESULTS\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"module_stderr\": \"/usr/bin/python2: can't open file '/root/.ansible/tmp/ansible-tmp-1523570295.39-97329820046336/command.py': [Errno 13] Permission denied\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\", \"rc\": 2}\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\natal: [localhost]: FAILED! => {\"changed\": false, \"module_stderr\": \"/usr/bin/python2: can't open file '/root/.ansible/tmp/ansible-tmp-1523570295.39-97329820046336/command.py': [Errno 13] Permission denied\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\", \"rc\": 2}\r\n```\r\n",
        "created_at": "2018-04-12T22:24:19Z",
        "user": "symgryph",
        "labels": [
            "support:core",
            "affects_2.5",
            "bug",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 38176,
        "title": "never tag does not show up with --list-tags",
        "body": "##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nlib/ansible/playbook/taggable.py\r\nlib/ansible/playbook/base.py\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.5.0\r\n  config file = /Users/nunya/ecs_pipeline/ansible.cfg\r\n  configured module search path = ['/usr/share/ansible/plugins/modules', '/Users/nunya/ecs_pipeline/library']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 3.6.5 (default, Mar 30 2018, 06:42:10) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\n```\r\nANSIBLE_SSH_ARGS(/Users/nunya/ecs_pipeline/ansible.cfg) = -o StrictHostKeyChecking=no -o ConnectTimeout=3 -o UserKnownHostsFile=/dev/null\r\nDEFAULT_CALLBACK_WHITELIST(/Users/nunya/ecs_pipeline/ansible.cfg) = ['full_skip']\r\nDEFAULT_HOST_LIST(/Users/nunya/ecs_pipeline/ansible.cfg) = ['/Users/nunya/ecs_pipeline/inventory']\r\nDEFAULT_MANAGED_STR(/Users/nunya/ecs_pipeline/ansible.cfg) = \"#############################\r\n***      Ansible      ***\r\nModified on: %Y-%m-%d %H:%M:%S\r\nBy: {uid} on {host}\r\nUsing template: {file}\r\nDEFAULT_MODULE_PATH(/Users/nunya/ecs_pipeline/ansible.cfg) = ['/usr/share/ansible/plugins/modules', '/Users/nunya/ecs_pipeline/library']\r\nDEFAULT_ROLES_PATH(/Users/nunya/ecs_pipeline/ansible.cfg) = ['/Users/nunya/ecs_pipeline/roles']\r\nDEFAULT_STDOUT_CALLBACK(/Users/nunya/ecs_pipeline/ansible.cfg) = full_skip\r\nDEFAULT_VAULT_PASSWORD_FILE(/Users/nunya/ecs_pipeline/ansible.cfg) = /Users/nunya/ecs_pipeline/.vpw\r\nHOST_KEY_CHECKING(/Users/nunya/ecs_pipeline/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/Users/nunya/ecs_pipeline/ansible.cfg) = False\r\n```\r\n##### OS / ENVIRONMENT\r\nMacOSX\r\n\r\n##### SUMMARY\r\nnever tag hides other tags\r\n\r\n##### STEPS TO REPRODUCE\r\nattach `never` tag to a task\r\nansible-playbook playbook.yml --list-tags\r\n\r\n```yaml\r\n# --list-tags doesn't show 'container_definition' nor 'never' tag\r\n- include_tasks: \"container_definition.yml\"\r\n  tags:\r\n    - container_definition\r\n    - never\r\n```\r\n\r\n```yaml\r\n# --list-tags shows 'container_definition'\r\n- include_tasks: \"container_definition.yml\"\r\n  tags:\r\n    - container_definition\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\nAll tags including `container_definition` and `never` would show\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`container_definition` tag does not show \r\n`never` tag does not show\r\n```\r\nansible-playbook 2.5.0\r\n  config file = /Users/reinose/ecs_pipeline/ansible.cfg\r\n  configured module search path = ['/usr/share/ansible/plugins/modules', '/Users/reinose/ecs_pipeline/library']\r\n  ansible python module location = /usr/local/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 3.6.5 (default, Mar 30 2018, 06:42:10) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)]\r\nUsing /Users/reinose/ecs_pipeline/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed /Users/reinose/ecs_pipeline/inventory/hosts.inv inventory source with ini plugin\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\n1 plays in playbooks/ecs_service.yml\r\n\r\nplaybook: playbooks/ecs_service.yml\r\n\r\n  play #1 (localhost): localhost\tTAGS: []\r\n      TASK TAGS: [always]\r\n```\r\n",
        "created_at": "2018-04-02T13:29:45Z",
        "user": "SimplySeth",
        "labels": [
            "support:core",
            "affects_2.5",
            "bug",
            "has_pr",
            "P3"
        ]
    },
    {
        "number": 37697,
        "title": "Unclear error messages when a dict is missing an attribute",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nunsure\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.3.0\r\n  config file = /mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg\r\n  configured module search path = [u'/home/chrome/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.12 (default, Dec  4 2017, 14:50:18) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_NOCOWS(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = True\r\nANSIBLE_PIPELINING(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = True\r\nDEFAULT_ROLES_PATH(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = [u'/mnt/c/Users/chrome/Development/ansible\r\nDEFAULT_STDOUT_CALLBACK(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = debug\r\nDEPRECATION_WARNINGS(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = False\r\nRETRY_FILES_ENABLED(/mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nubuntu 1604\r\n\r\n##### SUMMARY\r\nWhen ansible is unable to find a key in a dict, it prints an unhelpful error message. It would be helpful if it mentioned the exact line the object was referenced, and if it would mention exactly which object was referenced.\r\n\r\n##### STEPS TO REPRODUCE\r\nExecute the following playbook:\r\n\r\n```yaml\r\n# a playbook to demonstrate bad error messages when there is a missing key on a dict.\r\n---\r\n- name: \"Testing stuff\"\r\n  hosts: localhost\r\n  gather_facts: False \r\n  vars:\r\n    sample:\r\n      thing1: one\r\n      thing2: two\r\n      thing3: three\r\n\r\n  tasks:\r\n    - name: \"debug\"\r\n      debug:\r\n        msg:\r\n          one: \"{{sample['thing1']}}\"\r\n          two: \"{{sample['whoops']}}\"\r\n          three: \"{{sample['thing3']}}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPreferably the object missing the attribute (sample) and the line it was referenced on (line 17) should be mentioned in the error output.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\nAnsible highlights the wrong line (but identifies the correct task). It also does not mention which object in particular is missing the attribute.\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nchrome@ORAC:~/Development/ansible-smc$ ansible-playbook -vvv -i inventory/development playbooks/adhoc/test-attribute-err\r\nor.yml\r\nansible-playbook 2.4.3.0\r\n  config file = /mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg\r\n  configured module search path = [u'/home/chrome/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 2.7.12 (default, Dec  4 2017, 14:50:18) [GCC 5.4.0 20160609]\r\nUsing /mnt/c/Users/chrome/Development/ansible-smc/ansible.cfg as config file\r\nParsed /mnt/c/Users/chrome/Development/ansible-smc/inventory/development/ec2.py inventory source with script plugin\r\nParsed /mnt/c/Users/chrome/Development/ansible-smc/inventory/development/localhost inventory source with ini plugin\r\n\r\nPLAYBOOK: test-attribute-error.yml *************************************************************************************\r\n1 plays in playbooks/adhoc/test-attribute-error.yml\r\n\r\nPLAY [Testing stuff] ***************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [debug] ***********************************************************************************************************\r\ntask path: /mnt/c/Users/chrome/Development/ansible-smc/playbooks/adhoc/test-attribute-error.yml:13\r\nfatal: [localhost]: FAILED! => {}\r\n\r\nMSG:\r\n\r\nThe task includes an option with an undefined variable. The error was: 'dict object' has no attribute 'whoops'\r\n\r\nThe error appears to have been in '/mnt/c/Users/chrome/Development/ansible-smc/playbooks/adhoc/test-attribute-error.yml': line 13, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n  tasks:\r\n    - name: \"debug\"\r\n      ^ here\r\n\r\nexception type: <class 'ansible.errors.AnsibleUndefinedVariable'>\r\nexception: 'dict object' has no attribute 'whoops'\r\n\r\n\r\nPLAY RECAP *************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1\r\n```\r\n",
        "created_at": "2018-03-21T07:17:23Z",
        "user": "matjam",
        "labels": [
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "verified"
        ]
    },
    {
        "number": 37398,
        "title": "`user` module with `local: true` fail to move nonexistent user home dir despite that `createhome: true` is set",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and devel branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!---\r\nName of the module, plugin, task or feature\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path\r\n-->\r\n`user` module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.3.0\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.13 (default, Nov 24 2017, 17:33:09) [GCC 6.3.0 20170516]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nIf using Ansible 2.4 or above, paste the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\nNot modified\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n-->\r\nMaster: Debian GNU/Linux 9.3 (stretch)\r\nSlave1: CentOS Linux release 7.4.1708 (Core)\r\nSlave2: Debian GNU/Linux 9.3 (stretch)\r\n##### SUMMARY\r\nAs title say.\r\nAlso, removing user with nonexistent home and `local: true` lead to fail, while with `local: false` just complain on absent dir.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\nInstall `libuser`.\r\nDo not use any IPA engine, since it is interfere with `useradd/mod` and provided play may behave differently.\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  vars:\r\n    username: 'testuser'\r\n  become: true\r\n  tasks:\r\n    - name: 'create some user with `local: false`'\r\n      user:\r\n        name: '{{ username }}'\r\n        createhome: false\r\n        local: false\r\n      register: s\r\n\r\n    - fail:\r\n        msg: 'Please specify nonexistent user in vars'\r\n      when: 'not s[\"changed\"]'\r\n\r\n    - block:\r\n        - name: 'try to move/create home with `local: false`'\r\n          user:\r\n            name: '{{ username }}'\r\n            home: '/home/{{ username }}_move_create_test'\r\n            createhome: true\r\n            move_home: true\r\n            local: false\r\n\r\n      always:\r\n        - name: 'list homes'\r\n          command: 'ls -ld /home/{{ username }}_move_create_test'\r\n          failed_when: false\r\n\r\n        - name: 'remove user with `local: false`'\r\n          user:\r\n            name: '{{ username }}'\r\n            state: 'absent'\r\n            remove: true\r\n            local: false\r\n\r\n    - name: 'create some user with `local: true`'\r\n      user:\r\n        name: '{{ username }}'\r\n        createhome: false\r\n        local: true\r\n      register: s\r\n\r\n    - fail:\r\n        msg: 'Please specify nonexistent user in vars'\r\n      when: 'not s[\"changed\"]'\r\n\r\n    - block:\r\n        - name: 'try to move/create home with `local: true`'\r\n          user:\r\n            name: '{{ username }}'\r\n            home: '/home/{{ username }}_move_create_test'\r\n            createhome: true\r\n            move_home: true\r\n            local: true\r\n\r\n      always:\r\n        - name: 'list homes'\r\n          command: 'ls -ld /home/{{ username }}_move_create_test'\r\n          failed_when: false\r\n\r\n        - name: 'remove user with `local: true`'\r\n          user:\r\n            name: '{{ username }}'\r\n            state: 'absent'\r\n            remove: true\r\n            local: true\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\nSince `user` module create missed home while move with `local: false`, `move_home: true` and `createhome: true`, that is expected same behavior with `local: true` option.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nansible-playbook 2.4.3.0\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 2.7.13 (default, Nov 24 2017, 17:33:09) [GCC 6.3.0 20170516]\r\nNo config file found; using defaults\r\n\r\nPLAYBOOK: move_nonexistent_home.yml **********************************************************************************************************\r\n1 plays in move_nonexistent_home.yml\r\n\r\nPLAY [all] ***********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************************\r\nok: [Slave2]\r\nok: [Slave1]\r\nMETA: ran handlers\r\n\r\nTASK [create some user with `local: false`] **************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:7\r\nchanged: [Slave2] => {\"changed\": true, \"comment\": \"\", \"createhome\": false, \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"\", \"state\": \"present\", \"system\": false, \"uid\": 1001}\r\nchanged: [Slave1] => {\"changed\": true, \"comment\": \"\", \"createhome\": false, \"failed\": false, \"group\": 1003, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"/bin/bash\", \"state\": \"present\", \"system\": false, \"uid\": 1003}\r\n\r\nTASK [fail] **********************************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:14\r\nskipping: [Slave2] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\", \"skipped\": true}\r\nskipping: [Slave1] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\", \"skipped\": true}\r\n\r\nTASK [try to move/create home with `local: false`] *******************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:19\r\nchanged: [Slave2] => {\"append\": false, \"changed\": true, \"comment\": \"\", \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser_move_create_test\", \"move_home\": true, \"name\": \"testuser\", \"shell\": \"\", \"state\": \"present\", \"uid\": 1001}\r\nchanged: [Slave1] => {\"append\": false, \"changed\": true, \"comment\": \"\", \"failed\": false, \"group\": 1003, \"home\": \"/home/testuser_move_create_test\", \"move_home\": true, \"name\": \"testuser\", \"shell\": \"/bin/bash\", \"state\": \"present\", \"stderr\": \"usermod: The previous home directory (/home/testuser) does not exist or is inaccessible. Move cannot be completed.\\n\", \"stderr_lines\": [\"usermod: The previous home directory (/home/testuser) does not exist or is inaccessible. Move cannot be completed.\"], \"uid\": 1003}\r\n\r\nTASK [list homes] ****************************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:28\r\nchanged: [Slave2] => {\"changed\": true, \"cmd\": [\"ls\", \"-ld\", \"/home/testuser_move_create_test\"], \"delta\": \"0:00:00.002390\", \"end\": \"2018-03-14 12:17:41.297689\", \"failed\": false, \"failed_when_result\": false, \"rc\": 0, \"start\": \"2018-03-14 12:17:41.295299\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"drwxr-xr-x 1 testuser testuser 54 \u041c\u0430\u0440  2 14:52 /home/testuser_move_create_test\", \"stdout_lines\": [\"drwxr-xr-x 1 testuser testuser 54 \u041c\u0430\u0440  2 14:52 /home/testuser_move_create_test\"]}\r\nchanged: [Slave1] => {\"changed\": true, \"cmd\": [\"ls\", \"-ld\", \"/home/testuser_move_create_test\"], \"delta\": \"0:00:00.002985\", \"end\": \"2018-03-14 12:17:41.449650\", \"failed\": false, \"failed_when_result\": false, \"rc\": 0, \"start\": \"2018-03-14 12:17:41.446665\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"drwxr-xr-x. 1 testuser testuser 64 Mar  3 10:28 /home/testuser_move_create_test\", \"stdout_lines\": [\"drwxr-xr-x. 1 testuser testuser 64 Mar  3 10:28 /home/testuser_move_create_test\"]}\r\n\r\nTASK [remove user with `local: false`] *******************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:32\r\nchanged: [Slave2] => {\"changed\": true, \"failed\": false, \"force\": false, \"name\": \"testuser\", \"remove\": true, \"state\": \"absent\", \"stderr\": \"userdel: testuser mail spool (/var/mail/testuser) not found\\n\", \"stderr_lines\": [\"userdel: testuser mail spool (/var/mail/testuser) not found\"]}\r\nchanged: [Slave1] => {\"changed\": true, \"failed\": false, \"force\": false, \"name\": \"testuser\", \"remove\": true, \"state\": \"absent\"}\r\n\r\nTASK [create some user with `local: true`] ***************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:39\r\nchanged: [Slave2] => {\"changed\": true, \"comment\": \"testuser\", \"createhome\": false, \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"/bin/sh\", \"state\": \"present\", \"system\": false, \"uid\": 1001}\r\nchanged: [Slave1] => {\"changed\": true, \"comment\": \"testuser\", \"createhome\": false, \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"/bin/bash\", \"state\": \"present\", \"system\": false, \"uid\": 1001}\r\n\r\nTASK [fail] **********************************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:46\r\nskipping: [Slave2] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\", \"skipped\": true}\r\nskipping: [Slave1] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\", \"skipped\": true}\r\n\r\nTASK [try to move/create home with `local: true`] ********************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:51\r\nfatal: [Slave2]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Error moving /home/testuser to /home/testuser_move_create_test: Error opening `/home/testuser': No such file or directory.\\n\", \"name\": \"testuser\", \"rc\": 12}\r\nfatal: [Slave1]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Error moving /home/testuser to /home/testuser_move_create_test: Error opening `/home/testuser': No such file or directory.\\n\", \"name\": \"testuser\", \"rc\": 12}\r\n\r\nTASK [list homes] ****************************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:60\r\nchanged: [Slave2] => {\"changed\": true, \"cmd\": [\"ls\", \"-ld\", \"/home/testuser_move_create_test\"], \"delta\": \"0:00:00.002260\", \"end\": \"2018-03-14 12:17:43.788060\", \"failed\": false, \"failed_when_result\": false, \"msg\": \"non-zero return code\", \"rc\": 2, \"start\": \"2018-03-14 12:17:43.785800\", \"stderr\": \"ls: cannot access /home/testuser_move_create_test: No such file or directory\", \"stderr_lines\": [\"ls: cannot access /home/testuser_move_create_test: No such file or directory\"], \"stdout\": \"\", \"stdout_lines\": []}\r\nchanged: [Slave1] => {\"changed\": true, \"cmd\": [\"ls\", \"-ld\", \"/home/testuser_move_create_test\"], \"delta\": \"0:00:00.004337\", \"end\": \"2018-03-14 12:17:43.958333\", \"failed\": false, \"failed_when_result\": false, \"msg\": \"non-zero return code\", \"rc\": 2, \"start\": \"2018-03-14 12:17:43.953996\", \"stderr\": \"ls: cannot access /home/testuser_move_create_test: No such file or directory\", \"stderr_lines\": [\"ls: cannot access /home/testuser_move_create_test: No such file or directory\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nTASK [remove user with `local: true`] ********************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.yml:64\r\nfatal: [Slave1]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Error removing home directory: Error opening `/home/testuser_move_create_test': No such file or directory.\\n\", \"name\": \"testuser\", \"rc\": 9}\r\nfatal: [Slave2]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Error removing home directory: Error opening `/home/testuser_move_create_test': No such file or directory.\\n\", \"name\": \"testuser\", \"rc\": 9}\r\n        to retry, use: --limit @/home/user/ansible/ansible_bugs/move_nonexistent_home/move_nonexistent_home.retry\r\n\r\nPLAY RECAP ***********************************************************************************************************************************\r\nSlave1              : ok=7    changed=6    unreachable=0    failed=2\r\nSlave2               : ok=7    changed=6    unreachable=0    failed=2\r\n```\r\n",
        "created_at": "2018-03-14T10:59:32Z",
        "user": "Arano-kai",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "system"
        ]
    },
    {
        "number": 37396,
        "title": "`user` module with `local: true` fail to change group for existing user",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and devel branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!---\r\nName of the module, plugin, task or feature\r\nDo not include extra details here, e.g. \"vyos_command\" not \"the network module vyos_command\" or the full path\r\n-->\r\n`user` module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.3.0\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.13 (default, Nov 24 2017, 17:33:09) [GCC 6.3.0 20170516]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nIf using Ansible 2.4 or above, paste the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\nNot modified\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n-->\r\nMaster: Debian GNU/Linux 9.3 (stretch)\r\nSlave1: CentOS Linux release 7.4.1708 (Core)\r\nSlave2: Debian GNU/Linux 9.3 (stretch)\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nWhen change group of existing user, `user` module with `local: true` use group name, and `lusermod` supports only group id.\r\nWhen define group for nonexistent user, group id is used.\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\nInstall `libuser`.\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- hosts: all\r\n  vars:\r\n    username: 'testuser'\r\n  become: true\r\n  tasks:\r\n    - name: 'create some user'\r\n      user:\r\n        name: '{{ username }}'\r\n        createhome: false\r\n        local: true\r\n\r\n    - block:\r\n        - name: 'try to set goup'\r\n          user:\r\n            name: '{{ username }}'\r\n            group: '{%- if ansible_os_family == \"Debian\" -%}sudo{%- else -%}wheel{%- endif -%}'\r\n            local: true\r\n\r\n      always:\r\n        - name: 'remove user'\r\n          user:\r\n            name: '{{ username }}'\r\n            state: 'absent'\r\n            local: true\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\nGroup changed\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nansible-playbook 2.4.3.0\r\n  config file = None\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/local/bin/ansible-playbook\r\n  python version = 2.7.13 (default, Nov 24 2017, 17:33:09) [GCC 6.3.0 20170516]\r\nNo config file found; using defaults\r\n\r\nPLAYBOOK: local_user_fails_on_group_set.yml **************************************************************************************************\r\n1 plays in local_user_fails_on_group_set.yml\r\n\r\nPLAY [all] ***********************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***********************************************************************************************************************\r\nok: [Slave1]\r\nok: [Slave2]\r\nMETA: ran handlers\r\n\r\nTASK [create some user] **********************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/local_user_fails_on_group_set/local_user_fails_on_group_set.yml:7\r\nchanged: [Slave2] => {\"changed\": true, \"comment\": \"testuser\", \"createhome\": false, \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"/bin/sh\", \"state\": \"present\", \"system\": false, \"uid\": 1001}\r\nchanged: [Slave1] => {\"changed\": true, \"comment\": \"testuser\", \"createhome\": false, \"failed\": false, \"group\": 1001, \"home\": \"/home/testuser\", \"name\": \"testuser\", \"shell\": \"/bin/bash\", \"state\": \"present\", \"system\": false, \"uid\": 1001}\r\n\r\nTASK [try to set goup] ***********************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/local_user_fails_on_group_set/local_user_fails_on_group_set.yml:14\r\nfatal: [Slave2]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Invalid group ID sudo\\nUsage: lusermod [-imLU?] [-i|--interactive] [-c|--gecos STRING]\\n        [-d|--directory STRING] [-m|--movedirectory] [-s|--shell STRING]\\n        [-u|--uid NUM] [-g|--gid NUM] [-l|--login STRING]\\n        [-P|--plainpassword STRING] [-p|--password STRING] [-L|--lock]\\n        [-U|--unlock] [--commonname=STRING] [--givenname=STRING]\\n        [--surname=STRING] [--roomnumber=STRING] [--telephonenumber=STRING]\\n        [--homephone=STRING] [-?|--help] [--usage] [OPTION...] user\\n\", \"name\": \"testuser\", \"rc\": 1}\r\nfatal: [Slave1]: FAILED! => {\"changed\": false, \"failed\": true, \"msg\": \"Invalid group ID wheel\\nUsage: lusermod [-imLU?] [-i|--interactive] [-c|--gecos STRING]\\n        [-d|--directory STRING] [-m|--movedirectory] [-s|--shell STRING]\\n        [-u|--uid NUM] [-g|--gid NUM] [-l|--login STRING]\\n        [-P|--plainpassword STRING] [-p|--password STRING] [-L|--lock]\\n        [-U|--unlock] [--commonname=STRING] [--givenname=STRING]\\n        [--surname=STRING] [--roomnumber=STRING] [--telephonenumber=STRING]\\n        [--homephone=STRING] [-?|--help] [--usage] [OPTION...] user\\n\", \"name\": \"testuser\", \"rc\": 1}\r\n\r\nTASK [remove user] ***************************************************************************************************************************\r\ntask path: /home/user/ansible/ansible_bugs/local_user_fails_on_group_set/local_user_fails_on_group_set.yml:21\r\nchanged: [Slave2] => {\"changed\": true, \"failed\": false, \"force\": false, \"name\": \"testuser\", \"remove\": false, \"state\": \"absent\"}\r\nchanged: [Slave1] => {\"changed\": true, \"failed\": false, \"force\": false, \"name\": \"testuser\", \"remove\": false, \"state\": \"absent\"}\r\n        to retry, use: --limit @/home/user/ansible/ansible_bugs/local_user_fails_on_group_set/local_user_fails_on_group_set.retry\r\n\r\nPLAY RECAP ***********************************************************************************************************************************\r\nSlave1              : ok=3    changed=2    unreachable=0    failed=1\r\nSlave2               : ok=3    changed=2    unreachable=0    failed=1\r\n```\r\n",
        "created_at": "2018-03-14T09:41:01Z",
        "user": "Arano-kai",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 37271,
        "title": "gather_facts mountpoints are not gathered correctly",
        "body": "#### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ngather_facts\r\nsetup\r\n\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.4.3.0\r\n  config file = None\r\n  configured module search path = [u'/home/eax/.ansible/plugins/modules', u'/usr/local/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/local/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.14 (default, Jan  2 2018, 01:25:01) [GCC 4.2.1 Compatible FreeBSD Clang 4.0.0 (tags/RELEASE_400/final 297347)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nALLOW_WORLD_READABLE_TMPFILES(/usr/home/eax/global/ansible.cfg) = False\r\nANSIBLE_NOCOWS(/usr/home/eax/global/ansible.cfg) = True\r\nCACHE_PLUGIN(/usr/home/eax/global/ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(/usr/home/eax/global/ansible.cfg) = /home/eax/global/cache\r\nCOMMAND_WARNINGS(/usr/home/eax/global/ansible.cfg) = True\r\nDEFAULT_FORKS(/usr/home/eax/global/ansible.cfg) = 15\r\nDEFAULT_GATHERING(/usr/home/eax/global/ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(/usr/home/eax/global/ansible.cfg) = [u'/home/eax/global/hosts.yml']\r\nDEFAULT_MODULE_LANG(/usr/home/eax/global/ansible.cfg) = en_US.UTF-8\r\nDEFAULT_ROLES_PATH(/usr/home/eax/global/ansible.cfg) = [u'/root/.ansible/roles']\r\nDEFAULT_TRANSPORT(/usr/home/eax/global/ansible.cfg) = smart\r\nDEFAULT_UNDEFINED_VAR_BEHAVIOR(/usr/home/eax/global/ansible.cfg) = True\r\nDEPRECATION_WARNINGS(/usr/home/eax/global/ansible.cfg) = True\r\nDISPLAY_ARGS_TO_STDOUT(/usr/home/eax/global/ansible.cfg) = True\r\nDISPLAY_SKIPPED_HOSTS(/usr/home/eax/global/ansible.cfg) = True\r\nHOST_KEY_CHECKING(/usr/home/eax/global/ansible.cfg) = True\r\nSYSTEM_WARNINGS(/usr/home/eax/global/ansible.cfg) = True\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\nFreeBSD\r\n\r\n##### SUMMARY\r\nmountpoints are not gathered correctly\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Mount a filesystem not listed in /etc/fstab\r\n2. List the output of ansible_mounts\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: list mount points\r\n  hosts: all\r\n  tasks:\r\n    - debug:\r\n        msg: \"{{ansible_mounts}}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n- See all and only mounted filesysems\r\n\r\n##### ACTUAL RESULTS\r\n- See parsed contents of /etc/fstab \r\n\r\n",
        "created_at": "2018-03-10T23:05:41Z",
        "user": "grimreaper",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "system"
        ]
    },
    {
        "number": 36978,
        "title": "include_tasks in a loop breaks task execution order",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and devel branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ninclude_tasks\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.4.4 (stable-2.4 92cea82a4e) last updated 2018/03/04 14:53:42 (GMT +300)\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/ansible_main/lib/ansible\r\n  executable location = /home/user/ansible_main/bin/ansible\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\nANSIBLE_SSH_CONTROL_PATH(/etc/ansible/ansible.cfg) = %(directory)s/ansible-ssh-%%C\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = [u'/opt/ansible/hosts']\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nCentOS 7 on ansible master\r\nWindows 2012 Server R2 on managed hosts (although the problem does not seem OS-specific)\r\n\r\n##### SUMMARY\r\nIf tasks are included in a loop and item contains **host-specific** data in a template, task execution for this item will be sequential (one host at a time), not parallel.\r\n\r\n##### STEPS TO REPRODUCE\r\n```hosts```:\r\n```yaml\r\nonline-server-1\r\nindex-server-1\r\nindex-server-2\r\n```\r\n\r\n```par_test.yml```:\r\n```yaml\r\n - hosts: all\r\n   gather_facts: yes\r\n   vars:\r\n     default_variable: \"just_some_text\"\r\n     default_ip_src_order: \"{{ ansible_ip_addresses[0] if 'fe80' not in ansible_ip_addresses[0] else ansible_ip_addresses[1] }}\"\r\n     test_variable:\r\n       - \"item1\" # works just fine\r\n       - \"{{ default_variable }}\" # fine too\r\n       - \"{{ default_ip_src_order }}\" # oops... no more parallel execution for you, buddy\r\n   tasks:\r\n     - include_tasks: do_something.yml\r\n       with_items: \"{{test_variable}}\"\r\n```\r\n```do_something.yml```:\r\n```yaml\r\n - name: \"Touch file 1\"\r\n   win_file:\r\n     path: \"C:\\\\Temp\\\\foo1.{{item}}\"\r\n     state: touch\r\n - name: \"Touch file 2\"\r\n   win_file:\r\n     path: \"C:\\\\Temp\\\\foo2.{{item}}\"\r\n     state: touch\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nSteps \"Touch file 1\" and \"Touch file 2\" are expected to be run simultaneously on every host in play.\r\n\r\n##### ACTUAL RESULTS\r\nSteps \"Touch file 1\" and \"Touch file 2\" for item 3 in ```test_variable``` list are run sequentially on each host (file 1 on host1, then file 2 on host 1, then file 1 on host2, then file 2 on host2, etc).\r\n\r\n```\r\n[user@centos7 ansible]$ ansible-playbook par_test.yml -vvvv\r\nansible-playbook 2.4.4 (stable-2.4 92cea82a4e) last updated 2018/03/04 14:53:42 (GMT +300)\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/user/ansible_main/lib/ansible\r\n  executable location = /home/user/ansible_main/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed /opt/ansible/hosts inventory source with ini plugin\r\nLoading callback plugin default of type stdout, v2.0 from /home/user/ansible_main/lib/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: par_test.yml *********************************************************************************************************************************************************************************************************************************\r\n1 plays in par_test.yml\r\n\r\nPLAY [all] *********************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************************************************************************************************************************************************************************************\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/setup.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/setup.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/setup.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1]\r\nok: [index-server-2]\r\nok: [online-server-1]\r\nMETA: ran handlers\r\n\r\nTASK [include_tasks] ***********************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/par_test.yml:12\r\nincluded: /opt/ansible/do_something.yml for index-server-1, online-server-1, index-server-2\r\nincluded: /opt/ansible/do_something.yml for index-server-1, online-server-1, index-server-2\r\nincluded: /opt/ansible/do_something.yml for index-server-1\r\nincluded: /opt/ansible/do_something.yml for online-server-1\r\nincluded: /opt/ansible/do_something.yml for index-server-2\r\n\r\nTASK [Touch file 1] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:1\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\n\r\nTASK [Touch file 2] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:6\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\n\r\nTASK [Touch file 1] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:1\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\n\r\nTASK [Touch file 2] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:6\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\n\r\nTASK [Touch file 1] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:1\r\nMETA: noop\r\nMETA: noop\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\n\r\nTASK [Touch file 2] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:6\r\nMETA: noop\r\nMETA: noop\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-1\r\nchecking if winrm_host index-server-1 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nMETA: noop\r\n\r\nTASK [Touch file 1] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:1\r\nMETA: noop\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nMETA: noop\r\n\r\nTASK [Touch file 2] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:6\r\nMETA: noop\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<online-server-1> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO online-server-1\r\nchecking if winrm_host online-server-1 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [online-server-1] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nMETA: noop\r\nMETA: noop\r\n\r\nTASK [Touch file 1] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:1\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nMETA: noop\r\nMETA: noop\r\n\r\nTASK [Touch file 2] ************************************************************************************************************************************************************************************************************************************\r\ntask path: /opt/ansible/do_something.yml:6\r\nUsing module file /home/user/ansible_main/lib/ansible/modules/windows/win_file.ps1\r\n<index-server-2> ESTABLISH WINRM CONNECTION FOR USER: user on PORT 5986 TO index-server-2\r\nchecking if winrm_host index-server-2 is an IPv6 address\r\nEXEC (via pipeline wrapper)\r\nok: [index-server-2] => {\r\n    \"changed\": false, \r\n    \"failed\": false\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************************\r\nindex-server-1             : ok=10   changed=0    unreachable=0    failed=0   \r\nindex-server-2             : ok=10   changed=0    unreachable=0    failed=0   \r\nonline-server-1            : ok=10   changed=0    unreachable=0    failed=0   \r\n```\r\n\r\n##### NB\r\nThis is not a bug introduced by ```include_tasks``` feature - 2.3.0 with its ```include``` keyword works the same way.",
        "created_at": "2018-03-04T13:30:13Z",
        "user": "adakhin",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "utilities",
            "affects_2.16"
        ]
    },
    {
        "number": 35086,
        "title": "clear_host_errors causes unexpected behaviour with unreachable hosts",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nmeta\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.4.2.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n```\r\n\r\n##### CONFIGURATION\r\nCACHE_PLUGIN(/etc/ansible/ansible.cfg) = redis\r\nCACHE_PLUGIN_TIMEOUT(/etc/ansible/ansible.cfg) = 86400\r\nDEFAULT_HOST_LIST(/etc/ansible/ansible.cfg) = [u'/root/scripts/get_inventory.py']\r\nPERSISTENT_CONNECT_TIMEOUT(/etc/ansible/ansible.cfg) = 30\r\nRETRY_FILES_SAVE_PATH(/etc/ansible/ansible.cfg) = /root/.ansible-retry\r\n\r\n##### OS / ENVIRONMENT\r\nN/A\r\n\r\n##### SUMMARY\r\nI'm using Ansible to generate configuration files for physical nodes, not all of which might be present when the script runs. Using `meta: clear_host_errors` I want to create the configuration file regardless, however this appears to misbehave the more hosts are present (running against a group of ~50).\r\n\r\n##### STEPS TO REPRODUCE\r\nThis playbook demonstrates the unexpected behaviour.\r\n\r\n```yaml\r\n- hosts: all\r\n  tasks:\r\n    - set_fact:\r\n        was_accessible: \"up\"\r\n\r\n    - meta: clear_host_errors\r\n\r\n    - debug:\r\n        msg: \"Hello\"\r\n\r\n    - when:\r\n        - was_accessible is defined\r\n      debug:\r\n        msg: \"Hello again, I am up.\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nThe fact `was_accessible` should only be set for hosts that were reachable. The first debug message should have appeared for every host, and the second message only for running hosts.\r\n\r\nAdmittedly, this might be misuse of clear_host_errors, but this behaviour still seems highly suspect.\r\n\r\n##### ACTUAL RESULTS\r\nTasks appear to move between each other, and the messages appear explicitly for the nodes that they shouldn't. Additionally one of the tasks runs for the exact nodes it shouldn't.\r\n\r\n```\r\nPLAY [all] ****************************************************************************************************\r\n\r\nTASK [Gathering Facts] **********************************************************************************************************\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/setup.py\r\nfatal: [node1]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host node1.domain.org port 22: Connection timed out\\r\\n\", \"unreachable\": true}\r\nfatal: [node2]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host node2.domain.org port 22: Connection timed out\\r\\n\", \"unreachable\": true}\r\nfatal: [node3]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host node3.domain.org port 22: Connection timed out\\r\\n\", \"unreachable\": true}\r\nok: [node4]\r\nok: [node5]\r\nok: [node6]\r\nMETA: ran handlers\r\n\r\nTASK [set_fact] *****************************************************************************************************************\r\ntask path: debug.yml:4\r\nok: [node4] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nok: [node5] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nok: [node6] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nMETA: cleared host errors\r\nMETA: ran handlers\r\n\r\nTASK [set_fact] *****************************************************************************************************************\r\ntask path: debug.yml:4\r\nok: [node1] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nok: [node2] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nok: [node3] => {\r\n    \"ansible_facts\": {\r\n        \"was_accessible\": \"up\"\r\n    },\r\n    \"changed\": false\r\n}\r\nok: [node4] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\nok: [node5] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\nok: [node6] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\nMETA: cleared host errors\r\n\r\nTASK [debug] ********************************************************************************************************************\r\ntask path: debug.yml:9\r\nMETA: noop\r\nMETA: noop\r\nMETA: noop\r\nok: [node1] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\nok: [node2] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\nok: [node3] => {\r\n    \"msg\": \"Hello.\"\r\n}\r\n\r\nTASK [debug] ********************************************************************************************************************\r\ntask path: debug.yml:12\r\nMETA: noop\r\nMETA: noop\r\nMETA: noop\r\nok: [node1] => {\r\n    \"msg\": \"Hello again\"\r\n}\r\nok: [node2] => {\r\n    \"msg\": \"Hello again\"\r\n}\r\nok: [node3] => {\r\n    \"msg\": \"Hello again\"\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP **********************************************************************************************************************\r\nnode1                    : ok=3    changed=0    unreachable=1    failed=0\r\nnode2                    : ok=3    changed=0    unreachable=1    failed=0\r\nnode3                    : ok=3    changed=0    unreachable=1    failed=0\r\nnode4                   : ok=3    changed=0    unreachable=0    failed=0\r\nnode5                   : ok=3    changed=0    unreachable=0    failed=0\r\nnode6                   : ok=3    changed=0    unreachable=0    failed=0\r\n```",
        "created_at": "2018-01-19T11:13:37Z",
        "user": "ghost",
        "labels": [
            "module",
            "c:executor/playbook_executor",
            "c:plugins/strategy",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "utilities",
            "affects_2.14"
        ]
    },
    {
        "number": 35085,
        "title": "Setup module - ansible_service_mgr detection errors",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\n\r\nSetup module.\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.2.0\r\n  config file = /home/lucas/ansible/ansible.cfg\r\n  configured module search path = [u'/home/lucas/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.12 (default, Nov 20 2017, 18:23:56) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\n```\r\n DEFAULT_HOST_LIST(/home/lucas/ansible/ansible.cfg) = [u'/home/lucas/ansible/hosts']\r\n DEFAULT_REMOTE_USER(/home/lucas/ansible/ansible.cfg) = ansible\r\n DEFAULT_VAULT_PASSWORD_FILE(/home/lucas/ansible/ansible.cfg) = /home/lucas/.vault\r\n RETRY_FILES_ENABLED(/home/lucas/ansible/ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n\r\n\"Controller\" OS is Ubuntu 16.04 amd64\r\n\"Target\" OS is Ubuntu 14.04 amd64\r\n\r\n##### SUMMARY\r\n\r\nIt seems the `setup` module detects `ansible_service_mgr` incorrectly (and with major inconsistencies between subsequent runs) in an Ubuntu 14.04 (upstart) host with `snapd` installed (which in turn installs `systemd` as a dependency).\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Run a minimal service task against a default `ubuntu/trusty64` Vagrant box.\r\n\r\n```\r\nVagrant.configure(\"2\") do |config|\r\n  config.vm.box = \"ubuntu/trusty64\"\r\n  config.vm.provision \"ansible\" do |ansible|\r\n    ansible.verbose = \"v\"\r\n    ansible.playbook = \"playbook.yml\"\r\n  end\r\nend\r\n```\r\n\r\n```\r\n- name: ensure rsyslog is running\r\n  hosts: all\r\n  become: yes\r\n  become_user: root\r\n  tasks:\r\n    - name: ensure rsyslog is running\r\n      service:\r\n        name: rsyslog\r\n        state: started\r\n        enabled: yes\r\n```\r\n\r\nWorks fine.\r\n\r\n2. Install `snapd` in VM\r\n\r\n`apt install snapd`\r\n\r\n3. Run the same playbook as before against that VM with `vagrant provision`\r\n\r\n---\r\n\r\n1. Install Ansible from an official PPA in the Vagrant VM (the same Ubuntu 14.04 with `snapd` already installed).\r\n\r\n```\r\napt-add-repository ppa:ansible/ansible\r\napt update\r\napt install -y ansible\r\n```\r\n\r\n2. Run `ansible -m setup -a filter=ansible_service_mgr localhost`.\r\n\r\n3. Run `ansible -m setup localhost | grep ansible_service_mgr` and compare results.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n```\r\n$ ansible -m setup -a filter=ansible_service_mgr target_host\r\ntarget_host | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"ansible_service_mgr\": \"service\"\r\n    },\r\n    \"changed\": false\r\n}\r\n$ ansible -m setup target_host | grep ansible_service_mgr\r\n        \"ansible_service_mgr\": \"service\",\r\n```\r\n\r\nFor the playbook run:\r\n\r\n```\r\nTASK [ensure rsyslog is running] ***********************************************\r\nok: [default] => {\"changed\": false, \"enabled\": true, \"name\": \"rsyslog\", \"state\": \"started\"}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n$ ansible -m setup -a filter=ansible_service_mgr target_host\r\ntarget_host | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"ansible_service_mgr\": \"service\"\r\n    },\r\n    \"changed\": false\r\n}\r\n$ ansible -m setup target_host | grep ansible_service_mgr\r\n        \"ansible_service_mgr\": \"systemd\",\r\n```\r\n\r\nFor the playbook run:\r\n\r\n```\r\nTASK [ensure rsyslog is running] ***********************************************\r\nfatal: [default]: FAILED! => {\"changed\": false, \"msg\": \"Error loading unit file 'rsyslog': org.freedesktop.DBus.Error.FileNotFound \\\"No such file or directory\\\"\"}\r\n```",
        "created_at": "2018-01-19T10:25:47Z",
        "user": "moon-musick",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "verified",
            "system"
        ]
    },
    {
        "number": 35030,
        "title": "delegate_to with unreachable hosts breaks playbook",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ndelegate_to\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.4.2.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.12 (default, Nov 20 2017, 18:23:56) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nUbuntu 16.04.3 LTS\r\n\r\n##### SUMMARY\r\nUsing `delegate_to` (a perfect example can be found in the documentation [http://docs.ansible.com/ansible/latest/playbooks_delegation.html#delegated-facts](http://docs.ansible.com/ansible/latest/playbooks_delegation.html#delegated-facts)); When a host passed along to `delegate_to` is unreachable for whatever reason. The host that is executing the task will be also be marked as unreachable. After a large error is printed out (output from all hosts in the `delegate_to`?) and the playbook ends with something like:\r\n```\r\nPLAY RECAP *************************************************************************************************************************************************\r\nfoo.example.com    : ok=0    changed=0    unreachable=1    failed=0\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\nplaybook.yml:\r\n```yaml\r\n---\r\n- hosts: app_servers\r\n  tasks:\r\n    - name: gather facts from db servers\r\n      setup:\r\n      delegate_to: \"{{ item }}\"\r\n      delegate_facts: True\r\n      with_items: \"{{groups['dbservers']}}\"\r\n    - name: test\r\n      debug:\r\n        msg: \"test\"\r\n```\r\n\r\ninventory.yml:\r\n```yaml\r\n---\r\nall:\r\n  children:\r\n    app_servers:\r\n      hosts:\r\n        foo.example.com:\r\n    dbservers:\r\n      hosts:\r\n        bar.example.com:\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n```\r\nPLAY [app_servers] ***********************************************************************************************************************************\r\n\r\nTASK [gather facts from db servers] ******************************************************************************************************************\r\nfailed: [foo.example.com] (item=bar.example.com) => {\"item\": \"bar.example.com\", \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host bar.example.com port 22: Connection timed out\\r\\n\", \"unreachable\": true}\r\n\r\nTASK [test] ************************************************************************************************************************************************\r\nok: [foo.example.com] => {\r\n    \"msg\": \"test\"\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nPLAY [app_servers] ***********************************************************************************************************************************\r\n\r\nTASK [gather facts from db servers] ******************************************************************************************************************\r\nfailed: [foo.example.com] (item=bar.example.com) => {\"item\": \"bar.example.com\", \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host bar.example.com port 22: Connection timed out\\r\\n\", \"unreachable\": true}\r\nfatal: [foo.example.com]: UNREACHABLE! => {\"changed\": false, \"msg\": \"All items completed\", \"...\r\n```\r\n",
        "created_at": "2018-01-18T04:57:11Z",
        "user": "NZSmartie",
        "labels": [
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "affects_2.10"
        ]
    },
    {
        "number": 34450,
        "title": "Copy action is silently ignored when given an unrecognized parameter",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!---\r\n-->\r\nCopy module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.2.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/local/VELOQUANT/yitzikc/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\n-->\r\nDistro default\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\n-->\r\nCentos 7.4, running as a Proxmox PVE 4.4 container\r\n\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nWhen running _copy_ with the parameter _recurse=yes_ The step failed siltently. The output indicated that the step ran successfully and made no changes, yet no files were actually copied\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Override config file with with files from a user-specified directory\r\n  copy: dest=\"{{ deployment_sensitive_dir }}/Configs/\" src=\"{{ config_override_dir }}/\" force=yes  mode=\"u=rwX,g=rX,o=\" recurse=yes owner=root group=ops local_follow=yes\r\n  when: config_override_dir is defined\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nThe step should fail and issue an error message about an unrecognized parameter\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nThe step appeared to run and was indicated as unchanged. Only when running with extra verbosity I saw indications on an error\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n<stg1> PUT /tmp/tmpFAIsQ_ TO /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/copy.py\r\n<stg1> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=yc -o ConnectTimeout=10 -o ControlPath=/home/local/VELOQUANT/yitzikc/.ansible/cp/5166322500 '[stg1]'\r\n<stg1> (0, 'sftp> put /tmp/tmpFAIsQ_ /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/copy.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 25391\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug2: Remote version: 3\\r\\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\\r\\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\\r\\ndebug2: Server supports extension \"fsync@openssh.com\" revision 1\\r\\ndebug3: Sent message fd 5 T:16 I:1\\r\\ndebug3: SSH_FXP_REALPATH . -> /home/yc size 0\\r\\ndebug3: Looking up /tmp/tmpFAIsQ_\\r\\ndebug3: Sent message fd 5 T:17 I:2\\r\\ndebug3: Received stat reply T:105 I:2\\r\\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/copy.py\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 4 32768 bytes at 0\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\\r\\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:4083\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 5 32768 bytes at 32768\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: In write loop, ack for 6 4083 bytes at 65536\\r\\ndebug3: Sent message SSH2_FXP_CLOSE I:4\\r\\ndebug3: SSH2_FXP_STATUS 0\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<stg1> ESTABLISH SSH CONNECTION FOR USER: yc\r\n<stg1> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=yc -o ConnectTimeout=10 -o ControlPath=/home/local/VELOQUANT/yitzikc/.ansible/cp/5166322500 stg1 '/bin/sh -c '\"'\"'chmod u+x /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/ /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/copy.py && sleep 0'\"'\"''\r\n<stg1> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 25391\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n<stg1> ESTABLISH SSH CONNECTION FOR USER: yc\r\n<stg1> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=yc -o ConnectTimeout=10 -o ControlPath=/home/local/VELOQUANT/yitzikc/.ansible/cp/5166322500 -tt stg1 '/bin/sh -c '\"'\"'sudo -H -S -n -u root /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-jpikupiesrlkhkgpjewqpatiitgjhcja; /usr/bin/python /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/copy.py'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\r\n<stg1> (1, '\\r\\n{\"msg\": \"Unsupported parameters for (copy) module: recurse Supported parameters include: attributes,backup,content,delimiter,dest,directory_mode,follow,force,group,local_follow,mode,original_basename,owner,regexp,remote_src,selevel,serole,setype,seuser,src,unsafe_writes,validate\", \"failed\": true, \"invocation\": {\"module_args\": {\"src\": \"/home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/source\", \"force\": \"yes\", \"dest\": \"/opt/vq/en/Configs/\", \"recurse\": \"yes\", \"original_basename\": \"RiskInstruments_v2.ods\", \"mode\": \"u=rwX,g=rX,o=\", \"owner\": \"root\", \"group\": \"veloquant\", \"local_follow\": \"yes\"}}}\\r\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 25391\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 1\\r\\nShared connection to stg1 closed.\\r\\n')\r\n<stg1> ESTABLISH SSH CONNECTION FOR USER: yc\r\n<stg1> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=yc -o ConnectTimeout=10 -o ControlPath=/home/local/VELOQUANT/yitzikc/.ansible/cp/5166322500 stg1 '/bin/sh -c '\"'\"'rm -f -r /home/yc/.ansible/tmp/ansible-tmp-1515036718.59-155007975234693/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<stg1> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug2: fd 4 setting O_NONBLOCK\\r\\ndebug2: mux_client_hello_exchange: master version 4\\r\\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\\r\\ndebug3: mux_client_request_session: entering\\r\\ndebug3: mux_client_request_alive: entering\\r\\ndebug3: mux_client_request_alive: done pid = 25391\\r\\ndebug3: mux_client_request_session: session request sent\\r\\ndebug1: mux_client_request_session: master session id: 2\\r\\ndebug3: mux_client_read_packet: read header failed: Broken pipe\\r\\ndebug2: Received exit status from master 0\\r\\n')\r\n```\r\n",
        "created_at": "2018-01-04T11:40:27Z",
        "user": "yitzikc",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "files"
        ]
    },
    {
        "number": 33907,
        "title": "Inconsistencies in result of template module",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ntemplate\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.4.2.0\r\n  config file = None\r\n  configured module search path = [u'/home/****/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/andre/local/ansible/local/lib/python2.7/site-packages/ansible\r\n  executable location = /home/****/local/bin/ansible\r\n  python version = 2.7.12 (default, Nov 19 2016, 06:48:10) [GCC 5.4.0 20160609]\r\n```\r\n\r\n##### CONFIGURATION\r\nNo changes\r\n\r\n##### OS / ENVIRONMENT\r\nLinux Mint 18\r\n\r\n##### SUMMARY\r\nThe structure of the result of the template module is different depending on whether the destination file is changed or not.\r\n\r\n##### STEPS TO REPRODUCE\r\nRun this playbook with `ansible-playbook -i localhost, test.yml` twice. `test.tpl` is empty.\r\n```yaml\r\n- name: Template test\r\n  hosts: localhost\r\n  connection: local\r\n\r\n  tasks:\r\n    - name: Test\r\n      template:\r\n        src: test.tpl\r\n        dest: \"{{ playbook_dir }}/test.txt\"\r\n      register: template_results\r\n\r\n    - name: Debug\r\n      debug:\r\n        var: template_results\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nIndependent of what the module does the structure of the result should always be the same.\r\n\r\n##### ACTUAL RESULTS\r\nThe first run gives this result:\r\n```\r\nok: [localhost] => {\r\n    \"template_results\": {\r\n        \"changed\": true, \r\n        \"checksum\": \"bde2a55f9a8164894c1583ea8922f40a818ddaba\", \r\n        \"dest\": \"****/test/test.txt\", \r\n        \"diff\": [], \r\n        \"failed\": false, \r\n        \"gid\": 1000, \r\n        \"group\": \"****\", \r\n        \"md5sum\": \"7eeb5a7ea3a32aa4f2df400551e34074\", \r\n        \"mode\": \"0644\", \r\n        \"owner\": \"****\", \r\n        \"size\": 16, \r\n        \"src\": \"****/.ansible/tmp/ansible-tmp-1513245674.49-29874628334555/source\", \r\n        \"state\": \"file\", \r\n        \"uid\": 1000\r\n    }\r\n}\r\n```\r\nRunning it a second time (the `test.txt` file gets not changed) the result is:\r\n```\r\nok: [localhost] => {\r\n    \"template_results\": {\r\n        \"changed\": false, \r\n        \"checksum\": \"bde2a55f9a8164894c1583ea8922f40a818ddaba\", \r\n        \"diff\": {\r\n            \"after\": {\r\n                \"path\": \"****/test/test.txt\"\r\n            }, \r\n            \"before\": {\r\n                \"path\": \"****/test/test.txt\"\r\n            }\r\n        }, \r\n        \"failed\": false, \r\n        \"gid\": 1000, \r\n        \"group\": \"****\", \r\n        \"mode\": \"0644\", \r\n        \"owner\": \"****\", \r\n        \"path\": \"****/test/test.txt\", \r\n        \"size\": 16, \r\n        \"state\": \"file\", \r\n        \"uid\": 1000\r\n    }\r\n}\r\n```\r\n\r\nThe first run has the result of the copy module, the second run has the result of the file module. As can be seen from the syslog messages:\r\n```\r\n# First run\r\nDez 14 11:12:28 **** ansible-setup[31951]: Invoked with filter=* gather_subset=['all'] fact_path=/etc/ansible/facts.d gather_timeout=10\r\nDez 14 11:12:29 **** ansible-stat[32017]: Invoked with checksum_algorithm=sha1 get_checksum=True path=/****/test/test.txt checksum_algo=sha1 follow=False get_md5=False get_mime=True get_attributes=True\r\nDez 14 11:12:29 **** ansible-copy[32030]: Invoked with directory_mode=None force=True remote_src=None owner=None follow=False local_follow=None group=None unsafe_writes=None setype=None content=NOT_LOGGING_PARAMETER serole=None dest=/****/test/test.txt selevel=None original_basename=test.tpl regexp=None validate=None src=/home/****/.ansible/tmp/ansible-tmp-1513246348.9-70821872716636/source seuser=None delimiter=None mode=None attributes=None backup=False\r\n# Second run\r\nDez 14 11:12:32 **** ansible-setup[32074]: Invoked with filter=* gather_subset=['all'] fact_path=/etc/ansible/facts.d gather_timeout=10\r\nDez 14 11:12:33 **** ansible-stat[32140]: Invoked with checksum_algorithm=sha1 get_checksum=True path=/****/test/test.txt checksum_algo=sha1 follow=False get_md5=False get_mime=True get_attributes=True\r\nDez 14 11:12:33 **** ansible-file[32151]: Invoked with directory_mode=None force=False remote_src=None path=/****/test/test.txt owner=None follow=False group=None unsafe_writes=None state=file content=NOT_LOGGING_PARAMETER serole=None diff_peek=None setype=None dest=/****/test/test.txt selevel=None original_basename=test.tpl regexp=None validate=None src=test.tpl seuser=None recurse=False delimiter=None mode=None attributes=None backup=None\r\n```\r\n\r\nRunning in check mode without the destination file beeing present gives no additional variables:\r\n```\r\nok: [localhost] => {\r\n    \"template_results\": {\r\n        \"changed\": true, \r\n        \"diff\": [], \r\n        \"failed\": false\r\n    }\r\n}\r\n```\r\n\r\nI want to use the `path`/`dest` result to get the list of created files which is not possible because the name of the variable changes between runs.",
        "created_at": "2017-12-14T10:21:37Z",
        "user": "NomAnor",
        "labels": [
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "files"
        ]
    },
    {
        "number": 32379,
        "title": "ansible delegates to previously failed node",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\nansible\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.0\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nIf using Ansible 2.4 or above, paste the results of \"ansible-config dump --only-changed\"\r\n\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n-->\r\nController: RHEL7.4\r\nHosts: RHEL7.4\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nDuring playbook execution one of the hosts failed for \"OSError: [Errno 32] Broken pipe\". Ansible continues to execute the playbook for the other nodes. One of these later tasks for other hosts gets delegated to the failed host, but ansible does not prevent the execution of such tasks - the task fails miserably because ansible has skipped all the relevant tasks that should have been executed as a pre-requisite for the delegated task. Ansible should not execute delegate_to tasks on previously failed host.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nAnsible refuses to execute a \"delegate_to\"-task on a previously failed host.\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nAnsible executes a \"delegated_to\"-task on a previously failed host, which fails miserably\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n\r\n```\r\n",
        "created_at": "2017-10-31T09:45:45Z",
        "user": "karniemi",
        "labels": [
            "affects_2.4",
            "support:core",
            "bug",
            "affects_2.8",
            "P3",
            "affects_2.9"
        ]
    },
    {
        "number": 31194,
        "title": "Fetching large file consumes a lot of memory",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\nModule `fetch`\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\nansible 2.4.0.0 (detached HEAD d14467b029) last updated 2017/09/22 13:29:24 (GMT +200)\r\n  config file = ./ansible.cfg\r\n  configured module search path = [u'$HOME/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = $HOME/bin/ansible/lib/ansible\r\n  executable location = $HOME/bin/ansible/bin/ansible\r\n  python version = 2.7.13 (default, Jan 19 2017, 14:48:08) [GCC 6.3.0 20170118]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nIf using Ansible 2.4 or above, paste the results of \"ansible-config dump --only-changed\"\r\n\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n\r\n-->\r\n```\r\nANSIBLE_NOCOWS(./ansible.cfg) = True\r\nANSIBLE_SSH_PIPELINING(./ansible.cfg) = True\r\nCACHE_PLUGIN(./ansible.cfg) = jsonfile\r\nCACHE_PLUGIN_CONNECTION(./ansible.cfg) = /tmp/ansible_facts_cache\r\nCACHE_PLUGIN_TIMEOUT(./ansible.cfg) = 7200\r\nDEFAULT_CALLBACK_PLUGIN_PATH(./ansible.cfg) = [u'./callbacks']\r\nDEFAULT_FORKS(./ansible.cfg) = 25\r\nDEFAULT_GATHERING(./ansible.cfg) = smart\r\nDEFAULT_HOST_LIST(./ansible.cfg) = [u'./hosts']\r\nDEFAULT_LOCAL_TMP(./ansible.cfg) = /tmp/.ansible/tmp/ansible-local-18383M5QWWd\r\nDEFAULT_REMOTE_TMP(./ansible.cfg) = /tmp/.ansible_$USER/tmp\r\nDEFAULT_ROLES_PATH(./ansible.cfg) = [u'./roles', u'./shared-roles']\r\nDEFAULT_VAULT_PASSWORD_FILE(./ansible.cfg) = ./vault.sh\r\nRETRY_FILES_ENABLED(./ansible.cfg) = False\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \"N/A\" for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n-->\r\n\r\nRunning from Debian Testing (Buster), managing Ubuntu 16 and 14 LTS.\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nFetching larger files consumes too much memory on controller node. I have tried to fetch 411 MB *tar* file with both *Ansible* 2.3 and 2.4 and also with `validate_checksum` parameter set to `false`. RAM consumed by python process rise up to 3-5GB! This causes local system to swap a lot and freezes. Consumed RAM on *controlled host* also rise a lot a cannot provide more details.\r\n\r\nSimilar problems were reported in #11702.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n- name: Migrate LXC container\r\n  hosts: '{{ guest }}'\r\n  gather_facts: no\r\n  tasks:\r\n    - name: Fetch large file to local machine\r\n      fetch:\r\n        src: '/var/lib/lxc/archive/{{ large_file }}'\r\n        dest: 'tmp/{{ large_file }}'\r\n        fail_on_missing: yes\r\n        flat: yes\r\n      delegate_to: '{{ host }}'\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nAnsible downloads given file to given path with no extra memory consumption (i.e by few kB or MB blocks).\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nAnsible downloads given file but system freezes and memory rise up to 100 % consumed RAM. I have not tested larger files then few hundred megabytes. \r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n\r\n",
        "created_at": "2017-10-02T14:31:02Z",
        "user": "VojtechMyslivec",
        "labels": [
            "module",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "files",
            "affects_2.14"
        ]
    },
    {
        "number": 30411,
        "title": "Ansible hangs forever while executing playbook with no information on what is going on",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\nansible-playbook\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\nansible 2.3.1.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n  python version = 2.7.5 (default, Aug  2 2016, 04:20:16) [GCC 4.8.5 20150623 (Red Hat 4.8.5-4)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\n[defaults]\r\nhost_key_checking = False\r\ntimeout = 20\r\nretry_files_save_path = /home/ansible/retry/\r\n# Do not put more jobs here, or ssh will fail\r\n# Anything more than 10 kills this poor server\r\nforks = 10\r\nremote_user = root\r\nlog_path=/var/log/ansible.log\r\n\r\n[ssh_connection]\r\nretries=3\r\npipelining=True\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nRHEL 7.3\r\n-->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\n\r\nWhen running ansible playbook for all servers (1964 servers) it hangs somewhere in middle of execution. I used -vvvvvvvvvv to trace the problem, but it doesn't print ANYTHING. The previous host finishes and the message about finish is last thing I see in console, then there is NOTHING. It just hangs. It doesn't even print the FQDN or name of server that is next in queue, it doesn't say what is is waiting for. Just nothing.\r\n\r\nIn ps I see 2 processes: Running strace shows:\r\n\r\nparent:\r\nProcess 22170 attached\r\nselect(0, NULL, NULL, NULL, {0, 599})   = 0 (Timeout)\r\nwait4(28917, 0x7ffd44d0bf34, WNOHANG, NULL) = 0\r\nwait4(28917, 0x7ffd44d0bf64, WNOHANG, NULL) = 0\r\nselect(0, NULL, NULL, NULL, {0, 1000})  = 0 (Timeout)\r\nwait4(28917, 0x7ffd44d0bf34, WNOHANG, NULL) = 0\r\nwait4(28917, 0x7ffd44d0bf64, WNOHANG, NULL) = 0\r\nselect(0, NULL, NULL, NULL, {0, 1000})  = 0 (Timeout)\r\nwait4(28917, 0x7ffd44d0bf34, WNOHANG, NULL) = 0\r\nwait4(28917, 0x7ffd44d0bf64, WNOHANG, NULL) = 0\r\nselect(0, NULL, NULL, NULL, {0, 1000})  = 0 (Timeout)\r\nwait4(28917, 0x7ffd44d0bf34, WNOHANG, NULL) = 0\r\nwait4(28917, 0x7ffd44d0bf64, WNOHANG, NULL) = 0\r\nselect(0, NULL, NULL, NULL, {0, 1000})  = 0 (Timeout)\r\nwait4(28917, 0x7ffd44d0bf34, WNOHANG, NULL) = 0\r\nwait4(28917, 0x7ffd44d0bf64, WNOHANG, NULL) = 0\r\n\r\n...\r\nrepeats forever\r\n\r\nchild:\r\nProcess 28917 attached\r\nepoll_wait(40, \r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# This playbook is used to test if server works or not\r\n\r\n---\r\n- hosts: run-tools.homecredit.net all:!ignored\r\n  tasks:\r\n  - command: echo works\r\n```\r\n\r\nLooks like a bug to me, it should at least tell me what it's trying to do that causes the hang",
        "created_at": "2017-09-15T09:34:12Z",
        "user": "benapetr",
        "labels": [
            "affects_2.3",
            "support:core",
            "bug",
            "has_pr",
            "hang"
        ]
    },
    {
        "number": 30116,
        "title": "Timed abort in pause module",
        "body": "##### ISSUE TYPE\r\n\r\n~Feature  Idea~\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\n\r\npause module\r\n\r\n##### ANSIBLE VERSION\r\n\r\n2.3\r\n\r\n##### SUMMARY\r\n\r\nFrom @bobrik on 2015-06-01T10:43:32Z\r\nIt would be nice to about sequence if operator does not respond in timeout. Currently `pause` module can only continue if no action taken. Extra flag like `action_on_timeout` with values `abort` and `continue` would do the trick.\r\n\r\nCopied from original issue: ansible/ansible-modules-core#1449\r\n\r\n\r\n",
        "created_at": "2017-09-12T16:36:57Z",
        "user": "ansibot",
        "labels": [
            "module",
            "support:core",
            "bug",
            "feature",
            "P3",
            "utilities",
            "affects_2.14"
        ]
    },
    {
        "number": 28991,
        "title": "apt module does not update cache before checking release exists",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n`apt` module\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\nansible 2.2.1.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nMention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \u201cN/A\u201d for anything that is not platform-specific.\r\nAlso mention the specific version of what you are trying to control,\r\ne.g. if this is a network bug the version of firmware on the network device.\r\n-->\r\nDebian 8 (`jessie`)\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nThe `apt` module, when asked to ensure a package is installed (`present`) fails if the release (specified via `default_release`) \r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n\r\nUse the following tasks in a playbook/role with Ansible 2.2.1.0, where at least the host being managed is Debian 8.\r\n\r\n```yaml\r\n- name: Add jessie-backports APT repository\r\n  apt_repository:\r\n    filename: \"jessie-backports\"\r\n    repo: \"deb http://httpredir.debian.org/debian jessie-backports main\"\r\n    state: present\r\n    update_cache: yes\r\n\r\n- name: Install unscd\r\n  apt:\r\n    name: \"unscd\"\r\n    default_release: \"jessie-backports\"\r\n    state: present\r\n    update_cache: yes\r\n    cache_valid_time: \"900\"\r\n```\r\nNB: Presumably other Debian and Ubuntu versions would also be effected, but the example package and/or release may need changing.\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\nOn a run where both tasks succeed, the first (`apt_repository`) module should update the APT cache because it has just added the APT repository, and as a result the second (`apt`) task should succeed in installing the `unscd` package from the `jessie-backports` release, which is provided by the APT repository added in the first task.\r\n\r\nMeanwhile a scenario could occur where the first (`apt_repository`) task adds the APT repository but fails to update the APT cache due to a temporary problem like a lack of Internet connectivity or the repository being down. On a subsequent run (after 15 mins / `900` seconds) after the temporary problem is resolved, the first task will understandably not update APT cache as the APT repository is already added. However the second task should still update the APT cache as it's over 900 seconds old, after which it should be able to install `unscd` from the `jessie-backports` release provided by that APT repository.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nIn the second scenario above, it appears the `apt` module does not update the APT cache before checking the `jessie-backports` and so fails with the below error.\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: SystemError: E:The value 'jessie-backports' is invalid for APT::Default-Release as such a release is not available in the sources\r\nfatal: [example-host]: FAILED! => {\"changed\": false, \"failed\": true, \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"/tmp/ansible_EMdwuK/ansible_module_apt.py\\\", line 903, in <module>\\n    main()\\n  File \\\"/tmp/ansible_EMdwuK/ansible_module_apt.py\\\", line 806, in main\\n    cache.open(progress=None)\\n  File \\\"/usr/lib/python2.7/dist-packages/apt/cache.py\\\", line 154, in open\\n    self._cache = apt_pkg.Cache(progress)\\nSystemError: E:The value 'jessie-backports' is invalid for APT::Default-Release as such a release is not available in the sources\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\"} \r\n```\r\nI can appreciate the `apt` module, at least when told a package should be `present`, wants to check for the presence/absence of the package before updating the APT cache, in order to avoid updating the APT cache if the package is already present. However (at least for `state: present`) I would think it should be possible to check whether the named package is installed locally, without concern as to whether the release specified to `default_release` is available. I *would* expect the `apt` module to check the release being avalaible, but only after it's updated the APT cache (if asked to do so!).",
        "created_at": "2017-09-04T13:51:21Z",
        "user": "ghost",
        "labels": [
            "affects_2.2",
            "module",
            "support:core",
            "bug",
            "has_pr",
            "traceback",
            "P3",
            "verified",
            "packaging"
        ]
    },
    {
        "number": 28674,
        "title": "The Ansible/Jinja parser incorrectly tries to parse command/shell comment blocks",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n- ``command``\r\n- ``shell``\r\n\r\n##### ANSIBLE VERSION\r\n``ansible 2.4.0``\r\n\r\n##### CONFIGURATION\r\nnot relevant\r\n\r\n##### OS / ENVIRONMENT\r\nnot relevant\r\n\r\n##### SUMMARY\r\nThe Ansible/Jinja parser incorrectly tries to parse/match unrelevant quotes in the command or shell commands.\r\n\r\n##### STEPS TO REPRODUCE\r\n```bash\r\nansible localhost -m shell -a \"# there is a comment block\"  <-- Works\r\nansible localhost -m shell -a \"# there's a comment block\"   <-- Fails\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nAn Ansible command or shell task should not crash because we are using proper grammar in comments.\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n$ ansible localhost -m shell -a \"# there's a comment block\"\r\nERROR! failed at splitting arguments, either an unbalanced jinja2 block or quotes: # there's a comment block\r\n```\r\n",
        "created_at": "2017-08-25T16:36:40Z",
        "user": "dmsimard",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "has_pr",
            "docs",
            "P3",
            "commands"
        ]
    },
    {
        "number": 28006,
        "title": "Inventory group_vars/host_vars aren't loaded recursively when playbook is launch from a high level inventory directory",
        "body": "##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\nInventories vars\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.4.0\r\n```\r\n\r\n##### CONFIGURATION\r\n\r\nno change in ansible.cfg\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nUbuntu 16.04.3\r\n\r\n##### SUMMARY\r\nInventories group_vars not loaded when ansible-playbook is launched with an upper level directory with the -i option\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHi\r\nI'm actually study how the multi inventory works with ansible 2.4, because this feature can very be interested for my team. I did some test and foud a very strange behaviour. \r\n\r\nAs I understand, we can now specify a directory with the `--inventory` option. I tried and see that all *.ini files are parsed recursively. So this is an inventory structure I wanna try:\r\n\r\n```bash\r\n\u251c\u2500\u2500 inventories\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ansible-test.ini\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 integration\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 common_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 all.yml\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tenant_1\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tenant_2\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 tenant_3\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 production\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 common_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 all.yml\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tenant_1\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 tenant_2\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 tenant_3\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 qa\r\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 common_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 common_vars.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 all\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0         \u251c\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0         \u2514\u2500\u2500 vault.yml\r\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 tenant_1\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 all.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 elastic.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 all\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 elastic\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mapr\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vertica\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 mapr.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vertica.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 all\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 satellites\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 vars.yml\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 satellites.ini\r\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 tenant_2\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 tenant_3\r\n\u2502\u00a0\u00a0         \u251c\u2500\u2500 cluster_A\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0         \u251c\u2500\u2500 cluster_B\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 hosts.ini\r\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 cluster_C\r\n\u2502\u00a0\u00a0             \u251c\u2500\u2500 group_vars\r\n\u2502\u00a0\u00a0             \u251c\u2500\u2500 host_vars\r\n\u2502\u00a0\u00a0             \u2514\u2500\u2500 hosts.ini\r\n```\r\nWhen I execute a playbook with `-i inventories/qa/tenant_1/cluster_C` the hosts.ini file is parsed and the variables set in the group_vars in the current directory are loaded.\r\n\r\nIf I execute the playbook with i inventories/qa/tenant_1`, so from the level above (where my satellites inventory are defined), all the hosts defined in the different sub inventories are parsed, but the host_vars/group_vars associated to each inventory aren't loaded recursively.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPossibillity to optionnaly load recursively all the inventory group_vars/host_vars defined in the subdirectory\r\n\r\nThx in advance ",
        "created_at": "2017-08-10T14:04:35Z",
        "user": "Winael",
        "labels": [
            "c:plugins/vars",
            "affects_2.4",
            "support:core",
            "feature",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 27699,
        "title": "remote_tmp is not used for module files",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n`lib/ansible/executor/module_common.py`\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.3.1.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n  python version = 2.7.13 (default, Jul 21 2017, 03:24:34) [GCC 7.1.1 20170630]\r\n```\r\n\r\n##### CONFIGURATION\r\nThe option is `remote_tmp=/root/.ansible/tmp` but this is also the default (depending on the remote user).\r\n\r\n##### OS / ENVIRONMENT\r\nRunning on Arch Linux, controlling Debian jessie, but issue should be N/A.\r\n\r\n##### SUMMARY\r\nFrom `lib/ansible/executor/module_common.py`:\r\n```\r\n        # There's a race condition with the controller removing the\r\n        # remote_tmpdir and this module executing under async.  So we cannot\r\n        # store this in remote_tmpdir (use system tempdir instead)\r\n        temp_path = tempfile.mkdtemp(prefix='ansible_')\r\n```\r\nThe documentation says that I can configure `remote_tmp` in order to have all module files copied there, executed and then deleted. But as one can see in the code this is actually not the case, because only the initial file is stored in `remote_tmp`.\r\n\r\nAlso, this leads to modules storing their temporary files in the system tempdir. See e.g. the _git_ module which writes an ssh wrapper (when invoked with `key_file`) to a tempfile below the module path (which is made system temp here) or if that does not work to a tempfile in the system temp. My problem is that this wrapper is executed, which is not possible because `/tmp` is mounted `noexec`. This means that I actually need to configure a remote tmpdir for the module to work.\r\n\r\n##### STEPS TO REPRODUCE\r\n`ansible -m shell -a \"ls /tmp/*ansible*/*py /root/.ansible/tmp/*/*py\" -u root somehost`\r\n\r\n##### EXPECTED RESULTS\r\nI would expect that all files are stored within `remote_tmp` which I configured exactly for that purpose.\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nsomehost | SUCCESS | rc=0 >>\r\n/root/.ansible/tmp/ansible-tmp-1501764820.35-275497803017545/command.py\r\n/tmp/ansible_e6qjbm/ansible_module_command.py\r\n```\r\n\r\n##### POSSIBLE SOLUTIONS\r\n\r\n- Before solving the tempdir problem for async execution, check that async execution is actually enabled. If it is not then continue to use `remote_tmp` as base temp path.\r\n- Implement another configuration option, e.g. `remote_module_tmp` or `real_remote_tmp`.\r\n- Test every tempdir and file not only for correct permissions but also check if the filesystem allows these (noexec,ro,...). Choose an alternate base dir if the check does not succeed.",
        "created_at": "2017-08-03T13:15:49Z",
        "user": "extmind",
        "labels": [
            "affects_2.3",
            "c:executor/module_common",
            "support:core",
            "bug",
            "has_pr",
            "verified"
        ]
    },
    {
        "number": 25792,
        "title": "Copy module bug when a directory exists with the same name as a file in src directory",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\ncopy module\r\n\r\n##### ANSIBLE VERSION\r\n\r\n```\r\nansible 2.4.0 (devel 91e995d691) last updated 2017/06/14 08:27:05 (GMT +100)\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/alan-sysop/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/alan-sysop/src/ansible/lib/ansible\r\n  executable location = /home/alan-sysop/src/ansible/bin/ansible\r\n  python version = 2.7.13 (default, May 10 2017, 20:04:28) [GCC 6.3.1 20161221 (Red Hat 6.3.1-1)]\r\n```\r\n\r\n##### CONFIGURATION\r\nTested with `-c local`.\r\n\r\n##### OS / ENVIRONMENT\r\nN/A\r\n\r\n##### SUMMARY\r\nWhen a directory exists with the same name as a file in `src` directory, the copy module does the wrong thing.  (It should simply fail, like `cp -r` does (`cp: cannot overwrite directory 'dest' with non-directory`)).\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# test.yml\r\n- hosts: all\r\n  tasks:\r\n  - copy:\r\n      src: src/\r\n      dest: /tmp/dest\r\n```\r\n\r\n```\r\nmkdir src\r\ntouch src/a\r\n\r\nmkdir /tmp/dest\r\nmkdir /tmp/dest/a\r\nansible-playbook -c local -i localhost, test.yml\r\ntree /tmp/dest\r\n\r\n# WARNING rm -r\r\nrm -r  /tmp/dest\r\n\r\nmkdir /tmp/dest\r\nmkdir /tmp/dest/a\r\nmkdir /tmp/dest/a/a\r\nansible-playbook -c local -i localhost, test.yml\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBoth of the above ansible commands should fail, with an error message similar to cp -r, `cp: cannot overwrite directory 'a' with non-directory`.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [copy] ********************************************************************\r\nchanged: [localhost]\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=2    changed=1    unreachable=0    failed=0   \r\n\r\n/tmp/dest\r\n\u2514\u2500\u2500 a\r\n    \u2514\u2500\u2500 a\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [copy] ********************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"checksum\": \"da39a3ee5e6b4b0d3255bfef95601890afd80709\", \"failed\": true,\r\n\"msg\": \"attempted to take checksum of directory: /tmp/dest/a/a\"}\r\n\tto retry, use: --limit @/home/alan-sysop/t/test.retry\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1   \r\n```",
        "created_at": "2017-06-16T12:42:10Z",
        "user": "sourcejedi",
        "labels": [
            "module",
            "affects_2.4",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "files"
        ]
    },
    {
        "number": 25068,
        "title": "Cannot handle SSH host authenticity prompts for multiple hosts",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nSSH connection\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\nansible --version\r\nansible 2.4.0 (devel 6dd1fc6f34) last updated 2017/05/26 13:48:40 (GMT +100)\r\n  config file =\r\n  configured module search path = [u'/bin/ansible-source/library', u'/usr/share/ansible/']\r\n  ansible python module location = /bin/ansible-source/lib/ansible\r\n  executable location = /bin/ansible\r\n  python version = 2.7.10 (default, Oct 23 2015, 19:19:21) [GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)]\r\n```\r\nSame for `stable-2.3`\r\n\r\n##### CONFIGURATION\r\n<!---\r\nMention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\ndefaults\r\n\r\n##### OS / ENVIRONMENT\r\nHost: Mac OS 10.11.6 \r\nManaging VM: CentOS 7 / Vagrant\r\n\r\n\r\n##### SUMMARY\r\nWhen running against multiple (new) hosts that have no entry in `.ssh/known_hosts` the \"authenticity\" prompts are all output at once to the command line. Entering \"yes\" to continue connecting does not work and simply receives the prompt again \"Please type 'yes' or 'no':\"\r\n\r\nThe problem does not exist when running against a single host. The entry \"yes\" is accepted.\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun any ansible command that connects via SSH against two or more hosts where the hosts are not present in the `.ssh/known_hosts` file.\r\n\r\n##### EXPECTED RESULTS\r\nExpected OS prompts to be queued, accepting user input of \"yes\", before proceeding to the next prompt.\r\n\r\n##### ACTUAL RESULTS\r\nExample using two hosts:\r\n```\r\nThe authenticity of host '10.0.0.4 (10.0.0.4)' can't be established.\r\nECDSA key fingerprint is SHA256:WkPeJUhNdz/MX3zAy536BHZRC/9INGEQWGhsmAPzkEo.\r\nAre you sure you want to continue connecting (yes/no)? The authenticity of host '10.0.0.5 (10.0.0.5)' can't be established.\r\nECDSA key fingerprint is SHA256:UJCEM05W15HZuzOLRpxNli+Qnwei7j84u2lbpVFBqkI.\r\nAre you sure you want to continue connecting (yes/no)? \r\nyes\r\nPlease type 'yes' or 'no': yes\r\nPlease type 'yes' or 'no': yes\r\nPlease type 'yes' or 'no': yes\r\nPlease type 'yes' or 'no': yes\r\n...\r\n```\r\n",
        "created_at": "2017-05-26T13:17:23Z",
        "user": "timwhitlock",
        "labels": [
            "c:plugins/connection/ssh",
            "affects_2.4",
            "support:core",
            "bug",
            "P3",
            "needs_verified"
        ]
    },
    {
        "number": 24989,
        "title": "Module unarchive: Failure when the group name in the group parameter contains a space.",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n\r\n##### COMPONENT NAME\r\nModule: unarchive\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\n$ ansible --version\r\nansible 2.3.0.0\r\n  config file =\r\n  configured module search path = Default w/o overrides\r\n  python version = 2.7.5 (default, Nov  3 2016, 22:05:29) [GCC 4.8.5 20150623 (Red Hat 4.8.5-11)]\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nMention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \u201cN/A\u201d for anything that is not platform-specific.\r\n-->\r\nN/A\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nRunning unarchive using the group ownership parameter fails to unarchive a tar file when the group has a space in it.\r\n\r\nThis is a regression from 2.0.0.2.\r\nFails in 2.2.3 and 2.3.0.\r\n\r\nWe use sssd with AD authentication, so \"domain users\" is a valid system group.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n---\r\n- name: Unarchive\r\n  hosts: remote_host\r\n  become: True\r\n\r\n  vars:\r\n    user: \"root\"\r\n    # Must be a valid system group with a space in it\r\n    # e.g. /etc/group: domain users:x:10000:\r\n    # $ getent group \"domain users\"\r\n    # domain users:x:10000:\r\n    group: \"domain users\"\r\n\r\n  tasks:\r\n    - unarchive: src=\"/tmp/archive.tar.gz\" dest=\"/opt\" copy=no owner=\"{{ user }}\" group=\"{{ group }}\"\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\nunarchive fails to unarchive.\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\nPLAY [Unarchive] ***************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [remote_host]\r\n\r\nTASK [unarchive] ***************************************************************\r\nfatal: [remote_host]: FAILED! => {\"changed\": false, \"dest\": \"/opt\", \"failed\": true, \"gid\": 0, \"group\": \"root\", \"handler\": \"TgzArchive\", \"mode\": \"0755\", \"msg\": \"Unexpected error when accessing exploded file: [Errno 2] No such file or directory: '/opt/etc/'\", \"owner\": \"root\", \"size\": 4096, \"src\": \"/tmp/archive.tar.gz\", \"state\": \"directory\", \"uid\": 0}\r\n\r\nPLAY RECAP *********************************************************************\r\nremote_host                    : ok=1    changed=0    unreachable=0    failed=1\r\n\r\nAnsible failed to complete successfully. Any error output should be\r\nvisible above. Please fix these errors and try again.\r\n```\r\n",
        "created_at": "2017-05-24T16:02:18Z",
        "user": "areobe",
        "labels": [
            "affects_2.3",
            "module",
            "support:core",
            "m:unarchive",
            "bug",
            "P3",
            "needs_verified",
            "files"
        ]
    },
    {
        "number": 22473,
        "title": "Feature Idea: Ability to fail entire playbook if one of included plays fail.",
        "body": "<!---\r\nVerify first that your issue/request is not already reported on GitHub.\r\nAlso test if the latest release, and master branch are affected too.\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\n  - ansible_playbook\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\nansible --version\r\nansible 2.2.0.0\r\n  config file = \r\n  configured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nMention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\n\r\n##### OS / ENVIRONMENT\r\n<!---\r\nMention the OS you are running Ansible from, and the OS you are\r\nmanaging, or say \u201cN/A\u201d for anything that is not platform-specific.\r\n-->\r\n\r\n##### SUMMARY\r\n<!--- Explain the problem briefly -->\r\nNon trivial playbooks can contain many plays. Sometimes downstream plays depend on previous plays being run first. It would be useful to be able to fail the entire playbook early if earlier plays in a playbook fail and not try to execute the rest of the playbook. In the example below, play 2 should not execute if play 1 fails. Currently play 2 will execute as long as it has hosts. This helps in a testing and production scenario. Perhaps make it configurable in ansible.cfg\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# play 1\r\n- hosts: localhost\r\n  connection: local\r\n  gather_facts: false\r\n  become: false\r\n  tasks:\r\n    - include: roles/role1/tasks/stuff.yml\r\n\r\n# play2 depends on play1\r\n- hosts: hosts\r\n  become: true\r\n  pre_tasks:\r\n    - include: roles/role2/tasks/stuff.yml\r\n  roles:\r\n    - role2\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n```\r\n\r\n```\r\n",
        "created_at": "2017-03-10T01:17:17Z",
        "user": "jamesongithub",
        "labels": [
            "c:executor/playbook_executor",
            "support:core",
            "feature",
            "affects_2.17"
        ]
    },
    {
        "number": 22248,
        "title": "A way to delete empty directory safely",
        "body": "##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\nfile\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n```\r\nansible 2.2.1.0\r\n  config file =\r\n  configured module search path = Default w/o overrides\r\n$ uname -a\r\nDarwin mbpro-2014.local 15.6.0 Darwin Kernel Version 15.6.0: Mon Jan  9 23:07:29 PST 2017; root:xnu-3248.60.11.2.1~1/RELEASE_X86_64 x86_64\r\n```\r\n\r\nI don't know if anyone looks at closed issues, so I'm opening this to revisit - ansible/ansible#7541\r\n\r\nIs there a less dangerous and complicated way to safely delete an empty directory?\r\n\r\nI will detect \"is it necessary to run `kubeadm init`\" first, and next ensure that the conditions to run it are met.  If there are stale collections of PKI keys and certs, pods and plugins that haven't been cleaned up from a previous installation, etc, I want to abort and fail, and have someone look at the system to see if they are safe to delete before moving on.  If they are empty directories, I want to delete them without ceremony so that `kubeadm init` does not fail because of their presence.",
        "created_at": "2017-03-03T15:07:54Z",
        "user": "kingdonb",
        "labels": [
            "affects_2.2",
            "affects_2.3",
            "module",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "system",
            "files",
            "collection",
            "affects_2.12"
        ]
    },
    {
        "number": 21899,
        "title": "Git module do not update local copy if tag ref is updated, but reports diff in check + diff mode",
        "body": "##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nModule git\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.2.1.0\r\n  config file = \r\n  configured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\nNothing to declare\r\n\r\n##### OS / ENVIRONMENT\r\nUbuntu 16.04 LTS\r\n\r\n##### SUMMARY\r\n1. create a tag like v1.0\r\n2. use git module to \"clone\" the project with version=v1.0\r\n3. make some commits and push force v1.0 (=changed)\r\n4. use git module to \"clone\" the project with version=v1.0\r\n\r\nShould report changed and local copy should be updated.\r\nReports no change and do not update local copy.\r\nBut running in check + diff mode then changes are reported!\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n- hosts:\r\n    - localhost\r\n  tasks:\r\n    - name: Clone some\r\n      git: repo=some.git dest=/some force=yes version=v1.0\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n```\r\nTASK [...]\r\nchanged: [localhost] ...\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nTASK [...]\r\nok: [localhost] ...\r\n```",
        "created_at": "2017-02-24T14:56:51Z",
        "user": "davidfischer-ch",
        "labels": [
            "affects_2.2",
            "module",
            "support:core",
            "bug",
            "P3",
            "source_control"
        ]
    },
    {
        "number": 21156,
        "title": "detect if ssh pipeline can be used through a setup module fact",
        "body": "##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\nsetup\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.2.1.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\nN/A\r\n\r\n##### OS / ENVIRONMENT\r\nN/A\r\n\r\n##### SUMMARY\r\nssh pipeline is off by default (p.s., PR #13200 has some problems). Can we make  ssh pipeline more smart way, that is, enable it as much as possible for each host after the setup module is done?\r\n\r\nSo a few things are needed:\r\n1. in `ansible.cfg`, `pipelining` can be set to 'smart'/True/False\r\n2. if set to smart (by default), setup module will set ansible_ssh_pipelining as a host fact\r\n3. when detecting:\r\n    - if not find `sudo`, set ansible_ssh_pipelining to True\r\n    - run some command such as `echo id | sudo -S -n sh`, if find 'you must have a tty to run sudo' in stderr, set ansible_ssh_pipelining to False\r\n    - other cases, set ansible_ssh_pipelining to True\r\n4. if a task is not a become-task, always enable ssh pipelining\r\n\r\n##### STEPS TO REPRODUCE\r\n- debug: msg=\"{{ansible_ssh_pipelining|d('')}}\"\r\n- setup\r\n- debug: msg=\"{{ansible_ssh_pipelining|d('')}}\"\r\n\r\n##### EXPECTED RESULTS\r\nfirst debug output empty string\r\nsecond debug output true or false\r\n\r\n##### ACTUAL RESULTS\r\nboth debug output same",
        "created_at": "2017-02-08T17:24:10Z",
        "user": "gzm55",
        "labels": [
            "module",
            "support:core",
            "feature",
            "system",
            "affects_2.17"
        ]
    },
    {
        "number": 19720,
        "title": "Exit status of `ansible-playbook` not as documented",
        "body": "##### ISSUE TYPE\r\n - Docs Report\r\n- ~~Bug Report~~\r\n\r\n##### COMPONENT NAME\r\n`ansible-playbook` command.\r\n\r\n##### ANSIBLE VERSION\r\n```\r\n > ansible --version\r\nansible 2.3.0 (devel a10209cbe9) last updated 2016/12/28 22:13:02 (GMT +200)\r\n  config file = /Users/ko/Development/projects/new-nest/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n\r\n > ansible-playbook --version\r\nansible-playbook 2.3.0 (devel a10209cbe9) last updated 2016/12/28 22:13:02 (GMT +200)\r\n  config file = /Users/ko/Development/projects/new-nest/ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\n```\r\n[defaults]\r\ndisplay_skipped_hosts = False\r\nretry_files_enabled = False\r\nroles_path = ./roles:./galaxy-roles\r\n```\r\n(but should not be related to the problem)\r\n\r\n##### OS / ENVIRONMENT\r\nRunning Ansible from macOS `10.12.1 (16B2555)`\r\n\r\n##### SUMMARY\r\nThe exit codes from the `ansible-playbook` command with an unreachable host is not as reported in `man ansible-playbook` (`4` instead of `3`).\r\n\r\n##### STEPS TO REPRODUCE\r\n(Just follow the code)\r\n```yaml\r\n# playbook.yml\r\n- hosts: all\r\n  tasks:\r\n    - debug:  var=hostvars\r\n```\r\n\r\n```\r\n# inventory\r\nfoobar.baz # Be shure, this host does not exist o_O\r\n```\r\n\r\n```bash\r\n# then run\r\nansible-playbook -i inventory playbook.yml\r\necho \"Exit code is: $?\"\r\n```\r\n\r\nThis as a gist: https://gist.github.com/kolibri/744effd6d713b69928aa9b9bddea291a\r\n(clone an `./run.sh`)\r\n\r\n##### EXPECTED RESULTS\r\nExit code `3` when a host ist unreachable (or, if this is not an error, a more understandable documentation what `unreachable` means) \r\n\r\n##### ACTUAL RESULTS\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAYBOOK: playbook.yml ***************************************************************************************************************************\r\n1 plays in playbook.yml\r\n\r\nPLAY [all] ***************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ***************************************************************************************************************************\r\nUsing module file /Users/ko/Development/vendor/ansible/lib/ansible/modules/system/setup.py\r\n<foobar.baz> ESTABLISH SSH CONNECTION FOR USER: None\r\n<foobar.baz> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/Users/ko/.ansible/cp/ansible-ssh-%h-%p-%r foobar.baz '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo ~/.ansible/tmp/ansible-tmp-1482961771.21-8227272489736 `\" && echo ansible-tmp-1482961771.21-8227272489736=\"` echo ~/.ansible/tmp/ansible-tmp-1482961771.21-8227272489736 `\" ) && sleep 0'\"'\"''\r\nfatal: [foobar.baz]: UNREACHABLE! => {\r\n    \"changed\": false,\r\n    \"msg\": \"Failed to connect to the host via ssh: ssh: Could not resolve hostname foobar.baz: nodename nor servname provided, or not known\\r\\n\",\r\n    \"unreachable\": true\r\n}\r\n\r\nPLAY RECAP ***************************************************************************************************************************************\r\nfoobar.baz                 : ok=0    changed=0    unreachable=1    failed=0\r\n\r\nExit code is: 4\r\n```\r\n(this is not really necessary for this issue, is it? So, here a snippet from my `man ansible-playbook` that is more related: )\r\n```\r\nEXIT STATUS -----------\r\n\r\n*0* -- OK or no hosts matched\r\n\r\n*1* -- Error\r\n\r\n*2* -- One or more hosts failed\r\n\r\n*3* -- One or more hosts were unreachable\r\n\r\n*4* -- Parser error\r\n\r\n*5* -- Bad or incomplete options\r\n\r\n*99* -- User interrupted execution\r\n\r\n*250* -- Unexpected error\r\n```",
        "created_at": "2016-12-28T22:05:02Z",
        "user": "kolibri",
        "labels": [
            "c:cli/playbook",
            "support:core",
            "bug",
            "has_pr",
            "docs",
            "affects_2.15",
            "affects_2.16",
            "affects_2.18"
        ]
    },
    {
        "number": 19101,
        "title": "--diff doesn't show all differences with Template module",
        "body": "_From @rsanr on September 20, 2016 18:27_\n\n<!--- Verify first that your issue/request is not already reported in GitHub -->\n##### ISSUE TYPE\n\n<!--- Pick one below and delete the rest: -->\n- Bug Report\n##### COMPONENT NAME\n\nTemplate\n##### ANSIBLE VERSION\n\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\n\n```\nansible 2.2.0 (devel 3bac945147)\n```\n##### CONFIGURATION\n\n<!---\nMention any settings you have changed/added/removed in ansible.cfg\n(or using the ANSIBLE_* environment variables).\n-->\n##### OS / ENVIRONMENT\n\n<!---\nMention the OS you are running Ansible from, and the OS you are\nmanaging, or say \u201cN/A\u201d for anything that is not platform-specific.\n-->\n\nN/A\n##### SUMMARY\n\n<!--- Explain the problem briefly -->\n\nUsing `--diff` when running template module doesn't show all the changes when both the template file and mode has changed.\n##### STEPS TO REPRODUCE\n\n<!---\nFor bugs, show exactly how to reproduce the problem.\nFor new features, show how the feature would be used.\n-->\n\n<!--- Paste example playbooks or commands between quotes below -->\n\nTask:\n\n```\n- name: ensures /abc/myconf.conf exists\n  template:\n    src: \"my_template\"\n    dest: \"/abc/myconf.conf\"\n    mode: 0755\n  become: yes\n  become_method: sudo\n```\n\nmyconf.conf\n\n```\n{\n  \"obj\": {\n    \"type\": \"foo\",\n    \"pol\": {\n      \"a\": \"{{  ansible_processor_vcpus }}|a_pol\",\n      \"b\": \"b_pol,\n      \"c\": \"c_pol\",\n      \"d\": \"d_pol\"\n    }\n  }\n}\n```\n\nChanged task w/ updated `mode` and updated `myconf.conf`\n\n```\n- name: ensures /abc/myconf.conf exists\n  template:\n    src: \"my_template\"\n    dest: \"/abc/myconf.conf\"\n    mode: 0775\n  become: yes\n  become_method: sudo\n```\n\n```\n{\n  \"obj\": {\n    \"type\": \"foo1\",\n    \"pol\": {\n      \"a\": \"{{  ansible_processor_vcpus }}|a_pol\",\n      \"b\": \"b_pol,\n      \"c\": \"c_pol\",\n      \"d\": \"d_pol\"\n    }\n  }\n}\n```\n\n<!--- You can also paste gist.github.com links for larger files -->\n##### EXPECTED RESULTS\n\n<!--- What did you expect to happen when running the steps above? -->\n\n```\n\nchanged: [xx.xx.xx.xxx] => {\"changed\": true, \"diff\": {\"after\": {\"mode\": \"0775\", \"path\": \"/abc/myconf.conf\"}, \"before\": {\"mode\": \"0755\", \"path\": \"/abc/myconf.conf\"},{\"after\": \"{\\n  \\\"obj\\\": {\\n    \\\"type\\\": \\\"foo1\\\",\\n    \\\"pol\\\": {\\n      \\\"a\\\": \\\"2|a_pol\\\",\\n      \\\"b\\\": \\\"b_pol,\\n      \\\"c\\\": \\\"c_pol\\\",\\n      \\\"d\\\": \\\"d_pol\\\"\\n    }\\n  }\\n}\\n\\n\", \"after_header\": \"dynamically generated\", \"before\": \"{\\n  \\\"obj\\\": {\\n    \\\"type\\\": \\\"foo\\\",\\n    \\\"pol\\\": {\\n      \\\"a\\\": \\\"2|a_pol\\\",\\n      \\\"b\\\": \\\"b_pol,\\n      \\\"c\\\": \\\"c_pol\\\",\\n      \\\"d\\\": \\\"d_pol\\\"\\n    }\\n}, \"gid\": 0, \"group\": \"root\", \"invocation\": {\"module_args\": {\"backup\": null, \"content\": null, \"delimiter\": null, \"dest\": \"/abc/myconf.conf\", \"diff_peek\": null, \"directory_mode\": null, \"follow\": true, \"force\": false, \"group\": null, \"mode\": 509, \"original_basename\": \"myconf.conf.j2\", \"owner\": null, \"path\": \"/abc/myconf.conf\", \"recurse\": false, \"regexp\": null, \"remote_src\": null, \"selevel\": null, \"serole\": null, \"setype\": null, \"seuser\": null, \"src\": null, \"state\": null, \"validate\": null}}, \"mode\": \"0755\", \"owner\": \"root\", \"path\": \"/abc/myconf.conf\", \"size\": 138, \"state\": \"file\", \"uid\": 0}\n--- before: /abc/myconf.conf\n+++ after: dynamically generated\n@@ -1,6 +1,6 @@\n {\n   \"obj\": {\n-    \"type\": \"foo\",\n+    \"type\": \"foo1\",\n     \"pol\": {\n       \"a\": \"2|a_pol\",\n       \"b\": \"b_pol,\n--- before\n+++ after\n@@ -1,4 +1,4 @@\n {\n-    \"mode\": \"0755\", \n+    \"mode\": \"0775\", \n     \"path\": \"/abc/myconf.conf\"\n }\n```\n##### ACTUAL RESULTS\n\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\n\n<!--- Paste verbatim command output between quotes below -->\n\nAnsible playbook was run with `--diff` and `--check` flags.  The behavior is the same whether `--check` flag was used or not.\n\n```\nchanged: [xx.xx.xx.xxx] => {\"changed\": true, \"diff\": {\"after\": \"{\\n  \\\"obj\\\": {\\n    \\\"type\\\": \\\"foo1\\\",\\n    \\\"pol\\\": {\\n      \\\"a\\\": \\\"2|a_pol\\\",\\n      \\\"b\\\": \\\"b_pol,\\n      \\\"c\\\": \\\"c_pol\\\",\\n      \\\"d\\\": \\\"d_pol\\\"\\n    }\\n  }\\n}\\n\\n\", \"after_header\": \"dynamically generated\", \"before\": \"{\\n  \\\"obj\\\": {\\n    \\\"type\\\": \\\"foo\\\",\\n    \\\"pol\\\": {\\n      \\\"a\\\": \\\"2|a_pol\\\",\\n      \\\"b\\\": \\\"b_pol,\\n      \\\"c\\\": \\\"c_pol\\\",\\n      \\\"d\\\": \\\"d_pol\\\"\\n    }\\n  }\\n}\\n\\n\", \"before_header\": \"/abc/myconf.conf\"}, \"invocation\": {\"module_args\": {\"dest\": \"/abc/myconf.conf\", \"mode\": 509, \"src\": \"myconf.conf.j2\"}, \"module_name\": \"template\"}}\n--- before: /abc/myconf.conf\n+++ after: dynamically generated\n@@ -1,6 +1,6 @@\n {\n   \"obj\": {\n-    \"type\": \"foo\",\n+    \"type\": \"foo1\",\n     \"pol\": {\n       \"a\": \"2|a_pol\",\n       \"b\": \"b_pol,\n```\n\nNOTE: When only `mode` was updated with no changes to the `myconf.conf` file, the output is as expected as follows:\n\n```\n--- before\n+++ after\n@@ -1,4 +1,4 @@\n {\n-    \"mode\": \"0755\", \n+    \"mode\": \"0775\", \n     \"path\": \"/abc/myconf.conf\"\n }\n```\n\n\n_Copied from original issue: ansible/ansible-modules-core#4948_",
        "created_at": "2016-12-09T19:53:03Z",
        "user": "rsanr",
        "labels": [
            "affects_2.2",
            "module",
            "support:core",
            "bug",
            "P3",
            "verified",
            "files"
        ]
    },
    {
        "number": 17806,
        "title": "hostvars[host][variable] are not recursively templated",
        "body": "<!---\nPlease do not report issues/requests related to Ansible modules here !!\n\nReport them to the appropriate modules-core or modules-extras project:\n  - https://github.com/ansible/ansible-modules-core/issues\n  - https://github.com/ansible/ansible-modules-extras/issues\n\nAlso verify first that your issue/request is not already reported in GitHub\n-->\n##### ISSUE TYPE\n\n<!--- Pick one below and delete the rest: -->\n- Bug Report\n##### ANSIBLE VERSION\n\n```\nansible 2.1.1.0\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = Default w/o overrides\n\n```\n##### CONFIGURATION\n\nDefault configuration without changes.\n##### OS / ENVIRONMENT\n\nLinux (Fedora 23)\n##### SUMMARY\n\nWhen using host/groupvars in a template through hostvars and the variable is templated, jinja template string is returned instead of the interpolated variable. This renders map/extract pretty useless in variables. Can't confirm but I think this used to work in some of the earlier versions.\n##### STEPS TO REPRODUCE\n\nplaybook.yml:\n\n```\n\n---\n- hosts: all\n  become: no\n  tasks:\n    - template: src=test.j2 dest=\"/tmp/test.{{ inventory_hostname }}\"\n\n```\n\ninventory:\n\n```\n[foo]\nlocalhost ansible_connection=local\notherhost ansible_connection=local\n```\n\nhost_vars/localhost:\n\n```\n\n---\ntest_var: \"this is localhost\"\n```\n\nhost_vars/otherhost:\n\n```\n\n---\ntest_var: \"this is otherhost\"\n\n```\n\ngroup_vars/foo\n\n```\n\n---\ngroupvar: \"{{ groups.all|map('extract', hostvars, 'test_var')|list }}\"\n```\n\ntest.j2:\n\n```\n1. {{ groupvar }}\n2. {{ hostvars[inventory_hostname]['groupvar'] }}\n```\n\nRun the playbook:\n\n```\nansible-playbook -i inventory -l otherhost playbook.yml\n```\n\n```\ncat /tmp/test.otherhost\n```\n##### EXPECTED RESULTS\n\n```\n1. [u'this is localhost', u'this is otherhost']\n2. [u'this is localhost', u'this is otherhost']\n```\n##### ACTUAL RESULTS\n1. [u'this is localhost', u'this is otherhost']\n2. {{ groups.all|map('extract', hostvars, 'test_var')|list }}\n",
        "created_at": "2016-09-29T12:31:34Z",
        "user": "lassizci",
        "labels": [
            "affects_2.1",
            "c:vars/hostvars",
            "support:core",
            "bug",
            "P3",
            "needs_verified",
            "affects_2.12",
            "data_tagging"
        ]
    },
    {
        "number": 16977,
        "title": "ansible_default_ipv6 fact uses link-local address",
        "body": "##### ISSUE TYPE\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\nsetup module\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible 2.1.0.0\r\nconfig file = /Users/chip/Personal/ansible/ansible.cfg\r\nconfigured module search path = Default w/o overrides\r\n```\r\n\r\n##### CONFIGURATION\r\nNo relevant changes.\r\n\r\n##### OS / ENVIRONMENT\r\nRunning Ansible on Mac OS X 10.11.6\r\nManaging FreeBSD 10.3-RELEASE-p4\r\n\r\n##### SUMMARY\r\nOn FreeBSD hosts, the ansible_default_ipv6 facts will return the link-local address, which isn't useful for communication between hosts on separate networks.\r\n\r\n##### STEPS TO REPRODUCE\r\n```\r\nansible [host] -m setup\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nOn a host with an interface like this:\r\n```\r\nalc0: flags=8843<UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST> metric 0 mtu 1500\r\n    options=c3198<VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,TSO4,WOL_MCAST,WOL_MAGIC,VLAN_HWTSO,LINKSTATE>\r\n    ether 1c:6f:65:69:48:b6\r\n    inet 192.0.2.32 netmask 0xffffff00 broadcast 192.0.2.255\r\n    inet6 fe80::1e6f:65ff:fe69:48b6%alc0 prefixlen 64 scopeid 0x1\r\n    inet6 2001:db8::32 prefixlen 64\r\n    nd6 options=21<PERFORMNUD,AUTO_LINKLOCAL>\r\n    media: Ethernet autoselect (1000baseT <full-duplex,master>)\r\n    status: active\r\n```\r\nI would expect `ansible_facts['ansible_default_ipv6']['address']` to contain `2001:db8::32`\r\n\r\n##### ACTUAL RESULTS\r\nBut instead we get the link local address of `fe80::1e6f:65ff:fe69:48b6%alc0`\r\n\r\n```\r\n> ansible host -m setup\r\nhost | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"ansible_alc0\": {\r\n            \"device\": \"alc0\",\r\n            \"flags\": [\r\n                \"UP\",\r\n                \"BROADCAST\",\r\n                \"RUNNING\",\r\n                \"SIMPLEX\",\r\n                \"MULTICAST\"\r\n            ],\r\n            \"ipv4\": [\r\n                {\r\n                    \"address\": \"192.0.2.32\",\r\n                    \"broadcast\": \"192.0.2.255\",\r\n                    \"netmask\": \"255.255.255.0\",\r\n                    \"network\": \"192.0.2.0\"\r\n                }\r\n            ],\r\n            \"ipv6\": [\r\n                {\r\n                    \"address\": \"fe80::1e6f:65ff:fe69:48b6%alc0\",\r\n                    \"prefix\": \"64\",\r\n                    \"scope\": \"0x1\"\r\n                },\r\n                {\r\n                    \"address\": \"2001:db8::32\",\r\n                    \"prefix\": \"64\"\r\n                }\r\n            ],\r\n            \"macaddress\": \"1c:6f:65:69:48:b6\",\r\n            \"media\": \"Ethernet\",\r\n            \"media_options\": [\r\n                \"full-duplex\",\r\n                \"master\"\r\n            ],\r\n            \"media_select\": \"autoselect\",\r\n            \"media_type\": \"1000baseT\",\r\n            \"metric\": \"0\",\r\n            \"mtu\": \"1500\",\r\n            \"options\": [\r\n                \"PERFORMNUD\",\r\n                \"AUTO_LINKLOCAL\"\r\n            ],\r\n            \"status\": \"active\",\r\n            \"type\": \"unknown\"\r\n        },\r\n        \"ansible_all_ipv4_addresses\": [\r\n            \"192.0.2.32\"\r\n        ],\r\n        \"ansible_all_ipv6_addresses\": [\r\n            \"fe80::1e6f:65ff:fe69:48b6%alc0\",\r\n            \"2001:db8::32\"\r\n        ],\r\n[..SNIP..]\r\n        \"ansible_default_ipv6\": {\r\n            \"address\": \"fe80::1e6f:65ff:fe69:48b6%alc0\",\r\n            \"device\": \"alc0\",\r\n            \"flags\": [\r\n                \"UP\",\r\n                \"BROADCAST\",\r\n                \"RUNNING\",\r\n                \"SIMPLEX\",\r\n                \"MULTICAST\"\r\n            ],\r\n            \"gateway\": \"2001:db8::1\",\r\n            \"interface\": \"alc0\",\r\n            \"macaddress\": \"1c:6f:65:69:48:b6\",\r\n            \"media\": \"Ethernet\",\r\n            \"media_options\": [\r\n                \"full-duplex\",\r\n                \"master\"\r\n            ],\r\n            \"media_select\": \"autoselect\",\r\n            \"media_type\": \"1000baseT\",\r\n            \"metric\": \"0\",\r\n            \"mtu\": \"1500\",\r\n            \"options\": [\r\n                \"PERFORMNUD\",\r\n                \"AUTO_LINKLOCAL\"\r\n            ],\r\n            \"prefix\": \"64\",\r\n            \"scope\": \"0x1\",\r\n            \"status\": \"active\",\r\n            \"type\": \"unknown\"\r\n        },\r\n[..SNIP..]\r\n    },\r\n    \"changed\": false\r\n}\r\n```\r\n\r\n",
        "created_at": "2016-08-05T15:15:05Z",
        "user": "2bithacker",
        "labels": [
            "affects_2.1",
            "module",
            "c:module_utils/facts",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "needs_verified",
            "system"
        ]
    },
    {
        "number": 16259,
        "title": "Add MFA keyboard-interactive authentication in sshd_config, even with nullok in the authentication method's PAM options",
        "body": "<!--- Verify first that your issue/request is not already reported in GitHub -->\r\n##### ISSUE TYPE\r\n\r\n<!--- Pick one below and delete the rest: -->\r\n- Feature Request\r\n\r\n##### COMPONENT NAME\r\n<!--- Name of the module/plugin/task/feature -->\r\nCore? The whole of ansible :s\r\n##### ANSIBLE VERSION\r\n\r\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\r\n\r\n```\r\nansible 2.1.0.0\r\n  config file = /home/admin/.ansible.cfg\r\n  configured module search path = Default w/o overrides\r\n```\r\n##### CONFIGURATION\r\n\r\nansible.cfg:\r\n\r\n```\r\n[defaults]\r\ninventory=~/bin/custom-ansible-inventory\r\ncallback_whitelist = profile_tasks\r\n\r\n[ssh_connection]\r\ncontrol_path = %(directory)s/%%C\r\n```\r\n##### OS / ENVIRONMENT\r\n\r\nDebian Jessie, targeting an Amazon Linux EC2 instance\r\n##### SUMMARY\r\n\r\nWhen I set up sshd to require keyboard-interactive authentication without using a password, I can't connect to the target host via ssh when running ansible-playbook.\r\n\r\nI have set up a remote host with the [google-authenticator PAM module](https://github.com/google/google-authenticator/blob/f2db05c52884e4d6c3894f5fd2cf10f0f686aec2/libpam/README.md) to allow users who have not set up their MFA token to authenticate via the `nullok` option in the PAM entry for google-authenticator. More details below in \"steps to reproduce.\"\r\n\r\nThen, when I try to run my playbook, during the setup step I get this error:\r\n\r\n```\r\nfatal: [<IP address>]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh.\", \"unreachable\": true}\r\n```\r\n\r\nI believe that this happens because the `PreferredAuthentications` option that ansible uses does not include `keyboard-interactive`. But in this case, `--ask-pass` is not a solution because my user has neither a password nor an MFA token to pass.\r\n\r\nIf I manually run the ssh command that ansible is trying to run, adding `keyboard-interactive`, the command works. I believe the fix would be to always include `keyboard-interactive`.\r\n\r\nNote that this is a separate issue from #10065 because I do not want to pass an MFA token.\r\n##### STEPS TO REPRODUCE\r\n\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\nFirst, software versions:\r\n- OpenSSH_6.6.1p1, OpenSSL 1.0.1k-fips 8 Jan 2015\r\n- google-authenticator 1.01-1.el6\r\n\r\nNow, the actual steps:\r\n1. I added the following line to `/etc/pam.d/sshd` on the remote host and removed the line requiring password-auth.\r\n   \r\n   ```\r\n   auth       required     pam_google_authenticator.so secret=/var/mfa_secrets/${USER}/.google_authenticator user=google-authenticator nullok\r\n   ```\r\n2. I then set up `sshd_config` on the remote host like so and restarted `sshd`:\r\n   \r\n   ```\r\n   ChallengeResponseAuthentication yes\r\n   PasswordAuthentication no\r\n   UsePAM yes\r\n   AuthenticationMethods publickey,keyboard-interactive:pam\r\n   ```\r\n3. I verified that I could ssh to my EC2 instance:\r\n   \r\n   ```\r\n   ssh -l ec2-user <IP address>\r\n   ```\r\n   \r\n   I logged in without being prompted for anything, including my MFA token (since it wasn't set up yet.) This verifies that it is possible to ssh in.\r\n4. Then from my machine I went to run my playbook (the contents are irrelevant):\r\n   \r\n   ```\r\n   ansible-playbook ./ansible/playbook.yml -i <IP address>, -e target=<IP address> -e ansible_ssh_user=ec2-user\r\n   ```\r\n##### EXPECTED RESULTS\r\n\r\n<!--- What did you expect to happen when running the steps above? -->\r\n\r\nI had expected to be able to run the playbook just fine, but...\r\n##### ACTUAL RESULTS\r\n\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\nWhat actually happened was this SSH connection error.\r\n\r\n<!--- Paste verbatim command output between quotes below -->\r\n\r\n```\r\n<184.72.123.76> ESTABLISH SSH CONNECTION FOR USER: ec2-user\r\n<184.72.123.76> SSH: EXEC ssh -C -vvv -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ec2-user -o ConnectTimeout=10 -o ControlPath=/home/admin/.ansible/cp/%C <IP address> '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo $HOME/.ansible/tmp/ansible-tmp-1465856827.88-176148510186610 `\" && echo ansible-tmp-1465856827.88-176148510186610=\"` echo $HOME/.ansible/tmp/ansible-tmp-1465856827.88-176148510186610 `\" ) && sleep 0'\"'\"''\r\nfatal: [<IP address>]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh.\", \"unreachable\": true}\r\n```\r\n",
        "created_at": "2016-06-13T22:38:11Z",
        "user": "2rs2ts",
        "labels": [
            "affects_2.1",
            "affects_2.2",
            "affects_2.3",
            "c:plugins/connection/ssh",
            "affects_2.4",
            "support:core",
            "affects_2.5",
            "has_pr",
            "feature",
            "affects_2.13",
            "affects_2.18"
        ]
    },
    {
        "number": 15786,
        "title": "tags not validated",
        "body": "<!--- Verify first that your issue/request is not already reported in GitHub -->\n##### ISSUE TYPE\n\n<!--- Pick one below and delete the rest: -->\n- Bug Report\n##### COMPONENT NAME\ncore\n\n##### ANSIBLE VERSION\n\n```\nansible 2.1.0.0 (stable-2.1 9620eadc03) last updated 2016/05/09 09:53:48 (GMT -500)\n  lib/ansible/modules/core: (detached HEAD 4212513be4) last updated 2016/05/09 10:19:48 (GMT -500)\n  lib/ansible/modules/extras: (detached HEAD b933aaf85f) last updated 2016/05/09 10:19:48 (GMT -500)\n  config file = \n  configured module search path = Default w/o overrides\n```\n##### CONFIGURATION\n\nStock\n##### OS / ENVIRONMENT\n\n<!---\nMention the OS you are running Ansible from, and the OS you are\nmanaging, or say \u201cN/A\u201d for anything that is not platform-specific.\n-->\n\nDebian Wheezy Linux\n##### SUMMARY\n\n<!--- Explain the problem briefly -->\n\nIn 1.9, using a tag not present in a playbook would fail at start and present existing tags. In 2.0.1 and confirmed in 2.1, tags that aren't in playbook are ignored, playbook runs anyway.\n##### STEPS TO REPRODUCE\n\ngit checkout stable-1.9 ; git submodule update\n\nrun playbook with missing tag\n\ngit checkout stable-2.1 ; git submodule update\n\nrun playbook with missing tag\n##### EXPECTED RESULTS\n\n<!--- What did you expect to happen when running the steps above? -->\n\nIn 1.9+, run with incorrect tag should have failed with an error. Listing existing tags would be nice.\n##### ACTUAL RESULTS\n\n<!--- What actually happened? If possible run with high verbosity (-vvvv) -->\n\nversion 1.9\n\n```\nwcarlson@tek1:~/playbooks/test$ ./run -t sjdlfkjalskdf --check\nERROR: tag(s) not found in playbook: sjdlfkjalskdf.  possible values: packages\n```\n\nversion 2.1 (unreachable host expected, but not with unknown tag)\n\n```\nwcarlson@tek1:~/playbooks/test$ ./run -t sjdlfkjalskdf --check\n\nPLAY [all] *********************************************************************\n\nTASK [setup] *******************************************************************\nfatal: [test-1]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh.\", \"unreachable\": true}\n    to retry, use: --limit @site.retry\n\nPLAY RECAP *********************************************************************\ntest-1                     : ok=0    changed=0    unreachable=1    failed=0   \n```\n",
        "created_at": "2016-05-09T17:19:50Z",
        "user": "ghost",
        "labels": [
            "affects_2.1",
            "support:core",
            "bug",
            "P3"
        ]
    },
    {
        "number": 12608,
        "title": "[deadlock] Paramiko transport hangs forever if a bad sudo password is provided",
        "body": "##### ISSUE TYPE\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\ncore\r\n\r\n##### ANSIBLE VERSION\r\n2.1\r\n\r\n##### CONFIGURATION\r\n\r\n\r\n##### OS / ENVIRONMENT\r\n\r\n\r\n##### SUMMARY\r\n```console\r\n$ ansible dest-host -Ks -m shell -a 'echo hello world'\r\nsudo password: \r\nrl02-mach.rhev.intra | FAILED => failed to parse: \r\nSorry, try again.\r\n[sudo via ansible, key=iqasdasddasdasdasdaadasdaasdsdcb] password: \r\nsudo: 1 incorrect password attempt\r\n```\r\n\r\nOnly after a 5 minutes hang I can see the output above. It shows it hangs in the \"try again\" waiting for user input.\r\n\r\nThe transport is set to \"smart\" and falls to paramiko because ssh doesn't have ControlPersist in the master host.\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n",
        "created_at": "2015-10-02T13:26:42Z",
        "user": "manuq",
        "labels": [
            "performance",
            "affects_2.1",
            "affects_2.3",
            "c:plugins/connection/paramiko_ssh",
            "support:core",
            "plugins/connection/paramiko_ssh",
            "bug",
            "has_pr",
            "affects_2.6",
            "affects_2.7",
            "affects_2.8",
            "P3",
            "verified",
            "affects_2.9"
        ]
    },
    {
        "number": 11568,
        "title": "Add check and diff mode support to assemble",
        "body": "##### ISSUE TYPE\r\nFeature Idea\r\n\r\n##### COMPONENT NAME\r\nassemble module\r\n\r\n##### ANSIBLE VERSION\r\ndevel\r\n\r\n##### SUMMARY\r\nIn current devel assemble just skips when in check mode, it should be able to test if there is a difference and changed=true/false. \r\n\r\nThe same with diff, it should work as template modules does.\r\n",
        "created_at": "2015-07-13T14:41:21Z",
        "user": "bcoca",
        "labels": [
            "affects_2.0",
            "affects_2.3",
            "module",
            "support:core",
            "has_pr",
            "feature",
            "P3",
            "files",
            "affects_2.10"
        ]
    },
    {
        "number": 11544,
        "title": "Vault overrides file permissions and ownership",
        "body": "##### ISSUE TYPE\r\nBug Report\r\n\r\n##### COMPONENT NAME\r\nvault\r\n\r\n##### ANSIBLE VERSION\r\n2.12\r\n\r\n##### SUMMARY\r\nI have several files with 400 permission. After encrypting / decrypting them they change to 644. That's not desired / expected. It seems the same happens for the file owner. If I have multiple files belonging to several users, they all become owned by the current user.\r\n",
        "created_at": "2015-07-10T06:01:03Z",
        "user": "iby",
        "labels": [
            "affects_2.0",
            "affects_2.3",
            "c:cli/vault",
            "support:core",
            "bug",
            "has_pr",
            "P3",
            "affects_2.14"
        ]
    }
]